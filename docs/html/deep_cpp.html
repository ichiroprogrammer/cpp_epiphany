<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Deep C++(V17.02)</title>
  <style>
    html {
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 12px;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      html {
        background-color: white;
      }
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
      font-size: 85%;
      margin: 0;
      hyphens: manual;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #cccccc; background-color: #303030; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ffcfaf; } /* Alert */
    code span.an { color: #7f9f7f; font-weight: bold; } /* Annotation */
    code span.at { } /* Attribute */
    code span.bn { color: #dca3a3; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #f0dfaf; } /* ControlFlow */
    code span.ch { color: #dca3a3; } /* Char */
    code span.cn { color: #dca3a3; font-weight: bold; } /* Constant */
    code span.co { color: #7f9f7f; } /* Comment */
    code span.cv { color: #7f9f7f; font-weight: bold; } /* CommentVar */
    code span.do { color: #7f9f7f; } /* Documentation */
    code span.dt { color: #dfdfbf; } /* DataType */
    code span.dv { color: #dcdccc; } /* DecVal */
    code span.er { color: #c3bf9f; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #c0bed1; } /* Float */
    code span.fu { color: #efef8f; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #7f9f7f; font-weight: bold; } /* Information */
    code span.kw { color: #f0dfaf; } /* Keyword */
    code span.op { color: #f0efd0; } /* Operator */
    code span.ot { color: #efef8f; } /* Other */
    code span.pp { color: #ffcfaf; font-weight: bold; } /* Preprocessor */
    code span.sc { color: #dca3a3; } /* SpecialChar */
    code span.ss { color: #cc9393; } /* SpecialString */
    code span.st { color: #cc9393; } /* String */
    code span.va { } /* Variable */
    code span.vs { color: #cc9393; } /* VerbatimString */
    code span.wa { color: #7f9f7f; font-weight: bold; } /* Warning */

    body {
        margin: 0 auto;
        max-width: none;
        width: 1000px;
        padding-left: 50px;
        padding-right: 50px;
        padding-top: 50px;
        padding-bottom: 50px;
        hyphens: auto;
        overflow-wrap: break-word;
        text-rendering: optimizeLegibility;
        font-kerning: normal;
    }

    table {
        border-collapse: collapse;
    }

    table, th, td {
        border: 2px solid black;
    }

    header {
        margin-bottom: 4em;
        text-align: center;
        color: white;
        background-color: lightblue;
    }

    h1:not(:first-of-type) {
        page-break-before: always;
    }

  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">Deep C++(V17.02)</h1>
<p class="author">autor:ichiroprogrammer</p>
</header>
<h1 id="インデックス">インデックス</h1>
<p>  <a href="#SS_1">SOLID</a><br />
   <a href="#SS_1_1">単一責任の原則(SRP)</a><br />
   <a href="#SS_1_2">オープン・クローズドの原則(OCP)</a><br />
   <a href="#SS_1_3">リスコフの置換原則(LSP)</a><br />
   <a href="#SS_1_4">インターフェース分離の原則(ISP)</a><br />
   <a href="#SS_1_5">依存関係逆転の原則(DIP)</a><br />
   <a href="#SS_1_6">まとめ</a></p>
<p>  <a href="#SS_2">デザインパターン</a><br />
   <a href="#SS_2_1">ガード節</a><br />
   <a href="#SS_2_2">BitmaskType</a><br />
   <a href="#SS_2_3">Pimpl</a><br />
   <a href="#SS_2_4">Accessor</a><br />
   <a href="#SS_2_5">Copy-And-Swap</a><br />
   <a href="#SS_2_6">Immutable</a><br />
   <a href="#SS_2_7">Clone(仮想コンストラクタ)</a><br />
   <a href="#SS_2_8">NVI(non virtual interface)</a><br />
   <a href="#SS_2_9">RAII(scoped guard)</a><br />
   <a href="#SS_2_10">Future</a><br />
   <a href="#SS_2_11">DI(dependency injection)</a><br />
   <a href="#SS_2_12">Singleton</a><br />
   <a href="#SS_2_13">State</a><br />
   <a href="#SS_2_14">Null Object</a><br />
   <a href="#SS_2_15">Templateメソッド</a><br />
   <a href="#SS_2_16">Factory</a><br />
   <a href="#SS_2_17">Named Constructor</a><br />
   <a href="#SS_2_18">Proxy</a><br />
   <a href="#SS_2_19">Strategy</a><br />
   <a href="#SS_2_20">Visitor</a><br />
   <a href="#SS_2_21">CRTP(curiously recurring template
pattern)</a><br />
   <a href="#SS_2_22">Observer</a><br />
   <a href="#SS_2_23">MVC</a><br />
   <a href="#SS_2_24">Cでのクラス表現</a></p>
<p>  <a href="#SS_3">テンプレートメタプログラミング</a><br />
   <a href="#SS_3_1">ログ取得ライブラリの開発</a><br />
   <a href="#SS_3_2">Nstdライブラリの開発</a><br />
   <a href="#SS_3_3">メタ関数のテクニック</a><br />
   <a href="#SS_3_4">Nstdライブラリの開発2</a><br />
   <a href="#SS_3_5">ログ取得ライブラリの開発2</a><br />
   <a href="#SS_3_6">その他のテンプレートテクニック</a><br />
   <a href="#SS_3_7">注意点まとめ</a></p>
<p>  <a href="#SS_4">ダイナミックメモリアロケーション</a><br />
   <a href="#SS_4_1">malloc/freeの問題点</a><br />
   <a href="#SS_4_2">グローバルnew/deleteのオーバーロード</a><br />
   <a href="#SS_4_3">クラスnew/deleteのオーバーロード</a><br />
   <a href="#SS_4_4">STLコンテナのアロケーター</a></p>
<p>  <a href="#SS_5">用語解説</a><br />
   <a href="#SS_5_1">型とインスタンス</a><br />
   <a href="#SS_5_2">オブジェクトと生成</a><br />
   <a href="#SS_5_3">オブジェクトのコピー</a><br />
   <a href="#SS_5_4">name lookupと名前空間</a><br />
   <a href="#SS_5_5">expressionと値カテゴリ</a><br />
   <a href="#SS_5_6">リファレンス</a><br />
   <a href="#SS_5_7">エクセプション安全性の保証</a><br />
   <a href="#SS_5_8">シンタックス、セマンティクス</a><br />
   <a href="#SS_5_9">C++コンパイラ</a><br />
   <a href="#SS_5_10">C++その他</a><br />
   <a href="#SS_5_11">ソフトウェア一般</a><br />
   <a href="#SS_5_12">非ソフトウェア用語</a></p>
<p>  <a href="#SS_6">Sample Code</a><br />
   <a href="#SS_6_1">C++</a></p>
<!-- ./md/solid.md -->
<h1 id="solid">SOLID <a id="SS_1"></a></h1>
<p>SOLIDとは、オブジェクト指向(OOD/OOP)プログラミングにおいて特に重要な下記の5つの原則である。</p>
<ul>
<li><a href="#SS_1_1">単一責任の原則(SRP)</a></li>
<li><a href="#SS_1_2">オープン・クローズドの原則(OCP)</a></li>
<li><a href="#SS_1_3">リスコフの置換原則(LSP)</a></li>
<li><a href="#SS_1_4">インターフェース分離の原則(ISP)</a></li>
<li><a href="#SS_1_5">依存関係逆転の原則(DIP)</a></li>
</ul>
<h2 id="単一責任の原則srp">単一責任の原則(SRP) <a id="SS_1_1"></a></h2>
<p>単一責任の原則(SRP, Single Responsibility Principle)とは、</p>
<ul>
<li>一つのクラスは、ただ一つの責任(機能)を持つようにしなければならない</li>
<li>一つのクラスは、ただ一つの理由で変更されるように作られなければならない</li>
</ul>
<p>というクラスデザイン上の制約である。</p>
<p>下記クラスSentenceHolderNotSRPは、一見問題ないように見えるが、std::stringの保持と、
その出力という二つの責務を持つため、SRP違反である。</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/solid/srp_ut.cpp 27</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> SentenceHolderNotSRP <span class="op">{</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>        SentenceHolderNotSRP<span class="op">()</span>  <span class="op">=</span> <span class="cf">default</span><span class="op">;</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>        <span class="op">~</span>SentenceHolderNotSRP<span class="op">()</span> <span class="op">=</span> <span class="cf">default</span><span class="op">;</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> Add<span class="op">(</span><span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span><span class="op">&amp;</span> sentence<span class="op">)</span> <span class="op">{</span> <span class="va">sentence_</span> <span class="op">+=</span> sentence<span class="op">;</span> <span class="op">}</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span><span class="op">&amp;</span> Get<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">sentence_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> Save<span class="op">(</span><span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span><span class="op">&amp;</span> file<span class="op">)</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>            <span class="bu">std::</span>ofstream<span class="op"> </span>o<span class="op">{</span>file<span class="op">};</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>            o <span class="op">&lt;&lt;</span> <span class="va">sentence_</span><span class="op">;</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> Display<span class="op">()</span> <span class="op">{</span> <span class="bu">std::</span>cout<span class="op"> &lt;&lt;</span> <span class="va">sentence_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span><span class="va">sentence_</span><span class="op">{};</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>実践的にはこの程度の単純なクラスでのSRP違反が問題になることは少ないが、
下記のコメントで示す通り、単体テストの実施が困難になる。</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/solid/srp_ut.cpp 53</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> not_srp <span class="op">=</span> SentenceHolderNotSRP<span class="op">{};</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    not_srp<span class="op">.</span>Add<span class="op">(</span><span class="st">&quot;haha</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">);</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    not_srp<span class="op">.</span>Add<span class="op">(</span><span class="st">&quot;hihi</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">);</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    not_srp<span class="op">.</span>Add<span class="op">(</span><span class="st">&quot;huhu</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">);</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">// SRPに従っていないため、テストが面倒</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    not_srp<span class="op">.</span>Save<span class="op">(</span><span class="va">not_srp_text_</span><span class="op">);</span>  <span class="co">// not_srp_text_への書き込み</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> ifs       <span class="op">=</span> <span class="bu">std::</span>ifstream<span class="op">{</span><span class="va">not_srp_text_</span><span class="op">};</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> ifs_begin <span class="op">=</span> <span class="bu">std::</span>istreambuf_iterator<span class="op">&lt;</span><span class="dt">char</span><span class="op">&gt;{</span>ifs<span class="op">};</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> ifs_end   <span class="op">=</span> <span class="bu">std::</span>istreambuf_iterator<span class="op">&lt;</span><span class="dt">char</span><span class="op">&gt;{};</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> act       <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{</span>ifs_begin<span class="op">,</span> ifs_end<span class="op">};</span>  <span class="co">// not_srp_text_ファイルの読み出し</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;haha</span><span class="sc">\n</span><span class="st">hihi</span><span class="sc">\n</span><span class="st">huhu</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">,</span> act<span class="op">);</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="co">// SRPに従っていないため、テストできない</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    not_srp<span class="op">.</span>Display<span class="op">();</span></span></code></pre></div>
<p>クラスSentenceHolderNotSRPの二つの責務をクラスSentenceHolderSRPと、
Output()に分離したコード実装例を下記する。</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/solid/srp_ut.cpp 75</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> SentenceHolderSRP <span class="op">{</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>        SentenceHolderSRP<span class="op">()</span>  <span class="op">=</span> <span class="cf">default</span><span class="op">;</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>        <span class="op">~</span>SentenceHolderSRP<span class="op">()</span> <span class="op">=</span> <span class="cf">default</span><span class="op">;</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> Add<span class="op">(</span><span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span><span class="op">&amp;</span> sentence<span class="op">)</span> <span class="op">{</span> <span class="va">sentence_</span> <span class="op">+=</span> sentence<span class="op">;</span> <span class="op">}</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span><span class="op">&amp;</span> Get<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">sentence_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span><span class="va">sentence_</span><span class="op">{};</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">// SRPに従うために、</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">//    SentenceHolderNotSRP::Save(), SentenceHolderNotSRP::Display()</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">// をクラスの外に出し、さらに仮引数に出力先(std::ostream&amp;)を追加してこの2関数を統一。</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> Output<span class="op">(</span>SentenceHolderSRP <span class="at">const</span><span class="op">&amp;</span> sentence_holder<span class="op">,</span> <span class="bu">std::</span>ostream<span class="op">&amp;</span> o<span class="op">)</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>        o <span class="op">&lt;&lt;</span> sentence_holder<span class="op">.</span>Get<span class="op">();</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>下記のコードで示したように、この分離の効果で単体テストの実施が容易になった。</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/solid/srp_ut.cpp 101</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> srp <span class="op">=</span> SentenceHolderSRP<span class="op">{};</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    srp<span class="op">.</span>Add<span class="op">(</span><span class="st">&quot;haha</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">);</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    srp<span class="op">.</span>Add<span class="op">(</span><span class="st">&quot;hihi</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">);</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    srp<span class="op">.</span>Add<span class="op">(</span><span class="st">&quot;huhu</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">);</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">// SRPに従ったことで、ファイル操作やstd::coutへの操作が不要になり、単体テストの実施が容易</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> act <span class="op">=</span> <span class="bu">std::</span>ostringstream<span class="op">{};</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    Output<span class="op">(</span>srp<span class="op">,</span> act<span class="op">);</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;haha</span><span class="sc">\n</span><span class="st">hihi</span><span class="sc">\n</span><span class="st">huhu</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">,</span> act<span class="op">.</span>str<span class="op">());</span></span></code></pre></div>
<h2 id="オープンクローズドの原則ocp">オープン・クローズドの原則(OCP)
<a id="SS_1_2"></a></h2>
<p>オープン・クローズドの原則(OCP, Open-Closed Principle)とは、</p>
<ul>
<li>クラスは拡張に対して開いて (open) いなければならず、</li>
<li>クラスは修正に対して閉じて (closed) いなければならない</li>
</ul>
<p>というクラスデザイン上の制約である。</p>
<p>まずは、アンチパターンから示す。</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/solid/ocp_ut.cpp 14</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> TransactorGoogle <span class="op">{</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="dt">bool</span> Pay<span class="op">(</span>Yen price<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>            <span class="op">...</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="dt">bool</span> Charge<span class="op">(</span>Yen price<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>            <span class="op">...</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> TransactorSuica <span class="op">{</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> TransactorEdy <span class="op">{</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> TransactorNotOCP <span class="op">{</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>        <span class="kw">enum</span> <span class="kw">class</span> TransactionMethod <span class="op">{</span> Google<span class="op">,</span> Suica<span class="op">,</span> Edy <span class="op">};</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> TransactorNotOCP<span class="op">(</span>TransactionMethod pay_method<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">:</span> <span class="va">pay_method_</span><span class="op">{</span>pay_method<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>        <span class="dt">bool</span> Charge<span class="op">(</span>Yen price<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>            <span class="cf">switch</span> <span class="op">(</span><span class="va">pay_method_</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>            <span class="cf">case</span> TransactionMethod<span class="op">::</span>Google<span class="op">:</span></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> TransactorGoogle<span class="op">::</span>Charge<span class="op">(</span>price<span class="op">);</span></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>            <span class="cf">case</span> TransactionMethod<span class="op">::</span>Suica<span class="op">:</span></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> TransactorSuica<span class="op">::</span>Charge<span class="op">(</span>price<span class="op">);</span></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>                <span class="op">...</span></span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>        <span class="dt">bool</span> Pay<span class="op">(</span>Yen price<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>            <span class="cf">switch</span> <span class="op">(</span><span class="va">pay_method_</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>            <span class="cf">case</span> TransactionMethod<span class="op">::</span>Google<span class="op">:</span></span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> TransactorGoogle<span class="op">::</span>Pay<span class="op">(</span>price<span class="op">);</span></span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>            <span class="cf">case</span> TransactionMethod<span class="op">::</span>Suica<span class="op">:</span></span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> TransactorSuica<span class="op">::</span>Pay<span class="op">(</span>price<span class="op">);</span></span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>                <span class="op">...</span></span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>Transaction Method(enum TransactionMethod)が増えた場合、
少なくとも3か所に手を入れなけばならなくなる(修正に対してclosedでない)。
従って、下記のTransactorNotOCP::Charge()や、TransactorNotOCP::Pay()は
Transaction Methodの追加、変更に対して、脆弱な構造だと言える。</p>
<p>次に上記ソースコードのクラス図を下記する。</p>
<p>クラス図が示す通り、 TransactorNotOCPは、TransactorGoogle,
TransactorSuica, TransactorEdy (Transaction
Methodに対応した具体的なクラス)に強く依存する。
したがって、新たなTransactor Methodが追加されれば、 Transaction
Methodを使用しているTransactorNotOCPのすべてのメンバ関数は影響を受ける。
この構造は、上位概念が下位概念に依存しているとも言えるため、
後述する「<a
href="#SS_1_5">依存関係逆転の原則(DIP)</a>」にも反している。</p>
<p>
<img src="data:image/png;base64,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" />
</p>
<p>下記は、TransactorIFを導入することによって、上例をOCPに沿うように改善したクラス図と実装である。
TransactorOCPは、TransactorIFの効果によりTransaction
Methodの追加に対して全く影響を受けなくなった
(実際には、TransactorIFから派生する具象クラスの生成用Factory関数(「<a
href="#SS_2_16">Factory</a>」参照)
が必要になるため全く影響がないわけではないが、
そのような箇所はソースコード全体でただ一つにすることができるため、
Transaction Methodの追加に対して強固な構造になったと言える)。</p>
<p>
<img src="data:image/png;base64,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" />
</p>
<p>下記にこのクラス図に従ったコードを示す。</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/solid/ocp_ut.cpp 122</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> TransactorIF <span class="op">{</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">bool</span> Charge<span class="op">(</span>Yen price<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> charge<span class="op">(</span>price<span class="op">);</span> <span class="op">}</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">bool</span> Pay<span class="op">(</span>Yen price<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> pay<span class="op">(</span>price<span class="op">);</span> <span class="op">}</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">bool</span> charge<span class="op">(</span>Yen price<span class="op">)</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">bool</span> pay<span class="op">(</span>Yen price<span class="op">)</span>    <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> TransactorGoogle <span class="op">:</span> <span class="kw">public</span> TransactorIF <span class="op">{</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> TransactorSuica <span class="op">:</span> <span class="kw">public</span> TransactorIF <span class="op">{</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> TransactorEdy <span class="op">:</span> <span class="kw">public</span> TransactorIF <span class="op">{</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> TransactorOCP <span class="op">{</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> TransactorOCP<span class="op">(</span><span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>TransactorIF<span class="op">&gt;&amp;&amp;</span> transactor<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>            <span class="op">:</span> <span class="va">transactor_</span><span class="op">{</span><span class="bu">std::</span>move<span class="op">(</span>transactor<span class="op">)}</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>        <span class="dt">bool</span> Charge<span class="op">(</span>Yen price<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">transactor_</span><span class="op">-&gt;</span>Charge<span class="op">(</span>price<span class="op">);</span> <span class="op">}</span></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>        <span class="dt">bool</span> Pay<span class="op">(</span>Yen price<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">transactor_</span><span class="op">-&gt;</span>Pay<span class="op">(</span>price<span class="op">);</span> <span class="op">}</span></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>TransactorIF<span class="op">&gt;</span> <span class="va">transactor_</span><span class="op">;</span></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>ここでは、この原則に沿う実装方法としてポリモーフィズムを使うパターンを紹介したが、
<a
href="#SS_2_3">Pimpl</a>のようにラッピングを使用するパターンも有用である。</p>
<h2 id="リスコフの置換原則lsp">リスコフの置換原則(LSP)
<a id="SS_1_3"></a></h2>
<p>リスコフの置換原則(LSP, Liskov Substitution Principle)とは、</p>
<ul>
<li>基底クラスを使っているX(関数もしくはクラス)に、
基底クラスの代わりにその派生クラスを渡した場合でも、
Xはその実際の型を知ること無しに正常動作できなければならない</li>
</ul>
<p>というクラスデザイン上の制約であり、
この制約を守るために下記のような契約プログラミングを行うことが求められる。</p>
<ul>
<li>事前条件を派生クラスで強めることはできない。
つまり、基底クラスよりも強い事前条件を持つ派生クラスを作ってはならない。</li>
<li>事後条件を派生クラスで弱めることはできない。
つまり、基底クラスよりも弱い事後条件を持つ派生クラスを作ってはならない。</li>
</ul>
<p>この原則に従わない実装例を示すために、以下のようなクラスRectangleとその派生クラスSquareを定義する。</p>
<p>
<img src="data:image/png;base64,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" />
</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/solid/lsp.h 5</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@class</span><span class="co"> </span><span class="cv">Rectangle</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@brief</span><span class="co"> (0, 0) からの矩形を表す</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Rectangle <span class="op">{</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> Rectangle<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">:</span> <span class="va">x_</span><span class="op">{</span>x<span class="op">},</span> <span class="va">y_</span><span class="op">{</span>y<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> SetX<span class="op">(</span><span class="dt">int</span> x<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> temp <span class="op">=</span> <span class="va">y_</span><span class="op">;</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>            set_x<span class="op">(</span>x<span class="op">);</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>            <span class="ot">assert</span><span class="op">(</span>temp <span class="op">==</span> <span class="va">y_</span><span class="op">);</span>  <span class="co">// 「set_xはy_に影響を与えない」が事後条件</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">protected</span><span class="op">:</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span> set_x<span class="op">(</span><span class="dt">int</span> x<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="va">x_</span> <span class="op">=</span> x<span class="op">;</span> <span class="op">}</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> <span class="va">x_</span><span class="op">;</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> <span class="va">y_</span><span class="op">;</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@class</span><span class="co"> </span><span class="cv">Rectangle</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@brief</span><span class="co"> (0, 0) からの正方形を表す</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Square <span class="op">:</span> <span class="kw">public</span> Rectangle <span class="op">{</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> Square<span class="op">(</span><span class="dt">int</span> x<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">:</span> Rectangle<span class="op">{</span>x<span class="op">,</span> x<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>    <span class="kw">protected</span><span class="op">:</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span> set_x<span class="op">(</span><span class="dt">int</span> x<span class="op">)</span> <span class="kw">noexcept</span> <span class="kw">override</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>            Rectangle<span class="op">::</span>set_x<span class="op">(</span>x<span class="op">);</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>            Rectangle<span class="op">::</span>set_y<span class="op">(</span>x<span class="op">);</span></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span> set_y<span class="op">(</span><span class="dt">int</span> y<span class="op">)</span> <span class="kw">noexcept</span> <span class="kw">override</span> <span class="op">{</span> set_x<span class="op">(</span>y<span class="op">);</span> <span class="op">}</span></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>Rectangleのリファレンスを受け取るSetX()とその単体テストを以下のようにすると、
Rectangleのテストでは問題は起こらないが、同じことをSquareに行うとアボートしてしまう
(下記例ではASSERT_DEATHを使用しアボートすることを確認している)。</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/solid/lsp_ut.cpp 13</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> SetX<span class="op">(</span>Rectangle<span class="op">&amp;</span> rect<span class="op">,</span> <span class="dt">int</span> x<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span> rect<span class="op">.</span>SetX<span class="op">(</span>x<span class="op">);</span> <span class="op">}</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    TEST<span class="op">(</span>LSP_Opt<span class="op">,</span> violation_abort<span class="op">)</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Rectangleのテスト</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> rect <span class="op">=</span> Rectangle<span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">};</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>        SetX<span class="op">(</span>rect<span class="op">,</span> <span class="dv">3</span><span class="op">);</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="dv">3</span><span class="op">,</span> rect<span class="op">.</span>GetX<span class="op">());</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Squareのテスト</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> square <span class="op">=</span> Square<span class="op">{</span><span class="dv">0</span><span class="op">};</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>        ASSERT_DEATH<span class="op">(</span>SetX<span class="op">(</span>square<span class="op">,</span> <span class="dv">3</span><span class="op">),</span> <span class="st">&quot;&quot;</span><span class="op">);</span>  <span class="co">// ここでRectangle::SetX()の中のassert()がfailする。</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>上記コードがアボート(assertion fail)してしまったのは</p>
<ul>
<li>Rectangle::SetX()は、この実行によるy_の値が不変であることを表明している</li>
<li>この表明は、Rectangle::set_x()の事後条件となる</li>
<li>Square::set_x()は、この事後条件を守らず、y_の値を変えてしまった</li>
</ul>
<p>が原因である。このデザイン上の問題には目をつぶり(Rectangle、Squareを修正せずに)、
しかもアボートしないSetX()の実装を考えてみよう。</p>
<p>SetX()は仮引数で渡されたオブジェクトの実際の型がわからなければアボートを避けることはできない。
従って、 新しいSetX()のコード実装例は以下のようになる。</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/solid/lsp_ut.cpp 32</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> SetX<span class="op">(</span>Rectangle<span class="op">&amp;</span> rect<span class="op">,</span> <span class="dt">int</span> x<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span><span class="kw">dynamic_cast</span><span class="op">&lt;</span>Square<span class="op">*&gt;(&amp;</span>rect<span class="op">)</span> <span class="op">!=</span> <span class="kw">nullptr</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>            rect <span class="op">=</span> Square<span class="op">(</span>x<span class="op">);</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>            <span class="co">// rectの型は、Rectangle</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>            rect<span class="op">.</span>SetX<span class="op">(</span>x<span class="op">);</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    TEST<span class="op">(</span>LSP<span class="op">,</span> violation_not_abort<span class="op">)</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Rectangleのテスト</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> rect <span class="op">=</span> Rectangle<span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">};</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>        SetX<span class="op">(</span>rect<span class="op">,</span> <span class="dv">3</span><span class="op">);</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="dv">3</span><span class="op">,</span> rect<span class="op">.</span>GetX<span class="op">());</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Squareのテスト</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> square <span class="op">=</span> Square<span class="op">{</span><span class="dv">0</span><span class="op">};</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>        SetX<span class="op">(</span>square<span class="op">,</span> <span class="dv">3</span><span class="op">);</span>  <span class="co">// assert()はfailしない。</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="dv">3</span><span class="op">,</span> square<span class="op">.</span>GetX<span class="op">());</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>上記の新たなSetX()は、アボートはしないがきわめて醜悪且つ、
Rectangleの全派生クラスに依存した、変更に弱い関数となる。</p>
<p>なお、リスコフの置換原則とは関係しないが、上記のdynamic_castを含むSetX()は、
下記のように修正することができる。</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/solid/lsp_ut.cpp 61</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> SetX<span class="op">(</span>Rectangle<span class="op">&amp;</span> rect<span class="op">,</span> <span class="dt">int</span> x<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> y <span class="op">=</span> rect<span class="op">.</span>GetY<span class="op">();</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>        rect   <span class="op">=</span> Rectangle<span class="op">(</span>x<span class="op">,</span> y<span class="op">);</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>このSetX()は、Rectangleからの派生クラスに依存していないため、良い解法に見える。
ところが実際にはオブジェクトの<a
href="#SS_5_3_3">スライシング</a>という別の問題を引き起こす。</p>
<p>例示した問題は結局のところデザインの誤りが原因であり、それを修正しない限り、
問題の回避は容易ではない。</p>
<p>一般に、継承関係は、IS-Aの関係と呼ばれる。数学の世界では「正方形 is a
長方形」であるため、 この関係を継承で表したのだが、
「Rectangle::SetX()の性質より導き出されたRectangle::set_x()の事後条件」
により、「クラスSquare is <strong>NOT</strong> a
クラスRectangle」となり、
SquareとRectangleは継承関係ではないため問題が発生した。</p>
<p>継承を用いなければこのような問題は発生しないため、public継承を使用する際には、
「本当にその関係は継承で表すべきか(それが最もシンプルな方法か)？」
について熟慮する必要がある。</p>
<p>なお、エクセプション記述子は、関数のエクセプション仕様を強制的にLSPに従わせる仕組みであるが、
C++11から非推奨になり、C++17では規格から削除された。 その理由は、 「<a
href="https://cpprefjp.github.io/lang/cpp17/remove_deprecated_exception_specifications.html">非推奨だった古い例外仕様を削除</a>」
の説明の通り、これを使用し場合、OCPに違反する可能性が高いからである。
従って、原則に従うのみでなく、その他の原則とのバランスも考慮する必要がある。</p>
<h2 id="インターフェース分離の原則isp">インターフェース分離の原則(ISP)
<a id="SS_1_4"></a></h2>
<p>インターフェース分離の原則 (ISP, Interface Segregation
Principle)とは、</p>
<ul>
<li>クラスは、そのクライアントが使用しないメソッドへの依存を、そのクライアントに強制するべきではない。
<ul>
<li>クラスのインターフェースを巨大にしない。</li>
<li>一つのヘッダファイルに互いが密接な関係を持たない複数のクラスを定義、宣言すべきでない。</li>
<li>一つのヘッダファイルにそのファイルのコンパイルに不要なヘッダファイルをインクルードすべきでない。</li>
</ul></li>
</ul>
<p>というクラスデザイン上の制約である。</p>
<p>まずは、ISPに従っていない例を示す。
下記のStreamReadWriterは、ClientRからはStreamReadWriter::Read()のみが、
ClientWからはStreamReadWriter::Write()のみが使用されている。</p>
<p>
<img src="data:image/png;base64,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" />
</p>
<p>ほとんどのStreamReadWriter使用ファイルでこのような依存関係がある場合、
このクラスは下記のようにStreamReaderとStreamWriterに分割した方が良い(依存関係が小さくなる)。</p>
<p>
<img src="data:image/png;base64,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" />
</p>
<p>クラスの設計時に統合か分割かで悩むことは多いが、一度統合してしまえば分割は困難であり、
逆に分割されたものを統合することは容易である。このことを考慮すれば、
このような逡巡に解を与えることは簡単である。言うまでもないが、「まずは分割」が原則である。</p>
<h2 id="依存関係逆転の原則dip">依存関係逆転の原則(DIP)
<a id="SS_1_5"></a></h2>
<p>依存関係逆転の原則 (DIP, Dependency Inversion Principle)とは、</p>
<ul>
<li>上位レベルのモジュールは下位レベルのモジュールに依存すべきではない。</li>
<li>抽象は具象に依存すべきではない。</li>
</ul>
<p>というクラス デザイン上の制約である。</p>
<p>下記ServerNG::Serverは、ClientNG::Clientに非同期サービスを提供する
(従って、ServerNG::ServerはClientNG::Clientに対して上位概念である)。</p>
<p>
<img src="data:image/png;base64,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" />
</p>
<p>非同期サービスであるServerNG::Server::RequireStringAsync()の完了は
ServerNG::ServerがClientNG::Client::Done()を呼び出すことにより通知される。<br />
その実装、使用例を下記に示す。</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/solid/dip_server_ng.h 10</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> ServerNG <span class="op">{</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Server <span class="op">{</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>        Server<span class="op">();</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> RequireStringAsync<span class="op">(</span>ClientNG <span class="op">::</span>Client<span class="op">&amp;</span> client<span class="op">)</span> <span class="kw">noexcept</span><span class="op">;</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace ServerNG</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/solid/dip_server_ng.cpp 6</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> ServerNG <span class="op">{</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> <span class="op">{</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> dispatch<span class="op">(</span>ClientNG<span class="op">::</span>Client<span class="op">&amp;</span> client<span class="op">)</span>  <span class="co">// コマンドのディスパッチ</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">switch</span> <span class="op">(</span>client<span class="op">.</span>GetNum<span class="op">())</span> <span class="op">{</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="dv">1</span><span class="op">:</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>            client<span class="op">.</span>Done<span class="op">(</span><span class="kw">new</span> <span class="bu">std::</span>string<span class="op">{</span><span class="st">&quot;hello&quot;</span><span class="op">});</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span><span class="op">;</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="dv">2</span><span class="op">:</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>            client<span class="op">.</span>Done<span class="op">(</span><span class="kw">new</span> <span class="bu">std::</span>string<span class="op">{</span><span class="st">&quot;good bye&quot;</span><span class="op">});</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span><span class="op">;</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>            <span class="op">...</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> thread_entry<span class="op">(</span>Pipe<span class="op">&amp;</span> pipe<span class="op">)</span>  <span class="co">// サーバーのスレッド関数</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(;;)</span> <span class="op">{</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>            ClientNG<span class="op">::</span>Client<span class="op">*</span> client<span class="op">{</span><span class="kw">nullptr</span><span class="op">};</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> <span class="at">const</span>        ret <span class="op">=</span> pipe<span class="op">.</span>Read<span class="op">(&amp;</span>client<span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>client<span class="op">));</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>            <span class="ot">assert</span><span class="op">(</span>ret <span class="op">==</span> <span class="kw">sizeof</span><span class="op">(</span>client<span class="op">));</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>client <span class="op">==</span> <span class="kw">nullptr</span><span class="op">)</span> <span class="op">{</span>  <span class="co">// nullptr受信でサーバー終了</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span><span class="op">;</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>            dispatch<span class="op">(*</span>client<span class="op">);</span></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace</span></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> Server<span class="op">::</span>RequireStringAsync<span class="op">(</span>ClientNG<span class="op">::</span>Client<span class="op">&amp;</span> client<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> <span class="at">const</span><span class="op">*</span> <span class="at">const</span> buff<span class="op">{&amp;</span>client<span class="op">};</span></span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> ret <span class="op">=</span> <span class="va">pipe_</span><span class="op">.</span>Write<span class="op">(&amp;</span>buff<span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>buff<span class="op">));</span></span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>        <span class="ot">assert</span><span class="op">(</span>ret <span class="op">==</span> <span class="kw">sizeof</span><span class="op">(&amp;</span>client<span class="op">));</span></span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span></span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace ServerNG</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/solid/dip_client_ng.h 10</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> ClientNG <span class="op">{</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Client <span class="op">{</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> Client<span class="op">(</span>ServerNG<span class="op">::</span>Server<span class="op">&amp;</span> server<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">:</span> <span class="va">server_</span><span class="op">{</span>server<span class="op">},</span> <span class="va">pipe_</span><span class="op">{},</span> <span class="va">num_</span><span class="op">{</span><span class="dv">0</span><span class="op">}</span> <span class="op">{}</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span>GetString<span class="op">(</span><span class="dt">uint32_t</span> num<span class="op">);</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> Done<span class="op">(</span><span class="bu">std::</span>string<span class="op">*</span> str<span class="op">)</span> <span class="kw">noexcept</span>  <span class="co">// サーバーからクライアントへのコマンド終了通知</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> <span class="at">const</span> ret <span class="op">=</span> <span class="va">pipe_</span><span class="op">.</span>Write<span class="op">(&amp;</span>str<span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>str<span class="op">));</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>            <span class="ot">assert</span><span class="op">(</span>ret <span class="op">==</span> <span class="kw">sizeof</span><span class="op">(</span>str<span class="op">));</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace ClientNG</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/solid/dip_client_ng.cpp 3</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> ClientNG <span class="op">{</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>string<span class="op"> </span>Client<span class="op">::</span>GetString<span class="op">(</span><span class="dt">uint32_t</span> num<span class="op">)</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>        set_num<span class="op">(</span>num<span class="op">);</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">server_</span><span class="op">.</span>RequireStringAsync<span class="op">(*</span><span class="kw">this</span><span class="op">);</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="op">*</span>wait_done<span class="op">();</span>  <span class="co">// 非同期通知待ち</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;</span> Client<span class="op">::</span>wait_done<span class="op">()</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op">*</span> str<span class="op">{</span><span class="kw">nullptr</span><span class="op">};</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> <span class="at">const</span>   ret <span class="op">=</span> <span class="va">pipe_</span><span class="op">.</span>Read<span class="op">(&amp;</span>str<span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>str<span class="op">));</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>        <span class="ot">assert</span><span class="op">(</span>ret <span class="op">==</span> <span class="kw">sizeof</span><span class="op">(</span>str<span class="op">));</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;{</span>str<span class="op">};</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace ClientNG</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/solid/dip_ut.cpp 11</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    TEST<span class="op">(</span>DIP<span class="op">,</span> ng_pattern<span class="op">)</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> server <span class="op">=</span> ServerNG<span class="op">::</span>Server<span class="op">{};</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> client <span class="op">=</span> ClientNG<span class="op">::</span>Client<span class="op">{</span>server<span class="op">};</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> actual <span class="op">=</span> client<span class="op">.</span>GetString<span class="op">(</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;hello&quot;</span><span class="op">,</span> actual<span class="op">);</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>        actual <span class="op">=</span> client<span class="op">.</span>GetString<span class="op">(</span><span class="dv">2</span><span class="op">);</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;good bye&quot;</span><span class="op">,</span> actual<span class="op">);</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>        actual <span class="op">=</span> client<span class="op">.</span>GetString<span class="op">(</span><span class="dv">3</span><span class="op">);</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;unknown&quot;</span><span class="op">,</span> actual<span class="op">);</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>上記ソースコードから明らかなようにServerNG::ServerとClientNG::Clientは相互に依存している。
このうちの一つはサーバがクライアントに依存(上位概念が下位概念に依存)する問題のある構造となっている。</p>
<p>
<img src="data:image/png;base64,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" />
</p>
<p>このため、クライアントのバリエーションが増えた場合、容易にServerNG::Serverのコードは肥大化する。
また、ServerNG::Serverを介して各クライアント間にも(暗黙、明示両方の)依存関係が生まれやすいため、
ServerNG::Serverのコード修正は非常に困難になることが予想される。</p>
<p>次にDIPに従い上記コードを改善した例を示す。</p>
<div class="sourceCode" id="cb16"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/solid/dip_server_ok.h 7</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> ServerOK <span class="op">{</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> ClientIF <span class="op">{</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>        ClientIF<span class="op">()</span> <span class="kw">noexcept</span> <span class="op">:</span> <span class="va">num_</span><span class="op">{</span><span class="dv">0</span><span class="op">}</span> <span class="op">{}</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> Done<span class="op">(</span><span class="bu">std::</span>string<span class="op">*</span> str<span class="op">)</span> <span class="op">{</span> done<span class="op">(</span>str<span class="op">);</span> <span class="op">}</span>  <span class="co">// サーバーからクライアントへのコマンド終了通知</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span> done<span class="op">(</span><span class="bu">std::</span>string<span class="op">*</span> str<span class="op">)</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Server <span class="op">{</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>        Server<span class="op">();</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> RequireStringAsync<span class="op">(</span>ClientIF<span class="op">&amp;</span> client<span class="op">)</span> <span class="kw">noexcept</span><span class="op">;</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace ServerOK</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/solid/dip_server_ok.cpp 5</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> ServerOK <span class="op">{</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> <span class="op">{</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> dispatch<span class="op">(</span>ClientIF<span class="op">&amp;</span> client<span class="op">)</span>  <span class="co">// コマンドのディスパッチ</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">switch</span> <span class="op">(</span>client<span class="op">.</span>GetNum<span class="op">())</span> <span class="op">{</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="dv">1</span><span class="op">:</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>            client<span class="op">.</span>Done<span class="op">(</span><span class="kw">new</span> <span class="bu">std::</span>string<span class="op">{</span><span class="st">&quot;hello&quot;</span><span class="op">});</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span><span class="op">;</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="dv">2</span><span class="op">:</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>            client<span class="op">.</span>Done<span class="op">(</span><span class="kw">new</span> <span class="bu">std::</span>string<span class="op">{</span><span class="st">&quot;good bye&quot;</span><span class="op">});</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span><span class="op">;</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>            <span class="op">...</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> thread_entry<span class="op">(</span>Pipe<span class="op">&amp;</span> pipe<span class="op">)</span>  <span class="co">// サーバーのスレッド関数</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(;;)</span> <span class="op">{</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>            ClientIF<span class="op">*</span>  client<span class="op">{</span><span class="kw">nullptr</span><span class="op">};</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> <span class="at">const</span> ret <span class="op">=</span> pipe<span class="op">.</span>Read<span class="op">(&amp;</span>client<span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>client<span class="op">));</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>            <span class="ot">assert</span><span class="op">(</span>ret <span class="op">==</span> <span class="kw">sizeof</span><span class="op">(</span>client<span class="op">));</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>client <span class="op">==</span> <span class="kw">nullptr</span><span class="op">)</span> <span class="op">{</span>  <span class="co">// nullptr受信でサーバー終了</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span><span class="op">;</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>            dispatch<span class="op">(*</span>client<span class="op">);</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace</span></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> Server<span class="op">::</span>RequireStringAsync<span class="op">(</span>ClientIF<span class="op">&amp;</span> client<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> <span class="at">const</span><span class="op">*</span> <span class="at">const</span> buff<span class="op">{&amp;</span>client<span class="op">};</span></span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> ret <span class="op">=</span> <span class="va">pipe_</span><span class="op">.</span>Write<span class="op">(&amp;</span>buff<span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>buff<span class="op">));</span></span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>        <span class="ot">assert</span><span class="op">(</span>ret <span class="op">==</span> <span class="kw">sizeof</span><span class="op">(&amp;</span>client<span class="op">));</span></span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span></span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace ServerOK</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/solid/dip_client_ok.h 10</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> ClientOK <span class="op">{</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Client <span class="op">:</span> <span class="kw">public</span> ServerOK<span class="op">::</span>ClientIF <span class="op">{</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> Client<span class="op">(</span>ServerOK<span class="op">::</span>Server<span class="op">&amp;</span> server<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">:</span> ClientIF<span class="op">{},</span> <span class="va">server_</span><span class="op">{</span>server<span class="op">},</span> <span class="va">pipe_</span><span class="op">{}</span> <span class="op">{}</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span>GetString<span class="op">(</span><span class="dt">uint32_t</span> num<span class="op">);</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace ClientOK</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/solid/dip_client_ok.cpp 3</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> ClientOK <span class="op">{</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>string<span class="op"> </span>Client<span class="op">::</span>GetString<span class="op">(</span><span class="dt">uint32_t</span> num<span class="op">)</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>        SetNum<span class="op">(</span>num<span class="op">);</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">server_</span><span class="op">.</span>RequireStringAsync<span class="op">(*</span><span class="kw">this</span><span class="op">);</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="op">*</span>wait_done<span class="op">();</span>  <span class="co">// 非同期通知待ち</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;</span> Client<span class="op">::</span>wait_done<span class="op">()</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op">*</span> str<span class="op">{</span><span class="kw">nullptr</span><span class="op">};</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> <span class="at">const</span>   ret <span class="op">=</span> <span class="va">pipe_</span><span class="op">.</span>Read<span class="op">(&amp;</span>str<span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>str<span class="op">));</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>        <span class="ot">assert</span><span class="op">(</span>ret <span class="op">==</span> <span class="kw">sizeof</span><span class="op">(</span>str<span class="op">));</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;{</span>str<span class="op">};</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace ClientOK</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/solid/dip_ut.cpp 28</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 使用方法は、ServerNG, ClientNGと同じ。</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    TEST<span class="op">(</span>DIP<span class="op">,</span> ok_pattern<span class="op">)</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> server <span class="op">=</span> ServerOK<span class="op">::</span>Server<span class="op">{};</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> client <span class="op">=</span> ClientOK<span class="op">::</span>Client<span class="op">{</span>server<span class="op">};</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 以下、ng_paternと同じ</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>修正後のコードは、</p>
<ul>
<li>ServerOK::ServerはServerOK::ClientIFに依存する。</li>
<li>ClientOK::ClientはServerOK::ClientIFから派生する。</li>
</ul>
<p>このクラス図を以下に示す。</p>
<p>
<img src="data:image/png;base64,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" />
</p>
<p>ServerNGとClientNGの双方向依存関係は、ClientOKからServerOKへの単方向依存関係へと改善され、
サーバに影響を与えることなく、クライアントの機能変更やバリエーション追加を行うことが可能となった。</p>
<h2 id="まとめ">まとめ <a id="SS_1_6"></a></h2>
<p>以上で述べたように、SOLIDはオブジェクト指向(OOD/OOP)プログラミングにおいて極めて重要な原則である。
この逸脱はソースコードを劣化させ、ソフトウェアの品質低下や開発費増大に直結するため、
厳守することが求められる。</p>
<!-- ./md/design_pattern.md -->
<h1 id="デザインパターン">デザインパターン <a id="SS_2"></a></h1>
<p>ソースコードを劣化させるアンチパターンには、</p>
<ul>
<li>大きすぎる関数、クラス、ファイル等のソフトウェア構成物</li>
<li>複雑怪奇な依存関係</li>
<li>コードクローン</li>
</ul>
<p>等があるだろう。
こういった問題は、ひどいソースコードを書かないという強い意志を持ったプログラマの不断の努力と、
そのプログラマを支えるソフトウェア工学に基づいた知識によって回避可能である。
本章ではその知識の一翼をになうデザインパターン、イデオム等を解説、例示する。</p>
<p>なお、ここに挙げるデザインパターン、イデオム等は「適切な場所に適用される場合、
ソースコードをよりシンプルに記述できる」というメリットがある一方で、
「不適切な場所に適用される場合、ソースコードの複雑度を不要に上げてしまう」
という負の一面を持つ。</p>
<p>また、デザインパターン、イデオム等を覚えたてのプログラマは、
自分のスキルが上がったという一種の高揚感や顕示欲を持つため、
それをむやみやたらに多用してしまう状態に陥ることある。このようなプログラマの状態を</p>
<ul>
<li>パターン病に罹患した</li>
<li>パターン猿になった、もしくは単に、猿になった</li>
</ul>
<p>と呼ぶ。
猿になり不要に複雑なソースコードを書かないために、デザインパターン、イデオム等を使用する場合、
本当にそれが必要か吟味し、不要な場所への適用を避けなければならない。</p>
<h2 id="ガード節">ガード節 <a id="SS_2_1"></a></h2>
<p>ガード節とは、
「可能な場合、処理を早期に打ち切るために関数やループの先頭に配置される短い条件文(通常はif文)」
であり、以下のような利点がある。</p>
<ul>
<li>処理の打ち切り条件が明確になる。</li>
<li>関数やループのネストが少なくなる。</li>
</ul>
<p>まずは、ガード節を使っていない例を上げる。</p>
<div class="sourceCode" id="cb21"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/guard_ut.cpp 24</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@fn</span><span class="co"> </span><span class="do">int32_t</span><span class="co"> </span><span class="do">SequentialA(char</span><span class="co"> </span><span class="do">const</span><span class="co"> </span><span class="do">(&amp;a)[3])</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@brief</span><span class="co"> a(配列へのリファレンス)の要素について、先頭から&#39;a&#39;が続く数を返す</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@param</span><span class="co"> </span><span class="cv">配列へのリファレンス</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int32_t</span> SequentialA<span class="op">(</span><span class="dt">char</span> <span class="at">const</span> <span class="op">(&amp;</span>a<span class="op">)[</span><span class="dv">3</span><span class="op">])</span> <span class="kw">noexcept</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>a<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">==</span> <span class="ch">&#39;a&#39;</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>a<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">==</span> <span class="ch">&#39;a&#39;</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="op">(</span>a<span class="op">[</span><span class="dv">2</span><span class="op">]</span> <span class="op">==</span> <span class="ch">&#39;a&#39;</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>上記の例を読んで一目で何が行われているか、理解できる人は稀である。
一方で、上記と同じロジックである下記関数を一目で理解できない人も稀である。</p>
<div class="sourceCode" id="cb22"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/guard_ut.cpp 78</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int32_t</span> SequentialA<span class="op">(</span><span class="dt">char</span> <span class="at">const</span> <span class="op">(&amp;</span>a<span class="op">)[</span><span class="dv">3</span><span class="op">])</span> <span class="kw">noexcept</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>a<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">!=</span> <span class="ch">&#39;a&#39;</span><span class="op">)</span> <span class="op">{</span>  <span class="co">// ガード節</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>a<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">!=</span> <span class="ch">&#39;a&#39;</span><span class="op">)</span> <span class="op">{</span>  <span class="co">// ガード節</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>a<span class="op">[</span><span class="dv">2</span><span class="op">]</span> <span class="op">!=</span> <span class="ch">&#39;a&#39;</span><span class="op">)</span> <span class="op">{</span>  <span class="co">// ガード節</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>ここまで効果的な例はあまりない。</p>
<p>もう一例、(ガード節導入の効果が前例ほど明確でない)ガード節を使っていないコードを示す。</p>
<div class="sourceCode" id="cb23"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/guard_ut.cpp 49</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>optional<span class="op">&lt;</span><span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">uint32_t</span><span class="op">&gt;&gt;</span> PrimeNumbers<span class="op">(</span><span class="dt">uint32_t</span> max_num<span class="op">)</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> result <span class="op">=</span> <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">uint32_t</span><span class="op">&gt;{};</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>max_num <span class="op">&lt;</span> <span class="dv">65536</span><span class="op">)</span> <span class="op">{</span>  <span class="co">// 演算コストが高いためエラーにする</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>max_num <span class="op">&gt;=</span> <span class="dv">2</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>                <span class="kw">auto</span> is_num_prime <span class="op">=</span> <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">bool</span><span class="op">&gt;(</span>max_num <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> <span class="kw">true</span><span class="op">);</span>  <span class="co">// falseなら素数でない</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>                is_num_prime<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> is_num_prime<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>                <span class="kw">auto</span> prime_num                    <span class="op">=</span> <span class="dv">2</span><span class="bu">U</span><span class="op">;</span>  <span class="co">// 最初の素数</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>                <span class="cf">do</span> <span class="op">{</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>                    result<span class="op">.</span>emplace_back<span class="op">(</span>prime_num<span class="op">);</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>                    prime_num <span class="op">=</span> next_prime_num<span class="op">(</span>prime_num<span class="op">,</span> is_num_prime<span class="op">);</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span> <span class="cf">while</span> <span class="op">(</span>prime_num <span class="op">&lt;</span> is_num_prime<span class="op">.</span>size<span class="op">());</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> result<span class="op">;</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">std::</span>nullopt<span class="op">;</span></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>上記にガード節を適用した例を下記する。</p>
<div class="sourceCode" id="cb24"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/guard_ut.cpp 95</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>optional<span class="op">&lt;</span><span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">uint32_t</span><span class="op">&gt;&gt;</span> PrimeNumbers<span class="op">(</span><span class="dt">uint32_t</span> max_num<span class="op">)</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>max_num <span class="op">&gt;=</span> <span class="dv">65536</span><span class="op">)</span> <span class="op">{</span>  <span class="co">// ガード節。演算コストが高いためエラーにする。</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="bu">std::</span>nullopt<span class="op">;</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> result <span class="op">=</span> <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">uint32_t</span><span class="op">&gt;{};</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>max_num <span class="op">&lt;</span> <span class="dv">2</span><span class="op">)</span> <span class="op">{</span>  <span class="co">// ガード節。2未満の素数はない。</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> result<span class="op">;</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> is_num_prime <span class="op">=</span> <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">bool</span><span class="op">&gt;(</span>max_num <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> <span class="kw">true</span><span class="op">);</span>  <span class="co">// falseなら素数でない。</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>        is_num_prime<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> is_num_prime<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> prime_num                    <span class="op">=</span> <span class="dv">2</span><span class="bu">U</span><span class="op">;</span>  <span class="co">// 最初の素数</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">do</span> <span class="op">{</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>            result<span class="op">.</span>emplace_back<span class="op">(</span>prime_num<span class="op">);</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>            prime_num <span class="op">=</span> next_prime_num<span class="op">(</span>prime_num<span class="op">,</span> is_num_prime<span class="op">);</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span> <span class="cf">while</span> <span class="op">(</span>prime_num <span class="op">&lt;</span> is_num_prime<span class="op">.</span>size<span class="op">());</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> result<span class="op">;</span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>ガード節を使っていない例に比べて、</p>
<ul>
<li>ネストが減って読みやすくなった</li>
<li>max_numが1, 2, 65535,
65536である場合がロジックの境界値であることが一目でわかるようになった</li>
</ul>
<p>といった改善はされたものの、最初の例ほどのレベル差はない。
しかし、ソースコードの改善やリファクタリングのほとんどは、このようなものであり、
この少しのレベルアップが数か月後、数年後に大きな差を生み出すことを忘れてはならない。</p>
<h2 id="bitmasktype">BitmaskType <a id="SS_2_2"></a></h2>
<p>下記のようなビットマスク表現は誤用しやすいインターフェースである。
修正や拡張等に関しても脆弱であるため、避けるべきである。</p>
<div class="sourceCode" id="cb25"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/enum_operator.h 6</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Animal <span class="op">{</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">struct</span> PhisicalAbility <span class="op">{</span>  <span class="co">// オブジェクトの状態を表すためのビットマスク</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">static</span> <span class="kw">constexpr</span> <span class="kw">auto</span> Run  <span class="op">=</span> <span class="bn">0b0001</span><span class="bu">U</span><span class="op">;</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">static</span> <span class="kw">constexpr</span> <span class="kw">auto</span> Fly  <span class="op">=</span> <span class="bn">0b0010</span><span class="bu">U</span><span class="op">;</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">static</span> <span class="kw">constexpr</span> <span class="kw">auto</span> Swim <span class="op">=</span> <span class="bn">0b0100</span><span class="bu">U</span><span class="op">;</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">};</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>        <span class="co">// paにはPhisicalAbilityのみを受け入れたいが、実際にはすべてのuint32_tを受け入れる。</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> Animal<span class="op">(</span><span class="dt">uint32_t</span> pa<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">:</span> <span class="va">phisical_ability_</span><span class="op">{</span>pa<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>        <span class="dt">uint32_t</span> GetPhisicalAbility<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">phisical_ability_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb26"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/enum_operator_ut.cpp 13</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    Animal dolphin<span class="op">{</span>Animal<span class="op">::</span>PhisicalAbility<span class="op">::</span>Swim<span class="op">};</span>  <span class="co">// OK</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>Animal<span class="op">::</span>PhisicalAbility<span class="op">::</span>Swim<span class="op">,</span> dolphin<span class="op">.</span>GetPhisicalAbility<span class="op">());</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    Animal uma<span class="op">{</span><span class="bn">0xff</span><span class="op">};</span>  <span class="co">// NG 誤用だが、コンストラクタの仮引数の型がuint32_tなのでコンパイル可能</span></span></code></pre></div>
<p>上記のような誤用を防ぐために、
enumによるビットマスク表現を使用して型チェックを強化した例を以下に示す。
このテクニックは、STLのインターフェースとしても使用されている強力なイデオムである。</p>
<div class="sourceCode" id="cb27"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/enum_operator.h 30</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Animal <span class="op">{</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">enum</span> <span class="kw">class</span> PhisicalAbility <span class="op">:</span> <span class="dt">uint32_t</span> <span class="op">{</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>            Run  <span class="op">=</span> <span class="bn">0b0001</span><span class="op">,</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>            Fly  <span class="op">=</span> <span class="bn">0b0010</span><span class="op">,</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>            Swim <span class="op">=</span> <span class="bn">0b0100</span><span class="op">,</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">};</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> Animal<span class="op">(</span>PhisicalAbility pa<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">:</span> <span class="va">phisical_ability_</span><span class="op">{</span>pa<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>        PhisicalAbility GetPhisicalAbility<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">phisical_ability_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>        PhisicalAbility <span class="at">const</span> <span class="va">phisical_ability_</span><span class="op">;</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>    <span class="co">// &amp;, | &amp;=, |=, IsTrue, IsFalseの定義</span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> Animal<span class="op">::</span>PhisicalAbility <span class="kw">operator</span><span class="op">&amp;(</span>Animal<span class="op">::</span>PhisicalAbility x<span class="op">,</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>                                                Animal<span class="op">::</span>PhisicalAbility y<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">static_cast</span><span class="op">&lt;</span>Animal<span class="op">::</span>PhisicalAbility<span class="op">&gt;(</span><span class="kw">static_cast</span><span class="op">&lt;</span><span class="dt">uint32_t</span><span class="op">&gt;(</span>x<span class="op">)</span></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>                                                    <span class="op">&amp;</span> <span class="kw">static_cast</span><span class="op">&lt;</span><span class="dt">uint32_t</span><span class="op">&gt;(</span>y<span class="op">));</span></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> Animal<span class="op">::</span>PhisicalAbility <span class="kw">operator</span><span class="op">|(</span>Animal<span class="op">::</span>PhisicalAbility x<span class="op">,</span></span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>                                                Animal<span class="op">::</span>PhisicalAbility y<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">static_cast</span><span class="op">&lt;</span>Animal<span class="op">::</span>PhisicalAbility<span class="op">&gt;(</span><span class="kw">static_cast</span><span class="op">&lt;</span><span class="dt">uint32_t</span><span class="op">&gt;(</span>x<span class="op">)</span></span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>                                                    <span class="op">|</span> <span class="kw">static_cast</span><span class="op">&lt;</span><span class="dt">uint32_t</span><span class="op">&gt;(</span>y<span class="op">));</span></span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>    <span class="kw">inline</span> Animal<span class="op">::</span>PhisicalAbility<span class="op">&amp;</span> <span class="kw">operator</span><span class="op">&amp;=(</span>Animal<span class="op">::</span>PhisicalAbility<span class="op">&amp;</span> x<span class="op">,</span></span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>                                               Animal<span class="op">::</span>PhisicalAbility  y<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> x <span class="op">=</span> x <span class="op">&amp;</span> y<span class="op">;</span></span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span></span></code></pre></div>
<div class="sourceCode" id="cb28"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/enum_operator_ut.cpp 28</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// コンストラクタの仮引数の型が厳密になったためコンパイル不可</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// これにより誤用を防ぐ</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Animal uma{0xff};</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">// C++17から下記はコンパイル可能となったが、アクシデントでこのようなミスはしないだろう</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> uma <span class="op">=</span> Animal<span class="op">{</span>Animal<span class="op">::</span>PhisicalAbility<span class="op">{</span><span class="bn">0xff</span><span class="op">}};</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> dolphin <span class="op">=</span> Animal<span class="op">{</span>Animal<span class="op">::</span>PhisicalAbility<span class="op">::</span>Swim<span class="op">};</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>Animal<span class="op">::</span>PhisicalAbility<span class="op">::</span>Swim<span class="op">,</span> dolphin<span class="op">.</span>GetPhisicalAbility<span class="op">());</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> pa <span class="op">=</span> Animal<span class="op">::</span>PhisicalAbility<span class="op">{</span>Animal<span class="op">::</span>PhisicalAbility<span class="op">::</span>Run<span class="op">};</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>    pa <span class="op">|=</span> Animal<span class="op">::</span>PhisicalAbility<span class="op">::</span>Swim<span class="op">;</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> human <span class="op">=</span> Animal<span class="op">{</span>pa<span class="op">};</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>    ASSERT_TRUE<span class="op">(</span>IsTrue<span class="op">(</span>Animal<span class="op">::</span>PhisicalAbility<span class="op">::</span>Run <span class="op">&amp;</span> human<span class="op">.</span>GetPhisicalAbility<span class="op">()));</span></span></code></pre></div>
<p>この改善により、Animalのコンストラクタに域値外の値を渡すことは困難になった
(少なくとも不注意で間違うことはないだろう)。
この修正の延長で、Animal::GetPhisicalAbility()の戻り値もenumになり、これも誤用が難しくなった。</p>
<h2 id="pimpl">Pimpl <a id="SS_2_3"></a></h2>
<p>このパターンは、「クラスA(a.cpp、a.hで宣言、定義)を使用するクラスにAの実装の詳細を伝搬させたくない」
ような場合に使用する。 そのため<a
href="#SS_1_2">オープン・クローズドの原則(OCP)</a>の実装方法としても有用である。</p>
<p>一般的に、STLライブラリのパースは多くのCPUタイムを消費する。
クラスAがSTLクラスをメンバに使用し、a.hにそのSTLヘッダファイルがインクルードされた場合、
a.hをインクルードするファイルをコンパイルする度にそのSTLヘッダファイルはパースされる。
これはさらに多くのCPUタイムの消費につながり、ソースコード全体のビルドは遅くなる。
こういった問題をあらかじめ避けるためにも有効な手段ではあるが、
そのトレードオフとして実行速度は若干遅くなる。</p>
<p>下記は、Pimplイデオム未使用の、std::stringに依存したクラスStringHolderOldの例である。</p>
<div class="sourceCode" id="cb29"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/string_holder_old.h 3</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">// このファイルには&lt;string&gt;が必要</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#include </span><span class="im">&lt;memory&gt;</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#include </span><span class="im">&lt;string&gt;</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> StringHolderOld <span class="kw">final</span> <span class="op">{</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>        StringHolderOld<span class="op">();</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span>        Add<span class="op">(</span><span class="dt">char</span> <span class="at">const</span><span class="op">*</span> str<span class="op">);</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>        <span class="dt">char</span> <span class="at">const</span><span class="op">*</span> GetStr<span class="op">()</span> <span class="at">const</span><span class="op">;</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;</span> <span class="va">str_</span><span class="op">;</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb30"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/string_holder_old.cpp 1</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#include </span><span class="im">&quot;string_holder_old.h&quot;</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    StringHolderOld<span class="op">::</span>StringHolderOld<span class="op">()</span> <span class="op">:</span> <span class="va">str_</span><span class="op">{</span><span class="bu">std::</span>make_unique<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;()}</span> <span class="op">{}</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> StringHolderOld<span class="op">::</span>Add<span class="op">(</span><span class="dt">char</span> <span class="at">const</span><span class="op">*</span> str<span class="op">)</span> <span class="op">{</span> <span class="op">*</span><span class="va">str_</span> <span class="op">+=</span> str<span class="op">;</span> <span class="op">}</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> <span class="at">const</span><span class="op">*</span> StringHolderOld<span class="op">::</span>GetStr<span class="op">()</span> <span class="at">const</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">str_</span><span class="op">-&gt;</span>c_str<span class="op">();</span> <span class="op">}</span></span></code></pre></div>
<p>下記は、上記クラスStringHolderOldにPimplイデオムを適用したクラスStringHolderNewの例である。</p>
<div class="sourceCode" id="cb31"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/string_holder_new.h 3</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">// このファイルには&lt;string&gt;は不要</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#include </span><span class="im">&lt;memory&gt;</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> StringHolderNew <span class="kw">final</span> <span class="op">{</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>        StringHolderNew<span class="op">();</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span>        Add<span class="op">(</span><span class="dt">char</span> <span class="at">const</span><span class="op">*</span> str<span class="op">);</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>        <span class="dt">char</span> <span class="at">const</span><span class="op">*</span> GetStr<span class="op">()</span> <span class="at">const</span><span class="op">;</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">~</span>StringHolderNew<span class="op">();</span>  <span class="co">// デストラクタは.cppで=defaultで定義</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">class</span> StringHolderNewCore<span class="op">;</span>  <span class="co">// StringHolderNewの振る舞いは、StringHolderNewCoreに移譲</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>StringHolderNewCore<span class="op">&gt;</span> <span class="va">core_</span><span class="op">;</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb32"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/string_holder_new.cpp 1</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">// このファイルには&lt;string&gt;が必要</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#include </span><span class="im">&lt;string&gt;</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#include </span><span class="im">&quot;string_holder_new.h&quot;</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> StringHolderNew<span class="op">::</span>StringHolderNewCore <span class="kw">final</span> <span class="op">{</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>        StringHolderNewCore<span class="op">()</span> <span class="op">=</span> <span class="cf">default</span><span class="op">;</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> Add<span class="op">(</span><span class="dt">char</span> <span class="at">const</span><span class="op">*</span> str<span class="op">)</span> <span class="op">{</span> <span class="va">str_</span> <span class="op">+=</span> str<span class="op">;</span> <span class="op">}</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>        <span class="dt">char</span> <span class="at">const</span><span class="op">*</span> GetStr<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">str_</span><span class="op">.</span>c_str<span class="op">();</span> <span class="op">}</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span><span class="va">str_</span><span class="op">{};</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>    StringHolderNew<span class="op">::</span>StringHolderNew<span class="op">()</span> <span class="op">:</span> <span class="va">core_</span><span class="op">{</span><span class="bu">std::</span>make_unique<span class="op">&lt;</span>StringHolderNewCore<span class="op">&gt;()}</span> <span class="op">{}</span></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> StringHolderNew<span class="op">::</span>Add<span class="op">(</span><span class="dt">char</span> <span class="at">const</span><span class="op">*</span> str<span class="op">)</span> <span class="op">{</span> <span class="va">core_</span><span class="op">-&gt;</span>Add<span class="op">(</span>str<span class="op">);</span> <span class="op">}</span></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> <span class="at">const</span><span class="op">*</span> StringHolderNew<span class="op">::</span>GetStr<span class="op">()</span> <span class="at">const</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">core_</span><span class="op">-&gt;</span>GetStr<span class="op">();</span> <span class="op">}</span></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>    <span class="co">// この宣言、定義をしないと、StringHolderNewをインスタンス化した場所では、</span></span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>    <span class="co">// StringHolderNewCoreが不完全型であるため、std::unique_ptrが実体化できず、コンパイルエラーとなる。</span></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>    <span class="co">// この場所であれば、StringHolderNewCoreは完全型であるためstd::unique_ptrが実体化できる。</span></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>    StringHolderNew<span class="op">::~</span>StringHolderNew<span class="op">()</span> <span class="op">=</span> <span class="cf">default</span><span class="op">;</span></span></code></pre></div>
<p>下記図は、上記ファイルやそれらを使用するファイルの依存関係である。
string_holder_old.hは、std::stringに依存しているが、string_holder_new.hは、
std::stringに依存していないこと、
それによってStringHolderNewを使用するファイルから、std::stringへの依存を排除できていることがわかる。</p>
<p>
<img src="data:image/png;base64,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" />
</p>
<p>このパターンを使用して問題のある依存関係をリファクタリングする例を示す。</p>
<p>まずは、リファクタリング前のコードを下記する。</p>
<div class="sourceCode" id="cb33"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// in lib/h/widget.h</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#include </span><span class="im">&quot;gtest/gtest.h&quot;</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Widget <span class="op">{</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span>     DoSomething<span class="op">();</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>        <span class="dt">uint32_t</span> GetValue<span class="op">()</span> <span class="at">const</span><span class="op">;</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 何らかの宣言</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>        <span class="dt">uint32_t</span> gen_xxx_data<span class="op">(</span><span class="dt">uint32_t</span> a<span class="op">);</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>        <span class="dt">uint32_t</span> <span class="va">xxx_data_</span><span class="op">{</span><span class="dv">1</span><span class="op">};</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>        FRIEND_TEST<span class="op">(</span>Pimpl<span class="op">,</span> widget_ng<span class="op">);</span>  <span class="co">// 単体テストをfriendにする</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb34"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// in lib/src/widget.cpp</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#include </span><span class="im">&quot;widget.h&quot;</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> Widget<span class="op">::</span>DoSomething<span class="op">()</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 何らかの処理</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">xxx_data_</span> <span class="op">=</span> gen_xxx_data<span class="op">(</span><span class="va">xxx_data_</span><span class="op">);</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">uint32_t</span> Widget<span class="op">::</span>GetValue<span class="op">()</span> <span class="at">const</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">xxx_data_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>    <span class="dt">uint32_t</span> WidgetNG<span class="op">::</span>Widget<span class="op">::</span>gen_xxx_data<span class="op">(</span><span class="dt">uint32_t</span> a<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> a <span class="op">*</span> <span class="dv">3</span><span class="op">;</span> <span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb35"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// in lib/ut/widget_ut.cpp</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#include </span><span class="im">&quot;widget.h&quot;</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    TEST<span class="op">(</span>Pimpl<span class="op">,</span> widget_ng<span class="op">)</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>        Widget w<span class="op">;</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="dv">1</span><span class="op">,</span> w<span class="op">.</span><span class="va">xxx_data_</span><span class="op">);</span>  <span class="co">// privateのテスト</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>        w<span class="op">.</span>DoSomething<span class="op">();</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="dv">3</span><span class="op">,</span> w<span class="op">.</span><span class="va">xxx_data_</span><span class="op">);</span>        <span class="co">// privateのテスト</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="dv">9</span><span class="op">,</span> w<span class="op">.</span>gen_xxx_data<span class="op">(</span><span class="dv">3</span><span class="op">));</span>  <span class="co">// privateのテスト</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="dv">3</span><span class="op">,</span> w<span class="op">.</span>GetValue<span class="op">());</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>何らかの事情により、単体テストでprivateなメンバにアクセスする必要があったため、
単体テストクラスをテスト対象クラスのfriendすることで、それを実現している。</p>
<p>単体テストクラスをテスト対象クラスのfriendにするためには、
上記コードの抜粋である下記を記述する必要がある。</p>
<div class="sourceCode" id="cb36"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>        FRIEND_TEST<span class="op">(</span>Pimpl<span class="op">,</span> widget_ng<span class="op">);</span>  <span class="co">// 単体テストをfriendにする</span></span></code></pre></div>
<p>このマクロは、gtest.h内で定義されているため、widget.hからgtest.hをインクルードしている。</p>
<p>このため、ファイルの依存関係は下記のようになる。</p>
<p>
<img src="data:image/png;base64,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" />
</p>
<p>この依存関係は、Widgetのクライアントに不要な依存関係を強要してしまう問題のある構造を作り出す。</p>
<p>この問題をPimplによるリファクタリングで解決したコードを以下に示す
(コンパイラのインクルードパスにはlib/hのみが入っていることを前提とする)。</p>
<div class="sourceCode" id="cb37"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// in lib/h/widget.h</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#include </span><span class="im">&lt;memory&gt;</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Widget <span class="op">{</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>        Widget<span class="op">();</span>   <span class="co">// widget_pimplは不完全型であるため、コンストラクタ、</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">~</span>Widget<span class="op">();</span>  <span class="co">// デストラクタはインラインにできない</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span>     DoSomething<span class="op">();</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">uint32_t</span> GetValue<span class="op">()</span> <span class="at">const</span><span class="op">;</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 何らかの宣言</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>        <span class="kw">struct</span> widget_pimpl<span class="op">;</span>  <span class="co">// 単体テストのため、publicとするが、実装はsrc/の下に置くため、</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>                              <span class="co">// 単体テスト以外の外部からのアクセスはできない</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>widget_pimpl<span class="op">&gt;</span> <span class="va">widget_pimpl_</span><span class="op">;</span></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb38"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// in lib/src/widget.cpp</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#include </span><span class="im">&quot;widget_internal.h&quot;</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// widget_pimpl</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> Widget<span class="op">::</span>widget_pimpl<span class="op">::</span>DoSomething<span class="op">()</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 何らかの処理</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">xxx_data_</span> <span class="op">=</span> gen_xxx_data<span class="op">(</span><span class="va">xxx_data_</span><span class="op">);</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>    <span class="dt">uint32_t</span> Widget<span class="op">::</span>widget_pimpl<span class="op">::</span>gen_xxx_data<span class="op">(</span><span class="dt">uint32_t</span> a<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> a <span class="op">*</span> <span class="dv">3</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Widget</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span>     Widget<span class="op">::</span>DoSomething<span class="op">()</span> <span class="op">{</span> <span class="va">widget_pimpl_</span><span class="op">-&gt;</span>DoSomething<span class="op">();</span> <span class="op">}</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>    <span class="dt">uint32_t</span> Widget<span class="op">::</span>GetValue<span class="op">()</span> <span class="at">const</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">widget_pimpl_</span><span class="op">-&gt;</span><span class="va">xxx_data_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ヘッダファイルの中では、widget_pimplは不完全型であるため、コンストラクタ、</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>    <span class="co">// デストラクタは下記に定義する</span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>    Widget<span class="op">::</span>Widget<span class="op">()</span> <span class="op">:</span> <span class="va">widget_pimpl_</span><span class="op">{</span><span class="bu">std::</span>make_unique<span class="op">&lt;</span>Widget<span class="op">::</span>widget_pimpl<span class="op">&gt;()}</span> <span class="op">{}</span></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>    Widget<span class="op">::~</span>Widget<span class="op">()</span> <span class="op">=</span> <span class="cf">default</span><span class="op">;</span></span></code></pre></div>
<div class="sourceCode" id="cb39"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// in lib/src/widget_internal.h</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#include </span><span class="im">&quot;widget.h&quot;</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> Widget<span class="op">::</span>widget_pimpl <span class="op">{</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span>     DoSomething<span class="op">();</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">uint32_t</span> gen_xxx_data<span class="op">(</span><span class="dt">uint32_t</span> a<span class="op">);</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>        <span class="dt">uint32_t</span> <span class="va">xxx_data_</span><span class="op">{</span><span class="dv">1</span><span class="op">};</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb40"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// in lib/ut/widget_ut.cpp</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#include </span><span class="im">&quot;../src/widget_internal.h&quot;</span><span class="pp">  </span><span class="co">// 単体テストのみに、このようなインクルードを認める</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#include </span><span class="im">&quot;gtest/gtest.h&quot;</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    TEST<span class="op">(</span>Pimpl<span class="op">,</span> widget_ok<span class="op">)</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>        Widget<span class="op">::</span>widget_pimpl wi<span class="op">;</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="dv">1</span><span class="op">,</span> wi<span class="op">.</span><span class="va">xxx_data_</span><span class="op">);</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>        wi<span class="op">.</span>DoSomething<span class="op">();</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="dv">3</span><span class="op">,</span> wi<span class="op">.</span><span class="va">xxx_data_</span><span class="op">);</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="dv">9</span><span class="op">,</span> wi<span class="op">.</span>gen_xxx_data<span class="op">(</span><span class="dv">3</span><span class="op">));</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>        Widget w<span class="op">;</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>        w<span class="op">.</span>DoSomething<span class="op">();</span></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="dv">3</span><span class="op">,</span> w<span class="op">.</span>GetValue<span class="op">());</span></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>このリファクタリングにより、ファイルの依存は下記のようになり、
問題のある構造は解消された。</p>
<p>
<img src="data:image/png;base64,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" />
</p>
<h2 id="accessor">Accessor <a id="SS_2_4"></a></h2>
<p>publicメンバ変数とそれにアクセスするソースコードは典型的なアンチパターンであるため、
このようなコードを禁じるのが一般的なプラクティスである。</p>
<div class="sourceCode" id="cb41"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/accessor_ut.cpp 8</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> A <span class="op">{</span>  <span class="co">// アンチパターン</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span> <span class="va">a_</span><span class="op">{</span><span class="dv">0</span><span class="op">};</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> f<span class="op">(</span>A<span class="op">&amp;</span> a<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>        a<span class="op">.</span><span class="va">a_</span> <span class="op">=</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Do something</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>とはいえ、ソフトウェアのプラクティスには必ずといってほど例外があり、
製品開発の現場において、オブジェクトのメンバ変数にアクセスせざるを得ないような場面は、
稀にではあるが発生する。
このような場合に適用するがのこのイデオムである。</p>
<div class="sourceCode" id="cb42"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/accessor_ut.cpp 28</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> A <span class="op">{</span>  <span class="co">// Accessorの実装例</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> SetA<span class="op">(</span><span class="dt">int32_t</span> a<span class="op">)</span> <span class="kw">noexcept</span>  <span class="co">// setter</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>            <span class="va">a_</span> <span class="op">=</span> a<span class="op">;</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span> GetA<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span>  <span class="co">// getter</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">a_</span><span class="op">;</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span> <span class="va">a_</span><span class="op">{</span><span class="dv">0</span><span class="op">};</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> f<span class="op">(</span>A<span class="op">&amp;</span> a<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>        a<span class="op">.</span>SetA<span class="op">(</span><span class="dv">3</span><span class="op">);</span></span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Do something</span></span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>メンバ変数への直接のアクセスに比べ、以下のようなメリットがある。</p>
<ul>
<li>アクセスのログを入れることができる。</li>
<li>メンバ変数へのアクセスをデバッガで捕捉しやすくなる。</li>
<li>setterに都合の悪い値が渡された場合、何らかの手段を取ることができる(assertや、エラー処理)。</li>
<li>リファクタリングや機能修正により対象のメンバ変数がなくなった場合においても、
クラスのインターフェースの変更を回避できる(修正箇所を局所化できる)。</li>
</ul>
<p>一方で、クラスに対するこのような細かい制御は、カプセル化に対して問題を起こしやすい。
下記はその典型的なアンチパターンである。</p>
<div class="sourceCode" id="cb43"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/accessor_ut.cpp 62</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> A <span class="op">{</span>  <span class="co">// Accessorを使用して細かすぎる制御をしてしまうアンチパターン</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> SetA<span class="op">(</span><span class="dt">int32_t</span> a<span class="op">)</span> <span class="kw">noexcept</span>  <span class="co">// setter</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>            <span class="va">a_</span> <span class="op">=</span> a<span class="op">;</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span> GetA<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span>  <span class="co">// getter</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">a_</span><span class="op">;</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> Change<span class="op">(</span><span class="dt">bool</span> is_changed<span class="op">)</span> <span class="kw">noexcept</span>  <span class="co">// setter</span></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>            <span class="va">is_changed_</span> <span class="op">=</span> is_changed<span class="op">;</span></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>        <span class="dt">bool</span> IsChanged<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span>  <span class="co">// getter</span></span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">is_changed_</span><span class="op">;</span></span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> DoSomething<span class="op">()</span> <span class="kw">noexcept</span>  <span class="co">// is_changed_がtrueの時に、呼び出してほしい</span></span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Do something</span></span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a>            <span class="op">...</span></span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> f<span class="op">(</span>A<span class="op">&amp;</span> a<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb43-35"><a href="#cb43-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>a<span class="op">.</span>GetA<span class="op">()</span> <span class="op">!=</span> <span class="dv">3</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb43-36"><a href="#cb43-36" aria-hidden="true" tabindex="-1"></a>            a<span class="op">.</span>SetA<span class="op">(</span><span class="dv">3</span><span class="op">);</span></span>
<span id="cb43-37"><a href="#cb43-37" aria-hidden="true" tabindex="-1"></a>            a<span class="op">.</span>Change<span class="op">(</span><span class="kw">true</span><span class="op">);</span></span>
<span id="cb43-38"><a href="#cb43-38" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb43-39"><a href="#cb43-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-40"><a href="#cb43-40" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb43-41"><a href="#cb43-41" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb43-42"><a href="#cb43-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-43"><a href="#cb43-43" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> g<span class="op">(</span>A<span class="op">&amp;</span> a<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb43-44"><a href="#cb43-44" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb43-45"><a href="#cb43-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!</span>a<span class="op">.</span>IsChanged<span class="op">())</span> <span class="op">{</span></span>
<span id="cb43-46"><a href="#cb43-46" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span><span class="op">;</span></span>
<span id="cb43-47"><a href="#cb43-47" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb43-48"><a href="#cb43-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-49"><a href="#cb43-49" aria-hidden="true" tabindex="-1"></a>        a<span class="op">.</span>Change<span class="op">(</span><span class="kw">false</span><span class="op">);</span></span>
<span id="cb43-50"><a href="#cb43-50" aria-hidden="true" tabindex="-1"></a>        a<span class="op">.</span>DoSomething<span class="op">();</span>  <span class="co">// a.IsChanged()がtrueの時に実行する。</span></span>
<span id="cb43-51"><a href="#cb43-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-52"><a href="#cb43-52" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb43-53"><a href="#cb43-53" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>上記ソースコードは、オブジェクトaのA::a_が変更された場合、
その後、それをもとに何らかの動作を行うこと(a.DoSomething)を表しているが、
本来オブジェクトaの状態が変わったかどうかはオブジェクトa自体が判断すべきであり、
a.DoSomething()の実行においても、それが必要かどうかはオブジェクトaが判断すべきである。
この考えに基づいた修正ソースコードを下記に示す。</p>
<div class="sourceCode" id="cb44"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/accessor_ut.cpp 130</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> A <span class="op">{</span>  <span class="co">// 上記アンチパターンからChange()とIsChanged()を削除し、状態の隠蔽レベルを強化</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> SetA<span class="op">(</span><span class="dt">int32_t</span> a<span class="op">)</span> <span class="kw">noexcept</span>  <span class="co">// setter</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span><span class="va">a_</span> <span class="op">==</span> a<span class="op">)</span> <span class="op">{</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span><span class="op">;</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>            <span class="va">a_</span>          <span class="op">=</span> a<span class="op">;</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>            <span class="va">is_changed_</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> DoSomething<span class="op">()</span> <span class="kw">noexcept</span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(!</span><span class="va">is_changed_</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span><span class="op">;</span></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Do something</span></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>            <span class="op">...</span></span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a>            <span class="va">is_changed_</span> <span class="op">=</span> <span class="kw">false</span><span class="op">;</span>  <span class="co">// 状態変更の取り消し</span></span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> f<span class="op">(</span>A<span class="op">&amp;</span> a<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a>        a<span class="op">.</span>SetA<span class="op">(</span><span class="dv">3</span><span class="op">);</span></span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> g<span class="op">(</span>A<span class="op">&amp;</span> a<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true" tabindex="-1"></a>        a<span class="op">.</span>DoSomething<span class="op">();</span>  <span class="co">// DoSomethingは無条件で呼び出す。</span></span>
<span id="cb44-39"><a href="#cb44-39" aria-hidden="true" tabindex="-1"></a>                          <span class="co">// 実際に何かをするかどうかは、オブジェクトaが決める。</span></span>
<span id="cb44-40"><a href="#cb44-40" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb44-41"><a href="#cb44-41" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>setterを使用する場合、上記のように処理の隠蔽化には特に気を付ける必要がある。</p>
<h2 id="copy-and-swap">Copy-And-Swap <a id="SS_2_5"></a></h2>
<p>メンバ変数にポインタやスマートポインタを持つクラスに</p>
<ul>
<li>copyコンストラクタ</li>
<li>copy代入演算子</li>
<li>moveコンストラクタ</li>
<li>move代入演算子</li>
</ul>
<p>が必要になった場合、コンパイラが生成するデフォルトの <a
href="#SS_5_2_1">特殊メンバ関数</a>では機能が不十分であることが多い。</p>
<p>下記に示すコードは、そのような場合の上記4関数の実装例である。</p>
<div class="sourceCode" id="cb45"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/no_copy_and_swap_ut.cpp 8</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> NoCopyAndSwap <span class="kw">final</span> <span class="op">{</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> NoCopyAndSwap<span class="op">(</span><span class="dt">char</span> <span class="at">const</span><span class="op">*</span> name0<span class="op">,</span> <span class="dt">char</span> <span class="at">const</span><span class="op">*</span> name1<span class="op">)</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>            <span class="op">:</span> <span class="va">name0_</span><span class="op">{</span>name0 <span class="op">==</span> <span class="kw">nullptr</span> <span class="op">?</span> <span class="st">&quot;&quot;</span> <span class="op">:</span> name0<span class="op">},</span> <span class="va">name1_</span><span class="op">{</span>name1 <span class="op">==</span> <span class="kw">nullptr</span> <span class="op">?</span> <span class="st">&quot;&quot;</span> <span class="op">:</span> name1<span class="op">}</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>        NoCopyAndSwap<span class="op">(</span>NoCopyAndSwap <span class="at">const</span><span class="op">&amp;</span> rhs<span class="op">)</span> <span class="op">:</span> <span class="va">name0_</span><span class="op">{</span>rhs<span class="op">.</span><span class="va">name0_</span><span class="op">},</span> <span class="va">name1_</span><span class="op">{</span>rhs<span class="op">.</span><span class="va">name1_</span><span class="op">}</span> <span class="op">{}</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>        NoCopyAndSwap<span class="op">(</span>NoCopyAndSwap<span class="op">&amp;&amp;</span> rhs<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>            <span class="op">:</span> <span class="va">name0_</span><span class="op">{</span><span class="bu">std::</span>exchange<span class="op">(</span>rhs<span class="op">.</span><span class="va">name0_</span><span class="op">,</span> <span class="kw">nullptr</span><span class="op">)},</span> <span class="va">name1_</span><span class="op">{</span><span class="bu">std::</span>move<span class="op">(</span>rhs<span class="op">.</span><span class="va">name1_</span><span class="op">)}</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>            <span class="co">// move後には、</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>            <span class="co">//  * name0_はnullptr</span></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>            <span class="co">//  * name1_はnullptrを保持したunique_ptr</span></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>            <span class="co">// となる。</span></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>        NoCopyAndSwap<span class="op">&amp;</span> <span class="kw">operator</span><span class="op">=(</span>NoCopyAndSwap <span class="at">const</span><span class="op">&amp;</span> rhs<span class="op">)</span></span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span><span class="kw">this</span> <span class="op">==</span> <span class="op">&amp;</span>rhs<span class="op">)</span> <span class="op">{</span></span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="op">*</span><span class="kw">this</span><span class="op">;</span></span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>            <span class="co">// copyコンストラクタのコードクローン</span></span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>            <span class="va">name0_</span> <span class="op">=</span> rhs<span class="op">.</span><span class="va">name0_</span><span class="op">;</span></span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>            <span class="va">name1_</span> <span class="op">=</span> rhs<span class="op">.</span><span class="va">name1_</span><span class="op">;</span>  <span class="co">// ここでエクセプションが発生すると*thisが壊れる</span></span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="op">*</span><span class="kw">this</span><span class="op">;</span></span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>        NoCopyAndSwap<span class="op">&amp;</span> <span class="kw">operator</span><span class="op">=(</span>NoCopyAndSwap<span class="op">&amp;&amp;</span> rhs<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span><span class="kw">this</span> <span class="op">==</span> <span class="op">&amp;</span>rhs<span class="op">)</span> <span class="op">{</span></span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="op">*</span><span class="kw">this</span><span class="op">;</span></span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a>            <span class="co">// moveコンストラクタのコードクローン</span></span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a>            <span class="va">name0_</span> <span class="op">=</span> <span class="bu">std::</span>exchange<span class="op">(</span>rhs<span class="op">.</span><span class="va">name0_</span><span class="op">,</span> <span class="kw">nullptr</span><span class="op">);</span></span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a>            <span class="va">name1_</span> <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{};</span>  <span class="co">// これがないと、name1_の値がrhs.name1_にスワップされる</span></span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a>            <span class="va">name1_</span> <span class="op">=</span> <span class="bu">std::</span>move<span class="op">(</span>rhs<span class="op">.</span><span class="va">name1_</span><span class="op">);</span></span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-45"><a href="#cb45-45" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="op">*</span><span class="kw">this</span><span class="op">;</span></span>
<span id="cb45-46"><a href="#cb45-46" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb45-47"><a href="#cb45-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-48"><a href="#cb45-48" aria-hidden="true" tabindex="-1"></a>        <span class="dt">char</span> <span class="at">const</span><span class="op">*</span>        GetName0<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">name0_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb45-49"><a href="#cb45-49" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span><span class="op">&amp;</span> GetName1<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">name1_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb45-50"><a href="#cb45-50" aria-hidden="true" tabindex="-1"></a>        <span class="op">~</span>NoCopyAndSwap<span class="op">()</span> <span class="op">=</span> <span class="cf">default</span><span class="op">;</span></span>
<span id="cb45-51"><a href="#cb45-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-52"><a href="#cb45-52" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb45-53"><a href="#cb45-53" aria-hidden="true" tabindex="-1"></a>        <span class="dt">char</span> <span class="at">const</span><span class="op">*</span> <span class="va">name0_</span><span class="op">;</span>  <span class="co">// 問題やその改善を明示するために、敢えてname0_をchar const*としたが、</span></span>
<span id="cb45-54"><a href="#cb45-54" aria-hidden="true" tabindex="-1"></a>                             <span class="co">// 本来ならば、std::stringかstd::string_viewを使うべき</span></span>
<span id="cb45-55"><a href="#cb45-55" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span><span class="va">name1_</span><span class="op">;</span></span>
<span id="cb45-56"><a href="#cb45-56" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>コード内のコメントで示したように、このコードには以下のような問題がある。</p>
<ul>
<li>copy代入演算子には、<a
href="#SS_5_7">エクセプション安全性の保証</a>がない。</li>
<li>上記4関数は似ているにも関わらず、微妙な違いがあるためコードクローンとなっている。</li>
</ul>
<p>ここで紹介するCopy-And-Swapはこのような問題を解決するためのイデオムである。</p>
<p>実装例を以下に示す。</p>
<div class="sourceCode" id="cb46"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/copy_and_swap_ut.cpp 6</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> CopyAndSwap <span class="kw">final</span> <span class="op">{</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> CopyAndSwap<span class="op">(</span><span class="dt">char</span> <span class="at">const</span><span class="op">*</span> name0<span class="op">,</span> <span class="dt">char</span> <span class="at">const</span><span class="op">*</span> name1<span class="op">)</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>            <span class="op">:</span> <span class="va">name0_</span><span class="op">{</span>name0 <span class="op">==</span> <span class="kw">nullptr</span> <span class="op">?</span> <span class="st">&quot;&quot;</span> <span class="op">:</span> name0<span class="op">},</span> <span class="va">name1_</span><span class="op">{</span>name1 <span class="op">==</span> <span class="kw">nullptr</span> <span class="op">?</span> <span class="st">&quot;&quot;</span> <span class="op">:</span> name1<span class="op">}</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>        CopyAndSwap<span class="op">(</span>CopyAndSwap <span class="at">const</span><span class="op">&amp;</span> rhs<span class="op">)</span> <span class="op">:</span> <span class="va">name0_</span><span class="op">{</span>rhs<span class="op">.</span><span class="va">name0_</span><span class="op">},</span> <span class="va">name1_</span><span class="op">{</span>rhs<span class="op">.</span><span class="va">name1_</span><span class="op">}</span> <span class="op">{}</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>        CopyAndSwap<span class="op">(</span>CopyAndSwap<span class="op">&amp;&amp;</span> rhs<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>            <span class="op">:</span> <span class="va">name0_</span><span class="op">{</span><span class="bu">std::</span>exchange<span class="op">(</span>rhs<span class="op">.</span><span class="va">name0_</span><span class="op">,</span> <span class="kw">nullptr</span><span class="op">)},</span> <span class="va">name1_</span><span class="op">{</span><span class="bu">std::</span>move<span class="op">(</span>rhs<span class="op">.</span><span class="va">name1_</span><span class="op">)}</span></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>            <span class="co">// move後には、</span></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>            <span class="co">//  * name0_はnullptr</span></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>            <span class="co">//  * name1_は&quot;&quot;を保持したstd::string</span></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>            <span class="co">// となる。</span></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>        CopyAndSwap<span class="op">&amp;</span> <span class="kw">operator</span><span class="op">=(</span>CopyAndSwap <span class="at">const</span><span class="op">&amp;</span> rhs<span class="op">)</span></span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span><span class="kw">this</span> <span class="op">==</span> <span class="op">&amp;</span>rhs<span class="op">)</span> <span class="op">{</span></span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="op">*</span><span class="kw">this</span><span class="op">;</span></span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>            <span class="co">// copyコンストラクタの使用</span></span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a>            CopyAndSwap tmp<span class="op">{</span>rhs<span class="op">};</span>  <span class="co">// ここでエクセプションが発生しても、tmp以外、壊れない</span></span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a>            Swap<span class="op">(</span>tmp<span class="op">);</span></span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="op">*</span><span class="kw">this</span><span class="op">;</span></span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a>        CopyAndSwap<span class="op">&amp;</span> <span class="kw">operator</span><span class="op">=(</span>CopyAndSwap<span class="op">&amp;&amp;</span> rhs<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span><span class="kw">this</span> <span class="op">==</span> <span class="op">&amp;</span>rhs<span class="op">)</span> <span class="op">{</span></span>
<span id="cb46-38"><a href="#cb46-38" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="op">*</span><span class="kw">this</span><span class="op">;</span></span>
<span id="cb46-39"><a href="#cb46-39" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb46-40"><a href="#cb46-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-41"><a href="#cb46-41" aria-hidden="true" tabindex="-1"></a>            CopyAndSwap tmp<span class="op">{</span><span class="bu">std::</span>move<span class="op">(</span>rhs<span class="op">)};</span>  <span class="co">// moveコンストラクタ</span></span>
<span id="cb46-42"><a href="#cb46-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-43"><a href="#cb46-43" aria-hidden="true" tabindex="-1"></a>            Swap<span class="op">(</span>tmp<span class="op">);</span></span>
<span id="cb46-44"><a href="#cb46-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-45"><a href="#cb46-45" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="op">*</span><span class="kw">this</span><span class="op">;</span></span>
<span id="cb46-46"><a href="#cb46-46" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb46-47"><a href="#cb46-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-48"><a href="#cb46-48" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> Swap<span class="op">(</span>CopyAndSwap<span class="op">&amp;</span> rhs<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb46-49"><a href="#cb46-49" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb46-50"><a href="#cb46-50" aria-hidden="true" tabindex="-1"></a>            <span class="bu">std::</span>swap<span class="op">(</span><span class="va">name0_</span><span class="op">,</span> rhs<span class="op">.</span><span class="va">name0_</span><span class="op">);</span></span>
<span id="cb46-51"><a href="#cb46-51" aria-hidden="true" tabindex="-1"></a>            <span class="bu">std::</span>swap<span class="op">(</span><span class="va">name1_</span><span class="op">,</span> rhs<span class="op">.</span><span class="va">name1_</span><span class="op">);</span></span>
<span id="cb46-52"><a href="#cb46-52" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb46-53"><a href="#cb46-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-54"><a href="#cb46-54" aria-hidden="true" tabindex="-1"></a>        <span class="dt">char</span> <span class="at">const</span><span class="op">*</span>        GetName0<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">name0_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb46-55"><a href="#cb46-55" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span><span class="op">&amp;</span> GetName1<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">name1_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb46-56"><a href="#cb46-56" aria-hidden="true" tabindex="-1"></a>        <span class="op">~</span>CopyAndSwap<span class="op">()</span> <span class="op">=</span> <span class="cf">default</span><span class="op">;</span></span>
<span id="cb46-57"><a href="#cb46-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-58"><a href="#cb46-58" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb46-59"><a href="#cb46-59" aria-hidden="true" tabindex="-1"></a>        <span class="dt">char</span> <span class="at">const</span><span class="op">*</span> <span class="va">name0_</span><span class="op">;</span>  <span class="co">// 問題やその改善を明示するために、敢えてname0_をchar const*としたが、</span></span>
<span id="cb46-60"><a href="#cb46-60" aria-hidden="true" tabindex="-1"></a>                             <span class="co">// 本来ならば、std::stringかstd::string_viewを使うべき</span></span>
<span id="cb46-61"><a href="#cb46-61" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span><span class="va">name1_</span><span class="op">;</span></span>
<span id="cb46-62"><a href="#cb46-62" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>上記CopyAndSwapのcopyコンストラクタ、moveコンストラクタに変更はない。
また、CopyAndSwap::Swapに関してもstd::vector等が持つswapと同様のものである。
このイデオムの特徴は、copy代入演算子、
move代入演算子が各コンストラクタとSwap関数により実装されている所にある。
これにより<a
href="#SS_5_7">エクセプション安全性の保証</a>を持つ4関数をコードクローンすることなく実装できる。</p>
<h2 id="immutable">Immutable <a id="SS_2_6"></a></h2>
<p>クラスに対するimmutable、immutabilityの定義を以下のように定める。</p>
<ul>
<li>immutable(不変な)なクラスとは、初期化後、状態の変更ができないクラスを指す。</li>
<li>immutability(不変性)が高いクラスとは、
状態を変更するメンバ関数(非constなメンバ関数)が少ないクラスを指す。</li>
</ul>
<p>immutabilityが高いほど、そのクラスの使用方法は制限される。
これにより、そのクラスやそのクラスを使用しているソースコードの可読性やデバッグ容易性が向上する。
また、クラスがimmutableでなくても、そのクラスのオブジェクトをconstハンドル経由でアクセスすることで、
immutableとして扱うことができる。</p>
<p>一方で、「<a
href="#SS_2_4">Accessor</a>」で紹介したsetterは、クラスのimmutabilityを下げる。
いつでも状態が変更できるため、ソースコードの可読性やデバッグ容易性が低下する。
また、マルチスレッド環境においてはこのことが競合問題や、
それを回避するためのロックがパフォーマンス問題やデッドロックを引き起こしてしまう。</p>
<p>従って、クラスを宣言、定義する場合、immutabilityを出来るだけ高くするべきであり、
そのクラスのオブジェクトを使う側は、
可能な限りimmutableオブジェクト(constオブジェクト)として扱うべきである。</p>
<h2 id="clone仮想コンストラクタ">Clone(仮想コンストラクタ)
<a id="SS_2_7"></a></h2>
<p>オブジェクトコピーによる<a
href="#SS_5_3_3">スライシング</a>を回避するためのイデオムである。</p>
<p>下記は、オブジェクトコピーによるスライシングを起こしてしまう例である。</p>
<div class="sourceCode" id="cb47"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/clone_ut.cpp 8</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> BaseSlicing <span class="op">{</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">char</span> <span class="at">const</span><span class="op">*</span> Name<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="st">&quot;BaseSlicing&quot;</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> DerivedSlicing <span class="kw">final</span> <span class="op">:</span> <span class="kw">public</span> BaseSlicing <span class="op">{</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">char</span> <span class="at">const</span><span class="op">*</span> Name<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="kw">override</span> <span class="op">{</span> <span class="cf">return</span> <span class="st">&quot;DerivedSlicing&quot;</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>    TEST<span class="op">(</span>Clone<span class="op">,</span> object_slicing<span class="op">)</span></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> b <span class="op">=</span> BaseSlicing<span class="op">{};</span></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> d <span class="op">=</span> DerivedSlicing<span class="op">{};</span></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>        BaseSlicing<span class="op">*</span> b_ptr   <span class="op">=</span> <span class="op">&amp;</span>b<span class="op">;</span></span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>        BaseSlicing<span class="op">*</span> b_ptr_d <span class="op">=</span> <span class="op">&amp;</span>d<span class="op">;</span></span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>        ASSERT_STREQ<span class="op">(</span><span class="st">&quot;BaseSlicing&quot;</span><span class="op">,</span> b_ptr<span class="op">-&gt;</span>Name<span class="op">());</span></span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>        ASSERT_STREQ<span class="op">(</span><span class="st">&quot;DerivedSlicing&quot;</span><span class="op">,</span> b_ptr_d<span class="op">-&gt;</span>Name<span class="op">());</span></span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>        <span class="op">*</span>b_ptr <span class="op">=</span> <span class="op">*</span>b_ptr_d<span class="op">;</span>  <span class="co">// コピーしたつもりだがスライシングにより、*b_ptrは、</span></span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>                            <span class="co">// DerivedSlicingのインスタンスではなく、BaseSlicingのインスタンス</span></span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#if 0</span></span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a><span class="co">        ASSERT_STREQ(&quot;DerivedSlicing&quot;, b_ptr-&gt;Name());</span></span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="pp">#else</span></span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a>        ASSERT_STREQ<span class="op">(</span><span class="st">&quot;BaseSlicing&quot;</span><span class="op">,</span> b_ptr<span class="op">-&gt;</span>Name<span class="op">());</span>  <span class="co">// &quot;DerivedSlicing&quot;が返るはずだが、</span></span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a>                                                     <span class="co">// スライシングにより&quot;BaseSlicing&quot;が返る</span></span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#endif</span></span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>下記は、上記にcloneイデオムを適用した例である。</p>
<div class="sourceCode" id="cb48"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/clone_ut.cpp 50</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// スライシングを起こさないようにコピー演算子の代わりにClone()を実装。</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> BaseNoSlicing <span class="op">{</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">char</span> <span class="at">const</span><span class="op">*</span> Name<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="st">&quot;BaseNoSlicing&quot;</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>BaseNoSlicing<span class="op">&gt;</span> Clone<span class="op">()</span> <span class="op">{</span> <span class="cf">return</span> <span class="bu">std::</span>make_unique<span class="op">&lt;</span>BaseNoSlicing<span class="op">&gt;();</span> <span class="op">}</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>        BaseNoSlicing<span class="op">(</span>BaseNoSlicing <span class="at">const</span><span class="op">&amp;)</span>            <span class="op">=</span> <span class="kw">delete</span><span class="op">;</span>  <span class="co">// copy生成の禁止</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>        BaseNoSlicing<span class="op">&amp;</span> <span class="kw">operator</span><span class="op">=(</span>BaseNoSlicing <span class="at">const</span><span class="op">&amp;)</span> <span class="op">=</span> <span class="kw">delete</span><span class="op">;</span>  <span class="co">// copy代入の禁止</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> DerivedNoSlicing <span class="kw">final</span> <span class="op">:</span> <span class="kw">public</span> BaseNoSlicing <span class="op">{</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">char</span> <span class="at">const</span><span class="op">*</span> Name<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="kw">override</span> <span class="op">{</span> <span class="cf">return</span> <span class="st">&quot;DerivedNoSlicing&quot;</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>DerivedNoSlicing<span class="op">&gt;</span> CloneOwn<span class="op">()</span> <span class="op">{</span> <span class="cf">return</span> <span class="bu">std::</span>make_unique<span class="op">&lt;</span>DerivedNoSlicing<span class="op">&gt;();</span> <span class="op">}</span></span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>        <span class="co">// DerivedNoSlicingはBaseNoSlicingの派生クラスであるため、</span></span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>        <span class="co">// std::unique_ptr&lt;DerivedNoSlicing&gt;オブジェクトから</span></span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>        <span class="co">// std::unique_ptr&lt;BaseNoSlicing&gt;オブジェクトへのmove代入可能</span></span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>BaseNoSlicing<span class="op">&gt;</span> Clone<span class="op">()</span> <span class="kw">override</span> <span class="op">{</span> <span class="cf">return</span> CloneOwn<span class="op">();</span> <span class="op">}</span></span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>    TEST<span class="op">(</span>Clone<span class="op">,</span> object_slicing_avoidance<span class="op">)</span></span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> b <span class="op">=</span> BaseNoSlicing<span class="op">{};</span></span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> d <span class="op">=</span> DerivedNoSlicing<span class="op">{};</span></span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a>        BaseNoSlicing<span class="op">*</span> b_ptr   <span class="op">=</span> <span class="op">&amp;</span>b<span class="op">;</span></span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a>        BaseNoSlicing<span class="op">*</span> b_ptr_d <span class="op">=</span> <span class="op">&amp;</span>d<span class="op">;</span></span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-36"><a href="#cb48-36" aria-hidden="true" tabindex="-1"></a>        ASSERT_STREQ<span class="op">(</span><span class="st">&quot;BaseNoSlicing&quot;</span><span class="op">,</span> b_ptr<span class="op">-&gt;</span>Name<span class="op">());</span></span>
<span id="cb48-37"><a href="#cb48-37" aria-hidden="true" tabindex="-1"></a>        ASSERT_STREQ<span class="op">(</span><span class="st">&quot;DerivedNoSlicing&quot;</span><span class="op">,</span> b_ptr_d<span class="op">-&gt;</span>Name<span class="op">());</span></span>
<span id="cb48-38"><a href="#cb48-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-39"><a href="#cb48-39" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#if 0</span></span>
<span id="cb48-40"><a href="#cb48-40" aria-hidden="true" tabindex="-1"></a><span class="co">        *b_ptr = *b_ptr_d;                // コピー演算子をdeleteしたのでコンパイルエラー</span></span>
<span id="cb48-41"><a href="#cb48-41" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="pp">#else</span></span>
<span id="cb48-42"><a href="#cb48-42" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> b_uptr <span class="op">=</span> b_ptr_d<span class="op">-&gt;</span>Clone<span class="op">();</span>  <span class="co">// コピー演算子の代わりにClone()を使う。</span></span>
<span id="cb48-43"><a href="#cb48-43" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#endif</span></span>
<span id="cb48-44"><a href="#cb48-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-45"><a href="#cb48-45" aria-hidden="true" tabindex="-1"></a>        ASSERT_STREQ<span class="op">(</span><span class="st">&quot;DerivedNoSlicing&quot;</span><span class="op">,</span> b_uptr<span class="op">-&gt;</span>Name<span class="op">());</span>  <span class="co">// 意図通り&quot;DerivedNoSlicing&quot;が返る。</span></span>
<span id="cb48-46"><a href="#cb48-46" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>B1::Clone()やそのオーバーライドであるD1::Clone()を使うことで、
スライシングを起こすことなくオブジェクトのコピーを行うことができるようになった。</p>
<h2 id="nvinon-virtual-interface">NVI(non virtual interface)
<a id="SS_2_8"></a></h2>
<p>NVIとは、「virtualなメンバ関数をpublicにしない」という実装上の制約である。</p>
<p>下記のようにクラスBaseが定義されているとする。</p>
<div class="sourceCode" id="cb49"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/nvi_ut.cpp 7</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Base <span class="op">{</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">bool</span> DoSomething<span class="op">(</span><span class="dt">int</span> something<span class="op">)</span> <span class="at">const</span> <span class="kw">noexcept</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>            <span class="op">...</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="op">~</span>Base<span class="op">()</span> <span class="op">=</span> <span class="cf">default</span><span class="op">;</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>これを使うクラスはBase::DoSomething()に依存する。
また、このクラスから派生した下記のクラスDerivedもBase::DoSomething()に依存する。</p>
<div class="sourceCode" id="cb50"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/nvi_ut.cpp 26</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Derived <span class="op">:</span> <span class="kw">public</span> Base <span class="op">{</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">bool</span> DoSomething<span class="op">(</span><span class="dt">int</span> something<span class="op">)</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="kw">override</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>            <span class="op">...</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>この条件下ではBase::DoSomething()へ依存が集中し、この関数の修正や機能追加の作業コストが高くなる。
このイデオムは、この問題を軽減する。</p>
<p>これを用いた上記2クラスのリファクタリング例を以下に示す。</p>
<div class="sourceCode" id="cb51"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/nvi_ut.cpp 57</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Base <span class="op">{</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">bool</span> DoSomething<span class="op">(</span><span class="dt">int</span> something<span class="op">)</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> do_something<span class="op">(</span>something<span class="op">);</span> <span class="op">}</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="op">~</span>Base<span class="op">()</span> <span class="op">=</span> <span class="cf">default</span><span class="op">;</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">bool</span> do_something<span class="op">(</span><span class="dt">int</span> something<span class="op">)</span> <span class="at">const</span> <span class="kw">noexcept</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>            <span class="op">...</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Derived <span class="op">:</span> <span class="kw">public</span> Base <span class="op">{</span></span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">bool</span> do_something<span class="op">(</span><span class="dt">int</span> something<span class="op">)</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="kw">override</span></span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>            <span class="op">...</span></span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>オーバーライド元の関数とそのオーバーライドのデフォルト引数の値は一致させる必要がある。</p>
<p>それに従わない下記のようなクラスとその派生クラス</p>
<div class="sourceCode" id="cb52"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/nvi_ut.cpp 105</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> NotNviBase <span class="op">{</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="bu">std::</span>string<span class="op"> </span>Name<span class="op">(</span><span class="dt">bool</span> mangled <span class="op">=</span> <span class="kw">false</span><span class="op">)</span> <span class="at">const</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> mangled <span class="op">?</span> <span class="kw">typeid</span><span class="op">(*</span><span class="kw">this</span><span class="op">).</span>name<span class="op">()</span> <span class="op">:</span> <span class="st">&quot;NotNviBase&quot;</span><span class="op">;</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="op">~</span>NotNviBase<span class="op">()</span> <span class="op">=</span> <span class="cf">default</span><span class="op">;</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> NotNviDerived <span class="op">:</span> <span class="kw">public</span> NotNviBase <span class="op">{</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="bu">std::</span>string<span class="op"> </span>Name<span class="op">(</span><span class="dt">bool</span> mangled <span class="op">=</span> <span class="kw">true</span><span class="op">)</span> <span class="at">const</span> <span class="kw">override</span>  <span class="co">// NG デフォルト値が違う</span></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> mangled <span class="op">?</span> <span class="kw">typeid</span><span class="op">(*</span><span class="kw">this</span><span class="op">).</span>name<span class="op">()</span> <span class="op">:</span> <span class="st">&quot;NotNviDerived&quot;</span><span class="op">;</span></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>には下記の単体テストで示したような、
メンバ関数の振る舞いがその表層型に依存してしまう問題を持つことになる。</p>
<div class="sourceCode" id="cb53"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/nvi_ut.cpp 129</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>    NotNviDerived <span class="at">const</span> d<span class="op">;</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>    NotNviBase <span class="at">const</span><span class="op">&amp;</span>   d_ref <span class="op">=</span> d<span class="op">;</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;NotNviDerived&quot;</span><span class="op">,</span> d<span class="op">.</span>Name<span class="op">(</span><span class="kw">false</span><span class="op">));</span>   <span class="co">// OK</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;13NotNviDerived&quot;</span><span class="op">,</span> d<span class="op">.</span>Name<span class="op">(</span><span class="kw">true</span><span class="op">));</span>  <span class="co">// OK</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;NotNviDerived&quot;</span><span class="op">,</span> d_ref<span class="op">.</span>Name<span class="op">(</span><span class="kw">false</span><span class="op">));</span>   <span class="co">// OK</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;13NotNviDerived&quot;</span><span class="op">,</span> d_ref<span class="op">.</span>Name<span class="op">(</span><span class="kw">true</span><span class="op">));</span>  <span class="co">// OK</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;13NotNviDerived&quot;</span><span class="op">,</span> d<span class="op">.</span>Name<span class="op">());</span>    <span class="co">// mangled == false</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;NotNviDerived&quot;</span><span class="op">,</span> d_ref<span class="op">.</span>Name<span class="op">());</span>  <span class="co">// mangled == true</span></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>    ASSERT_NE<span class="op">(</span>d<span class="op">.</span>Name<span class="op">(),</span> d_ref<span class="op">.</span>Name<span class="op">());</span>  <span class="co">// NG d_refの実態はdであるが、d.Name()と動きが違う</span></span></code></pre></div>
<p>この例のように継承階層が浅く、デフォルト引数の数も少ない場合、
この値を一致させることは難しくないが、
これよりも遥かに複雑な実際のコードではこの一致の維持は困難になる。</p>
<p>下記のようにNVIに従わせることでこのような問題に対処できる。</p>
<div class="sourceCode" id="cb54"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/nvi_ut.cpp 148</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> NviBase <span class="op">{</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span>Name<span class="op">(</span><span class="dt">bool</span> mangled <span class="op">=</span> <span class="kw">false</span><span class="op">)</span> <span class="at">const</span> <span class="op">{</span> <span class="cf">return</span> name<span class="op">(</span>mangled<span class="op">);</span> <span class="op">}</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="op">~</span>NviBase<span class="op">()</span> <span class="op">=</span> <span class="cf">default</span><span class="op">;</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="bu">std::</span>string<span class="op"> </span>name<span class="op">(</span><span class="dt">bool</span> mangled<span class="op">)</span> <span class="at">const</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> mangled <span class="op">?</span> <span class="kw">typeid</span><span class="op">(*</span><span class="kw">this</span><span class="op">).</span>name<span class="op">()</span> <span class="op">:</span> <span class="st">&quot;NviBase&quot;</span><span class="op">;</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> NviDerived <span class="op">:</span> <span class="kw">public</span> NviBase <span class="op">{</span></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="bu">std::</span>string<span class="op"> </span>name<span class="op">(</span><span class="dt">bool</span> mangled<span class="op">)</span> <span class="at">const</span> <span class="kw">override</span>  <span class="co">// OK デフォルト値を持たない</span></span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> mangled <span class="op">?</span> <span class="kw">typeid</span><span class="op">(*</span><span class="kw">this</span><span class="op">).</span>name<span class="op">()</span> <span class="op">:</span> <span class="st">&quot;NviDerived&quot;</span><span class="op">;</span></span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>下記の単体テストにより、この問題の解消が確認できる。</p>
<div class="sourceCode" id="cb55"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/nvi_ut.cpp 173</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>    NviBase <span class="at">const</span>    b<span class="op">;</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>    NviDerived <span class="at">const</span> d<span class="op">;</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>    NviBase <span class="at">const</span><span class="op">&amp;</span>   d_ref <span class="op">=</span> d<span class="op">;</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;NviDerived&quot;</span><span class="op">,</span> d<span class="op">.</span>Name<span class="op">(</span><span class="kw">false</span><span class="op">));</span>   <span class="co">// OK</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;10NviDerived&quot;</span><span class="op">,</span> d<span class="op">.</span>Name<span class="op">(</span><span class="kw">true</span><span class="op">));</span>  <span class="co">// OK</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;NviDerived&quot;</span><span class="op">,</span> d_ref<span class="op">.</span>Name<span class="op">(</span><span class="kw">false</span><span class="op">));</span>   <span class="co">// OK</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;10NviDerived&quot;</span><span class="op">,</span> d_ref<span class="op">.</span>Name<span class="op">(</span><span class="kw">true</span><span class="op">));</span>  <span class="co">// OK</span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;NviDerived&quot;</span><span class="op">,</span> d<span class="op">.</span>Name<span class="op">());</span>      <span class="co">// mangled == false</span></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;NviDerived&quot;</span><span class="op">,</span> d_ref<span class="op">.</span>Name<span class="op">());</span>  <span class="co">// mangled == false</span></span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>d<span class="op">.</span>Name<span class="op">(),</span> d_ref<span class="op">.</span>Name<span class="op">());</span>  <span class="co">// OK</span></span></code></pre></div>
<p>なお、メンバ関数のデフォルト引数は、
そのクラス外部からのメンバ関数呼び出しを簡潔に記述するための記法であるため、
privateなメンバ関数はデフォルト引数を持つべきではない。</p>
<h2 id="raiiscoped-guard">RAII(scoped guard) <a id="SS_2_9"></a></h2>
<p>RAIIとは、「Resource Acquisition Is Initialization」の略語であり、
リソースの確保と解放をオブジェクトの初期化と破棄処理に結びつけるパターンもしくはイデオムである。
特にダイナミックにオブジェクトを生成する場合、
RAIIに従わないとメモリリークを防ぐことは困難である。</p>
<p>下記は、関数終了付近でdeleteする素朴なコードである。</p>
<div class="sourceCode" id="cb56"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/raii_ut.cpp 18</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Aは外部の変数をリファレンスcounter_として保持し、</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">//  * コンストラクタ呼び出し時に++counter_</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">//  * デストラクタタ呼び出し時に--counter_</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">// とするため、生成と解放が同じだけ行われれば外部の変数の値は0となる</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> A <span class="op">{</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>        A<span class="op">(</span><span class="dt">uint32_t</span><span class="op">&amp;</span> couner<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">:</span> <span class="va">counter_</span><span class="op">{++</span>couner<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">~</span>A<span class="op">()</span> <span class="op">{</span> <span class="op">--</span><span class="va">counter_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>        <span class="dt">uint32_t</span><span class="op">&amp;</span> <span class="va">counter_</span><span class="op">;</span></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> not_use_RAII_for_memory<span class="op">(</span><span class="dt">size_t</span> index<span class="op">,</span> <span class="dt">uint32_t</span><span class="op">&amp;</span> object_counter<span class="op">)</span></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> a <span class="op">=</span> <span class="kw">new</span> A<span class="op">{</span>object_counter<span class="op">};</span>  <span class="co">// RAIIでない例</span></span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> s <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{</span><span class="st">&quot;hehe&quot;</span><span class="op">};</span></span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> ret <span class="op">=</span> s<span class="op">.</span>at<span class="op">(</span>index<span class="op">);</span>  <span class="co">// index &gt;= 5でエクセプション発生</span></span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 何らかの処理</span></span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>        <span class="kw">delete</span> a<span class="op">;</span>         <span class="co">//  この行以前に関数を抜けるとaはメモリリーク</span></span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> ret<span class="op">;</span></span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>このコードは下記の単体テストが示す通り、第1パラメータが5以上の場合、
エクセプションが発生しメモリリークしてしまう。</p>
<div class="sourceCode" id="cb57"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/raii_ut.cpp 71</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> object_counter <span class="op">=</span> <span class="dv">0</span><span class="bu">U</span><span class="op">;</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 第1引数が5なのでエクセプション発生</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>    ASSERT_THROW<span class="op">(</span>not_use_RAII_for_memory<span class="op">(</span><span class="dv">5</span><span class="op">,</span> object_counter<span class="op">),</span> <span class="bu">std::</span>exception<span class="op">);</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 上記のnot_use_RAII_for_memoryではエクセプションが発生し、メモリリークする</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">1</span><span class="op">,</span> object_counter<span class="op">);</span></span></code></pre></div>
<p>以下は、std::unique_ptrによってRAIIを導入し、この問題に対処した例である。</p>
<div class="sourceCode" id="cb58"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/raii_ut.cpp 83</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> use_RAII_for_memory<span class="op">(</span><span class="dt">size_t</span> index<span class="op">,</span> <span class="dt">uint32_t</span><span class="op">&amp;</span> object_counter<span class="op">)</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> a <span class="op">=</span> <span class="bu">std::</span>make_unique<span class="op">&lt;</span>A<span class="op">&gt;(</span>object_counter<span class="op">);</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> s <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{</span><span class="st">&quot;hehe&quot;</span><span class="op">};</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> ret <span class="op">=</span> s<span class="op">.</span>at<span class="op">(</span>index<span class="op">);</span>  <span class="co">// index &gt;= 5でエクセプション発生</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 何らかの処理</span></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> ret<span class="op">;</span>  <span class="co">// aは自動解放される</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>下記単体テストで確認できるように、
エクセプション発生時にもstd::unique_ptrによる自動解放によりメモリリークは発生しない。</p>
<div class="sourceCode" id="cb59"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/raii_ut.cpp 100</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> object_counter <span class="op">=</span> <span class="dv">0</span><span class="bu">U</span><span class="op">;</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 第1引数が5なのでエクセプション発生</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>    ASSERT_THROW<span class="op">(</span>use_RAII_for_memory<span class="op">(</span><span class="dv">5</span><span class="op">,</span> object_counter<span class="op">),</span> <span class="bu">std::</span>exception<span class="op">);</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 上記のuse_RAII_for_memoryではエクセプションが発生するがメモリリークはしない</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">0</span><span class="op">,</span> object_counter<span class="op">);</span></span></code></pre></div>
<p>RAIIのテクニックはメモリ管理のみでなく、ファイルディスクリプタ(open-close、socket-close)
等のリソース管理においても有効であるという例を示す。</p>
<p>下記は、生成したソケットを関数終了付近でcloseする素朴なコードである。</p>
<div class="sourceCode" id="cb60"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/raii_ut.cpp 111</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// RAIIをしない例</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 複数のclose()を書くような関数は、リソースリークを起こしやすい。</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> not_use_RAII_for_socket<span class="op">()</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> fd <span class="op">=</span> socket<span class="op">(</span>AF_INET<span class="op">,</span> SOCK_STREAM<span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span> <span class="op">{</span></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Do something</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>            <span class="op">...</span></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">catch</span> <span class="op">(</span><span class="bu">std::</span>exception<span class="op"> </span><span class="at">const</span><span class="op">&amp;</span> e<span class="op">)</span> <span class="op">{</span>  <span class="co">// エクセプションはconstリファレンスで受ける。</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>            close<span class="op">(</span>fd<span class="op">);</span>                     <span class="co">// NG RAII未使用</span></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Do something to recover</span></span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>            <span class="op">...</span></span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span><span class="op">;</span></span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a>        close<span class="op">(</span>fd<span class="op">);</span>  <span class="co">// NG RAII未使用</span></span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>エクセプションを扱うために関数の2か所でソケットをcloseしている。
この程度であれば大きな問題にはならないだろうが、実際には様々な条件が重なるため、
リソースの解放コードは醜悪にならざるを得ない。</p>
<p>このような場合には、下記するようなリソース解放用クラス</p>
<div class="sourceCode" id="cb61"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ h/scoped_guard.h 4</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@class</span><span class="co"> </span><span class="cv">ScopedGuard</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@brief</span><span class="co"> RAIIのためのクラス。</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">///        コンストラクタ引数の関数オブジェクトをデストラクタから呼び出す。</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> F<span class="op">&gt;</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> ScopedGuard <span class="op">{</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> ScopedGuard<span class="op">(</span>F<span class="op">&amp;&amp;</span> f<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">:</span> <span class="va">f_</span><span class="op">{</span>f<span class="op">}</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>            <span class="co">// f()がill-formedにならず、その戻りがvoidでなければならない</span></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>            <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_invocable_r_v<span class="op">&lt;</span><span class="dt">void</span><span class="op">,</span> F<span class="op">&gt;,</span> <span class="st">&quot;F must be callable and return void&quot;</span><span class="op">);</span></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">~</span>ScopedGuard<span class="op">()</span> <span class="op">{</span> <span class="va">f_</span><span class="op">();</span> <span class="op">}</span></span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>        ScopedGuard<span class="op">(</span>ScopedGuard <span class="at">const</span><span class="op">&amp;)</span>            <span class="op">=</span> <span class="kw">delete</span><span class="op">;</span>  <span class="co">// copyは禁止</span></span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>        ScopedGuard<span class="op">&amp;</span> <span class="kw">operator</span><span class="op">=(</span>ScopedGuard <span class="at">const</span><span class="op">&amp;)</span> <span class="op">=</span> <span class="kw">delete</span><span class="op">;</span>  <span class="co">// copyは禁止</span></span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>        F <span class="va">f_</span><span class="op">;</span></span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>を使用し、下記のようにすることで安全なコードをすっきりと書くことができる。</p>
<div class="sourceCode" id="cb62"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/raii_ut.cpp 138</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// RAIIをScopedGuardで行った例。</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// close()が自動実行されるためにリソース解放を忘れない。</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> use_RAII_for_socket<span class="op">()</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> fd    <span class="op">=</span> socket<span class="op">(</span>AF_INET<span class="op">,</span> SOCK_STREAM<span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> guard <span class="op">=</span> ScopedGuard<span class="op">{[</span>fd<span class="op">]</span> <span class="op">{</span> close<span class="op">(</span>fd<span class="op">);</span> <span class="op">}};</span>  <span class="co">// 関数終了時に自動実行</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span> <span class="op">{</span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Do something</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">catch</span> <span class="op">(...)</span> <span class="op">{</span></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Do something to recover</span></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span><span class="op">;</span></span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>クリティカルセクションの保護をlock/unlockで行うstd::mutex等を使う場合にも、
std::lock_guard&lt;&gt;によってunlockを行うことで、同様の効果が得られる。</p>
<h2 id="future">Future <a id="SS_2_10"></a></h2>
<p><a
href="https://ja.wikipedia.org/wiki/Future_%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3">Future</a>とは、
並行処理のためのデザインパターンであり、別スレッドに何らかの処理をさせる際、
その結果の取得を、必要になるまで後回しにする手法である。</p>
<p>C++11では、std::future, std::promise,
std::asyncによって実現できる。</p>
<p>まずは、C++03以前のスタイルから示す。</p>
<div class="sourceCode" id="cb63"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/future_ut.cpp 11</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> do_something<span class="op">(</span><span class="bu">std::</span>string_view<span class="op"> </span>str0<span class="op">,</span> <span class="bu">std::</span>string_view<span class="op"> </span>str1<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> ret0 <span class="op">+</span> ret1<span class="op">;</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>    TEST<span class="op">(</span>Future<span class="op">,</span> old_style<span class="op">)</span></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> str0 <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{};</span></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> th0  <span class="op">=</span> <span class="bu">std::</span>thread<span class="op">{[&amp;</span>str0<span class="op">]()</span> <span class="kw">noexcept</span> <span class="op">{</span> str0 <span class="op">=</span> do_heavy_algorithm<span class="op">(</span><span class="st">&quot;thread 0&quot;</span><span class="op">);</span> <span class="op">}};</span></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> str1 <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{};</span></span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> th1  <span class="op">=</span> <span class="bu">std::</span>thread<span class="op">{[&amp;</span>str1<span class="op">]()</span> <span class="kw">noexcept</span> <span class="op">{</span> str1 <span class="op">=</span> do_heavy_algorithm<span class="op">(</span><span class="st">&quot;thread 1&quot;</span><span class="op">);</span> <span class="op">}};</span></span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>        <span class="co">//</span></span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>        <span class="co">// このスレッドで行うべき何らかの処理</span></span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>        <span class="co">//</span></span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>        th0<span class="op">.</span>join<span class="op">();</span></span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>        th1<span class="op">.</span>join<span class="op">();</span></span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;THREAD 0&quot;</span><span class="op">,</span> str0<span class="op">);</span></span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;THREAD 1&quot;</span><span class="op">,</span> str1<span class="op">);</span></span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="dv">16</span><span class="op">,</span> do_something<span class="op">(</span>str0<span class="op">,</span> str1<span class="op">));</span></span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>上記は、</p>
<ol type="1">
<li>時間がかかる処理を並行して行うために、スレッドを二つ作る。</li>
<li>それぞれの完了をthread::join()で待ち合わせる。</li>
<li>その結果を参照キャプチャによって受け取る。</li>
<li>その2つの結果を別の関数に渡す。</li>
</ol>
<p>という処理を行っている。</p>
<p>この程度の単純なコードでは特に問題にはならないが、目的外の処理が多いことがわかるだろう。</p>
<p>次にFutureパターンによって上記をリファクタリングした例を示す。</p>
<div class="sourceCode" id="cb64"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/future_ut.cpp 45</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>    TEST<span class="op">(</span>Future<span class="op">,</span> new_style<span class="op">)</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>future<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;</span> result0</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>            <span class="op">=</span> <span class="bu">std::</span>async<span class="op">(</span><span class="bu">std::</span>launch<span class="bu">::</span>async<span class="op">,</span> <span class="op">[]()</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> do_heavy_algorithm<span class="op">(</span><span class="st">&quot;thread 0&quot;</span><span class="op">);</span> <span class="op">});</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>future<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;</span> result1</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>            <span class="op">=</span> <span class="bu">std::</span>async<span class="op">(</span><span class="bu">std::</span>launch<span class="bu">::</span>async<span class="op">,</span> <span class="op">[]()</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> do_heavy_algorithm<span class="op">(</span><span class="st">&quot;thread 1&quot;</span><span class="op">);</span> <span class="op">});</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>        <span class="co">// futre::get()は処理の待ち合わせと値の取り出しを行う。</span></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> str0 <span class="op">=</span> result0<span class="op">.</span>get<span class="op">();</span></span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> str1 <span class="op">=</span> result1<span class="op">.</span>get<span class="op">();</span></span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="dv">16</span><span class="op">,</span> do_something<span class="op">(</span>str0<span class="op">,</span> str1<span class="op">));</span></span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;THREAD 0&quot;</span><span class="op">,</span> str0<span class="op">);</span></span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;THREAD 1&quot;</span><span class="op">,</span> str1<span class="op">);</span></span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>リファクタリングした例では、時間のかかる処理をstd::future型のオブジェクトにし、
その結果を必要とする関数に渡すことができるため、目的をよりダイレクトに表すことができる。</p>
<p>なお、</p>
<div class="sourceCode" id="cb65"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>async<span class="op">(</span>関数オブジェクト<span class="op">)</span></span></code></pre></div>
<p>という形式を使った場合、関数オブジェクトは、</p>
<div class="sourceCode" id="cb66"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>launch<span class="bu">::</span>async<span class="op"> |</span> <span class="bu">std::</span>launch<span class="bu">::</span>deferred</span></code></pre></div>
<p>が指定されたとして実行される。この場合、</p>
<div class="sourceCode" id="cb67"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>launch<span class="bu">::</span>deferred</span></code></pre></div>
<p>の効果により、関数オブジェクトは、並行に実行されるとは限らない
(この仕様はランタイム系に依存しており、std::future::get()のコンテキストで実行されることもあり得る)。
従って、並行実行が必要な場合、上記例のように</p>
<div class="sourceCode" id="cb68"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>launch<span class="bu">::</span>async</span></code></pre></div>
<p>のみを明示的に指定するべきである。</p>
<h2 id="didependency-injection">DI(dependency injection)
<a id="SS_2_11"></a></h2>
<p>メンバ関数内でクラスDependedのオブジェクトを直接、生成する
(もしくは<a
href="#SS_2_12">Singleton</a>オブジェクトや静的オブジェクト(std::coutやstd::cin等)に直接アクセスする)
クラスNotDIがあるとする。
この場合、クラスNotDIはクラスDependedのインスタンスに依存してしまう。
このような依存関係はクラスNotDIの可用性とテスト容易性を下げる。
これは、「仮にクラスDependedがデータベースをラップするクラスだった場合、
クラスNotDIの単体テストにデータベースが必要になる」ことからも容易に理解できる。</p>
<div class="sourceCode" id="cb69"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/di_ut.cpp 8</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@class</span><span class="co"> </span><span class="cv">Depended</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@brief</span><span class="co"> NotDIや、DIから依存されるクラス</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Depended <span class="op">{</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@class</span><span class="co"> </span><span class="cv">NotDI</span></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@brief</span><span class="co"> NotDIを使わない例。そのため、NotDIは、Dependedのインスタンスに依存している。</span></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> NotDI <span class="op">{</span></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>        NotDI<span class="op">()</span> <span class="op">:</span> <span class="va">not_di_depended_</span><span class="op">{</span><span class="bu">std::</span>make_unique<span class="op">&lt;</span>Depended<span class="op">&gt;()}</span> <span class="op">{}</span></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> DoSomething<span class="op">()</span> <span class="op">{</span> <span class="va">not_di_depended_</span><span class="op">-&gt;</span>DoSomething<span class="op">();</span> <span class="op">}</span></span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>Depended<span class="op">&gt;</span> <span class="va">not_di_depended_</span><span class="op">;</span></span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>下記は上記NotDIにDIパターンを適用した例である。
この場合、クラスDIは、クラスDependedの型にのみ依存する。</p>
<div class="sourceCode" id="cb70"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/di_ut.cpp 39</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@class</span><span class="co"> </span><span class="cv">DI</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@brief</span><span class="co"> DIを使う例。そのため、DIは、Dependedの型に依存している。</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> DI <span class="op">{</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> DI<span class="op">(</span><span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>Depended<span class="op">&gt;&amp;&amp;</span> di_depended<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>            <span class="op">:</span> <span class="va">di_depended_</span><span class="op">{</span><span class="bu">std::</span>move<span class="op">(</span>di_depended<span class="op">)}</span></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> DoSomething<span class="op">()</span> <span class="op">{</span> <span class="va">di_depended_</span><span class="op">-&gt;</span>DoSomething<span class="op">();</span> <span class="op">}</span></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>Depended<span class="op">&gt;</span> <span class="va">di_depended_</span><span class="op">;</span></span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>下記は、クラスNotDIとクラスDIがそれぞれのDoSomething()を呼び出すまでのシーケンス図である。</p>
<p>
<img src="data:image/png;base64,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" />
</p>
<p>このパターンの効果により、
DIオブジェクトにはDependedかその派生クラスのオブジェクトを渡すことができるようになった。
これによりクラスDIは拡張性に対して柔軟になっただけでなく、テスト容易性も向上した。</p>
<p>次に示すのは、このパターンを使用して問題のある単体テストを修正した例である。</p>
<p>まずは、問題があるクラスとその単体テストを下記する。</p>
<div class="sourceCode" id="cb71"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// in device_io.h</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> DeviceIO <span class="op">{</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">uint8_t</span> read<span class="op">()</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>            <span class="co">// ハードウェアに依存した何らかの処理</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> write<span class="op">(</span><span class="dt">uint8_t</span> a<span class="op">)</span></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>            <span class="co">// ハードウェアに依存した何らかの処理</span></span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 何らかの宣言</span></span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#ifdef UNIT_TEST       </span><span class="co">// 単体テストビルドでは定義されるマクロ</span></span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> DeviceIO_Mock <span class="op">{</span>  <span class="co">// 単体テスト用のモック</span></span>
<span id="cb71-21"><a href="#cb71-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb71-22"><a href="#cb71-22" aria-hidden="true" tabindex="-1"></a>        <span class="dt">uint8_t</span> read<span class="op">()</span></span>
<span id="cb71-23"><a href="#cb71-23" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb71-24"><a href="#cb71-24" aria-hidden="true" tabindex="-1"></a>            <span class="co">// ハードウェアに依存しない何らかの処理</span></span>
<span id="cb71-25"><a href="#cb71-25" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb71-26"><a href="#cb71-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-27"><a href="#cb71-27" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> write<span class="op">(</span><span class="dt">uint8_t</span> a<span class="op">)</span></span>
<span id="cb71-28"><a href="#cb71-28" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb71-29"><a href="#cb71-29" aria-hidden="true" tabindex="-1"></a>            <span class="co">// ハードウェアに依存しない何らかの処理</span></span>
<span id="cb71-30"><a href="#cb71-30" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb71-31"><a href="#cb71-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-32"><a href="#cb71-32" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb71-33"><a href="#cb71-33" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 何らかの宣言</span></span>
<span id="cb71-34"><a href="#cb71-34" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb71-35"><a href="#cb71-35" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#endif</span></span></code></pre></div>
<div class="sourceCode" id="cb72"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// in widget.h</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#include </span><span class="im">&quot;device_io.h&quot;</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Widget <span class="op">{</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> DoSomething<span class="op">()</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>            <span class="co">// io_を使った何らかの処理</span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>        <span class="dt">uint8_t</span> GetResp<span class="op">()</span></span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>            <span class="co">// io_を使った何らかの処理</span></span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#ifdef UNIT_TEST</span></span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>        DeviceIO_Mock <span class="va">io_</span><span class="op">;</span></span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#else</span></span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a>        DeviceIO <span class="va">io_</span><span class="op">;</span></span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#endif</span></span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb73"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// in widget_ut.cpp</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// UNIT_TESTマクロが定義されたWidgetの単体テスト</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>    Widget w<span class="op">;</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>    w<span class="op">.</span>DoSomething<span class="op">();</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">0</span><span class="op">,</span> w<span class="op">.</span>GetResp<span class="op">());</span></span></code></pre></div>
<p>当然であるが、この単体テストは、UNIT_TESTマクロを定義している場合のWidgetの評価であり、
UNIT_TESTを定義しない実際のコードの評価にはならない。</p>
<p>以下では、DIを用い、この問題を回避する。</p>
<div class="sourceCode" id="cb74"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// in device_io.h</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> DeviceIO <span class="op">{</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">uint8_t</span> read<span class="op">()</span>  <span class="co">// モックでオーバーライドするためvirtual</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>            <span class="co">// ハードウェアに依存した何らかの処理</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span> write<span class="op">(</span><span class="dt">uint8_t</span> a<span class="op">)</span>  <span class="co">// モックでオーバーライドするためvirtual</span></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>            <span class="co">// ハードウェアに依存した何らかの処理</span></span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="op">~</span>DeviceIO<span class="op">()</span> <span class="op">=</span> <span class="cf">default</span><span class="op">;</span></span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 何らかの宣言</span></span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb75"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// in widget.h</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Widget <span class="op">{</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>        Widget<span class="op">(</span><span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>DeviceIO<span class="op">&gt;</span> io <span class="op">=</span> <span class="bu">std::</span>make_unique<span class="op">&lt;</span>DeviceIO<span class="op">&gt;())</span> <span class="op">:</span> <span class="va">io_</span><span class="op">{</span><span class="bu">std::</span>move<span class="op">(</span>io<span class="op">)}</span> <span class="op">{}</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> DoSomething<span class="op">()</span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>            <span class="co">// io_を使った何らかの処理</span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>        <span class="dt">uint8_t</span> GetResp<span class="op">()</span></span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>            <span class="co">// io_を使った何らかの処理</span></span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>DeviceIO<span class="op">&gt;</span> <span class="va">io_</span><span class="op">;</span></span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb76"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// in widget_ut.cpp</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> DeviceIO_Mock <span class="op">:</span> <span class="kw">public</span> DeviceIO <span class="op">{</span>  <span class="co">// 単体テスト用のモック</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">uint8_t</span> read<span class="op">()</span> <span class="kw">override</span></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>            <span class="co">// ハードウェアに依存しない何らかの処理</span></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> write<span class="op">(</span><span class="dt">uint8_t</span> a<span class="op">)</span> <span class="kw">override</span></span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>            <span class="co">// ハードウェアに依存しない何らかの処理</span></span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 何らかの宣言</span></span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb77"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 上記DeviceIO_Mockと同様に、in widget_ut.cpp</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>    Widget w<span class="op">{</span><span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>DeviceIO<span class="op">&gt;(</span><span class="kw">new</span> DeviceIO_Mock<span class="op">)};</span>  <span class="co">// モックのインジェクション</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Widgetの単体テスト</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>    w<span class="op">.</span>DoSomething<span class="op">();</span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">1</span><span class="op">,</span> w<span class="op">.</span>GetResp<span class="op">());</span></span></code></pre></div>
<p>この例では、単体テストのためだけに仮想関数を導入しているため、多少やりすぎの感がある。
そのような場合、下記のようにテンプレートを用いればよい。</p>
<div class="sourceCode" id="cb78"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// in device_io.h</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> DeviceIO <span class="op">{</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">uint8_t</span> read<span class="op">()</span>  <span class="co">// Widgetがテンプレートであるため非virtualで良い</span></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>            <span class="co">// ハードウェアに依存した何らかの処理</span></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> write<span class="op">(</span><span class="dt">uint8_t</span> a<span class="op">)</span>  <span class="co">// Widgetがテンプレートであるため非virtualで良い</span></span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>            <span class="co">// ハードウェアに依存した何らかの処理</span></span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="op">~</span>DeviceIO<span class="op">()</span> <span class="op">=</span> <span class="cf">default</span><span class="op">;</span></span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 何らかの宣言</span></span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb79"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// in widget.h</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">class</span> T <span class="op">=</span> DeviceIO<span class="op">&gt;</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Widget <span class="op">{</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> DoSomething<span class="op">()</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>            <span class="co">// io_を使った何らかの処理</span></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>        <span class="dt">uint8_t</span> GetResp<span class="op">()</span></span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>            <span class="co">// io_を使った何らかの処理</span></span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>        T <span class="va">io_</span><span class="op">;</span></span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb80"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// in widget_ut.cpp</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> DeviceIO_Mock <span class="op">{</span>  <span class="co">// 単体テスト用のモック</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">uint8_t</span> read<span class="op">()</span>  <span class="co">// Widgetがテンプレートであるため非virtualで良い</span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>            <span class="co">// ハードウェアに依存しない何らかの処理</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> write<span class="op">(</span><span class="dt">uint8_t</span> a<span class="op">)</span>  <span class="co">// Widgetがテンプレートであるため非virtualで良い</span></span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>            <span class="co">// ハードウェアに依存しない何らかの処理</span></span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 何らかの宣言</span></span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb81"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 上記DeviceIO_Mockと同様に、in widget_ut.cpp</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>    Widget<span class="op">&lt;</span>DeviceIO_Mock<span class="op">&gt;</span> w<span class="op">;</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Widget&lt;&gt;の単体テスト</span></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>    w<span class="op">.</span>DoSomething<span class="op">();</span></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">2</span><span class="op">,</span> w<span class="op">.</span>GetResp<span class="op">());</span></span></code></pre></div>
<p>以上からわかるように、
ここで紹介したDIは単体テストを容易にするクラス設計のためにも非常に有用なパターンである。</p>
<h2 id="singleton">Singleton <a id="SS_2_12"></a></h2>
<p>このパターンにより、特定のクラスのインスタンスをシステム全体で唯一にすることができる。
これにより、グローバルオブジェクトを規律正しく使用しやすくなる。</p>
<p>以下は、Singletonの実装例である。</p>
<div class="sourceCode" id="cb82"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/singleton_ut.cpp 7</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Singleton <span class="kw">final</span> <span class="op">{</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> Singleton<span class="op">&amp;</span>       Inst<span class="op">();</span></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> Singleton <span class="at">const</span><span class="op">&amp;</span> InstConst<span class="op">()</span> <span class="kw">noexcept</span>  <span class="co">// constインスタンスを返す</span></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> Inst<span class="op">();</span></span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a>        Singleton<span class="op">()</span> <span class="kw">noexcept</span> <span class="op">{}</span>  <span class="co">// コンストラクタをprivateにすることで、</span></span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a>                                 <span class="co">// Inst()以外ではこのオブジェクトを生成できない。</span></span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb82-17"><a href="#cb82-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-18"><a href="#cb82-18" aria-hidden="true" tabindex="-1"></a>    Singleton<span class="op">&amp;</span> Singleton<span class="op">::</span>Inst<span class="op">()</span></span>
<span id="cb82-19"><a href="#cb82-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb82-20"><a href="#cb82-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> Singleton inst<span class="op">;</span>  <span class="co">//  instの初期化が同時に行われることはない。</span></span>
<span id="cb82-21"><a href="#cb82-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-22"><a href="#cb82-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> inst<span class="op">;</span></span>
<span id="cb82-23"><a href="#cb82-23" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb82-24"><a href="#cb82-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-25"><a href="#cb82-25" aria-hidden="true" tabindex="-1"></a>    TEST<span class="op">(</span>Singleton<span class="op">,</span> how_to_use<span class="op">)</span></span>
<span id="cb82-26"><a href="#cb82-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb82-27"><a href="#cb82-27" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span><span class="op">&amp;</span>       inst       <span class="op">=</span> Singleton<span class="op">::</span>Inst<span class="op">();</span></span>
<span id="cb82-28"><a href="#cb82-28" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> <span class="at">const</span><span class="op">&amp;</span> inst_const <span class="op">=</span> Singleton<span class="op">::</span>InstConst<span class="op">();</span></span>
<span id="cb82-29"><a href="#cb82-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-30"><a href="#cb82-30" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="dv">0</span><span class="op">,</span> inst<span class="op">.</span>GetXxx<span class="op">());</span></span>
<span id="cb82-31"><a href="#cb82-31" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="dv">0</span><span class="op">,</span> inst_const<span class="op">.</span>GetXxx<span class="op">());</span></span>
<span id="cb82-32"><a href="#cb82-32" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#if 0</span></span>
<span id="cb82-33"><a href="#cb82-33" aria-hidden="true" tabindex="-1"></a><span class="co">        inst_const.SetXxx(10);  // inst_constはconstオブジェクトなのでコンパイルエラー</span></span>
<span id="cb82-34"><a href="#cb82-34" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="pp">#else</span></span>
<span id="cb82-35"><a href="#cb82-35" aria-hidden="true" tabindex="-1"></a>        inst<span class="op">.</span>SetXxx<span class="op">(</span><span class="dv">10</span><span class="op">);</span></span>
<span id="cb82-36"><a href="#cb82-36" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#endif</span></span>
<span id="cb82-37"><a href="#cb82-37" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="dv">10</span><span class="op">,</span> inst<span class="op">.</span>GetXxx<span class="op">());</span></span>
<span id="cb82-38"><a href="#cb82-38" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="dv">10</span><span class="op">,</span> inst_const<span class="op">.</span>GetXxx<span class="op">());</span></span>
<span id="cb82-39"><a href="#cb82-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-40"><a href="#cb82-40" aria-hidden="true" tabindex="-1"></a>        inst<span class="op">.</span>SetXxx<span class="op">(</span><span class="dv">0</span><span class="op">);</span></span>
<span id="cb82-41"><a href="#cb82-41" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="dv">0</span><span class="op">,</span> inst<span class="op">.</span>GetXxx<span class="op">());</span></span>
<span id="cb82-42"><a href="#cb82-42" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="dv">0</span><span class="op">,</span> inst_const<span class="op">.</span>GetXxx<span class="op">());</span></span>
<span id="cb82-43"><a href="#cb82-43" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb82-44"><a href="#cb82-44" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace</span></span></code></pre></div>
<p>このパターンを使用する場合、以下に注意する。</p>
<ul>
<li>Singletonはデザインパターンの中でも、特にパターン猿病を発生しやすい。
Singletonは「ほとんどグローバル変数である」ことを理解した上で、控えめに使用する。</li>
<li>Singletonを定義する場合、以下の二つを定義する。
<ul>
<li>インスタンスを返すstaticメンバ関数Inst()</li>
<li>constインスタンスを返すstaticメンバ関数InstConst()</li>
</ul></li>
<li>InstConst()は、Inst()が返すオブジェクトと同じオブジェクトを返すようにする。</li>
<li>Singletonには、可能な限りInstConst()経由でアクセスする。</li>
</ul>
<p>Singletonオブジェクトの初期化(最初のコンストラクタ呼び出し)は、
C++03以前はスレッドセーフでなかったため、「 Double Checked
Lockingを使って競合を避ける」か、
「他のスレッドを起動する前にメインスレッドから各SingletonのInstConst()を呼び出す」
ことが必要であった。
C++11から上記例のようなSingletonオブジェクトのコンストラクタ呼び出しはスレッドセーフとなったため、
このような黒魔術が不要になった。</p>
<p>なお、Inst()のような関数を複数定義する場合、そのパターンはNamed
Constructor (「<a href="#SS_2_17">Named
Constructor</a>」参照)と呼ばれる。</p>
<h2 id="state">State <a id="SS_2_13"></a></h2>
<p>Stateは、オブジェクトの状態と、それに伴う振る舞いを分離して記述するためのパターンである。
これにより状態の追加、削減、変更に伴う修正範囲が限定される (「<a
href="#SS_1_2">オープン・クローズドの原則(OCP)</a>」参照)。
またオブジェクトのインターフェース変更(パブリックメンバ関数の変更)に関しても、修正箇所が明確になる。</p>
<p>
<img src="data:image/png;base64,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" />
</p>
<p>上記ステートマシン図の「オールドスタイルによる実装」と、「stateパターンによる実装」、
それぞれを例示する。</p>
<p>まずは、下記にオールドスタイルな実装例を示す。
この実装では、状態を静的なenum変数thread_old_style_stateで管理するため、
ThreadOldStyleStateStr()、ThreadOldStyleRun()、ThreadOldStyleAbort()、ThreadOldStyleSuspend()
には、thread_old_style_stateに対する同型のswitch文が入ることになる(下記例では一部省略)。
これは醜悪で、バグを起こしやすい構造である。
ただし、要求される状態遷移がこの例程度であり、状態ごとに決められた振る舞いの数が少なければ、
この構造でも問題ないともいえる。</p>
<div class="sourceCode" id="cb83"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/state_machine_old.h 4</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">extern</span> <span class="bu">std::</span>string_view<span class="op"> </span>ThreadOldStyleStateStr<span class="op">()</span> <span class="kw">noexcept</span><span class="op">;</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">extern</span> <span class="dt">void</span>             ThreadOldStyleRun<span class="op">();</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">extern</span> <span class="dt">void</span>             ThreadOldStyleAbort<span class="op">();</span></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">extern</span> <span class="dt">void</span>             ThreadOldStyleSuspend<span class="op">();</span></span></code></pre></div>
<div class="sourceCode" id="cb84"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/state_machine_old.cpp 6</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> <span class="op">{</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">enum</span> <span class="kw">class</span> ThreadOldStyleState <span class="op">{</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>        Idle<span class="op">,</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>        Running<span class="op">,</span></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>        Suspending<span class="op">,</span></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>    ThreadOldStyleState thread_old_style_state<span class="op">;</span></span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span></span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace</span></span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>string_view<span class="op"> </span>ThreadOldStyleStateStr<span class="op">()</span> <span class="kw">noexcept</span></span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">switch</span> <span class="op">(</span>thread_old_style_state<span class="op">)</span> <span class="op">{</span>  <span class="co">// このswitch文と同型switch文が何度も記述される</span></span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> ThreadOldStyleState<span class="op">::</span>Idle<span class="op">:</span></span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&quot;Idle&quot;</span><span class="op">;</span></span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> ThreadOldStyleState<span class="op">::</span>Running<span class="op">:</span></span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&quot;Running&quot;</span><span class="op">;</span></span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> ThreadOldStyleState<span class="op">::</span>Suspending<span class="op">:</span></span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&quot;Suspending&quot;</span><span class="op">;</span></span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">default</span><span class="op">:</span></span>
<span id="cb84-24"><a href="#cb84-24" aria-hidden="true" tabindex="-1"></a>            <span class="ot">assert</span><span class="op">(</span><span class="kw">false</span><span class="op">);</span></span>
<span id="cb84-25"><a href="#cb84-25" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&quot;&quot;</span><span class="op">;</span></span>
<span id="cb84-26"><a href="#cb84-26" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb84-27"><a href="#cb84-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb84-28"><a href="#cb84-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-29"><a href="#cb84-29" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> ThreadOldStyleRun<span class="op">()</span></span>
<span id="cb84-30"><a href="#cb84-30" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb84-31"><a href="#cb84-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">switch</span> <span class="op">(</span>thread_old_style_state<span class="op">)</span> <span class="op">{</span></span>
<span id="cb84-32"><a href="#cb84-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> ThreadOldStyleState<span class="op">::</span>Idle<span class="op">:</span></span>
<span id="cb84-33"><a href="#cb84-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> ThreadOldStyleState<span class="op">::</span>Running<span class="op">:</span></span>
<span id="cb84-34"><a href="#cb84-34" aria-hidden="true" tabindex="-1"></a>            thread_old_style_state <span class="op">=</span> ThreadOldStyleState<span class="op">::</span>Running<span class="op">;</span></span>
<span id="cb84-35"><a href="#cb84-35" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span><span class="op">;</span></span>
<span id="cb84-36"><a href="#cb84-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> ThreadOldStyleState<span class="op">::</span>Suspending<span class="op">:</span></span>
<span id="cb84-37"><a href="#cb84-37" aria-hidden="true" tabindex="-1"></a>            <span class="op">--</span>thread_old_style_suspend_count<span class="op">;</span></span>
<span id="cb84-38"><a href="#cb84-38" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>thread_old_style_suspend_count <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb84-39"><a href="#cb84-39" aria-hidden="true" tabindex="-1"></a>                thread_old_style_state <span class="op">=</span> ThreadOldStyleState<span class="op">::</span>Running<span class="op">;</span></span>
<span id="cb84-40"><a href="#cb84-40" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb84-41"><a href="#cb84-41" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span><span class="op">;</span></span>
<span id="cb84-42"><a href="#cb84-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">default</span><span class="op">:</span></span>
<span id="cb84-43"><a href="#cb84-43" aria-hidden="true" tabindex="-1"></a>            <span class="ot">assert</span><span class="op">(</span><span class="kw">false</span><span class="op">);</span></span>
<span id="cb84-44"><a href="#cb84-44" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb84-45"><a href="#cb84-45" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb84-46"><a href="#cb84-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-47"><a href="#cb84-47" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> ThreadOldStyleAbort<span class="op">()</span></span>
<span id="cb84-48"><a href="#cb84-48" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb84-49"><a href="#cb84-49" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb84-50"><a href="#cb84-50" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb84-51"><a href="#cb84-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-52"><a href="#cb84-52" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> ThreadOldStyleSuspend<span class="op">()</span></span>
<span id="cb84-53"><a href="#cb84-53" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb84-54"><a href="#cb84-54" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb84-55"><a href="#cb84-55" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb85"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/state_machine_ut.cpp 15</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ステートのテスト。仕様書よりも単体テストでその仕様や使用法を記述したほうが正確に理解できる。</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>    TEST<span class="op">(</span>StateMachine<span class="op">,</span> old_style<span class="op">)</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;Idle&quot;</span><span class="op">,</span> ThreadOldStyleStateStr<span class="op">());</span></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>        ThreadOldStyleAbort<span class="op">();</span></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;Idle&quot;</span><span class="op">,</span> ThreadOldStyleStateStr<span class="op">());</span></span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>        ThreadOldStyleRun<span class="op">();</span></span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;Running&quot;</span><span class="op">,</span> ThreadOldStyleStateStr<span class="op">());</span></span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a>        ThreadOldStyleRun<span class="op">();</span></span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;Running&quot;</span><span class="op">,</span> ThreadOldStyleStateStr<span class="op">());</span></span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-17"><a href="#cb85-17" aria-hidden="true" tabindex="-1"></a>        ThreadOldStyleSuspend<span class="op">();</span></span>
<span id="cb85-18"><a href="#cb85-18" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;Suspending&quot;</span><span class="op">,</span> ThreadOldStyleStateStr<span class="op">());</span>  <span class="co">// suspend_count_ == 1</span></span>
<span id="cb85-19"><a href="#cb85-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-20"><a href="#cb85-20" aria-hidden="true" tabindex="-1"></a>        ThreadOldStyleSuspend<span class="op">();</span></span>
<span id="cb85-21"><a href="#cb85-21" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;Suspending&quot;</span><span class="op">,</span> ThreadOldStyleStateStr<span class="op">());</span>  <span class="co">// suspend_count_ == 2</span></span>
<span id="cb85-22"><a href="#cb85-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-23"><a href="#cb85-23" aria-hidden="true" tabindex="-1"></a>        ThreadOldStyleRun<span class="op">();</span></span>
<span id="cb85-24"><a href="#cb85-24" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;Suspending&quot;</span><span class="op">,</span> ThreadOldStyleStateStr<span class="op">());</span>  <span class="co">// suspend_count_ == 1</span></span>
<span id="cb85-25"><a href="#cb85-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-26"><a href="#cb85-26" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb85-27"><a href="#cb85-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>下記は、上記例へstateパターンを適用した例である。
まずは、stateパターンを形成するクラスの関係をクラス図で示す。</p>
<p>
<img src="data:image/png;base64,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" />
</p>
<p>次に上記クラス図の実装例を示す。</p>
<div class="sourceCode" id="cb86"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/state_machine_new.h 6</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@class</span><span class="co"> </span><span class="cv">ThreadNewStyleState</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@brief</span><span class="co"> ThreadNewStyleのステートを表す基底クラス</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> ThreadNewStyleState <span class="op">{</span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>        ThreadNewStyleState<span class="op">()</span>          <span class="op">=</span> <span class="cf">default</span><span class="op">;</span></span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="op">~</span>ThreadNewStyleState<span class="op">()</span> <span class="op">=</span> <span class="cf">default</span><span class="op">;</span></span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>ThreadNewStyleState<span class="op">&gt;</span> Abort<span class="op">()</span>  <span class="co">// NVI</span></span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> abort_thread<span class="op">();</span></span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>ThreadNewStyleState<span class="op">&gt;</span> Run<span class="op">()</span>  <span class="co">// NVI</span></span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> run_thread<span class="op">();</span></span>
<span id="cb86-18"><a href="#cb86-18" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb86-19"><a href="#cb86-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-20"><a href="#cb86-20" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>ThreadNewStyleState<span class="op">&gt;</span> Suspend<span class="op">()</span>  <span class="co">// NVI</span></span>
<span id="cb86-21"><a href="#cb86-21" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb86-22"><a href="#cb86-22" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> suspend_thread<span class="op">();</span></span>
<span id="cb86-23"><a href="#cb86-23" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb86-24"><a href="#cb86-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-25"><a href="#cb86-25" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string_view<span class="op"> </span>GetStateStr<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> get_state_str<span class="op">();</span> <span class="op">}</span></span>
<span id="cb86-26"><a href="#cb86-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-27"><a href="#cb86-27" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb86-28"><a href="#cb86-28" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>ThreadNewStyleState<span class="op">&gt;</span> abort_thread<span class="op">()</span></span>
<span id="cb86-29"><a href="#cb86-29" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb86-30"><a href="#cb86-30" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="op">{};</span>  <span class="co">// デフォルトでは何もしない。</span></span>
<span id="cb86-31"><a href="#cb86-31" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb86-32"><a href="#cb86-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-33"><a href="#cb86-33" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>ThreadNewStyleState<span class="op">&gt;</span> run_thread<span class="op">()</span></span>
<span id="cb86-34"><a href="#cb86-34" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb86-35"><a href="#cb86-35" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="op">{};</span>  <span class="co">// デフォルトでは何もしない。</span></span>
<span id="cb86-36"><a href="#cb86-36" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb86-37"><a href="#cb86-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-38"><a href="#cb86-38" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>ThreadNewStyleState<span class="op">&gt;</span> suspend_thread<span class="op">()</span></span>
<span id="cb86-39"><a href="#cb86-39" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb86-40"><a href="#cb86-40" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="op">{};</span>  <span class="co">// デフォルトでは何もしない。</span></span>
<span id="cb86-41"><a href="#cb86-41" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb86-42"><a href="#cb86-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-43"><a href="#cb86-43" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="bu">std::</span>string_view<span class="op"> </span>get_state_str<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb86-44"><a href="#cb86-44" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb87"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/state_machine_new.h 52</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> ThreadNewStyle <span class="kw">final</span> <span class="op">{</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>        ThreadNewStyle<span class="op">();</span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> Abort<span class="op">()</span> <span class="op">{</span> change_state<span class="op">(</span><span class="va">state_</span><span class="op">-&gt;</span>Abort<span class="op">());</span> <span class="op">}</span></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> Run<span class="op">()</span> <span class="op">{</span> change_state<span class="op">(</span><span class="va">state_</span><span class="op">-&gt;</span>Run<span class="op">());</span> <span class="op">}</span></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> Suspend<span class="op">()</span> <span class="op">{</span> change_state<span class="op">(</span><span class="va">state_</span><span class="op">-&gt;</span>Suspend<span class="op">());</span> <span class="op">}</span></span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string_view<span class="op"> </span>GetStateStr<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">state_</span><span class="op">-&gt;</span>GetStateStr<span class="op">();</span> <span class="op">}</span></span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>ThreadNewStyleState<span class="op">&gt;</span> <span class="va">state_</span><span class="op">;</span></span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> change_state<span class="op">(</span><span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>ThreadNewStyleState<span class="op">&gt;&amp;&amp;</span> new_state<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb87-20"><a href="#cb87-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>new_state<span class="op">)</span> <span class="op">{</span></span>
<span id="cb87-21"><a href="#cb87-21" aria-hidden="true" tabindex="-1"></a>                <span class="va">state_</span> <span class="op">=</span> <span class="bu">std::</span>move<span class="op">(</span>new_state<span class="op">);</span></span>
<span id="cb87-22"><a href="#cb87-22" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb87-23"><a href="#cb87-23" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb87-24"><a href="#cb87-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb88"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/state_machine_new.cpp 10</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> ThreadNewStyleState_Idle <span class="kw">final</span> <span class="op">:</span> <span class="kw">public</span> ThreadNewStyleState <span class="op">{</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> ThreadNewStyleState_Running <span class="kw">final</span> <span class="op">:</span> <span class="kw">public</span> ThreadNewStyleState <span class="op">{</span></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> ThreadNewStyleState_Suspending <span class="kw">final</span> <span class="op">:</span> <span class="kw">public</span> ThreadNewStyleState <span class="op">{</span></span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>ThreadNewStyleState<span class="op">&gt;</span> abort_thread<span class="op">()</span> <span class="kw">override</span></span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb88-17"><a href="#cb88-17" aria-hidden="true" tabindex="-1"></a>            <span class="co">// do something to abort</span></span>
<span id="cb88-18"><a href="#cb88-18" aria-hidden="true" tabindex="-1"></a>            <span class="op">...</span></span>
<span id="cb88-19"><a href="#cb88-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-20"><a href="#cb88-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="bu">std::</span>make_unique<span class="op">&lt;</span>ThreadNewStyleState_Idle<span class="op">&gt;();</span></span>
<span id="cb88-21"><a href="#cb88-21" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb88-22"><a href="#cb88-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-23"><a href="#cb88-23" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>ThreadNewStyleState<span class="op">&gt;</span> run_thread<span class="op">()</span> <span class="kw">override</span></span>
<span id="cb88-24"><a href="#cb88-24" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb88-25"><a href="#cb88-25" aria-hidden="true" tabindex="-1"></a>            <span class="op">--</span><span class="va">suspend_count_</span><span class="op">;</span></span>
<span id="cb88-26"><a href="#cb88-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-27"><a href="#cb88-27" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span><span class="va">suspend_count_</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb88-28"><a href="#cb88-28" aria-hidden="true" tabindex="-1"></a>                <span class="co">// do something to resume</span></span>
<span id="cb88-29"><a href="#cb88-29" aria-hidden="true" tabindex="-1"></a>                <span class="op">...</span></span>
<span id="cb88-30"><a href="#cb88-30" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="bu">std::</span>make_unique<span class="op">&lt;</span>ThreadNewStyleState_Running<span class="op">&gt;();</span></span>
<span id="cb88-31"><a href="#cb88-31" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb88-32"><a href="#cb88-32" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb88-33"><a href="#cb88-33" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="op">{};</span></span>
<span id="cb88-34"><a href="#cb88-34" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb88-35"><a href="#cb88-35" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb88-36"><a href="#cb88-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-37"><a href="#cb88-37" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>ThreadNewStyleState<span class="op">&gt;</span> suspend_thread<span class="op">()</span> <span class="kw">override</span></span>
<span id="cb88-38"><a href="#cb88-38" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb88-39"><a href="#cb88-39" aria-hidden="true" tabindex="-1"></a>            <span class="op">++</span><span class="va">suspend_count_</span><span class="op">;</span></span>
<span id="cb88-40"><a href="#cb88-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-41"><a href="#cb88-41" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="op">{};</span></span>
<span id="cb88-42"><a href="#cb88-42" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb88-43"><a href="#cb88-43" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb88-44"><a href="#cb88-44" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb89"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/state_machine_ut.cpp 57</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>    TEST<span class="op">(</span>StateMachine<span class="op">,</span> new_style<span class="op">)</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> tns <span class="op">=</span> ThreadNewStyle<span class="op">{};</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;Idle&quot;</span><span class="op">,</span> tns<span class="op">.</span>GetStateStr<span class="op">());</span></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>        tns<span class="op">.</span>Abort<span class="op">();</span></span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;Idle&quot;</span><span class="op">,</span> tns<span class="op">.</span>GetStateStr<span class="op">());</span></span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>        tns<span class="op">.</span>Run<span class="op">();</span></span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;Running&quot;</span><span class="op">,</span> tns<span class="op">.</span>GetStateStr<span class="op">());</span></span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a>        tns<span class="op">.</span>Run<span class="op">();</span></span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;Running&quot;</span><span class="op">,</span> tns<span class="op">.</span>GetStateStr<span class="op">());</span></span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-18"><a href="#cb89-18" aria-hidden="true" tabindex="-1"></a>        tns<span class="op">.</span>Suspend<span class="op">();</span></span>
<span id="cb89-19"><a href="#cb89-19" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;Suspending&quot;</span><span class="op">,</span> tns<span class="op">.</span>GetStateStr<span class="op">());</span>  <span class="co">// suspend_count_ == 1</span></span>
<span id="cb89-20"><a href="#cb89-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-21"><a href="#cb89-21" aria-hidden="true" tabindex="-1"></a>        tns<span class="op">.</span>Suspend<span class="op">();</span></span>
<span id="cb89-22"><a href="#cb89-22" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;Suspending&quot;</span><span class="op">,</span> tns<span class="op">.</span>GetStateStr<span class="op">());</span>  <span class="co">// suspend_count_ == 2</span></span>
<span id="cb89-23"><a href="#cb89-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-24"><a href="#cb89-24" aria-hidden="true" tabindex="-1"></a>        tns<span class="op">.</span>Run<span class="op">();</span></span>
<span id="cb89-25"><a href="#cb89-25" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;Suspending&quot;</span><span class="op">,</span> tns<span class="op">.</span>GetStateStr<span class="op">());</span>  <span class="co">// suspend_count_ == 1</span></span>
<span id="cb89-26"><a href="#cb89-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-27"><a href="#cb89-27" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb89-28"><a href="#cb89-28" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>オールドスタイルな構造に比べると一見複雑に見えるが同型のswitch構造がないため、
状態の増減や振る舞いの変更等への対応が容易である。
一方で、前述したとおり、この例程度の要求であれば、
シンプルさという意味においてオールドスタイルのソースコードの方が優れているともいえる。
従って、オールドスタイルとstateパターンの選択は、
その要求の複雑さと安定度によって決定されるべきものである。</p>
<p>なお、C++でのstateパターンの実装には、下記に示すようなメンバ関数を使う方法もある。
多くのクラスを作る必要はないが、
各状態での状態管理変数を別の状態のものと分けて管理することができないため、
複雑な状態管理が必要な場合には使えないが、単純な状態管理で十分な場合には便利なパターンである。</p>
<div class="sourceCode" id="cb90"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/state_machine_new.h 77</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> ThreadNewStyle2 <span class="kw">final</span> <span class="op">{</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>        ThreadNewStyle2<span class="op">()</span> <span class="kw">noexcept</span> <span class="op">{}</span></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span>             Abort<span class="op">()</span> <span class="op">{</span> <span class="op">(</span><span class="kw">this</span><span class="op">-&gt;*</span><span class="va">abort_</span><span class="op">)();</span> <span class="op">}</span></span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span>             Run<span class="op">()</span> <span class="op">{</span> <span class="op">(</span><span class="kw">this</span><span class="op">-&gt;*</span><span class="va">run_</span><span class="op">)();</span> <span class="op">}</span></span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span>             Suspend<span class="op">()</span> <span class="op">{</span> <span class="op">(</span><span class="kw">this</span><span class="op">-&gt;*</span><span class="va">suspend_</span><span class="op">)();</span> <span class="op">}</span></span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string_view<span class="op"> </span>GetStateStr<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">state_str_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> <span class="op">(</span>ThreadNewStyle2<span class="op">::*</span><span class="va">abort_</span><span class="op">)()</span>   <span class="op">=</span> <span class="op">&amp;</span>ThreadNewStyle2<span class="op">::</span>abort_idle<span class="op">;</span></span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> <span class="op">(</span>ThreadNewStyle2<span class="op">::*</span><span class="va">run_</span><span class="op">)()</span>     <span class="op">=</span> <span class="op">&amp;</span>ThreadNewStyle2<span class="op">::</span>run_idle<span class="op">;</span></span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> <span class="op">(</span>ThreadNewStyle2<span class="op">::*</span><span class="va">suspend_</span><span class="op">)()</span> <span class="op">=</span> <span class="op">&amp;</span>ThreadNewStyle2<span class="op">::</span>suspend_idle<span class="op">;</span></span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string_view<span class="op"> </span><span class="va">state_str_</span><span class="op">{</span><span class="va">state_str_idle_</span><span class="op">};</span></span>
<span id="cb90-17"><a href="#cb90-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-18"><a href="#cb90-18" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span>                                 abort_idle<span class="op">()</span> <span class="op">{}</span>  <span class="co">// do nothing</span></span>
<span id="cb90-19"><a href="#cb90-19" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span>                                 run_idle<span class="op">();</span></span>
<span id="cb90-20"><a href="#cb90-20" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span>                                 suspend_idle<span class="op">()</span> <span class="op">{}</span>  <span class="co">// do nothing</span></span>
<span id="cb90-21"><a href="#cb90-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="kw">inline</span> <span class="bu">std::</span>string_view<span class="op"> </span><span class="at">const</span> <span class="va">state_str_idle_</span><span class="op">{</span><span class="st">&quot;Idle&quot;</span><span class="op">};</span></span>
<span id="cb90-22"><a href="#cb90-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-23"><a href="#cb90-23" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span>                                 abort_running<span class="op">();</span></span>
<span id="cb90-24"><a href="#cb90-24" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span>                                 run_running<span class="op">()</span> <span class="op">{}</span>  <span class="co">// do nothing</span></span>
<span id="cb90-25"><a href="#cb90-25" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span>                                 suspend_running<span class="op">();</span></span>
<span id="cb90-26"><a href="#cb90-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="kw">inline</span> <span class="bu">std::</span>string_view<span class="op"> </span><span class="at">const</span> <span class="va">state_str_running_</span><span class="op">{</span><span class="st">&quot;Running&quot;</span><span class="op">};</span></span>
<span id="cb90-27"><a href="#cb90-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-28"><a href="#cb90-28" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span>                                 abort_suspending<span class="op">();</span></span>
<span id="cb90-29"><a href="#cb90-29" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span>                                 run_suspending<span class="op">();</span></span>
<span id="cb90-30"><a href="#cb90-30" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span>                                 suspend_suspending<span class="op">()</span> <span class="op">{}</span>  <span class="co">// do nothing</span></span>
<span id="cb90-31"><a href="#cb90-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="kw">inline</span> <span class="bu">std::</span>string_view<span class="op"> </span><span class="at">const</span> <span class="va">state_str_suspending_</span><span class="op">{</span><span class="st">&quot;Suspending&quot;</span><span class="op">};</span></span>
<span id="cb90-32"><a href="#cb90-32" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb91"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/state_machine_new.cpp 106</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> ThreadNewStyle2<span class="op">::</span>run_idle<span class="op">()</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>        <span class="co">// スレッドの始動処理</span></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>        <span class="co">// ステートの切り替え</span></span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">run_</span>       <span class="op">=</span> <span class="op">&amp;</span>ThreadNewStyle2<span class="op">::</span>run_running<span class="op">;</span></span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">suspend_</span>   <span class="op">=</span> <span class="op">&amp;</span>ThreadNewStyle2<span class="op">::</span>suspend_running<span class="op">;</span></span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">state_str_</span> <span class="op">=</span> <span class="va">state_str_running_</span><span class="op">;</span></span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> ThreadNewStyle2<span class="op">::</span>abort_running<span class="op">()</span></span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a>        <span class="co">// スレッドのアボート処理</span></span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true" tabindex="-1"></a>        <span class="co">// ステートの切り替え</span></span>
<span id="cb91-20"><a href="#cb91-20" aria-hidden="true" tabindex="-1"></a>        <span class="va">run_</span>       <span class="op">=</span> <span class="op">&amp;</span>ThreadNewStyle2<span class="op">::</span>run_idle<span class="op">;</span></span>
<span id="cb91-21"><a href="#cb91-21" aria-hidden="true" tabindex="-1"></a>        <span class="va">suspend_</span>   <span class="op">=</span> <span class="op">&amp;</span>ThreadNewStyle2<span class="op">::</span>suspend_idle<span class="op">;</span></span>
<span id="cb91-22"><a href="#cb91-22" aria-hidden="true" tabindex="-1"></a>        <span class="va">state_str_</span> <span class="op">=</span> <span class="va">state_str_idle_</span><span class="op">;</span></span>
<span id="cb91-23"><a href="#cb91-23" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb91-24"><a href="#cb91-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-25"><a href="#cb91-25" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> ThreadNewStyle2<span class="op">::</span>suspend_running<span class="op">()</span></span>
<span id="cb91-26"><a href="#cb91-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb91-27"><a href="#cb91-27" aria-hidden="true" tabindex="-1"></a>        <span class="co">// スレッドのサスペンド処理</span></span>
<span id="cb91-28"><a href="#cb91-28" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb91-29"><a href="#cb91-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-30"><a href="#cb91-30" aria-hidden="true" tabindex="-1"></a>        <span class="co">// ステートの切り替え</span></span>
<span id="cb91-31"><a href="#cb91-31" aria-hidden="true" tabindex="-1"></a>        <span class="va">run_</span>       <span class="op">=</span> <span class="op">&amp;</span>ThreadNewStyle2<span class="op">::</span>run_suspending<span class="op">;</span></span>
<span id="cb91-32"><a href="#cb91-32" aria-hidden="true" tabindex="-1"></a>        <span class="va">suspend_</span>   <span class="op">=</span> <span class="op">&amp;</span>ThreadNewStyle2<span class="op">::</span>suspend_suspending<span class="op">;</span></span>
<span id="cb91-33"><a href="#cb91-33" aria-hidden="true" tabindex="-1"></a>        <span class="va">state_str_</span> <span class="op">=</span> <span class="va">state_str_suspending_</span><span class="op">;</span></span>
<span id="cb91-34"><a href="#cb91-34" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb91-35"><a href="#cb91-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-36"><a href="#cb91-36" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> ThreadNewStyle2<span class="op">::</span>run_suspending<span class="op">()</span></span>
<span id="cb91-37"><a href="#cb91-37" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb91-38"><a href="#cb91-38" aria-hidden="true" tabindex="-1"></a>        <span class="co">// スレッドのレジューム処理</span></span>
<span id="cb91-39"><a href="#cb91-39" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb91-40"><a href="#cb91-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-41"><a href="#cb91-41" aria-hidden="true" tabindex="-1"></a>        <span class="co">// ステートの切り替え</span></span>
<span id="cb91-42"><a href="#cb91-42" aria-hidden="true" tabindex="-1"></a>        <span class="va">run_</span>       <span class="op">=</span> <span class="op">&amp;</span>ThreadNewStyle2<span class="op">::</span>run_running<span class="op">;</span></span>
<span id="cb91-43"><a href="#cb91-43" aria-hidden="true" tabindex="-1"></a>        <span class="va">suspend_</span>   <span class="op">=</span> <span class="op">&amp;</span>ThreadNewStyle2<span class="op">::</span>suspend_running<span class="op">;</span></span>
<span id="cb91-44"><a href="#cb91-44" aria-hidden="true" tabindex="-1"></a>        <span class="va">state_str_</span> <span class="op">=</span> <span class="va">state_str_running_</span><span class="op">;</span></span>
<span id="cb91-45"><a href="#cb91-45" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb92"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/state_machine_ut.cpp 95</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>    TEST<span class="op">(</span>StateMachine<span class="op">,</span> new_style2<span class="op">)</span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> tns <span class="op">=</span> ThreadNewStyle2<span class="op">{};</span></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;Idle&quot;</span><span class="op">,</span> tns<span class="op">.</span>GetStateStr<span class="op">());</span></span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>        tns<span class="op">.</span>Run<span class="op">();</span></span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;Running&quot;</span><span class="op">,</span> tns<span class="op">.</span>GetStateStr<span class="op">());</span></span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a>        tns<span class="op">.</span>Suspend<span class="op">();</span></span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;Suspending&quot;</span><span class="op">,</span> tns<span class="op">.</span>GetStateStr<span class="op">());</span></span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a>        tns<span class="op">.</span>Suspend<span class="op">();</span></span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;Suspending&quot;</span><span class="op">,</span> tns<span class="op">.</span>GetStateStr<span class="op">());</span></span>
<span id="cb92-17"><a href="#cb92-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<h2 id="null-object">Null Object <a id="SS_2_14"></a></h2>
<p>オブジェクトへのポインタを受け取った関数が
「そのポインタがnullptrでない場合、そのポインタが指すオブジェクトに何かをさせる」
というような典型的な条件文を削減するためのパターンである。</p>
<div class="sourceCode" id="cb93"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/null_object_ut.cpp 7</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> A <span class="op">{</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">bool</span> Action<span class="op">()</span> <span class="kw">noexcept</span></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>            <span class="co">// do something</span></span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>            <span class="op">...</span></span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> result<span class="op">;</span></span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bool</span> ActionOldStyle<span class="op">(</span>A<span class="op">*</span> a<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb93-16"><a href="#cb93-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb93-17"><a href="#cb93-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>a <span class="op">!=</span> <span class="kw">nullptr</span><span class="op">)</span> <span class="op">{</span>  <span class="co">// ←このif文を消すためのパターン。</span></span>
<span id="cb93-18"><a href="#cb93-18" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> a<span class="op">-&gt;</span>Action<span class="op">();</span></span>
<span id="cb93-19"><a href="#cb93-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb93-20"><a href="#cb93-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb93-21"><a href="#cb93-21" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb93-22"><a href="#cb93-22" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb93-23"><a href="#cb93-23" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>上記例にNull Objectパターンを適用した例を下記する。</p>
<div class="sourceCode" id="cb94"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/null_object_ut.cpp 41</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> A <span class="op">{</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">bool</span> Action<span class="op">()</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> action<span class="op">();</span> <span class="op">}</span></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">bool</span> action<span class="op">()</span> <span class="kw">noexcept</span></span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>            <span class="co">// do something</span></span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a>            <span class="op">...</span></span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> result<span class="op">;</span></span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb94-17"><a href="#cb94-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-18"><a href="#cb94-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> ANull <span class="kw">final</span> <span class="op">:</span> <span class="kw">public</span> A <span class="op">{</span></span>
<span id="cb94-19"><a href="#cb94-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb94-20"><a href="#cb94-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb94-21"><a href="#cb94-21" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">bool</span> action<span class="op">()</span> <span class="kw">noexcept</span> <span class="kw">override</span> <span class="op">{</span> <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb94-22"><a href="#cb94-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb94-23"><a href="#cb94-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-24"><a href="#cb94-24" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bool</span> ActionNewStyle<span class="op">(</span>A<span class="op">&amp;</span> a<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb94-25"><a href="#cb94-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb94-26"><a href="#cb94-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> a<span class="op">.</span>Action<span class="op">();</span>  <span class="co">// ←Null Objectによりif文が消えた。</span></span>
<span id="cb94-27"><a href="#cb94-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>この単純な例では、逆にソースコードが複雑化したように見えるが、</p>
<div class="sourceCode" id="cb95"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>a <span class="op">!=</span> <span class="kw">nullptr</span><span class="op">)</span></span></code></pre></div>
<p>を頻繁に使うような関数、
クラスではソースコードの単純化やnullptrチェック漏れの防止に非常に有効である。</p>
<h2 id="templateメソッド">Templateメソッド <a id="SS_2_15"></a></h2>
<p>Templateメソッドは、雛形の形式(書式等)を定めるメンバ関数(templateメソッド)と、
それを埋めるための振る舞いやデータを定めるメンバ関数を分離するときに用いるパターンである。</p>
<p>以下に実装例を示す。</p>
<div class="sourceCode" id="cb96"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/template_method.h 6</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@class</span><span class="co"> </span><span class="cv">XxxData</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@brief</span><span class="co"> 何かのデータを入れる箱</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> XxxData <span class="op">{</span></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> a<span class="op">;</span></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> b<span class="op">;</span></span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> c<span class="op">;</span></span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@class</span><span class="co"> </span><span class="cv">XxxDataFormatterIF</span></span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@brief</span><span class="co"> data_storer_if.cppに定義すべきだが、サンプルであるため便宜上同じファイルで定義する</span></span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">///        データフォーマットを行うクラスのインターフェースクラス</span></span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> XxxDataFormatterIF <span class="op">{</span></span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> XxxDataFormatterIF<span class="op">(</span><span class="bu">std::</span>string_view<span class="op"> </span>formatter_name<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb96-17"><a href="#cb96-17" aria-hidden="true" tabindex="-1"></a>            <span class="op">:</span> <span class="va">formatter_name_</span><span class="op">{</span>formatter_name<span class="op">}</span></span>
<span id="cb96-18"><a href="#cb96-18" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb96-19"><a href="#cb96-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb96-20"><a href="#cb96-20" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="op">~</span>XxxDataFormatterIF<span class="op">()</span> <span class="op">=</span> <span class="cf">default</span><span class="op">;</span></span>
<span id="cb96-21"><a href="#cb96-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-22"><a href="#cb96-22" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span>ToString<span class="op">(</span>XxxData <span class="at">const</span><span class="op">&amp;</span> xxx_data<span class="op">)</span> <span class="at">const</span></span>
<span id="cb96-23"><a href="#cb96-23" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb96-24"><a href="#cb96-24" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> header<span class="op">()</span> <span class="op">+</span> body<span class="op">(</span>xxx_data<span class="op">)</span> <span class="op">+</span> footer<span class="op">();</span></span>
<span id="cb96-25"><a href="#cb96-25" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb96-26"><a href="#cb96-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-27"><a href="#cb96-27" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span>ToString<span class="op">(</span><span class="bu">std::</span>vector<span class="op">&lt;</span>XxxData<span class="op">&gt;</span> <span class="at">const</span><span class="op">&amp;</span> xxx_datas<span class="op">)</span> <span class="at">const</span></span>
<span id="cb96-28"><a href="#cb96-28" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb96-29"><a href="#cb96-29" aria-hidden="true" tabindex="-1"></a>            <span class="bu">std::</span>string<span class="op"> </span>ret<span class="op">{</span>header<span class="op">()};</span></span>
<span id="cb96-30"><a href="#cb96-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-31"><a href="#cb96-31" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> <span class="at">const</span><span class="op">&amp;</span> xxx_data <span class="op">:</span> xxx_datas<span class="op">)</span> <span class="op">{</span></span>
<span id="cb96-32"><a href="#cb96-32" aria-hidden="true" tabindex="-1"></a>                ret <span class="op">+=</span> body<span class="op">(</span>xxx_data<span class="op">);</span></span>
<span id="cb96-33"><a href="#cb96-33" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb96-34"><a href="#cb96-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-35"><a href="#cb96-35" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> ret <span class="op">+</span> footer<span class="op">();</span></span>
<span id="cb96-36"><a href="#cb96-36" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb96-37"><a href="#cb96-37" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb96-38"><a href="#cb96-38" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb96-39"><a href="#cb96-39" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span><span class="op">&amp;</span> header<span class="op">()</span> <span class="at">const</span>                      <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb96-40"><a href="#cb96-40" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span><span class="op">&amp;</span> footer<span class="op">()</span> <span class="at">const</span>                      <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb96-41"><a href="#cb96-41" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="bu">std::</span>string<span class="op"> </span>       body<span class="op">(</span>XxxData <span class="at">const</span><span class="op">&amp;</span> xxx_data<span class="op">)</span> <span class="at">const</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb96-42"><a href="#cb96-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-43"><a href="#cb96-43" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb96-44"><a href="#cb96-44" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>上記XxxDataFormatterIFでは、以下のようなメンバ関数を宣言、定義している。</p>
<table>
<colgroup>
<col style="width: 13%" />
<col style="width: 23%" />
<col style="width: 63%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">メンバ関数</th>
<th style="text-align: left;"></th>
<th style="text-align: left;">振る舞い</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">header()</td>
<td style="text-align: left;">private pure-virtual</td>
<td
style="text-align: left;">ヘッダをstd::stringオブジェクトとして生成</td>
</tr>
<tr class="even">
<td style="text-align: left;">footer()</td>
<td style="text-align: left;">private pure-virtual</td>
<td
style="text-align: left;">フッタをstd::stringオブジェクトとして生成</td>
</tr>
<tr class="odd">
<td style="text-align: left;">body()</td>
<td style="text-align: left;">private pure-virtual</td>
<td
style="text-align: left;">XxxDataからボディをstd::stringオブジェクトとして生成</td>
</tr>
<tr class="even">
<td style="text-align: left;">ToString()</td>
<td style="text-align: left;">public normal</td>
<td
style="text-align: left;">header(),body(),footer()の出力を組み合わせた全体像を生成</td>
</tr>
</tbody>
</table>
<p>この構造により、XxxDataFormatterIFは、</p>
<ul>
<li>全体の書式を定義している。</li>
<li>各行の生成をXxxDataFormatterIFから派生した具象クラスに委譲している。</li>
</ul>
<p>下記XxxDataFormatterXml、XxxDataFormatterCsv、XxxDataFormatterTableでは、
header()、body()、footer()をオーバーライドすることで、それぞれの機能を実現している。</p>
<div class="sourceCode" id="cb97"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/template_method.cpp 8</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@class</span><span class="co"> </span><span class="cv">XxxDataFormatterXml</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@brief</span><span class="co"> XxxDataをXmlに変換</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> XxxDataFormatterXml <span class="kw">final</span> <span class="op">:</span> <span class="kw">public</span> XxxDataFormatterIF <span class="op">{</span></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span><span class="op">&amp;</span> header<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="kw">final</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">header_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span><span class="op">&amp;</span> footer<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="kw">final</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">footer_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="bu">std::</span>string<span class="op"> </span>       body<span class="op">(</span>XxxData <span class="at">const</span><span class="op">&amp;</span> xxx_data<span class="op">)</span> <span class="at">const</span> <span class="kw">override</span></span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> content <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{</span><span class="st">&quot;&lt;Item&gt;</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">};</span></span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a>            content <span class="op">+=</span> <span class="st">&quot;    &lt;XxxData a=</span><span class="sc">\&quot;</span><span class="st">&quot;</span> <span class="op">+</span> <span class="bu">std::</span>to_string<span class="op">(</span>xxx_data<span class="op">.</span>a<span class="op">)</span> <span class="op">+</span> <span class="st">&quot;</span><span class="sc">\&quot;</span><span class="st">&gt;</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">;</span></span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a>            content <span class="op">+=</span> <span class="st">&quot;    &lt;XxxData b=</span><span class="sc">\&quot;</span><span class="st">&quot;</span> <span class="op">+</span> <span class="bu">std::</span>to_string<span class="op">(</span>xxx_data<span class="op">.</span>b<span class="op">)</span> <span class="op">+</span> <span class="st">&quot;</span><span class="sc">\&quot;</span><span class="st">&gt;</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">;</span></span>
<span id="cb97-16"><a href="#cb97-16" aria-hidden="true" tabindex="-1"></a>            content <span class="op">+=</span> <span class="st">&quot;    &lt;XxxData c=</span><span class="sc">\&quot;</span><span class="st">&quot;</span> <span class="op">+</span> <span class="bu">std::</span>to_string<span class="op">(</span>xxx_data<span class="op">.</span>c<span class="op">)</span> <span class="op">+</span> <span class="st">&quot;</span><span class="sc">\&quot;</span><span class="st">&gt;</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">;</span></span>
<span id="cb97-17"><a href="#cb97-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-18"><a href="#cb97-18" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> content <span class="op">+</span> <span class="st">&quot;&lt;/Itemp&gt;</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">;</span></span>
<span id="cb97-19"><a href="#cb97-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb97-20"><a href="#cb97-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-21"><a href="#cb97-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="kw">inline</span> <span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span> <span class="va">header_</span><span class="op">{</span></span>
<span id="cb97-22"><a href="#cb97-22" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;&lt;?xml version=</span><span class="sc">\&quot;</span><span class="st">1.0</span><span class="sc">\&quot;</span><span class="st"> encoding=</span><span class="sc">\&quot;</span><span class="st">UTF-8</span><span class="sc">\&quot;</span><span class="st"> ?&gt;</span><span class="sc">\n</span><span class="st">&lt;XxxDataFormatterXml&gt;</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">};</span></span>
<span id="cb97-23"><a href="#cb97-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="kw">inline</span> <span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span> <span class="va">footer_</span><span class="op">{</span><span class="st">&quot;&lt;/XxxDataFormatterXml&gt;</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">};</span></span>
<span id="cb97-24"><a href="#cb97-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb97-25"><a href="#cb97-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-26"><a href="#cb97-26" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@class</span><span class="co"> </span><span class="cv">XxxDataFormatterCsv</span></span>
<span id="cb97-27"><a href="#cb97-27" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@brief</span><span class="co"> XxxDataをCsvに変換</span></span>
<span id="cb97-28"><a href="#cb97-28" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> XxxDataFormatterCsv <span class="kw">final</span> <span class="op">:</span> <span class="kw">public</span> XxxDataFormatterIF <span class="op">{</span></span>
<span id="cb97-29"><a href="#cb97-29" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb97-30"><a href="#cb97-30" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb97-31"><a href="#cb97-31" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span><span class="op">&amp;</span> header<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="kw">final</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">header_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb97-32"><a href="#cb97-32" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span><span class="op">&amp;</span> footer<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="kw">final</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">footer_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb97-33"><a href="#cb97-33" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="bu">std::</span>string<span class="op"> </span>       body<span class="op">(</span>XxxData <span class="at">const</span><span class="op">&amp;</span> xxx_data<span class="op">)</span> <span class="at">const</span> <span class="kw">override</span></span>
<span id="cb97-34"><a href="#cb97-34" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb97-35"><a href="#cb97-35" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="bu">std::</span>string<span class="op">{</span><span class="bu">std::</span>to_string<span class="op">(</span>xxx_data<span class="op">.</span>a<span class="op">)</span> <span class="op">+</span> <span class="st">&quot;, &quot;</span> <span class="op">+</span> <span class="bu">std::</span>to_string<span class="op">(</span>xxx_data<span class="op">.</span>b<span class="op">)</span> <span class="op">+</span> <span class="st">&quot;, &quot;</span></span>
<span id="cb97-36"><a href="#cb97-36" aria-hidden="true" tabindex="-1"></a>                               <span class="op">+</span> <span class="bu">std::</span>to_string<span class="op">(</span>xxx_data<span class="op">.</span>b<span class="op">)</span> <span class="op">+</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">};</span></span>
<span id="cb97-37"><a href="#cb97-37" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb97-38"><a href="#cb97-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-39"><a href="#cb97-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="kw">inline</span> <span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span> <span class="va">header_</span><span class="op">{</span><span class="st">&quot;a, b, c</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">};</span></span>
<span id="cb97-40"><a href="#cb97-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="kw">inline</span> <span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span> <span class="va">footer_</span><span class="op">{};</span></span>
<span id="cb97-41"><a href="#cb97-41" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb97-42"><a href="#cb97-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-43"><a href="#cb97-43" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@class</span><span class="co"> </span><span class="cv">XxxDataFormatterTable</span></span>
<span id="cb97-44"><a href="#cb97-44" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@brief</span><span class="co"> XxxDataをTableに変換</span></span>
<span id="cb97-45"><a href="#cb97-45" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> XxxDataFormatterTable <span class="kw">final</span> <span class="op">:</span> <span class="kw">public</span> XxxDataFormatterIF <span class="op">{</span></span>
<span id="cb97-46"><a href="#cb97-46" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb97-47"><a href="#cb97-47" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb97-48"><a href="#cb97-48" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span><span class="op">&amp;</span> header<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="kw">final</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">header_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb97-49"><a href="#cb97-49" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span><span class="op">&amp;</span> footer<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="kw">final</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">footer_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb97-50"><a href="#cb97-50" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="bu">std::</span>string<span class="op"> </span>       body<span class="op">(</span>XxxData <span class="at">const</span><span class="op">&amp;</span> xxx_data<span class="op">)</span> <span class="at">const</span> <span class="kw">override</span></span>
<span id="cb97-51"><a href="#cb97-51" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb97-52"><a href="#cb97-52" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> a <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{</span><span class="bu">std::</span>string<span class="op">{</span><span class="st">&quot;| &quot;</span><span class="op">}</span> <span class="op">+</span> <span class="bu">std::</span>to_string<span class="op">(</span>xxx_data<span class="op">.</span>a<span class="op">)};</span></span>
<span id="cb97-53"><a href="#cb97-53" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> b <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{</span><span class="bu">std::</span>string<span class="op">{</span><span class="st">&quot;| &quot;</span><span class="op">}</span> <span class="op">+</span> <span class="bu">std::</span>to_string<span class="op">(</span>xxx_data<span class="op">.</span>b<span class="op">)};</span></span>
<span id="cb97-54"><a href="#cb97-54" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> c <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{</span><span class="bu">std::</span>string<span class="op">{</span><span class="st">&quot;| &quot;</span><span class="op">}</span> <span class="op">+</span> <span class="bu">std::</span>to_string<span class="op">(</span>xxx_data<span class="op">.</span>c<span class="op">)};</span></span>
<span id="cb97-55"><a href="#cb97-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-56"><a href="#cb97-56" aria-hidden="true" tabindex="-1"></a>            a <span class="op">+=</span> <span class="bu">std::</span>string<span class="op">(</span><span class="va">colomun_</span> <span class="op">-</span> a<span class="op">.</span>size<span class="op">()</span> <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> <span class="ch">&#39; &#39;</span><span class="op">);</span></span>
<span id="cb97-57"><a href="#cb97-57" aria-hidden="true" tabindex="-1"></a>            b <span class="op">+=</span> <span class="bu">std::</span>string<span class="op">(</span><span class="va">colomun_</span> <span class="op">-</span> b<span class="op">.</span>size<span class="op">()</span> <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> <span class="ch">&#39; &#39;</span><span class="op">);</span></span>
<span id="cb97-58"><a href="#cb97-58" aria-hidden="true" tabindex="-1"></a>            c <span class="op">+=</span> <span class="bu">std::</span>string<span class="op">(</span><span class="va">colomun_</span> <span class="op">-</span> c<span class="op">.</span>size<span class="op">()</span> <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> <span class="ch">&#39; &#39;</span><span class="op">);</span></span>
<span id="cb97-59"><a href="#cb97-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-60"><a href="#cb97-60" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> a <span class="op">+</span> b <span class="op">+</span> c <span class="op">+</span> <span class="st">&quot;|</span><span class="sc">\n</span><span class="st">&quot;</span> <span class="op">+</span> <span class="va">border_</span><span class="op">;</span></span>
<span id="cb97-61"><a href="#cb97-61" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb97-62"><a href="#cb97-62" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb97-63"><a href="#cb97-63" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>以下の単体テストで、これらのクラスの振る舞いを示す。</p>
<div class="sourceCode" id="cb98"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/template_method_ut.cpp 6</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>    TEST<span class="op">(</span>TemplateMethod<span class="op">,</span> xml<span class="op">)</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> xml <span class="op">=</span> XxxDataFormatterXml<span class="op">{};</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> <span class="at">const</span> xd     <span class="op">=</span> XxxData<span class="op">{</span><span class="dv">1</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="dv">10</span><span class="op">};</span></span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> <span class="at">const</span> expect <span class="op">=</span> <span class="bu">std::</span>string_view<span class="op">{</span></span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;&lt;?xml version=</span><span class="sc">\&quot;</span><span class="st">1.0</span><span class="sc">\&quot;</span><span class="st"> encoding=</span><span class="sc">\&quot;</span><span class="st">UTF-8</span><span class="sc">\&quot;</span><span class="st"> ?&gt;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;&lt;XxxDataFormatterXml&gt;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;&lt;Item&gt;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;    &lt;XxxData a=</span><span class="sc">\&quot;</span><span class="st">1</span><span class="sc">\&quot;</span><span class="st">&gt;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;    &lt;XxxData b=</span><span class="sc">\&quot;</span><span class="st">100</span><span class="sc">\&quot;</span><span class="st">&gt;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;    &lt;XxxData c=</span><span class="sc">\&quot;</span><span class="st">10</span><span class="sc">\&quot;</span><span class="st">&gt;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;&lt;/Itemp&gt;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb98-17"><a href="#cb98-17" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;&lt;/XxxDataFormatterXml&gt;</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">};</span></span>
<span id="cb98-18"><a href="#cb98-18" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> <span class="at">const</span> actual <span class="op">=</span> xml<span class="op">.</span>ToString<span class="op">(</span>xd<span class="op">);</span></span>
<span id="cb98-19"><a href="#cb98-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-20"><a href="#cb98-20" aria-hidden="true" tabindex="-1"></a>            ASSERT_EQ<span class="op">(</span>expect<span class="op">,</span> actual<span class="op">);</span></span>
<span id="cb98-21"><a href="#cb98-21" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb98-22"><a href="#cb98-22" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb98-23"><a href="#cb98-23" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> <span class="at">const</span> xds    <span class="op">=</span> <span class="bu">std::</span>vector<span class="op">&lt;</span>XxxData<span class="op">&gt;{{</span><span class="dv">1</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="dv">10</span><span class="op">},</span> <span class="op">{</span><span class="dv">2</span><span class="op">,</span> <span class="dv">200</span><span class="op">,</span> <span class="dv">20</span><span class="op">}};</span></span>
<span id="cb98-24"><a href="#cb98-24" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> <span class="at">const</span> expect <span class="op">=</span> <span class="bu">std::</span>string_view<span class="op">{</span></span>
<span id="cb98-25"><a href="#cb98-25" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;&lt;?xml version=</span><span class="sc">\&quot;</span><span class="st">1.0</span><span class="sc">\&quot;</span><span class="st"> encoding=</span><span class="sc">\&quot;</span><span class="st">UTF-8</span><span class="sc">\&quot;</span><span class="st"> ?&gt;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb98-26"><a href="#cb98-26" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;&lt;XxxDataFormatterXml&gt;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb98-27"><a href="#cb98-27" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;&lt;Item&gt;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb98-28"><a href="#cb98-28" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;    &lt;XxxData a=</span><span class="sc">\&quot;</span><span class="st">1</span><span class="sc">\&quot;</span><span class="st">&gt;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb98-29"><a href="#cb98-29" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;    &lt;XxxData b=</span><span class="sc">\&quot;</span><span class="st">100</span><span class="sc">\&quot;</span><span class="st">&gt;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb98-30"><a href="#cb98-30" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;    &lt;XxxData c=</span><span class="sc">\&quot;</span><span class="st">10</span><span class="sc">\&quot;</span><span class="st">&gt;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb98-31"><a href="#cb98-31" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;&lt;/Itemp&gt;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb98-32"><a href="#cb98-32" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;&lt;Item&gt;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb98-33"><a href="#cb98-33" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;    &lt;XxxData a=</span><span class="sc">\&quot;</span><span class="st">2</span><span class="sc">\&quot;</span><span class="st">&gt;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb98-34"><a href="#cb98-34" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;    &lt;XxxData b=</span><span class="sc">\&quot;</span><span class="st">200</span><span class="sc">\&quot;</span><span class="st">&gt;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb98-35"><a href="#cb98-35" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;    &lt;XxxData c=</span><span class="sc">\&quot;</span><span class="st">20</span><span class="sc">\&quot;</span><span class="st">&gt;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb98-36"><a href="#cb98-36" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;&lt;/Itemp&gt;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb98-37"><a href="#cb98-37" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;&lt;/XxxDataFormatterXml&gt;</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">};</span></span>
<span id="cb98-38"><a href="#cb98-38" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> <span class="at">const</span> actual <span class="op">=</span> xml<span class="op">.</span>ToString<span class="op">(</span>xds<span class="op">);</span></span>
<span id="cb98-39"><a href="#cb98-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-40"><a href="#cb98-40" aria-hidden="true" tabindex="-1"></a>            ASSERT_EQ<span class="op">(</span>expect<span class="op">,</span> actual<span class="op">);</span></span>
<span id="cb98-41"><a href="#cb98-41" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb98-42"><a href="#cb98-42" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb98-43"><a href="#cb98-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-44"><a href="#cb98-44" aria-hidden="true" tabindex="-1"></a>    TEST<span class="op">(</span>TemplateMethod<span class="op">,</span> csv<span class="op">)</span></span>
<span id="cb98-45"><a href="#cb98-45" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb98-46"><a href="#cb98-46" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> csv <span class="op">=</span> XxxDataFormatterCsv<span class="op">{};</span></span>
<span id="cb98-47"><a href="#cb98-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-48"><a href="#cb98-48" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb98-49"><a href="#cb98-49" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> <span class="at">const</span> xd     <span class="op">=</span> XxxData<span class="op">{</span><span class="dv">1</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="dv">10</span><span class="op">};</span></span>
<span id="cb98-50"><a href="#cb98-50" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> <span class="at">const</span> expect <span class="op">=</span> <span class="bu">std::</span>string_view<span class="op">{</span></span>
<span id="cb98-51"><a href="#cb98-51" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;a, b, c</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb98-52"><a href="#cb98-52" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;1, 100, 100</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">};</span></span>
<span id="cb98-53"><a href="#cb98-53" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> <span class="at">const</span> actual <span class="op">=</span> csv<span class="op">.</span>ToString<span class="op">(</span>xd<span class="op">);</span></span>
<span id="cb98-54"><a href="#cb98-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-55"><a href="#cb98-55" aria-hidden="true" tabindex="-1"></a>            ASSERT_EQ<span class="op">(</span>expect<span class="op">,</span> actual<span class="op">);</span></span>
<span id="cb98-56"><a href="#cb98-56" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb98-57"><a href="#cb98-57" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb98-58"><a href="#cb98-58" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> <span class="at">const</span> xds    <span class="op">=</span> <span class="bu">std::</span>vector<span class="op">&lt;</span>XxxData<span class="op">&gt;{{</span><span class="dv">1</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="dv">10</span><span class="op">},</span> <span class="op">{</span><span class="dv">2</span><span class="op">,</span> <span class="dv">200</span><span class="op">,</span> <span class="dv">20</span><span class="op">}};</span></span>
<span id="cb98-59"><a href="#cb98-59" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> <span class="at">const</span> expect <span class="op">=</span> <span class="bu">std::</span>string_view<span class="op">{</span></span>
<span id="cb98-60"><a href="#cb98-60" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;a, b, c</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb98-61"><a href="#cb98-61" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;1, 100, 100</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb98-62"><a href="#cb98-62" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;2, 200, 200</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">};</span></span>
<span id="cb98-63"><a href="#cb98-63" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> <span class="at">const</span> actual <span class="op">=</span> csv<span class="op">.</span>ToString<span class="op">(</span>xds<span class="op">);</span></span>
<span id="cb98-64"><a href="#cb98-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-65"><a href="#cb98-65" aria-hidden="true" tabindex="-1"></a>            ASSERT_EQ<span class="op">(</span>expect<span class="op">,</span> actual<span class="op">);</span></span>
<span id="cb98-66"><a href="#cb98-66" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb98-67"><a href="#cb98-67" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb98-68"><a href="#cb98-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-69"><a href="#cb98-69" aria-hidden="true" tabindex="-1"></a>    TEST<span class="op">(</span>TemplateMethod<span class="op">,</span> table<span class="op">)</span></span>
<span id="cb98-70"><a href="#cb98-70" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb98-71"><a href="#cb98-71" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> table <span class="op">=</span> XxxDataFormatterTable<span class="op">{};</span></span>
<span id="cb98-72"><a href="#cb98-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-73"><a href="#cb98-73" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb98-74"><a href="#cb98-74" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>上記で示した実装例は、public継承による動的ポリモーフィズムを使用したため、
XxxDataFormatterXml、XxxDataFormatterCsv、XxxDataFormatterTableのインスタンスやそのポインタは、
XxxDataFormatterIFのリファレンスやポインタとして表現できる。
この性質は、<a href="#SS_2_16">Factory</a>や<a href="#SS_2_17">Named
Constructor</a>の実装には不可欠であるが、
逆にこのようなポリモーフィズムが不要な場合、このよう柔軟性も不要である。</p>
<p>そういった場合、private継承を用いるか、
テンプレートを用いた静的ポリモーフィズムを用いることでこの柔軟性を排除できる。</p>
<p>下記のコードはそのような実装例である。</p>
<div class="sourceCode" id="cb99"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/template_method_ut.cpp 111</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span>  <span class="co">// Tは下記のXxxDataFormatterXmlのようなクラス</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> XxxDataFormatter <span class="op">:</span> <span class="kw">private</span> T <span class="op">{</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span>ToString<span class="op">(</span>XxxData <span class="at">const</span><span class="op">&amp;</span> xxx_data<span class="op">)</span> <span class="at">const</span></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> T<span class="op">::</span>Header<span class="op">()</span> <span class="op">+</span> T<span class="op">::</span>Body<span class="op">(</span>xxx_data<span class="op">)</span> <span class="op">+</span> T<span class="op">::</span>Footer<span class="op">();</span></span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span>ToString<span class="op">(</span><span class="bu">std::</span>vector<span class="op">&lt;</span>XxxData<span class="op">&gt;</span> <span class="at">const</span><span class="op">&amp;</span> xxx_datas<span class="op">)</span> <span class="at">const</span></span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> ret <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{</span>T<span class="op">::</span>Header<span class="op">()};</span></span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> <span class="at">const</span><span class="op">&amp;</span> xxx_data <span class="op">:</span> xxx_datas<span class="op">)</span> <span class="op">{</span></span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a>                ret <span class="op">+=</span> T<span class="op">::</span>Body<span class="op">(</span>xxx_data<span class="op">);</span></span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb99-18"><a href="#cb99-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-19"><a href="#cb99-19" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> ret <span class="op">+</span> T<span class="op">::</span>Footer<span class="op">();</span></span>
<span id="cb99-20"><a href="#cb99-20" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb99-21"><a href="#cb99-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb99-22"><a href="#cb99-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-23"><a href="#cb99-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> XxxDataFormatterXml_Impl <span class="op">{</span></span>
<span id="cb99-24"><a href="#cb99-24" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb99-25"><a href="#cb99-25" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span><span class="op">&amp;</span> Header<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">header_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb99-26"><a href="#cb99-26" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span><span class="op">&amp;</span> Footer<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">footer_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb99-27"><a href="#cb99-27" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span>       Body<span class="op">(</span>XxxData <span class="at">const</span><span class="op">&amp;</span> xxx_data<span class="op">)</span> <span class="at">const</span></span>
<span id="cb99-28"><a href="#cb99-28" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb99-29"><a href="#cb99-29" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> content <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{</span><span class="st">&quot;&lt;Item&gt;</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">};</span></span>
<span id="cb99-30"><a href="#cb99-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-31"><a href="#cb99-31" aria-hidden="true" tabindex="-1"></a>            content <span class="op">+=</span> <span class="st">&quot;    &lt;XxxData a=</span><span class="sc">\&quot;</span><span class="st">&quot;</span> <span class="op">+</span> <span class="bu">std::</span>to_string<span class="op">(</span>xxx_data<span class="op">.</span>a<span class="op">)</span> <span class="op">+</span> <span class="st">&quot;</span><span class="sc">\&quot;</span><span class="st">&gt;</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">;</span></span>
<span id="cb99-32"><a href="#cb99-32" aria-hidden="true" tabindex="-1"></a>            content <span class="op">+=</span> <span class="st">&quot;    &lt;XxxData b=</span><span class="sc">\&quot;</span><span class="st">&quot;</span> <span class="op">+</span> <span class="bu">std::</span>to_string<span class="op">(</span>xxx_data<span class="op">.</span>b<span class="op">)</span> <span class="op">+</span> <span class="st">&quot;</span><span class="sc">\&quot;</span><span class="st">&gt;</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">;</span></span>
<span id="cb99-33"><a href="#cb99-33" aria-hidden="true" tabindex="-1"></a>            content <span class="op">+=</span> <span class="st">&quot;    &lt;XxxData c=</span><span class="sc">\&quot;</span><span class="st">&quot;</span> <span class="op">+</span> <span class="bu">std::</span>to_string<span class="op">(</span>xxx_data<span class="op">.</span>c<span class="op">)</span> <span class="op">+</span> <span class="st">&quot;</span><span class="sc">\&quot;</span><span class="st">&gt;</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">;</span></span>
<span id="cb99-34"><a href="#cb99-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-35"><a href="#cb99-35" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> content <span class="op">+</span> <span class="st">&quot;&lt;/Itemp&gt;</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">;</span></span>
<span id="cb99-36"><a href="#cb99-36" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb99-37"><a href="#cb99-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-38"><a href="#cb99-38" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb99-39"><a href="#cb99-39" aria-hidden="true" tabindex="-1"></a>        <span class="kw">inline</span> <span class="at">static</span> <span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span> <span class="va">header_</span><span class="op">{</span></span>
<span id="cb99-40"><a href="#cb99-40" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;&lt;?xml version=</span><span class="sc">\&quot;</span><span class="st">1.0</span><span class="sc">\&quot;</span><span class="st"> encoding=</span><span class="sc">\&quot;</span><span class="st">UTF-8</span><span class="sc">\&quot;</span><span class="st"> ?&gt;</span><span class="sc">\n</span><span class="st">&lt;XxxDataFormatterXml&gt;</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">};</span></span>
<span id="cb99-41"><a href="#cb99-41" aria-hidden="true" tabindex="-1"></a>        <span class="kw">inline</span> <span class="at">static</span> <span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span> <span class="va">footer_</span><span class="op">{</span><span class="st">&quot;&lt;/XxxDataFormatterXml&gt;</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">};</span></span>
<span id="cb99-42"><a href="#cb99-42" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb99-43"><a href="#cb99-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-44"><a href="#cb99-44" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> XxxDataFormatterXml <span class="op">=</span> XxxDataFormatter<span class="op">&lt;</span>XxxDataFormatterXml_Impl<span class="op">&gt;;</span></span></code></pre></div>
<p>上記の単体テストは下記のようになる。</p>
<div class="sourceCode" id="cb100"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/template_method_ut.cpp 159</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> xml <span class="op">=</span> XxxDataFormatterXml<span class="op">{};</span></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> <span class="at">const</span> xd     <span class="op">=</span> XxxData<span class="op">{</span><span class="dv">1</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="dv">10</span><span class="op">};</span></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> <span class="at">const</span> expect <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{</span></span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;&lt;?xml version=</span><span class="sc">\&quot;</span><span class="st">1.0</span><span class="sc">\&quot;</span><span class="st"> encoding=</span><span class="sc">\&quot;</span><span class="st">UTF-8</span><span class="sc">\&quot;</span><span class="st"> ?&gt;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;&lt;XxxDataFormatterXml&gt;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;&lt;Item&gt;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;    &lt;XxxData a=</span><span class="sc">\&quot;</span><span class="st">1</span><span class="sc">\&quot;</span><span class="st">&gt;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;    &lt;XxxData b=</span><span class="sc">\&quot;</span><span class="st">100</span><span class="sc">\&quot;</span><span class="st">&gt;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;    &lt;XxxData c=</span><span class="sc">\&quot;</span><span class="st">10</span><span class="sc">\&quot;</span><span class="st">&gt;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;&lt;/Itemp&gt;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;&lt;/XxxDataFormatterXml&gt;</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">};</span></span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> <span class="at">const</span> actual <span class="op">=</span> xml<span class="op">.</span>ToString<span class="op">(</span>xd<span class="op">);</span></span>
<span id="cb100-17"><a href="#cb100-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-18"><a href="#cb100-18" aria-hidden="true" tabindex="-1"></a>            ASSERT_EQ<span class="op">(</span>expect<span class="op">,</span> actual<span class="op">);</span></span>
<span id="cb100-19"><a href="#cb100-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb100-20"><a href="#cb100-20" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb100-21"><a href="#cb100-21" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> <span class="at">const</span> xds    <span class="op">=</span> <span class="bu">std::</span>vector<span class="op">&lt;</span>XxxData<span class="op">&gt;{{</span><span class="dv">1</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="dv">10</span><span class="op">},</span> <span class="op">{</span><span class="dv">2</span><span class="op">,</span> <span class="dv">200</span><span class="op">,</span> <span class="dv">20</span><span class="op">}};</span></span>
<span id="cb100-22"><a href="#cb100-22" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> <span class="at">const</span> expect <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{</span></span>
<span id="cb100-23"><a href="#cb100-23" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;&lt;?xml version=</span><span class="sc">\&quot;</span><span class="st">1.0</span><span class="sc">\&quot;</span><span class="st"> encoding=</span><span class="sc">\&quot;</span><span class="st">UTF-8</span><span class="sc">\&quot;</span><span class="st"> ?&gt;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb100-24"><a href="#cb100-24" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;&lt;XxxDataFormatterXml&gt;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb100-25"><a href="#cb100-25" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;&lt;Item&gt;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb100-26"><a href="#cb100-26" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;    &lt;XxxData a=</span><span class="sc">\&quot;</span><span class="st">1</span><span class="sc">\&quot;</span><span class="st">&gt;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb100-27"><a href="#cb100-27" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;    &lt;XxxData b=</span><span class="sc">\&quot;</span><span class="st">100</span><span class="sc">\&quot;</span><span class="st">&gt;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb100-28"><a href="#cb100-28" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;    &lt;XxxData c=</span><span class="sc">\&quot;</span><span class="st">10</span><span class="sc">\&quot;</span><span class="st">&gt;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb100-29"><a href="#cb100-29" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;&lt;/Itemp&gt;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb100-30"><a href="#cb100-30" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;&lt;Item&gt;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb100-31"><a href="#cb100-31" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;    &lt;XxxData a=</span><span class="sc">\&quot;</span><span class="st">2</span><span class="sc">\&quot;</span><span class="st">&gt;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb100-32"><a href="#cb100-32" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;    &lt;XxxData b=</span><span class="sc">\&quot;</span><span class="st">200</span><span class="sc">\&quot;</span><span class="st">&gt;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb100-33"><a href="#cb100-33" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;    &lt;XxxData c=</span><span class="sc">\&quot;</span><span class="st">20</span><span class="sc">\&quot;</span><span class="st">&gt;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb100-34"><a href="#cb100-34" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;&lt;/Itemp&gt;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb100-35"><a href="#cb100-35" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;&lt;/XxxDataFormatterXml&gt;</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">};</span></span>
<span id="cb100-36"><a href="#cb100-36" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> <span class="at">const</span> actual <span class="op">=</span> xml<span class="op">.</span>ToString<span class="op">(</span>xds<span class="op">);</span></span>
<span id="cb100-37"><a href="#cb100-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-38"><a href="#cb100-38" aria-hidden="true" tabindex="-1"></a>            ASSERT_EQ<span class="op">(</span>expect<span class="op">,</span> actual<span class="op">);</span></span>
<span id="cb100-39"><a href="#cb100-39" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span></code></pre></div>
<h2 id="factory">Factory <a id="SS_2_16"></a></h2>
<p>Factoryは、専用関数(Factory関数)にオブジェクト生成をさせるためのパターンである。
オブジェクトを生成するクラスや関数をそのオブジェクトの生成方法に依存させたくない場合や、
オブジェクトの生成に統一されたルールを適用したい場合等に用いられる。
DI(「<a href="#SS_2_11">DI(dependency
injection)</a>」参照)と組み合わせて使われることが多い。</p>
<p>「<a
href="#SS_2_15">Templateメソッド</a>」の例にFactoryを適用したソースコードを下記する。</p>
<p>下記のXxxDataFormatterFactory関数により、</p>
<ul>
<li>XxxDataFormatterIFオブジェクトはstd::unique_ptrで保持されることを強制できる</li>
<li>XxxDataFormatterIFから派生したクラスはtemplate_method.cppの無名名前空間で宣言できるため、
これらのクラスは他のクラスから直接依存されることがない</li>
</ul>
<p>といった効果がある。</p>
<div class="sourceCode" id="cb101"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/template_method.h 73</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">enum</span> <span class="kw">class</span> XxxDataFormatterMethod <span class="op">{</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>        Xml<span class="op">,</span></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>        Csv<span class="op">,</span></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>        Table<span class="op">,</span></span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@fn</span><span class="co"> </span><span class="do">XxxDataFormatterFactory</span></span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@brief</span><span class="co"> std::unique_ptrで保持されたXxxDataFormatterIFオブジェクトを生成するFactory関数</span></span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@param</span><span class="co"> </span><span class="cv">method</span><span class="co"> XxxDataFormatterMethodのいずれか</span></span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@return</span><span class="co"> std::unique_ptr</span><span class="kw">&lt;const</span><span class="ot"> XxxDataFormatterIF</span><span class="kw">&gt;</span></span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">///         XxxDataFormatterIFはconstメンバ関数のみを持つため、戻り値もconstオブジェクト</span></span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>XxxDataFormatterIF <span class="at">const</span><span class="op">&gt;</span> XxxDataFormatterFactory<span class="op">(</span>XxxDataFormatterMethod method<span class="op">);</span></span></code></pre></div>
<div class="sourceCode" id="cb102"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/template_method.cpp 109</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>XxxDataFormatterIF <span class="at">const</span><span class="op">&gt;</span> XxxDataFormatterFactory<span class="op">(</span>XxxDataFormatterMethod method<span class="op">)</span></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">switch</span> <span class="op">(</span>method<span class="op">)</span> <span class="op">{</span></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> XxxDataFormatterMethod<span class="op">::</span>Xml<span class="op">:</span></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>XxxDataFormatterIF <span class="at">const</span><span class="op">&gt;{</span><span class="kw">new</span> XxxDataFormatterXml<span class="op">};</span>  <span class="co">// C++11</span></span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> XxxDataFormatterMethod<span class="op">::</span>Csv<span class="op">:</span></span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="bu">std::</span>make_unique<span class="op">&lt;</span>XxxDataFormatterCsv <span class="at">const</span><span class="op">&gt;();</span>  <span class="co">// C++14 make_uniqueもFactory</span></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> XxxDataFormatterMethod<span class="op">::</span>Table<span class="op">:</span></span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="bu">std::</span>make_unique<span class="op">&lt;</span>XxxDataFormatterTable <span class="at">const</span><span class="op">&gt;();</span></span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">default</span><span class="op">:</span></span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a>            <span class="ot">assert</span><span class="op">(</span><span class="kw">false</span><span class="op">);</span></span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="op">{};</span></span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb102-16"><a href="#cb102-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>以下に上記クラスの単体テストを示す。</p>
<div class="sourceCode" id="cb103"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/template_method_factory_ut.cpp 7</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>    TEST<span class="op">(</span>Factory<span class="op">,</span> xml<span class="op">)</span></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> xml <span class="op">=</span> XxxDataFormatterFactory<span class="op">(</span>XxxDataFormatterMethod<span class="op">::</span>Xml<span class="op">);</span></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a>    TEST<span class="op">(</span>Factory<span class="op">,</span> csv<span class="op">)</span></span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> csv <span class="op">=</span> XxxDataFormatterFactory<span class="op">(</span>XxxDataFormatterMethod<span class="op">::</span>Csv<span class="op">);</span></span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-14"><a href="#cb103-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb103-15"><a href="#cb103-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb103-16"><a href="#cb103-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-17"><a href="#cb103-17" aria-hidden="true" tabindex="-1"></a>    TEST<span class="op">(</span>Factory<span class="op">,</span> table<span class="op">)</span></span>
<span id="cb103-18"><a href="#cb103-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb103-19"><a href="#cb103-19" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> table <span class="op">=</span> XxxDataFormatterFactory<span class="op">(</span>XxxDataFormatterMethod<span class="op">::</span>Table<span class="op">);</span></span>
<span id="cb103-20"><a href="#cb103-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-21"><a href="#cb103-21" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb103-22"><a href="#cb103-22" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> <span class="at">const</span> xd     <span class="op">=</span> XxxData<span class="op">{</span><span class="dv">1</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="dv">10</span><span class="op">};</span></span>
<span id="cb103-23"><a href="#cb103-23" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> <span class="at">const</span> expect <span class="op">=</span> <span class="bu">std::</span>string_view<span class="op">{</span></span>
<span id="cb103-24"><a href="#cb103-24" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;+--------|--------|--------+</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb103-25"><a href="#cb103-25" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;| a      | b      | c      |</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb103-26"><a href="#cb103-26" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;+--------|--------|--------+</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb103-27"><a href="#cb103-27" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;| 1      | 100    | 10     |</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb103-28"><a href="#cb103-28" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;+--------|--------|--------+</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">};</span></span>
<span id="cb103-29"><a href="#cb103-29" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> <span class="at">const</span> actual <span class="op">=</span> table<span class="op">-&gt;</span>ToString<span class="op">(</span>xd<span class="op">);</span></span>
<span id="cb103-30"><a href="#cb103-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-31"><a href="#cb103-31" aria-hidden="true" tabindex="-1"></a>            ASSERT_EQ<span class="op">(</span>expect<span class="op">,</span> actual<span class="op">);</span></span>
<span id="cb103-32"><a href="#cb103-32" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb103-33"><a href="#cb103-33" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb103-34"><a href="#cb103-34" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> <span class="at">const</span> xds    <span class="op">=</span> <span class="bu">std::</span>vector<span class="op">&lt;</span>XxxData<span class="op">&gt;{{</span><span class="dv">1</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="dv">10</span><span class="op">},</span> <span class="op">{</span><span class="dv">2</span><span class="op">,</span> <span class="dv">200</span><span class="op">,</span> <span class="dv">20</span><span class="op">}};</span></span>
<span id="cb103-35"><a href="#cb103-35" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> <span class="at">const</span> expect <span class="op">=</span> <span class="bu">std::</span>string_view<span class="op">{</span></span>
<span id="cb103-36"><a href="#cb103-36" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;+--------|--------|--------+</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb103-37"><a href="#cb103-37" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;| a      | b      | c      |</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb103-38"><a href="#cb103-38" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;+--------|--------|--------+</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb103-39"><a href="#cb103-39" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;| 1      | 100    | 10     |</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb103-40"><a href="#cb103-40" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;+--------|--------|--------+</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb103-41"><a href="#cb103-41" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;| 2      | 200    | 20     |</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb103-42"><a href="#cb103-42" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;+--------|--------|--------+</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">};</span></span>
<span id="cb103-43"><a href="#cb103-43" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> <span class="at">const</span> actual <span class="op">=</span> table<span class="op">-&gt;</span>ToString<span class="op">(</span>xds<span class="op">);</span></span>
<span id="cb103-44"><a href="#cb103-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-45"><a href="#cb103-45" aria-hidden="true" tabindex="-1"></a>            ASSERT_EQ<span class="op">(</span>expect<span class="op">,</span> actual<span class="op">);</span></span>
<span id="cb103-46"><a href="#cb103-46" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb103-47"><a href="#cb103-47" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>一般にFactory関数はヒープを使用してオブジェクトを生成する場合が多いため、
それを例示する目的でXxxDataFormatterFactoryもヒープを使用している。</p>
<p>この例ではその必要はないため、ヒープを使用しないFactory関数の例を下記する。</p>
<div class="sourceCode" id="cb104"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/template_method.cpp 126</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>    XxxDataFormatterIF <span class="at">const</span><span class="op">&amp;</span> XxxDataFormatterFactory2<span class="op">(</span>XxxDataFormatterMethod method<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="kw">auto</span> xml   <span class="op">=</span> XxxDataFormatterXml<span class="op">{};</span></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="kw">auto</span> csv   <span class="op">=</span> XxxDataFormatterCsv<span class="op">{};</span></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="kw">auto</span> table <span class="op">=</span> XxxDataFormatterTable<span class="op">{};</span></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">switch</span> <span class="op">(</span>method<span class="op">)</span> <span class="op">{</span></span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> XxxDataFormatterMethod<span class="op">::</span>Xml<span class="op">:</span></span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> xml<span class="op">;</span></span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> XxxDataFormatterMethod<span class="op">::</span>Csv<span class="op">:</span></span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> csv<span class="op">;</span></span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> XxxDataFormatterMethod<span class="op">::</span>Table<span class="op">:</span></span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> table<span class="op">;</span></span>
<span id="cb104-16"><a href="#cb104-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">default</span><span class="op">:</span></span>
<span id="cb104-17"><a href="#cb104-17" aria-hidden="true" tabindex="-1"></a>            <span class="ot">assert</span><span class="op">(</span><span class="kw">false</span><span class="op">);</span></span>
<span id="cb104-18"><a href="#cb104-18" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> xml<span class="op">;</span></span>
<span id="cb104-19"><a href="#cb104-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb104-20"><a href="#cb104-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>次に示すのは、このパターンを使用して、プリプロセッサ命令を排除するリファクタリングの例である。</p>
<p>まずは、出荷仕分け向けのプリプロセッサ命令をロジックの内部に記述している問題のあるコードを示す。
このようなオールドスタイルなコードは様々な開発阻害要因になるため、避けるべきである。</p>
<div class="sourceCode" id="cb105"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// in shipping.h</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#define SHIP_TO_JAPAN </span><span class="dv">1</span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#define SHIP_TO_US </span><span class="dv">2</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#define SHIP_TO_EU </span><span class="dv">3</span></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> ShippingOp <span class="op">{</span></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">int32_t</span> DoSomething<span class="op">()</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="op">~</span>ShippingOp<span class="op">()</span>         <span class="op">=</span> <span class="cf">default</span><span class="op">;</span></span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb106"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// in shipping_japan.h</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> ShippingOp_Japan <span class="op">:</span> <span class="kw">public</span> ShippingOp <span class="op">{</span></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>        ShippingOp_Japan<span class="op">();</span></span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span> DoSomething<span class="op">()</span> <span class="kw">override</span><span class="op">;</span></span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>        <span class="op">~</span>ShippingOp_Japan<span class="op">()</span> <span class="kw">override</span><span class="op">;</span></span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 何らかの宣言</span></span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb107"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// in xxx.cpp 仕分けに依存した処理</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// SHIPPINGはmake等のビルドツールから渡される</span></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#if SHIPPING == SHIP_TO_JAPAN</span></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> shipping <span class="op">=</span> ShippingOp_Japan<span class="op">{};</span></span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#elif SHIPPING == SHIP_TO_US</span></span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> shipping <span class="op">=</span> ShippingOp_US<span class="op">{};</span></span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#elif SHIPPING == SHIP_TO_EU</span></span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> shipping <span class="op">=</span> ShippingOp_EU<span class="op">{};</span></span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#else</span></span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#error &quot;SHIPPING must be defined&quot;</span></span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#endif</span></span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a>        shipping<span class="op">.</span>DoSomething<span class="op">();</span></span></code></pre></div>
<p>このコードは、
関数テンプレートの特殊化を利用したFactoryを以下のように定義することで改善することができる。</p>
<div class="sourceCode" id="cb108"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// in shipping.h</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ShippingOpクラスは改善前のコードと同じ</span></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">enum</span> <span class="kw">class</span> ShippingRegion <span class="op">{</span> Japan<span class="op">,</span> US<span class="op">,</span> EU <span class="op">};</span></span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span>ShippingRegion<span class="op">&gt;</span></span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>ShippingOp<span class="op">&gt;</span> ShippingOpFactory<span class="op">();</span>  <span class="co">// ShippingOpFactory特殊化のための宣言</span></span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;&gt;</span></span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>ShippingOp<span class="op">&gt;</span> ShippingOpFactory<span class="op">&lt;</span>ShippingRegion<span class="op">::</span>Japan<span class="op">&gt;();</span>  <span class="co">// 特殊化関数の宣言</span></span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;&gt;</span></span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>ShippingOp<span class="op">&gt;</span> ShippingOpFactory<span class="op">&lt;</span>ShippingRegion<span class="op">::</span>US<span class="op">&gt;();</span>  <span class="co">// 特殊化関数の宣言</span></span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;&gt;</span></span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>ShippingOp<span class="op">&gt;</span> ShippingOpFactory<span class="op">&lt;</span>ShippingRegion<span class="op">::</span>EU<span class="op">&gt;();</span>  <span class="co">// 特殊化関数の宣言</span></span></code></pre></div>
<div class="sourceCode" id="cb109"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// in shipping_japan.cpp</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ファクトリーの効果で、ShippingOp_Japanは外部への公開が不要</span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> ShippingOp_Japan <span class="op">:</span> <span class="kw">public</span> ShippingOp <span class="op">{</span></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>        ShippingOp_Japan<span class="op">();</span></span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span> DoSomething<span class="op">()</span> <span class="kw">override</span><span class="op">;</span></span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">~</span>ShippingOp_Japan<span class="op">()</span> <span class="kw">override</span><span class="op">;</span></span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 何らかの宣言</span></span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;&gt;</span></span>
<span id="cb109-15"><a href="#cb109-15" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>ShippingOp<span class="op">&gt;</span> ShippingOpFactory<span class="op">&lt;</span>ShippingRegion<span class="op">::</span>Japan<span class="op">&gt;()</span></span>
<span id="cb109-16"><a href="#cb109-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb109-17"><a href="#cb109-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>ShippingOp<span class="op">&gt;{</span><span class="kw">new</span> ShippingOp_Japan<span class="op">};</span></span>
<span id="cb109-18"><a href="#cb109-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb110"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// in xxx.cpp 仕分けに依存した処理</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// SHIPPINGはmake等のビルドツールからShippingRegionのいづれかとして渡される</span></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> shipping <span class="op">=</span> ShippingOpFactory<span class="op">&lt;</span>SHIPPING<span class="op">&gt;();</span></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>    shipping<span class="op">-&gt;</span>DoSomething<span class="op">();</span></span></code></pre></div>
<p>もしくは、
関数オーバーロードを利用したFactoryを以下のように定義することで改善することもできる。</p>
<div class="sourceCode" id="cb111"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// in shipping.h</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ShippingOpクラスは改善前のコードと同じ</span></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">enum</span> <span class="kw">class</span> ShippingRegion <span class="op">{</span> Japan<span class="op">,</span> US<span class="op">,</span> EU <span class="op">};</span></span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span>ShippingRegion R<span class="op">&gt;</span></span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> ShippingRegion2Type <span class="op">:</span> <span class="bu">std::</span>integral_constant<span class="op">&lt;</span>ShippingRegion<span class="op">,</span> R<span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> ShippingRegionType_Japan <span class="op">=</span> ShippingRegion2Type<span class="op">&lt;</span>ShippingRegion<span class="op">::</span>Japan<span class="op">&gt;;</span></span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> ShippingRegionType_US    <span class="op">=</span> ShippingRegion2Type<span class="op">&lt;</span>ShippingRegion<span class="op">::</span>US<span class="op">&gt;;</span></span>
<span id="cb111-13"><a href="#cb111-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> ShippingRegionType_EU    <span class="op">=</span> ShippingRegion2Type<span class="op">&lt;</span>ShippingRegion<span class="op">::</span>EU<span class="op">&gt;;</span></span>
<span id="cb111-14"><a href="#cb111-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-15"><a href="#cb111-15" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>ShippingOp<span class="op">&gt;</span> ShippingOpFactory<span class="op">(</span>ShippingRegionType_Japan<span class="op">);</span></span>
<span id="cb111-16"><a href="#cb111-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>ShippingOp<span class="op">&gt;</span> ShippingOpFactory<span class="op">(</span>ShippingRegionType_US<span class="op">);</span></span>
<span id="cb111-17"><a href="#cb111-17" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>ShippingOp<span class="op">&gt;</span> ShippingOpFactory<span class="op">(</span>ShippingRegionType_EU<span class="op">);</span></span></code></pre></div>
<div class="sourceCode" id="cb112"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// in shipping_japan.cpp</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ファクトリーの効果で、ShippingOp_Japanは外部への公開が不要</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> ShippingOp_Japan <span class="op">:</span> <span class="kw">public</span> ShippingOp <span class="op">{</span></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>        ShippingOp_Japan<span class="op">();</span></span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span> DoSomething<span class="op">()</span> <span class="kw">override</span><span class="op">;</span></span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">~</span>ShippingOp_Japan<span class="op">()</span> <span class="kw">override</span><span class="op">;</span></span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 何らかの宣言</span></span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-14"><a href="#cb112-14" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>ShippingOp<span class="op">&gt;</span> ShippingOpFactory<span class="op">(</span>ShippingRegionType_Japan<span class="op">)</span></span>
<span id="cb112-15"><a href="#cb112-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb112-16"><a href="#cb112-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>ShippingOp<span class="op">&gt;{</span><span class="kw">new</span> ShippingOp_Japan<span class="op">};</span></span>
<span id="cb112-17"><a href="#cb112-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb113"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// in xxx.cpp 仕分けに依存した処理</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// SHIPPINGはmake等のビルドツールからShippingRegionのいづれかとして渡される</span></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> shipping <span class="op">=</span> ShippingOpFactory<span class="op">(</span>ShippingRegion2Type<span class="op">&lt;</span>SHIPPING<span class="op">&gt;{});</span></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>    shipping<span class="op">-&gt;</span>DoSomething<span class="op">();</span></span></code></pre></div>
<h2 id="named-constructor">Named Constructor <a id="SS_2_17"></a></h2>
<p>Named Connstructorは、<a
href="#SS_2_12">Singleton</a>のようなオブジェクトを複数、生成するためのパターンである。</p>
<div class="sourceCode" id="cb114"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/enum_operator.h 82</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Mammals <span class="op">:</span> <span class="kw">public</span> Animal <span class="op">{</span>  <span class="co">// 哺乳類</span></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> Mammals<span class="op">&amp;</span> Human<span class="op">()</span> <span class="kw">noexcept</span></span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">static</span> <span class="kw">auto</span> inst <span class="op">=</span> Mammals<span class="op">{</span>PhisicalAbility<span class="op">::</span>Run <span class="op">|</span> PhisicalAbility<span class="op">::</span>Swim<span class="op">};</span></span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> inst<span class="op">;</span></span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> Mammals<span class="op">&amp;</span> Bat<span class="op">()</span> <span class="kw">noexcept</span></span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">static</span> <span class="kw">auto</span> inst <span class="op">=</span> Mammals<span class="op">{</span>PhisicalAbility<span class="op">::</span>Run <span class="op">|</span> PhisicalAbility<span class="op">::</span>Fly<span class="op">};</span></span>
<span id="cb114-14"><a href="#cb114-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> inst<span class="op">;</span></span>
<span id="cb114-15"><a href="#cb114-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb114-16"><a href="#cb114-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-17"><a href="#cb114-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> Mammals<span class="op">&amp;</span> Whale<span class="op">()</span> <span class="kw">noexcept</span></span>
<span id="cb114-18"><a href="#cb114-18" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb114-19"><a href="#cb114-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">static</span> <span class="kw">auto</span> inst <span class="op">=</span> Mammals<span class="op">{</span>PhisicalAbility<span class="op">::</span>Swim<span class="op">};</span></span>
<span id="cb114-20"><a href="#cb114-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> inst<span class="op">;</span></span>
<span id="cb114-21"><a href="#cb114-21" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb114-22"><a href="#cb114-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-23"><a href="#cb114-23" aria-hidden="true" tabindex="-1"></a>        <span class="dt">bool</span> Act<span class="op">();</span></span>
<span id="cb114-24"><a href="#cb114-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-25"><a href="#cb114-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb114-26"><a href="#cb114-26" aria-hidden="true" tabindex="-1"></a>        Mammals<span class="op">(</span>PhisicalAbility pa<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">:</span> Animal<span class="op">{</span>pa<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb114-27"><a href="#cb114-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>上記例のHuman()、Bat()、Whale()は、人、コウモリ、クジラに対応するクラスMammalsオブジェクトを返す。</p>
<p>次に示したのは「<a
href="#SS_2_16">Factory</a>」の例にこのパターンを適応したコードである。</p>
<div class="sourceCode" id="cb115"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/template_method.h 16</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@class</span><span class="co"> </span><span class="cv">XxxDataFormatterIF</span></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@brief</span><span class="co"> data_storer_if.cppに定義すべきだが、サンプルであるため便宜上同じファイルで定義する</span></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">///        データフォーマットを行うクラスのインターフェースクラス</span></span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> XxxDataFormatterIF <span class="op">{</span></span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> XxxDataFormatterIF<span class="op">(</span><span class="bu">std::</span>string_view<span class="op"> </span>formatter_name<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a>            <span class="op">:</span> <span class="va">formatter_name_</span><span class="op">{</span>formatter_name<span class="op">}</span></span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="op">~</span>XxxDataFormatterIF<span class="op">()</span> <span class="op">=</span> <span class="cf">default</span><span class="op">;</span></span>
<span id="cb115-13"><a href="#cb115-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-14"><a href="#cb115-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> XxxDataFormatterIF <span class="at">const</span><span class="op">&amp;</span> Xml<span class="op">()</span> <span class="kw">noexcept</span><span class="op">;</span></span>
<span id="cb115-15"><a href="#cb115-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> XxxDataFormatterIF <span class="at">const</span><span class="op">&amp;</span> Csv<span class="op">()</span> <span class="kw">noexcept</span><span class="op">;</span></span>
<span id="cb115-16"><a href="#cb115-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> XxxDataFormatterIF <span class="at">const</span><span class="op">&amp;</span> Table<span class="op">()</span> <span class="kw">noexcept</span><span class="op">;</span></span>
<span id="cb115-17"><a href="#cb115-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-18"><a href="#cb115-18" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb115-19"><a href="#cb115-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb116"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/template_method.cpp 147</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>    XxxDataFormatterIF <span class="at">const</span><span class="op">&amp;</span> XxxDataFormatterIF<span class="op">::</span>Xml<span class="op">()</span> <span class="kw">noexcept</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="kw">auto</span> xml <span class="op">=</span> XxxDataFormatterXml<span class="op">{};</span></span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> xml<span class="op">;</span></span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a>    XxxDataFormatterIF <span class="at">const</span><span class="op">&amp;</span> XxxDataFormatterIF<span class="op">::</span>Csv<span class="op">()</span> <span class="kw">noexcept</span></span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb116-12"><a href="#cb116-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="kw">auto</span> csv <span class="op">=</span> XxxDataFormatterCsv<span class="op">{};</span></span>
<span id="cb116-13"><a href="#cb116-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-14"><a href="#cb116-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> csv<span class="op">;</span></span>
<span id="cb116-15"><a href="#cb116-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb116-16"><a href="#cb116-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-17"><a href="#cb116-17" aria-hidden="true" tabindex="-1"></a>    XxxDataFormatterIF <span class="at">const</span><span class="op">&amp;</span> XxxDataFormatterIF<span class="op">::</span>Table<span class="op">()</span> <span class="kw">noexcept</span></span>
<span id="cb116-18"><a href="#cb116-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb116-19"><a href="#cb116-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="kw">auto</span> table <span class="op">=</span> XxxDataFormatterTable<span class="op">{};</span></span>
<span id="cb116-20"><a href="#cb116-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-21"><a href="#cb116-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> table<span class="op">;</span></span>
<span id="cb116-22"><a href="#cb116-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>これまでにXxxDataFormatterIFオブジェクトを取得するパターンを以下のように3つ示した。</p>
<ol type="1">
<li>Factory関数によってstd::unique_ptr&lt;XxxDataFormatterIF&gt;オブジェクトを返す。</li>
<li>Factory関数によってstaticなXxxDataFormatterIFオブジェクトを返す。</li>
<li>Named
ConstructorによってstaticなXxxDataFormatterIFオブジェクトを返す。</li>
</ol>
<p>最も汎用的な方法はパターン1であるが、
上記例のようにオブジェクトが状態を持たない場合、これは過剰な方法であり、
パターン3が最適であるように思える。このような考察からわかるように、
(単にnewする場合も含めて)オブジェクトの取得にどのような方法を用いるかは、
クラスの性質に依存する。</p>
<h2 id="proxy">Proxy <a id="SS_2_18"></a></h2>
<p>Proxyとは代理人という意味で、
本物のクラスに代わり代理クラス(Proxy)が処理を受け取る
(実際は、処理自体は本物クラスに委譲されることもある)パターンである。</p>
<p>以下の順番で例を示すことで、Proxyパターンの説明を行う。</p>
<ol type="1">
<li>内部構造を外部公開しているサーバ クラス</li>
<li>そのサーバをラッピングして、使いやすくしたサーバ
クラス(Facadeパターン)</li>
<li>サーバをラップしたクラスのProxyクラス</li>
</ol>
<p>まずは、内部構造を外部公開しているの醜悪なサーバの実装例である。</p>
<div class="sourceCode" id="cb117"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/bare_server.h 5</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">enum</span> <span class="kw">class</span> Cmd <span class="op">{</span></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>        SayHello<span class="op">,</span></span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>        SayGoodbye<span class="op">,</span></span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>        Shutdown<span class="op">,</span></span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> Packet <span class="op">{</span></span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a>        Cmd cmd<span class="op">;</span></span>
<span id="cb117-11"><a href="#cb117-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb117-12"><a href="#cb117-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-13"><a href="#cb117-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> BareServer <span class="kw">final</span> <span class="op">{</span></span>
<span id="cb117-14"><a href="#cb117-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb117-15"><a href="#cb117-15" aria-hidden="true" tabindex="-1"></a>        BareServer<span class="op">()</span> <span class="kw">noexcept</span><span class="op">;</span></span>
<span id="cb117-16"><a href="#cb117-16" aria-hidden="true" tabindex="-1"></a>        <span class="op">~</span>BareServer<span class="op">();</span></span>
<span id="cb117-17"><a href="#cb117-17" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> GetPipeW<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span>  <span class="co">// クライアントのwrite用</span></span>
<span id="cb117-18"><a href="#cb117-18" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb117-19"><a href="#cb117-19" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">to_server_</span><span class="op">[</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb117-20"><a href="#cb117-20" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb117-21"><a href="#cb117-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-22"><a href="#cb117-22" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> GetPipeR<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span>  <span class="co">// クライアントのread用</span></span>
<span id="cb117-23"><a href="#cb117-23" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb117-24"><a href="#cb117-24" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">to_client_</span><span class="op">[</span><span class="dv">0</span><span class="op">];</span></span>
<span id="cb117-25"><a href="#cb117-25" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb117-26"><a href="#cb117-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-27"><a href="#cb117-27" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> Start<span class="op">();</span></span>
<span id="cb117-28"><a href="#cb117-28" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> Wait<span class="op">()</span> <span class="kw">noexcept</span><span class="op">;</span></span>
<span id="cb117-29"><a href="#cb117-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-30"><a href="#cb117-30" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb117-31"><a href="#cb117-31" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span>         <span class="va">to_server_</span><span class="op">[</span><span class="dv">2</span><span class="op">];</span>  <span class="co">// サーバへの通信用</span></span>
<span id="cb117-32"><a href="#cb117-32" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span>         <span class="va">to_client_</span><span class="op">[</span><span class="dv">2</span><span class="op">];</span>  <span class="co">// クライアントへの通信用</span></span>
<span id="cb117-33"><a href="#cb117-33" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>thread<span class="op"> </span><span class="va">thread_</span><span class="op">;</span></span>
<span id="cb117-34"><a href="#cb117-34" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb118"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/bare_server.cpp 9</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> <span class="op">{</span></span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bool</span> cmd_dispatch<span class="op">(</span><span class="dt">int</span> wfd<span class="op">,</span> Cmd cmd<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="dt">char</span> <span class="at">const</span> hello<span class="op">[]</span>   <span class="op">=</span> <span class="st">&quot;Hello&quot;</span><span class="op">;</span></span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="dt">char</span> <span class="at">const</span> goodbye<span class="op">[]</span> <span class="op">=</span> <span class="st">&quot;Goodbye&quot;</span><span class="op">;</span></span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">switch</span> <span class="op">(</span>cmd<span class="op">)</span> <span class="op">{</span></span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> Cmd<span class="op">::</span>SayHello<span class="op">:</span></span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a>            write<span class="op">(</span>wfd<span class="op">,</span> hello<span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>hello<span class="op">));</span></span>
<span id="cb118-12"><a href="#cb118-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span><span class="op">;</span></span>
<span id="cb118-13"><a href="#cb118-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> Cmd<span class="op">::</span>SayGoodbye<span class="op">:</span></span>
<span id="cb118-14"><a href="#cb118-14" aria-hidden="true" tabindex="-1"></a>            write<span class="op">(</span>wfd<span class="op">,</span> goodbye<span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>goodbye<span class="op">));</span></span>
<span id="cb118-15"><a href="#cb118-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span><span class="op">;</span></span>
<span id="cb118-16"><a href="#cb118-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> Cmd<span class="op">::</span>Shutdown<span class="op">:</span></span>
<span id="cb118-17"><a href="#cb118-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">default</span><span class="op">:</span></span>
<span id="cb118-18"><a href="#cb118-18" aria-hidden="true" tabindex="-1"></a>            <span class="bu">std::</span>cout<span class="op"> &lt;&lt;</span> <span class="st">&quot;Shutdown&quot;</span> <span class="op">&lt;&lt;</span> <span class="bu">std::</span>endl<span class="op">;</span></span>
<span id="cb118-19"><a href="#cb118-19" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb118-20"><a href="#cb118-20" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb118-21"><a href="#cb118-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-22"><a href="#cb118-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb118-23"><a href="#cb118-23" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb118-24"><a href="#cb118-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-25"><a href="#cb118-25" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> thread_entry<span class="op">(</span><span class="dt">int</span> rfd<span class="op">,</span> <span class="dt">int</span> wfd<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb118-26"><a href="#cb118-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb118-27"><a href="#cb118-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(;;)</span> <span class="op">{</span></span>
<span id="cb118-28"><a href="#cb118-28" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> packet <span class="op">=</span> Packet<span class="op">{};</span></span>
<span id="cb118-29"><a href="#cb118-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-30"><a href="#cb118-30" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>read<span class="op">(</span>rfd<span class="op">,</span> <span class="op">&amp;</span>packet<span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>packet<span class="op">))</span> <span class="op">&lt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb118-31"><a href="#cb118-31" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb118-32"><a href="#cb118-32" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb118-33"><a href="#cb118-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-34"><a href="#cb118-34" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(!</span>cmd_dispatch<span class="op">(</span>wfd<span class="op">,</span> packet<span class="op">.</span>cmd<span class="op">))</span> <span class="op">{</span></span>
<span id="cb118-35"><a href="#cb118-35" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span><span class="op">;</span></span>
<span id="cb118-36"><a href="#cb118-36" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb118-37"><a href="#cb118-37" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb118-38"><a href="#cb118-38" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb118-39"><a href="#cb118-39" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace</span></span>
<span id="cb118-40"><a href="#cb118-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-41"><a href="#cb118-41" aria-hidden="true" tabindex="-1"></a>    BareServer<span class="op">::</span>BareServer<span class="op">()</span> <span class="kw">noexcept</span> <span class="op">:</span> <span class="va">to_server_</span><span class="op">{-</span><span class="dv">1</span><span class="op">,</span> <span class="op">-</span><span class="dv">1</span><span class="op">},</span> <span class="va">to_client_</span><span class="op">{-</span><span class="dv">1</span><span class="op">,</span> <span class="op">-</span><span class="dv">1</span><span class="op">},</span> <span class="va">thread_</span><span class="op">{}</span></span>
<span id="cb118-42"><a href="#cb118-42" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb118-43"><a href="#cb118-43" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> ret <span class="op">=</span> pipe<span class="op">(</span><span class="va">to_server_</span><span class="op">);</span></span>
<span id="cb118-44"><a href="#cb118-44" aria-hidden="true" tabindex="-1"></a>        <span class="ot">assert</span><span class="op">(</span>ret <span class="op">&gt;=</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb118-45"><a href="#cb118-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-46"><a href="#cb118-46" aria-hidden="true" tabindex="-1"></a>        ret <span class="op">=</span> pipe<span class="op">(</span><span class="va">to_client_</span><span class="op">);</span></span>
<span id="cb118-47"><a href="#cb118-47" aria-hidden="true" tabindex="-1"></a>        <span class="ot">assert</span><span class="op">(</span>ret <span class="op">&gt;=</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb118-48"><a href="#cb118-48" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb118-49"><a href="#cb118-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-50"><a href="#cb118-50" aria-hidden="true" tabindex="-1"></a>    BareServer<span class="op">::~</span>BareServer<span class="op">()</span></span>
<span id="cb118-51"><a href="#cb118-51" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb118-52"><a href="#cb118-52" aria-hidden="true" tabindex="-1"></a>        close<span class="op">(</span><span class="va">to_server_</span><span class="op">[</span><span class="dv">0</span><span class="op">]);</span></span>
<span id="cb118-53"><a href="#cb118-53" aria-hidden="true" tabindex="-1"></a>        close<span class="op">(</span><span class="va">to_server_</span><span class="op">[</span><span class="dv">1</span><span class="op">]);</span></span>
<span id="cb118-54"><a href="#cb118-54" aria-hidden="true" tabindex="-1"></a>        close<span class="op">(</span><span class="va">to_client_</span><span class="op">[</span><span class="dv">0</span><span class="op">]);</span></span>
<span id="cb118-55"><a href="#cb118-55" aria-hidden="true" tabindex="-1"></a>        close<span class="op">(</span><span class="va">to_client_</span><span class="op">[</span><span class="dv">1</span><span class="op">]);</span></span>
<span id="cb118-56"><a href="#cb118-56" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb118-57"><a href="#cb118-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-58"><a href="#cb118-58" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> BareServer<span class="op">::</span>Start<span class="op">()</span></span>
<span id="cb118-59"><a href="#cb118-59" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb118-60"><a href="#cb118-60" aria-hidden="true" tabindex="-1"></a>        <span class="va">thread_</span> <span class="op">=</span> <span class="bu">std::</span>thread<span class="op">{</span>thread_entry<span class="op">,</span> <span class="va">to_server_</span><span class="op">[</span><span class="dv">0</span><span class="op">],</span> <span class="va">to_client_</span><span class="op">[</span><span class="dv">1</span><span class="op">]};</span></span>
<span id="cb118-61"><a href="#cb118-61" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>cout<span class="op"> &lt;&lt;</span> <span class="st">&quot;thread started !!!&quot;</span> <span class="op">&lt;&lt;</span> <span class="bu">std::</span>endl<span class="op">;</span></span>
<span id="cb118-62"><a href="#cb118-62" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb118-63"><a href="#cb118-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-64"><a href="#cb118-64" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> BareServer<span class="op">::</span>Wait<span class="op">()</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="va">thread_</span><span class="op">.</span>join<span class="op">();</span> <span class="op">}</span></span></code></pre></div>
<p>下記は、上記BareServerを使用するクライアントの実装例である。通信がpipe()によって行われ、
その中身がPacket{}であること等、不要な依存関係をbare_client()に強いていることがわかる。
このような構造は、機能追加、保守作業を非効率、困難にするアンチパターンである。</p>
<div class="sourceCode" id="cb119"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/proxy_ut.cpp 17</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@fn</span><span class="co"> </span><span class="do">bare_client</span></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@brief</span><span class="co"> 非同期サービスを隠蔽していないBareServerを使用したときのクライアントの例</span></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;</span> bare_client<span class="op">(</span>BareServer<span class="op">&amp;</span> bs<span class="op">)</span></span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> <span class="at">const</span> wfd <span class="op">=</span> bs<span class="op">.</span>GetPipeW<span class="op">();</span></span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> <span class="at">const</span> rfd <span class="op">=</span> bs<span class="op">.</span>GetPipeR<span class="op">();</span></span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span>       ret <span class="op">=</span> <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;{};</span></span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-11"><a href="#cb119-11" aria-hidden="true" tabindex="-1"></a>        bs<span class="op">.</span>Start<span class="op">();</span></span>
<span id="cb119-12"><a href="#cb119-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-13"><a href="#cb119-13" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> packet <span class="op">=</span> Packet<span class="op">{};</span></span>
<span id="cb119-14"><a href="#cb119-14" aria-hidden="true" tabindex="-1"></a>        <span class="dt">char</span> buffer<span class="op">[</span><span class="dv">30</span><span class="op">];</span></span>
<span id="cb119-15"><a href="#cb119-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-16"><a href="#cb119-16" aria-hidden="true" tabindex="-1"></a>        packet<span class="op">.</span>cmd <span class="op">=</span> Cmd<span class="op">::</span>SayHello<span class="op">;</span></span>
<span id="cb119-17"><a href="#cb119-17" aria-hidden="true" tabindex="-1"></a>        write<span class="op">(</span>wfd<span class="op">,</span> <span class="op">&amp;</span>packet<span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>packet<span class="op">));</span></span>
<span id="cb119-18"><a href="#cb119-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-19"><a href="#cb119-19" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> read_ret <span class="op">=</span> read<span class="op">(</span>rfd<span class="op">,</span> buffer<span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>buffer<span class="op">));</span></span>
<span id="cb119-20"><a href="#cb119-20" aria-hidden="true" tabindex="-1"></a>        <span class="ot">assert</span><span class="op">(</span>read_ret <span class="op">&gt;</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb119-21"><a href="#cb119-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-22"><a href="#cb119-22" aria-hidden="true" tabindex="-1"></a>        ret<span class="op">.</span>emplace_back<span class="op">(</span>buffer<span class="op">);</span></span>
<span id="cb119-23"><a href="#cb119-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-24"><a href="#cb119-24" aria-hidden="true" tabindex="-1"></a>        packet<span class="op">.</span>cmd <span class="op">=</span> Cmd<span class="op">::</span>SayGoodbye<span class="op">;</span></span>
<span id="cb119-25"><a href="#cb119-25" aria-hidden="true" tabindex="-1"></a>        write<span class="op">(</span>wfd<span class="op">,</span> <span class="op">&amp;</span>packet<span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>packet<span class="op">));</span></span>
<span id="cb119-26"><a href="#cb119-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-27"><a href="#cb119-27" aria-hidden="true" tabindex="-1"></a>        read_ret <span class="op">=</span> read<span class="op">(</span>rfd<span class="op">,</span> buffer<span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>buffer<span class="op">));</span></span>
<span id="cb119-28"><a href="#cb119-28" aria-hidden="true" tabindex="-1"></a>        <span class="ot">assert</span><span class="op">(</span>read_ret <span class="op">&gt;</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb119-29"><a href="#cb119-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-30"><a href="#cb119-30" aria-hidden="true" tabindex="-1"></a>        ret<span class="op">.</span>emplace_back<span class="op">(</span>buffer<span class="op">);</span></span>
<span id="cb119-31"><a href="#cb119-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-32"><a href="#cb119-32" aria-hidden="true" tabindex="-1"></a>        packet<span class="op">.</span>cmd <span class="op">=</span> Cmd<span class="op">::</span>Shutdown<span class="op">;</span></span>
<span id="cb119-33"><a href="#cb119-33" aria-hidden="true" tabindex="-1"></a>        write<span class="op">(</span>wfd<span class="op">,</span> <span class="op">&amp;</span>packet<span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>packet<span class="op">));</span></span>
<span id="cb119-34"><a href="#cb119-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-35"><a href="#cb119-35" aria-hidden="true" tabindex="-1"></a>        bs<span class="op">.</span>Wait<span class="op">();</span></span>
<span id="cb119-36"><a href="#cb119-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-37"><a href="#cb119-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> ret<span class="op">;</span></span>
<span id="cb119-38"><a href="#cb119-38" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>次に、このむき出しの構造をラッピングする例を示す(このようなラッピングをFacadeパターンと呼ぶ)。</p>
<div class="sourceCode" id="cb120"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/bare_server_wrapper.h 6</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">enum</span> <span class="kw">class</span> Cmd<span class="op">;</span>  <span class="co">// C++11からenumは前方宣言できる。</span></span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> BareServer<span class="op">;</span></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> BareServerWrapper <span class="kw">final</span> <span class="op">{</span></span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a>        BareServerWrapper<span class="op">();</span></span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span>        Start<span class="op">();</span></span>
<span id="cb120-11"><a href="#cb120-11" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span>SayHello<span class="op">();</span></span>
<span id="cb120-12"><a href="#cb120-12" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span>SayGoodbye<span class="op">();</span></span>
<span id="cb120-13"><a href="#cb120-13" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span>        Shutdown<span class="op">()</span> <span class="kw">noexcept</span><span class="op">;</span></span>
<span id="cb120-14"><a href="#cb120-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-15"><a href="#cb120-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb120-16"><a href="#cb120-16" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span>                        send_message<span class="op">(</span><span class="kw">enum</span> Cmd cmd<span class="op">)</span> <span class="kw">noexcept</span><span class="op">;</span></span>
<span id="cb120-17"><a href="#cb120-17" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>BareServer<span class="op">&gt;</span> <span class="va">bare_server_</span><span class="op">;</span></span>
<span id="cb120-18"><a href="#cb120-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb121"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/bare_server_wrapper.cpp 8</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>    BareServerWrapper<span class="op">::</span>BareServerWrapper<span class="op">()</span> <span class="op">:</span> <span class="va">bare_server_</span><span class="op">{</span><span class="bu">std::</span>make_unique<span class="op">&lt;</span>BareServer<span class="op">&gt;()}</span> <span class="op">{}</span></span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> BareServerWrapper<span class="op">::</span>Start<span class="op">()</span> <span class="op">{</span> <span class="va">bare_server_</span><span class="op">-&gt;</span>Start<span class="op">();</span> <span class="op">}</span></span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> BareServerWrapper<span class="op">::</span>send_message<span class="op">(</span><span class="kw">enum</span> Cmd cmd<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb121-9"><a href="#cb121-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> packet <span class="op">=</span> Packet<span class="op">{</span>cmd<span class="op">};</span></span>
<span id="cb121-10"><a href="#cb121-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-11"><a href="#cb121-11" aria-hidden="true" tabindex="-1"></a>        write<span class="op">(</span><span class="va">bare_server_</span><span class="op">-&gt;</span>GetPipeW<span class="op">(),</span> <span class="op">&amp;</span>packet<span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>packet<span class="op">));</span></span>
<span id="cb121-12"><a href="#cb121-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb121-13"><a href="#cb121-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-14"><a href="#cb121-14" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>string<span class="op"> </span>BareServerWrapper<span class="op">::</span>SayHello<span class="op">()</span></span>
<span id="cb121-15"><a href="#cb121-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb121-16"><a href="#cb121-16" aria-hidden="true" tabindex="-1"></a>        <span class="dt">char</span> buffer<span class="op">[</span><span class="dv">30</span><span class="op">];</span></span>
<span id="cb121-17"><a href="#cb121-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-18"><a href="#cb121-18" aria-hidden="true" tabindex="-1"></a>        send_message<span class="op">(</span>Cmd<span class="op">::</span>SayHello<span class="op">);</span></span>
<span id="cb121-19"><a href="#cb121-19" aria-hidden="true" tabindex="-1"></a>        read<span class="op">(</span><span class="va">bare_server_</span><span class="op">-&gt;</span>GetPipeR<span class="op">(),</span> buffer<span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>buffer<span class="op">));</span></span>
<span id="cb121-20"><a href="#cb121-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-21"><a href="#cb121-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> buffer<span class="op">;</span></span>
<span id="cb121-22"><a href="#cb121-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb121-23"><a href="#cb121-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-24"><a href="#cb121-24" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>string<span class="op"> </span>BareServerWrapper<span class="op">::</span>SayGoodbye<span class="op">()</span></span>
<span id="cb121-25"><a href="#cb121-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb121-26"><a href="#cb121-26" aria-hidden="true" tabindex="-1"></a>        <span class="dt">char</span> buffer<span class="op">[</span><span class="dv">30</span><span class="op">];</span></span>
<span id="cb121-27"><a href="#cb121-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-28"><a href="#cb121-28" aria-hidden="true" tabindex="-1"></a>        send_message<span class="op">(</span>Cmd<span class="op">::</span>SayGoodbye<span class="op">);</span></span>
<span id="cb121-29"><a href="#cb121-29" aria-hidden="true" tabindex="-1"></a>        read<span class="op">(</span><span class="va">bare_server_</span><span class="op">-&gt;</span>GetPipeR<span class="op">(),</span> buffer<span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>buffer<span class="op">));</span></span>
<span id="cb121-30"><a href="#cb121-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-31"><a href="#cb121-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> buffer<span class="op">;</span></span>
<span id="cb121-32"><a href="#cb121-32" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb121-33"><a href="#cb121-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-34"><a href="#cb121-34" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> BareServerWrapper<span class="op">::</span>Shutdown<span class="op">()</span> <span class="kw">noexcept</span></span>
<span id="cb121-35"><a href="#cb121-35" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb121-36"><a href="#cb121-36" aria-hidden="true" tabindex="-1"></a>        send_message<span class="op">(</span>Cmd<span class="op">::</span>Shutdown<span class="op">);</span></span>
<span id="cb121-37"><a href="#cb121-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-38"><a href="#cb121-38" aria-hidden="true" tabindex="-1"></a>        <span class="va">bare_server_</span><span class="op">-&gt;</span>Wait<span class="op">();</span></span>
<span id="cb121-39"><a href="#cb121-39" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>下記は、上記BareServerWrapperのクライアントの実装例である。
BareServerWrapperがむき出しの通信をラップしたことで、bare_wrapper_client()は、
bare_client()に比べてシンプルになったことがわかる。</p>
<div class="sourceCode" id="cb122"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/proxy_ut.cpp 57</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@fn</span><span class="co"> </span><span class="do">bare_wrapper_client</span></span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@brief</span><span class="co"> BareServerを使いやすくラップしたBareServerWrapperを使用したときのクライアントの例</span></span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;</span> bare_wrapper_client<span class="op">(</span>BareServerWrapper<span class="op">&amp;</span> bsw<span class="op">)</span></span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> ret <span class="op">=</span> <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;{};</span></span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>        bsw<span class="op">.</span>Start<span class="op">();</span></span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a>        ret<span class="op">.</span>emplace_back<span class="op">(</span>bsw<span class="op">.</span>SayHello<span class="op">());</span></span>
<span id="cb122-12"><a href="#cb122-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-13"><a href="#cb122-13" aria-hidden="true" tabindex="-1"></a>        ret<span class="op">.</span>emplace_back<span class="op">(</span>bsw<span class="op">.</span>SayGoodbye<span class="op">());</span></span>
<span id="cb122-14"><a href="#cb122-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-15"><a href="#cb122-15" aria-hidden="true" tabindex="-1"></a>        bsw<span class="op">.</span>Shutdown<span class="op">();</span></span>
<span id="cb122-16"><a href="#cb122-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-17"><a href="#cb122-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> ret<span class="op">;</span></span>
<span id="cb122-18"><a href="#cb122-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>次の例は、BareServerとBareServerWrapperを統合し、
さらに全体をシンプルにリファクタリングしたWrappedServerである。
Packet{}やpipe等の通信の詳細がwrapped_server.cppの無名名前空間に閉じ込められ、
クラスの隠蔽性が強化されたことで、より機能追加、保守が容易になった。</p>
<div class="sourceCode" id="cb123"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/wrapped_server.h 5</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> WrappedServer <span class="op">{</span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>        WrappedServer<span class="op">()</span> <span class="kw">noexcept</span><span class="op">;</span></span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="op">~</span>WrappedServer<span class="op">();</span></span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span>        Start<span class="op">();</span></span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span>SayHello<span class="op">()</span> <span class="op">{</span> <span class="cf">return</span> say_hello<span class="op">();</span> <span class="op">}</span></span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span>SayGoodbye<span class="op">()</span> <span class="op">{</span> <span class="cf">return</span> say_goodbye<span class="op">();</span> <span class="op">}</span></span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span>        Shutdown<span class="op">()</span> <span class="kw">noexcept</span><span class="op">;</span></span>
<span id="cb123-12"><a href="#cb123-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-13"><a href="#cb123-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">protected</span><span class="op">:</span></span>
<span id="cb123-14"><a href="#cb123-14" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="bu">std::</span>string<span class="op"> </span>say_hello<span class="op">();</span>    <span class="co">// 後で拡張するためにvirtual</span></span>
<span id="cb123-15"><a href="#cb123-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="bu">std::</span>string<span class="op"> </span>say_goodbye<span class="op">();</span>  <span class="co">// 同上</span></span>
<span id="cb123-16"><a href="#cb123-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-17"><a href="#cb123-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb123-18"><a href="#cb123-18" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span>         <span class="va">to_server_</span><span class="op">[</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb123-19"><a href="#cb123-19" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span>         <span class="va">to_client_</span><span class="op">[</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb123-20"><a href="#cb123-20" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>thread<span class="op"> </span><span class="va">thread_</span><span class="op">;</span></span>
<span id="cb123-21"><a href="#cb123-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb124"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/wrapped_server.cpp 8</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> <span class="op">{</span></span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">enum</span> <span class="kw">class</span> Cmd <span class="op">{</span></span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> Packet <span class="op">{</span></span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a>        Cmd cmd<span class="op">;</span></span>
<span id="cb124-10"><a href="#cb124-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb124-11"><a href="#cb124-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace</span></span>
<span id="cb124-12"><a href="#cb124-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-13"><a href="#cb124-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 以下、bare_server_wrapper.cppのコードとほぼ同じであるため省略。</span></span>
<span id="cb124-14"><a href="#cb124-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-15"><a href="#cb124-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span></span></code></pre></div>
<p>WrappedServerの使用例を下記する。当然ながらbare_wrapper_client()とほぼ同様になる。</p>
<div class="sourceCode" id="cb125"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/proxy_ut.cpp 77</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@fn</span><span class="co"> </span><span class="do">wrapped_client</span></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@brief</span><span class="co"> 非同期サービスを隠蔽しているWrappedServerを使用したときのクライアントの例</span></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;</span> wrapped_client<span class="op">(</span>WrappedServer<span class="op">&amp;</span> ws<span class="op">)</span></span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> ret <span class="op">=</span> <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;{};</span></span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a>        ws<span class="op">.</span>Start<span class="op">();</span></span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a>        ret<span class="op">.</span>emplace_back<span class="op">(</span>ws<span class="op">.</span>SayHello<span class="op">());</span></span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-13"><a href="#cb125-13" aria-hidden="true" tabindex="-1"></a>        ret<span class="op">.</span>emplace_back<span class="op">(</span>ws<span class="op">.</span>SayGoodbye<span class="op">());</span></span>
<span id="cb125-14"><a href="#cb125-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-15"><a href="#cb125-15" aria-hidden="true" tabindex="-1"></a>        ws<span class="op">.</span>Shutdown<span class="op">();</span></span>
<span id="cb125-16"><a href="#cb125-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-17"><a href="#cb125-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> ret<span class="op">;</span></span>
<span id="cb125-18"><a href="#cb125-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>WrappedServerが提供する機能はスレッド間通信を含むため処理コストが高い。
その対策として、サーバから送られてきた文字列をキャッシュするクラス(Proxyパターン)の導入により、
そのコストを削減する例を下記する。</p>
<div class="sourceCode" id="cb126"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/wrapped_server_proxy.h 7</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> WrappedServerProxy <span class="kw">final</span> <span class="op">:</span> <span class="kw">public</span> WrappedServer <span class="op">{</span></span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>        WrappedServerProxy<span class="op">()</span> <span class="op">=</span> <span class="cf">default</span><span class="op">;</span></span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span>        <span class="va">hello_cashe_</span><span class="op">{};</span></span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="bu">std::</span>string<span class="op"> </span>say_hello<span class="op">()</span> <span class="kw">override</span><span class="op">;</span></span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="bu">std::</span>string<span class="op"> </span>say_goodbye<span class="op">()</span> <span class="kw">override</span><span class="op">;</span></span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb127"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/wrapped_server_proxy.cpp 7</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>string<span class="op"> </span>WrappedServerProxy<span class="op">::</span>say_hello<span class="op">()</span></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span><span class="va">hello_cashe_</span><span class="op">.</span>size<span class="op">()</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>            <span class="va">hello_cashe_</span> <span class="op">=</span> WrappedServer<span class="op">::</span>say_hello<span class="op">();</span>  <span class="co">// キャッシュとし保存</span></span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">hello_cashe_</span><span class="op">;</span></span>
<span id="cb127-10"><a href="#cb127-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb127-11"><a href="#cb127-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-12"><a href="#cb127-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>string<span class="op"> </span>WrappedServerProxy<span class="op">::</span>say_goodbye<span class="op">()</span></span>
<span id="cb127-13"><a href="#cb127-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb127-14"><a href="#cb127-14" aria-hidden="true" tabindex="-1"></a>        <span class="va">hello_cashe_</span> <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{};</span>  <span class="co">// helloキャッシュをクリア</span></span>
<span id="cb127-15"><a href="#cb127-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-16"><a href="#cb127-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> WrappedServer<span class="op">::</span>say_goodbye<span class="op">();</span></span>
<span id="cb127-17"><a href="#cb127-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>下記図のようにWrappedServerProxyはWrappedServerからのパブリック継承であるため、
WrappedServerのクライアントは、そのままWrappedServerProxyのクライアントとして利用できる。</p>
<p>
<img src="data:image/png;base64,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" />
</p>
<p>なお、正確には下記のようなクラス構造をProxyパターンと呼ぶことが多いが、
ここでは単純さを優先した。</p>
<p>
<img src="data:image/png;base64,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" />
</p>
<h2 id="strategy">Strategy <a id="SS_2_19"></a></h2>
<p>関数f(args)の振る舞いが、</p>
<ul>
<li>全体の制御</li>
<li>部分的な振る舞い(何らかの条件を探す等)</li>
</ul>
<p>に分けられるような場合、関数fを</p>
<ul>
<li>「全体の制御」を行う関数g</li>
<li>「部分的な振る舞い」を規定するStrategyオブジェクト(関数へのポインタ、関数オブジェクト、ラムダ式)</li>
</ul>
<p>に分割し、下記のように、Strategyオブジェクトをgの引数として外部から渡せるようにしたパターンである
(std::sort()のようなパターン)。</p>
<div class="sourceCode" id="cb128"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>    g<span class="op">(</span>args<span class="op">,</span> Strategyオブジェクト<span class="op">)</span></span></code></pre></div>
<p>Strategyオブジェクトにいろいろなバリエーションがある場合、このパターンを使うと良い。
なお、このパターンの対象はクラスになる場合もある。</p>
<p>「ディレクトリをリカーシブに追跡し、引数で指定された属性にマッチしたファイルの一覧を返す関数」
を開発することを要求されたとする。</p>
<p>まずは、拡張性のない実装例を示す。</p>
<div class="sourceCode" id="cb129"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/find_files_old_style.h 4</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@enum</span><span class="co"> </span><span class="cv">FindCondition</span></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// find_files_recursivelyの条件</span></span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">enum</span> <span class="kw">class</span> FindCondition <span class="op">{</span></span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>        File<span class="op">,</span>              <span class="co">///&lt; pathがファイル</span></span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a>        Dir<span class="op">,</span>               <span class="co">///&lt; pathがディレクトリ</span></span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a>        FileNameHeadIs_f<span class="op">,</span>  <span class="co">///&lt; pathがファイル且つ、そのファイル名の先頭が&quot;f&quot;</span></span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb130"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/find_files_old_style.cpp 9</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@fn</span><span class="co"> </span><span class="do">std::vector</span><span class="kw">&lt;std::string&gt;</span><span class="co"> </span><span class="do">find_files_recursively(std::string</span><span class="co"> </span><span class="do">const&amp;</span><span class="co"> </span><span class="do">path,</span></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">///                                                     FindCondition condition)</span></span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@brief</span><span class="co"> 条件にマッチしたファイルをリカーシブに探して返す</span></span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@param</span><span class="co"> </span><span class="cv">path</span><span class="co">      リカーシブにディレクトリをたどるための起点となるパス</span></span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@param</span><span class="co"> </span><span class="cv">condition</span><span class="co"> どのようなファイルかを指定する</span></span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@return</span><span class="co"> 条件にマッチしたファイルをstd::vector</span><span class="kw">&lt;std::string&gt;</span><span class="co">で返す</span></span>
<span id="cb130-9"><a href="#cb130-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;</span> find_files_recursively<span class="op">(</span><span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span><span class="op">&amp;</span> path<span class="op">,</span> FindCondition condition<span class="op">)</span></span>
<span id="cb130-10"><a href="#cb130-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb130-11"><a href="#cb130-11" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> files <span class="op">=</span> <span class="bu">std::</span>vector<span class="op">&lt;</span>fs<span class="op">::</span>path<span class="op">&gt;{};</span></span>
<span id="cb130-12"><a href="#cb130-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-13"><a href="#cb130-13" aria-hidden="true" tabindex="-1"></a>        <span class="co">// recursive_directory_iteratorはファイルシステム依存するため、その依存を排除する他の処理</span></span>
<span id="cb130-14"><a href="#cb130-14" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>copy<span class="op">(</span>fs<span class="op">::</span>recursive_directory_iterator<span class="op">{</span>path<span class="op">},</span> fs<span class="op">::</span>recursive_directory_iterator<span class="op">{},</span></span>
<span id="cb130-15"><a href="#cb130-15" aria-hidden="true" tabindex="-1"></a>                  <span class="bu">std::</span>back_inserter<span class="op">(</span>files<span class="op">));</span></span>
<span id="cb130-16"><a href="#cb130-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-17"><a href="#cb130-17" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>sort<span class="op">(</span>files<span class="op">.</span>begin<span class="op">(),</span> files<span class="op">.</span>end<span class="op">());</span></span>
<span id="cb130-18"><a href="#cb130-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-19"><a href="#cb130-19" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> ret <span class="op">=</span> <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;{};</span></span>
<span id="cb130-20"><a href="#cb130-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-21"><a href="#cb130-21" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>for_each<span class="op">(</span>files<span class="op">.</span>begin<span class="op">(),</span> files<span class="op">.</span>end<span class="op">(),</span> <span class="op">[&amp;](</span>fs<span class="op">::</span>path <span class="at">const</span><span class="op">&amp;</span> p<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span></span>
<span id="cb130-22"><a href="#cb130-22" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> is_match <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb130-23"><a href="#cb130-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-24"><a href="#cb130-24" aria-hidden="true" tabindex="-1"></a>            <span class="cf">switch</span> <span class="op">(</span>condition<span class="op">)</span> <span class="op">{</span></span>
<span id="cb130-25"><a href="#cb130-25" aria-hidden="true" tabindex="-1"></a>            <span class="cf">case</span> FindCondition<span class="op">::</span>File<span class="op">:</span></span>
<span id="cb130-26"><a href="#cb130-26" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="op">(</span>fs<span class="op">::</span>is_regular_file<span class="op">(</span>p<span class="op">))</span> <span class="op">{</span></span>
<span id="cb130-27"><a href="#cb130-27" aria-hidden="true" tabindex="-1"></a>                    is_match <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb130-28"><a href="#cb130-28" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span></span>
<span id="cb130-29"><a href="#cb130-29" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span><span class="op">;</span></span>
<span id="cb130-30"><a href="#cb130-30" aria-hidden="true" tabindex="-1"></a>            <span class="cf">case</span> FindCondition<span class="op">::</span>Dir<span class="op">:</span></span>
<span id="cb130-31"><a href="#cb130-31" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="op">(</span>fs<span class="op">::</span>is_directory<span class="op">(</span>p<span class="op">))</span> <span class="op">{</span></span>
<span id="cb130-32"><a href="#cb130-32" aria-hidden="true" tabindex="-1"></a>                    is_match <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb130-33"><a href="#cb130-33" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span></span>
<span id="cb130-34"><a href="#cb130-34" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span><span class="op">;</span></span>
<span id="cb130-35"><a href="#cb130-35" aria-hidden="true" tabindex="-1"></a>                <span class="op">...</span></span>
<span id="cb130-36"><a href="#cb130-36" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb130-37"><a href="#cb130-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-38"><a href="#cb130-38" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>is_match<span class="op">)</span> <span class="op">{</span></span>
<span id="cb130-39"><a href="#cb130-39" aria-hidden="true" tabindex="-1"></a>                ret<span class="op">.</span>emplace_back<span class="op">(</span>p<span class="op">.</span>generic_string<span class="op">());</span></span>
<span id="cb130-40"><a href="#cb130-40" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb130-41"><a href="#cb130-41" aria-hidden="true" tabindex="-1"></a>        <span class="op">});</span></span>
<span id="cb130-42"><a href="#cb130-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-43"><a href="#cb130-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> ret<span class="op">;</span></span>
<span id="cb130-44"><a href="#cb130-44" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb131"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/find_files_ut.cpp 29</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>    TEST<span class="op">(</span>Strategy<span class="op">,</span> old_style<span class="op">)</span></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>        assure_test_files_exist<span class="op">();</span>  <span class="co">// test用のファイルがあることの確認</span></span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> <span class="at">const</span> files_actual <span class="op">=</span> find_files_recursively<span class="op">(</span>test_dir<span class="op">,</span> FindCondition<span class="op">::</span>File<span class="op">);</span></span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> <span class="at">const</span> files_expect <span class="op">=</span> sort<span class="op">(</span><span class="bu">std::</span>vector<span class="op">{</span></span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a>            test_dir <span class="op">+</span> <span class="st">&quot;dir0/file2&quot;</span><span class="op">,</span></span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a>            test_dir <span class="op">+</span> <span class="st">&quot;dir0/gile3&quot;</span><span class="op">,</span></span>
<span id="cb131-11"><a href="#cb131-11" aria-hidden="true" tabindex="-1"></a>            test_dir <span class="op">+</span> <span class="st">&quot;dir1/dir2/file4&quot;</span><span class="op">,</span></span>
<span id="cb131-12"><a href="#cb131-12" aria-hidden="true" tabindex="-1"></a>            test_dir <span class="op">+</span> <span class="st">&quot;file0&quot;</span><span class="op">,</span></span>
<span id="cb131-13"><a href="#cb131-13" aria-hidden="true" tabindex="-1"></a>            test_dir <span class="op">+</span> <span class="st">&quot;gile1&quot;</span></span>
<span id="cb131-14"><a href="#cb131-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">});</span></span>
<span id="cb131-15"><a href="#cb131-15" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span>files_expect<span class="op">,</span> files_actual<span class="op">);</span></span>
<span id="cb131-16"><a href="#cb131-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-17"><a href="#cb131-17" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> <span class="at">const</span> dirs_actual <span class="op">=</span> find_files_recursively<span class="op">(</span>test_dir<span class="op">,</span> FindCondition<span class="op">::</span>Dir<span class="op">);</span></span>
<span id="cb131-18"><a href="#cb131-18" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> <span class="at">const</span> dirs_expect <span class="op">=</span> sort<span class="op">(</span><span class="bu">std::</span>vector<span class="op">{</span></span>
<span id="cb131-19"><a href="#cb131-19" aria-hidden="true" tabindex="-1"></a>            test_dir <span class="op">+</span> <span class="st">&quot;dir0&quot;</span><span class="op">,</span></span>
<span id="cb131-20"><a href="#cb131-20" aria-hidden="true" tabindex="-1"></a>            test_dir <span class="op">+</span> <span class="st">&quot;dir1&quot;</span><span class="op">,</span></span>
<span id="cb131-21"><a href="#cb131-21" aria-hidden="true" tabindex="-1"></a>            test_dir <span class="op">+</span> <span class="st">&quot;dir1/dir2&quot;</span></span>
<span id="cb131-22"><a href="#cb131-22" aria-hidden="true" tabindex="-1"></a>        <span class="op">});</span></span>
<span id="cb131-23"><a href="#cb131-23" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span>dirs_expect<span class="op">,</span> dirs_actual<span class="op">);</span></span>
<span id="cb131-24"><a href="#cb131-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-25"><a href="#cb131-25" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> <span class="at">const</span> f_actual <span class="op">=</span> find_files_recursively<span class="op">(</span>test_dir<span class="op">,</span> FindCondition<span class="op">::</span>FileNameHeadIs_f<span class="op">);</span></span>
<span id="cb131-26"><a href="#cb131-26" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> <span class="at">const</span> f_expect <span class="op">=</span> sort<span class="op">(</span><span class="bu">std::</span>vector<span class="op">{</span></span>
<span id="cb131-27"><a href="#cb131-27" aria-hidden="true" tabindex="-1"></a>            test_dir <span class="op">+</span> <span class="st">&quot;dir0/file2&quot;</span><span class="op">,</span></span>
<span id="cb131-28"><a href="#cb131-28" aria-hidden="true" tabindex="-1"></a>            test_dir <span class="op">+</span> <span class="st">&quot;dir1/dir2/file4&quot;</span><span class="op">,</span></span>
<span id="cb131-29"><a href="#cb131-29" aria-hidden="true" tabindex="-1"></a>            test_dir <span class="op">+</span> <span class="st">&quot;file0&quot;</span></span>
<span id="cb131-30"><a href="#cb131-30" aria-hidden="true" tabindex="-1"></a>        <span class="op">});</span></span>
<span id="cb131-31"><a href="#cb131-31" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span>f_expect<span class="op">,</span> f_actual<span class="op">);</span></span>
<span id="cb131-32"><a href="#cb131-32" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>この関数は、見つかったファイルが「引数で指定された属性」にマッチするかどうかを検査する。
検査は、「引数で指定された属性」に対するswitch文によって行われる。
これにより、この関数は「引数で指定された属性」の変更に強く影響を受ける。</p>
<p>下記は、この関数にStrategyパターンを適用したものである。</p>
<div class="sourceCode" id="cb132"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/find_files_strategy.h 7</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@typedef</span><span class="co"> </span><span class="do">find_condition</span></span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@brief</span><span class="co"> find_files_recursively仮引数conditionの型(関数オブジェクトの型)</span></span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> find_condition <span class="op">=</span> <span class="bu">std::</span>function<span class="op">&lt;</span><span class="dt">bool</span><span class="op">(</span><span class="bu">std::</span>filesystem<span class="bu">::</span>path<span class="op"> </span><span class="at">const</span><span class="op">&amp;)&gt;;</span></span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Strategyパターン</span></span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@fn</span><span class="co"> </span><span class="do">std::vector</span><span class="kw">&lt;std::string&gt;</span><span class="co"> </span><span class="do">find_files_recursively(std::string</span><span class="co"> </span><span class="do">const&amp;</span><span class="co"> </span><span class="do">path,</span></span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">///                                                     find_condition     condition);</span></span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@brief</span><span class="co"> 条件にマッチしたファイルをリカーシブに探索して返す</span></span>
<span id="cb132-11"><a href="#cb132-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@param</span><span class="co"> </span><span class="cv">path</span><span class="co">      リカーシブにディレクトリを辿るための起点となるパス</span></span>
<span id="cb132-12"><a href="#cb132-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@param</span><span class="co"> </span><span class="cv">condition</span><span class="co"> 探索するファイルの条件</span></span>
<span id="cb132-13"><a href="#cb132-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@return</span><span class="co"> 条件にマッチしたファイルをstd::vector</span><span class="kw">&lt;std::string&gt;</span><span class="co">で返す</span></span>
<span id="cb132-14"><a href="#cb132-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">extern</span> <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;</span> find_files_recursively<span class="op">(</span><span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span><span class="op">&amp;</span> path<span class="op">,</span></span>
<span id="cb132-15"><a href="#cb132-15" aria-hidden="true" tabindex="-1"></a>                                                           find_condition     condition<span class="op">);</span></span></code></pre></div>
<div class="sourceCode" id="cb133"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/find_files_strategy.cpp 6</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;</span> find_files_recursively<span class="op">(</span><span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span><span class="op">&amp;</span> path<span class="op">,</span> find_condition condition<span class="op">)</span></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">namespace</span> fs <span class="op">=</span> <span class="bu">std::</span>filesystem<span class="op">;</span></span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> files <span class="op">=</span> <span class="bu">std::</span>vector<span class="op">&lt;</span>fs<span class="op">::</span>path<span class="op">&gt;{};</span></span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a>        <span class="co">// recursive_directory_iteratorはファイルシステム依存するため、その依存を排除する他の処理</span></span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>copy<span class="op">(</span>fs<span class="op">::</span>recursive_directory_iterator<span class="op">{</span>path<span class="op">},</span> fs<span class="op">::</span>recursive_directory_iterator<span class="op">{},</span></span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a>                  <span class="bu">std::</span>back_inserter<span class="op">(</span>files<span class="op">));</span></span>
<span id="cb133-12"><a href="#cb133-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-13"><a href="#cb133-13" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>sort<span class="op">(</span>files<span class="op">.</span>begin<span class="op">(),</span> files<span class="op">.</span>end<span class="op">());</span></span>
<span id="cb133-14"><a href="#cb133-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-15"><a href="#cb133-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> ret <span class="op">=</span> <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;{};</span></span>
<span id="cb133-16"><a href="#cb133-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-17"><a href="#cb133-17" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>for_each<span class="op">(</span>files<span class="op">.</span>cbegin<span class="op">(),</span> files<span class="op">.</span>cend<span class="op">(),</span> <span class="op">[&amp;](</span>fs<span class="op">::</span>path <span class="at">const</span><span class="op">&amp;</span> p<span class="op">)</span> <span class="op">{</span></span>
<span id="cb133-18"><a href="#cb133-18" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>condition<span class="op">(</span>p<span class="op">))</span> <span class="op">{</span></span>
<span id="cb133-19"><a href="#cb133-19" aria-hidden="true" tabindex="-1"></a>                ret<span class="op">.</span>emplace_back<span class="op">(</span>p<span class="op">.</span>generic_string<span class="op">());</span></span>
<span id="cb133-20"><a href="#cb133-20" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb133-21"><a href="#cb133-21" aria-hidden="true" tabindex="-1"></a>        <span class="op">});</span></span>
<span id="cb133-22"><a href="#cb133-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-23"><a href="#cb133-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> ret<span class="op">;</span></span>
<span id="cb133-24"><a href="#cb133-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb134"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/find_files_ut.cpp 69</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>    TEST<span class="op">(</span>Strategy<span class="op">,</span> strategy_lamda<span class="op">)</span></span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">namespace</span> fs <span class="op">=</span> <span class="bu">std::</span>filesystem<span class="op">;</span></span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a>        assure_test_files_exist<span class="op">();</span>  <span class="co">// test用のファイルがあることの確認</span></span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-9"><a href="#cb134-9" aria-hidden="true" tabindex="-1"></a>        <span class="co">// ラムダ式で実装</span></span>
<span id="cb134-10"><a href="#cb134-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> <span class="at">const</span> files_actual <span class="op">=</span> find_files_recursively<span class="op">(</span></span>
<span id="cb134-11"><a href="#cb134-11" aria-hidden="true" tabindex="-1"></a>            test_dir<span class="op">,</span> <span class="op">[](</span>fs<span class="op">::</span>path <span class="at">const</span><span class="op">&amp;</span> p<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> fs<span class="op">::</span>is_regular_file<span class="op">(</span>p<span class="op">);</span> <span class="op">});</span></span>
<span id="cb134-12"><a href="#cb134-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-13"><a href="#cb134-13" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> <span class="at">const</span> files_expect <span class="op">=</span> sort<span class="op">(</span><span class="bu">std::</span>vector<span class="op">{</span></span>
<span id="cb134-14"><a href="#cb134-14" aria-hidden="true" tabindex="-1"></a>            test_dir <span class="op">+</span> <span class="st">&quot;dir0/file2&quot;</span><span class="op">,</span></span>
<span id="cb134-15"><a href="#cb134-15" aria-hidden="true" tabindex="-1"></a>            test_dir <span class="op">+</span> <span class="st">&quot;dir0/gile3&quot;</span><span class="op">,</span></span>
<span id="cb134-16"><a href="#cb134-16" aria-hidden="true" tabindex="-1"></a>            test_dir <span class="op">+</span> <span class="st">&quot;dir1/dir2/file4&quot;</span><span class="op">,</span></span>
<span id="cb134-17"><a href="#cb134-17" aria-hidden="true" tabindex="-1"></a>            test_dir <span class="op">+</span> <span class="st">&quot;file0&quot;</span><span class="op">,</span></span>
<span id="cb134-18"><a href="#cb134-18" aria-hidden="true" tabindex="-1"></a>            test_dir <span class="op">+</span> <span class="st">&quot;gile1&quot;</span></span>
<span id="cb134-19"><a href="#cb134-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">});</span></span>
<span id="cb134-20"><a href="#cb134-20" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span>files_expect<span class="op">,</span> files_actual<span class="op">);</span></span>
<span id="cb134-21"><a href="#cb134-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-22"><a href="#cb134-22" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> <span class="at">const</span> dirs_actual <span class="op">=</span> find_files_recursively<span class="op">(</span></span>
<span id="cb134-23"><a href="#cb134-23" aria-hidden="true" tabindex="-1"></a>            test_dir<span class="op">,</span> <span class="op">[](</span>fs<span class="op">::</span>path <span class="at">const</span><span class="op">&amp;</span> p<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> fs<span class="op">::</span>is_directory<span class="op">(</span>p<span class="op">);</span> <span class="op">});</span></span>
<span id="cb134-24"><a href="#cb134-24" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> <span class="at">const</span> dirs_expect <span class="op">=</span> sort<span class="op">(</span><span class="bu">std::</span>vector<span class="op">{</span></span>
<span id="cb134-25"><a href="#cb134-25" aria-hidden="true" tabindex="-1"></a>            test_dir <span class="op">+</span> <span class="st">&quot;dir0&quot;</span><span class="op">,</span></span>
<span id="cb134-26"><a href="#cb134-26" aria-hidden="true" tabindex="-1"></a>            test_dir <span class="op">+</span> <span class="st">&quot;dir1&quot;</span><span class="op">,</span></span>
<span id="cb134-27"><a href="#cb134-27" aria-hidden="true" tabindex="-1"></a>            test_dir <span class="op">+</span> <span class="st">&quot;dir1/dir2&quot;</span></span>
<span id="cb134-28"><a href="#cb134-28" aria-hidden="true" tabindex="-1"></a>        <span class="op">});</span></span>
<span id="cb134-29"><a href="#cb134-29" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span>dirs_expect<span class="op">,</span> dirs_actual<span class="op">);</span></span>
<span id="cb134-30"><a href="#cb134-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-31"><a href="#cb134-31" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> <span class="at">const</span> f_actual <span class="op">=</span> find_files_recursively<span class="op">(</span>test_dir<span class="op">,</span> <span class="op">[](</span>fs<span class="op">::</span>path <span class="at">const</span><span class="op">&amp;</span> p<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span></span>
<span id="cb134-32"><a href="#cb134-32" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> p<span class="op">.</span>filename<span class="op">().</span>generic_string<span class="op">()[</span><span class="dv">0</span><span class="op">]</span> <span class="op">==</span> <span class="ch">&#39;f&#39;</span><span class="op">;</span></span>
<span id="cb134-33"><a href="#cb134-33" aria-hidden="true" tabindex="-1"></a>        <span class="op">});</span></span>
<span id="cb134-34"><a href="#cb134-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-35"><a href="#cb134-35" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> <span class="at">const</span> f_expect <span class="op">=</span> sort<span class="op">(</span><span class="bu">std::</span>vector<span class="op">{</span></span>
<span id="cb134-36"><a href="#cb134-36" aria-hidden="true" tabindex="-1"></a>            test_dir <span class="op">+</span> <span class="st">&quot;dir0/file2&quot;</span><span class="op">,</span></span>
<span id="cb134-37"><a href="#cb134-37" aria-hidden="true" tabindex="-1"></a>            test_dir <span class="op">+</span> <span class="st">&quot;dir1/dir2/file4&quot;</span><span class="op">,</span></span>
<span id="cb134-38"><a href="#cb134-38" aria-hidden="true" tabindex="-1"></a>            test_dir <span class="op">+</span> <span class="st">&quot;file0&quot;</span></span>
<span id="cb134-39"><a href="#cb134-39" aria-hidden="true" tabindex="-1"></a>        <span class="op">});</span></span>
<span id="cb134-40"><a href="#cb134-40" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span>f_expect<span class="op">,</span> f_actual<span class="op">);</span></span>
<span id="cb134-41"><a href="#cb134-41" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb134-42"><a href="#cb134-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-43"><a href="#cb134-43" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@fn</span><span class="co"> </span><span class="do">bool</span><span class="co"> </span><span class="do">condition_func(std::filesystem::path</span><span class="co"> </span><span class="do">const&amp;</span><span class="co"> </span><span class="do">path)</span></span>
<span id="cb134-44"><a href="#cb134-44" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@brief</span><span class="co"> find_files_recursivelyの第2仮引数に渡すためのファイル属性を決める関数</span></span>
<span id="cb134-45"><a href="#cb134-45" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bool</span> condition_func<span class="op">(</span><span class="bu">std::</span>filesystem<span class="bu">::</span>path<span class="op"> </span><span class="at">const</span><span class="op">&amp;</span> path<span class="op">)</span></span>
<span id="cb134-46"><a href="#cb134-46" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb134-47"><a href="#cb134-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> path<span class="op">.</span>filename<span class="op">().</span>generic_string<span class="op">().</span>at<span class="op">(</span><span class="dv">0</span><span class="op">)</span> <span class="op">==</span> <span class="ch">&#39;f&#39;</span><span class="op">;</span></span>
<span id="cb134-48"><a href="#cb134-48" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb134-49"><a href="#cb134-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-50"><a href="#cb134-50" aria-hidden="true" tabindex="-1"></a>    TEST<span class="op">(</span>Strategy<span class="op">,</span> strategy_func_pointer<span class="op">)</span></span>
<span id="cb134-51"><a href="#cb134-51" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb134-52"><a href="#cb134-52" aria-hidden="true" tabindex="-1"></a>        assure_test_files_exist<span class="op">();</span>  <span class="co">// test用のファイルがあることの確認</span></span>
<span id="cb134-53"><a href="#cb134-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-54"><a href="#cb134-54" aria-hidden="true" tabindex="-1"></a>        <span class="co">// FindCondition::FileNameHeadIs_fで行ったことを関数ポインタで実装。</span></span>
<span id="cb134-55"><a href="#cb134-55" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> <span class="at">const</span> f_actual <span class="op">=</span> find_files_recursively<span class="op">(</span>test_dir<span class="op">,</span> condition_func<span class="op">);</span></span>
<span id="cb134-56"><a href="#cb134-56" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> <span class="at">const</span> f_expect <span class="op">=</span> sort<span class="op">(</span><span class="bu">std::</span>vector<span class="op">{</span></span>
<span id="cb134-57"><a href="#cb134-57" aria-hidden="true" tabindex="-1"></a>            test_dir <span class="op">+</span> <span class="st">&quot;dir0/file2&quot;</span><span class="op">,</span></span>
<span id="cb134-58"><a href="#cb134-58" aria-hidden="true" tabindex="-1"></a>            test_dir <span class="op">+</span> <span class="st">&quot;dir1/dir2/file4&quot;</span><span class="op">,</span></span>
<span id="cb134-59"><a href="#cb134-59" aria-hidden="true" tabindex="-1"></a>            test_dir <span class="op">+</span> <span class="st">&quot;file0&quot;</span></span>
<span id="cb134-60"><a href="#cb134-60" aria-hidden="true" tabindex="-1"></a>        <span class="op">});</span></span>
<span id="cb134-61"><a href="#cb134-61" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span>f_expect<span class="op">,</span> f_actual<span class="op">);</span></span>
<span id="cb134-62"><a href="#cb134-62" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb134-63"><a href="#cb134-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-64"><a href="#cb134-64" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@class</span><span class="co"> </span><span class="cv">ConditionFunctor</span></span>
<span id="cb134-65"><a href="#cb134-65" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@brief</span></span>
<span id="cb134-66"><a href="#cb134-66" aria-hidden="true" tabindex="-1"></a>    <span class="co">///  find_files_recursivelyの第2仮引数に渡すためのファイル属性を決める関数オブジェクトクラス。</span></span>
<span id="cb134-67"><a href="#cb134-67" aria-hidden="true" tabindex="-1"></a>    <span class="co">///  検索条件に状態が必要な場合、関数オブジェクトを使うとよい。</span></span>
<span id="cb134-68"><a href="#cb134-68" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> ConditionFunctor <span class="op">{</span></span>
<span id="cb134-69"><a href="#cb134-69" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb134-70"><a href="#cb134-70" aria-hidden="true" tabindex="-1"></a>        ConditionFunctor<span class="op">()</span>  <span class="op">=</span> <span class="cf">default</span><span class="op">;</span></span>
<span id="cb134-71"><a href="#cb134-71" aria-hidden="true" tabindex="-1"></a>        <span class="op">~</span>ConditionFunctor<span class="op">()</span> <span class="op">=</span> <span class="cf">default</span><span class="op">;</span></span>
<span id="cb134-72"><a href="#cb134-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-73"><a href="#cb134-73" aria-hidden="true" tabindex="-1"></a>        <span class="co">/// </span><span class="an">@fn</span><span class="co"> </span><span class="do">bool</span><span class="co"> </span><span class="do">operator()(std::filesystem::path</span><span class="co"> </span><span class="do">const&amp;</span><span class="co"> </span><span class="do">path)</span></span>
<span id="cb134-74"><a href="#cb134-74" aria-hidden="true" tabindex="-1"></a>        <span class="co">/// </span><span class="an">@brief</span><span class="co"> 先頭が&#39;f&#39;のファイルを最大2つまで探す</span></span>
<span id="cb134-75"><a href="#cb134-75" aria-hidden="true" tabindex="-1"></a>        <span class="dt">bool</span> <span class="kw">operator</span><span class="op">()(</span><span class="bu">std::</span>filesystem<span class="bu">::</span>path<span class="op"> </span><span class="at">const</span><span class="op">&amp;</span> path<span class="op">)</span></span>
<span id="cb134-76"><a href="#cb134-76" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb134-77"><a href="#cb134-77" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>path<span class="op">.</span>filename<span class="op">().</span>generic_string<span class="op">().</span>at<span class="op">(</span><span class="dv">0</span><span class="op">)</span> <span class="op">!=</span> <span class="ch">&#39;f&#39;</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb134-78"><a href="#cb134-78" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb134-79"><a href="#cb134-79" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb134-80"><a href="#cb134-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-81"><a href="#cb134-81" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="op">++</span><span class="va">count_</span> <span class="op">&lt;</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb134-82"><a href="#cb134-82" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb134-83"><a href="#cb134-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-84"><a href="#cb134-84" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb134-85"><a href="#cb134-85" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span> <span class="va">count_</span><span class="op">{</span><span class="dv">0</span><span class="op">};</span></span>
<span id="cb134-86"><a href="#cb134-86" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb134-87"><a href="#cb134-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-88"><a href="#cb134-88" aria-hidden="true" tabindex="-1"></a>    TEST<span class="op">(</span>Strategy<span class="op">,</span> strategy_func_obj<span class="op">)</span></span>
<span id="cb134-89"><a href="#cb134-89" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb134-90"><a href="#cb134-90" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 条件に状態が必要な場合(この例では最大2つまでを判断するのに状態が必要)、</span></span>
<span id="cb134-91"><a href="#cb134-91" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 関数ポインタより、ファンクタの方が便利。</span></span>
<span id="cb134-92"><a href="#cb134-92" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> <span class="at">const</span> f_actual <span class="op">=</span> find_files_recursively<span class="op">(</span>test_dir<span class="op">,</span> ConditionFunctor<span class="op">{});</span></span>
<span id="cb134-93"><a href="#cb134-93" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> <span class="at">const</span> f_expect <span class="op">=</span> sort<span class="op">(</span><span class="bu">std::</span>vector<span class="op">{</span></span>
<span id="cb134-94"><a href="#cb134-94" aria-hidden="true" tabindex="-1"></a>            test_dir <span class="op">+</span> <span class="st">&quot;dir0/file2&quot;</span><span class="op">,</span></span>
<span id="cb134-95"><a href="#cb134-95" aria-hidden="true" tabindex="-1"></a>            test_dir <span class="op">+</span> <span class="st">&quot;dir1/dir2/file4&quot;</span><span class="op">,</span></span>
<span id="cb134-96"><a href="#cb134-96" aria-hidden="true" tabindex="-1"></a>        <span class="op">});</span></span>
<span id="cb134-97"><a href="#cb134-97" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span>f_expect<span class="op">,</span> f_actual<span class="op">);</span></span>
<span id="cb134-98"><a href="#cb134-98" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>捜査対象のファイル属性の指定をfind_files_recursively()の外に出しため、
その属性の追加に対して「<a
href="#SS_1_2">オープン・クローズドの原則(OCP)</a>」に対応した構造となった。</p>
<p>なお、上記find_files_recursivelyの第2パラメータをテンプレートパラメータとすることで、</p>
<div class="sourceCode" id="cb135"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/find_files_strategy.h 23</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> F<span class="op">&gt;</span>  <span class="co">// Fはファンクタ</span></span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> find_files_recursively2<span class="op">(</span><span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span><span class="op">&amp;</span> path<span class="op">,</span> F condition<span class="op">)</span></span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>        <span class="op">-&gt;</span> <span class="bu">std::</span>enable_if_t<span class="op">&lt;</span><span class="bu">std::</span>is_invocable_r_v<span class="op">&lt;</span><span class="dt">bool</span><span class="op">,</span> F<span class="op">,</span> <span class="bu">std::</span>filesystem<span class="bu">::</span>path<span class="op"> </span><span class="at">const</span><span class="op">&amp;&gt;,</span></span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>                            <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;&gt;</span></span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">namespace</span> fs <span class="op">=</span> <span class="bu">std::</span>filesystem<span class="op">;</span></span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> files <span class="op">=</span> <span class="bu">std::</span>vector<span class="op">&lt;</span>fs<span class="op">::</span>path<span class="op">&gt;{};</span></span>
<span id="cb135-11"><a href="#cb135-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-12"><a href="#cb135-12" aria-hidden="true" tabindex="-1"></a>        <span class="co">// recursive_directory_iteratorはファイルシステム依存するため、その依存を排除する他の処理</span></span>
<span id="cb135-13"><a href="#cb135-13" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>copy<span class="op">(</span>fs<span class="op">::</span>recursive_directory_iterator<span class="op">{</span>path<span class="op">},</span> fs<span class="op">::</span>recursive_directory_iterator<span class="op">{},</span></span>
<span id="cb135-14"><a href="#cb135-14" aria-hidden="true" tabindex="-1"></a>                  <span class="bu">std::</span>back_inserter<span class="op">(</span>files<span class="op">));</span></span>
<span id="cb135-15"><a href="#cb135-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-16"><a href="#cb135-16" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>sort<span class="op">(</span>files<span class="op">.</span>begin<span class="op">(),</span> files<span class="op">.</span>end<span class="op">());</span></span>
<span id="cb135-17"><a href="#cb135-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-18"><a href="#cb135-18" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> ret <span class="op">=</span> <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;{};</span></span>
<span id="cb135-19"><a href="#cb135-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-20"><a href="#cb135-20" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>for_each<span class="op">(</span>files<span class="op">.</span>cbegin<span class="op">(),</span> files<span class="op">.</span>cend<span class="op">(),</span> <span class="op">[&amp;](</span>fs<span class="op">::</span>path <span class="at">const</span><span class="op">&amp;</span> p<span class="op">)</span> <span class="op">{</span></span>
<span id="cb135-21"><a href="#cb135-21" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>condition<span class="op">(</span>p<span class="op">))</span> <span class="op">{</span></span>
<span id="cb135-22"><a href="#cb135-22" aria-hidden="true" tabindex="-1"></a>                ret<span class="op">.</span>emplace_back<span class="op">(</span>p<span class="op">.</span>generic_string<span class="op">());</span></span>
<span id="cb135-23"><a href="#cb135-23" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb135-24"><a href="#cb135-24" aria-hidden="true" tabindex="-1"></a>        <span class="op">});</span></span>
<span id="cb135-25"><a href="#cb135-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-26"><a href="#cb135-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> ret<span class="op">;</span></span>
<span id="cb135-27"><a href="#cb135-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>のように書くこともできる。</p>
<p>次に示すのは、このパターンを使用して、プリプロセッサ命令を排除するリファクタリングの例である。</p>
<p>まずは、出荷仕分け向けのプリプロセッサ命令をロジックの内部に記述している問題のあるコードを示す。
このようなオールドスタイルなコードは様々な開発阻害要因になるため、避けるべきである。</p>
<div class="sourceCode" id="cb136"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/strategy_shipping_ut.cpp 11</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> X <span class="op">{</span></span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>        X<span class="op">()</span> <span class="op">=</span> <span class="cf">default</span><span class="op">;</span></span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span> DoSomething<span class="op">()</span></span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int32_t</span> ret<span class="op">{</span><span class="dv">0</span><span class="op">};</span></span>
<span id="cb136-10"><a href="#cb136-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-11"><a href="#cb136-11" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#if SHIPPING == SHIP_TO_JAPAN</span></span>
<span id="cb136-12"><a href="#cb136-12" aria-hidden="true" tabindex="-1"></a>            <span class="co">// 日本向けの何らかの処理</span></span>
<span id="cb136-13"><a href="#cb136-13" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#elif SHIPPING == SHIP_TO_US</span></span>
<span id="cb136-14"><a href="#cb136-14" aria-hidden="true" tabindex="-1"></a>            <span class="co">// US向けの何らかの処理</span></span>
<span id="cb136-15"><a href="#cb136-15" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#elif SHIPPING == SHIP_TO_JAPAN</span></span>
<span id="cb136-16"><a href="#cb136-16" aria-hidden="true" tabindex="-1"></a>            <span class="co">// EU向けの何らかの処理</span></span>
<span id="cb136-17"><a href="#cb136-17" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#else</span></span>
<span id="cb136-18"><a href="#cb136-18" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#error &quot;SHIPPING must be defined&quot;</span></span>
<span id="cb136-19"><a href="#cb136-19" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#endif</span></span>
<span id="cb136-20"><a href="#cb136-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> ret<span class="op">;</span></span>
<span id="cb136-21"><a href="#cb136-21" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb136-22"><a href="#cb136-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-23"><a href="#cb136-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb136-24"><a href="#cb136-24" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 何らかの宣言</span></span>
<span id="cb136-25"><a href="#cb136-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb137"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/strategy_shipping_ut.cpp 43</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>    X x<span class="op">;</span></span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>    x<span class="op">.</span>DoSomething<span class="op">();</span></span></code></pre></div>
<p>このコードは、Strategyを使用し以下のようにすることで、改善することができる。</p>
<div class="sourceCode" id="cb138"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/strategy_shipping_ut.cpp 56</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> ShippingOp <span class="op">{</span></span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">int32_t</span> DoSomething<span class="op">()</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="op">~</span>ShippingOp<span class="op">()</span>         <span class="op">=</span> <span class="cf">default</span><span class="op">;</span></span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-9"><a href="#cb138-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> X <span class="op">{</span></span>
<span id="cb138-10"><a href="#cb138-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb138-11"><a href="#cb138-11" aria-hidden="true" tabindex="-1"></a>        X<span class="op">()</span> <span class="op">=</span> <span class="cf">default</span><span class="op">;</span></span>
<span id="cb138-12"><a href="#cb138-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-13"><a href="#cb138-13" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span> DoSomething<span class="op">(</span>ShippingOp<span class="op">&amp;</span> shipping<span class="op">)</span></span>
<span id="cb138-14"><a href="#cb138-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb138-15"><a href="#cb138-15" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int32_t</span> ret <span class="op">=</span> shipping<span class="op">.</span>DoSomething<span class="op">();</span></span>
<span id="cb138-16"><a href="#cb138-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-17"><a href="#cb138-17" aria-hidden="true" tabindex="-1"></a>            <span class="co">// 何らかの処理</span></span>
<span id="cb138-18"><a href="#cb138-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-19"><a href="#cb138-19" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> ret<span class="op">;</span></span>
<span id="cb138-20"><a href="#cb138-20" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb138-21"><a href="#cb138-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-22"><a href="#cb138-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb138-23"><a href="#cb138-23" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 何らかの宣言</span></span>
<span id="cb138-24"><a href="#cb138-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb139"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/strategy_shipping_ut.cpp 81</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> ShippingOp_Japan <span class="op">:</span> <span class="kw">public</span> ShippingOp <span class="op">{</span></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>        ShippingOp_Japan<span class="op">();</span></span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span> DoSomething<span class="op">()</span> <span class="kw">override</span><span class="op">;</span></span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a>        <span class="op">~</span>ShippingOp_Japan<span class="op">()</span> <span class="kw">override</span><span class="op">;</span></span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-9"><a href="#cb139-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb139-10"><a href="#cb139-10" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 何らかの宣言</span></span>
<span id="cb139-11"><a href="#cb139-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb140"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/strategy_shipping_ut.cpp 100</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>    X                x<span class="op">;</span></span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>    ShippingOp_Japan sj<span class="op">;</span></span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>    x<span class="op">.</span>DoSomething<span class="op">(</span>sj<span class="op">);</span></span></code></pre></div>
<p>あるいは、<a href="#SS_2_11">DI(dependency
injection)</a>と組み合わせて、下記のような改善も有用である。</p>
<div class="sourceCode" id="cb141"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/strategy_shipping_ut.cpp 112</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> ShippingOp <span class="op">{</span></span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">int32_t</span> DoSomething<span class="op">()</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="op">~</span>ShippingOp<span class="op">()</span>         <span class="op">=</span> <span class="cf">default</span><span class="op">;</span></span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-9"><a href="#cb141-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> X <span class="op">{</span></span>
<span id="cb141-10"><a href="#cb141-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb141-11"><a href="#cb141-11" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> X<span class="op">(</span><span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>ShippingOp<span class="op">&gt;</span> shipping<span class="op">)</span> <span class="op">:</span> <span class="va">shipping_</span><span class="op">{</span><span class="bu">std::</span>move<span class="op">(</span>shipping<span class="op">)}</span> <span class="op">{}</span></span>
<span id="cb141-12"><a href="#cb141-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-13"><a href="#cb141-13" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span> DoSomething<span class="op">()</span></span>
<span id="cb141-14"><a href="#cb141-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb141-15"><a href="#cb141-15" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int32_t</span> ret <span class="op">=</span> <span class="va">shipping_</span><span class="op">-&gt;</span>DoSomething<span class="op">();</span></span>
<span id="cb141-16"><a href="#cb141-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-17"><a href="#cb141-17" aria-hidden="true" tabindex="-1"></a>            <span class="co">// 何らかの処理</span></span>
<span id="cb141-18"><a href="#cb141-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-19"><a href="#cb141-19" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> ret<span class="op">;</span></span>
<span id="cb141-20"><a href="#cb141-20" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb141-21"><a href="#cb141-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-22"><a href="#cb141-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb141-23"><a href="#cb141-23" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>ShippingOp<span class="op">&gt;</span> <span class="va">shipping_</span><span class="op">;</span></span>
<span id="cb141-24"><a href="#cb141-24" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 何らかの宣言</span></span>
<span id="cb141-25"><a href="#cb141-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb142"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/strategy_shipping_ut.cpp 138</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> ShippingOp_Japan <span class="op">:</span> <span class="kw">public</span> ShippingOp <span class="op">{</span></span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a>        ShippingOp_Japan<span class="op">();</span></span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span> DoSomething<span class="op">()</span> <span class="kw">override</span><span class="op">;</span></span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a>        <span class="op">~</span>ShippingOp_Japan<span class="op">()</span> <span class="kw">override</span><span class="op">;</span></span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-9"><a href="#cb142-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb142-10"><a href="#cb142-10" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 何らかの宣言</span></span>
<span id="cb142-11"><a href="#cb142-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb143"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/strategy_shipping_ut.cpp 157</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>    X x<span class="op">{</span><span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>ShippingOp<span class="op">&gt;(</span><span class="kw">new</span> ShippingOp_Japan<span class="op">)};</span></span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>    x<span class="op">.</span>DoSomething<span class="op">();</span></span></code></pre></div>
<h2 id="visitor">Visitor <a id="SS_2_20"></a></h2>
<p>このパターンは、クラス構造とそれに関連するアルゴリズムを分離するためのものである。</p>
<p>最初に 「クラス構造とそれに関連するアルゴリズムは分離できているが、
それ以前にオブジェクト指向の原則に反している」 例を示す。</p>
<div class="sourceCode" id="cb144"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/visitor.cpp 42</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@class</span><span class="co"> </span><span class="cv">FileEntity</span></span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@brief</span></span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">///  ファイルシステムの構成物(ファイル、ディレクトリ等)を表すクラスの基底クラス</span></span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> FileEntity <span class="op">{</span></span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb144-8"><a href="#cb144-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> FileEntity<span class="op">(</span><span class="bu">std::</span>string<span class="op"> </span>pathname<span class="op">)</span> <span class="op">:</span> <span class="va">pathname_</span><span class="op">{</span><span class="bu">std::</span>move<span class="op">(</span>pathname<span class="op">)}</span> <span class="op">{}</span></span>
<span id="cb144-9"><a href="#cb144-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="op">~</span>FileEntity<span class="op">()</span> <span class="op">{}</span></span>
<span id="cb144-10"><a href="#cb144-10" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span><span class="op">&amp;</span> Pathname<span class="op">()</span> <span class="at">const</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">pathname_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb144-11"><a href="#cb144-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-12"><a href="#cb144-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb144-13"><a href="#cb144-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-14"><a href="#cb144-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb144-15"><a href="#cb144-15" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span> <span class="va">pathname_</span><span class="op">;</span></span>
<span id="cb144-16"><a href="#cb144-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb144-17"><a href="#cb144-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-18"><a href="#cb144-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> File <span class="kw">final</span> <span class="op">:</span> <span class="kw">public</span> FileEntity <span class="op">{</span></span>
<span id="cb144-19"><a href="#cb144-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb144-20"><a href="#cb144-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb144-21"><a href="#cb144-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-22"><a href="#cb144-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Dir <span class="kw">final</span> <span class="op">:</span> <span class="kw">public</span> FileEntity <span class="op">{</span></span>
<span id="cb144-23"><a href="#cb144-23" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb144-24"><a href="#cb144-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb144-25"><a href="#cb144-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-26"><a href="#cb144-26" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> OtherEntity <span class="kw">final</span> <span class="op">:</span> <span class="kw">public</span> FileEntity <span class="op">{</span></span>
<span id="cb144-27"><a href="#cb144-27" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb144-28"><a href="#cb144-28" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb144-29"><a href="#cb144-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-30"><a href="#cb144-30" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Printer <span class="op">{</span></span>
<span id="cb144-31"><a href="#cb144-31" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb144-32"><a href="#cb144-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="dt">void</span> PrintPathname1<span class="op">(</span>FileEntity <span class="at">const</span><span class="op">&amp;</span> file_entity<span class="op">)</span></span>
<span id="cb144-33"><a href="#cb144-33" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb144-34"><a href="#cb144-34" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span><span class="kw">typeid</span><span class="op">(</span>File<span class="op">)</span> <span class="op">==</span> <span class="kw">typeid</span><span class="op">(</span>file_entity<span class="op">))</span> <span class="op">{</span></span>
<span id="cb144-35"><a href="#cb144-35" aria-hidden="true" tabindex="-1"></a>                <span class="bu">std::</span>cout<span class="op"> &lt;&lt;</span> file_entity<span class="op">.</span>Pathname<span class="op">();</span></span>
<span id="cb144-36"><a href="#cb144-36" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb144-37"><a href="#cb144-37" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span><span class="kw">typeid</span><span class="op">(</span>Dir<span class="op">)</span> <span class="op">==</span> <span class="kw">typeid</span><span class="op">(</span>file_entity<span class="op">))</span> <span class="op">{</span></span>
<span id="cb144-38"><a href="#cb144-38" aria-hidden="true" tabindex="-1"></a>                <span class="bu">std::</span>cout<span class="op"> &lt;&lt;</span> file_entity<span class="op">.</span>Pathname<span class="op">()</span> <span class="op">+</span> <span class="st">&quot;/&quot;</span><span class="op">;</span></span>
<span id="cb144-39"><a href="#cb144-39" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb144-40"><a href="#cb144-40" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span><span class="kw">typeid</span><span class="op">(</span>OtherEntity<span class="op">)</span> <span class="op">==</span> <span class="kw">typeid</span><span class="op">(</span>file_entity<span class="op">))</span> <span class="op">{</span></span>
<span id="cb144-41"><a href="#cb144-41" aria-hidden="true" tabindex="-1"></a>                <span class="bu">std::</span>cout<span class="op"> &lt;&lt;</span> file_entity<span class="op">.</span>Pathname<span class="op">()</span> <span class="op">+</span> <span class="st">&quot;(o1)&quot;</span><span class="op">;</span></span>
<span id="cb144-42"><a href="#cb144-42" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb144-43"><a href="#cb144-43" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb144-44"><a href="#cb144-44" aria-hidden="true" tabindex="-1"></a>                <span class="ot">assert</span><span class="op">(</span><span class="kw">false</span><span class="op">);</span></span>
<span id="cb144-45"><a href="#cb144-45" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb144-46"><a href="#cb144-46" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb144-47"><a href="#cb144-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-48"><a href="#cb144-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="dt">void</span> PrintPathname2<span class="op">(</span>FileEntity <span class="at">const</span><span class="op">&amp;</span> file_entity<span class="op">)</span></span>
<span id="cb144-49"><a href="#cb144-49" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb144-50"><a href="#cb144-50" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span><span class="kw">typeid</span><span class="op">(</span>File<span class="op">)</span> <span class="op">==</span> <span class="kw">typeid</span><span class="op">(</span>file_entity<span class="op">))</span> <span class="op">{</span></span>
<span id="cb144-51"><a href="#cb144-51" aria-hidden="true" tabindex="-1"></a>                <span class="bu">std::</span>cout<span class="op"> &lt;&lt;</span> file_entity<span class="op">.</span>Pathname<span class="op">();</span></span>
<span id="cb144-52"><a href="#cb144-52" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb144-53"><a href="#cb144-53" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span><span class="kw">typeid</span><span class="op">(</span>Dir<span class="op">)</span> <span class="op">==</span> <span class="kw">typeid</span><span class="op">(</span>file_entity<span class="op">))</span> <span class="op">{</span></span>
<span id="cb144-54"><a href="#cb144-54" aria-hidden="true" tabindex="-1"></a>                <span class="bu">std::</span>cout<span class="op"> &lt;&lt;</span> find_files<span class="op">(</span>file_entity<span class="op">.</span>Pathname<span class="op">());</span></span>
<span id="cb144-55"><a href="#cb144-55" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb144-56"><a href="#cb144-56" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span><span class="kw">typeid</span><span class="op">(</span>OtherEntity<span class="op">)</span> <span class="op">==</span> <span class="kw">typeid</span><span class="op">(</span>file_entity<span class="op">))</span> <span class="op">{</span></span>
<span id="cb144-57"><a href="#cb144-57" aria-hidden="true" tabindex="-1"></a>                <span class="bu">std::</span>cout<span class="op"> &lt;&lt;</span> file_entity<span class="op">.</span>Pathname<span class="op">()</span> <span class="op">+</span> <span class="st">&quot;(o2)&quot;</span><span class="op">;</span></span>
<span id="cb144-58"><a href="#cb144-58" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb144-59"><a href="#cb144-59" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb144-60"><a href="#cb144-60" aria-hidden="true" tabindex="-1"></a>                <span class="ot">assert</span><span class="op">(</span><span class="kw">false</span><span class="op">);</span></span>
<span id="cb144-61"><a href="#cb144-61" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb144-62"><a href="#cb144-62" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb144-63"><a href="#cb144-63" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>下記クラス図からもわかる通り、ポリモーフィズムに反したこのような構造は複雑な依存関係を作り出す。
このアンチパターンにより同型の条件文が2度出てきてしまうため、
Printerのアルゴリズム関数が増えれば、この繰り返しはそれに比例して増える。
またFileEntityの派生が増えれば、それら条件文はすべて影響を受ける。
このようなソースコードは、このようにして等比級数的に複雑化する。</p>
<p>
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAATcAAACpCAIAAADBW+3iAAAAKnRFWHRjb3B5bGVmdABHZW5lcmF0ZWQgYnkgaHR0cHM6Ly9wbGFudHVtbC5jb212zsofAAABD2lUWHRwbGFudHVtbAABAAAAeJxtj0FLw0AQhe/7K+aYHFK0RJEepGhTpSQYTNP7NlnjYjIbdmcjBX+8uxphK73Ne/M95s3aENdkh541PTcGtrIXGZKkU2DM40bqeXqhd6FnjHkCILFj8nUf5h0Ol/wgfGHLSi2RhIbkzP7nhtrXCmTYbS2w9b+xsudIdZHDJLSRCuF6sbxapov0KIjfRDV+oPpEaNQw+m9IDiJm0VOZg1FWNwJaaUjLoyUXjtmOTxxeLXpuBV5F+yKGKvszIcNJaoWDQGK7Q/ELwbOialT0A9+myYMkqIR2neBQsI1447YnF21UK7FbQb3fJncs59hZ3rlDAtmjcgf0ye0q9g12QZU/r/AJ6wAAKJZJREFUeF7tnQtUFdXCxy0fN1vfbd3y9oVvU1SOICAIXB4qoIjXMHv4Qiv1RvmhpCgIgo98K4oppvLwhYUpCCIoYPnArOXVFBUVn6EliKYInOxaluX378x11nbPcJgz58wwB/ZvzTprzt57Xv+9/7Mf82ryiMFgaJsmdACDwdAYzKUMhtZhLmUwtA5zKYOhdZhLGQytw1zKYGgdtV1aWFi4cOHCRY2DxYsXx8fH6/V6WgXFqK6uXrZsGbZL7wpDwOHDh2n5tIqqLs3KysrIyNA3JsrKyj766CNaCMVYvnw5tkjvBEOMzMzM9PR0WkFNoqpLly5dSkvVCMBR00IoBqoIevOM2lmyZAmtoCZhLlUc5lLNgv4IraAmYS5VHOZSzcJcKoJxl9bU1OQU5IZOnejl661z0NnY2OAX8whBOGLpBawE7bi0sqoyfXdGyJT3Pft52f1X4R4+fj4fREz+fN/n1quwbJhLRTDi0qzcnf/o84/eXm4h0RNWZCRsPLAlqzgXv5hHCMIRizT0YtaAFlxaVVO9OXOLm497rQp7u3n39cnLz6OXbNAwl4og6tKqqqpJU8McXR1nr5uHclPbhFikQUqkp1ehberdpRW3b44NG99TgsJOrs4R0yOtTmHZMJeKIHQpCsTQYa/1HzJg67/TheWGmpAGKZHeuopR/boUFg18bZB0hQNeHThi1EjrUlg2zKUiCF2KHhEK0I5Tu4QlRnRCSqTHUtR6tEw9uhQNXdSipiocOHRQVFQUuZ6GCnOpCJRL9+TlObo6pR2p+xxPTkiPpbAsuSpTycvLa9KkydWrV+kIBahHl6IvioauDIVd3VwLCgrIVdUGqaSaqnKYuUXmUhFIl9bU1Pj08xH2lDJP5YR+GNZZ16Vps6bNWzTv0sPWwa1nD1d7Mg2WwrLUmCSXYRx/+9vfhg0bVlpaSiYguXPnzuXLl+sc1eTWef36dTrCFOrLpZVVle4+HpTCUuTFNDdxgZ+/H6kPKS9HaGio/kklJXpGuCpw/PhxOt2TiOaFcOsmZRZzqQikS/fv3+/m7U4VjszTOb5D/KE1CpDOxd7OWYfChL/P/s+zVEosizUQgv83k44dO4ZsQ5ROpwsICCAT8Ny9e5cOqgUZGU/Cbai+XJq+O6O3t5s8eTH59PUhFSbl5bhx4wYfS6aR6FJyVaDOnnCdeVFnAiHMpSKQLo2IjnwvegJVMiKWR0Pojl07pnyxiQtJ3rvxhf9tJSxGWBZrIASni8iWLVuaNm1aWVnJR2VmZrq4uDRv3jw9PZ1MzM1nZ2c7OTm1aNGiV69eJ06c4FbS5Ekeb0ofFxdna2uLVbVp0wZdOL6ECTekrz+Xhkx5n1JYuryYwmdPi4mJ4ddWmwOFSvJpjKskXBUfJT0vyFUJE8TGxuJk/Xjdf+Lh4TFhwgT+L3OpCKRL+/n7rkhPoEqGa5/e0HfRljgy8N0Z7wcO/yeVEstiDfza9IK837Zt21NPPXX79m0+qmfPnpg5d+4c0gjLFvIPVQfaXW5ubj4+PtxK0tLSEFVUVMSd77nAGTNmdO3aFVa8cOFCTk5Ohw4dIiIiuCjhhvT151LPfp6UwtLlxbQ2K2nAgAH82mqzllBJbr5OlYSr4qOk5wW5KmECbBpn6oMHD3KJYXgkOHLkCPdXz1wqCulS+54OGw9+QpWMdp3bQ8eMomxhoaEmLIs18GvTP5lh+EXuIo/JqO3bt4sm5ub37NnDRaWmpjZr1oxrrHJRZCPq1q1bLVu23LdvHx+ycePG559/npsXbkhffy61s7ejFJYuL6bUwq2o0Pi1cYf2LEFJSQkfTrlUikrkqlDZklES84IPJLdOJQgMDBw/fjw3Hx4ejsqZjGUuFYF0afv27YXFpU2nthA681SOsNBQE5bFGgjBn8h71KLID5xWyaiLFy9Sicnc/fbbb8ko7vkvYcYXFhZSJeyZZ55BSEVFBZ+e3JC+/lzarn07SmHp8v45ncxFBcivjTs0HP6px5DmoVwqRSVyVWfOnCG3IjEv+EAjLv3ss8+ee+45nDXQ3raxsVm5ciUZy1wqAulSB7G6VOdiD6ETstfSJUYwYVkHsboUeX/69Olr164Jo8gmljB3+Vgys4UZf+DAAYTs3buXL2Ec1dXVwlVx1JdLdQ46SmHp8mLadniHsC4VNlNFlZShEodJeUGlF02AUwnMmZKSggYOqvfy8nIylrlUBNKl/v39hf3S92eGQuhujt3X70/lQjJP5/zfnEkv23VO/XIrmRLLYg2E4HQGG48S5q5oySgoKMD8d999xy+I2gDVwoYNG/gQEuGG9PXnUm9fb0ph6fJi2pSbKrtfKkMl0SjjeUGlF00Apk2b1qdPn6CgoODgYCqKuVQE0qUxMTGhMWFUydhxapdngDe0btqsKQqTs5dL6w5t8LfVS39PO7KdTIllyRFIvSCDjUeJli0yiisZ6Hphft26daWlpXwCbBddrOTk5HPnzqF+2Lx5c2xsrHC1PJZy6ZUrV5KSklA50BEEpEs/iJhMjfFKlxdT7PyZ5ozx1qkSdSXmzp071Br4v0bygkwvmgAUFxc//fTT6N/m5+fzgRzMpSJQ10u9+nhTJSPLcNk9bP4UO2fdX575C7qXf2/9YuCIf3IPcJATlhW9XiosRqJRtZUt/i/fcJo9ezaaTMjmJsSVmISEBHt7+xYtWqDH5erqunr1anJZhVwKjhw5otPphg8f/umnn9JxBkiXfr7vc5Er0tLkzTmb7+vrK7xeKpTXiJLGVaLIysoSrqHOvKDSCxNwoC7t0qULGcLBXCoC6dKamho/f/95SQup8iFlwlJYts47hzSCBV36yGDUzp07oyyi2M2ZM+fBgwdkLOnS2u7ukjKt25Lobz0K10nXrl3nzZtHhzKXikK6VG/oSPR27y3jLlMsJfEuUy1gWZc+Mhi1W7dunp6e8Gq7du3Gjh2LfiAXRd3Hm5ef5+TqbKrCOcfzPDw8rEhhI6D1u2LFipYtW/LjxiTMpSJQLgXR0dFBrw8x6YkNpMdS1Hq0jMVd+shgVAcHh7feesvGQOvWrQcOHIienvDJtYjpkQGvDpSucO6Z/GHDh1mXwkZA07dVq1aJiYl0hAHmUhGELq2qqgoODn71jaFb/50hLDHUhDRIifR13vOpKTgjKUGnTp24mfbt27dt29bW1jYsLIzaOrQaMWpk4NBBUp4vzT3xp0WtTmHZMJeKIHSp3lCMcOZ2c3eLWx8vLDf8hFikQUqrK0BK1KVff/01Z1Gu6Yt69aOPPrp7966wLtUbFI6KinJ1c52buEAoLDflnM1HXxQNXWtUWDbMpSKIupQDvSA/P7++/fpOnxOVlL3h00PbUHTwi3mEIByxVtpTsrhLYdEOHTrAn7169fL19d22bRs/hiTqUg5OYe++PlNmTV27Myn1YNquM3mfHU7fnLsldt5MrMd6FZYNc6kIRlyqN4xJ7t+/PyYmJiAgwMnJCRUFfjGPEIRb73ijZV0Ki3bs2BHijBkz5tChQ1SsEZfqG67CsmEuFcG4SxsqFnQpd700MjLy8uXLdJwB4y5lUDCXisBcag6m3nvEqBPmUhGYS5WGudQkmEtFYC5VGuZSk2AuFQHldfPmzYsaE6mpqSq7tLEpLBtkDXOpCKwuVZpFrC41BeZSEZhLlYa51CSYS0VgLlUa5lKTYC4VgblUaZhLTYK5VATmUqVhLjUJ5lIRmEuVhrnUJJhLRWAuVRrmUpNgLhWBXS9VmkXseqlk2PVScVhdqjSLWF1qCsylIjCXKg1zqUkwl4rAXKo0zKUmwVwqAnOp0jCXmgRzqQjMpUrDXGoSy5cvpxXUJKq6NCkpif/yZCOhpqYmLi6OFkIx4NJG+GIUeZSWlqakpNAKahJVXfrgwYPo6GjljMp9U1gGshesjR9++AG/P/74Y3Z29ldffUULoRiHDx/OzMyk90YAjvfs2bN0qDRKSkqKi4vpUFncvHmT+/CE+sCiMTEx1JcBNIuqLgW//vprcnJyvAIsXLjQ1tYWFRcdURfch+Xnz59PR8gFTdxu3bqNGDECu5Senk5LoDAo9/QOGZgzZ05ISMgrr7zi7OzcsWPH6dOn0ynqYtmyZTioTp06ocam42SBBmeHDh1k7In5oBCiKNLaaRW1Xaoc0D0sLIwOlUZUVJRl26Xff//96NGj/f39T5w4QcepxS+//PLNN98kJiaOHz/eyQBmZs+e3a5du4KCAjp1XeBAcDg6nW7s2LF0nBl07doVZ40bN27QEQyChuNSHx8fFEo6VBpXr151cHC4f/8+HWEeu3btQhHkvuZAxylDWVkZNgorDho0qHPnzvjFPEIQjth79+7BaTid0YsZRW/4UAgOJCcnBxZFi5pOYQa9evVCJY+9wr7RcYzHNBCXHjlyxNfXlw41BbQGN2zYQIeaDYo4KmquiNNxlkC0wsRfBCKKTPnw4cPg4OAZM2aQgXWC3eZPNOhmoyWPXzqRGfTr1+/SpUvYK+wb9pCOZhhoIC4NDQ3duHEjHWoKJ0+edHd3/+233+gIS3D8+HE/P78xY8Zcv36djjODu3fvwjZ9+/YlK8zaMNUJwkY7alHLNndBUFAQxJF3Bmk8NASXVlZWdu/e3fxW5euvv56dnU2HWgj4/+OPP+7Ro8fatWsteC5YtWoVKk86VABaudJbldi9NWvWYFfxS+6qxZu7YNSoUYWFhY/ktsYbCQ3BpSj34eHhdKjp7Nu3LyAggA61KKigUGn079+/qKiIjpPFgwcPvLy8Dh48SEcQFBQUoPsncYSGGyVCLYpdJcOVaO6C9957Lzc3l5vHHmI/ZYxsNXis3qV//PEHiqlFCj1WhW7S4cOH6QhLgxobnT008Myv/wEsCgVqu/RXXFxsb2+PXzpCADlKRMcp09wF06ZN27p1K/9X+t42KqzepTAVqiY6VC7bt29HG4wOVQB+VAn9STrOdNDojRe7JVV67USOEtFxBpRo7oI5c+ZQrVyTav5GgtW7FE2mLVu20KFy+fXXX1FEzp07R0coA9e8RBv4u+++o+Mkg67jokWL2rRpc+XKFTJcYk9POEokRKHmLuDuMaACTepFNwas26W3b9+2s7OzbHailztp0iQ6VDHgMWyxR48eCQkJMu6GQVOf8/ncuXPJYSSJo6a3bt1CC3PMmDHGB7QUau4+MhgS1SkdavqIdMPGul2Kkh0REUGHmgdqDHimvLycjlCSsrKyt99+G71i6TdmoGmKosy3malhJOmlvKSkxMPDY8GCBUYSK9TcBeiUomtKh0o+yzQSrNilv//+u7u7uxIjDSiys2fPpkOVZ8+ePWhv47xTU1NDxz3J7t27kXL69OlkN5IfRjK1xVhdXT3SAGboOCWbuyA3Nxd9FjrUgMQWe2PAil2KQhkYGEiHWoKbN2+iIV2nVZQAZpg5c6aTk1NtdRdX6/r6+orWumj0IlbG6AvqLpybUKmePHmSilKuuQsKCwuNDNdJH/1q2FixS8eNG0cO4luW8PDwlStX0qFqcfr06YCAgOHDh5eWlvKB6DomJiYa78HCw+ZcycD627Ztm5GRQQYq19x9ZLgrKygoiA41gGPcu3fvkCFDcMa8ffs2Hd2YsFaX4iyr0+ksfn88z5UrVxwdHX/++Wc6Qi1QuaWkpMCT8fHxKK+nTp0aMGAAGqV1jgbLLtAQEx1jnJvIbqqizV1w6dIlbJQKPHr0aGxsLI79tddeS0tLq+3iUOPBWl26dOlSpbuOqKs3bdpEh6pLRUXFO++8A5/glJSVlUVHW5SpU6dOnjz50ZPdVEWbu48MB4g2LTePhgDOEZ6enqjPlyxZYvy25EaFVboUdQt6btTlQYtTVFSk3P33EsnLy0MhRs/NxcUlLCyssrKSTmEhduzY0bdv3//85z/cX76bOnjwYOWau48MdXWXLl1QYaLaROWJKhSyT5o0af369XTSRoxVujQnJ+fNN9+kQxXgjTfeULoGq43y8nJUYnDOsWPH8Bf+mT9/voODAwr0H3/8Qac2D5zvsOaLFy9S4bt27UKfULnm7iPDQH2nTp3ee+89dEH5zrb5zyE2MKzSpTAPf4u2ohw8eNCCtx9KBPVYUlISKpZVq1ZRo0QlJSVBQUFDhgy5cOECGW4O6HvDEtu2baMjDMju5UpH9IqRt7f38ePH6dDGivW59PLly87OzrUNclocuPTAgQN0qGJwo7sjRoy4du0aHWcAFeknn3xib2+/cOFCiwyeoTv6wQcf0KH1TWJiokWec2oYWJ9LZ86cuWzZMjpUMXbu3Imqmw5VAFQps2bNQn9bShsbVdzEiRPd3Nz27dtHx5lCRkZGnz59+O6odrDUM8MNAytzKcqTTqerqKigIxTjt99+c3d3N3InukXIz893cXGRctcRyZdffunp6RkSEnLz5k06TgKXLl1CnSzsjmqECRMmpKam0qGNEitzaVpa2rhx4+hQhdm8ebNyG6VGiUzlwYMHaFmgE7t+/XojN+IKwfkOG1X/RaTSwTlowIABdGijxMpcij7boUOH6FCF+fnnnx0dHS1+4QemSk5OFh0lMpXS0lI0ywcOHCj9riP0RTXe8UMP3MPDAx11OqLxYU0uLSoqQgPP4tchpLBy5UrLlmnuXqIRI0ZcvXqVjpMLOpk4m6BzW+e1k61bt/r6+tbjnVUSSUhIiIyMpEMbH9bk0smTJycmJtKhqoDuIvrD8rp/FPz99FJGiUyluroandtevXrt3r2bjnvM+fPn0R21eNNACX744Qc7O7uffvqJjmhkWI1Lq6qqunfvLvpolTrMnTv3ww8/pENNhLuXyNRRIlP55ptvUFWKvlj03r17Xl5eSpwgFGL8+PHKPVNhLViNS1GLcneZ1heoSFGdynZXeXn5O++8I3uUyFTQ0eVeLIpfstM7YcKEqKgoIqHWOXDgwODBg+nQRoZ1uBR9UfRILfKiQHOQ9zgb/8SZ+aNEpoK6FDUq/zDqpk2bAgICanvboDb5/fffXV1dS0pK6IjGhHW49NChQ0q/KVcKMh5nO3nyZP/+/UeOHFnbvUQqwL3YAU1HdEfrfPBNg8THx8fGxtKhjQnrcOm4cePS0tLo0PpA+uNsP/74I8qWQqNEpoL2dteuXdGxp57wtgpu3LiBlohJJ8cGhhW4tKKiAh1CjdzFJvFxNq76ioyMlN2PtSDoL4wdO3bOnDnFxcUDBw584403yFdAWAVot+/YsYMObTRYgUvj4uJmzZpFh9Yfxh9nKysre+utt2p7L1G9sGbNmiFDhnBd4ocPH65fvx5V07Jly6yog1pQUDB06FA6tNGgdZeibDk7O1++fJmOqD9qe5yNf7Pu6tWrVR4lMsLRo0fRl6bufL5582ZISIinp+eXX35JhmsWaItiYBXXeJVA6y7Nzc1V55EUkxA+zoaWMAJHjRqlqeGZO3fuoOHNfdRMyL59+9zc3CZOnKjCQ6Tms2TJkrlz59KhjQOtu/TNN98U/bhQ/UI+zsa/vVq5ryrK4/fffx8+fDj6C3QEwf379xcuXGhvb//JJ5/Uy62X0sHpz8HBQTuNFDXRtEvRwnFyctJgxvCPs3EfQYqKitLgk5DwJ1wKr9IRAi5cuICOa1BQkMYvS44YMcIiH7+yOjTt0tmzZy9dupQO1QYrVqzAqd3f31+bL/5AKxdtXbR46YhaQEWalpaGI5o/f75GhtOF4JwIo9KhjQDtuhSNMZ1OZ+o72lWA/6q3ra2tNh+hrqiocHR0PHr0KB1RF5WVlWFhYb179/7iiy/oOA2AVhXOI5rq+auDdl26detW5Z69lg1qTj8/v9GjR1+/fn3VqlWWfZzNIqAoo/m6Zs0aOkIyX3/9tZeX17/+9S8134khkblz5y5evJgObeho16WBgYHGP0SvMvx3gfnRrJqaGjs7O4s8zmZB5syZM3bsWDOHgmD1+Ph4tBdSUlJMegWE0ly5cgVZUOddJQ0Mjbq0uLjY3d1dysiHOmRnZ6NwzJgxgxolQs95wYIFZEj9kp+fD90sdcNTaWnp8OHDAwICNPXChKFDhza27ztp1KUREREJCQl0aH2AXtCoUaP69+8v+kROeXk5Kpw6342gDty1Cos7KjMz08nJaebMmRo5zB07dowZM4YObdBo0aX37t3Twme20OpbvXo1TLhu3TojTaxJkyatXbuWDlWdBw8eoNKT+CSAqaBy5l4BsWfPHjpOdX7++WdkigaHFZVDiy7dsmVLbV+eVQ3udQdvvfVWnd8UOnfuHIpvvV/URZ95woQJdKhFgSb9+vV7++2369REaWJjY9FtpkMbLppwKdWUQvPy8OHDZIiaoOcZGRlp/NVBFGgSb9++nQxRuXGYlZXl5eUl+ikHy4KTEXoiqMrQfDDSvlCakpISV1dX7QxbKI0mXEp+1QvdPxQ4M4coZYPijj4YTtUm2QznFFQy5D4r+p0yiitXrtjb258/f56OUAx0gIODg/39/ZV+mbgRBg8erOaXQeoXTbh0LPGFzPDw8Hrp5l27dm3kyJGoxoWfrJcC+oTkxyDII1IU7ltM9fL+rl27djk7O0dHR9fL3ZE45PHjx9OhDRRNuLRjx45c3YX87t69u3Jf6RQFrbhVq1ahFZeYmCi7FZednf36669z8zgWHNET0YqBk1o9fotJypMGly9flq2qEX766Sc7O7tbt27REQ0RTbjUxsaGayJu3LgxNDSUjDp69Kiitw0cO3asb9++77zzTnl5OR1nCg8fPnR3d+fqYRwLjohOoQDp6enkp4HrC+6pPbSBv//+ezrOcCu/OTdCGSEyMlIjl+uURisuRR5jBo23I0eOcIFlZWWTJk3i/1oc/upCXl4eHScBYc95w4YNISEhjwzNXRVcevHiRXRHL126REfUB/wT8B9//DFVc6Kp0q1bN1EDm8np06c9PDyEGdHw0IpL0UQ8dOiQj4/Po8dNUBRB5SzKjRKZeaX+4MGDcCb/Iu/79+87ODicPXvW1tZWaZei/uzTp4/WXjXGvVjUz8+Pek4ITeLRo0eTIZZiwIAB1vK6CXPQiks7deo0ZMiQ5ORkFH0XF5d27doZ6eqYAzdKhNw9deoUHWc6BQUF6B298sor3N7GxcUNGzbM29tbaZeiLzp16lQ6VBsIn7lFE6l169ZKPM2fmpqq9FViLaAVl4K2bduie4MZ5OjOnTvpRGbDX+szZ5RISHFxcc+ePbHbL7/88rhx49AowCYUdem2bds0/i0m+DM6Ohpe5R7anjx5cocOHRwdHS0+Glwvw43qoyGXcrRp00aJWlTR+2Zu3LgB23ANXZxiuAOhE1kIdEfRrraK93SdOHHC398fbd2kpCRkK/qQsC6dyGzCw8Pr6xtfqqEtl6I6zc3NpaPNg7+XSNF7UO/duzdq1ChshT8WOoUl4D4NbEVvpkWbZc2aNU5OTmhiQBP0Dix+IwT6wOhi0KENCw25FBaVflOeRNByRrsrJibGnFEiiTx8+BB1Bdf6VcilaDpqtjtKgs7F+fPnccKF8oMGDerWrRunSZcuXXCWsWB3g4O8NNAg0YpLYVF5V0Rqg3/iTN69RLJJTk5GT0kJl6anp6PRfv/+fTpCMxQVFaHnP3LkSOQmZ0sbogvAAXEsfvl0/fr1kyZNokMbEJpwaadOnfLz8+lQuUh84kw5CgoKLH7vEczp5uamkaujUqioqDh9+vQXX3yRlpY2a9as4OBgnGLQo+5owLKXT6urq9Go/uWXX+iIhoK4S3HYy5YtW7x48SJVmDhxIh0kDeGjM9x7iUQ/sGsmJmkyZcoUOshs5s2bRwc9RqiDohQWFi5cuJDeCVOYO3cuHWQe8+fPp4OsEJSu+Ph44Ui4uEuXL19eVlam1zyZmZloB3L7rH/8XiKLjz9xaFkTUgelycrKysjIoPeAYSFQxj766CNKc3GXwtb00lplyZIljx4/nyF8L5EF0bgmnA4qsHTpUnrbDIsifAe11bt09uzZo0ePVuFZR41rotq7C5hLlaahufSHH37o1q3bmjVrVBgl0rgmzKUNBsu4tLKqMn13RsiU9z37edk56GxsbHQOPXz8fD6ImPz5vs9ramroBZREeEgKoXFNNOJSHGlOQW7o1Ilevt66/+qgwzxCEK6CDg0AYZE2zaVVNdWbM7e4+bj39nILiZ6wIiNh44EtWcW5+MU8Qnp7u3n39cnLz6OXVAzVSqfGNVFNByMuzcrd+Y8+/6hVBy83xCINvRjjScxyacXtm2PDxvd0dZy9bh7Ur21CrJOrc8T0yKqqKnoVCqBa6dS4JqrpIOpSHNekqWGOEnRAGqRUTocGgHyXojgGvjao/5ABW/+dLlSfmpAm4NWBI0aNVCEzVCudGtdENR2ELsURDR32mnQdkBLpFdKhASDTpWjUocaAuDtO7RLqLjohZeDQQdxDhoqiWunUuCaq6SB0KfrepuqA9FiKWg+DQ6ZL0e9Coy7tSN1nSnJCelc314KCAnJVtZGXl9ekSZOrV69S83WiWulUXxMeKYKopgPl0j15eY6uTjJ0wFJYllyVbKToozLm7JIcl1ZWVbr7eFD9jcxTOaEfhnXWdWnarGnzFs279LB1cOvZw9Weyoy5iQv8/P3IkT1u70lCQ0MRfufOncuXL3MpTTpC1UqnCpo89dRTzz33nIuLy8yZM2/cuMEnIMWpDdV0IF2KXfLp5yPsi0qRAkthWeFBnTt3bvTo0S+99FLz5s07duw4ZcqU8vJyPpbT6vr168QSphUYIwgLJzh+/Did7klEd0lYnqkERpDj0vTdGb293Z7Ig9M5vkP8sWFkgM7F3s5Zh8zA32f/51kqtzD59PXZv38/vzZuj48dO3b5MWRxJNNIFF210qmOJkVFRZs2bXJ0dOzcuXNpaSmfpjbu3r3LzaimA+lSHIWbtzt1dNKlwLKkDuDkyZOtWrUaPHjwvn37SkpKuAcPHRwcbt68ySUQLfEmFZjagJLCwgnq7D+L7hJJnQko5Lg0ZMr770VPIMWNWB6NrXbs2jHli01cSPLejS/8bythNmAKnz0tJiaGX1ttgpLhVJq4uDhbW1ucWdu0aYNOHaWaaqVTTU1u3brVtWvXd999V5iAm8/MzESVC03S09O5NKrpQLo0IjqS0sEkKbAs1sCvDfj7+/v6+pIVbEVFRYcOHaZOncr9bfIkXCCnSXZ2tpOTU4sWLXr16nXixAl+DbWVH6GSwozgMbKJJ/foiV3iViVMEBsbq9PpHq/7Tzw8PCZMmMDNy3GpZz/PFekJpLiufXpjY4u2xJGB7854P3D4P6lswLQ2K2nAgAH82moTQlgQufkZM2agvELKCxcu5OTkIMMiIiLIBVUrnSprsmTJEhsbG2ECbr5nz56YQeOQX0o1HUiX9vP3pXQwSQosizXwa7t27Rra/MhrPoRj3rx57du35+bT0tKwcrQ4uIqOC+Q0QUFHzYwGqpubm4+PDxdlpPwIlRTNCDKx6CaM7BK3KmEC7EzTpk0PHjzIJYbhkeDIkSPcXzkutbO323jwE1Lcdp3bY6UZRdmU6KJTauFWnH74tXF7/ywBGjZ8OOVSVCktW7ZE44dffOPGjc8//zz/V69i6VRaE6pwZGVlIRDdGyoBN799+3YysV5FHUiX2vd0oHTIMkUKLIs18Gs7cOAAFkQJ5kM44DFKCtEW7549e7i/qampzZo1QwvWePkRKiksnKh+ySjhJvgo0V0is4xKEBgYOH78eG4+PDwclTMfJcel7dq3oxRv06kttpp5Kkeou8h0MhcnMH5t3B4XFhaeegx5qJRLkYxS7ZlnnkEIWkH8ClUrnUprQrlUWDRJcS5evEgm1quoA+lSVHFCN0qXAsvylaTebJd+++235N+ysjLj5UeopLBwnjlzxvgm+HnRXTLi0s8+++y5557DeQQtcDSaVq5cyUfJcanOQUedL3Uu9thqQvZaoe7CadvhHXXWG1Q4P89l2969e3nVOKqrq/kFVSudKmuCzbVu3VqYQDSxXkUdSJc6iNWl0qXAsg5EXcq1eHfs2MGHcJAtXtEST2nCpzFefoRKCkNqiyJ3o85dEk2AygnmTElJQWWOCp8cx5bjUm9fb6rv8f7MUGy1m2P39ftTuZDM0zn/N2fSy3adU7/cSuXEptzUOvtgVDg/j3MeTn4bNmygEpOoVjrV1IQbPQoJCREmECbmUE0H0qX+/f2F/VLpUmBZrIE4CL2vASOjRwUFBVj5d999xyfQCzThXWG8/AiVFIbUFkUar85dEk0Apk2b1qdPn6CgoODgYDJcjks/iJhMjePtOLXLM8AbG27arCkyw9nLpXWHNvjb6qW/px3ZTuVZ7PyZxsczheHkPJZFRyI5ORn9e5wFN2/eHBsbSy6oWulUWhPuAsDJkydxjNSVmNrEIVFNB9KlOIrQmDDq6KRLgWVJHfSGcZQXXnjhlVdeQWfy/Pnzu3btQoeNvBJTUlKCVa1btw7iUJ4RtZCR8iNUkswIHmGng//LbaLOXRJNAIqLi59++mn0b/Pz8/lAvTyXfr7vc5FrYqdywuZPsXPW/eWZv6CV8vfWLwaO+Cf3DAQ55ZzNx6lReG1QWMiMFMSEhAR7e/sWLVqgX+Hq6rp69WpyQdVKp9KaNDHc1fDXv/4V5RIlSXgpX1QcHtV0oK6XevXxpg5QuhRYlrpeCtAVHDVq1Isvvti8eXM0dCdPnkxKoTc894+2Isp3E7HLHvxfvoVZW/kRKslnBElWVpYwMbWJOndJmIADdWmXLl3IEL08l9Z2f4mUad2WRH9/f+H9JRZEtdKpcU1U04F0KY7Cz99/XtJC4WHWOWEpPwV0sC7Qr0GvmwqU41KQl5/n5Ops6r2aOcfzPDw8TL1n1VRUK50a10Q1HUiX6g2drt7uvU3VAemxlBI6WAto/a5YsaJly5b8uDGPTJeCiOmRAa8OlP7cQ+6Z/GHDh3Gfc1cU1UqnxjVRTQfKpXrDh5uCXh8iXQekRHqFdLAW0PRt1apVYmIiHWGOS6uqqkaMGhk4dJCUZwhzT/xZHIODg+u8B9J8VCudGtdENR2ELsUR4bhefWPo1n9nCA+cmpAGKZXToQEg36V6Q2ZERUW5urnOTVwgVJ+bcs7mo9/FfV1LnWxQrXRqXBPVdBC6VG/QAUfn5u4Wtz5eqAA/IRZpFNWhAWCWSznQl/Dz8/Pu6zNl1tS1O5NSD6btOpP32eH0zblbYufN9PX1Raya/Q3VSqfGNVFNB1GXcnA69O3Xd/qcqKTsDZ8e2gZn4hfzCEG4Cjo0ACzgUr1hZG///v0xMTEBAQFOTk42Njb4xTxCEK7yqJ1qpVPjmqimgxGX6jWgQwPAMi7VFKqVTo1ropoOxl3KMB/mUvloXBPVdGAuVRrmUvloXBPVdGAuVRrmUvloXBPVdGAuVRoTXLp58+ZFmic1NVW10rlIw5qoqQPKkGZ1aAAgK01wKW1wraJa6dS4JqrpwOpSpWEulY/GNVFNB+ZSpWEulY/GNVFNB+ZSpWEulY/GNVFNB+ZSpWEulY/GNVFNB+ZSpWEulY/GNVFNB+ZSpWEulY/GNVFNB+ZSpTHBpVZxTUzN64SLNKyJmjqw66WKwq6XmoXGNVFNB1aXKg1zqXw0rolqOjCXKg1zqXw0rolqOjCXKg1zqXw0rolqOjCXKk0DdOny5cvpvVcGjWuimg7MpUpjgkut4uUXpaWlKSkp9N4rg5Y1UVOHpKQk/iudDIuDMhYXF0dpLu7Sw4cPCz/2qjVQNGNiYh48eEDvvTJoVhOVdcCGoqOjmVGV4Mcff8zOzv7qq68ozcVdCrKysuK1TXJy8q+//krvt5JoUxP1dcDmsFF6Pxhms3jx4vT0dFpuIy5lMBgagbmUwdA6zKUMhtZhLmUwtA5zKYOhdf4fl7MBk/HH/QUAAAAASUVORK5CYII=" />
</p>
<p>これをポリモーフィズムの導入で解決した例を示す。</p>
<div class="sourceCode" id="cb145"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/visitor.cpp 143</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> FileEntity <span class="op">{</span></span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> FileEntity<span class="op">(</span><span class="bu">std::</span>string<span class="op"> </span>pathname<span class="op">)</span> <span class="op">:</span> <span class="va">pathname_</span><span class="op">{</span><span class="bu">std::</span>move<span class="op">(</span>pathname<span class="op">)}</span> <span class="op">{}</span></span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span> PrintPathname1<span class="op">()</span> <span class="at">const</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span> PrintPathname2<span class="op">()</span> <span class="at">const</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-10"><a href="#cb145-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb145-11"><a href="#cb145-11" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span> <span class="va">pathname_</span><span class="op">;</span></span>
<span id="cb145-12"><a href="#cb145-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb145-13"><a href="#cb145-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-14"><a href="#cb145-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> File <span class="kw">final</span> <span class="op">:</span> <span class="kw">public</span> FileEntity <span class="op">{</span></span>
<span id="cb145-15"><a href="#cb145-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb145-16"><a href="#cb145-16" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb145-17"><a href="#cb145-17" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span> PrintPathname1<span class="op">()</span> <span class="at">const</span> <span class="kw">override</span> <span class="op">{</span> <span class="bu">std::</span>cout<span class="op"> &lt;&lt;</span> Pathname<span class="op">();</span> <span class="op">}</span></span>
<span id="cb145-18"><a href="#cb145-18" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span> PrintPathname2<span class="op">()</span> <span class="at">const</span> <span class="kw">override</span> <span class="op">{</span> <span class="bu">std::</span>cout<span class="op"> &lt;&lt;</span> Pathname<span class="op">();</span> <span class="op">}</span></span>
<span id="cb145-19"><a href="#cb145-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb145-20"><a href="#cb145-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-21"><a href="#cb145-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Dir <span class="kw">final</span> <span class="op">:</span> <span class="kw">public</span> FileEntity <span class="op">{</span></span>
<span id="cb145-22"><a href="#cb145-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb145-23"><a href="#cb145-23" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb145-24"><a href="#cb145-24" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span> PrintPathname1<span class="op">()</span> <span class="at">const</span> <span class="kw">override</span> <span class="op">{</span> <span class="bu">std::</span>cout<span class="op"> &lt;&lt;</span> Pathname<span class="op">()</span> <span class="op">+</span> <span class="st">&quot;/&quot;</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb145-25"><a href="#cb145-25" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span> PrintPathname2<span class="op">()</span> <span class="at">const</span> <span class="kw">override</span> <span class="op">{</span> <span class="bu">std::</span>cout<span class="op"> &lt;&lt;</span> find_files<span class="op">(</span>Pathname<span class="op">());</span> <span class="op">}</span></span>
<span id="cb145-26"><a href="#cb145-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb145-27"><a href="#cb145-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-28"><a href="#cb145-28" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> OtherEntity <span class="kw">final</span> <span class="op">:</span> <span class="kw">public</span> FileEntity <span class="op">{</span></span>
<span id="cb145-29"><a href="#cb145-29" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb145-30"><a href="#cb145-30" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb145-31"><a href="#cb145-31" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span> PrintPathname1<span class="op">()</span> <span class="at">const</span> <span class="kw">override</span> <span class="op">{</span> <span class="bu">std::</span>cout<span class="op"> &lt;&lt;</span> Pathname<span class="op">()</span> <span class="op">+</span> <span class="st">&quot;(o1)&quot;</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb145-32"><a href="#cb145-32" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span> PrintPathname2<span class="op">()</span> <span class="at">const</span> <span class="kw">override</span> <span class="op">{</span> <span class="bu">std::</span>cout<span class="op"> &lt;&lt;</span> Pathname<span class="op">()</span> <span class="op">+</span> <span class="st">&quot;(o2)&quot;</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb145-33"><a href="#cb145-33" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb145-34"><a href="#cb145-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-35"><a href="#cb145-35" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Printer <span class="op">{</span></span>
<span id="cb145-36"><a href="#cb145-36" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb145-37"><a href="#cb145-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="dt">void</span> PrintPathname1<span class="op">(</span>FileEntity <span class="at">const</span><span class="op">&amp;</span> file_entity<span class="op">)</span> <span class="op">{</span> file_entity<span class="op">.</span>PrintPathname1<span class="op">();</span> <span class="op">}</span></span>
<span id="cb145-38"><a href="#cb145-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="dt">void</span> PrintPathname2<span class="op">(</span>FileEntity <span class="at">const</span><span class="op">&amp;</span> file_entity<span class="op">)</span> <span class="op">{</span> file_entity<span class="op">.</span>PrintPathname2<span class="op">();</span> <span class="op">}</span></span>
<span id="cb145-39"><a href="#cb145-39" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>上記例では、PrinterのアルゴリズムをFileEntityの各派生クラスのメンバ関数で実装することで、
Printerの各関数は単純化された。</p>
<p>
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfQAAADqCAIAAADbHyCCAAAAKnRFWHRjb3B5bGVmdABHZW5lcmF0ZWQgYnkgaHR0cHM6Ly9wbGFudHVtbC5jb212zsofAAABIWlUWHRwbGFudHVtbAABAAAAeJylUU1PwkAQvc+vmGN7KJEGjeFgiAIaQmNjgfvSjrCxnW22sxii/ne3GJISvIhzm/eR92Z31Iiy4qoS8lI1DU51SRMWLXv8APSTWs2SKtmyqqgfhOdg7MEv6Pgvc461vcz4LFuy/+l8YOjP6YdTMXJ19HnXeTdoD/kN7/Y8Z+HYIjqBR8RF+zuQloplmcxxR7bRhrHfi6/iQW+wJlHXwZLf2Lwz5qaq216iKwoheEzn2Bhnc8JCN2L12ok3hzBTO4UvjlvdENstWCQhZpMjiBPeaWu4IhaYrZIfET4ZyWojB/HNILrXghlZ3wlXCYzpVblSvDU3hebNEJeLaXQLc8UbpzY+iBgejA+we89l8A3bVc0XgVyiSgAALxpJREFUeF7tnXt0FdX59wMhEQJeIvbXiAL+gFhCrpCbkISEAKUq1AuIQr0sX1sRSw1CzQV+2AYKFJXXF0qBKEiARAiEXLgFTZAqLnxZXNVwWZRwh1IuCYeu/tFVu3gfz34ZJ3vPzJmTnJmz55zvZ52VdWZfD/N8n++Z2ZlsQm4BAAAIOEL4AgAAAM4H5g4AAAEIzB0AAAIQmDsAAAQgMHcAAAhAYO4AABCAaJt7S0vLO++8M2/evLlAPr744gs+YJYBJciMnUoAjkPb3N99993z58+7gJRUVlZWVFTwMbMGKEFm7FQCcBza5k4XBbyOgEzMnz+fj5k1QAmSY5sSgOOAuTuS9957j4+ZNUAJkmObEoDjgLk7EttSGkqQHNuUAByHn839xo0bWz/Z9vq0Xw/JyYiJi4mKiqKfg3OGTJr6WvX2mpYbLXwH4Ma2lPa5EppbmjdsrfxV3quDs4f0vx3xjGGZv5n+xo5Pd5Ae+A7AENuUAByHP829ZmvN4KzBKUNSf1kwaeGGRSt3rt709Wb6Se+phMrTM9Mrajbw3YCNKe1DJZBxr9lUlpqZphvxjNQhQzO2btvG9wT62KYE4Dj8Y+7Nzc1vTM9LSE6ctbSY0lvvRbXxyQl0FX+9+To/RHBjW0r7SglXrl15ecorFE2PEU9MTpz21nRSCD8E0MI2JQDH4Qdzp7x9evzTw8eMKP+qQkxv7kVtqOXosWOQ7WpsS2mfKIGc/WdPPWo+4iPGjHzm2fGIuBlsUwJwHH4w9zd/++bwMSM3HqoRE1vzRS3JFyZPfZ0fKIixLaXbr4Qbrhv/6zevUAS9ivjIn496K/8tfiwgYJsSgOOw29y3121PTE4q2+P5Ck79ovYJyQnVW2r44drBtm3bQkJCTp06xVc4AdtSuv1KKKsqj09OaEPEB6UMqqur44fzhDqs9ofY/hltUwJwHLaa+40bN4bmDBVXXSsP1U7+3ZQ+MX1DO4WGhYf1HdAvLjV+QHKsug31Gjx0iPHTFCy1GPfcc8+4ceOampr4Rre5evXqiRMnjAd03R7z3LlzfIVfsS2l26mE5pbmtKx0LuJmwk2v3y2dnTNsmF6A1LFmTJ482dU6rCatVhyK2LdvH9+uNZrCEGe3Wjm2KQE4DlvNvaGhIT3zES6HKw/X5ozJpTSgPI8ZFNs/KYZyng4jukVwLVMyUj9t+JQfVAVLp71791KC0VwxMTEjR47kG7m5ft3sb2jbmaLmJ/IK21K6nUqo2l5DUWtbuOmVMTSD4sgP6kYda8bFixc125g0d/VQhMcVf4/C8NjAJ9imBOA4bDX3gsKCVwtf4xJ4+rsFlAO9o3t/8OlHrKRkx8p7/6u7mO2/KpiU99s8flAVXDKvXr06NDT02rVrSlVlZeWgQYPCwsIqKirUjdn76urqxMTE8PDwgQMH7t+/nw0S0prbU7kWLFjQr18/GqpHjx75+fmKF4gTKV18iG0p3U4lTJr6GkWtbeGm129m5hUVFfGDutEzbjGsShvjkIlDKVXmhaEeSmwwY8YMuuC4Pfb3pKenT5o0SV3iLbYpATgOW8192PDchRWLuAROzkoh6c9dvUBd+Erhq6OeeZRrSX2zhg3lB1XBZem6des6dOhw5coVpSo+Pp7eNDY2UhvRBSjT6DqR7sdTU1MzMzPZIGVlZVR14MABdkHHCgsLC6Ojo8nBjx07Vltb26tXr+nTp7MqcSJW7ltsS+l2KmFI9hAu4ubDTa/3N/xpxIgR/KBu9BxZDCt77zFk4lBKlXlhqIcSG9DUdLXx2Wefscb0PUEN9uzZww7bhm1KAI7DVnOPT4hf+dkaLoEf7NOTJL7hQLWY29yL+g6Ij+UHVaFOLfpJeUjZqK5av369ZmP2fuvWrayqtLS0U6dObEWFValvri9fvtylS5f6+nqlZOXKlZGRkey9OJEV2JbS7VRCTFwMF3Hz4WYRT0hI4Ad1w85zhIojR44o5Zy5mwmZeii6tFdXmRSGUqienWswatSol19+mb2fOnUq3Qqoa9uAbUoAjsNWc+/Zs6eY1T0eeoByoPJQrZjb3Iv6PtizJz+oCnWW0jU7ZQ5dN6mrjh8/zjVW5+HJkyfVVWyrWzFFd+3axXlB586dqeTSpUtKe/VEVmBbSrdTCQ/2fJCLuPlws4jTJTY/qBt2nikWh26j9lzO3M2ETD3UN998o57FpDCUQgNz//jjj++66y76smlubo6Kinr//ffVtW3ANiUAx2GruWteuccMiqUcWFT9ZzG3uRf1jTVx5U5Zevjw4dOnT4tV6ltvMQ+VWnVaiim6c+dOKtmxY4fiBYyWlu93whEnsgLbUrqdSoiJG8BF3Hy46VW6qzwxMZEf1I3eedYMa5tD5pUwuPaaDegbiDz9gw8+oHs7upm4cOGCurYN2KYE4DhsNffhI0b87w2LuQR+deZkyoGHE37yYUMpK6k8XPva27/+7/59Sj8vV7dcWLEoJzeHH1SF+SzlSgxyuK6ujt6fOXNG6UiXe3Tdt2LFCqVEjTiRFdiW0u1UQmZOFrfmbj7c9FpetcIna+5tDplXwuDaazYgpk2blpWVNXr06AkTJnBVbcA2JQDHYau5FxUV5f3PVC6BNx6qGTwyg9IgtFMo5XzSkEH39+pBh91/fF/ZnvWtfKHwtYLCAn5QFeazlCsxyOEjR47Q+6VLlzY1NSkN6B8SGRlZUlLS2NhIF4CrVq2aMWOGOKx12JbS7VTC1Lfe5J6WMR9uehX8vtBXT8t4DBn3KOTVq1e5EZRDA2Go22s2IL7++uuOHTt26tRp+/btSmGbsU0JwHHYau4NDQ2ZQzO5BN7k/quWKbPz+ifF3NH5jg4dOtx3/49GjX+UbRmofj2SNVjvqWeGXsJrVum5gHKo3FDPmjWLbqUpIUNUj0IuWrQoNjY2PDw8IiIiOTl58eLF6r6an8GH2JbS7VRCfUN9akZa28Jd/c3W7JxsvYjrnWeDsBqHjGPTpk3iCB6FwbUXGzDoyr1v377qkjZjmxKA47DV3G/cuJGbmzuv5I9cGpt5uf9eMUfv7xWDDdtSup1KoHhlaf1NspnXolV/IrUEZMSjo6OLi4v50jZhmxKA47DV3F3uhcjUtNR1X20Qk9ngVbanIjk1uQ07jQQqtqV0+5WwvW57UspAb/eW2bS3Ni09LfAi3tTUtHDhwi5duihP4LQT25QAHIfd5k4UFBQ8MfZJkw/DbXKv0j765GPUix8oiLEtpX2ihLfy3/rpE6PM7wpZ/fXWsePGBmTEQ0JCunfvvmzZMr6irdimBOA4/GDuzc3NEyZMeHLsU+u+qhQTm3uVf1Ux+qnvnyvwuNdHUGFbSvtECRS755577mdPPGpmP/eqfZvHPjMWETeJbUoAjsMP5u5yZztdl6WlpS1c+b6Y3sprXskfU9JSqSXynMO2lPaVEiiC+fn5yanJxcvnioFmr5pvt/2p9M9p6emIuHlsUwJwHP4xd0ZdXd2wYcOGZg/N/13BhzUflX3+/WXd2r+sW1b1wbRZv83KzqLawFt19Qm2pbRvlcAinjk0c+r/TFtaVbJ6VzkZevnnFR9tLi36/YzsnGxE3FtsUwJwHP40d5f7aYqGhoaioqKRI0cmJiZGRUXRT3pPJVQekE9K+ATbUtrnSkDEfYttSgCOw8/mDtqGbSkNJUiObUoAjgPm7khsS2koQXJsUwJwHDB3R2JbSkMJkmObEoDjgLk7EttSGkqQHNuUAByHrrmvWrVqLpCS0tJS21J6LpQgMXYqATgOXXPnrxCATNiW0lCC5NimBOA4YO6OxLaUhhIkxzYlAMcBc3ckPknpv/71r8uXL79+/TpfoQJKkByfKAEEJDB3R+KrlN6zZ09MTMyrr7564sQJvs4NlCA5vlICCDxg7o7EhylN/v7QQw9FRUX99Kc/3bVrF1cLJUiOD5UAAgyYuyPxbUqTv/ft2/fBBx/s1atXUlLSmjVr/vWvf7EqKEFyfKsEEEjA3B2Jz1Oa/P0nP/kJu4Tv2bMnef3s2bOvX78OJUiOz5UAAgZdc8fTzdJSWloaZQ3k6erDPn36TJkyBUqQFjznDgzQNXf+CgHIhM9TGlfuDsXnSgABA8zdkfg2pbHm7lx8qwQQSMDcHYkPUxpPyzgaHyoBBBgwd0fiq5TGc+5Ox1dKAIEHzN2R+CSl8ReqAYBPlAACEqvMfdu2bSEhIadOneIrbESGz+AVM2fOHD9+PHufmJi4Zs2a1vU/YFtKQwl+QUIlAMfhhbmzDGHcc88948aNa2pq4hvd5urVq3Sn7/G/xGRjnjt3Tiw0ORHDYBzZUvqll15KTU3t2rUr94HPnDlz55137tu3jx2uXbv24Ycf1juBtqU0lGAdzlICcBxem/vevXspVxsaGmJiYkaOHMk3ckN3+nyRDgapaGYiBYNxZEvpF154Yf78+cXFxdwHnj17dlpamnJInkh2Vl1drZSosS2loQTrcJYSgOPw2tyVDFm9enVoaOi1a9eUqsrKykGDBoWFhVVUVKgbs/ekTrrBDA8PHzhw4P79+9kgIa3xONGyZcvi4uJokLvvvpvuW5WUMBhHc16DKr0pWJeqqqqkpKQ77rgjJSXl8OHDO3fupL50SD8PHjzIWhILFizo168fnYoePXrk5+c3NzcrVQzRg+iTUJ6rmrjoQpXyX12iYFtKQwniFMGpBOA42m7u69at69Chw5UrV5Sq+Ph4etPY2EhtxJROT0+niy+62aRb0czMTDZIWVkZVR04cOCEG48TlZSUbNmy5ejRo9RmwIABzz77rMdxNOc1qNKbgnWhlvX19ZT/1Jdym3pRVrPD7Oxs1rKwsDA6OpoM7tixY7W1tb169Zo+fTqrUuBS+uLFi/RvpHnVbeiy7qGHHlKXKNiW0lCCOEVwKgE4jjaaO/0kNZO+1VXr16/XbMzeb926lVWVlpZ26tSJ3bBzyhb7chOpKS8vj4iIYGuRBuMYzKtZpUacQsk6uoqkw7q6OuWQRqDrssuXL3fp0oXSXhlk5cqVkZGRyiGD+8C7d++mw0OHDqnbkE9RnrMLVQ7bUhpKYIhTBJsSgOPw2twj3JDU6PaTro/UVcePH+caq1P65MmT6qrz588r7zVTUXOiTz75hC6L7rvvvq5du3bu3Jma0ZWO8TgG82pWGU/BdTlz5gw3wq5du5QPz2CDXLp0ibVUt1c+MFkDHSpXmgy61qPCs2fPqgsZtqU0lKA3RbApATgOr82dJHv48OHTp0+LVcrtM1fC1arVbJCK4kTUrFu3bhMnTqSroYMHDy5fvtzMOAbzilUepxC7cId0b05vduzYcag1LS0trKVmd3a9pl6rdclxvQYl6E0hduEOA0wJwHF4be7qvDWoMpnS7DpFueoR+6r59NNPqfzo0aPscM6cOV6NYyalDabQ68Id0nUZXaCtWLGClevBdWcrrXSBpm4zb948v6+0QgmsHEoAjsPP5n7kyBF6v3Tp0qamJq6BOBHd7IeGhubl5X377bfl5eUPPPCAV+OYSWmDKfS6iIdFRUWRkZElJSWNjY10pbZq1aoZM2awZsSXbhYvXhziXqil96w8ISHh7bffVpoRY8eOff7559UlCralNJQgTqHXRTwMJCUAx+FncydmzZoVFRXVsWPHEJ0H4NQsWbKEGtMFUXZ29rJly7wax0xKu/SnMOgiHi5atCg2NjY8PDwiIiI5OZkSmJW7hGf1Qm5/2uLiYmqpNGNPN1dVVSklamxLaShBnMKgi3gYMEoAjsMLcweWcvr06W7duu3du5cdrl27Njo62u9/lwgl2I+cSgCOA+YuEXTP/swzz7D3iYmJq1evbl3/A7alNJTgFyRUAnAcMHdHYltKQwmSY5sSgOOAuTsS21IaSpAc25QAHAfM3ZHYltJQguTYpgTgOKwyd4PnHGxDhs9gHvNbeLtsTGkowX7kVAJwHF6YO8sQhsfNtbGLtyZ5eXn9+/cPCwu79957J06cqPytjVdbeLtsTGkowSIcpwTgOLw2dzOba4v7LulhkIpmJlIwGEeqlM7NzaV0bWxsrK+vp9weMWIEK/dqC2+XjSkNJViE45QAHIfX5q5kCHbxbs8u3q7bG4awDWy92sLbZWNKQwniFMGpBOA42m7u2MW7Pbt4u9x/ANm1a9eWlhZvt/B22ZjSUII4RXAqATiONpr7Kezi3b5dvM+fP9+7d++8vDyX91t4u2xMaSiBIU4RbEoAjsNrc2c7U2MXb3bYtl286dqTpsjIyGAXod5u4e2yMaWhBL0pgk0JwHF4be7i5tpKlXL7zJVwter0M0hFcaJznrbY1hzHYF6xyuMUYhfu0OMu3nRVOHr0aLqRv3DhAivxdgtvl40pDSXoTSF24Q4DTAnAcXht7uq8NagymdJmdt9WMNhi28w4ZlLaYAq9Ltyh8S7elNjjxo2LiYlRW5W3W3i7bExpKIGVQwnAcfjZ3M3svq1gsMW2mXHMpLTBFHpdxEODXbxffPHFqKioL7/8kv2678TtB8C92sLbZWNKQwniFHpdxMNAUgJwHH42d5eJ3bfV6G2x7TIxjpmUdulPYdBFPNTbxTtEgHXxagtvl40pDSWIUxh0EQ8DRgnAcXhh7sA6vNrC22VjSkMJNiOtEoDjgLnLgvktvF02pjSUYD9yKgE4Dpi7I7EtpaEEybFNCcBxwNwdiW0pDSVIjm1KAI4D5u5IbEtpKEFybFMCcBwwd+dx8+ZN21IaSpAZO5UAHIe2uZNi2F9gAwmpqqqqrq7mY2YNUILM2KkE4Di0zd3lvt1bsGDBfCATf3Sze/duPmCW0WYlFBcXFxQU8KX+5vnnn+eL/A2dJTpXfKkn7FcCcBza5g5A2/jHP/6xcePGl156qX///mfPnuWr/crNmzcffvhh+slX+BU6S3Su6IzReaOzx1cD0FZg7sAHKJ5O7smcfcmSJXwjf1NZWRkVFUU/+Qp/Q+eK+Ts7e3B54BNg7qDtcJ7OXKm2tjY3N/ff//4339rf0CecMGEC/eQr/A2dKzpjdN40zyffGgBzwNyB1xh4kMvlSkpK2r9/f+se/oetyVy6dEnClRmCzhidNzp77NDgDANgEpg7MIsZxylwwxXKQGVlJbtmp58Srszc0jl1Zs45AJrA3IEHzPsLd/kpFYqnKy4vG8Y3PeajAAAD5g6MuHLlSv/+/R977DGPbqIsHPMVEqB+TkbOZ2YYZn5dwVyeIkJxoejw1QDcBuYOPFBTU5Oent7S0sJXtGbJkiUTJ07kS+WAu1qXdmWGoHPo8UEjigVFhOLCVwCgAuYOPDN79uxnn332u+++4ytuc/bs2QEDBsj2YLsC5+bSrszcMnEmKQoUC4oIXwFAa2DuwDMeDcXM9aa/ENdhxBKpML4H8vhFCwAD5g5MwZYCNmzYwFeYWyn2I5rX6TKvzBj89oLOv5klMgBuwdyBeeiKskePHgcOHFAXGj/jIQOaPq7p+PKg+dwRnXk6/9LeIQHZgLkDz3z33Xdz5syha0ZyFu7KUfPpbHnQW4HRK5cH7sSyOyd2/ikWWJYBHoG5Aw+QrTzrhnm6es1X8wJTKgyu0DWv6OVBfUuk/p0HFw4A9IC5AyMaGxvT0tL+8Ic/KJeKitEYLA3Lg4GDG/i+JCi/zOB+iUpvKCIUF4pO6x4A/ADMHehSXV0dFxcn2jdbIvjFL35h8FCHDBivvRjXSgKdYTrPmr9EpbhQdPCfdQA9YO5AA7o2LC4ufuSRR44ePcrXuTly5EhsbKzB49gy4PHa3OC6XhLoDNN5prPNV7ih6FCMKFJYggciMHfA09zcPH78+Oeee+7GjRt8nYq///3vfJFkePRuj+4vA8bnmWJEkaJ4UdT4OhDcwNxBK9gi+9y5c51+MXjz5s3evXtHeYLaSL4y4xGKFMULS/CAA+YOfqCqqkpzkT1gIDfniwIFtgRPEeQrQLACcwff43GRPTAIYHO/hSV40BqYOzC7yB4ABLa538ISPFABcw92lEX2//znP3xdwBHw5k5QHLEED27B3IMctsi+efNmviJACQZzZ1BMsQQf5MDcg5QgWWTnCB5zv4Ul+KAH5h6MBM8iO0dQmfstLMEHNzD3oCNgnmRvA8Fm7rfwFHwQA3MPLgL+SXZjgtDcGXgKPgiBuQcLwbnIzhG05n4LS/DBB8w9KGhpaQnORXaOYDb3W6oleHGPSRB4wNwDn2BeZOcIcnO/hSX4YALmHuDo7ckenMDcGdgLPhiAuQcsdI02e/bs9PR0vd3AgxCYuwKpgrRBCsH9XKACcw9M8D9tagJzVwORBDYw9wCEXZSp/+NTwIC5c3zn/u9YcXsXkMDcA42ampq4uDj6yVcAmLsO0ExAAnMPHOgqbM6cObgKMwDmrge72yP94G4vYIC5BwhYPzUDzN0ASCjAgLkHAnjywSQwd2PwhFUgAXN3PHhm2TwwdzPgbyMCA5i7g2GPOuCvDc0DczcJ+6tmPHDlaGDuToXtE4IVUq+AuZuHLcFjPyLnAnN3JGyHPyyyewvM3SvYEnyQ7yTqXGDuzgN7c7cZmHsbCPL/A8C5wNydBLb0aycw97aBjUWdCMzdMeD/w2w/MPc2E7T/765zgbk7A/w3Oj4B5t4evsN/5uUoYO4OAIvsvgLm3n6wBO8UYO5Sg0V23wJz9wlYgncEMHd5wSK7z4G5+woswcsPzF1SsMhuBTB3H4IleMmBucsIFtktAubuc7AELy0wd7nAIrulwNytAEvwcgJzlwgsslsNzN0isAQvITB3WcAiuw3A3K0DS/CyAXOXAuzJbg8wd6vBXvDyAHP3M9iT3U5g7jaAveAlAebuT/C/VtoMzN0eIGwZgLn7Dfx/8/YDc7cNUjVpG/8dqx+BufuHf/7zn6mpqTU1NXwFsBKYu82QwknnpHa+AliPtrnTzdQ777wzb968ucAyiouL+SJzfPHFF3zALANKkBlHKKHNOgfm0VSCtrm/++6758+fdwEpqaysrKio4GNmDVCCzEAJgKGpBG1zp68CvjeQifnz5/MxswYoQXKgBMAQlQBzdyTvvfceHzNrgBIkB0oADFEJMHdHIgbSIqAEyYESAENUggPM/caNG9s/2f76tCkZOZkxcTFRUVH0c3DOkFenvrZpW1VzSzPfIQgQA2kRUimBAT2okV8JFK+a7bWvvfn6kJwhSryG5GRMfvP1LTu2UC3fAbQJUQmym/vmrZsHDx2SkpH6y4JJCzcsWrlz9aavN9NPek8lKUNS0zLTP65ex3cLdMRAWoQ8SmBADxySK2Hj5sr0rEcoLnrxeiTrkarNVXw34D2iEuQ19+bm5qnTpyYkJ85aWkyC0HtRbXxywq/eePXa9Wv8EIGLGEiLkEEJDOhBE2mVQPGaPPX1hOQEj/GiNlOmTaH2/BDAG0QlSGruFOmx48cNHzOy/KsKURDci9oMHzPisacfv379Oj9QgCIG0iL8rgQG9KCHnEqgeP183BMUBfPxenLck/D39iAqQVJzn/7W9BFjRm48VCNKQfNFLUkfv8qbxA8UoIiBtAi/K4EBPeghpxLoSpzOv7fxypuexw8ETCMqQUZzr6urS0oZWLbH83e++kXt6X68cnMlP5xptm3bFhIScurUKe69hIiBtAj/KoHhLz0oyCwGCZWwZduWhOTENsSLetGp5odrBxIGzrqPJCpBOnO/ceNG9rBscZ2u8lDt5N9N6RPTN7RTaFh4WN8B/eJS4wckx6rbUK9Hhg72+Pt3dn7VTJ48mcqvXr164sQJ1t26GPgEMZAW4UclMOzUQ4cOHe66665BgwbNnDnz4sWLSgO1MGRDNiXQWcrIzmhzvDKzs/TOc2Nj48SJE3/84x+HhYX17t07Ly/vwoULSi0L4rlz51Q9fJbFomMQ+/bt49u1RvMjiSbDNWgzohKkM/eGhobBWYN5ZRyuzRmTSyeCZBEzKLZ/UgxJhA4jukVwLVMyUrd/sp0ftDXsnO7du/fEbdSZrG7TfllYhBhIi/CjEhg26+HAgQMfffRRQkJCnz59mpqa+KYCfl/Wl00JFK/UjLQ2xystM51G4Ad1uQ4ePNi9e/fHHnusvr7+yJEjVVVVSUlJcXFxf/vb31gDTaP0SRZTiEXHIDz+hkDzI6nx2MArRCVIZ+6FRYWTil7nQj793QI6C72je3/w6UespGTHynv/q7sojl8VTJoy7Tf8oK3RC7m6nGuzYMGCfv360SVDjx498vPzPcbVasRAWoQflcDwix4uX74cHR39yiuviA3Y+8rKSrrAJz1UVFQovfyCbEqY9tY0OuftiddbBW/xg7pcubm5OTk56ov6S5cu9erV680332SHIa1hhSxY1dXViYmJ4eHhAwcO3L9/vzKCXlKLIRYVomAwRetP1OojsaHEBjNmzIiJibk99vekp6dPmmTqV0eiEqQz9+HDhy+sWMSFPDkrhf7xc1cvUBe+UvjqqGce5VpS38ycTH7Q1uiFSsxh9r6wsJBSnYJ97Nix2tpaktT06dO5vjYjBtIi/KgEhr/0MH/+/KioKLEBex8fH09vGhsbRRXZjGxKyM7Nbme8cnJzuDFPnz7doUMHSkCuvLi4uGfPnux9WVkZTUE3XuyymhWyYJE/0t3Avn37UlNTMzP/vxgMkloMsaZC1I01pzD4SGwosQF9mNDQ0M8++4w1pu8JarBnzx52aIyoBOnMPT4hfuVna7iQP9inJ/0jNxyo5srFF/UdEDeAH7Q17PxGqKAbPaWcM3e6iOvSpQvdDCrdV65cGRkZqRz6BTGQFuFHJTBs0wOXups2baLCq1evcg3Y+/Xr16sb+xHZlBAbH9vOeMXFx3Fj7ty5k7qT8XHlZM1cjDSXZbZu3coOS0tLO3XqdP36deOkFkMsOgZd7KurxCmUKs2PpNYS12DUqFEvv/wyez916lS6FVDXGiAqQTpzp69iUQQ9HnqAzkLloVpRDdyL+j7Y80F+0Nawc7pr165Dt1EHgzN3asbFtXPnzlRCd4X8uDYiBtIi/KgEhm164MxdNA61MI4fP65u7EdkU0L746VcjCu009xPnjypPjx//rxxUoshFh3jm2++MZ5Cea/5kQzM/eOPP77rrrvo66e5uZnuHd9//311rQGiEqQz94SEBPGbP2ZQLJ2FRdV/FtXAvb6/UouP5QdtjWYyc+XKeyasHTt2KHFltLS0cN3tRAykRfhRCQx/6YH+4ffff7/YQLOxH5FNCXTd3c540b0aNyZbltm4cSNXrl6W0TRKLlhKG+OkFkMsluhVqT+Gx4+k2YAuNMnTP/jgA7p1oNsL9RNBxohKkM7cR4wYsWgjL4JXZ06ms/Bwwk8+bChlJZWHa197+9f/3b9P6efl6pYLKxYNHZbND9oavVCJ553e05c5fauvWLGCa+xfxEBahB+VwPCLHtgvVH/5y1+KDcTG/kU2JQwbPkxcc/cqXrnDh/ODulw5bgx+oVpXV0dTnDlzRmngEoKlmKlxUoshFkv0qtR+7fEjaTYgpk2blpWVNXr06AkTJnBVBohKkM7ci4qKpr39W04cGw/VDB6ZQScitFMoSSRpyKD7e/Wgw+4/vq9sz3p1S73ftqvRC5VeDtNHioyMLCkpaWxspK/3VatWzZgxg+trM2IgLcKPSmDYpgf2oNvBgwcpvtyjkHrCkAHZlFBYVPia8HST+Xj9esZvKOL8oO5fLd57772PP/54fX390aNHa2pqBg4cqH4U8siRIzTg0qVLKWqc1Wo6r0FSiyFWK0RBXLJTDtkUHj+SZgPi66+/7tixY6dOnbZv9/AUrxpRCdKZe0NDQ1Z2FieOTe4/gpgyO69/Uswdne+ge7T77v/RqPGPsk3m1K/0zEc0n5NVIwZPLOfaLFq0KDY2Njw8PCIiIjk5efHixa162o4YSIvwoxIYtukhxP1HTHfeeSe5BuW5+AcymsLwO7Ipwf13CUPaHK+MoRl68frmm2+ee+65H/3oR2FhYT179nzjjTe4JYtZs2ZFRUWRLYZoPXeoHCrLIHpJLYZYUYiaTZs2iY25KTx+JLEBg67c+/btqy7xiKgE6cyd7rxyc3PfWfGeqA+Pr1lLi7OHtbp3C1TEQFqEH5XAgB6MkU0JdLaH5Q77/bI5Yjg8vmYvn0exDux4mSQ6Orq4uJgvNURUgnTm7nIvRaWlpa3/v5Vi+A1eZXsqBqYMor78cIGIGEiL8K8SGNCDARIqgc55cmqKt3vLlH9VkZKWEvDx8khTU9PChQu7dOmiPIFjElEJMpo7UVBQ8NS4pzYd5hWg99p4qOZnTzyan5/PDxSgiIG0CL8rgQE96CGnEihejz812qtdIcc8/XPqxQ8UfISEhHTv3n3ZsmV8hSdEJUhq7s3NzRMmTHhq3NMb9vLPzIov+s5/7MnHn5vwnN93BbANMZAW4XclMKAHPeRUAovXmKfHlH+1QQwQ9/r4q41PjH2C2gdDvKxDVIKk5u5y64O+yel+/P+sWlz1zRZRE+z1h5L5Kakp1DKolCEG0iJkUAIDetBEWiWweKWmpf7xw3fFMCmvd1a8R22CJ17WISpBXnNn1NXVDRs2LDsnu+B3hStqVpV9XkGJvfovHy+r+nDarOlZQ7OoNgjX6cRAWoQ8SmBADxySK4HFKyt76G/fzl9e9WHZ598/+Fj2l/Ul1Sveejt/aPbQYIuXdYhKkN3cXe7fvzc0NBQVFY0cOTIxMTEqKop+0nsqofLg/N26GEiLkEoJDOhBjfxKQLzsQVSCA8wdiIiBtAgoQXKgBMAQlQBzdyRiIC0CSpAcKAEwRCXA3B2JGEiLgBIkB0oADFEJMHdHIgbSIqAEyYESAENUgq65r1q1ai6QktLSUjGQFjEXSpAYKAEwNJWga+789wKQCTGQFgElSA6UABiiEmDujkQMpEVACZIDJQCGqASYuyMRA2kRUILkQAmAISoB5u5IxEBaBJQgOVACYIhKgLk7EjGQFgElSA6UABiiEmDujkQMpEVACZIDJQCGqASYuyMRA2kRUILkQAmAISpB19zxTKu0aD7TahFzoQSJgRIAQ1MJuubOfy8AmRADaRFQguRACYAhKgHm7kjEQFoElCA5UAJgiEqAuTsSMZAWASVIDpQAGKISYO6ORAykRUAJkgMlAIaoBJi7IxEDaRFQguRACYAhKsEqc9+2bVtISMipU6f4ChuR4TN4xcyZM8ePH8/eJyYmrlmzpnX9D4iBtAgowS9ACRYhw2fwivYowQtzZ+eFcc8994wbN66pqYlvdJurV6+eOHHC43+QyMY8d+6cWGhyIobBOLIF8qWXXkpNTe3atSv3gc+cOXPnnXfu27ePHa5du/bhhx/WO4FiIC0CSrAOKEETgwianIhhME6QKMFrc9+7dy9FqKGhISYmZuTIkXwjN9evX+eLdDAIgJmJFAzGkS2QL7zwwvz584uLi7kPPHv27LS0NOWQMoFEXF1drZSoEQNpEVCCdUAJmhhE0MxECgbjBIkSvDZ35bysXr06NDT02rVrSlVlZeWgQYPCwsIqKirUjdl7+kx0WxEeHj5w4MD9+/ezQUJa43GiZcuWxcXF0SB333033a0oJ8JgHM15Dar0pmBdqqqqkpKS7rjjjpSUlMOHD+/cuZP60iH9PHjwIGtJLFiwoF+/fnQqevTokZ+f39zcrFQxROXRJ6Hoqpq46PKEoq4uURADaRFQgjgFlKBgECAowe9KaLu5r1u3rkOHDleuXFGq4uPj6U1jYyO1EQOZnp5OX7l0i0E3IJmZmWyQsrIyqjpw4MAJNx4nKikp2bJly9GjR6nNgAEDnn32WY/jaM5rUKU3BetCLevr6ynq1JciSr0oluwwOzubtSwsLIyOjiZZHzt2rLa2tlevXtOnT2dVClwgL168SP9Gmlfdhr7MH3roIXWJghhIi4ASxCmgBAWDAEEJfldCG82dftK/gf5V6qr169drNmbvt27dyqpKS0s7derEbtO4f4/Yl5tITXl5eUREBFuBMhjHYF7NKjXiFMq5pmsHOqyrq1MOaQT6Nr58+XKXLl0o2MogK1eujIyMVA4Z3AfevXs3HR46dEjdhtRJ0WWXJxxiIC0CSmCIU0AJLsMAQQl+V4LX5h7hhiagmw76VlRXHT9+nGusDuTJkyfVVefPn1feawZAc6JPPvmEvgzvu+++rl27du7cmZrR95vxOAbzalYZT8F1OXPmDDfCrl27lA/PYINcunSJtVS3Vz4wCYIOlesLBn3DU+HZs2fVhQwxkBYBJehNASW4DAMEJfhdCV6bO33Qw4cPnz59WqxiYRNLuFr1v8EgAOJE1Kxbt24TJ06k78CDBw8uX77czDgG84pVHqcQu3CHdEdGb3bs2HGoNS0tLaylZnf2La1eoXN5+S1tEVCC3hRiF+4QSlCfJa7E4BwaRFCcyGOYNMcxmFes8jiF2IU79JcSvDZ3dbQMqkwGkn07Kd91Yl81n376KZUfPXqUHc6ZM8erccwE0mAKvS7cIX0b09fyihUrWLkeXHe2vkZfy+o28+bNM7++ZhFQAiuHEqAEVu4gJfjZ3I8cOULvly5d2tTUxDUQJ6JbvNDQ0Ly8vG+//ba8vPyBBx7wahwzgTSYQq+LeFhUVBQZGVlSUtLY2Ejfz6tWrZoxYwZrRnzpZvHixSHu5Tl6z8oTEhLefvttpRkxduzY559/Xl2iIAbSIqAEcQq9LuIhlAAl+FEJfjZ3YtasWVFRUR07dgzReexJzZIlS6gxfQ1mZ2cvW7bMq3HMBNKlP4VBF/Fw0aJFsbGx4eHhERERycnJFDZW7hKe0Aq5/WmLi4uppdKMPdNaVVWllKgRA2kRUII4hUEX8RBK0CwxPoceI6hGL0wuE+MEthK8MHdgKadPn+7WrdvevXvZ4dq1a6Ojo83/NZpFQAn2AyUARjuVAHOXCLpTe+aZZ9j7xMTE1atXt67/ATGQFgEl+AUoATDaowSYuyMRA2kRUILkQAmAISoB5u5IxEBaBJQgOVACYIhKgLk7EjGQFgElSA6UABiiEqwyd4PfbtuGDJ/BPOY3bnZpBdIioAT7gRKsQ4bPYJ52KsELc2fnheFxS2Xs3axJXl5e//79w8LC7r333okTJyp/YXHGm42bXVqBtAgowSKgBD0MImhyIobBOEGiBK/N3cyWyuJuO3oYBMDMRAoG40gVyNzcXApSY2NjfX09RXTEiBGs3KuNm11agbQIKMEioAQ9DCJoZiIFg3GCRAlem7tyXrB3c3v2bnbd3iaCbVvq1cbNLq1AWgSUIE4BJSgYBAhK8LsS2m7u2Lu5PXs3u9x/9ta1a9eWlhZvN252aQXSIqAEcQooQcEgQFCC35XQRnM/hb2b27d38/nz53v37p2Xl+fyfuNml1YgLQJKYIhTQAkuwwBBCX5XgtfmzvYj7oC9m92Hym8/lBHM7N1MVxw0RUZGBrv08HbjZpdWIC0CStCbAkpwGQYISvC7Erw2d3FLZaWKhU0s4WrVJ90gAOJE5zxtrKw5jsG8YpXHKcQu3KHHvZvpWmD06NF0+3bhwgVW4u3GzS6tQFoElKA3hdiFO4QS1GeJKzE4hwYRFCfyGCbNcQzmFas8TiF24Q79pQSvzV0dLYMqk4E0s+eygsHGymbGMRNIgyn0unCHxns3UzjHjRsXExOjFqi3Gze7tAJpEVACK4cSoARW7iAl+Nnczey5rGCwsbKZccwE0mAKvS7iocHezS+++GJUVNSXX37Jfslz4vZjv15t3OzSCqRFQAniFHpdxEMoAUrwoxL8bO4uE3suq9HbWNllYhwzgXTpT2HQRTzU27s5RIB18WrjZpdWIC0CShCnMOgiHkIJmiXG59BjBNXohcllYpzAVoIX5g6sw6uNm11agbQIKMFmoATAaL8SYO6yYH7jZpdWIC0CSrAfKAEw2qkEmLsjEQNpEVCC5EAJgCEqAebuSMRAWgSUIDlQAmCISoC5OxIxkBYBJUgOlAAYohJg7s7j5s2bYiAtAkqQGSgBMDSVoG3u1I793S2QkKqqqurqaj5m1gAlyAyUABiaStA2d5f7In/BggXzgUz80c3u3bv5gFkGlCAnUAJgGChB29wBAAA4Gpg7AAAEIDB3AAAIQGDuAAAQgMDcAQAgAPl/o0B1vREzsQYAAAAASUVORK5CYII=" />
</p>
<p>これはポリモーフィズムによるリファクタリングの良い例と言えるが、
SRP(「<a href="#SS_1_1">単一責任の原則(SRP)</a>」)に反するため、
Printerの関数が増えるたびにPrintPathname1、
PrintPathname2のようなFileEntityのインターフェースが増えてしまう。</p>
<p>このようなインターフェースの肥大化に対処するパターンがVisitorである。</p>
<p>上記例にVisitorを適用してリファクタリングした例を示す。</p>
<div class="sourceCode" id="cb146"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/visitor.h 9</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> FileEntityVisitor <span class="op">{</span></span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span> Visit<span class="op">(</span>File <span class="at">const</span><span class="op">&amp;)</span>        <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span> Visit<span class="op">(</span>Dir <span class="at">const</span><span class="op">&amp;)</span>         <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span> Visit<span class="op">(</span>OtherEntity <span class="at">const</span><span class="op">&amp;)</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb146-9"><a href="#cb146-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb146-10"><a href="#cb146-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-11"><a href="#cb146-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> FileEntity <span class="op">{</span></span>
<span id="cb146-12"><a href="#cb146-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb146-13"><a href="#cb146-13" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> FileEntity<span class="op">(</span><span class="bu">std::</span>string<span class="op"> </span>pathname<span class="op">)</span> <span class="op">:</span> <span class="va">pathname_</span><span class="op">{</span><span class="bu">std::</span>move<span class="op">(</span>pathname<span class="op">)}</span> <span class="op">{}</span></span>
<span id="cb146-14"><a href="#cb146-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb146-15"><a href="#cb146-15" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span><span class="op">&amp;</span> Pathname<span class="op">()</span> <span class="at">const</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">pathname_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb146-16"><a href="#cb146-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-17"><a href="#cb146-17" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span> Accept<span class="op">(</span>FileEntityVisitor<span class="op">&amp;)</span> <span class="at">const</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span>  <span class="co">// Acceptの仕様は安定しているので</span></span>
<span id="cb146-18"><a href="#cb146-18" aria-hidden="true" tabindex="-1"></a>                                                            <span class="co">// NVIは使わない。</span></span>
<span id="cb146-19"><a href="#cb146-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb146-20"><a href="#cb146-20" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span> <span class="va">pathname_</span><span class="op">;</span></span>
<span id="cb146-21"><a href="#cb146-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb146-22"><a href="#cb146-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-23"><a href="#cb146-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> File <span class="kw">final</span> <span class="op">:</span> <span class="kw">public</span> FileEntity <span class="op">{</span></span>
<span id="cb146-24"><a href="#cb146-24" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb146-25"><a href="#cb146-25" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> FileEntity<span class="op">::</span>FileEntity<span class="op">;</span></span>
<span id="cb146-26"><a href="#cb146-26" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span> Accept<span class="op">(</span>FileEntityVisitor<span class="op">&amp;</span> visitor<span class="op">)</span> <span class="at">const</span> <span class="kw">override</span> <span class="op">{</span> visitor<span class="op">.</span>Visit<span class="op">(*</span><span class="kw">this</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb146-27"><a href="#cb146-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb146-28"><a href="#cb146-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-29"><a href="#cb146-29" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Dir <span class="kw">final</span> <span class="op">:</span> <span class="kw">public</span> FileEntity <span class="op">{</span></span>
<span id="cb146-30"><a href="#cb146-30" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb146-31"><a href="#cb146-31" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> FileEntity<span class="op">::</span>FileEntity<span class="op">;</span></span>
<span id="cb146-32"><a href="#cb146-32" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span> Accept<span class="op">(</span>FileEntityVisitor<span class="op">&amp;</span> visitor<span class="op">)</span> <span class="at">const</span> <span class="kw">override</span> <span class="op">{</span> visitor<span class="op">.</span>Visit<span class="op">(*</span><span class="kw">this</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb146-33"><a href="#cb146-33" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb146-34"><a href="#cb146-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-35"><a href="#cb146-35" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> OtherEntity <span class="kw">final</span> <span class="op">:</span> <span class="kw">public</span> FileEntity <span class="op">{</span></span>
<span id="cb146-36"><a href="#cb146-36" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb146-37"><a href="#cb146-37" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> FileEntity<span class="op">::</span>FileEntity<span class="op">;</span></span>
<span id="cb146-38"><a href="#cb146-38" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span> Accept<span class="op">(</span>FileEntityVisitor<span class="op">&amp;</span> visitor<span class="op">)</span> <span class="at">const</span> <span class="kw">override</span> <span class="op">{</span> visitor<span class="op">.</span>Visit<span class="op">(*</span><span class="kw">this</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb146-39"><a href="#cb146-39" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb146-40"><a href="#cb146-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-41"><a href="#cb146-41" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> PathnamePrinter1 <span class="kw">final</span> <span class="op">:</span> <span class="kw">public</span> FileEntityVisitor <span class="op">{</span></span>
<span id="cb146-42"><a href="#cb146-42" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb146-43"><a href="#cb146-43" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span> Visit<span class="op">(</span>File <span class="at">const</span><span class="op">&amp;)</span> <span class="kw">override</span><span class="op">;</span></span>
<span id="cb146-44"><a href="#cb146-44" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span> Visit<span class="op">(</span>Dir <span class="at">const</span><span class="op">&amp;)</span> <span class="kw">override</span><span class="op">;</span></span>
<span id="cb146-45"><a href="#cb146-45" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span> Visit<span class="op">(</span>OtherEntity <span class="at">const</span><span class="op">&amp;)</span> <span class="kw">override</span><span class="op">;</span></span>
<span id="cb146-46"><a href="#cb146-46" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb146-47"><a href="#cb146-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-48"><a href="#cb146-48" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> PathnamePrinter2 <span class="kw">final</span> <span class="op">:</span> <span class="kw">public</span> FileEntityVisitor <span class="op">{</span></span>
<span id="cb146-49"><a href="#cb146-49" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb146-50"><a href="#cb146-50" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span> Visit<span class="op">(</span>File <span class="at">const</span><span class="op">&amp;)</span> <span class="kw">override</span><span class="op">;</span></span>
<span id="cb146-51"><a href="#cb146-51" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span> Visit<span class="op">(</span>Dir <span class="at">const</span><span class="op">&amp;)</span> <span class="kw">override</span><span class="op">;</span></span>
<span id="cb146-52"><a href="#cb146-52" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span> Visit<span class="op">(</span>OtherEntity <span class="at">const</span><span class="op">&amp;)</span> <span class="kw">override</span><span class="op">;</span></span>
<span id="cb146-53"><a href="#cb146-53" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb147"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/visitor.cpp 219</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> PathnamePrinter1<span class="op">::</span>Visit<span class="op">(</span>File <span class="at">const</span><span class="op">&amp;</span> file<span class="op">)</span> <span class="op">{</span> <span class="bu">std::</span>cout<span class="op"> &lt;&lt;</span> file<span class="op">.</span>Pathname<span class="op">();</span> <span class="op">}</span></span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> PathnamePrinter1<span class="op">::</span>Visit<span class="op">(</span>Dir <span class="at">const</span><span class="op">&amp;</span> dir<span class="op">)</span> <span class="op">{</span> <span class="bu">std::</span>cout<span class="op"> &lt;&lt;</span> dir<span class="op">.</span>Pathname<span class="op">()</span> <span class="op">+</span> <span class="st">&quot;/&quot;</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> PathnamePrinter1<span class="op">::</span>Visit<span class="op">(</span>OtherEntity <span class="at">const</span><span class="op">&amp;</span> other<span class="op">)</span> <span class="op">{</span> <span class="bu">std::</span>cout<span class="op"> &lt;&lt;</span> other<span class="op">.</span>Pathname<span class="op">()</span> <span class="op">+</span> <span class="st">&quot;(o1)&quot;</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> PathnamePrinter2<span class="op">::</span>Visit<span class="op">(</span>File <span class="at">const</span><span class="op">&amp;</span> file<span class="op">)</span> <span class="op">{</span> <span class="bu">std::</span>cout<span class="op"> &lt;&lt;</span> file<span class="op">.</span>Pathname<span class="op">();</span> <span class="op">}</span></span>
<span id="cb147-8"><a href="#cb147-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> PathnamePrinter2<span class="op">::</span>Visit<span class="op">(</span>Dir <span class="at">const</span><span class="op">&amp;</span> dir<span class="op">)</span> <span class="op">{</span> <span class="bu">std::</span>cout<span class="op"> &lt;&lt;</span> find_files<span class="op">(</span>dir<span class="op">.</span>Pathname<span class="op">());</span> <span class="op">}</span></span>
<span id="cb147-9"><a href="#cb147-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> PathnamePrinter2<span class="op">::</span>Visit<span class="op">(</span>OtherEntity <span class="at">const</span><span class="op">&amp;</span> other<span class="op">)</span> <span class="op">{</span> <span class="bu">std::</span>cout<span class="op"> &lt;&lt;</span> other<span class="op">.</span>Pathname<span class="op">()</span> <span class="op">+</span> <span class="st">&quot;(o2)&quot;</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb147-10"><a href="#cb147-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-11"><a href="#cb147-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Printer <span class="op">{</span></span>
<span id="cb147-12"><a href="#cb147-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb147-13"><a href="#cb147-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="dt">void</span> PrintPathname1<span class="op">(</span>FileEntity <span class="at">const</span><span class="op">&amp;</span> file_entity<span class="op">)</span></span>
<span id="cb147-14"><a href="#cb147-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb147-15"><a href="#cb147-15" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> visitor <span class="op">=</span> PathnamePrinter1<span class="op">{};</span></span>
<span id="cb147-16"><a href="#cb147-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-17"><a href="#cb147-17" aria-hidden="true" tabindex="-1"></a>            file_entity<span class="op">.</span>Accept<span class="op">(</span>visitor<span class="op">);</span></span>
<span id="cb147-18"><a href="#cb147-18" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb147-19"><a href="#cb147-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-20"><a href="#cb147-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="dt">void</span> PrintPathname2<span class="op">(</span>FileEntity <span class="at">const</span><span class="op">&amp;</span> file_entity<span class="op">)</span></span>
<span id="cb147-21"><a href="#cb147-21" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb147-22"><a href="#cb147-22" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> visitor <span class="op">=</span> PathnamePrinter2<span class="op">{};</span></span>
<span id="cb147-23"><a href="#cb147-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-24"><a href="#cb147-24" aria-hidden="true" tabindex="-1"></a>            file_entity<span class="op">.</span>Accept<span class="op">(</span>visitor<span class="op">);</span></span>
<span id="cb147-25"><a href="#cb147-25" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb147-26"><a href="#cb147-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>上記クラスの関係は下記のようになる。</p>
<p>
<img src="data:image/png;base64,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" />
</p>
<p>このリファクタリングには、</p>
<ul>
<li>FileEntityのインターフェースを小さくできる</li>
<li>FileEntityVisitorから派生できるアルゴリズムについては、
FileEntityのインターフェースに影響を与えずに追加できる (「<a
href="#SS_1_2">オープン・クローズドの原則(OCP)</a>」参照)</li>
</ul>
<p>という利点がある。
一方で、この程度の複雑さの(単純な)例では、Visitorの適用によって以前よりも構造が複雑になり、
改悪してしまった可能性があるため、デザインパターンを使用する場合には注意が必要である。</p>
<p>なお、上記の抜粋である下記コード</p>
<div class="sourceCode" id="cb148"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/visitor.h 39</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">virtual</span> <span class="dt">void</span> Accept<span class="op">(</span>FileEntityVisitor<span class="op">&amp;</span> visitor<span class="op">)</span> <span class="at">const</span> <span class="kw">override</span> <span class="op">{</span> visitor<span class="op">.</span>Visit<span class="op">(*</span><span class="kw">this</span><span class="op">);</span> <span class="op">}</span></span></code></pre></div>
<p>はコードクローンだが、thisの型が違うため、
各Acceptが呼び出すFileEntityVisitor::Visit()も異り、単純に統一することはできない。
これを改めるためには、「<a href="#SS_2_21">CRTP(curiously recurring
template pattern)</a>」が必要になる。</p>
<p>次に示すソースコードはVisitorとは関係がないが、
FileEntityVisitorから派生するクラスを下記クラス図が示すように改善することで、
単体テストが容易になる例である(「<a href="#SS_2_11">DI(dependency
injection)</a>」参照)。</p>
<p>
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAXcAAAG3CAIAAADASoIdAAAAKnRFWHRjb3B5bGVmdABHZW5lcmF0ZWQgYnkgaHR0cHM6Ly9wbGFudHVtbC5jb212zsofAAABPmlUWHRwbGFudHVtbAABAAAAeJytUcFOwkAQve9XzMm0hxJp0BgOhiigITQ2FrgvZSwb21myO4sh6r+7BZpIiRd1b+/Nm/dmdgaWpWFXlSIvpbUwViWOiBXvFsoq1gbeBfi3R0FdvQi/EUNlTvATr9Ec+j3/KY6uM/QxyxJTo4ix8WyxgbZsUFYnhr9NTCWvSVaNd/df1miZxn80bf9K5DbRx+35CcTZMkdly6Cti3/SDZBW9clFWkrieTKFLRqrNEG3E1/GvU5viSyvgjm9kn4jyHW18UMBqwpDETykU7DamRxhpfzN1NKxbw7FRG4lPDuqdX2oUTBLQshGDQkj2iqjqUJiMVkkBxE8as42mvfi6150pxgyNH4mWCRiiC/Slexbc71SVPRhPhtHN2IqqXCy8EFI4l77ALPztUx8ATwa7GCooJDsAABK7ElEQVR4Xu2dCVQVR7r42RXjhssTUTBR8QVBkE1mEBRRY0x0MklwwZdl8txiRtRIwuL2XCEENUKMiAEBd5BF4oIGFGP+x4ko4oJifKImKGEiLjc5M5lkJsn/C/WoKav79r0X+vZd+vudezjdVV9XV/et/nXV7XsLm18RBEGMiQ2fgCAIIitoGQRBjAtaBkEQ44KWQRDEuKBlEAQxLmgZBEGMC1pGfiorK9euXbsOsUCSkpLWr1+v0Wj4NxVpB2gZmSkqKiooKNAgFktDQ8PGjRv59xVpB2gZmXnvvff4ZotYGvAm8u8r0g7QMjKDlrEC0DLygpaRGbSMFYCWkRe0jMzotMyjR4/KjpXNj40ZOSbMy8fL1dX1aR+v348OnbNobuHhovsPH/AbIIqDlpEXtIzMSFvm0OFDoaNGBo0MnhU/d0NBWvbxvKKLn8BfWIaUoNDgEWEhO4t2PdI84rdEFAQtIy9oGZnRZpkHDx4sfmexX6Df8i2rwCzaXpA7LND3v2Nm3bt/jy8CUQq0jLygZWRG1DKgmCnTpoydPH73X/KFZuFeEDN28rhnX3zu3v1mviBEEdAy8oKWkRlRy7wT9874Pzyzv+aA0CmiL4gE0cyMmcUXhCgCWkZe0DIyI7RMWVmZf1DArtO6ezHsC+Jh6LS3ZB9XmjYOHz5sY2Nz8+ZNblkZjLRHncXqDGgbaBl5QcvIDGeZR48eRYyJWCH4LKawpnTe/8wf6DXI3sHe0clx0NDBPsHDhgZ6szHLt6wKCf/dw0cP2QLJdcUyb948SL93797169dhdzRG57UnLAo4e/YsH/c4ZKuvv/6aTRTunQsQZeLEiaNGjeISq6qqYPOSkhLN48WK0rb96gQtIy9oGZnhLFNRUREaHsor5kJpxORIuCTAL14B3k8P9wLXwGqnzp24yKCRwQfKStkCybV05syZ663cvXuXDaAxelqGLQp48EDHo3SdF7POAMqePXtsbW0vX77MJsbExLi7uz98+Jhb9UH//Ypy//59uoyWkRe0jMxwlklMTPzzkhjOHbGp8XA9DPAcsO3T7SQl82h2j//oKbTM7Pi5b779FlugNoOw6VxMSkrK4MGDHR0d3dzc4uLiqEe0FUWzoEPh5+fn5OTk7+9/7tw5kmXzOGw8KUoYsGTJEi8vr9ayfyMkJGTu3LlwYffp0yc+Pp6mNzc39+7dG+LJKlvspk2b+vXrZ29v37dv36SkJGGAcL+aFne88847cOBw+HASPvzwQ5JOty0sLAwICIDc/Px8moWWkRe0jMxwlhk3btyGgjTOHYHhQdC+1+WlsIkzE+ZMmDKRi9yQnzYyYiRboDY1aLNMQkKCp6cnXEt1dXWlpaUeHh6xsbHCTThIFrgA+mIwhgoODg4LCyNZu3btgqzq6mrS92HjSVHCANg12OHEiRMkGIQFAadPn4blRYsW9e/fn/ZcYFs7O7urV69yxUJ/B3o9K1eurK2tPXny5L59//dxlfR+gVmzZvXq1Qvir1y5kp6e3qFDh48++ojddtiwYbAAxbLnAS0jL2gZmeEs4+vrm31iB+eO/gPdoX0XVJdw6cIXbOvl81gvgFwbnRjg+qHpnGWampqcnZ3Ly8vp5tnZ2S4uLtqKgns+m3Xo0CGympub6+DgQMYUJIsbmAj3zgVMmDDhjTfeIMtgFugckeXz58/btH4KAzzzzDPgZbKsYYoFs9i0iolFer8NDQ3QScnMzKQpsGtwLlkm8VRYLGgZeUHLyAxnGXcPd6FN3J7sB+27sKZUqBXuBdv2d+/PFkiujcrKyppW2IufswyEcR7p2LEjpDQ2NooWdenSJXYvN27cYFfhoqXLhlpmz549Xbt2BevBeM3V1fWDDz6gWdBLeumll2Dh2rVr0OXZsWMHzaLFwjHCuAZKmDZtWl5enuigT7jf48ePQwqxMGH//v2Q8u2339J42CnNpaBl5AUtIzPCvsz2yp2cO7wCvKF9p5V8JNQK94K+zFCfoWyB7HWlLZ0uk8vs6NGj1CMEMkLRVpQwi72AhRczFy8aAJoAuWzbtg36DtC9unPnDs2CvgYMZG7fvr1ixQoY3TQ3//u7iGyxkJ6fnz979uzu3btPmjRJGCDcrz6WET18tIy8oGVkRvi5zJbiTM4dc5bOg/Y9xPc/P67IJSmFF0rfXPHnp54emPvZbjZyQ35aeEQ4W6C2a0N4vcEy9Fmg85KVlcUFE7QVJcxiL+CysjJYBiloixcNABYvXhweHg6CiI6OZtOhgwOdlJSUlKeeeiomJobNEq0h9GUgEbbiAoT7BZcJR0xDhgwhy6KFE9Ay8oKWkRnhM6Z3/yees8z+mgO/Hz8Smri9gz24ZnhoQF8PN1jt2afXrtP72MjZ8XMXxy1mC9R2bYhaRtNSARcXF7jSamtroReTk5PDPcHhnmTfu/fb76ckLANdA1jesmVLfX09F0BWRQOAixcv2tnZOTg4HDlyhCYSZs6cCT0U2KqqqopNp8WeOHEiNTX17NmzcAjTp093c3MTfjNIdL/Q9+nduzd0gq5evfrhhx8KP/0VnkkNWkZu0DIyI/y+zKjRo4ovHeREU1hTOn/1wqeHe3Xo2MHW1rZX394Tpk4kP9FmXyNG/vaUhy1Q27WhzTJAWlqat7e3k5NTp06dAgMD09PT2U04ioqKhCWwlgGWL18Owx9Qho3Yk2zRAAL0ZQYNGsSmEE6dOmXT8kiLS6fFgn1g286dO0PfJCgoiD6u0rlfGKnFxsbSJ9n02IXbsqBl5AUtIzOcZeCWGxkZ+cF2/mG2Pq/lW1aNihgl8c1Xi8PT03PVqlV8qvmBlpEXtIzMcJbRtHxeMCJkRMEZ/kmT9GvX6Xz/IH/YlivNQoFRzIYNG5ydnelzK3MGLSMvaBmZEVoGiI+Pfynq5eIL/LhJ22t/zYFnXpgQFxfHF2SxwNikZ8+eGRkZfIZZgpaRF7SMzIha5sGDB9HR0S9HvVxYpfs7Mrv/kv/sHydOj56u8ydFiJFAy8gLWkZmRC2jaREN9Ghg6JSeu7nk0iGhXMhrdWZSYHBgXPy/f22EKA9aRl7QMjKjzTKEsrKyMWPGjI4YnbhySfYnubs+yz9w6VBe5e4txZlvL18cNioMcq3msxjLBS0jL2gZmZG2jKblqVNFRUViYuL48eP9/PxcXV3hLyxDCqRb0xMlywUtIy9oGZnRaRnE/EHLyAtaRmbQMlYAWkZe0DIyg5axAtAy8oKWkRm0jBWAlpEXtIzMQAPNyclZh1gsubm5aBl5QcvIDPZlrAC0jLygZWQGLWMFoGXkBS0jM2gZKwAtIy9oGZlBy1gBaBl5QcvIDFrGCkDLyAtaRmbQMlYAWkZe0DIyg5axAtAy8oKWkRn8voylg9+XkR20jMxgX8YKQMvIC1pGZtAyVgBaRl7QMjKDlrEC0DLygpaRGbSMFYCWkRe0jMygZawAtIy8oGVkpm2Wkfg/hwSdAcDSpUunTp3Kpz6OxL+gbDN+fn47duzgUy0ZtIy8oGVkRtQyEydOHDVqFJdYVVUFF3lJSQks37t37/r16xKT/rIB3P+TJdy+fbtLly5nz54lq8L/Tjtv3jzRcvSxTGZmpqenp729fY8ePSZPnnz//n02d+fOnUOGDJGovMWBlpEXtIzMiFpmz549tra2ly9fZhNjYmLc3d0fPnzIJuqDqGVWr149YsQIukpizpw5c72Vu3fvMuH/jtFpmfPnz0Pl58+ff/HixS+++GLjxo2cZcBc3bt3J7q0DtAy8oKWkRlRy8Bl2adPn/j4eJrS3Nzcu3fvJUuWkFX2gt+0aVO/fv2g49C3b9+kpCRhANtDsWn9t/MwbGH/BbU2g0iMmFJSUgYPHuzo6Ojm5hYX9+9/CAVygcrU1NTQQoRERUW9+uqrfKrFgpaRF7SMzIhaBli0aFH//v1pz2XXrl12dnZXr14lq/SCh/4OdBxWrlxZW1t78uTJffv2cQFkW1iurq4mnRRIgX4KbHXw4EESzMWzaLNMQkICjIkKCwvr6upKS0s9PDxiY2PJJjAUCg8PDw0NvXPnDlsUS3Jy8pNPPsmnWixoGXlBy8iMNsvAuMOm9VMY4Jlnnhk3bhzNpRc8mAUWTp8+TbO4ALrMjpg+//xzSGG7GySmE8OVK1dEy4HlpqYmZ2fn8vJyunl2draLiwtZBt2MGTMmPT3dx8eHanH//v1QJv0sBsQHmoMOGlm1dNAy8oKWkRltlgHCwsJeeuklWLh27RqMQdjnMvSCh7FVQEBA165dp02blpeXR4ctQjuwlikrK4MU0q9h4ysrK2taIR+mCMuBZQjjlNSxY0dIaWxsvH37tpOT09GjRyF+/fr1MIg7deoULMNYb+zYsXR30P2B+K+++oqmWDRoGXlBy8iMhGUyMzM7dOgA1+2KFSt69erF3vnZix/S8/PzZ8+e3b1790mTJgkDhJYhfRnoLtEUNp5FWA4sHz9+HBZAJVRJBBjfVVRUQNaXX35JNl+7di04CPTn7u6em5tLi8W+DCIBWkZmJCwDAxPopKSkpDz11FMxMTFslqgU4GKGRNiKCyA9F7AVjSSfy0CHgqaIFsil02Xos0DnJSsriwsG6urqIGb79u00ZdmyZZACoyf20XVSUhJ+LoNoAy0jMxKWAWbOnAk9FLhKq6qq2HR6wZ84cSI1NfXs2bPQlZg+fbqbm5vwuy1XrlyB5S1bttTX11OP+Pr6QhdJWCBNEaazy4mJiS4uLtDbqq2thV3n5OTQ519QjW7dukEW7BeqN3nyZOjOQKcMZEeLffnll1955RW6aumgZeQFLSMz0pY5deoUXNghISFcOr3gwT7h4eGdO3d2dHQMCgqCq5oLIKvLly93dXW1s7OzaX2SvWrVqsDAQLIsjBdN52LS0tK8vb2dnJxAIlBUeno6SYdxEDjIw8PDwcEBrDdnzhywW3R0NFjp3LlzmtbvyxQXF7fuxOJBy8gLWkZmpC1jPG7dugVuOnPmDJ9hfHbu3Onp6Ynf/UW0gZaRGVNZRtPy3GfKlCl8qvHx8/PLy8vjUy0ZtIy8oGVkxoSWQeQCLSMvaBmZQctYAWgZeUHLyAxaxgpAy8gLWkZm2mYZbY+EKDoDNPrNL0PRp0AJrG9OGRa0jLygZWRG1DImnF/G1ta2a9euAQEB4CB28gede1TbnDIsaBl5QcvIjKhlTDu/THV19fbt2319fQcOHFhfX89sJA4IRYVzyrCgZeQFLSMzopYxh/llmpqaoG8yc+ZMYQBZLiwshC6Po6Njfn6+CueUYUHLyAtaRmZELaMxj/llkpOTXV1dhQFkediwYbAA+4VEFc4pw4KWkRe0jMxos4xJ5pfhLFNUVASJMNjhAsgyNZpGlXPKsKBl5AUtIzPaLKMxxfwynGVgTCRhGagVCVPnnDIsaBl5QcvIjIRlTD6/zLp160AZwgAuWJ1zyrCgZeQFLSMzEpYx7fwy5NPfWbNmCQO4YHXOKcOClpEXtIzMSFhGo/j8MuRJNvRxcnJyuCfZEpbRqHJOGRa0jLygZWRG2jIKzy9j0/KtvC5duvj7+y9ZsoR9YCRtGRXOKcOClpEXtIzMSFvGeCg8v4z1zSnDgpaRF7SMzJjKMhpl55exvjllWNAy8oKWkRkTWgaRC7SMvKBlZAYtYwWgZeQFLSMzaBkrAC0jL2gZmUHLWAFoGXlBy8hM2ywjfJbMoTNAY+AsVqLosxeFMV6VJCbiQsvIC1pGZkQto/wsVkBtbe2MGTP69Onj6Og4YMCAhQsXCr8vwxUi1yVNv63DwtZNFNEq6TxwCdo8ERdaRl7QMjIjahnlZ7E6f/58z549n3vuufLy8itXrhQXFw8fPtzHx+ebb74hAaKFyGIZuJhJOeSbxxT6y09tiFaJRWcAS3sm4kLLyAtaRmZELaP8LFaRkZERERHsjbqxsdHDw+Ptt98mq6KFkL3AhQelOTk5+fv7k2/6ElJSUgYPHgw9Izc3t7i4OO734uwkWBK2ktjF4zV6rEraDhxOoJeXV2vZvxESEjJ37lxYaM9EXGgZeUHLyIyoZTTKzmJ169YtWIXLnqxSQEPQeyLLwkI0rXuBC7WiogIGOMHBwWFhYSQrISEBRh9QZl1dXWlpKQgrNjaW3YqdBEunZUR3IVElbQcOlQGV0N9hgLBsWmfnac9EXGgZeUHLyIw2yyg5i9Xx48dhFa5AGkAQzi8jOmI6dOgQWc3NzXVwcICOWFNTk7OzMwy+aGR2draLiwu7FTsJFknpxADdHzZLuAuaJVolbQcOTJgw4Y033iDLoHLoHJHl9kzEhZaRF7SMzGizjEbBWazaaZkbN26wqw0NDZWVlZw1OnbsCCkwCqNhdBIsmgJb1bRy6dIl6V3QZdEqaTtwTctnXnC6wINwrlxdXT/44ANNuyfiQsvIC1pGZiQso9gsVmTEBPdtGkBgR0zCQmgiHenQGKItuGipNQhkAMhtJZqiLYuths4qiQaAl0Eu27Ztg84UdLjI+KidE3GhZeQFLSMzEpZRchariBYkPv0VFqIRVINe1bAtdF6ysrLYYIqw8sIUbVmsOHRWSTQAWLx4cXh4OBg5OjqapLRzIi60jLygZWRGwjIaBWexOnfuXI8ePZ5//vny8vKrV68eOHDA39+ffZItWoiEAhITE11cXKA7VltbC3XLyckRfUDGpnBPsoXzDdNVsgudVRIN0LQ8TrKzs3NwcDhy5AhNbM9EXGgZeUHLyIy0ZRSbxQq4dOkSXGm9e/eGomCksGDBAu5pi7AQCQUAaWlp3t7eTk5OcLnCvtLT00W3oikcRUVFwmBuFzqrJAwgwEkbNGgQm9KeibjQMvKClpEZacsYD4VnsTI3PD092a8L6YPERFxoGXlBy8iMqSyjUXYWK/MBeigbNmxwdnamz630RGIiLrSMvKBlZMaEllEnMHTq2bNnRkYGn9EO0DLygpaRGbSMFYCWkRe0jMysXbuWb7OIpZGSksK/r0g7QMvIzN69ewsKCvhmi1gODQ0NGzdu5N9XpB2gZeSnsrJy3bp1SdbLf/3Xf/FJ1kJycvL69evBNfybirQDtAxiGN99992QIUPgL5+BIFpAyyCGUVhY6OrqCn/5DATRAloGMYzXX389Ojoa/vIZCKIFtAxiAGS41NjYiIMmRH/QMogBwECJ9GLgLw6aED1ByyAGQOVCdYMgOkHLIPrCPl3CJ02I/qBlEH3h+i84aEL0BC2D6AunFRw0IXqClkH0QjhEEqYgiChoGUQvRHsuOGhC9AEtg+iFqFBE1YMgHGgZRDfaBkfa0hGEBS2D6EaizyLax0EQFrQMohsJlUgICEEIaBlEB9LDIulcBPkVLYPoRGdvRaKngyC/omUQneiUiE4NISoHLYNIAUOhAQMGuOoCYnDQhGgDLYMYDGiFT0IQ7aBlEINByyAGgZZBDAYtgxgEWgYxGLQMYhBoGcRg0DKIQaBlEINByyAGgZZBDAYtgxgEWgYxGLQMYhBoGcRg0DKIQaBlEINByyAGgZZBDAYtgxgEWgYxGLQMYhBoGcRg0DKIQaBlEINByyAGgZZBDAYtgxgEWgYxGLQMYhBoGcRg0DKIQaBlEINByyAGgZZBDAYtgxgEWgYxGLQMYhBoGcRg0DKIQaBlEINByyAGgZZBDAYtgxgEWgYxGLQMYhBoGcRg0DKIQaBlEINByyAGgZZBDAYtgxgEWgYxGLQMYhBoGcRg0DKIQaBlEINByyAGgZZBDAYtgxgEWgYxGLQMYhBoGcRg0DKIQaBlEINByyAGgZZBDAYtgxgEWgYxGLQMYhBoGcRg0DKIQaBlEINByyAGgZZBDAYtgxgEWgYxGLQMYhBoGcRg0DKIQajdMg8fPnz//feTkpLWIYjROHXqFN/y1ITaLZOamtrQ0KBBEGNSWFiYn5/PNz7VoHbLwH2GbxEIYgSSk5P5xqca0DJoGUQJ1q9fzzc+1YCWQcsgSoCWUS8KW+bRo0cHjpS++fZboRGhXj5erq6u8Dc0YuS8t986ePQg5PIbINYCWka9KGmZ/Z8UhoT/Lig0eFb83A0FadnH84oufgJ/YRlSIP134b8r/qSY3wyxCtAy6kUZyzx48GDeord8A32Xb1kFZtH2glyImb94PsTzRSAWDlpGvShgGVDGH6JeGDt53O6/5AvNwr0gBiL/GPVHFI2VgZZRLwpYBvomII79NQeEThF9QSTEL4xdyBeEWDJoGfVibMscPHzQN9Bv12ndvRj2BfGw1eHDh/nizAaom42Nzc2bN/mMFqRz24YxylQStIx6MaplHj16NHL0SOFnMYU1pfP+Z/5Ar0H2DvaOTo6Dhg72CR42NNCbjYGtwkaHSz91stEOH6oH5DL++uuv+QwxpK956VwKCSN07949Kiqqvr6eD2rl3r17169flz4hGgOPQknQMurFqJapqKgIHjmCV8yF0ojJkXAlgF+8AryfHu4FroHVTp07cZEjwkKgBL5Qhuut7Nq1C0qorq6mKXyoHhh0fUp7RDqXQsLOnDkDFYYj9fLyGj9+PB/Uwv379/kkLRh0FEL035GhoGXUi1Ets/jdxbPj53LuiE2Nh8tggOeAbZ9uJymZR7N7/EdPoWVg23fj3+ULFUPbpZWSkjJ48GBHR0c3N7e4uDj6ifKmTZv69etnb2/ft2/fpKQkkvh/nYpWSGJGRoaPj4+Tk1O3bt2mTp1Kd0H2WFpaOmLEiA4dOvTv3z81NZVk0VxqGW3V4MLy8vKgSs3NzTSrsLAwICAANszPz2eDyXJJSYmfnx/Uzd/f/9y5c6QQ9hBsmD6ddB3YHdFN5AUto16MapnRkaM35Kdx7ggMD4JmvS4vhU2cmTBnwpSJXCRsGxEZwRcqhqhlEhISPD094fqpq6sDHXh4eMTGxkL65cuXbW1tV65cWVtbe/LkyX379pF4rkNEEjMzMw8ePHj16lXYxdChQ6dNm0bSyR4HDhwIm1+5ciU9PR1c89FHH7G5xAjaqsGFAXv37oWKffvttzRr2LBhsAD1hBihZUJCfuvrnT17Njg4OCwsjBQiehQ668DuiKTLDlpGvRjVMt7DvLNP7ODc0X+gOzTrguoSLl34gm19hvnwhYohtExTU5Ozs3N5eTlNyc7OdnFxgQUwCwSfPn2aZhGEhXDs3r27U6dO5JMREgwOormLFi0aMmQIWaZGkKgGGwbL8BdMAb5gs6gBuWCyfOjQIZKVm5vr4OBABjvCo9CnDuyOjARaRr0Y1TLu7u5Cm7g92Q+adWFNqVAr3Au2hRL4QsUQXlqVlZWQ0omhY8eOkNLY2AhXI4wOunbtCh0TGKRwYwfOMseOHRs9enSvXr2eeOIJUsLdu3dpMPRiaOT+/fshhe2JgBEkqkHDSDr0YmDgA30QUhrJunbtGi1faJkbN26wWWQGD+FR6FMHdkdGAi2jXoxqGeiJCPsyXgHe0KzTSj4SaoV7wbbDfIfxhYohvLSOHz8OKUePHq15nIcPH0Juc3Nzfn7+7Nmzu3fvPmnSJG2FwHLnzp1nzJgBHYHz589v3bqVBpBgGEnRYFHLSFeDhIEFLly4cOvWLVoUW4JoCpfL1lx4FPrUwXgDJQpaRr0Y1TJjxo4Rfi4zZ+k8aNZDfP/z44pcklJ4ofTNFX9+6umBuZ/tZiNh28ixY/lCxRBeWnCjhjt2VlYWEyUC9GVgQxhTwHJZWRks3759m+Z++umnrErWrFnDXczbtm2jwaIjJulqSFzhwiw9LSM8ijbXQV7QMurFqJZJSEx4M/EtzjL7aw78fvxIaNn2DvbgmuGhAX093GC1Z59eu07vYyP/vCQmMTGRL1QMoWUA2NbFxSUzM7O2thZu3Tk5OUuWLIH0EydOpKamnj17FhKnT5/u5uZGPmqB4Q8UsmXLlvr6enLVwTjC3t5+4cKFly9f3r17d79+v431WMsMGjSooKAANLR582a4kj/88EOya/bS1VYNLoxDmKWnZYRHoWlrHeQFLaNejGqZioqK34eHcpYpavlW3vzVC58e7tWhYwdbW9tefXtPmDqR/ESbfY0cNVL6+zIUUcsAaWlp3t7eTk5OnTp1CgwMTE9Ph8Sqqqrw8HAYCjk6OgYFBYF0aPzy5ctdXV3t7OxsWp8Bgz4gBQwyevTojIwMzjIlJSVQQocOHUBAKSkptBzu0hWthjCMRZilp2U0YkehaVMd5AUto16MahnoI4yJHLMyY41QNDpfq7cmRUZG6vyqK2IpoGXUi1Eto2n5mCAwOMjQ3zHt/kt+0Igg2JYvDrFY0DLqxdiWAeLj459/cZJBv8me/NIfYCu+IMSSQcuoFwUs8+DBg+jo6MkvTd79lwKhU7jXnr/sf+HlFyAe55exMtAy6kUBy2haRAN9k+ARwe99nCo0C329n7UeYiASFWN9oGXUizKWIZSVlY0ZMyZ89Kh3VsRtLf5412e/PbfedXJfZknWuyviRo0eBbn4WYy1gpZRL0paRtPy1KmioiIxMXH8+PF+fn6urq7wF5YhBdLxiZIVg5ZRLwpbBlEtaBn1gpZBlAEto17QMogyoGXUC1oGUQa0jHoBy+Tk5KxDEGOSm5uLllEv67AvgygCWka9oGUQZUDLqBe0DKIMaBn1gpZBlAEto17QMogyoGXUC1oGUQa0jHpByyDKgJZRL+vw+zKI8cHvy6iaddiXQRQBLaNe0DKIMqBl1AtaBlEGtIx6QcsgyoCWUS9oGUQZ0DLqxawsI/1/DqVz24YxytTG0qVLp06dyqdaEX5+fjt27OBTW0HLqBehZWy0w0Xqg7b/LSuK9DUvnUshYYTu3btHRUXV19fzQa3cu3fv+vXrOucbNugoRLl9+3aXLl3Onj3LZ+hH+ysgC5mZmZ6envb29j169Jg8efL9+/fZ3J07dw4ZMkTbyUTLqBehZa63smvXLmjZ1dXVNIWL1AeDLg9pj0jnUkjYmTNnoMIVFRVeXl7jx4/ng1rgLhIJDDoKIbCj1atXjxgxgs/QG30qoP/htI3z58/b2trOnz//4sWLX3zxxcaNG7k9grJB6yUlJWwiBS2jXoSWoWhr2SkpKYMHD3Z0dHRzc4uLi6P/O2nTpk39+vWDG13fvn2TkpJIYmuv4v8giRkZGT4+Pk5OTt26dYNBBN0F2WNpaSlckB06dOjfv39qairJornUMtqqwYXl5eVBlZqbm2lWYWFhQEAAbJifn88Gk2W4SKDnD3Xz9/c/d+4cKYQ9BBumTyddB3ZHUOaqVavohnB9vvPOO7AV5EIJH374Ic3S/zQK96LRXiXpc15cXDx8+HA450FBQRcuXDh+/DgcPqzCX5ALiQS5QK1qamrIqijQc3z11Vf51BbQMurFUMskJCRAnxladl1dHejAw8MjNjYW0i9fvgw3upUrV9bW1p48eXLfvn0knusQkUToeB88ePDq1auwi6FDh06bNo2kkz0OHDgQNr9y5Up6ejo09I8++ojNJUbQVg0uDNi7dy9U7Ntvv6VZw4YNgwWoJ8QILRMSEgI9IBjaBAcHh4WFkUJEj0JnHeiOyMmBQya5wKxZs3r16iU8TINOo/BwJKokfc7hYMvLy8GqcPigGzhwEA1ZHT16NImEoVB4eHhoaOidO3dIipDk5OQnn3yST20BLaNeDLJMU1OTs7MzNEeakp2d7eLiAgtwSUDw6dOnaRZBWAjH7t27O3XqRAbzJBiuB5q7aNEiGOqTZWoEiWqwYbAMf+GCgUuIzaKXLhdMlg8dOkSycnNzHRwcyKBAeBT61IHu6PPPP4dV2gtoaGiAvgZ3mGAHjYGnkduLdJVYhOecGhC6frBK//cerMJJIB0iENaYMWPAidAnAluRgP3799OiNC02BEuSniMHWka9GGSZyspKSOnE0LFjR0hpbGyEqxH67V27doWbJDRNbuzAXR7Hjh2DOyTczJ944glSwt27d2kw3N5pJDRiSGF7ImAEiWrQMJIOLR76/NAFIKWRrGvXrtHyhZa5ceMGmwVGoMt6ngoaT3cEFy2s0j4IdBO0HaZBp5Hbi3SVpM85d9S3b99mV+EkQAqMto4ePapp8QWM5k6dOgXLS5YsGTt2LAkGoAMF8V999RVNoaBl1ItBliGXBzS1msd5+PAh5MIdLD8/f/bs2d27d580aZK2QmC5c+fOM2bMgLsujPm3bt1KA0gwvU9qtFhGuhokDC65Cxcu3Lp1ixbFliCawuWyNRcehT51oEWRvgz9gEPCMhq9TyNNpHuRqJLOcy561OwqjCJh4csvvyTpa9euBYuBB93d3aHTRxI12JfRAlrGAMvAXRFug1lZWUyUCKTXDR14TettnN4bgU8//dSGUcmaNWu4Fr9t2zYaLDpikq6GUCUSWXpaRngUBtUBeg1w7cF9nqzeuXNHOGKih0mRPo0awV4kqqTznIseNbtaV1cHC9u3byfpwLJlyyAFRk/so+ukpCT8XEYIWsYAywCJiYkw1IcrpLa2Fu6TOTk50GeG9BMnTqSmpp49exYSp0+f7ubmRhof3LGhkC1bttTX15OmDD18e3v7hQsXXr58effu3f369eNa/KBBgwoKCuCS2Lx5M1w29PkLez1oqwYXxiHM0tMywqPQGFgHX1/fFStW0FXoqvTu3Rv6LHCYcID001/9T6NGbC/aqqTznIseNbcK9enWrRsUDpWBek6ePBm6M1Bz+iEO8PLLL7/yyit0lQUto14MtQyQlpbm7e0No3RoZIGBgenp6ZBYVVUVHh4O3XK4SwcFBUErpPHLly93dXW1s7OzaX0EC/qAFDDI6NGjMzIyuBZfUlICJUDzhYshJSWFlsNdD6LVEIaxCLP0tIxG7Cg0htRh1apVEEBX79+/HxsbS59k0w0NOo3CvWi0V0n6nGs7anYVxkFgMQ8PDwcHB6j5nDlzQHnR0dHgNfLIn3xfpri4mGzLgZZRLxKWQWTk1q1b4I4zZ87wGVbEzp07PT098bu/QtAyaBmFgMHLlClT+FQrws/PLy8vj09tBS2jXtAyiDKgZdQLWgZRBrSMekHLIMqAllEvbbCM6KMNFp0BGv0mW5F4ANRmpOdAQYwHWka9CC0zceLEUaNGcYlVVVU2Lc+YNXrMycIGcE9GCdxkKySGZd68eaLl6GOZ9syBghgPtIx6EVpmz549tra2ly9fZhNjYmLc3d3J1+cNQtQy3GQrJIbMCEMgP7Fh0dMy7ZwDBTEeaBn1IrQMXJZ9+vSJj4+nKc3Nzb179xb9YqvoZChsANtDsWn9Ohk32Yo2g0iMmLTNotLOOVAQ44GWUS9Cy2haflbTv39/2nPZtWuXnZ0d/RUMveC1TYbCGkE4MQr5UQ872YqhlpGYRaWdc6AgxgMto15ELQPjDpvWT2GAZ555Zty4cTSXXvDSk6GwdmBHTNxkKzSGnbKA/F5ZWM5NXZPLtHMOFMR4oGXUi6hlgLCwsJdeeknT+kM79rkMveClJ0PRZhlushUaU1lZSScrYOeO4iwjMYtK++dAQYwHWka9aLNMZmZmhw4d4LpdsWJFr1692Ds/e/FLTIaizTLcZCtcPIuwnJuSk8u0fw4UxHigZdSLNsvAwAQ6KSkpKU899VRMTAybJSoFdjIUNkA4MQo32QoXzyJqGYlZVNo/BwpiPNAy6kWbZYCZM2dCDwWu0qqqKjadXvDaJkNh7SA6MQo32YpBltFon0VF0+45UBDjgZZRLxKWOXXqlE3LnP5cOr3gtU2GwllDODEKN9mKoZbRaJ9FpZ1zoCDGAy2jXiQsYzxMONmK9BwoiPFAy6gXk1hGY7rJVqTnQEGMB1pGvZjKMojaQMuoF7QMogxoGfWClkGUAS2jXtAyiDKgZdRLGyyj7cEzRWeARr9ZrCj6FCgBzlxlDqBl1IvQMiacxcrW1rZr164BAQHgIHaKGZ17xJmrzB+0jHoRWsa0s1hVV1dv377d19d34MCB9fX1zEbigFBw5iqLAC2jXoSWMYdZrJqamqBvMnPmTGEAWS4sLIQuj6OjY35+Ps5cZRGgZdSL0DIa85jFKjk52dXVVRhAlocNGwYLsF9IxJmrLAK0jHoRtYxJZrHiLFNUVASJMNjhAsgyNZoGZ66yENAy6kXUMhpTzGLFWQbGRBKWgVqRMJy5ylJAy6gXbZYx+SxWUDFQhjCAC8aZqywFtIx60WYZ085iRT79nTVrljCAC8aZqywFtIx60WYZjeKzWJEn2dDHycnJ4Z5kS1hGgzNXWQhoGfUiYRmFZ7GyaflWXpcuXfz9/ZcsWcI+MJK2DM5cZRGgZdSLhGWMh8KzWOHMVeYAWka9mMQyGmVnscKZq8wBtIx6MZVlELWBllEvaBlEGdAy6gUtgygDWka9tMEywqc8HDoDNAbOLyOKPntRGONVyQqmyEHLqBehZZSfXwaora2dMWNGnz59HB0dBwwYsHDhQuGTbK4QuS5p+hydha2bKKJV0nngElj9FDloGfUitIzy88ucP3++Z8+ezz33XHl5+ZUrV4qLi4cPH+7j4/PNN9+QANFCZLEMXMykHPKdQAr9TZY2RKvEojOARQ1T5KBl1IvQMsrPLxMZGRkREcHeqBsbGz08PN5++22yKloI2QtceFCak5OTv78/+Q4eISUlZfDgwdAzcnNzi4uL437JyU5PI2EriV08XqPHqqTtwOEEenl5tZb9GyEhIXPnzoUFNUyRg5ZRL0LLaJSdX+bWrVuwCpc9WaWAhqD3RJaFhWha9wIXakVFBQxwgoODw8LCSFZCQgKMPqDMurq60tJSEFZsbCy7FTs9jU7LiO5CokraDhwqAyqh35AGYdm0zpuhhily0DLqRdQySs4vc/z4cViFK5AGEIQzP4iOmA4dOkRWc3NzHRwcoCPW1NTk7OwMgy8amZ2d7eLiwm7FTk9DUjoxQPeHzRLugmaJVknbgQMTJkx44403yDKoHDpHZFkNU+SgZdSLqGU0Cs4v007L3Lhxg11taGiorKzkrNGxY0dIgVEYDaPT09AU2KqmlUuXLknvgi6LVknbgWtaPvOC0wUehHPl6ur6wQcfaFQzRQ5aRr1os4xi88uQERPct2kAgR0xCQuhiXSkQ2OItuCipdYgkAEgt5VoirYstho6qyQaAF4GuWzbtg06U9DhIuMjlUyRg5ZRL9oso+T8MhEtSHz6KyxEI6gGvaphW+i8ZGVlscEUYeWFKdqyWHHorJJoALB48eLw8HAwcnR0NElRyRQ5aBn1os0yGgXnlzl37lyPHj2ef/758vLyq1evHjhwwN/fn32SLVqIhAISExNdXFygO1ZbWwt1y8nJEX1AxqZwT7KFM4HSVbILnVUSDdC0PE6ys7NzcHA4cuQITVTDFDloGfUiYRnF5pcBLl26BFda7969oSgYKSxYsIB72iIsREIBQFpamre3t5OTE1yusK/09HTRrWgKR1FRkTCY24XOKgkDCHDSBg0axKaoYYoctIx6kbCM8VB4fhlzw9PTk/26kD5YwRQ5aBn1YhLLaJSdX8Z8gB7Khg0bnJ2d6XMrPbGCKXLQMurFVJZRJzB06tmzZ0ZGBp+hAtAy6gUtgygDWka9oGUQZUhNTeUbn2pAy6yz6M8UEYvgxo0b27Zt4xufalC7ZT777LOCggK+UVgsVS3wqRbIxYsXhT8Qs1CuX7+emJj4448/8o1PNajdMkBRUVGqVTBr1qwBAwYkJSXxGRbIe++9B8cyd+5cPsMCyczM/Omnn/hmpybQMtbAv/71rzVr1vTr1y8qKorPs1gmTpzo7u4OlyifgVgaaBmL5+HDh9NaeOuttzZv3sxnWyzLWoiMjIyPjweN8tmI5YCWsWyuXLkSEhICHRm4DkNDQ2tra/kIi6WkpOS///u/v//+++gWYIGPQCwEtIwFc+DAAR8fH/gLy1999ZWfn98vv/zCB1ksDQ0Nw4cP/7VlPAjdGejU3L17lw9CLAG0jEVCPoiBXgz0ZUhKXl7eggULHo+yeMAy4BqynJmZ6e/vf/HixcdDEAsALWN50A9iYIEm/ulPfyoqKmKirAEYMcG4ia6WlZVB3w3+MiGIBYCWsTDYD2Jo4k8//TRkyJDm5mYm0BrYsmXLsmXL2BToy0CPBh88WRZoGUuC/SCG5YsvvpgwYQKXaAWcOXNm4sSJXOLdu3fxwZNlgZaxDIQfxLAkt8CnWj7/+Mc/Bg4cCH+5dHzwZFmgZSwA0Q9iWKAjA90ZPtUqgL4M9Gj4VHzwZFGgZcwd0Q9iWJqbm4cMGWKt32FftmzZli1b+NRW8MGTRYCWMWu++eYbb29v6MVISKSoqOhPf/oTn2otkO/m8amtwGl59dVX4RT99a9/5fMQswEtY+40NDS88cYboaGhJ06c4PNaWLBgQV5eHp9qLdDv5gmBEwKnBU4O/U4NYp6gZSwDekXduHGDTf/ll1/8/Py++uorNtHKYL+bR4CTIG1exKxAy1gMMDpYtWqVm5tbamoqHUDV1tbCxfZ4oLXBfjcPDhwOH04CnAqJUSRiVqBlLInXX3999erV7G188+bNS5cu5eOsC/rdPNqhW7NmzWuvvcbHIeYKWsZiOHbsWFhYGLmB0+vt2WefLS8v50OtizNnzowaNYp1K5wESMGfGlgKaBnL4IcffhgxYsTnn39OU+BK27Rp05AhQ/72t78xgVbIP/7xDzhMOFh2iHT69OmgoCCrP3brAC1jGSQnJ8+bN49P/fXXR48e8UnWyIMHD/ikX3+NiYmB8SOfipgfaBkL4MaNG97e3k1NTXyGurl3756Pj09dXR2fgZgZaBkLYMqUKR9//DGfivz6644dO1544QVrmrvLKkHLmDvFxcXjxo3T9vMClfPzzz8/99xze/fu5TMQcwItY9Z89913w4cPr66u5jOQVi5fvuzr6yv6wQ1iJqBlzJqlS5e+++67fCryOMuXL4+NjeVTEbMBLWO+XLp0Ce7SKnmK1B6+//57f3//qqoqPgMxD9AyZsrPP//87LPP5ufn8xmIGKWlpZGRkf/85z/5DMQMQMuYKTk5OS+++CI+PdGf6dOnb926lU9FzAC0jDny7bffent7f/nll3wGop2bN28OHTq0sbGRz0BMDVrGHHnrrbeSkpL4VEQXGzZsmDlzJp+KmBq0jNlx6tSpESNG/P3vf+czEF38+OOPoaGhFRUVfAZiUtAy5gW5Tqz+Z9bG47PPPgsJCfnhhx/4DMR0oGXMC+jzS0xzi+jDm2++aZX/N8ZyQcuYEfj5pSw0NTV5e3tzU5ciJgQtY0ZMmzYN/zerLGRlZUVFRfGpiIlAy5gLxcXFY8eOxV9FygKcxvHjxxcVFfEZiClAy5gFGo0GfxUpLzU1NX5+fnBi+QxEcdAyZkFCQkJ8fDyfirSPhBb4VERx0DKm5/z589CRwbuu7JAeInRq+AxEWdAyJuZf//rXuHHj8BMEIwEndvz48T///DOfgSgIWsbEbNu2berUqXwqIh9RUVFZWVl8KqIgaBlT8s0333h7e9fX1/MZiHz87//+L87NblrQMqZk5syZ69ev51MRuUlOTn7zzTf5VEQp0DImo6KiIjQ09Mcff+QzELn54YcfQkJCPvvsMz4DUQS0jGnAdq8w6HQTgpYxDdr+VyRiPGB8umHDBj4VMT5oGRNw/fp1b2/vv/71r3wGYkwaGxuHDh168+ZNPgMxMmgZE/Diiy/m5OTwqYjx2bp16/Tp0/lUxMigZZSmoKDg2Wefxe+JmYR//vOfkZGRpaWlfAZiTNAyivLo0SNfX9+LFy/yGYhSVFVV+fv7f//993wGYjTQMory7rvvLlmyhE9FlCU2Nnb58uV8KmI00DLKUV1djb+KNAcePHgAPcra2lo+AzEOaBmFwF9FmhV79+597rnn8NMxZUDLKMTHH388ZcoUPhUxEb/88ssLL7ywY8cOPgMxAmgZJcD5rs2Quro6Hx+fe/fu8RmI3KBllGDevHn4vzvMkNWrV8fExPCpiNygZYzO559/PmLECPw/ZGbI3/72t6CgoNOnT/MZiKygZYzLTz/9FBYWduzYMT4DMQ/KyspGjRoFbxOfgcgHWsa4pKWlvf7663wqYk689tpr6enpfCoiH2gZI/L3v/89MDDw66+/5jMQcwLeIHib4M3iMxCZELfMw4cP33///aSkpHVI+1i1ahWfZE6cOnWKf++NSWVl5dq1a/lKmAFm/jZZCmCM9evXC793Km6Z1NTUhoYGDWLtFBYW5ufn82+/cSgqKiooKOBrgFgX4I2NGzdyb724ZUBL/NaIlaLYI/b33nuP3zdijcAbzb31aBm1o9j05mgZlYCWQXjQMoi8yGOZ5gfN+QcLZi2c8/vRoU/7eLm6unr5DA0bExYTu+BY+bFHjx7xGyBmjJlYBppNadkn895+KzRipNf/NSovWIYUSMdGZUG01zIPHj3MKcwLDhsRFBo8K37uhoK07ON5RRc/gb+wDClBI4NHjgo7fOQwvyVirpiDZYo+Kf5d+O+0NqrQYMiFGH4zxCxpl2Uav/3m9flvDAv0Xb5lFTQCbS/I9QscHvvuOw8ePOCLQMwP01oGGsmf357vq0ejghiIxEZl/rTdMqCYCX98duzkcbv/ki9sBNwLYsb/4Zmp06dhmzB/TGgZaB4vRP1R/0YFkRCPjcrMaaNlYKAEvRh4j/fXHBC+/aIviJzwwrNxcXFsOYgZYkLLxMQuMLRRQTxsxZWDmBVttExOYR4MlHad1n3DYV8QHxgcWFZWxhYlF4cPH7axsbl58yafYSGYT/1NZZlDhw/7Bvq1oVHBVrAtW5SMmM/70jbMof5tsUzzg+YRYSHcsLmwpnTe/8wf6DXI3sHe0clx0NDBPsHDhgZ6c21iZcaaMZFj2AcE5CwQunfvHhUVVV9fT3NFIZt8/fXXwkTTnk0Ogw7t3r17169f1/noRPTYDeX1118PDg5+4oknRIsyiWXgwMNGhwk/i9GnXcFWsC136gw6+QTRc4vtSk8WLlz49NNPOzo69ujRY8aMGbdv36ZZbbFM/sGCoJHBjzWFC6URkyOhltAOvAK8nx7uBW0CVjt17sQ1GniFjQqrqKigpZHDO3PmDJwLSPfy8ho/fjzNFUX0jJhta9Dn0O7fv88naUH02PWH7OjVV19NTk5etWqVaFEmsQycn+CRI7imon+7gm3ZRqUx5ORTRM8ttit9gB1FRkbu3Lmztra2vLwcdDNu3Dia2xbLzFo4Z3b8XPY9jk2NhyoO8Byw7dPtJCXzaHaP/+gpbA3wWrR8cWJiIi2Nexfz8vLs7e2bm5thOSMjw8fHx8nJqVu3blOnTqWnwOZx2HJKSkr8/PxgE39//3PnzunM0rYLsklxcfHw4cM7dOgQFBR04cKF48ePw7awCn/Pnz9PIoGUlJTBgweDxd3c3OLi4uiHkRKHRrIKCwsDAgJgw/z8fDZYosLMcf8GSdToqgO7I7qJtoZlEsvExr/DNSqD2hVsCyUwByF18rW96Y+fWmxXvyFdB9F2BezatcvW1vbbb78lq22xzO9H/35Dfhr7HgeGB8Eu1+WlsIkzE+ZMmDKRaw3w+qhoK+s57pTt3buX1i8zM/PgwYNXr16FmKFDh06bNo3EwDHAJtXV1ddbYMsJCQkBu589exZGBGFhYTqztO2CbAKRIGZ4J2BbaBawFTQIsjp69GgSmZCQ4OnpCae7rq6utLTUw8MjNjaWLUT00EjWsGHDYAH0DzHC1iBaYdFj11kHdkcknWaZiWVGR0ZwjcqgdgXbQgnMQUidfG1vuui5lXgvJLK07UIN7QrYvHkzjMcfPnxIVttimae9n84+sYN9j/sPdIddFlSXcO+96Cu3cjeolJbGngX4C4cNB09zKbt37+7UqRMZXopeHiTx0KFDZDU3N9fBwYH0GCWyWIS7gIZCsuB2Aav0c2tYhRLA601NTc7OztBiaCHZ2dkuLi5kWeLQSNa+fftat3ssWKLCwmPXpw7sjijCoggmsYz3MB+uURUZ0q5gWyiBOQipk88ifNOxXRH0qYNou2poaBgwYMDChQtpSlss09+9P/fGuz3ZD3ZZWFMqfPtFXuc/ASnS0kh1O7UASoZeHAiVZB07dgzU3qtXL/Bix44dIezu3bt0E9HWcOPGDXaVzFYhkSW9C24T+oEWLaGyspJWnkAKaWxspGGih0ayrl27RlZpCtsaRCssPHZ96sDuiCIsimASy7i7uwtton+7gm2hBOYgpE6+9JuO7YqgTx2E7Qq6VHDgI0eOpMMlTdss4+Xjxd12vAK8YZdpJR8J337ha++p/cK+DBwSDFBv3bpF0+GAO3fuPGPGDLApDFa3bt1Kz4LwjNBE2nNjY7Rl6dyFcBNuFTq6sHD06NGaxyF9RW2HRrPYfqawNYjuXXjs+tSB3RFFWBTBJJbxEevL6N+uYFsfsb6M8OTrfNOxXRH0qQPXrqBbNGnSJBgD3rlzh01vi2VGRozkhtBzls6DXQ7x/c+PK3JJSuGF0jdX/PmppwfmfrabaxDbP8mV+FyG8umnn0I6jGzJ6po1a+hZgB6mDXMHIOg8g8IsiV1o24RbBa+D4LOyskg6h7ZDE83SszUIj72ddWAbFsEklokcGyn8XEb/dgXbQgnMQWg9cIk3XXhuNYJysF0RhDsC+0RFRXl5eXHi07TNMjGxC7jHAftrDvx+/EjYq72DPbSJ4aEBfT3cYLVnn167Tu/jms6S1UslnjFRoDNmb28Po7vLly/DyLZfv986z+SMXLlyBZa3bNlSX1/PnTLRM6gtS2IX2jYRrsKxwGA1MzOztrYWTJ+Tk7NkyRI2THhooll6tgbRYze0Dv+vhfT0dJuWDwVgmc01iWXgEOYlzueaiv7tCrZlG5VGy4FrsF1p2bvosRtUh9dee83V1RXaEvn8+DrzJZ22WOZY+TGRrzbUlM5fvfDp4V4dOnaAsWKvvr0nTJ1IfkrLvkovH4mIiBB+X0b0lG3evBnqDUKFkV5GRgb7fixfvhyy7OzsbB5/4ih6BiWytO1CYhPhalpamre3t5OTE4xdAwMD4eplw0QPTZilZ2vQiB27xsA62Ahgc01iGWgSoeEjudaif7uCbUW/LyN68rW96RqxcyvxXkhkaduFxCbCVYPeU21ZirUrGwG05LZYRtvXNPV5bcnLiIyM1PlNRMSEmMQy0CTGREau2rpW2GZ0vmCrMdiozJi2WAY4fOSwX+BwQ39yUnr2cEhIiJF+x4TIhUkso2n5aCBoRJChjQriYStsVOZMGy0DxL77zvg/PKP/z2c/uXQkakpUfHw8Vw5ibpjKMgA0j0kvTta/UUEkxGOjMnPabpkHDx5MnT5twgvP6jMVyCfnflNMdHQ0TgVi/pjQMtA8oJH84aUXdv+lQNiKuBfEQCQ2KvOn7ZbRtLSJuLi4wODAlRlrhI2AvEovH9mSlwEDJbjhYGuwCExoGU1Lo4KmEjwiOOXj9cLmRF+QCzHYqCyCdlmGAEPiMWPGjBwVtnDZ2x8Vb809sevApcN7TuXnfJK3ZNXSiIgIyMVhswVhWssQSKMaNXrUuyvitpZk7Ty5F8wCf2EZUiAdG5UFIYNlNC0PCCoqKhITE8ePH+/n5+fq6gp/YRlSIB0//LcszMEyGmxUVoQ8lkGsCTOxDGI1oGUQHrQMIi9oGYQHLYPIC1oG4UHLIPJigGVycnLWIdZObm6ukpbBRmX1QIsywDK8oBArRUnL8PtGrBG0DMKDlkHkBS2D8KBlEHlByyA8aBlEXtAyCA9aBpEXtAzCg5ZB5AUtg/CgZRB5McAy+NUGNYDfl0HkBb8vg4igpGX4fSPWCFoG4UHLIPKClkF40DKIvKBlEB60DCIvaBmEBy2DyIsRLSP873McOgOApUuXTp06lU99HIn/ntdm/Pz8duzYwaeqAzO3jM63WGeABtuVsrTdMhMnThw1ahSXWFVVBW9GSUkJLN+7d4/9X7lC2ADun2kSbt++3aVLl7Nnz5JVEsMyb9480XL0aQ2ZmZmenp729vY9evSYPHny/fv32dydO3cOGTJEovJWjGktg+3K+mi7Zfbs2WNra3v58mU2MSYmxt3d/eHDh2yiPoi2htWrV48YMYKukpgzZ87Qf/d99+5dJvzfMTpbw/nz56Hy8+fPv3jx4hdffLFx40auNUAL6969O2nWasO0lsF2ZX203TJw+vr06cP+W7/m5ubevXsvWbKErLJvzKZNm/r16weC79u3b1JSkjCA3kYIJAC6l6tWrSLLXDwLm87FpKSkDB482NHR0c3NLS4ujv7vHmgEUJmamhpaiJCoqKhXX32VT1UBprUMtivro+2WARYtWtS/f396h9m1a5ednd3Vq1fJKn1j4L4Egl+5cmVtbe3Jkyf37dvHBZBtYbm6uprcTCAF7iew1cGDB0kwF8+irTUkJCRA37WwsLCurq60tNTDwyM2NpZsAl3W8PDw0NDQO3fusEWxJCcnP/nkk3yqCjCtZTTYrqyOdlkG+oc2raNl4Jlnnhk3bhzNpW8MtABYOH36NM3iAugy27P9/PPPIYW9LZCYTgxXrlwRLQeWm5qanJ2dy8vL6ebZ2dkuLi5kGZrFmDFj0tPTfXx8aPPdv38/lEnHzNBAoTnCjZSsqgeTWwbblZXRLssAYWFhL730Eixcu3YN+ors5+f0jYE+cEBAQNeuXadNm5aXl0e7l8J3kW0NZWVlkELuP2x8ZWVlTStk0CssB5YhjGs6HTt2hJTGxsbbt287OTkdPXpU03JFQWf71KlTsAx98rFjx9LdwW0K4r/66iuaohJMbhkNtivror2WyczM7NChA5zfFStW9OrVizU0+yZBen5+/uzZs7t37z5p0iRhgLA1kHsO3NZoChvPIiwHlo8fPw4L8JbTpkOAfnhFRQVkffnll2TztWvXQluBZuru7p6bm0uLVeE9h2AOlsF2ZU201zLQgYSbSUpKylNPPRUTE8Nmib55cNIhEbbiAsgdBloVjSTjZxA/TREtkEuny3BvgZtMVlYWFwzAcBpitm/fTlOWLVsGKdDLZR8xJiUlqW38TDAHy2C7sibaaxlg5syZcCeBs1lVVcWm0zfmxIkTqampZ8+eBeVPnz7dzc1N+B0EGAnD8pYtW+rr6+n77evrC7cyYYE0RZjOLicmJsKAGe6KtbW1sOucnBz6nAKq0a1bN8iC/UL1Jk+eDLcduHmy/+D95ZdffuWVV+iqejAHy2iwXVkRMlgGBp/wBoSEhHDp9I2BVhIeHt65c2dHR8egoCA4+1wAWV2+fLmrq6udnZ1N6xPHVatWBQYGkmVhvGg6F5OWlubt7Q2jZXizoaj09HSSDv1VaCseHh4ODg7QOufMmQOtMDo6GlrPuXPnNK3fayguLm7diYowE8tgu7IaZLCM8bh16xa0oTNnzvAZxmfnzp2enp5q+44mwUwsYzywXSmMWVtG0/L5/JQpU/hU4+Pn5wdDfT5VHVi9ZTTYrpTF3C2DKI8aLIMoCVoG4UHLIPKClkF40DKIvBjRMto+uqfoDNDoNw8IRZ8CJVDn3B9CzNwyOt9lnQEabFfK0nbLmHAeEFtb265duwYEBEBbYX+kr3OPOPeHPpjWMtiurI+2W8a084BUV1dv377d19d34MCB9fX1zEbiwBuPc3/oiWktg+3K+mi7ZcxhHpCmpia4h8ycOVMYQJYLCwvh1uTo6Jifn38R5/7QD9NaBtuV9dF2y2jMYx6Q5ORkV1dXYQBZHjZsGCzAfiHxEc79oR+mtYwG25XV0S7LmGQeEK41FBUVQSJ0SrkAskxbngbn/tAbk1sG25WV0S7LaEwxDwjXGqDvKtEaoFYkDOf+0B+TW0aD7cq6aK9lTD4PCFQM3lphABeMc3/ojzlYBtuVNdFey5h2HhDyKd2sWbOEAVwwzv2hP+ZgGWxX1kR7LaNRfB4Q8sQR7kU5OTncE0eJ1qDBuT/0xhwso8F2ZUXIYBmF5wGxafn2VJcuXfz9/WH0y36wL90acO4PPTETy2C7shpksIzxUHgeEHXO/SHETCxjPLBdKYxZW0aj7Dwg6pz7Q4jVW0aD7UpZzN0yiPKowTKIkqBlEB60DCIvaBmEBy2DyAtaBuFByyDyYkTLCJ/5cegM0Bg425Ao+uxFYYxXJVkmTDJzy+g8ezoDNNiuDKSd7artllF+tiGgtrZ2xowZffr0cXR0HDBgwMKFC4Xfa+AKkevU029VsLB1E0W0SjoPXAIFJkwyrWWwXdlYXbtqu2WUn23o/PnzPXv2fO6558rLy69cuVJcXDx8+HAfH59vvvmGBIgWIktrgJNOyiHfEKXQX+hpQ7RKLDoDWJSZMMm0lsF2ZX3tqu2WUX62ocjIyIiICFaojY2NHh4eb7/9NlkVLYTsBU4QlObk5OTv70++kUlISUkZPHgw3MHc3Nzi4uK43/WykxVJtCqJXTxeo8eqpO3A4QR6eXm1lv0bISEhc+fOhYWLikyYZFrLYLuiSOzi8RqZe7tqu2U0ys42dOvWLViFt4esUqC5wF2OLAsL0bTuBU5oRUUFdESDg4PDwsJIVkJCAvQSocy6urrS0lJoWLGxsexW7GRFOluD6C4kqqTtwKEy8JbT78tDw7JpnUXlkSITJpnWMhpsV61I7EKiStoO3ITtql2WUXK2oePHj8MqnCkaQBDOAyLasz106BBZzc3NdXBwgBtmU1OTs7MzdJJpZHZ2touLC7sVO1kRSenEALcpNku4C5olWiVtBw5MmDDhjTfeIMtwycFNjCwrM2GSyS2D7YrNEu6CZolWSduBa0zXrtplGY2Csw21szXcuHGDXW1oaKisrOTe3Y4dO0IK9JZpGJ2siKbAVjWtXLp0SXoXdFm0StoOXNPy2QScLmivcK5cXV0/+OADjYITJpncMhpsV5K7oMuiVdJ24BrTtav2Wkax2YZIzxb8SgMIbM9WWAhNpD1SGkOaF5xc+u4SSEed20o0RVsWWw2dVRINgOsHGsG2bdvgpgc3RtKPVWzCJHOwDLYrYZbltqv2WkbJ2YYiWpD4lE5YiEZQDXr2YVu4yWRlZbHBFGHlhSnastg3WGeVRAOAxYsXw1AZrpzo6GiSotiESeZgGWxXwizLbVfttYxGwdmGzp0716NHj+effx4GvTB6PHDgAAws2SeOooVIvFWJiYkwYIbbZm1tLdQtJydH9EEGm8I9cRTOC0tXyS50Vkk0QNPysb+dnR2Mw48cOUITlZkwyRwso8F2JQi23HYlg2UUm20IgCErnJHevXtDUdCjW7BgAfepuLAQibcKSEtL8/b2hnEpnFbYV3p6uuhWNIWjqKhIGMztQmeVhAEEOGmDBg1iU5SZMMlMLIPtSnoXOqskDCAo365ksIzxUHi2IXPD09OT/VqHPsgyYZKZWMZ4YLtSuF2ZtWU0ys42ZD7AnWTDhg3Ozs70+YKeyDJhktVbRoPtStl2Ze6WUSfQxe3Zs2dGRgafoQhqsIw6MVW7QssgPGgZRF7QMshjfPfdd4pZZu3atfzuEWskJSWFe+vFLZOamkq+dIhYN0VFRSUlJfzbbxz27t1bUFDA1wCxLsAbGzdu5N56ccs8evTo/fffT05OTkKsmlOnTvHvvTGprKyEbjJfCcRaAGNA1xhcw73v4pZBEASRC7QMgiDGBS2DIIhxQcsgCGJc0DIIghiX/w+UVuVbu3NdnAAAAABJRU5ErkJggg==" />
</p>
<div class="sourceCode" id="cb149"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/visitor.h 72</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> TestablePrinter <span class="op">:</span> <span class="kw">public</span> FileEntityVisitor <span class="op">{</span></span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> TestablePrinter<span class="op">(</span><span class="bu">std::</span>ostream<span class="op">&amp;</span> os<span class="op">)</span> <span class="op">:</span> <span class="va">ostream_</span><span class="op">{</span>os<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">protected</span><span class="op">:</span></span>
<span id="cb149-8"><a href="#cb149-8" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>ostream<span class="op">&amp;</span> <span class="va">ostream_</span><span class="op">;</span></span>
<span id="cb149-9"><a href="#cb149-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb149-10"><a href="#cb149-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-11"><a href="#cb149-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> TestablePathnamePrinter1 <span class="kw">final</span> <span class="op">:</span> <span class="kw">public</span> TestablePrinter <span class="op">{</span></span>
<span id="cb149-12"><a href="#cb149-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb149-13"><a href="#cb149-13" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> TestablePathnamePrinter1<span class="op">(</span><span class="bu">std::</span>ostream<span class="op">&amp;</span> os<span class="op">)</span> <span class="op">:</span> TestablePrinter<span class="op">{</span>os<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb149-14"><a href="#cb149-14" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span> Visit<span class="op">(</span>File <span class="at">const</span><span class="op">&amp;</span> file<span class="op">)</span> <span class="kw">override</span><span class="op">;</span></span>
<span id="cb149-15"><a href="#cb149-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span> Visit<span class="op">(</span>Dir <span class="at">const</span><span class="op">&amp;</span> dir<span class="op">)</span> <span class="kw">override</span><span class="op">;</span></span>
<span id="cb149-16"><a href="#cb149-16" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span> Visit<span class="op">(</span>OtherEntity <span class="at">const</span><span class="op">&amp;</span> other<span class="op">)</span> <span class="kw">override</span><span class="op">;</span></span>
<span id="cb149-17"><a href="#cb149-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb149-18"><a href="#cb149-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-19"><a href="#cb149-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> TestablePathnamePrinter2 <span class="kw">final</span> <span class="op">:</span> <span class="kw">public</span> TestablePrinter <span class="op">{</span></span>
<span id="cb149-20"><a href="#cb149-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb149-21"><a href="#cb149-21" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> TestablePathnamePrinter2<span class="op">(</span><span class="bu">std::</span>ostream<span class="op">&amp;</span> os<span class="op">)</span> <span class="op">:</span> TestablePrinter<span class="op">{</span>os<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb149-22"><a href="#cb149-22" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span> Visit<span class="op">(</span>File <span class="at">const</span><span class="op">&amp;</span> file<span class="op">)</span> <span class="kw">override</span><span class="op">;</span></span>
<span id="cb149-23"><a href="#cb149-23" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span> Visit<span class="op">(</span>Dir <span class="at">const</span><span class="op">&amp;</span> dir<span class="op">)</span> <span class="kw">override</span><span class="op">;</span></span>
<span id="cb149-24"><a href="#cb149-24" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span> Visit<span class="op">(</span>OtherEntity <span class="at">const</span><span class="op">&amp;</span> other<span class="op">)</span> <span class="kw">override</span><span class="op">;</span></span>
<span id="cb149-25"><a href="#cb149-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb150"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/visitor.cpp 246</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> TestablePathnamePrinter1<span class="op">::</span>Visit<span class="op">(</span>File <span class="at">const</span><span class="op">&amp;</span> file<span class="op">)</span> <span class="op">{</span> <span class="va">ostream_</span> <span class="op">&lt;&lt;</span> file<span class="op">.</span>Pathname<span class="op">();</span> <span class="op">}</span></span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> TestablePathnamePrinter1<span class="op">::</span>Visit<span class="op">(</span>Dir <span class="at">const</span><span class="op">&amp;</span> dir<span class="op">)</span> <span class="op">{</span> <span class="va">ostream_</span> <span class="op">&lt;&lt;</span> dir<span class="op">.</span>Pathname<span class="op">()</span> <span class="op">+</span> <span class="st">&quot;/&quot;</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> TestablePathnamePrinter1<span class="op">::</span>Visit<span class="op">(</span>OtherEntity <span class="at">const</span><span class="op">&amp;</span> other<span class="op">)</span></span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">ostream_</span> <span class="op">&lt;&lt;</span> other<span class="op">.</span>Pathname<span class="op">()</span> <span class="op">+</span> <span class="st">&quot;(o1)&quot;</span><span class="op">;</span></span>
<span id="cb150-8"><a href="#cb150-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb150-9"><a href="#cb150-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-10"><a href="#cb150-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> TestablePathnamePrinter2<span class="op">::</span>Visit<span class="op">(</span>File <span class="at">const</span><span class="op">&amp;</span> file<span class="op">)</span> <span class="op">{</span> <span class="va">ostream_</span> <span class="op">&lt;&lt;</span> file<span class="op">.</span>Pathname<span class="op">();</span> <span class="op">}</span></span>
<span id="cb150-11"><a href="#cb150-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-12"><a href="#cb150-12" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> TestablePathnamePrinter2<span class="op">::</span>Visit<span class="op">(</span>Dir <span class="at">const</span><span class="op">&amp;</span> dir<span class="op">)</span> <span class="op">{</span> <span class="va">ostream_</span> <span class="op">&lt;&lt;</span> find_files<span class="op">(</span>dir<span class="op">.</span>Pathname<span class="op">());</span> <span class="op">}</span></span>
<span id="cb150-13"><a href="#cb150-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-14"><a href="#cb150-14" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> TestablePathnamePrinter2<span class="op">::</span>Visit<span class="op">(</span>OtherEntity <span class="at">const</span><span class="op">&amp;</span> other<span class="op">)</span></span>
<span id="cb150-15"><a href="#cb150-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb150-16"><a href="#cb150-16" aria-hidden="true" tabindex="-1"></a>        <span class="va">ostream_</span> <span class="op">&lt;&lt;</span> other<span class="op">.</span>Pathname<span class="op">()</span> <span class="op">+</span> <span class="st">&quot;(o2)&quot;</span><span class="op">;</span></span>
<span id="cb150-17"><a href="#cb150-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb151"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/visitor_ut.cpp 28</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>    TEST<span class="op">(</span>Visitor<span class="op">,</span> testable_visitor<span class="op">)</span></span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> oss <span class="op">=</span> <span class="bu">std::</span>ostringstream<span class="op">{};</span></span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 出力をキャプチャするため、std::coutに代えてossを使う</span></span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> visitor1 <span class="op">=</span> TestablePathnamePrinter1<span class="op">{</span>oss<span class="op">};</span></span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> visitor2 <span class="op">=</span> TestablePathnamePrinter2<span class="op">{</span>oss<span class="op">};</span></span>
<span id="cb151-10"><a href="#cb151-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-11"><a href="#cb151-11" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> file <span class="op">=</span> File<span class="op">{</span><span class="st">&quot;visitor.cpp&quot;</span><span class="op">};</span></span>
<span id="cb151-12"><a href="#cb151-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb151-13"><a href="#cb151-13" aria-hidden="true" tabindex="-1"></a>            file<span class="op">.</span>Accept<span class="op">(</span>visitor1<span class="op">);</span></span>
<span id="cb151-14"><a href="#cb151-14" aria-hidden="true" tabindex="-1"></a>            ASSERT_EQ<span class="op">(</span><span class="st">&quot;visitor.cpp&quot;</span><span class="op">,</span> oss<span class="op">.</span>str<span class="op">());</span></span>
<span id="cb151-15"><a href="#cb151-15" aria-hidden="true" tabindex="-1"></a>            oss <span class="op">=</span> <span class="op">{};</span></span>
<span id="cb151-16"><a href="#cb151-16" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb151-17"><a href="#cb151-17" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb151-18"><a href="#cb151-18" aria-hidden="true" tabindex="-1"></a>            file<span class="op">.</span>Accept<span class="op">(</span>visitor2<span class="op">);</span></span>
<span id="cb151-19"><a href="#cb151-19" aria-hidden="true" tabindex="-1"></a>            ASSERT_EQ<span class="op">(</span><span class="st">&quot;visitor.cpp&quot;</span><span class="op">,</span> oss<span class="op">.</span>str<span class="op">());</span></span>
<span id="cb151-20"><a href="#cb151-20" aria-hidden="true" tabindex="-1"></a>            oss <span class="op">=</span> <span class="op">{};</span></span>
<span id="cb151-21"><a href="#cb151-21" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb151-22"><a href="#cb151-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-23"><a href="#cb151-23" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> dir <span class="op">=</span> Dir<span class="op">{</span><span class="st">&quot;find_files_ut_dir/dir0&quot;</span><span class="op">};</span></span>
<span id="cb151-24"><a href="#cb151-24" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb151-25"><a href="#cb151-25" aria-hidden="true" tabindex="-1"></a>            dir<span class="op">.</span>Accept<span class="op">(</span>visitor1<span class="op">);</span></span>
<span id="cb151-26"><a href="#cb151-26" aria-hidden="true" tabindex="-1"></a>            ASSERT_EQ<span class="op">(</span><span class="st">&quot;find_files_ut_dir/dir0/&quot;</span><span class="op">,</span> oss<span class="op">.</span>str<span class="op">());</span></span>
<span id="cb151-27"><a href="#cb151-27" aria-hidden="true" tabindex="-1"></a>            oss <span class="op">=</span> <span class="op">{};</span></span>
<span id="cb151-28"><a href="#cb151-28" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb151-29"><a href="#cb151-29" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb151-30"><a href="#cb151-30" aria-hidden="true" tabindex="-1"></a>            dir<span class="op">.</span>Accept<span class="op">(</span>visitor2<span class="op">);</span></span>
<span id="cb151-31"><a href="#cb151-31" aria-hidden="true" tabindex="-1"></a>            ASSERT_EQ<span class="op">(</span><span class="st">&quot;find_files_ut_dir/dir0/file2,find_files_ut_dir/dir0/gile3&quot;</span><span class="op">,</span> oss<span class="op">.</span>str<span class="op">());</span></span>
<span id="cb151-32"><a href="#cb151-32" aria-hidden="true" tabindex="-1"></a>            oss <span class="op">=</span> <span class="op">{};</span></span>
<span id="cb151-33"><a href="#cb151-33" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb151-34"><a href="#cb151-34" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<h2 id="crtpcuriously-recurring-template-pattern">CRTP(curiously
recurring template pattern) <a id="SS_2_21"></a></h2>
<p>CRTPとは、</p>
<div class="sourceCode" id="cb152"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/crtp_ut.cpp 8</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Base <span class="op">{</span></span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb152-6"><a href="#cb152-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb152-7"><a href="#cb152-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-8"><a href="#cb152-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Derived <span class="op">:</span> <span class="kw">public</span> Base<span class="op">&lt;</span>Derived<span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb152-9"><a href="#cb152-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb152-10"><a href="#cb152-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>のようなテンプレートによる再帰構造を用いて、静的ポリモーフィズムを実現するためのパターンである。</p>
<p>このパターンを用いて、「<a
href="#SS_2_20">Visitor</a>」のFileEntityの3つの派生クラスが持つコードクローン</p>
<div class="sourceCode" id="cb153"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/visitor.h 39</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">virtual</span> <span class="dt">void</span> Accept<span class="op">(</span>FileEntityVisitor<span class="op">&amp;</span> visitor<span class="op">)</span> <span class="at">const</span> <span class="kw">override</span> <span class="op">{</span> visitor<span class="op">.</span>Visit<span class="op">(*</span><span class="kw">this</span><span class="op">);</span> <span class="op">}</span></span></code></pre></div>
<p>を解消した例を以下に示す。</p>
<div class="sourceCode" id="cb154"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/crtp.h 31</span></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> FileEntity <span class="op">{</span>  <span class="co">// VisitorのFileEntityと同じ</span></span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> FileEntity<span class="op">(</span><span class="bu">std::</span>string<span class="op">&amp;&amp;</span> pathname<span class="op">)</span> <span class="op">:</span> <span class="va">pathname_</span><span class="op">{</span><span class="bu">std::</span>move<span class="op">(</span>pathname<span class="op">)}</span> <span class="op">{}</span></span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="op">~</span>FileEntity<span class="op">()</span> <span class="op">{}</span></span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span><span class="op">&amp;</span> Pathname<span class="op">()</span> <span class="at">const</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">pathname_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb154-8"><a href="#cb154-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-9"><a href="#cb154-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span> Accept<span class="op">(</span>FileEntityVisitor<span class="op">&amp;)</span> <span class="at">const</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span>  <span class="co">// Acceptの仕様は安定しているので</span></span>
<span id="cb154-10"><a href="#cb154-10" aria-hidden="true" tabindex="-1"></a>                                                            <span class="co">// NVIは使わない。</span></span>
<span id="cb154-11"><a href="#cb154-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb154-12"><a href="#cb154-12" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span> <span class="va">pathname_</span><span class="op">;</span></span>
<span id="cb154-13"><a href="#cb154-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb154-14"><a href="#cb154-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-15"><a href="#cb154-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb154-16"><a href="#cb154-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> AcceptableFileEntity <span class="op">:</span> <span class="kw">public</span> FileEntity <span class="op">{</span>  <span class="co">// CRTP</span></span>
<span id="cb154-17"><a href="#cb154-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb154-18"><a href="#cb154-18" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span> Accept<span class="op">(</span>FileEntityVisitor<span class="op">&amp;</span> visitor<span class="op">)</span> <span class="at">const</span> <span class="kw">override</span></span>
<span id="cb154-19"><a href="#cb154-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb154-20"><a href="#cb154-20" aria-hidden="true" tabindex="-1"></a>            visitor<span class="op">.</span>Visit<span class="op">(*</span><span class="kw">static_cast</span><span class="op">&lt;</span>T <span class="at">const</span><span class="op">*&gt;(</span><span class="kw">this</span><span class="op">));</span></span>
<span id="cb154-21"><a href="#cb154-21" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb154-22"><a href="#cb154-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-23"><a href="#cb154-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb154-24"><a href="#cb154-24" aria-hidden="true" tabindex="-1"></a>        <span class="co">// T : public AcceptableFileEntity&lt;T&gt; { ... };</span></span>
<span id="cb154-25"><a href="#cb154-25" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 以外の使い方をコンパイルエラーにする</span></span>
<span id="cb154-26"><a href="#cb154-26" aria-hidden="true" tabindex="-1"></a>        AcceptableFileEntity<span class="op">(</span><span class="bu">std::</span>string<span class="op">&amp;&amp;</span> pathname<span class="op">)</span> <span class="op">:</span> FileEntity<span class="op">{</span><span class="bu">std::</span>move<span class="op">(</span>pathname<span class="op">)}</span> <span class="op">{}</span></span>
<span id="cb154-27"><a href="#cb154-27" aria-hidden="true" tabindex="-1"></a>        <span class="kw">friend</span> T<span class="op">;</span></span>
<span id="cb154-28"><a href="#cb154-28" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb154-29"><a href="#cb154-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-30"><a href="#cb154-30" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> File <span class="kw">final</span> <span class="op">:</span> <span class="kw">public</span> AcceptableFileEntity<span class="op">&lt;</span>File<span class="op">&gt;</span> <span class="op">{</span>  <span class="co">// CRTPでクローンを解消</span></span>
<span id="cb154-31"><a href="#cb154-31" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb154-32"><a href="#cb154-32" aria-hidden="true" tabindex="-1"></a>        File<span class="op">(</span><span class="bu">std::</span>string<span class="op"> </span>pathname<span class="op">)</span> <span class="op">:</span> AcceptableFileEntity<span class="op">{</span><span class="bu">std::</span>move<span class="op">(</span>pathname<span class="op">)}</span> <span class="op">{}</span></span>
<span id="cb154-33"><a href="#cb154-33" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb154-34"><a href="#cb154-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-35"><a href="#cb154-35" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Dir <span class="kw">final</span> <span class="op">:</span> <span class="kw">public</span> AcceptableFileEntity<span class="op">&lt;</span>Dir<span class="op">&gt;</span> <span class="op">{</span>  <span class="co">// CRTPでクローンを解消</span></span>
<span id="cb154-36"><a href="#cb154-36" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb154-37"><a href="#cb154-37" aria-hidden="true" tabindex="-1"></a>        Dir<span class="op">(</span><span class="bu">std::</span>string<span class="op"> </span>pathname<span class="op">)</span> <span class="op">:</span> AcceptableFileEntity<span class="op">{</span><span class="bu">std::</span>move<span class="op">(</span>pathname<span class="op">)}</span> <span class="op">{}</span></span>
<span id="cb154-38"><a href="#cb154-38" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb154-39"><a href="#cb154-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-40"><a href="#cb154-40" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> OtherEntity <span class="kw">final</span> <span class="op">:</span> <span class="kw">public</span> AcceptableFileEntity<span class="op">&lt;</span>OtherEntity<span class="op">&gt;</span> <span class="op">{</span>  <span class="co">// CRTPでクローンを解消</span></span>
<span id="cb154-41"><a href="#cb154-41" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb154-42"><a href="#cb154-42" aria-hidden="true" tabindex="-1"></a>        OtherEntity<span class="op">(</span><span class="bu">std::</span>string<span class="op"> </span>pathname<span class="op">)</span> <span class="op">:</span> AcceptableFileEntity<span class="op">{</span><span class="bu">std::</span>move<span class="op">(</span>pathname<span class="op">)}</span> <span class="op">{}</span></span>
<span id="cb154-43"><a href="#cb154-43" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<h2 id="observer">Observer <a id="SS_2_22"></a></h2>
<p>Observerは、クラスSubjectと複数のクラスObserverN(N = 0, 1, 2
…)があり、
この関係が下記の条件を満たさなければならない場合に使用されるパターンである。</p>
<ul>
<li>ObserverNオブジェクトはSubjectオブジェクトが変更された際、その変更通知を受け取る。</li>
<li>SubjectはObserverNへ依存してはならない。</li>
</ul>
<p>GUIアプリケーションを<a
href="#SS_2_23">MVC</a>で実装する場合のModelがSubjectであり、
ViewがObserverNである。</p>
<p>まずは、このパターンを使用しない実装例を示す。</p>
<div class="sourceCode" id="cb155"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/observer_ng.h 6</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@class</span><span class="co"> </span><span class="cv">ObserberNG_N</span></span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@brief</span><span class="co"> SubjectNGからの変更通知をUpdate()で受け取る。</span></span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">///        Observerパターンを使用しない例。</span></span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> ObserverNG_0 <span class="op">{</span></span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a>        ObserverNG_0<span class="op">()</span> <span class="op">=</span> <span class="cf">default</span><span class="op">;</span></span>
<span id="cb155-9"><a href="#cb155-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-10"><a href="#cb155-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span> Update<span class="op">(</span>SubjectNG <span class="at">const</span><span class="op">&amp;</span> subject<span class="op">)</span>  <span class="co">// テストのためにvirtual</span></span>
<span id="cb155-11"><a href="#cb155-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb155-12"><a href="#cb155-12" aria-hidden="true" tabindex="-1"></a>            <span class="co">// 何らかの処理</span></span>
<span id="cb155-13"><a href="#cb155-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb155-14"><a href="#cb155-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-15"><a href="#cb155-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="op">~</span>ObserverNG_0<span class="op">()</span> <span class="op">=</span> <span class="cf">default</span><span class="op">;</span></span>
<span id="cb155-16"><a href="#cb155-16" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 何らかの定義、宣言</span></span>
<span id="cb155-17"><a href="#cb155-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb155-18"><a href="#cb155-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-19"><a href="#cb155-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> ObserverNG_1 <span class="op">{</span></span>
<span id="cb155-20"><a href="#cb155-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb155-21"><a href="#cb155-21" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb155-22"><a href="#cb155-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb155-23"><a href="#cb155-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-24"><a href="#cb155-24" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> ObserverNG_2 <span class="op">{</span></span>
<span id="cb155-25"><a href="#cb155-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb155-26"><a href="#cb155-26" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb155-27"><a href="#cb155-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb156"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/observer_ng.cpp 6</span></span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> ObserverNG_1<span class="op">::</span>Update<span class="op">(</span>SubjectNG <span class="at">const</span><span class="op">&amp;</span> subject<span class="op">)</span></span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb156-6"><a href="#cb156-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb156-7"><a href="#cb156-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-8"><a href="#cb156-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> ObserverNG_2<span class="op">::</span>Update<span class="op">(</span>SubjectNG <span class="at">const</span><span class="op">&amp;</span> subject<span class="op">)</span></span>
<span id="cb156-9"><a href="#cb156-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb156-10"><a href="#cb156-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb156-11"><a href="#cb156-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb157"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/subject_ng.h 9</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@class</span><span class="co"> </span><span class="cv">SubjectNG</span></span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@brief</span><span class="co"> 監視されるクラス。SetNumでの状態変更をObserverNG_Nに通知する。</span></span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">///        Observerパターンを使用しない例。</span></span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> SubjectNG <span class="kw">final</span> <span class="op">{</span></span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb157-8"><a href="#cb157-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> SubjectNG<span class="op">(</span>ObserverNG_0<span class="op">&amp;</span> ng_0<span class="op">,</span> ObserverNG_1<span class="op">&amp;</span> ng_1<span class="op">,</span> ObserverNG_2<span class="op">&amp;</span> ng_2<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb157-9"><a href="#cb157-9" aria-hidden="true" tabindex="-1"></a>            <span class="op">:</span> <span class="va">num_</span><span class="op">{</span><span class="dv">0</span><span class="op">},</span> <span class="va">ng_0_</span><span class="op">{</span>ng_0<span class="op">},</span> <span class="va">ng_1_</span><span class="op">{</span>ng_1<span class="op">},</span> <span class="va">ng_2_</span><span class="op">{</span>ng_2<span class="op">}</span></span>
<span id="cb157-10"><a href="#cb157-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb157-11"><a href="#cb157-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb157-12"><a href="#cb157-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-13"><a href="#cb157-13" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> SetNum<span class="op">(</span><span class="dt">uint32_t</span> num<span class="op">);</span></span>
<span id="cb157-14"><a href="#cb157-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb157-15"><a href="#cb157-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb158"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/subject_ng.cpp 4</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> SubjectNG<span class="op">::</span>SetNum<span class="op">(</span><span class="dt">uint32_t</span> num<span class="op">)</span></span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span><span class="va">num_</span> <span class="op">==</span> num<span class="op">)</span> <span class="op">{</span></span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span><span class="op">;</span></span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-9"><a href="#cb158-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">num_</span> <span class="op">=</span> num<span class="op">;</span></span>
<span id="cb158-10"><a href="#cb158-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-11"><a href="#cb158-11" aria-hidden="true" tabindex="-1"></a>        notify<span class="op">();</span>  <span class="co">// subjectが変更されたことをobserverへ通知</span></span>
<span id="cb158-12"><a href="#cb158-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb158-13"><a href="#cb158-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-14"><a href="#cb158-14" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> SubjectNG<span class="op">::</span>notify<span class="op">()</span></span>
<span id="cb158-15"><a href="#cb158-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb158-16"><a href="#cb158-16" aria-hidden="true" tabindex="-1"></a>        <span class="va">ng_0_</span><span class="op">.</span>Update<span class="op">(*</span><span class="kw">this</span><span class="op">);</span></span>
<span id="cb158-17"><a href="#cb158-17" aria-hidden="true" tabindex="-1"></a>        <span class="va">ng_1_</span><span class="op">.</span>Update<span class="op">(*</span><span class="kw">this</span><span class="op">);</span></span>
<span id="cb158-18"><a href="#cb158-18" aria-hidden="true" tabindex="-1"></a>        <span class="va">ng_2_</span><span class="op">.</span>Update<span class="op">(*</span><span class="kw">this</span><span class="op">);</span></span>
<span id="cb158-19"><a href="#cb158-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb159"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/observer_ut.cpp 15</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> ObserverNG_0_Test <span class="op">:</span> ObserverNG_0 <span class="op">{</span>  <span class="co">// テスト用クラス</span></span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span> Update<span class="op">(</span>SubjectNG <span class="at">const</span><span class="op">&amp;</span> subject<span class="op">)</span> <span class="kw">final</span></span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a>            <span class="op">++</span>call_count<span class="op">;</span></span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true" tabindex="-1"></a>            num <span class="op">=</span> subject<span class="op">.</span>GetNum<span class="op">();</span></span>
<span id="cb159-8"><a href="#cb159-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb159-9"><a href="#cb159-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-10"><a href="#cb159-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">uint32_t</span>                call_count<span class="op">{</span><span class="dv">0</span><span class="op">};</span></span>
<span id="cb159-11"><a href="#cb159-11" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>optional<span class="op">&lt;</span><span class="dt">uint32_t</span><span class="op">&gt;</span> num<span class="op">{};</span></span>
<span id="cb159-12"><a href="#cb159-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb159-13"><a href="#cb159-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-14"><a href="#cb159-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> ng0 <span class="op">=</span> ObserverNG_0_Test<span class="op">{};</span></span>
<span id="cb159-15"><a href="#cb159-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> ng1 <span class="op">=</span> ObserverNG_1<span class="op">{};</span></span>
<span id="cb159-16"><a href="#cb159-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> ng2 <span class="op">=</span> ObserverNG_2<span class="op">{};</span></span>
<span id="cb159-17"><a href="#cb159-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-18"><a href="#cb159-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> subject <span class="op">=</span> SubjectNG<span class="op">{</span>ng0<span class="op">,</span> ng1<span class="op">,</span> ng2<span class="op">};</span></span>
<span id="cb159-19"><a href="#cb159-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-20"><a href="#cb159-20" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">0</span><span class="op">,</span> ng0<span class="op">.</span>call_count<span class="op">);</span>  <span class="co">// まだ何もしていない</span></span>
<span id="cb159-21"><a href="#cb159-21" aria-hidden="true" tabindex="-1"></a>    ASSERT_FALSE<span class="op">(</span>ng0<span class="op">.</span>num<span class="op">);</span></span>
<span id="cb159-22"><a href="#cb159-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-23"><a href="#cb159-23" aria-hidden="true" tabindex="-1"></a>    subject<span class="op">.</span>SetNum<span class="op">(</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb159-24"><a href="#cb159-24" aria-hidden="true" tabindex="-1"></a>    subject<span class="op">.</span>SetNum<span class="op">(</span><span class="dv">2</span><span class="op">);</span></span>
<span id="cb159-25"><a href="#cb159-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-26"><a href="#cb159-26" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">2</span><span class="op">,</span> ng0<span class="op">.</span>call_count<span class="op">);</span></span>
<span id="cb159-27"><a href="#cb159-27" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">2</span><span class="op">,</span> <span class="op">*</span>ng0<span class="op">.</span>num<span class="op">);</span></span>
<span id="cb159-28"><a href="#cb159-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-29"><a href="#cb159-29" aria-hidden="true" tabindex="-1"></a>    subject<span class="op">.</span>SetNum<span class="op">(</span><span class="dv">2</span><span class="op">);</span>  <span class="co">// 同じ値をセットしたため、Updateは呼ばれないはず</span></span>
<span id="cb159-30"><a href="#cb159-30" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">2</span><span class="op">,</span> ng0<span class="op">.</span>call_count<span class="op">);</span></span>
<span id="cb159-31"><a href="#cb159-31" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">2</span><span class="op">,</span> <span class="op">*</span>ng0<span class="op">.</span>num<span class="op">);</span></span></code></pre></div>
<p>上記実装例のクラス図を下記する。
これを見ればわかるように、クラスSubjectNGとクラスObserverNG_Nは相互依存しており、機能追加、
修正が難しいだけではなく、この図の通りにパッケージを分割した場合
(パッケージがライブラリとなると前提）、リンクすら難しくなる。</p>
<p>
<img src="data:image/png;base64,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" />
</p>
<p>このようなクラス間の依存関係は下記のようにファイル間の依存関係に反映される。
このような相互依存は、差分ビルドの長時間化等の問題も引き起こす。</p>
<p>
<img src="data:image/png;base64,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" />
</p>
<p>次に、上記にObserverパターンを適用した実装例
(Subjectを抽象クラスにすることもあるが、下記例ではSubjectを具象クラスにしている)を示す。</p>
<div class="sourceCode" id="cb160"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/observer_ok.h 3</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@class</span><span class="co"> </span><span class="cv">ObserverOK_0</span></span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@brief</span><span class="co"> SubjectOKからの変更通知をUpdate()で受け取る。</span></span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">///        Observerパターンの使用例。</span></span>
<span id="cb160-6"><a href="#cb160-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> ObserverOK_0 <span class="op">:</span> <span class="kw">public</span> Observer <span class="op">{</span></span>
<span id="cb160-7"><a href="#cb160-7" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb160-8"><a href="#cb160-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb160-9"><a href="#cb160-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span> update<span class="op">(</span>SubjectOK <span class="at">const</span><span class="op">&amp;</span> subject<span class="op">)</span> <span class="kw">override</span><span class="op">;</span></span>
<span id="cb160-10"><a href="#cb160-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb160-11"><a href="#cb160-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-12"><a href="#cb160-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> ObserverOK_1 <span class="op">:</span> <span class="kw">public</span> Observer <span class="op">{</span></span>
<span id="cb160-13"><a href="#cb160-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb160-14"><a href="#cb160-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb160-15"><a href="#cb160-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span> update<span class="op">(</span>SubjectOK <span class="at">const</span><span class="op">&amp;</span> subject<span class="op">)</span> <span class="kw">override</span><span class="op">;</span></span>
<span id="cb160-16"><a href="#cb160-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb160-17"><a href="#cb160-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-18"><a href="#cb160-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> ObserverOK_2 <span class="op">:</span> <span class="kw">public</span> Observer <span class="op">{</span></span>
<span id="cb160-19"><a href="#cb160-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb160-20"><a href="#cb160-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb160-21"><a href="#cb160-21" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span> update<span class="op">(</span>SubjectOK <span class="at">const</span><span class="op">&amp;</span> subject<span class="op">)</span> <span class="kw">override</span><span class="op">;</span></span>
<span id="cb160-22"><a href="#cb160-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb161"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/observer_ok.cpp 5</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> ObserverOK_0<span class="op">::</span>update<span class="op">(</span>SubjectOK <span class="at">const</span><span class="op">&amp;</span> subject<span class="op">)</span></span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-8"><a href="#cb161-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> ObserverOK_1<span class="op">::</span>update<span class="op">(</span>SubjectOK <span class="at">const</span><span class="op">&amp;</span> subject<span class="op">)</span></span>
<span id="cb161-9"><a href="#cb161-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb161-10"><a href="#cb161-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb161-11"><a href="#cb161-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb161-12"><a href="#cb161-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-13"><a href="#cb161-13" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> ObserverOK_2<span class="op">::</span>update<span class="op">(</span>SubjectOK <span class="at">const</span><span class="op">&amp;</span> subject<span class="op">)</span></span>
<span id="cb161-14"><a href="#cb161-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb161-15"><a href="#cb161-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb161-16"><a href="#cb161-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb162"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/subject_ok.h 8</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@class</span><span class="co"> </span><span class="cv">SubjectOK</span></span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@brief</span><span class="co"> 監視されるクラス。SetNumでの状態変更をObserverOK_Nに通知する。</span></span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">///        Observerパターンの使用例。</span></span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> SubjectOK <span class="kw">final</span> <span class="op">{</span></span>
<span id="cb162-7"><a href="#cb162-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb162-8"><a href="#cb162-8" aria-hidden="true" tabindex="-1"></a>        SubjectOK<span class="op">()</span> <span class="op">:</span> <span class="va">observers_</span><span class="op">{},</span> <span class="va">num_</span><span class="op">{</span><span class="dv">0</span><span class="op">}</span> <span class="op">{}</span></span>
<span id="cb162-9"><a href="#cb162-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-10"><a href="#cb162-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> SetNum<span class="op">(</span><span class="dt">uint32_t</span> num<span class="op">)</span></span>
<span id="cb162-11"><a href="#cb162-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb162-12"><a href="#cb162-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span><span class="va">num_</span> <span class="op">==</span> num<span class="op">)</span> <span class="op">{</span></span>
<span id="cb162-13"><a href="#cb162-13" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span><span class="op">;</span></span>
<span id="cb162-14"><a href="#cb162-14" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb162-15"><a href="#cb162-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-16"><a href="#cb162-16" aria-hidden="true" tabindex="-1"></a>            <span class="va">num_</span> <span class="op">=</span> num<span class="op">;</span></span>
<span id="cb162-17"><a href="#cb162-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-18"><a href="#cb162-18" aria-hidden="true" tabindex="-1"></a>            notify<span class="op">();</span>  <span class="co">// subjectが変更されたことをobserverへ通知</span></span>
<span id="cb162-19"><a href="#cb162-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb162-20"><a href="#cb162-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-21"><a href="#cb162-21" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span>     Attach<span class="op">(</span>Observer<span class="op">&amp;</span> observer<span class="op">);</span>           <span class="co">// Observerの登録</span></span>
<span id="cb162-22"><a href="#cb162-22" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span>     Detach<span class="op">(</span>Observer<span class="op">&amp;</span> observer<span class="op">)</span> <span class="kw">noexcept</span><span class="op">;</span>  <span class="co">// Observerの登録解除</span></span>
<span id="cb162-23"><a href="#cb162-23" aria-hidden="true" tabindex="-1"></a>        <span class="dt">uint32_t</span> GetNum<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">num_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb162-24"><a href="#cb162-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-25"><a href="#cb162-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb162-26"><a href="#cb162-26" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> notify<span class="op">()</span> <span class="at">const</span><span class="op">;</span></span>
<span id="cb162-27"><a href="#cb162-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-28"><a href="#cb162-28" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>list<span class="op">&lt;</span>Observer<span class="op">*&gt;</span> <span class="va">observers_</span><span class="op">;</span></span>
<span id="cb162-29"><a href="#cb162-29" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb162-30"><a href="#cb162-30" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb162-31"><a href="#cb162-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-32"><a href="#cb162-32" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@class</span><span class="co"> </span><span class="cv">Observer</span></span>
<span id="cb162-33"><a href="#cb162-33" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@brief</span><span class="co"> SubjectOKを監視するクラスの基底クラス</span></span>
<span id="cb162-34"><a href="#cb162-34" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Observer <span class="op">{</span></span>
<span id="cb162-35"><a href="#cb162-35" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb162-36"><a href="#cb162-36" aria-hidden="true" tabindex="-1"></a>        Observer<span class="op">()</span> <span class="op">=</span> <span class="cf">default</span><span class="op">;</span></span>
<span id="cb162-37"><a href="#cb162-37" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> Update<span class="op">(</span>SubjectOK <span class="at">const</span><span class="op">&amp;</span> subject<span class="op">)</span> <span class="op">{</span> update<span class="op">(</span>subject<span class="op">);</span> <span class="op">}</span></span>
<span id="cb162-38"><a href="#cb162-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-39"><a href="#cb162-39" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb162-40"><a href="#cb162-40" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb162-41"><a href="#cb162-41" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span> update<span class="op">(</span>SubjectOK <span class="at">const</span><span class="op">&amp;</span> subject<span class="op">)</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb162-42"><a href="#cb162-42" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb162-43"><a href="#cb162-43" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb163"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/subject_ok.cpp 3</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> SubjectOK<span class="op">::</span>Attach<span class="op">(</span>Observer<span class="op">&amp;</span> observer_to_attach<span class="op">)</span> <span class="op">{</span> <span class="va">observers_</span><span class="op">.</span>push_back<span class="op">(&amp;</span>observer_to_attach<span class="op">);</span> <span class="op">}</span></span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> SubjectOK<span class="op">::</span>Detach<span class="op">(</span>Observer<span class="op">&amp;</span> observer_to_detach<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb163-7"><a href="#cb163-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">observers_</span><span class="op">.</span>remove_if<span class="op">(</span></span>
<span id="cb163-8"><a href="#cb163-8" aria-hidden="true" tabindex="-1"></a>            <span class="op">[&amp;</span>observer_to_detach<span class="op">](</span>Observer<span class="op">*</span> observer<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> <span class="op">&amp;</span>observer_to_detach <span class="op">==</span> observer<span class="op">;</span> <span class="op">});</span></span>
<span id="cb163-9"><a href="#cb163-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb163-10"><a href="#cb163-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-11"><a href="#cb163-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> SubjectOK<span class="op">::</span>notify<span class="op">()</span> <span class="at">const</span></span>
<span id="cb163-12"><a href="#cb163-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb163-13"><a href="#cb163-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> observer <span class="op">:</span> <span class="va">observers_</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb163-14"><a href="#cb163-14" aria-hidden="true" tabindex="-1"></a>            observer<span class="op">-&gt;</span>Update<span class="op">(*</span><span class="kw">this</span><span class="op">);</span></span>
<span id="cb163-15"><a href="#cb163-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb163-16"><a href="#cb163-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb164"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/observer_ut.cpp 51</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> ObserverOK_Test <span class="op">:</span> Observer <span class="op">{</span>  <span class="co">// テスト用クラス</span></span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span> update<span class="op">(</span>SubjectOK <span class="at">const</span><span class="op">&amp;</span> subject<span class="op">)</span> <span class="kw">final</span></span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb164-6"><a href="#cb164-6" aria-hidden="true" tabindex="-1"></a>            <span class="op">++</span>call_count<span class="op">;</span></span>
<span id="cb164-7"><a href="#cb164-7" aria-hidden="true" tabindex="-1"></a>            num <span class="op">=</span> subject<span class="op">.</span>GetNum<span class="op">();</span></span>
<span id="cb164-8"><a href="#cb164-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb164-9"><a href="#cb164-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-10"><a href="#cb164-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">uint32_t</span>                call_count<span class="op">{</span><span class="dv">0</span><span class="op">};</span></span>
<span id="cb164-11"><a href="#cb164-11" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>optional<span class="op">&lt;</span><span class="dt">uint32_t</span><span class="op">&gt;</span> num<span class="op">{};</span></span>
<span id="cb164-12"><a href="#cb164-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb164-13"><a href="#cb164-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-14"><a href="#cb164-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> ok0 <span class="op">=</span> ObserverOK_Test<span class="op">{};</span></span>
<span id="cb164-15"><a href="#cb164-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> ok1 <span class="op">=</span> ObserverOK_1<span class="op">{};</span></span>
<span id="cb164-16"><a href="#cb164-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> ok2 <span class="op">=</span> ObserverOK_2<span class="op">{};</span></span>
<span id="cb164-17"><a href="#cb164-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-18"><a href="#cb164-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> subject <span class="op">=</span> SubjectOK<span class="op">{};</span></span>
<span id="cb164-19"><a href="#cb164-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-20"><a href="#cb164-20" aria-hidden="true" tabindex="-1"></a>    subject<span class="op">.</span>Attach<span class="op">(</span>ok0<span class="op">);</span></span>
<span id="cb164-21"><a href="#cb164-21" aria-hidden="true" tabindex="-1"></a>    subject<span class="op">.</span>Attach<span class="op">(</span>ok1<span class="op">);</span></span>
<span id="cb164-22"><a href="#cb164-22" aria-hidden="true" tabindex="-1"></a>    subject<span class="op">.</span>Attach<span class="op">(</span>ok2<span class="op">);</span></span>
<span id="cb164-23"><a href="#cb164-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-24"><a href="#cb164-24" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">0</span><span class="op">,</span> ok0<span class="op">.</span>call_count<span class="op">);</span>  <span class="co">// まだ何もしていない</span></span>
<span id="cb164-25"><a href="#cb164-25" aria-hidden="true" tabindex="-1"></a>    ASSERT_FALSE<span class="op">(</span>ok0<span class="op">.</span>num<span class="op">);</span></span>
<span id="cb164-26"><a href="#cb164-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-27"><a href="#cb164-27" aria-hidden="true" tabindex="-1"></a>    subject<span class="op">.</span>SetNum<span class="op">(</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb164-28"><a href="#cb164-28" aria-hidden="true" tabindex="-1"></a>    subject<span class="op">.</span>SetNum<span class="op">(</span><span class="dv">2</span><span class="op">);</span></span>
<span id="cb164-29"><a href="#cb164-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-30"><a href="#cb164-30" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">2</span><span class="op">,</span> ok0<span class="op">.</span>call_count<span class="op">);</span></span>
<span id="cb164-31"><a href="#cb164-31" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">2</span><span class="op">,</span> <span class="op">*</span>ok0<span class="op">.</span>num<span class="op">);</span></span>
<span id="cb164-32"><a href="#cb164-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-33"><a href="#cb164-33" aria-hidden="true" tabindex="-1"></a>    subject<span class="op">.</span>SetNum<span class="op">(</span><span class="dv">2</span><span class="op">);</span>  <span class="co">// 同じ値をセットしたため、Updateは呼ばれないはず</span></span>
<span id="cb164-34"><a href="#cb164-34" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">2</span><span class="op">,</span> ok0<span class="op">.</span>call_count<span class="op">);</span></span>
<span id="cb164-35"><a href="#cb164-35" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">2</span><span class="op">,</span> <span class="op">*</span>ok0<span class="op">.</span>num<span class="op">);</span></span></code></pre></div>
<p>上記実装例のクラス図を下記する。
Observerパターンを使用しない例と比べると、
クラスSubjectOKとクラスObserverOK_Nとの相互依存が消えたことがわかる。</p>
<p>
<img src="data:image/png;base64,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FsYrxtaIXbZcqRihUNGQVvjll1+69ej+VNMGczctxCRC/eMsdbr36E59twnF7UbmEA1Qq3P3zk82qX9dKj7drFHPXj2VihGIzCEafK/YrX7Tp65LxatesWcPpWIEQkVDmuDKlSvtO7TvNqTH+0fXB5qE84863QZ3b9++vX7LKNKQCUQDpGob37bzC11TSMXew/p06NBBqRhpyASiAVLFt4/vOrh7CqnYfUhPvKhSMdKgoiFNMG3atLZdnw+0hDD/2nZ7nqvchm4E27dvP3funFuquAVkAtEwecobLbu0DuRbmH+dena+FSpevnz5o48+0tfSqYtMIBqmTp3apmvbQL6F+fd89/hboSLYsmXLDz/84JYqbgEqGlIf33zzTZXoKkv3vRdoA2H+Ub9KdFWudZu7FrjjGjVqZMmShaeuVq3aunXrzKlSpUqtWbPGqhspwOxLlixJh3PmzNmsWTMmS8qJLsWLF9+3b598/OKLLypWrDh58mRzoYPhw4eXKFGCdnLlytWpU6dLly65NVIbGV00QKfKVSvfKBVX7E+Mjom+LhVnzJgB5WRamzZteuTIESn/8ssvKWRyr61++3Hx4sV+/frdd999dI+//fv3NxTCrB599FFTc9myZWXLlv34449NiYPZs2c3b968dOnSXbp0cc+lDTK6aLhpr1g1BV7x/fffj4mJYVpxjDVr1rQn7v7779+6datVNyLw+++/T5gwoVixYvT57rvvbt269ddffy2neFi84rFjx+Tj3r17YSZ8++/F14KmYDWNZMuWrVWrVpDcrZHaUNGQ+sC8+4zo57B/xeeJbfvGP1i8cJY7s9x9T66omlXz3ptv/IIEu07fEf251m3Owvr163PkyDFp0qSffvrp559/xmvz8b333pOzkSkaiPQPPPBAYmIiqefZs2c7d+5csGBBsRAegbnbsWMHx0gHyl955RX3eguDBg0ib7hy5QqGxMN2797drZHayOiiYdZfZnUb1vMmqDhk5LDwVGSmcMerVq3CZ+Hmunbtyix/9dVXXqSKBmhDOEFn79+/n4+fffYZYaZ27dq//fab50ede+65R2rOnTs3d+7clNiXOxg9enRCQkKLFi0aN27snksbZHTRQP97De9zE1Ts/9LA8FRE4eEGZ86ciT/BMU6cOBEViwqUs5EpGnr16lWkSJENGzZwfPLkSYI9AkJ+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" />
</p>
<p>最後に、上記のファイルの依存関係を示す。
ファイル(パッケージ)の依存関係においてもSubjectOKはObserverOKに依存していないことがわかる
(MVCに置き換えると、ModelはViewに依存していない状態であるといえる)。</p>
<p>
<img src="data:image/png;base64,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" />
</p>
<h2 id="mvc">MVC <a id="SS_2_23"></a></h2>
<p>MVCはデザインパターンと言うよりもアーキテクチャパターンである。
一般にGUIアプリケーションのアーキテクチャに使用されるが、
外部からの非同期要求を処理するアプリケーションのアーキテクチャにも相性が良い。</p>
<p>MVCのそれぞれのアルファベットの意味は、下記テーブルの通りである。</p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: left;">MVC</th>
<th style="text-align: left;">主な役割</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">M</td>
<td style="text-align: left;">Model</td>
<td style="text-align: left;">ビジネスロジックの処理</td>
</tr>
<tr class="even">
<td style="text-align: center;">V</td>
<td style="text-align: left;">View</td>
<td style="text-align: left;">UIへの出力</td>
</tr>
<tr class="odd">
<td style="text-align: center;">C</td>
<td style="text-align: left;">Controller</td>
<td style="text-align: left;">入力をModelへ送信</td>
</tr>
</tbody>
</table>
<p>下記はMVCの概念モデルである(矢印は制御の流れであって、依存関係ではない)。</p>
<p>
<img src="data:image/png;base64,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" />
</p>
<p>制御の流れは、</p>
<ol type="1">
<li>ユーザの入力に応じてControllerのメソッドが呼び出される。</li>
<li>Controllerのメソッドは、ユーザの入力に応じた引数とともにModelのメソッドを呼び出す。</li>
<li>Modelは、それに対応するビジネスロジック等の処理を(通常、非同期に)行い、
自分自身の状態を変える(変わらないこともある)。</li>
<li>Modelの状態変化は、そのModelのオブザーバーとして登録されているViewに通知される。</li>
<li>Viewは関連するデータをModelから取得し、それを出力(UIに表示)する。</li>
</ol>
<p>ViewはModelの<a
href="#SS_2_22">Observer</a>であるため、ModelはViewへ依存しない。
多々あるMVC派生パターンすべてで、そのような依存関係は存在しない
(具体的なパターンの選択はプロジェクトで使用するGUIフレームワークに強く依存する)。</p>
<p>そのようにする理由は下記の通りで、極めて重要な規則である。</p>
<ul>
<li>GUIのテストは目で見る必要がある(ことが多い)ため、Viewに自動単体テストを実施することは困難である。
一方、ViewがModelに依存しないのであれば、Modelは自動単体テストをすることが可能である。</li>
<li>通常、Viewの仕様は不安定で、Modelの仕様は安定しているため、Modelのソースコード変更は
Viewのそれよりもかなり少ない。
しかし、ModelがViewに依存してしまうと、Viewに影響されModelのソースコード変更も多くなる。</li>
</ul>
<h2 id="cでのクラス表現">Cでのクラス表現 <a id="SS_2_24"></a></h2>
<p>このドキュメントは、C++でのソフトウェア開発を前提としているため、
ここで示したコードもC++で書いているが、</p>
<ul>
<li>何らかの事情でCを使わざるを得ないプログラマがデザインパターンを使用できるようにする</li>
<li>クラスの理解が曖昧なC++プログラマの理解を助ける(「<a
href="#SS_5_2_11">クラスのレイアウト</a>」参照)</li>
</ul>
<p>ような目的のためにCでのクラスの実現方法を例示する。</p>
<p>下記のような基底クラスPointとその派生クラスPoint3Dがあった場合、</p>
<p>
<img src="data:image/png;base64,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" />
</p>
<p>C++では、Pointのコードは下記のように表すことが一般的である。</p>
<div class="sourceCode" id="cb165"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/class_ut.cpp 7</span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Point <span class="op">{</span></span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> Point<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">:</span> <span class="va">x_</span><span class="op">{</span>x<span class="op">},</span> <span class="va">y_</span><span class="op">{</span>y<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="op">~</span>Point<span class="op">()</span> <span class="op">=</span> <span class="cf">default</span><span class="op">;</span></span>
<span id="cb165-7"><a href="#cb165-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-8"><a href="#cb165-8" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> SetXY<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb165-9"><a href="#cb165-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb165-10"><a href="#cb165-10" aria-hidden="true" tabindex="-1"></a>            <span class="va">x_</span> <span class="op">=</span> x<span class="op">;</span></span>
<span id="cb165-11"><a href="#cb165-11" aria-hidden="true" tabindex="-1"></a>            <span class="va">y_</span> <span class="op">=</span> y<span class="op">;</span></span>
<span id="cb165-12"><a href="#cb165-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb165-13"><a href="#cb165-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-14"><a href="#cb165-14" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> GetXY<span class="op">(</span><span class="dt">int</span><span class="op">&amp;</span> x<span class="op">,</span> <span class="dt">int</span><span class="op">&amp;</span> y<span class="op">)</span> <span class="at">const</span> <span class="kw">noexcept</span></span>
<span id="cb165-15"><a href="#cb165-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb165-16"><a href="#cb165-16" aria-hidden="true" tabindex="-1"></a>            x <span class="op">=</span> <span class="va">x_</span><span class="op">;</span></span>
<span id="cb165-17"><a href="#cb165-17" aria-hidden="true" tabindex="-1"></a>            y <span class="op">=</span> <span class="va">y_</span><span class="op">;</span></span>
<span id="cb165-18"><a href="#cb165-18" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb165-19"><a href="#cb165-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-20"><a href="#cb165-20" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">int</span> Quantity<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">x_</span> <span class="op">*</span> <span class="va">y_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb165-21"><a href="#cb165-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-22"><a href="#cb165-22" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span> Multipy<span class="op">(</span><span class="dt">int</span> m<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb165-23"><a href="#cb165-23" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb165-24"><a href="#cb165-24" aria-hidden="true" tabindex="-1"></a>            <span class="va">x_</span> <span class="op">*=</span> m<span class="op">;</span></span>
<span id="cb165-25"><a href="#cb165-25" aria-hidden="true" tabindex="-1"></a>            <span class="va">y_</span> <span class="op">*=</span> m<span class="op">;</span></span>
<span id="cb165-26"><a href="#cb165-26" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb165-27"><a href="#cb165-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-28"><a href="#cb165-28" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb165-29"><a href="#cb165-29" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> <span class="va">x_</span><span class="op">;</span></span>
<span id="cb165-30"><a href="#cb165-30" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> <span class="va">y_</span><span class="op">;</span></span>
<span id="cb165-31"><a href="#cb165-31" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>この単体テストは、下記のようになる。</p>
<div class="sourceCode" id="cb166"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/class_ut.cpp 42</span></span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a>    Point a<span class="op">{</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">};</span></span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-5"><a href="#cb166-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> x<span class="op">;</span></span>
<span id="cb166-6"><a href="#cb166-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> y<span class="op">;</span></span>
<span id="cb166-7"><a href="#cb166-7" aria-hidden="true" tabindex="-1"></a>    a<span class="op">.</span>GetXY<span class="op">(</span>x<span class="op">,</span> y<span class="op">);</span></span>
<span id="cb166-8"><a href="#cb166-8" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>x<span class="op">,</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb166-9"><a href="#cb166-9" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>y<span class="op">,</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb166-10"><a href="#cb166-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-11"><a href="#cb166-11" aria-hidden="true" tabindex="-1"></a>    a<span class="op">.</span>SetXY<span class="op">(</span><span class="dv">3</span><span class="op">,</span> <span class="dv">4</span><span class="op">);</span></span>
<span id="cb166-12"><a href="#cb166-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-13"><a href="#cb166-13" aria-hidden="true" tabindex="-1"></a>    a<span class="op">.</span>GetXY<span class="op">(</span>x<span class="op">,</span> y<span class="op">);</span></span>
<span id="cb166-14"><a href="#cb166-14" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>x<span class="op">,</span> <span class="dv">3</span><span class="op">);</span></span>
<span id="cb166-15"><a href="#cb166-15" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>y<span class="op">,</span> <span class="dv">4</span><span class="op">);</span></span>
<span id="cb166-16"><a href="#cb166-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-17"><a href="#cb166-17" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>a<span class="op">.</span>Quantity<span class="op">(),</span> <span class="dv">12</span><span class="op">);</span></span>
<span id="cb166-18"><a href="#cb166-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-19"><a href="#cb166-19" aria-hidden="true" tabindex="-1"></a>    a<span class="op">.</span>Multipy<span class="op">(</span><span class="dv">2</span><span class="op">);</span></span>
<span id="cb166-20"><a href="#cb166-20" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>a<span class="op">.</span>Quantity<span class="op">(),</span> <span class="dv">48</span><span class="op">);</span></span></code></pre></div>
<p>これをCで表した場合、下記のようになる。</p>
<div class="sourceCode" id="cb167"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/class_ut.cpp 124</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> Point <span class="op">{</span></span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> x<span class="op">;</span></span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> y<span class="op">;</span></span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-7"><a href="#cb167-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> <span class="op">(*</span><span class="at">const</span> Quantity<span class="op">)(</span>Point <span class="at">const</span><span class="op">*</span> self<span class="op">);</span></span>
<span id="cb167-8"><a href="#cb167-8" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> <span class="op">(*</span><span class="at">const</span> Multipy<span class="op">)(</span>Point<span class="op">*</span> self<span class="op">,</span> <span class="dt">int</span> m<span class="op">);</span></span>
<span id="cb167-9"><a href="#cb167-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb167-10"><a href="#cb167-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-11"><a href="#cb167-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">static</span> <span class="dt">int</span> point_quantity<span class="op">(</span>Point <span class="at">const</span><span class="op">*</span> self<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> self<span class="op">-&gt;</span>x <span class="op">*</span> self<span class="op">-&gt;</span>y<span class="op">;</span> <span class="op">}</span></span>
<span id="cb167-12"><a href="#cb167-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-13"><a href="#cb167-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">static</span> <span class="dt">void</span> point_multipy<span class="op">(</span>Point<span class="op">*</span> self<span class="op">,</span> <span class="dt">int</span> m<span class="op">)</span></span>
<span id="cb167-14"><a href="#cb167-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb167-15"><a href="#cb167-15" aria-hidden="true" tabindex="-1"></a>        self<span class="op">-&gt;</span>x <span class="op">*=</span> m<span class="op">;</span></span>
<span id="cb167-16"><a href="#cb167-16" aria-hidden="true" tabindex="-1"></a>        self<span class="op">-&gt;</span>y <span class="op">*=</span> m<span class="op">;</span></span>
<span id="cb167-17"><a href="#cb167-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb167-18"><a href="#cb167-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-19"><a href="#cb167-19" aria-hidden="true" tabindex="-1"></a>    Point Point_Construct<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">)</span></span>
<span id="cb167-20"><a href="#cb167-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb167-21"><a href="#cb167-21" aria-hidden="true" tabindex="-1"></a>        Point ret <span class="op">=</span> <span class="op">{</span>x<span class="op">,</span> y<span class="op">,</span> point_quantity<span class="op">,</span> point_multipy<span class="op">};</span>  <span class="co">// C言語のつもり</span></span>
<span id="cb167-22"><a href="#cb167-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-23"><a href="#cb167-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> ret<span class="op">;</span></span>
<span id="cb167-24"><a href="#cb167-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb167-25"><a href="#cb167-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-26"><a href="#cb167-26" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> Point_SetXY<span class="op">(</span>Point<span class="op">*</span> self<span class="op">,</span> <span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">)</span></span>
<span id="cb167-27"><a href="#cb167-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb167-28"><a href="#cb167-28" aria-hidden="true" tabindex="-1"></a>        self<span class="op">-&gt;</span>x <span class="op">=</span> x<span class="op">;</span></span>
<span id="cb167-29"><a href="#cb167-29" aria-hidden="true" tabindex="-1"></a>        self<span class="op">-&gt;</span>y <span class="op">=</span> y<span class="op">;</span></span>
<span id="cb167-30"><a href="#cb167-30" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb167-31"><a href="#cb167-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-32"><a href="#cb167-32" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> Point_GetXY<span class="op">(</span>Point<span class="op">*</span> self<span class="op">,</span> <span class="dt">int</span><span class="op">*</span> x<span class="op">,</span> <span class="dt">int</span><span class="op">*</span> y<span class="op">)</span></span>
<span id="cb167-33"><a href="#cb167-33" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb167-34"><a href="#cb167-34" aria-hidden="true" tabindex="-1"></a>        <span class="op">*</span>x <span class="op">=</span> self<span class="op">-&gt;</span>x<span class="op">;</span></span>
<span id="cb167-35"><a href="#cb167-35" aria-hidden="true" tabindex="-1"></a>        <span class="op">*</span>y <span class="op">=</span> self<span class="op">-&gt;</span>y<span class="op">;</span></span>
<span id="cb167-36"><a href="#cb167-36" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>C++のメンバ関数はプログラマから見えない引数thisを持つ。
これを表したものが各関数の第1引数selfである。
また、ポリモーフィックな関数は関数ポインタで、
非ポリモーフィックな関数は通常の関数で表される。</p>
<p>この単体テストは、下記のようになる。</p>
<div class="sourceCode" id="cb168"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/class_ut.cpp 164</span></span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>    Point a <span class="op">=</span> Point_Construct<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> x<span class="op">;</span></span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> y<span class="op">;</span></span>
<span id="cb168-7"><a href="#cb168-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-8"><a href="#cb168-8" aria-hidden="true" tabindex="-1"></a>    Point_GetXY<span class="op">(&amp;</span>a<span class="op">,</span> <span class="op">&amp;</span>x<span class="op">,</span> <span class="op">&amp;</span>y<span class="op">);</span></span>
<span id="cb168-9"><a href="#cb168-9" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>x<span class="op">,</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb168-10"><a href="#cb168-10" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>y<span class="op">,</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb168-11"><a href="#cb168-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-12"><a href="#cb168-12" aria-hidden="true" tabindex="-1"></a>    Point_SetXY<span class="op">(&amp;</span>a<span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">4</span><span class="op">);</span></span>
<span id="cb168-13"><a href="#cb168-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-14"><a href="#cb168-14" aria-hidden="true" tabindex="-1"></a>    Point_GetXY<span class="op">(&amp;</span>a<span class="op">,</span> <span class="op">&amp;</span>x<span class="op">,</span> <span class="op">&amp;</span>y<span class="op">);</span></span>
<span id="cb168-15"><a href="#cb168-15" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>x<span class="op">,</span> <span class="dv">3</span><span class="op">);</span></span>
<span id="cb168-16"><a href="#cb168-16" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>y<span class="op">,</span> <span class="dv">4</span><span class="op">);</span></span>
<span id="cb168-17"><a href="#cb168-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-18"><a href="#cb168-18" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>a<span class="op">.</span>Quantity<span class="op">(&amp;</span>a<span class="op">),</span> <span class="dv">12</span><span class="op">);</span></span>
<span id="cb168-19"><a href="#cb168-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-20"><a href="#cb168-20" aria-hidden="true" tabindex="-1"></a>    a<span class="op">.</span>Multipy<span class="op">(&amp;</span>a<span class="op">,</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb168-21"><a href="#cb168-21" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>a<span class="op">.</span>Quantity<span class="op">(&amp;</span>a<span class="op">),</span> <span class="dv">48</span><span class="op">);</span></span></code></pre></div>
<p>Pointから派生したクラスPoint3DのC++での実装を以下に示す。</p>
<div class="sourceCode" id="cb169"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/class_ut.cpp 65</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Point3D <span class="op">:</span> <span class="kw">public</span> Point <span class="op">{</span></span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> Point3D<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">,</span> <span class="dt">int</span> z<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">:</span> Point<span class="op">{</span>x<span class="op">,</span> y<span class="op">},</span> <span class="va">z_</span><span class="op">{</span>z<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb169-6"><a href="#cb169-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-7"><a href="#cb169-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> SetXYZ<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">,</span> <span class="dt">int</span> z<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb169-8"><a href="#cb169-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb169-9"><a href="#cb169-9" aria-hidden="true" tabindex="-1"></a>            SetXY<span class="op">(</span>x<span class="op">,</span> y<span class="op">);</span></span>
<span id="cb169-10"><a href="#cb169-10" aria-hidden="true" tabindex="-1"></a>            <span class="va">z_</span> <span class="op">=</span> z<span class="op">;</span></span>
<span id="cb169-11"><a href="#cb169-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb169-12"><a href="#cb169-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-13"><a href="#cb169-13" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> GetXYZ<span class="op">(</span><span class="dt">int</span><span class="op">&amp;</span> x<span class="op">,</span> <span class="dt">int</span><span class="op">&amp;</span> y<span class="op">,</span> <span class="dt">int</span><span class="op">&amp;</span> z<span class="op">)</span> <span class="at">const</span> <span class="kw">noexcept</span></span>
<span id="cb169-14"><a href="#cb169-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb169-15"><a href="#cb169-15" aria-hidden="true" tabindex="-1"></a>            GetXY<span class="op">(</span>x<span class="op">,</span> y<span class="op">);</span></span>
<span id="cb169-16"><a href="#cb169-16" aria-hidden="true" tabindex="-1"></a>            z <span class="op">=</span> <span class="va">z_</span><span class="op">;</span></span>
<span id="cb169-17"><a href="#cb169-17" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb169-18"><a href="#cb169-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-19"><a href="#cb169-19" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">int</span> Quantity<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="kw">override</span> <span class="op">{</span> <span class="cf">return</span> Point<span class="op">::</span>Quantity<span class="op">()</span> <span class="op">*</span> <span class="va">z_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb169-20"><a href="#cb169-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-21"><a href="#cb169-21" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span> Multipy<span class="op">(</span><span class="dt">int</span> m<span class="op">)</span> <span class="kw">noexcept</span> <span class="kw">override</span></span>
<span id="cb169-22"><a href="#cb169-22" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb169-23"><a href="#cb169-23" aria-hidden="true" tabindex="-1"></a>            Point<span class="op">::</span>Multipy<span class="op">(</span>m<span class="op">);</span></span>
<span id="cb169-24"><a href="#cb169-24" aria-hidden="true" tabindex="-1"></a>            <span class="va">z_</span> <span class="op">*=</span> m<span class="op">;</span></span>
<span id="cb169-25"><a href="#cb169-25" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb169-26"><a href="#cb169-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-27"><a href="#cb169-27" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb169-28"><a href="#cb169-28" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> <span class="va">z_</span><span class="op">;</span></span>
<span id="cb169-29"><a href="#cb169-29" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>この単体テストは、下記のようになる。</p>
<div class="sourceCode" id="cb170"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/class_ut.cpp 98</span></span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span>  a <span class="op">=</span> Point3D<span class="op">{</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">};</span></span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span><span class="op">&amp;</span> b <span class="op">=</span> a<span class="op">;</span></span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-6"><a href="#cb170-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> x <span class="op">=</span> <span class="dt">int</span><span class="op">{};</span></span>
<span id="cb170-7"><a href="#cb170-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> y <span class="op">=</span> <span class="dt">int</span><span class="op">{};</span></span>
<span id="cb170-8"><a href="#cb170-8" aria-hidden="true" tabindex="-1"></a>    b<span class="op">.</span>GetXY<span class="op">(</span>x<span class="op">,</span> y<span class="op">);</span></span>
<span id="cb170-9"><a href="#cb170-9" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>x<span class="op">,</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb170-10"><a href="#cb170-10" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>y<span class="op">,</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb170-11"><a href="#cb170-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-12"><a href="#cb170-12" aria-hidden="true" tabindex="-1"></a>    b<span class="op">.</span>SetXY<span class="op">(</span><span class="dv">3</span><span class="op">,</span> <span class="dv">4</span><span class="op">);</span></span>
<span id="cb170-13"><a href="#cb170-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-14"><a href="#cb170-14" aria-hidden="true" tabindex="-1"></a>    b<span class="op">.</span>GetXY<span class="op">(</span>x<span class="op">,</span> y<span class="op">);</span></span>
<span id="cb170-15"><a href="#cb170-15" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>x<span class="op">,</span> <span class="dv">3</span><span class="op">);</span></span>
<span id="cb170-16"><a href="#cb170-16" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>y<span class="op">,</span> <span class="dv">4</span><span class="op">);</span></span>
<span id="cb170-17"><a href="#cb170-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-18"><a href="#cb170-18" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>b<span class="op">.</span>Quantity<span class="op">(),</span> <span class="dv">36</span><span class="op">);</span></span>
<span id="cb170-19"><a href="#cb170-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-20"><a href="#cb170-20" aria-hidden="true" tabindex="-1"></a>    b<span class="op">.</span>Multipy<span class="op">(</span><span class="dv">2</span><span class="op">);</span></span>
<span id="cb170-21"><a href="#cb170-21" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>b<span class="op">.</span>Quantity<span class="op">(),</span> <span class="dv">288</span><span class="op">);</span></span></code></pre></div>
<p>これをCで実装したものが下記である。</p>
<div class="sourceCode" id="cb171"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/class_ut.cpp 188</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> Point3D <span class="op">{</span></span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a>        Point point<span class="op">;</span></span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span>   z<span class="op">;</span></span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb171-7"><a href="#cb171-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-8"><a href="#cb171-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">static</span> <span class="dt">int</span> point3d_quantity<span class="op">(</span>Point <span class="at">const</span><span class="op">*</span> self<span class="op">)</span></span>
<span id="cb171-9"><a href="#cb171-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb171-10"><a href="#cb171-10" aria-hidden="true" tabindex="-1"></a>        Point3D <span class="at">const</span><span class="op">*</span> self_derived <span class="op">=</span> <span class="op">(</span>Point3D <span class="at">const</span><span class="op">*)</span>self<span class="op">;</span></span>
<span id="cb171-11"><a href="#cb171-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-12"><a href="#cb171-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> point_quantity<span class="op">(</span>self<span class="op">)</span> <span class="op">*</span> self_derived<span class="op">-&gt;</span>z<span class="op">;</span></span>
<span id="cb171-13"><a href="#cb171-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb171-14"><a href="#cb171-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-15"><a href="#cb171-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">static</span> <span class="dt">void</span> point3d_multipy<span class="op">(</span>Point<span class="op">*</span> self<span class="op">,</span> <span class="dt">int</span> m<span class="op">)</span></span>
<span id="cb171-16"><a href="#cb171-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb171-17"><a href="#cb171-17" aria-hidden="true" tabindex="-1"></a>        point_multipy<span class="op">(</span>self<span class="op">,</span> m<span class="op">);</span></span>
<span id="cb171-18"><a href="#cb171-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-19"><a href="#cb171-19" aria-hidden="true" tabindex="-1"></a>        Point3D<span class="op">*</span> self_derived <span class="op">=</span> <span class="op">(</span>Point3D<span class="op">*)</span>self<span class="op">;</span></span>
<span id="cb171-20"><a href="#cb171-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-21"><a href="#cb171-21" aria-hidden="true" tabindex="-1"></a>        self_derived<span class="op">-&gt;</span>z <span class="op">*=</span> m<span class="op">;</span></span>
<span id="cb171-22"><a href="#cb171-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb171-23"><a href="#cb171-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-24"><a href="#cb171-24" aria-hidden="true" tabindex="-1"></a>    Point3D Point3D_Construct<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">,</span> <span class="dt">int</span> z<span class="op">)</span></span>
<span id="cb171-25"><a href="#cb171-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb171-26"><a href="#cb171-26" aria-hidden="true" tabindex="-1"></a>        Point3D ret<span class="op">{{</span>x<span class="op">,</span> y<span class="op">,</span> point3d_quantity<span class="op">,</span> point3d_multipy<span class="op">},</span> z<span class="op">};</span></span>
<span id="cb171-27"><a href="#cb171-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-28"><a href="#cb171-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> ret<span class="op">;</span></span>
<span id="cb171-29"><a href="#cb171-29" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>この単体テストは、下記のようになる。</p>
<div class="sourceCode" id="cb172"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/design_pattern/class_ut.cpp 221</span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a>    Point3D a <span class="op">=</span> Point3D_Construct<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">);</span></span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a>    Point<span class="op">*</span>  b <span class="op">=</span> <span class="op">&amp;</span>a<span class="op">.</span>point<span class="op">;</span></span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-6"><a href="#cb172-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> x<span class="op">;</span></span>
<span id="cb172-7"><a href="#cb172-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> y<span class="op">;</span></span>
<span id="cb172-8"><a href="#cb172-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-9"><a href="#cb172-9" aria-hidden="true" tabindex="-1"></a>    Point_GetXY<span class="op">(</span>b<span class="op">,</span> <span class="op">&amp;</span>x<span class="op">,</span> <span class="op">&amp;</span>y<span class="op">);</span></span>
<span id="cb172-10"><a href="#cb172-10" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>x<span class="op">,</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb172-11"><a href="#cb172-11" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>y<span class="op">,</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb172-12"><a href="#cb172-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-13"><a href="#cb172-13" aria-hidden="true" tabindex="-1"></a>    Point_SetXY<span class="op">(</span>b<span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">4</span><span class="op">);</span></span>
<span id="cb172-14"><a href="#cb172-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-15"><a href="#cb172-15" aria-hidden="true" tabindex="-1"></a>    Point_GetXY<span class="op">(</span>b<span class="op">,</span> <span class="op">&amp;</span>x<span class="op">,</span> <span class="op">&amp;</span>y<span class="op">);</span></span>
<span id="cb172-16"><a href="#cb172-16" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>x<span class="op">,</span> <span class="dv">3</span><span class="op">);</span></span>
<span id="cb172-17"><a href="#cb172-17" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>y<span class="op">,</span> <span class="dv">4</span><span class="op">);</span></span>
<span id="cb172-18"><a href="#cb172-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-19"><a href="#cb172-19" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>b<span class="op">-&gt;</span>Quantity<span class="op">(</span>b<span class="op">),</span> <span class="dv">36</span><span class="op">);</span></span>
<span id="cb172-20"><a href="#cb172-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-21"><a href="#cb172-21" aria-hidden="true" tabindex="-1"></a>    b<span class="op">-&gt;</span>Multipy<span class="op">(</span>b<span class="op">,</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb172-22"><a href="#cb172-22" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>b<span class="op">-&gt;</span>Quantity<span class="op">(</span>b<span class="op">),</span> <span class="dv">288</span><span class="op">);</span></span></code></pre></div>
<p>以上からわかる通り、Cでのクラス実装はC++のものに比べ、</p>
<ul>
<li>記述が多い</li>
<li>キャストを使わざるを得ない</li>
<li>リファレンスが使えないため、NULLにならないハンドル変数をポインタにせざるを得ない</li>
</ul>
<p>等といった問題があるため、「何らかの事情でC++が使えない」チームは、
なるべく早い時期にその障害を乗り越えることをお勧めする。</p>
<p>どうしてもその障害を超えられない場合は、 <a
href="https://www.amazon.co.jp/%E3%83%A2%E3%83%80%E3%83%B3C%E8%A8%80%E8%AA%9E%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0-%E3%82%A2%E3%82%B9%E3%82%AD%E3%83%BC%E6%9B%B8%E7%B1%8D-%E8%8A%B1%E4%BA%95-%E5%BF%97%E7%94%9F-ebook/dp/B00HWLJEKW">モダンC言語プログラミング</a>
が役に立つだろう。</p>
<!-- ./md/template_meta_programming.md -->
<h1 id="テンプレートメタプログラミング">テンプレートメタプログラミング
<a id="SS_3"></a></h1>
<p>本章でのテンプレートメタプログラミングとは、下記の2つを指す。</p>
<ul>
<li>ジェネリックプログラミング</li>
<li>メタプログラミング</li>
</ul>
<p>C++においては、この2つはテンプレートを用いたプログラミングとなる。</p>
<p>ジェネリックプログラミングとは、具体的なデータ型に依存しない抽象的プログラミングであり、
その代表的な成果物はSTLのコンテナやそれらを扱うアルゴリズム関数テンプレートである。</p>
<p>この利点は、</p>
<ul>
<li>i種の型</li>
<li>j種のコンテナ</li>
<li>k種のアルゴリズム</li>
</ul>
<p>の開発を行うことを考えれば明らかである。</p>
<p>ジェネリックプログラミングが無ければ、コンテナの種類はi x
j個必要になり、 それらに適用するアルゴリズム関数は、i x j x
k個必要になる。
また、サポートする型の増加に伴いコンテナやアルゴリズム関数は指数関数的に増えて行く。
C言語のqsort()のように強引なキャストを使い、この増加をある程度食い止めることはできるが、
それによりコンパイラによる型チェックは無効化され、
静的な型付け言語を使うメリットの多くを失うことになる。</p>
<p>メタプログラミングとは、</p>
<ul>
<li>ジェネリックのサポート</li>
<li>実行時コードの最適化</li>
<li>関数やクラスを生成するコードのプログラミング</li>
</ul>
<p>のような目的で行われるテンプレートプログラミングの総称である。</p>
<p>ジェネリックプログラミングとメタプログラミングに明確な境界はない、
また明確にしたところで大きなメリットはと思われるため、
本章では、これらをまとめた概念であるテンプレートメタプログラミングとして扱い、
ログ取得ライブラリやSTLを応用したNstdライブラリの実装を通して、
これらのテクニックや、使用上の注意点について解説する。</p>
<h2 id="ログ取得ライブラリの開発">ログ取得ライブラリの開発
<a id="SS_3_1"></a></h2>
<p>ここではログ取得ライブラリの開発を行う。</p>
<h3 id="要件">要件 <a id="SS_3_1_1"></a></h3>
<p>ログ取得ライブラリの要件は、</p>
<ul>
<li>ソースコードの場所とそこで指示されたオブジェクトの値を文字列で保持する</li>
<li>後からそれらを取り出せる</li>
</ul>
<p>ことのみとする。下記はその文字列を取り出した例である。</p>
<pre><code>    app/src/main.cpp: 96:Options
                         cmd       : GenPkg
                         in        : 
                         out       : 
                         recursive : true
                         src_as_pkg: false
        ...

    app/src/main.cpp: 51:start GenPkg

    file_utils/ut/path_utils.cpp: 38:1
    file_utils/ut/path_utils.cpp: 48:ut_data/app1
                         ut_data/app1/mod1
                         ut_data/app1/mod2

        ...

    app/src/main.cpp:100:Exit:0</code></pre>
<p>単純化のためログの番号やタイムスタンプのサポートはしない。
また、実行速度や仕様メモリ量の制限等も本章の趣旨とは離れるため考慮しない。</p>
<h3
id="ログ取得ライブラリのインターフェース">ログ取得ライブラリのインターフェース
<a id="SS_3_1_2"></a></h3>
<p>ログ取得コードにより、コードクローンが増えたり、主なロジックの可読性が下がったのでは、
本末転倒であるため、下記のようにワンライナーで記述できるべきだろう。</p>
<div class="sourceCode" id="cb174"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a>    LOGGER<span class="op">(</span><span class="st">&quot;start GenPkg&quot;</span><span class="op">,</span> objA<span class="op">,</span> objB<span class="op">,</span> objC<span class="op">);</span></span></code></pre></div>
<p>また、要件で述べた通り、ソースコード位置を特定できなければならないため、
上記LOGGERは下記のような関数型マクロにならざるを得ない。</p>
<div class="sourceCode" id="cb175"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#define LOGGER</span><span class="op">(...)</span><span class="pp"> </span>CppLoggerFunc<span class="op">(</span><span class="ot">__FILE__</span><span class="op">,</span><span class="pp"> </span><span class="ot">__LINE__</span><span class="op">,</span><span class="pp"> </span><span class="ot">__VA_ARGS__</span><span class="op">)</span></span></code></pre></div>
<p>CppLoggerFuncをクラス外の関数として実装した場合、ログ保持のための静的なオブジェクトが必要になる。
これは避けるべきなので、「<a
href="#SS_2_12">Singleton</a>」で述べた構造を導入すると、</p>
<div class="sourceCode" id="cb176"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#define LOGGER</span><span class="op">(...)</span><span class="pp"> </span>Logger<span class="op">::</span>Inst<span class="op">().</span>Set<span class="op">(</span><span class="ot">__FILE__</span><span class="op">,</span><span class="pp"> </span><span class="ot">__LINE__</span><span class="op">,</span><span class="pp"> </span><span class="ot">__VA_ARGS__</span><span class="op">)</span></span></code></pre></div>
<p>のような関数型マクロとなる。これがログ取得ライブラリの主なインターフェースとなる。</p>
<p>C言語プログラミングばかりをやりすぎて、
視神経と手の運動神経が直結してしまった大脳レス・プログラマーは、</p>
<div class="sourceCode" id="cb177"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a>    __VA_ARGS__</span></code></pre></div>
<p>を見るとprintf(…)のような可変長引数を取る関数を思い浮かべる。
「人は一昨日も行ったことを昨日も行ったという理由で、今日もそれを行う」
という諺を思い出すと気持ちは分からなくもないが、
C++ではprintf(…)のような危険な可変長引数を取る関数を作ってはならない。
パラメータパックを使って実装するべきである。</p>
<h3 id="パラメータパック">パラメータパック <a id="SS_3_1_3"></a></h3>
<p>C++11で導入されたパラメータパックはやや複雑なシンタックスを持つため、
まずは単純な例から説明する。</p>
<p>次のような単体テストをパスする関数テンプレートsumをパラメータパックで実装することを考える。</p>
<div class="sourceCode" id="cb178"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/parameter_pack_ut.cpp 26</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">1</span><span class="op">,</span> sum<span class="op">(</span><span class="dv">1</span><span class="op">));</span></span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">3</span><span class="op">,</span> sum<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">));</span></span>
<span id="cb178-5"><a href="#cb178-5" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">6</span><span class="op">,</span> sum<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">));</span></span>
<span id="cb178-6"><a href="#cb178-6" aria-hidden="true" tabindex="-1"></a>    ASSERT_FLOAT_EQ<span class="op">(</span><span class="fl">6.0</span><span class="op">,</span> sum<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="fl">2.0</span><span class="op">,</span> <span class="fl">3.0</span><span class="op">));</span></span>
<span id="cb178-7"><a href="#cb178-7" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">10</span><span class="op">,</span> sum<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">4</span><span class="op">));</span></span>
<span id="cb178-8"><a href="#cb178-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-9"><a href="#cb178-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span></span>
<span id="cb178-10"><a href="#cb178-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-11"><a href="#cb178-11" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">55</span><span class="op">,</span> sum<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">6</span><span class="op">,</span> <span class="dv">7</span><span class="op">,</span> <span class="dv">8</span><span class="op">,</span> <span class="dv">9</span><span class="op">,</span> <span class="dv">10</span><span class="op">));</span></span>
<span id="cb178-12"><a href="#cb178-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-13"><a href="#cb178-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span></span></code></pre></div>
<p>sumの要件は、</p>
<ul>
<li>可変長引数を持つ</li>
<li><a href="#SS_5_1_1">算術型</a>の引数と戻り値を持つ</li>
<li>すべての引数の和を返す</li>
</ul>
<p>のようなものになるため、関数テンプレートsumは下記のように書ける。</p>
<div class="sourceCode" id="cb179"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/parameter_pack_ut.cpp 9</span></span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> HEAD<span class="op">&gt;</span></span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> sum<span class="op">(</span>HEAD head<span class="op">)</span></span>
<span id="cb179-5"><a href="#cb179-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb179-6"><a href="#cb179-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> head<span class="op">;</span></span>
<span id="cb179-7"><a href="#cb179-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb179-8"><a href="#cb179-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-9"><a href="#cb179-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> HEAD<span class="op">,</span> <span class="kw">typename</span><span class="op">...</span> TAIL<span class="op">&gt;</span></span>
<span id="cb179-10"><a href="#cb179-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> sum<span class="op">(</span>HEAD head<span class="op">,</span> TAIL<span class="op">...</span> tails<span class="op">)</span></span>
<span id="cb179-11"><a href="#cb179-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb179-12"><a href="#cb179-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> head <span class="op">+</span> sum<span class="op">(</span>tails<span class="op">...);</span></span>
<span id="cb179-13"><a href="#cb179-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>1つ目の関数テンプレートsumは引数が一つの場合に対応する。
2つ目の関数テンプレートsumは引数が2つ以上の場合に対応する。</p>
<p>2つ目の関数テンプレートsumのテンプレートパラメータ</p>
<div class="sourceCode" id="cb180"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a>    <span class="kw">typename</span><span class="op">...</span> TAIL</span></code></pre></div>
<p>がパラメータパックであり、0個以上の型が指定されることを意味する。
これを関数の引数として表すシンタックスが</p>
<div class="sourceCode" id="cb181"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>    TAIL<span class="op">...</span> tails</span></code></pre></div>
<p>であり、同様に0個以上のインスタンスが指定されることを表している。</p>
<p>HEADとTAILより、2つ目のsumは1個以上の引数を取れることになるため、
引数が1つの場合、どちらのsumを呼び出すかが曖昧になるように思えるが、
ベストマッチの観点から1つ目のsumが呼び出される。</p>
<p>sum(1, 2,
3)の呼び出し時のsumの展開を見てみることでパラメータパックの振る舞いを解説する。</p>
<p>この呼び出しは、2つ目のsumにマッチする。従って下記のように展開される。</p>
<div class="sourceCode" id="cb182"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">1</span> <span class="op">+</span> sum<span class="op">(</span><span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">);</span></span></code></pre></div>
<p>sum(2, 3)も同様に展開されるため、上記コードは下記のようになる。</p>
<div class="sourceCode" id="cb183"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">1</span> <span class="op">+</span> <span class="dv">2</span> <span class="op">+</span> sum<span class="op">(</span><span class="dv">3</span><span class="op">);</span></span></code></pre></div>
<p>sum(3)は1つ目のsumにマッチするため、最終的には下記のように展開される。</p>
<div class="sourceCode" id="cb184"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">1</span> <span class="op">+</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">3</span><span class="op">;</span></span></code></pre></div>
<p>これで基本的な要件は満たしたが、このsumでは下記のようなコードもコンパイルできてしまう。</p>
<div class="sourceCode" id="cb185"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/parameter_pack_ut.cpp 43</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">2</span><span class="op">,</span> sum<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="kw">true</span><span class="op">,</span> <span class="kw">false</span><span class="op">));</span></span></code></pre></div>
<p>これを認めるかどうかはsumの仕様次第だが、ここではこれらを認めないようにしたい。
また、引数に浮動小数が与えられた場合でも、sumの戻り値の型がintなる仕様には問題がある。
合わせてそれも修正する。</p>
<div class="sourceCode" id="cb186"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/parameter_pack_ut.cpp 53</span></span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> HEAD<span class="op">&gt;</span></span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> sum<span class="op">(</span>HEAD head<span class="op">)</span></span>
<span id="cb186-5"><a href="#cb186-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb186-6"><a href="#cb186-6" aria-hidden="true" tabindex="-1"></a>        <span class="co">// std::is_sameの2パラメータが同一であれば、std::is_same&lt;&gt;::value == true</span></span>
<span id="cb186-7"><a href="#cb186-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">static_assert</span><span class="op">(!</span><span class="bu">std::</span>is_same<span class="op">&lt;</span>HEAD<span class="op">,</span> <span class="dt">bool</span><span class="op">&gt;::</span>value<span class="op">,</span> <span class="st">&quot;arguemnt type must not be bool.&quot;</span><span class="op">);</span></span>
<span id="cb186-8"><a href="#cb186-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-9"><a href="#cb186-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> head<span class="op">;</span></span>
<span id="cb186-10"><a href="#cb186-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb186-11"><a href="#cb186-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-12"><a href="#cb186-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> HEAD<span class="op">,</span> <span class="kw">typename</span><span class="op">...</span> TAIL<span class="op">&gt;</span></span>
<span id="cb186-13"><a href="#cb186-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> sum<span class="op">(</span>HEAD head<span class="op">,</span> TAIL<span class="op">...</span> tails<span class="op">)</span></span>
<span id="cb186-14"><a href="#cb186-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb186-15"><a href="#cb186-15" aria-hidden="true" tabindex="-1"></a>        <span class="co">// std::is_sameの2パラメータが同一であれば、std::is_same&lt;&gt;::value == true</span></span>
<span id="cb186-16"><a href="#cb186-16" aria-hidden="true" tabindex="-1"></a>        <span class="kw">static_assert</span><span class="op">(!</span><span class="bu">std::</span>is_same<span class="op">&lt;</span>HEAD<span class="op">,</span> <span class="dt">bool</span><span class="op">&gt;::</span>value<span class="op">,</span> <span class="st">&quot;arguemnt type must not be bool.&quot;</span><span class="op">);</span></span>
<span id="cb186-17"><a href="#cb186-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-18"><a href="#cb186-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> head <span class="op">+</span> sum<span class="op">(</span>tails<span class="op">...);</span></span>
<span id="cb186-19"><a href="#cb186-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb187"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/parameter_pack_ut.cpp 83</span></span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// boolを除く算術型のみ認めるため、下記はコンパイルできない。</span></span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ASSERT_EQ(2, sum(1, true, false));</span></span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-6"><a href="#cb187-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> i1 <span class="op">=</span> sum<span class="op">(</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb187-7"><a href="#cb187-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> i2 <span class="op">=</span> sum<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb187-8"><a href="#cb187-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-9"><a href="#cb187-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="kw">decltype</span><span class="op">(</span>i1<span class="op">)&gt;::</span>value<span class="op">);</span>  <span class="co">// 1の型はint</span></span>
<span id="cb187-10"><a href="#cb187-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="kw">decltype</span><span class="op">(</span>i2<span class="op">)&gt;::</span>value<span class="op">);</span>  <span class="co">// 1 + 2の型はint</span></span>
<span id="cb187-11"><a href="#cb187-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-12"><a href="#cb187-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> u1 <span class="op">=</span> sum<span class="op">(</span><span class="dv">1</span><span class="bu">U</span><span class="op">);</span></span>
<span id="cb187-13"><a href="#cb187-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> u2 <span class="op">=</span> sum<span class="op">(</span><span class="dv">1</span><span class="bu">U</span><span class="op">,</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb187-14"><a href="#cb187-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-15"><a href="#cb187-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same<span class="op">&lt;</span><span class="dt">unsigned</span> <span class="dt">int</span><span class="op">,</span> <span class="kw">decltype</span><span class="op">(</span>u1<span class="op">)&gt;::</span>value<span class="op">);</span>  <span class="co">// 1Uの型はunsigned int</span></span>
<span id="cb187-16"><a href="#cb187-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same<span class="op">&lt;</span><span class="dt">unsigned</span> <span class="dt">int</span><span class="op">,</span> <span class="kw">decltype</span><span class="op">(</span>u2<span class="op">)&gt;::</span>value<span class="op">);</span>  <span class="co">// 1U + 2の型はunsigned int</span></span>
<span id="cb187-17"><a href="#cb187-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-18"><a href="#cb187-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> f0 <span class="op">=</span> sum<span class="op">(</span><span class="fl">1.0</span><span class="op">,</span> <span class="fl">1.2</span><span class="op">);</span></span>
<span id="cb187-19"><a href="#cb187-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same<span class="op">&lt;</span><span class="dt">double</span><span class="op">,</span> <span class="kw">decltype</span><span class="op">(</span>f0<span class="op">)&gt;::</span>value<span class="op">);</span></span>
<span id="cb187-20"><a href="#cb187-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-21"><a href="#cb187-21" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ただし、戻り型をautoにしたため、下記も認められるようになった。</span></span>
<span id="cb187-22"><a href="#cb187-22" aria-hidden="true" tabindex="-1"></a>    <span class="co">// これに対しての対処は別の関数で行う。</span></span>
<span id="cb187-23"><a href="#cb187-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> str <span class="op">=</span> sum<span class="op">(</span><span class="bu">std::</span>string<span class="op">{</span><span class="st">&quot;1&quot;</span><span class="op">},</span> <span class="bu">std::</span>string<span class="op">{</span><span class="st">&quot;2&quot;</span><span class="op">});</span></span>
<span id="cb187-24"><a href="#cb187-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-25"><a href="#cb187-25" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>str<span class="op">,</span> <span class="st">&quot;12&quot;</span><span class="op">);</span></span>
<span id="cb187-26"><a href="#cb187-26" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">,</span> <span class="kw">decltype</span><span class="op">(</span>str<span class="op">)&gt;::</span>value<span class="op">);</span></span></code></pre></div>
<p>以上で示したようにパラメータパックにより、
C言語での可変長引数関数では不可能だった引数の型チェックができるようになったため、
C言語でのランタイムエラーがコンパイルエラーにできるようになった。</p>
<p>なお、上記コードで使用した<a href="#SS_3_3_1_3">std::is_same</a>は、
与えられた2つのテンプレートパラメータが同じ型であった場合、
valueをtrueで初期化するクラステンプレートであり、
type_traitsで定義されている
(後ほど使用するstd::is_same_vはstd::is_same&lt;&gt;::valueと等価な定数テンプレート)。
この実装については、後ほど説明する。</p>
<h4 id="パラメータパックの畳みこみ式">パラメータパックの畳みこみ式
<a id="SS_3_1_3_1"></a></h4>
<p>上記したsumは、パラメータパックの展開に汎用的な再帰構造を用いたが、
C++17で導入された畳みこみ式を用い、以下の様に簡潔に記述することもできる。</p>
<div class="sourceCode" id="cb188"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/parameter_pack_ut.cpp 123</span></span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span><span class="op">...</span> ARGS<span class="op">&gt;</span></span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> sum<span class="op">(</span>ARGS<span class="op">...</span> args<span class="op">)</span></span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb188-6"><a href="#cb188-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="op">(</span>args <span class="op">+</span> <span class="op">...);</span>  <span class="co">// 畳みこみ式は()で囲まなければならない。</span></span>
<span id="cb188-7"><a href="#cb188-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb189"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/parameter_pack_ut.cpp 134</span></span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">1</span><span class="op">,</span> sum<span class="op">(</span><span class="dv">1</span><span class="op">));</span></span>
<span id="cb189-4"><a href="#cb189-4" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">3</span><span class="op">,</span> sum<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">));</span></span>
<span id="cb189-5"><a href="#cb189-5" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">6</span><span class="op">,</span> sum<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">));</span></span>
<span id="cb189-6"><a href="#cb189-6" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="fl">6.0</span><span class="op">,</span> sum<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="fl">2.0</span><span class="op">,</span> <span class="fl">3.0</span><span class="op">));</span></span>
<span id="cb189-7"><a href="#cb189-7" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">10</span><span class="op">,</span> sum<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">4</span><span class="op">));</span></span>
<span id="cb189-8"><a href="#cb189-8" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">55</span><span class="op">,</span> sum<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">6</span><span class="op">,</span> <span class="dv">7</span><span class="op">,</span> <span class="dv">8</span><span class="op">,</span> <span class="dv">9</span><span class="op">,</span> <span class="dv">10</span><span class="op">));</span></span></code></pre></div>
<p>畳みこみ式で使用できる演算子を以下に示す。</p>
<pre><code>    + - * / % ^ &amp; | = &lt; &gt; &lt;&lt; &gt;&gt; += -= *= /= %= ^= &amp;= |= &lt;&lt;= &gt;&gt;= == != &lt;= &gt;= &amp;&amp; || , .* -&gt;*</code></pre>
<p>これらの演算子がオーバーロードである場合でも、畳みこみ式は利用できる。</p>
<h4 id="前から演算するパラメータパック">前から演算するパラメータパック
<a id="SS_3_1_3_2"></a></h4>
<p>パラメータパックを使うプログラミングでは、
上記したHEADとTAILによるリカーシブコールがよく使われるパターンであるが、
これには後ろから処理されるという、微妙な問題点がある。</p>
<p>これまでのsumに代えて下記のようなproduct(掛け算)を考える。</p>
<div class="sourceCode" id="cb191"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/parameter_pack_ut.cpp 149</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> HEAD<span class="op">&gt;</span></span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> product<span class="op">(</span>HEAD head<span class="op">)</span></span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb191-6"><a href="#cb191-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">static_assert</span><span class="op">(!</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span>HEAD<span class="op">,</span> <span class="dt">bool</span><span class="op">&gt;,</span> <span class="st">&quot;arguemnt type must not be bool.&quot;</span><span class="op">);</span></span>
<span id="cb191-7"><a href="#cb191-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_arithmetic_v<span class="op">&lt;</span>HEAD<span class="op">&gt;,</span> <span class="st">&quot;arguemnt type must be arithmetic.&quot;</span><span class="op">);</span></span>
<span id="cb191-8"><a href="#cb191-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-9"><a href="#cb191-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> head<span class="op">;</span></span>
<span id="cb191-10"><a href="#cb191-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb191-11"><a href="#cb191-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-12"><a href="#cb191-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> HEAD<span class="op">,</span> <span class="kw">typename</span><span class="op">...</span> TAIL<span class="op">&gt;</span></span>
<span id="cb191-13"><a href="#cb191-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> product<span class="op">(</span>HEAD head<span class="op">,</span> TAIL<span class="op">...</span> tails<span class="op">)</span></span>
<span id="cb191-14"><a href="#cb191-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb191-15"><a href="#cb191-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">static_assert</span><span class="op">(!</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span>HEAD<span class="op">,</span> <span class="dt">bool</span><span class="op">&gt;,</span> <span class="st">&quot;arguemnt type must not be bool.&quot;</span><span class="op">);</span></span>
<span id="cb191-16"><a href="#cb191-16" aria-hidden="true" tabindex="-1"></a>        <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_arithmetic_v<span class="op">&lt;</span>HEAD<span class="op">&gt;,</span> <span class="st">&quot;arguemnt type must be arithmetic.&quot;</span><span class="op">);</span></span>
<span id="cb191-17"><a href="#cb191-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-18"><a href="#cb191-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> head <span class="op">*</span> product<span class="op">(</span>tails<span class="op">...);</span></span>
<span id="cb191-19"><a href="#cb191-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>このコードの単体テストは、</p>
<div class="sourceCode" id="cb192"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/parameter_pack_ut.cpp 173</span></span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">1</span><span class="op">,</span> product<span class="op">(</span><span class="dv">100</span><span class="op">,</span> <span class="fl">0.1</span><span class="op">,</span> <span class="fl">0.1</span><span class="op">));</span></span></code></pre></div>
<p>のようになるだろうが、
std::numeric_limits&lt;&gt;::epsilonを使用していないため
、このテストはパスしない。一方で、以下のテストはパスする。</p>
<div class="sourceCode" id="cb193"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/parameter_pack_ut.cpp 178</span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">1</span><span class="op">,</span> product<span class="op">(</span><span class="fl">0.1</span><span class="op">,</span> <span class="fl">0.1</span><span class="op">,</span> <span class="dv">100</span><span class="op">));</span></span></code></pre></div>
<p>一般に0.01の2進数表現は無限小数になるため、これを含む演算にはepsilon以下の演算誤差が発生する。
前者単体テストでは、後ろから演算されるために処理の途中に0.01が現れるが、
後者では現れないため、この誤差の有無が結果の差になる。</p>
<p>このような演算順序による微妙な誤差が問題になるような関数を開発する場合、
演算は見た目の順序通りに行われた方が良いだろう。
ということで、productを前から演算するように修正する。</p>
<div class="sourceCode" id="cb194"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/parameter_pack_ut.cpp 196</span></span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> HEAD<span class="op">&gt;</span></span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> product<span class="op">(</span>HEAD head<span class="op">)</span></span>
<span id="cb194-5"><a href="#cb194-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb194-6"><a href="#cb194-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">static_assert</span><span class="op">(!</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span>HEAD<span class="op">,</span> <span class="dt">bool</span><span class="op">&gt;,</span> <span class="st">&quot;arguemnt type must not be bool.&quot;</span><span class="op">);</span></span>
<span id="cb194-7"><a href="#cb194-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_arithmetic_v<span class="op">&lt;</span>HEAD<span class="op">&gt;,</span> <span class="st">&quot;arguemnt type must be arithmetic.&quot;</span><span class="op">);</span></span>
<span id="cb194-8"><a href="#cb194-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-9"><a href="#cb194-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> head<span class="op">;</span></span>
<span id="cb194-10"><a href="#cb194-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb194-11"><a href="#cb194-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-12"><a href="#cb194-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> HEAD<span class="op">,</span> <span class="kw">typename</span> HEAD2<span class="op">,</span> <span class="kw">typename</span><span class="op">...</span> TAIL<span class="op">&gt;</span></span>
<span id="cb194-13"><a href="#cb194-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> product<span class="op">(</span>HEAD head<span class="op">,</span> HEAD2 head2<span class="op">,</span> TAIL<span class="op">...</span> tails<span class="op">)</span></span>
<span id="cb194-14"><a href="#cb194-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb194-15"><a href="#cb194-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">static_assert</span><span class="op">(!</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span>HEAD<span class="op">,</span> <span class="dt">bool</span><span class="op">&gt;,</span> <span class="st">&quot;arguemnt type must not be bool.&quot;</span><span class="op">);</span></span>
<span id="cb194-16"><a href="#cb194-16" aria-hidden="true" tabindex="-1"></a>        <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_arithmetic_v<span class="op">&lt;</span>HEAD<span class="op">&gt;,</span> <span class="st">&quot;arguemnt type must be arithmetic.&quot;</span><span class="op">);</span></span>
<span id="cb194-17"><a href="#cb194-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-18"><a href="#cb194-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> product<span class="op">(</span>head <span class="op">*</span> head2<span class="op">,</span> tails<span class="op">...);</span></span>
<span id="cb194-19"><a href="#cb194-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>HEAD、TAILに加えHEAD2を導入することで、前からの演算を実装できる
(引数が一つのproductに変更はない)。当然ながら、これにより、</p>
<div class="sourceCode" id="cb195"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/parameter_pack_ut.cpp 220</span></span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">1</span><span class="op">,</span> product<span class="op">(</span><span class="dv">100</span><span class="op">,</span> <span class="fl">0.1</span><span class="op">,</span> <span class="fl">0.1</span><span class="op">));</span></span></code></pre></div>
<p>はパスし、下記はパスしなくなる。</p>
<div class="sourceCode" id="cb196"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/parameter_pack_ut.cpp 225</span></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">1</span><span class="op">,</span> product<span class="op">(</span><span class="fl">0.1</span><span class="op">,</span> <span class="fl">0.1</span><span class="op">,</span> <span class="dv">100</span><span class="op">));</span></span></code></pre></div>
<h3 id="loggerの実装">Loggerの実装 <a id="SS_3_1_4"></a></h3>
<p>パラメータパックを使用したログ取得コードは以下のようになる。</p>
<div class="sourceCode" id="cb197"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/logger_0.h 47</span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#define LOGGER_P</span><span class="op">(...)</span><span class="pp"> </span>Logging<span class="op">::</span>Logger<span class="op">::</span>Inst<span class="op">().</span>Set<span class="op">(</span><span class="ot">__FILE__</span><span class="op">,</span><span class="pp"> </span><span class="ot">__LINE__</span><span class="op">)</span></span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#define LOGGER</span><span class="op">(...)</span><span class="pp"> </span>Logging<span class="op">::</span>Logger<span class="op">::</span>Inst<span class="op">().</span>Set<span class="op">(</span><span class="ot">__FILE__</span><span class="op">,</span><span class="pp"> </span><span class="ot">__LINE__</span><span class="op">,</span><span class="pp"> </span><span class="ot">__VA_ARGS__</span><span class="op">)</span></span></code></pre></div>
<p>予定していたものと若干違う理由は、__VA_ARGS__が1個以上の識別子を表しているからである。
従って、通過ポイントのみをロギングしたい場合、LOGGER_P()を使うことになる。
gcc拡張を使えば、LOGGER_PとLOGGERを統一できるが、そのようなことをすると別のコンパイラや、
静的解析ツールが使用できなくなることがあるため、残念だが上記のように実装するべきである。</p>
<p>Loggerクラスの実装は、下記のようになる。</p>
<div class="sourceCode" id="cb198"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/logger_0.h 5</span></span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> Logging <span class="op">{</span></span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Logger <span class="op">{</span></span>
<span id="cb198-5"><a href="#cb198-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb198-6"><a href="#cb198-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> Logger<span class="op">&amp;</span>       Inst<span class="op">();</span></span>
<span id="cb198-7"><a href="#cb198-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> Logger <span class="at">const</span><span class="op">&amp;</span> InstConst<span class="op">()</span> <span class="op">{</span> <span class="cf">return</span> Inst<span class="op">();</span> <span class="op">}</span></span>
<span id="cb198-8"><a href="#cb198-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-9"><a href="#cb198-9" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span>Get<span class="op">()</span> <span class="at">const</span><span class="op">;</span>  <span class="co">// ログデータの取得</span></span>
<span id="cb198-10"><a href="#cb198-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span>        Clear<span class="op">();</span>      <span class="co">// ログデータの消去</span></span>
<span id="cb198-11"><a href="#cb198-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-12"><a href="#cb198-12" aria-hidden="true" tabindex="-1"></a>        <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span><span class="op">...</span> ARGS<span class="op">&gt;</span>  <span class="co">// ログの登録</span></span>
<span id="cb198-13"><a href="#cb198-13" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> Set<span class="op">(</span><span class="dt">char</span> <span class="at">const</span><span class="op">*</span> filename<span class="op">,</span> <span class="dt">uint32_t</span> line_no<span class="op">,</span> ARGS <span class="at">const</span><span class="op">&amp;...</span> args<span class="op">)</span></span>
<span id="cb198-14"><a href="#cb198-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb198-15"><a href="#cb198-15" aria-hidden="true" tabindex="-1"></a>            <span class="va">oss_</span><span class="op">.</span>width<span class="op">(</span><span class="dv">32</span><span class="op">);</span></span>
<span id="cb198-16"><a href="#cb198-16" aria-hidden="true" tabindex="-1"></a>            <span class="va">oss_</span> <span class="op">&lt;&lt;</span> filename <span class="op">&lt;&lt;</span> <span class="st">&quot;:&quot;</span><span class="op">;</span></span>
<span id="cb198-17"><a href="#cb198-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-18"><a href="#cb198-18" aria-hidden="true" tabindex="-1"></a>            <span class="va">oss_</span><span class="op">.</span>width<span class="op">(</span><span class="dv">3</span><span class="op">);</span></span>
<span id="cb198-19"><a href="#cb198-19" aria-hidden="true" tabindex="-1"></a>            <span class="va">oss_</span> <span class="op">&lt;&lt;</span> line_no<span class="op">;</span></span>
<span id="cb198-20"><a href="#cb198-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-21"><a href="#cb198-21" aria-hidden="true" tabindex="-1"></a>            set_inner<span class="op">(</span>args<span class="op">...);</span></span>
<span id="cb198-22"><a href="#cb198-22" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb198-23"><a href="#cb198-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-24"><a href="#cb198-24" aria-hidden="true" tabindex="-1"></a>        Logger<span class="op">(</span>Logger <span class="at">const</span><span class="op">&amp;)</span>            <span class="op">=</span> <span class="kw">delete</span><span class="op">;</span></span>
<span id="cb198-25"><a href="#cb198-25" aria-hidden="true" tabindex="-1"></a>        Logger<span class="op">&amp;</span> <span class="kw">operator</span><span class="op">=(</span>Logger <span class="at">const</span><span class="op">&amp;)</span> <span class="op">=</span> <span class="kw">delete</span><span class="op">;</span></span>
<span id="cb198-26"><a href="#cb198-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-27"><a href="#cb198-27" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb198-28"><a href="#cb198-28" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> set_inner<span class="op">()</span> <span class="op">{</span> <span class="va">oss_</span> <span class="op">&lt;&lt;</span> <span class="bu">std::</span>endl<span class="op">;</span> <span class="op">}</span></span>
<span id="cb198-29"><a href="#cb198-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-30"><a href="#cb198-30" aria-hidden="true" tabindex="-1"></a>        <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> HEAD<span class="op">,</span> <span class="kw">typename</span><span class="op">...</span> TAIL<span class="op">&gt;</span></span>
<span id="cb198-31"><a href="#cb198-31" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> set_inner<span class="op">(</span>HEAD <span class="at">const</span><span class="op">&amp;</span> head<span class="op">,</span> TAIL <span class="at">const</span><span class="op">&amp;...</span> tails<span class="op">)</span></span>
<span id="cb198-32"><a href="#cb198-32" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb198-33"><a href="#cb198-33" aria-hidden="true" tabindex="-1"></a>            <span class="va">oss_</span> <span class="op">&lt;&lt;</span> <span class="st">&quot;:&quot;</span> <span class="op">&lt;&lt;</span> head<span class="op">;</span></span>
<span id="cb198-34"><a href="#cb198-34" aria-hidden="true" tabindex="-1"></a>            set_inner<span class="op">(</span>tails<span class="op">...);</span></span>
<span id="cb198-35"><a href="#cb198-35" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb198-36"><a href="#cb198-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-37"><a href="#cb198-37" aria-hidden="true" tabindex="-1"></a>        Logger<span class="op">()</span> <span class="op">{}</span></span>
<span id="cb198-38"><a href="#cb198-38" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>ostringstream<span class="op"> </span><span class="va">oss_</span><span class="op">{};</span></span>
<span id="cb198-39"><a href="#cb198-39" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb198-40"><a href="#cb198-40" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace Logging</span></span></code></pre></div>
<p>すでに述べた通り、</p>
<ul>
<li>クラスはシングルトンにする</li>
<li>パラメータパックにより可変長引数を実現する</li>
</ul>
<p>ようにした。
また、識別子の衝突を避けるために、名前空間Loggingを導入し、Loggerはその中で宣言した。</p>
<p>次に、どのように動作するのかを単体テストで示す。</p>
<div class="sourceCode" id="cb199"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/logger_0_ut.cpp 16</span></span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> a <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> b <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{</span><span class="st">&quot;b&quot;</span><span class="op">};</span></span>
<span id="cb199-5"><a href="#cb199-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-6"><a href="#cb199-6" aria-hidden="true" tabindex="-1"></a>    LOGGER_P<span class="op">();</span>               <span class="co">// (1)</span></span>
<span id="cb199-7"><a href="#cb199-7" aria-hidden="true" tabindex="-1"></a>    LOGGER<span class="op">(</span><span class="dv">5</span><span class="op">,</span> <span class="st">&quot;hehe&quot;</span><span class="op">,</span> a<span class="op">,</span> b<span class="op">);</span>  <span class="co">// (2)</span></span>
<span id="cb199-8"><a href="#cb199-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> line_num <span class="op">=</span> <span class="ot">__LINE__</span><span class="op">;</span></span>
<span id="cb199-9"><a href="#cb199-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-10"><a href="#cb199-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> s <span class="op">=</span> Logging<span class="op">::</span>Logger<span class="op">::</span>InstConst<span class="op">().</span>Get<span class="op">();</span></span>
<span id="cb199-11"><a href="#cb199-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-12"><a href="#cb199-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> exp <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{</span>log_str_exp<span class="op">(</span><span class="ot">__FILE__</span><span class="op">,</span> line_num <span class="op">-</span> <span class="dv">2</span><span class="op">,</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">)};</span>  <span class="co">// (1)のログ</span></span>
<span id="cb199-13"><a href="#cb199-13" aria-hidden="true" tabindex="-1"></a>    exp <span class="op">+=</span> log_str_exp<span class="op">(</span><span class="ot">__FILE__</span><span class="op">,</span> line_num <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> <span class="st">&quot;:5:hehe:1:b</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">);</span>        <span class="co">// (2)のログ</span></span>
<span id="cb199-14"><a href="#cb199-14" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>exp<span class="op">,</span> s<span class="op">);</span></span>
<span id="cb199-15"><a href="#cb199-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-16"><a href="#cb199-16" aria-hidden="true" tabindex="-1"></a>    Logging<span class="op">::</span>Logger<span class="op">::</span>Inst<span class="op">().</span>Clear<span class="op">();</span>  <span class="co">// クリアの確認</span></span>
<span id="cb199-17"><a href="#cb199-17" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;&quot;</span><span class="op">,</span> Logging<span class="op">::</span>Logger<span class="op">::</span>InstConst<span class="op">().</span>Get<span class="op">());</span></span></code></pre></div>
<p>行を含む出力の期待値をソースコードに直接書くと行増減のたびにそれらを修正する必要ある。
期待値の一部を自動計算する下記コード(上記コードで使用)を単体テストに導入することで、
そういった修正を避けている。</p>
<div class="sourceCode" id="cb200"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/logger_ut.h 4</span></span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">inline</span> <span class="bu">std::</span>string<span class="op"> </span>line_to_str<span class="op">(</span><span class="dt">uint32_t</span> line<span class="op">)</span></span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>line <span class="op">&lt;</span> <span class="dv">10</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb200-6"><a href="#cb200-6" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&quot;:  &quot;</span><span class="op">;</span></span>
<span id="cb200-7"><a href="#cb200-7" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb200-8"><a href="#cb200-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>line <span class="op">&lt;</span> <span class="dv">100</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb200-9"><a href="#cb200-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&quot;: &quot;</span><span class="op">;</span></span>
<span id="cb200-10"><a href="#cb200-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb200-11"><a href="#cb200-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>line <span class="op">&lt;</span> <span class="dv">1000</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb200-12"><a href="#cb200-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&quot;:&quot;</span><span class="op">;</span></span>
<span id="cb200-13"><a href="#cb200-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb200-14"><a href="#cb200-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb200-15"><a href="#cb200-15" aria-hidden="true" tabindex="-1"></a>            <span class="ot">assert</span><span class="op">(</span><span class="kw">false</span><span class="op">);</span>  <span class="co">// 1000行を超える単体テストファイルを認めない</span></span>
<span id="cb200-16"><a href="#cb200-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&quot;&quot;</span><span class="op">;</span></span>
<span id="cb200-17"><a href="#cb200-17" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb200-18"><a href="#cb200-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb200-19"><a href="#cb200-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-20"><a href="#cb200-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">inline</span> <span class="bu">std::</span>string<span class="op"> </span>log_str_exp<span class="op">(</span><span class="dt">char</span> <span class="at">const</span><span class="op">*</span> filename_cstr<span class="op">,</span> <span class="dt">uint32_t</span> line<span class="op">,</span> <span class="dt">char</span> <span class="at">const</span><span class="op">*</span> str<span class="op">)</span></span>
<span id="cb200-21"><a href="#cb200-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb200-22"><a href="#cb200-22" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> <span class="at">const</span> filename <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{</span>filename_cstr<span class="op">};</span></span>
<span id="cb200-23"><a href="#cb200-23" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> <span class="at">const</span> len      <span class="op">=</span> <span class="dv">32</span> <span class="op">&gt;</span> filename<span class="op">.</span>size<span class="op">()</span> <span class="op">?</span> <span class="dv">32</span> <span class="op">-</span> filename<span class="op">.</span>size<span class="op">()</span> <span class="op">:</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb200-24"><a href="#cb200-24" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span>       ret      <span class="op">=</span> <span class="bu">std::</span>string<span class="op">(</span>len<span class="op">,</span> <span class="ch">&#39; &#39;</span><span class="op">);</span></span>
<span id="cb200-25"><a href="#cb200-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-26"><a href="#cb200-26" aria-hidden="true" tabindex="-1"></a>        ret <span class="op">+=</span> filename<span class="op">;</span></span>
<span id="cb200-27"><a href="#cb200-27" aria-hidden="true" tabindex="-1"></a>        ret <span class="op">+=</span> line_to_str<span class="op">(</span>line<span class="op">);</span></span>
<span id="cb200-28"><a href="#cb200-28" aria-hidden="true" tabindex="-1"></a>        ret <span class="op">+=</span> <span class="bu">std::</span>to_string<span class="op">(</span>line<span class="op">);</span></span>
<span id="cb200-29"><a href="#cb200-29" aria-hidden="true" tabindex="-1"></a>        ret <span class="op">+=</span> str<span class="op">;</span></span>
<span id="cb200-30"><a href="#cb200-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-31"><a href="#cb200-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> ret<span class="op">;</span></span>
<span id="cb200-32"><a href="#cb200-32" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>アプリケーションの開発では、
下記のようなユーザが定義した名前空間とクラスを用いることがほとんどである。</p>
<div class="sourceCode" id="cb201"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/app_ints.h 12</span></span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> App <span class="op">{</span></span>
<span id="cb201-4"><a href="#cb201-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-5"><a href="#cb201-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> X <span class="op">{</span></span>
<span id="cb201-6"><a href="#cb201-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb201-7"><a href="#cb201-7" aria-hidden="true" tabindex="-1"></a>        X<span class="op">(</span><span class="bu">std::</span>string<span class="op"> </span>str<span class="op">,</span> <span class="dt">int</span> num<span class="op">)</span> <span class="op">:</span> <span class="va">str_</span><span class="op">{</span><span class="bu">std::</span>move<span class="op">(</span>str<span class="op">)},</span> <span class="va">num_</span><span class="op">{</span>num<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb201-8"><a href="#cb201-8" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span>ToString<span class="op">()</span> <span class="at">const</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">str_</span> <span class="op">+</span> <span class="st">&quot;/&quot;</span> <span class="op">+</span> <span class="bu">std::</span>to_string<span class="op">(</span><span class="va">num_</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb201-9"><a href="#cb201-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb201-10"><a href="#cb201-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb201-11"><a href="#cb201-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace App</span></span></code></pre></div>
<p>このApp::Xのインスタンスのログを取得できることも、当然Logging::Loggerの要件となる。
従って、下記の単体テストはコンパイルでき、且つパスすることが必要になる。</p>
<div class="sourceCode" id="cb202"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/logger_0_ut.cpp 42</span></span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> x <span class="op">=</span> App<span class="op">::</span>X<span class="op">{</span><span class="st">&quot;name&quot;</span><span class="op">,</span> <span class="dv">3</span><span class="op">};</span></span>
<span id="cb202-4"><a href="#cb202-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-5"><a href="#cb202-5" aria-hidden="true" tabindex="-1"></a>    LOGGER<span class="op">(</span><span class="dv">1</span><span class="op">,</span> x<span class="op">);</span></span>
<span id="cb202-6"><a href="#cb202-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> line_num <span class="op">=</span> <span class="ot">__LINE__</span><span class="op">;</span></span>
<span id="cb202-7"><a href="#cb202-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-8"><a href="#cb202-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> s <span class="op">=</span> Logging<span class="op">::</span>Logger<span class="op">::</span>InstConst<span class="op">().</span>Get<span class="op">();</span></span>
<span id="cb202-9"><a href="#cb202-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-10"><a href="#cb202-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> exp <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{</span>log_str_exp<span class="op">(</span><span class="ot">__FILE__</span><span class="op">,</span> line_num <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> <span class="st">&quot;:1:name/3</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">)};</span></span>
<span id="cb202-11"><a href="#cb202-11" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>exp<span class="op">,</span> s<span class="op">);</span></span></code></pre></div>
<p>Logging::Loggerのコードからオブジェクトのログを登録するためには、
Logging::Logger::set_innerがコンパイルできなければならない。
つまり、</p>
<div class="sourceCode" id="cb203"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>ostream<span class="op">&amp;</span> <span class="kw">operator</span><span class="op">&lt;&lt;(</span><span class="bu">std::</span>ostream<span class="op">&amp;,</span> ログ登録オブジェクトの型<span class="op">)</span></span></code></pre></div>
<p>の実装が必要条件となる。App::Xでは下記のようなコードになる。</p>
<div class="sourceCode" id="cb204"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/app_ints.h 28</span></span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> App <span class="op">{</span></span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-5"><a href="#cb204-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">inline</span> <span class="bu">std::</span>ostream<span class="op">&amp;</span> <span class="kw">operator</span><span class="op">&lt;&lt;(</span><span class="bu">std::</span>ostream<span class="op">&amp;</span> os<span class="op">,</span> X <span class="at">const</span><span class="op">&amp;</span> x<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> os <span class="op">&lt;&lt;</span> x<span class="op">.</span>ToString<span class="op">();</span> <span class="op">}</span></span>
<span id="cb204-6"><a href="#cb204-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace App</span></span></code></pre></div>
<p>他の任意のユーザ定義型に対しても、このようにすることでログ登録が可能になる。</p>
<p>なお、ヒューマンリーダブルな文字列でその状態を表示できる関数をユーザ定義型に与えることは、
デバッガを使用したデバッグ時にも有用である。</p>
<h3
id="ユーザ定義型とそのoperatorのname-lookup">ユーザ定義型とそのoperator&lt;&lt;のname
lookup <a id="SS_3_1_5"></a></h3>
<p>ここで、一旦Logging::Loggerの開発を止め、
Logging::Logger::set_innerでのApp::operator&lt;&lt;の<a
href="#SS_5_4_2">name lookup</a>について考えてみることにする。</p>
<p>ここまでで紹介したログ取得ライブラリやそれを使うユーザ定義型等の定義、宣言の順番は、</p>
<ol type="1">
<li>Logging::Logger</li>
<li>App::X</li>
<li>App::operator&lt;&lt;</li>
<li>単体テスト(Logger::set_innerのインスタンス化される場所)</li>
</ol>
<p>となっている。 name
lookupの原則に従い、App::Xの宣言は、App::operator&lt;&lt;より前に行われている。
これを逆にするとコンパイルできない。
しかし、Logging::Loggerは、後から宣言されたApp::operator&lt;&lt;を使うことができる。
多くのプログラマは、これについて気づいていないか、その理由を間違っての認識している。</p>
<p>その認識とは、「テンプレート内の識別子の<a href="#SS_5_4_2">name
lookup</a>は、
それがインスタンス化される時に行われる」というものであり、これにより 「
Logging::Loggerのname lookupは単体テスト内で行われる。
それはApp::operator&lt;&lt;宣言後であるためコンパイルできる」と考えることができるが、
<a href="#SS_5_4_3">two phase name
lookup</a>で行われるプロセスと反するため誤りである。</p>
<p>まずは、この認識の誤りを下記のコードで説明する。</p>
<div class="sourceCode" id="cb205"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/logger_0_ut.cpp 68</span></span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> App2 <span class="op">{</span></span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> X <span class="op">{</span></span>
<span id="cb205-5"><a href="#cb205-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb205-6"><a href="#cb205-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> X<span class="op">(</span><span class="bu">std::</span>string<span class="op"> </span>str<span class="op">,</span> <span class="dt">int</span> num<span class="op">)</span> <span class="op">:</span> <span class="va">str_</span><span class="op">{</span><span class="bu">std::</span>move<span class="op">(</span>str<span class="op">)},</span> <span class="va">num_</span><span class="op">{</span>num<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb205-7"><a href="#cb205-7" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span>ToString<span class="op">()</span> <span class="at">const</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">str_</span> <span class="op">+</span> <span class="st">&quot;/&quot;</span> <span class="op">+</span> <span class="bu">std::</span>to_string<span class="op">(</span><span class="va">num_</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb205-8"><a href="#cb205-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb205-9"><a href="#cb205-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb205-10"><a href="#cb205-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace App2</span></span>
<span id="cb205-11"><a href="#cb205-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-12"><a href="#cb205-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> App3 <span class="op">{</span>  <span class="co">// App3をApp2にすればコンパイルできる</span></span>
<span id="cb205-13"><a href="#cb205-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>ostream<span class="op">&amp;</span> <span class="kw">operator</span><span class="op">&lt;&lt;(</span><span class="bu">std::</span>ostream<span class="op">&amp;</span> os<span class="op">,</span> App2<span class="op">::</span>X <span class="at">const</span><span class="op">&amp;</span> x<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> os <span class="op">&lt;&lt;</span> x<span class="op">.</span>ToString<span class="op">();</span> <span class="op">}</span></span>
<span id="cb205-14"><a href="#cb205-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace App3</span></span>
<span id="cb205-15"><a href="#cb205-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-16"><a href="#cb205-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> <span class="op">{</span></span>
<span id="cb205-17"><a href="#cb205-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-18"><a href="#cb205-18" aria-hidden="true" tabindex="-1"></a>    TEST<span class="op">(</span>Template<span class="op">,</span> logger_0_X_in_AppX<span class="op">)</span></span>
<span id="cb205-19"><a href="#cb205-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb205-20"><a href="#cb205-20" aria-hidden="true" tabindex="-1"></a>        Logging<span class="op">::</span>Logger<span class="op">::</span>Inst<span class="op">().</span>Clear<span class="op">();</span></span>
<span id="cb205-21"><a href="#cb205-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-22"><a href="#cb205-22" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> x <span class="op">=</span> App2<span class="op">::</span>X<span class="op">{</span><span class="st">&quot;name&quot;</span><span class="op">,</span> <span class="dv">3</span><span class="op">};</span></span>
<span id="cb205-23"><a href="#cb205-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-24"><a href="#cb205-24" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> <span class="kw">namespace</span> App3<span class="op">;</span>  <span class="co">// この記述は下記のエラーに効果がない</span></span>
<span id="cb205-25"><a href="#cb205-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-26"><a href="#cb205-26" aria-hidden="true" tabindex="-1"></a>        LOGGER<span class="op">(</span><span class="dv">1</span><span class="op">,</span> x<span class="op">);</span>  <span class="co">// ここがコンパイルエラーとなる</span></span>
<span id="cb205-27"><a href="#cb205-27" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> line_num <span class="op">=</span> <span class="ot">__LINE__</span><span class="op">;</span></span>
<span id="cb205-28"><a href="#cb205-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-29"><a href="#cb205-29" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> s <span class="op">=</span> Logging<span class="op">::</span>Logger<span class="op">::</span>InstConst<span class="op">().</span>Get<span class="op">();</span></span>
<span id="cb205-30"><a href="#cb205-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-31"><a href="#cb205-31" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> exp <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{</span>log_str_exp<span class="op">(</span><span class="ot">__FILE__</span><span class="op">,</span> line_num <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> <span class="st">&quot;:1:name/3</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">)};</span></span>
<span id="cb205-32"><a href="#cb205-32" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span>exp<span class="op">,</span> s<span class="op">);</span></span>
<span id="cb205-33"><a href="#cb205-33" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb205-34"><a href="#cb205-34" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace</span></span></code></pre></div>
<p>このコードは、もともとのコードの名前空間名をApp2とApp3にしただけのものである。
もし、前記した「認識」の内容が正しいのであれば、このコードもコンパイルできるはずであるが
(実際にApp3と書いた部分をApp2に書き換えればコンパイルできる)、
実際には下記のようなエラーが発生する。</p>
<pre><code>    logger_0.h:37:21: error: no match for ‘operator&lt;&lt;’ 
    (operand types are ‘std::basic_ostream&lt;char&gt;’ and ‘const App2::X’)
       37 |         oss_ &lt;&lt; &quot;:&quot; &lt;&lt; head;
          |         ~~~~~~~~~~~~^~~~~~~
</code></pre>
<p>エラー内容からoperator&lt;&lt;が発見できないことは明らかである。
単体テスト内でのusing namespace
App3はLogging::Logger::set_innerの宣言より後に書かれているため、
このエラーを防ぐ効果はない。</p>
<p>Logging::Logger::set_innerの中でusing namespace App3とした上で、 two
phase name lookupの原則に従い、
App2::XとApp3::operator&lt;&lt;をLogging::Loggerの宣言より前に宣言することで、
ようやくコンパイルすることができる。</p>
<p>名前空間Appの例と名前空間App2、App3の例での本質的な違いは、
「型Xとそのoperator&lt;&lt;が同じ名前空間で宣言されているかどうか」である。</p>
<p>名前空間Appの例の場合、型Xとそのoperator&lt;&lt;が同じ名前空間で宣言されているため、
<a href="#SS_5_4_5">ADL</a>(実引数依存探索)が働く。
また、Logging::Logger::set_inner(x)はテンプレートであるため、<a
href="#SS_5_4_3">two phase name lookup</a> が使用される。
その結果、Logging::Logger::set_inner(x)でのname lookupの対象には、
「Logging::Logger::set_inner(x)がインスタンス化される場所
(単体テスト内でのLOGGER_PやLOGGERが使われている場所)より前方で宣言された名前空間App」も含まれる。
こういったメカニズムにより、
Logging::Logger::set_inner定義位置の後方で宣言されたApp::operator&lt;&lt;も発見できることになる。</p>
<p>一方で、名前空間App2、App3の例では、型XがApp2で宣言されているため、
Logging::Logger::set_inner(x)でのname lookupの対象にApp3は含ず、
App3::operator&lt;&lt;は発見されない(繰り返すが、インスタン化の場所直前でのusing
nameには効果がない)。</p>
<p>型Xとそのoperator&lt;&lt;を同じ名前空間で宣言することは本質的に重要なことであるが、
名前空間を使用する場合、自然にそのような構造になるため、
その重要性の理由を知る必要はないように思われる。
しかし、次の例で示すようにこのメカニズムを知らずに解決することができないケースが存在する。</p>
<h3 id="ints_tのログ登録">Ints_tのログ登録 <a id="SS_3_1_6"></a></h3>
<p>話題はログ取得ライブラリの開発に戻る。
アプリケーションの開発では、下記のように宣言された型エイリアスを使うことは珍しくない。</p>
<div class="sourceCode" id="cb207"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/app_ints.h 6</span></span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> App <span class="op">{</span></span>
<span id="cb207-4"><a href="#cb207-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> <span class="dt">Ints_t</span> <span class="op">=</span> <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;;</span></span>
<span id="cb207-5"><a href="#cb207-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>そのoperator&lt;&lt;を下記のように定義したとする。</p>
<div class="sourceCode" id="cb208"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/logger_0_ut.cpp 109</span></span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> App <span class="op">{</span></span>
<span id="cb208-4"><a href="#cb208-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>ostream<span class="op">&amp;</span> <span class="kw">operator</span><span class="op">&lt;&lt;(</span><span class="bu">std::</span>ostream<span class="op">&amp;</span> os<span class="op">,</span> <span class="dt">Ints_t</span> <span class="at">const</span><span class="op">&amp;</span> ints<span class="op">)</span></span>
<span id="cb208-5"><a href="#cb208-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb208-6"><a href="#cb208-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> first <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb208-7"><a href="#cb208-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-8"><a href="#cb208-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> <span class="at">const</span> i <span class="op">:</span> ints<span class="op">)</span> <span class="op">{</span></span>
<span id="cb208-9"><a href="#cb208-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(!</span><span class="bu">std::</span>exchange<span class="op">(</span>first<span class="op">,</span> <span class="kw">false</span><span class="op">))</span> <span class="op">{</span></span>
<span id="cb208-10"><a href="#cb208-10" aria-hidden="true" tabindex="-1"></a>                os <span class="op">&lt;&lt;</span> <span class="st">&quot;, &quot;</span><span class="op">;</span></span>
<span id="cb208-11"><a href="#cb208-11" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb208-12"><a href="#cb208-12" aria-hidden="true" tabindex="-1"></a>            os <span class="op">&lt;&lt;</span> i<span class="op">;</span></span>
<span id="cb208-13"><a href="#cb208-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb208-14"><a href="#cb208-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-15"><a href="#cb208-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> os<span class="op">;</span></span>
<span id="cb208-16"><a href="#cb208-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb208-17"><a href="#cb208-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace App</span></span></code></pre></div>
<p>単体テストは下記のように書けるが、残念ながらコンパイルエラーになり、</p>
<div class="sourceCode" id="cb209"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/logger_0_ut.cpp 134</span></span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> ints <span class="op">=</span> App<span class="op">::</span><span class="dt">Ints_t</span><span class="op">{</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">};</span></span>
<span id="cb209-4"><a href="#cb209-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-5"><a href="#cb209-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> oss <span class="op">=</span> <span class="bu">std::</span>ostringstream<span class="op">{};</span></span>
<span id="cb209-6"><a href="#cb209-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-7"><a href="#cb209-7" aria-hidden="true" tabindex="-1"></a>    oss <span class="op">&lt;&lt;</span> ints<span class="op">;</span></span>
<span id="cb209-8"><a href="#cb209-8" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;1, 2, 3&quot;</span><span class="op">,</span> oss<span class="op">.</span>str<span class="op">());</span></span></code></pre></div>
<p>下記のようなエラーメッセージが表示される。</p>
<pre><code>    logger_0_ut.cpp:140:9: error: no match for ‘operator&lt;&lt;’
        (operand types are ‘std::ostringstream’ {aka ‘std::basic_ostringstream&lt;char&gt;’}
         and ‘App::Ints_t’ {aka ‘std::vector&lt;int&gt;’})
      140 |     oss &lt;&lt; ints;
          |     ~~~ ^~ ~~~~
          |     |      |
          |     |      App::Ints_t {aka std::vector&lt;int&gt;}
          |     std::ostringstream {aka std::basic_ostringstream&lt;char&gt;}</code></pre>
<p>Ints_tはAppで定義されているが、実際の型はstdで定義されているため、
instsの<a href="#SS_5_4_6">関連名前空間</a>もstdであり、Appではない。
その結果App::operator&lt;&lt;は発見できず、このようなエラーになった。</p>
<p>LOGGERからApp::operator&lt;&lt;を使う場合の単体テストは下記のようになるが、
<a
href="#SS_5_4_5">ADL</a>によってLogging::Logger::set_inner(ints)内に導入される名前空間はstdのみであり、
前記単体テスト同様にコンパイルできない。</p>
<div class="sourceCode" id="cb211"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/logger_0_ints_ut.h 8</span></span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> ints <span class="op">=</span> App<span class="op">::</span><span class="dt">Ints_t</span><span class="op">{</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">};</span></span>
<span id="cb211-4"><a href="#cb211-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-5"><a href="#cb211-5" aria-hidden="true" tabindex="-1"></a>    LOGGER<span class="op">(</span><span class="st">&quot;Ints&quot;</span><span class="op">,</span> ints<span class="op">);</span></span>
<span id="cb211-6"><a href="#cb211-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> line_num <span class="op">=</span> <span class="ot">__LINE__</span><span class="op">;</span></span>
<span id="cb211-7"><a href="#cb211-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-8"><a href="#cb211-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> s <span class="op">=</span> Logging<span class="op">::</span>Logger<span class="op">::</span>InstConst<span class="op">().</span>Get<span class="op">();</span></span>
<span id="cb211-9"><a href="#cb211-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-10"><a href="#cb211-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> exp <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{</span>log_str_exp<span class="op">(</span><span class="ot">__FILE__</span><span class="op">,</span> line_num <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> <span class="st">&quot;:Ints:1, 2, 3</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">)};</span></span>
<span id="cb211-11"><a href="#cb211-11" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>exp<span class="op">,</span> s<span class="op">);</span></span></code></pre></div>
<p>この解決方法は、</p>
<ul>
<li><a href="#SS_3_1_6_1">operator&lt;&lt;をstd内で宣言する</a></li>
<li><a
href="#SS_3_1_6_2">operator&lt;&lt;をグローバル名前空間内で宣言する</a></li>
<li><a href="#SS_3_1_6_3">operator&lt;&lt;をLogging内で宣言する</a></li>
<li><a href="#SS_3_1_6_4">Logging::Logger::set_inner(ints)内でusing
namespace Appを行う</a></li>
<li><a href="#SS_3_1_6_5">Ints_tを構造体としてApp内に宣言する</a></li>
<li><a href="#SS_3_1_6_6">operator&lt;&lt;を使わない</a></li>
</ul>
<p>のようにいくつか考えられる。以下では、順を追ってこれらの問題点について解説を行う。</p>
<h4 id="operatorをstd内で宣言する">operator&lt;&lt;をstd内で宣言する
<a id="SS_3_1_6_1"></a></h4>
<p>ここで解決したい問題は、すでに示した通り、 「<a
href="#SS_5_4_5">ADL</a>によってLogging::Logger::set_inner(ints)内に導入される名前空間はstdである」
ことにって発生する。であれば、App内でのoperator&lt;&lt;の宣言をstdで行えばコンパイルできるはずである。
下記はその変更を行ったコードである。</p>
<div class="sourceCode" id="cb212"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/app_ints.h 6</span></span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> App <span class="op">{</span></span>
<span id="cb212-4"><a href="#cb212-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> <span class="dt">Ints_t</span> <span class="op">=</span> <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;;</span></span>
<span id="cb212-5"><a href="#cb212-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb213"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/logger_0_std_ut.cpp 11</span></span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> std <span class="op">{</span>  <span class="co">// operator&lt;&lt;の定義をstdで行う</span></span>
<span id="cb213-4"><a href="#cb213-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>ostream<span class="op">&amp;</span> <span class="kw">operator</span><span class="op">&lt;&lt;(</span><span class="bu">std::</span>ostream<span class="op">&amp;</span> os<span class="op">,</span> App<span class="op">::</span><span class="dt">Ints_t</span> <span class="at">const</span><span class="op">&amp;</span> ints<span class="op">)</span></span>
<span id="cb213-5"><a href="#cb213-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb213-6"><a href="#cb213-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> first <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb213-7"><a href="#cb213-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-8"><a href="#cb213-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> <span class="at">const</span> i <span class="op">:</span> ints<span class="op">)</span> <span class="op">{</span></span>
<span id="cb213-9"><a href="#cb213-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(!</span><span class="bu">std::</span>exchange<span class="op">(</span>first<span class="op">,</span> <span class="kw">false</span><span class="op">))</span> <span class="op">{</span></span>
<span id="cb213-10"><a href="#cb213-10" aria-hidden="true" tabindex="-1"></a>                os <span class="op">&lt;&lt;</span> <span class="st">&quot;, &quot;</span><span class="op">;</span></span>
<span id="cb213-11"><a href="#cb213-11" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb213-12"><a href="#cb213-12" aria-hidden="true" tabindex="-1"></a>            os <span class="op">&lt;&lt;</span> i<span class="op">;</span></span>
<span id="cb213-13"><a href="#cb213-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb213-14"><a href="#cb213-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-15"><a href="#cb213-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> os<span class="op">;</span></span>
<span id="cb213-16"><a href="#cb213-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb213-17"><a href="#cb213-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace std</span></span></code></pre></div>
<p>上記コードは<a href="#SS_5_4_3">two phase name
lookup</a>等の効果により、想定通りコンパイルできるが、
stdをユーザが拡張することは一部の例外を除き未定義動作を引き起こす可能性があり、
たとえこのコードがうまく動作したとしても
(実際、このコードはこのドキュメント作成時には正常動作している)、
未来においてその保証はなく、このようなプログラミングは厳に避けるべきである。</p>
<h4
id="operatorをグローバル名前空間内で宣言する">operator&lt;&lt;をグローバル名前空間内で宣言する
<a id="SS_3_1_6_2"></a></h4>
<p>すでに述べた通り、
「ADLによってLogging::Logger::set_inner(ints)内に導入される名前空間はstdのみである」ため、
この関数の中でのname
lookupに使用される名前空間は、std、グローバル名前空間、
Loggerを宣言しているLoggingの3つである。</p>
<p>ここでは、下記のコードのようにグローバル名前空間内でのoperator&lt;&lt;の宣言を試す。</p>
<div class="sourceCode" id="cb214"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/app_ints.h 6</span></span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-3"><a href="#cb214-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> App <span class="op">{</span></span>
<span id="cb214-4"><a href="#cb214-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> <span class="dt">Ints_t</span> <span class="op">=</span> <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;;</span></span>
<span id="cb214-5"><a href="#cb214-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb215"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/logger_0_global_ut.cpp 10</span></span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// グローバル名前空間</span></span>
<span id="cb215-4"><a href="#cb215-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>ostream<span class="op">&amp;</span> <span class="kw">operator</span><span class="op">&lt;&lt;(</span><span class="bu">std::</span>ostream<span class="op">&amp;</span> os<span class="op">,</span> App<span class="op">::</span><span class="dt">Ints_t</span> <span class="at">const</span><span class="op">&amp;</span> ints<span class="op">)</span></span>
<span id="cb215-5"><a href="#cb215-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb215-6"><a href="#cb215-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> first <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb215-7"><a href="#cb215-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-8"><a href="#cb215-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> <span class="at">const</span> i <span class="op">:</span> ints<span class="op">)</span> <span class="op">{</span></span>
<span id="cb215-9"><a href="#cb215-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(!</span><span class="bu">std::</span>exchange<span class="op">(</span>first<span class="op">,</span> <span class="kw">false</span><span class="op">))</span> <span class="op">{</span></span>
<span id="cb215-10"><a href="#cb215-10" aria-hidden="true" tabindex="-1"></a>                os <span class="op">&lt;&lt;</span> <span class="st">&quot;, &quot;</span><span class="op">;</span></span>
<span id="cb215-11"><a href="#cb215-11" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb215-12"><a href="#cb215-12" aria-hidden="true" tabindex="-1"></a>            os <span class="op">&lt;&lt;</span> i<span class="op">;</span></span>
<span id="cb215-13"><a href="#cb215-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb215-14"><a href="#cb215-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-15"><a href="#cb215-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> os<span class="op">;</span></span>
<span id="cb215-16"><a href="#cb215-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>このドキュメントで使用している<a
href="#SS_5_9_1">g++</a>ではこのコードはコンパイルでき、
動作も問題ないように思われるが、<a
href="#SS_5_9_2">clang++</a>では以下のようなエラーが発生し、コンパイルできない。</p>
<pre><code>    ./logger_0.h:37:21: error: call to function &#39;operator&lt;&lt;&#39; that is neither 
    visible in the tem plate definition nor found by argument-dependent lookup
            oss_ &lt;&lt; &quot;:&quot; &lt;&lt; head;</code></pre>
<p>この理由は「<a href="#SS_5_4_3">two phase name
lookup</a>」の後半で詳しく解説したので、ここでは繰り返さないが、
このようなコードを使うと、コード解析ツール等が使用できなくなることがあるため、
避けるべきである 。</p>
<p>多くのプログラマは、コードに問題があるとしても、
それが意図通りに動くように見えるのであればその問題を無視する。
今回のような難題に対しては、なおさらそのような邪悪な欲求に負けやすい。
そのような観点でclang++が吐き出したエラーメッセージを眺めると、上記したメッセージの後に、
下記のような出力を見つけるかもしれない。</p>
<pre><code>    logger_0_global_ut.cpp:13:15: note: &#39;operator&lt;&lt;&#39; should be declared prior to the call site
    std::ostream&amp; operator&lt;&lt;(std::ostream&amp; os, App::Ints_t const&amp; ints)</code></pre>
<p>clang++は「LOGGERの前にoperator&lt;&lt;を宣言せよ」と言っている。
実際そうすれば、clang++でのコンパイルも通り、単体テストもパスする。
しかし、それには下記のような問題がある。</p>
<ul>
<li>operator&lt;&lt;(std::ostream&amp; os, App::Ints_t const&amp; ints)
という名前空間Appローカルな宣言をグローバル名前空間で行うことによって、
グローバル名前空間を汚染してしまう
(このコードは名前空間を正しく使うことに対しての割れ窓 (「<a
href="#SS_5_12_1">割れ窓理論</a>」参照)になってしまうかもしれない)。</li>
<li>例示したコードでのoperator&lt;&lt;(std::ostream&amp; os, App::Ints_t
const&amp; ints)の定義は、
単体テストファイル内にあったが、実際には何らかのヘッダファイル内で定義されることになる。
その場合、ロガーのヘッダファイルよりも、
そのヘッダファイルを先にインクルードしなければならなくなる。
これは大した問題ではないように見えるが、
ヘッダファイル間の暗黙の依存関係を生み出し将来の保守作業を難しくさせる。</li>
</ul>
<p>以上述べた理由からこのアイデアを選択するべきではない。</p>
<h4
id="operatorをlogging内で宣言する">operator&lt;&lt;をLogging内で宣言する
<a id="SS_3_1_6_3"></a></h4>
<p>前節でのグローバル名前空間内でのoperator&lt;&lt;の宣言はうまく行かなかったので、
同様のことをLoggingで試す。</p>
<div class="sourceCode" id="cb218"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/app_ints.h 6</span></span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> App <span class="op">{</span></span>
<span id="cb218-4"><a href="#cb218-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> <span class="dt">Ints_t</span> <span class="op">=</span> <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;;</span></span>
<span id="cb218-5"><a href="#cb218-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb219"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/logger_0_logging_ut.cpp 10</span></span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-3"><a href="#cb219-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> Logging <span class="op">{</span>  <span class="co">// operator&lt;&lt;の定義をLoggingで行う</span></span>
<span id="cb219-4"><a href="#cb219-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>ostream<span class="op">&amp;</span> <span class="kw">operator</span><span class="op">&lt;&lt;(</span><span class="bu">std::</span>ostream<span class="op">&amp;</span> os<span class="op">,</span> App<span class="op">::</span><span class="dt">Ints_t</span> <span class="at">const</span><span class="op">&amp;</span> ints<span class="op">)</span></span>
<span id="cb219-5"><a href="#cb219-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb219-6"><a href="#cb219-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> first <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb219-7"><a href="#cb219-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-8"><a href="#cb219-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> <span class="at">const</span> i <span class="op">:</span> ints<span class="op">)</span> <span class="op">{</span></span>
<span id="cb219-9"><a href="#cb219-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(!</span><span class="bu">std::</span>exchange<span class="op">(</span>first<span class="op">,</span> <span class="kw">false</span><span class="op">))</span> <span class="op">{</span></span>
<span id="cb219-10"><a href="#cb219-10" aria-hidden="true" tabindex="-1"></a>                os <span class="op">&lt;&lt;</span> <span class="st">&quot;, &quot;</span><span class="op">;</span></span>
<span id="cb219-11"><a href="#cb219-11" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb219-12"><a href="#cb219-12" aria-hidden="true" tabindex="-1"></a>            os <span class="op">&lt;&lt;</span> i<span class="op">;</span></span>
<span id="cb219-13"><a href="#cb219-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb219-14"><a href="#cb219-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-15"><a href="#cb219-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> os<span class="op">;</span></span>
<span id="cb219-16"><a href="#cb219-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb219-17"><a href="#cb219-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace Logging</span></span></code></pre></div>
<p>動作はするものの、当然ながら結果は「<a
href="#SS_3_1_6_2">operator&lt;&lt;をグローバル名前空間内で宣言する</a>」
で述べた状況とほぼ同様であるため、このアイデアを採用することはできない。</p>
<h4
id="loggingloggerset_innerints内でusing-namespace-appを行う">Logging::Logger::set_inner(ints)内でusing
namespace Appを行う <a id="SS_3_1_6_4"></a></h4>
<p>Logging::Logger::set_inner(ints)内でusing namespace Appを行えば、
意図通りに動作させることができるが、App内のロギングは名前空間Loggingに依存するため、
AppとLoggingが循環した依存関係を持ってしまう。
また、LoggingはAppに対して上位概念であるため、<a
href="#SS_1_5">依存関係逆転の原則(DIP)</a>にも反する。
よって、このアイデアを採用することはできない。</p>
<h4
id="ints_tを構造体としてapp内に宣言する">Ints_tを構造体としてApp内に宣言する
<a id="SS_3_1_6_5"></a></h4>
<p>App::Ints_t用のoperator&lt;&lt;がLogging::Logger::set_inner内でname
lookup出来ない理由は、 これまで述べてきたようにApp::Inst_tの<a
href="#SS_5_4_6">関連名前空間</a>がAppではなく、stdになってしまうからである。</p>
<p>これを回避するためにはその原因を取り払えばよく、
つまり、App::Inst_tの<a
href="#SS_5_4_6">関連名前空間</a>がAppになるようにすればよい。
これを実現するために、次のコードを試してみる。</p>
<div class="sourceCode" id="cb220"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/logger_0_struct_ut.cpp 10</span></span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> App <span class="op">{</span>                     <span class="co">// Ints_tの宣言はApp</span></span>
<span id="cb220-4"><a href="#cb220-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> <span class="dt">Ints_t</span> <span class="op">:</span> <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> <span class="op">{</span>  <span class="co">// エイリアスではなく、継承を使う</span></span>
<span id="cb220-5"><a href="#cb220-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> vector<span class="op">::</span>vector<span class="op">;</span>           <span class="co">// 継承コンストラクタ</span></span>
<span id="cb220-6"><a href="#cb220-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb220-7"><a href="#cb220-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-8"><a href="#cb220-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">// App内</span></span>
<span id="cb220-9"><a href="#cb220-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>ostream<span class="op">&amp;</span> <span class="kw">operator</span><span class="op">&lt;&lt;(</span><span class="bu">std::</span>ostream<span class="op">&amp;</span> os<span class="op">,</span> <span class="dt">Ints_t</span> <span class="at">const</span><span class="op">&amp;</span> ints<span class="op">)</span></span>
<span id="cb220-10"><a href="#cb220-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb220-11"><a href="#cb220-11" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> first <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb220-12"><a href="#cb220-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-13"><a href="#cb220-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> <span class="at">const</span> i <span class="op">:</span> ints<span class="op">)</span> <span class="op">{</span></span>
<span id="cb220-14"><a href="#cb220-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(!</span><span class="bu">std::</span>exchange<span class="op">(</span>first<span class="op">,</span> <span class="kw">false</span><span class="op">))</span> <span class="op">{</span></span>
<span id="cb220-15"><a href="#cb220-15" aria-hidden="true" tabindex="-1"></a>                os <span class="op">&lt;&lt;</span> <span class="st">&quot;, &quot;</span><span class="op">;</span></span>
<span id="cb220-16"><a href="#cb220-16" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb220-17"><a href="#cb220-17" aria-hidden="true" tabindex="-1"></a>            os <span class="op">&lt;&lt;</span> i<span class="op">;</span></span>
<span id="cb220-18"><a href="#cb220-18" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb220-19"><a href="#cb220-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-20"><a href="#cb220-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> os<span class="op">;</span></span>
<span id="cb220-21"><a href="#cb220-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb220-22"><a href="#cb220-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace App</span></span></code></pre></div>
<p>上記のコードでは、</p>
<ul>
<li>App::Ints_tをstd::vectorからpublic継承</li>
<li>using宣言によりstd::vectorのすべてのコンストラクタをApp::Ints_tに導入
(「<a href="#SS_5_2_3">継承コンストラクタ</a>」参照)</li>
</ul>
<p>としているため、エイリアスで宣言されたInts_tと等価である。
C++03では、<a
href="#SS_5_2_3">継承コンストラクタ</a>が使えなかったため、
上記のような構造体を定義するためには、
std::vectorのすべてのコンストラクタと等価なコンストラクタをApp::Ints_t内に定義することが必要で、
実践的にはこのようなアイデアは使い物にならなかったが、
C++11での改善により、実践的なアイデアとして使用できるようになった。</p>
<p>実際、名前空間の問題もなく、すでに示した単体テストもパスするので有力な候補となるが、
若干の「やりすぎ感」は否めない。</p>
<h4 id="operatorを使わない">operator&lt;&lt;を使わない
<a id="SS_3_1_6_6"></a></h4>
<p>色々なアイデアを試してみたが、これまでの議論ではこれといった解決方法を発見できなかった。
「<a
href="https://ja.wikipedia.org/wiki/%E3%83%8B%E3%83%BC%E3%83%90%E3%83%BC%E3%81%AE%E7%A5%88%E3%82%8A">バーニーの祈り</a>」
が言っている通り、時にはどうにもならないことを受け入れることも重要である。
LOGGERの中でname
lookupできる、エイリアスApp::Ints_tのoperator&lt;&lt;の開発をあきらめ、
ここでは一旦、下記のような受け入れがたいコードを受け入れることにする。</p>
<div class="sourceCode" id="cb221"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/app_ints.h 6</span></span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-3"><a href="#cb221-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> App <span class="op">{</span></span>
<span id="cb221-4"><a href="#cb221-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> <span class="dt">Ints_t</span> <span class="op">=</span> <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;;</span></span>
<span id="cb221-5"><a href="#cb221-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb222"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/logger_0_no_put_to_ut.cpp 10</span></span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> App <span class="op">{</span>  <span class="co">// App::Ints_tのoperator&lt;&lt;とToStringをApp内で定義</span></span>
<span id="cb222-4"><a href="#cb222-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> <span class="op">{</span>      <span class="co">// operator&lt;&lt;は外部から使わない</span></span>
<span id="cb222-5"><a href="#cb222-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>ostream<span class="op">&amp;</span> <span class="kw">operator</span><span class="op">&lt;&lt;(</span><span class="bu">std::</span>ostream<span class="op">&amp;</span> os<span class="op">,</span> <span class="dt">Ints_t</span> <span class="at">const</span><span class="op">&amp;</span> ints<span class="op">)</span></span>
<span id="cb222-6"><a href="#cb222-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb222-7"><a href="#cb222-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> first <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb222-8"><a href="#cb222-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-9"><a href="#cb222-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> <span class="at">const</span> i <span class="op">:</span> ints<span class="op">)</span> <span class="op">{</span></span>
<span id="cb222-10"><a href="#cb222-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(!</span><span class="bu">std::</span>exchange<span class="op">(</span>first<span class="op">,</span> <span class="kw">false</span><span class="op">))</span> <span class="op">{</span></span>
<span id="cb222-11"><a href="#cb222-11" aria-hidden="true" tabindex="-1"></a>                os <span class="op">&lt;&lt;</span> <span class="st">&quot;, &quot;</span><span class="op">;</span></span>
<span id="cb222-12"><a href="#cb222-12" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb222-13"><a href="#cb222-13" aria-hidden="true" tabindex="-1"></a>            os <span class="op">&lt;&lt;</span> i<span class="op">;</span></span>
<span id="cb222-14"><a href="#cb222-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb222-15"><a href="#cb222-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-16"><a href="#cb222-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> os<span class="op">;</span></span>
<span id="cb222-17"><a href="#cb222-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb222-18"><a href="#cb222-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace</span></span>
<span id="cb222-19"><a href="#cb222-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-20"><a href="#cb222-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Ints_tオブジェクトをstd::stringに変換する</span></span>
<span id="cb222-21"><a href="#cb222-21" aria-hidden="true" tabindex="-1"></a>    <span class="co">// この変換によりロガーに渡すことができる</span></span>
<span id="cb222-22"><a href="#cb222-22" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>string<span class="op"> </span>ToString<span class="op">(</span><span class="dt">Ints_t</span> <span class="at">const</span><span class="op">&amp;</span> inst<span class="op">)</span></span>
<span id="cb222-23"><a href="#cb222-23" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb222-24"><a href="#cb222-24" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> oss <span class="op">=</span> <span class="bu">std::</span>ostringstream<span class="op">{};</span></span>
<span id="cb222-25"><a href="#cb222-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-26"><a href="#cb222-26" aria-hidden="true" tabindex="-1"></a>        oss <span class="op">&lt;&lt;</span> inst<span class="op">;</span></span>
<span id="cb222-27"><a href="#cb222-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-28"><a href="#cb222-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> oss<span class="op">.</span>str<span class="op">();</span></span>
<span id="cb222-29"><a href="#cb222-29" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb222-30"><a href="#cb222-30" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace App</span></span></code></pre></div>
<p>当然だが、恥を忍んで受け入れたコードにも単体テストは必要である。</p>
<div class="sourceCode" id="cb223"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/logger_0_no_put_to_ut.cpp 47</span></span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> ints <span class="op">=</span> App<span class="op">::</span><span class="dt">Ints_t</span><span class="op">{</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">};</span></span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-5"><a href="#cb223-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ToStringのテスト</span></span>
<span id="cb223-6"><a href="#cb223-6" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;1, 2, 3&quot;</span><span class="op">,</span> App<span class="op">::</span>ToString<span class="op">(</span>ints<span class="op">));</span></span>
<span id="cb223-7"><a href="#cb223-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-8"><a href="#cb223-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">// LOGGERのテスト</span></span>
<span id="cb223-9"><a href="#cb223-9" aria-hidden="true" tabindex="-1"></a>    LOGGER<span class="op">(</span><span class="st">&quot;Ints&quot;</span><span class="op">,</span> App<span class="op">::</span>ToString<span class="op">(</span>ints<span class="op">));</span></span>
<span id="cb223-10"><a href="#cb223-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> line_num <span class="op">=</span> <span class="ot">__LINE__</span><span class="op">;</span></span>
<span id="cb223-11"><a href="#cb223-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-12"><a href="#cb223-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> s <span class="op">=</span> Logging<span class="op">::</span>Logger<span class="op">::</span>InstConst<span class="op">().</span>Get<span class="op">();</span></span>
<span id="cb223-13"><a href="#cb223-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-14"><a href="#cb223-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> exp <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{</span>log_str_exp<span class="op">(</span><span class="ot">__FILE__</span><span class="op">,</span> line_num <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> <span class="st">&quot;:Ints:1, 2, 3</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">)};</span></span>
<span id="cb223-15"><a href="#cb223-15" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>exp<span class="op">,</span> s<span class="op">);</span></span></code></pre></div>
<p>上記コードから明らかな通り、App::Ints_tのインスタンスをログ登録する場合、
App::ToString()によりstd::stringへ変換する必要があり、残念なインターフェースとなっている。</p>
<h4 id="ints_tのログ登録のまとめ">Ints_tのログ登録のまとめ
<a id="SS_3_1_6_7"></a></h4>
<p>製品開発では、満足できる仕様の関数やクラスが作れず、妥協せざるを得ないことはよくあることである。
このような場合、将来、良いアイデアが見つかった時に備えて、
妥協コードを簡単に修正できるようなレベルにした後、捲土重来を期してさっさと退却するのがベストである。
ただし、漫然と過ごしても良いアイデアは浮かばない。
時間を作り、関連書籍やウェブドキュメント等を読み、学習を継続する必要があることは言うまでもない。</p>
<h2 id="nstdライブラリの開発">Nstdライブラリの開発
<a id="SS_3_2"></a></h2>
<p>「<a
href="#SS_3_1_6_6">operator&lt;&lt;を使わない</a>」で導入したコードは、短いながらも汎用性が高い。
このようなコードをローカルなファイルに閉じ込めてしまうと、
コードクローンや、<a
href="#SS_5_12_2">車輪の再発明</a>による開発効率の低下につながることがある。</p>
<p>通常、プロジェクトの全ファイルから参照可能で且つ、
プロジェクトの他のパッケージに非依存なパッケージを用意することで、このような問題を回避できる。</p>
<p>ここでは、そのようなパッケージをNstd(not standard
library)とし、名前空間も同様に宣言する。
そうした場合、この章の例題で使用している名前空間の依存関係は下記のようになる。</p>
<p>
<img src="data:image/png;base64,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" />
</p>
<p>このように整理された依存関係は、
大規模ソフトウェア開発においては特に重要であり、決して循環しないように維持しなければならない。</p>
<h3
id="nstdライブラリを使用したリファクタリング">Nstdライブラリを使用したリファクタリング
<a id="SS_3_2_1"></a></h3>
<p>すでに述べた通り、「<a
href="#SS_3_1_6_6">operator&lt;&lt;を使わない</a>」で導入したコードは、Nstdで定義するべきである。
その場合、下記のようにさらに一般化するのが良いだろう。</p>
<div class="sourceCode" id="cb224"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_0.h 4</span></span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> Nstd <span class="op">{</span></span>
<span id="cb224-4"><a href="#cb224-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-5"><a href="#cb224-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb224-6"><a href="#cb224-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>ostream<span class="op">&amp;</span> <span class="kw">operator</span><span class="op">&lt;&lt;(</span><span class="bu">std::</span>ostream<span class="op">&amp;</span> os<span class="op">,</span> <span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;</span> <span class="at">const</span><span class="op">&amp;</span> vec<span class="op">)</span></span>
<span id="cb224-7"><a href="#cb224-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb224-8"><a href="#cb224-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> first <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb224-9"><a href="#cb224-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-10"><a href="#cb224-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> <span class="at">const</span><span class="op">&amp;</span> i <span class="op">:</span> vec<span class="op">)</span> <span class="op">{</span></span>
<span id="cb224-11"><a href="#cb224-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(!</span><span class="bu">std::</span>exchange<span class="op">(</span>first<span class="op">,</span> <span class="kw">false</span><span class="op">))</span> <span class="op">{</span></span>
<span id="cb224-12"><a href="#cb224-12" aria-hidden="true" tabindex="-1"></a>                os <span class="op">&lt;&lt;</span> <span class="st">&quot;, &quot;</span><span class="op">;</span></span>
<span id="cb224-13"><a href="#cb224-13" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb224-14"><a href="#cb224-14" aria-hidden="true" tabindex="-1"></a>            os <span class="op">&lt;&lt;</span> i<span class="op">;</span></span>
<span id="cb224-15"><a href="#cb224-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb224-16"><a href="#cb224-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-17"><a href="#cb224-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> os<span class="op">;</span></span>
<span id="cb224-18"><a href="#cb224-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb224-19"><a href="#cb224-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-20"><a href="#cb224-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb224-21"><a href="#cb224-21" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>string<span class="op"> </span>ToString<span class="op">(</span><span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;</span> <span class="at">const</span><span class="op">&amp;</span> vec<span class="op">)</span></span>
<span id="cb224-22"><a href="#cb224-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb224-23"><a href="#cb224-23" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> oss <span class="op">=</span> <span class="bu">std::</span>ostringstream<span class="op">{};</span></span>
<span id="cb224-24"><a href="#cb224-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-25"><a href="#cb224-25" aria-hidden="true" tabindex="-1"></a>        oss <span class="op">&lt;&lt;</span> vec<span class="op">;</span></span>
<span id="cb224-26"><a href="#cb224-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-27"><a href="#cb224-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> oss<span class="op">.</span>str<span class="op">();</span></span>
<span id="cb224-28"><a href="#cb224-28" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb224-29"><a href="#cb224-29" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace Nstd</span></span></code></pre></div>
<p>その単体テストは下記のようになる。</p>
<div class="sourceCode" id="cb225"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_0_ut.cpp 13</span></span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> <span class="at">const</span> ints <span class="op">=</span> App<span class="op">::</span><span class="dt">Ints_t</span><span class="op">{</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">};</span></span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-5"><a href="#cb225-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb225-6"><a href="#cb225-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> oss <span class="op">=</span> <span class="bu">std::</span>ostringstream<span class="op">{};</span></span>
<span id="cb225-7"><a href="#cb225-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-8"><a href="#cb225-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> <span class="kw">namespace</span> Nstd<span class="op">;</span></span>
<span id="cb225-9"><a href="#cb225-9" aria-hidden="true" tabindex="-1"></a>        oss <span class="op">&lt;&lt;</span> ints <span class="op">&lt;&lt;</span> <span class="dv">4</span><span class="op">;</span></span>
<span id="cb225-10"><a href="#cb225-10" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;1, 2, 34&quot;</span><span class="op">,</span> oss<span class="op">.</span>str<span class="op">());</span></span>
<span id="cb225-11"><a href="#cb225-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb225-12"><a href="#cb225-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb225-13"><a href="#cb225-13" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> oss <span class="op">=</span> <span class="bu">std::</span>ostringstream<span class="op">{};</span></span>
<span id="cb225-14"><a href="#cb225-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-15"><a href="#cb225-15" aria-hidden="true" tabindex="-1"></a>        Nstd<span class="op">::</span><span class="kw">operator</span><span class="op">&lt;&lt;(</span>oss<span class="op">,</span> ints<span class="op">)</span> <span class="op">&lt;&lt;</span> <span class="dv">4</span><span class="op">;</span>  <span class="co">// 念のためこの形式でもテスト</span></span>
<span id="cb225-16"><a href="#cb225-16" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;1, 2, 34&quot;</span><span class="op">,</span> oss<span class="op">.</span>str<span class="op">());</span></span>
<span id="cb225-17"><a href="#cb225-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb225-18"><a href="#cb225-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-19"><a href="#cb225-19" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;1, 2, 3&quot;</span><span class="op">,</span> Nstd<span class="op">::</span>ToString<span class="op">(</span>ints<span class="op">));</span></span></code></pre></div>
<p>勘のいい読者なら、このコードをLOGGERから利用することで、
App:Ints_tのログ登録問題を解消できると思うかもしれない。
実際その通りなのであるが、そうした場合、
std::list等の他のコンテナや配列には対応できないという問題が残るため、
以降もしばらくNstdの開発を続ける。</p>
<h3 id="安全なvector">安全なvector <a id="SS_3_2_2"></a></h3>
<p>std::vector、std::basic_string、std::array等の配列型コンテナは、</p>
<ul>
<li>operator[]経由でのメンバアクセスについて範囲の妥当性をチェックしない</li>
<li>範囲のチェックが必要ならばat()を使用する</li>
</ul>
<p>という仕様になっているが、
ここではoperator[]にも範囲のチェックを行う配列型コンテナが必要になった場合について考える。</p>
<p>手始めにoperator[]にも範囲のチェックを行うstd::vector相当のコンテナSafeVectorを作ると、
下記のコードのようになる。</p>
<div class="sourceCode" id="cb226"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/safe_vector_ut.cpp 9</span></span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-3"><a href="#cb226-3" aria-hidden="true" tabindex="-1"></a><span class="kw">namespace</span> Nstd <span class="op">{</span></span>
<span id="cb226-4"><a href="#cb226-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-5"><a href="#cb226-5" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb226-6"><a href="#cb226-6" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> SafeVector <span class="op">:</span> <span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb226-7"><a href="#cb226-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> <span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;::</span>vector<span class="op">;</span>  <span class="co">// 継承コンストラクタ</span></span>
<span id="cb226-8"><a href="#cb226-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-9"><a href="#cb226-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> <span class="dt">base_type</span> <span class="op">=</span> <span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;;</span></span>
<span id="cb226-10"><a href="#cb226-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> <span class="dt">size_type</span> <span class="op">=</span> <span class="kw">typename</span> <span class="dt">base_type</span><span class="op">::</span><span class="dt">size_type</span><span class="op">;</span></span>
<span id="cb226-11"><a href="#cb226-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-12"><a href="#cb226-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">typename</span> <span class="dt">base_type</span><span class="op">::</span>reference       <span class="kw">operator</span><span class="op">[](</span><span class="dt">size_type</span> i<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> <span class="kw">this</span><span class="op">-&gt;</span>at<span class="op">(</span>i<span class="op">);</span> <span class="op">}</span></span>
<span id="cb226-13"><a href="#cb226-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">typename</span> <span class="dt">base_type</span><span class="op">::</span>const_reference <span class="kw">operator</span><span class="op">[](</span><span class="dt">size_type</span> i<span class="op">)</span> <span class="at">const</span> <span class="op">{</span> <span class="cf">return</span> <span class="kw">this</span><span class="op">-&gt;</span>at<span class="op">(</span>i<span class="op">);</span> <span class="op">}</span></span>
<span id="cb226-14"><a href="#cb226-14" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span>
<span id="cb226-15"><a href="#cb226-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span>  <span class="co">// namespace Nstd</span></span></code></pre></div>
<p>このコードで行ったことは、</p>
<ul>
<li>std::vectorからSafeVectorをpublic継承する</li>
<li>継承コンストラクタの機能を使い、std::vectorのコンストラクタをSafeVectorで宣言する</li>
<li>std::vector::atを使い、SafeVector::operator[]を定義する</li>
</ul>
<p>である。単体テストは下記のようになる。</p>
<div class="sourceCode" id="cb227"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/safe_vector_ut.cpp 29</span></span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb227-4"><a href="#cb227-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> v <span class="op">=</span> Nstd<span class="op">::</span>SafeVector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="dv">10</span><span class="op">);</span>  <span class="co">// ()での初期化</span></span>
<span id="cb227-5"><a href="#cb227-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-6"><a href="#cb227-6" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="dv">10</span><span class="op">,</span> v<span class="op">.</span>size<span class="op">());</span></span>
<span id="cb227-7"><a href="#cb227-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb227-8"><a href="#cb227-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb227-9"><a href="#cb227-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> <span class="at">const</span> v <span class="op">=</span> Nstd<span class="op">::</span>SafeVector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;{</span><span class="dv">10</span><span class="op">};</span></span>
<span id="cb227-10"><a href="#cb227-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-11"><a href="#cb227-11" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="dv">1</span><span class="op">,</span> v<span class="op">.</span>size<span class="op">());</span></span>
<span id="cb227-12"><a href="#cb227-12" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="dv">10</span><span class="op">,</span> v<span class="op">[</span><span class="dv">0</span><span class="op">]);</span></span>
<span id="cb227-13"><a href="#cb227-13" aria-hidden="true" tabindex="-1"></a>        ASSERT_THROW<span class="op">(</span>v<span class="op">[</span><span class="dv">1</span><span class="op">],</span> <span class="bu">std::</span>out_of_range<span class="op">);</span>  <span class="co">// エクセプションの発生</span></span>
<span id="cb227-14"><a href="#cb227-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb227-15"><a href="#cb227-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb227-16"><a href="#cb227-16" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> v <span class="op">=</span> Nstd<span class="op">::</span>SafeVector<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;{</span><span class="st">&quot;1&quot;</span><span class="op">,</span> <span class="st">&quot;2&quot;</span><span class="op">,</span> <span class="st">&quot;3&quot;</span><span class="op">};</span></span>
<span id="cb227-17"><a href="#cb227-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-18"><a href="#cb227-18" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="dv">3</span><span class="op">,</span> v<span class="op">.</span>size<span class="op">());</span></span>
<span id="cb227-19"><a href="#cb227-19" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">((</span><span class="bu">std::</span>vector<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;{</span><span class="st">&quot;1&quot;</span><span class="op">,</span> <span class="st">&quot;2&quot;</span><span class="op">,</span> <span class="st">&quot;3&quot;</span><span class="op">}),</span> v<span class="op">);</span></span>
<span id="cb227-20"><a href="#cb227-20" aria-hidden="true" tabindex="-1"></a>        ASSERT_THROW<span class="op">(</span>v<span class="op">[</span><span class="dv">3</span><span class="op">],</span> <span class="bu">std::</span>out_of_range<span class="op">);</span>  <span class="co">// エクセプションの発生</span></span>
<span id="cb227-21"><a href="#cb227-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb227-22"><a href="#cb227-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb227-23"><a href="#cb227-23" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> <span class="at">const</span> v <span class="op">=</span> Nstd<span class="op">::</span>SafeVector<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;{</span><span class="st">&quot;1&quot;</span><span class="op">,</span> <span class="st">&quot;2&quot;</span><span class="op">,</span> <span class="st">&quot;3&quot;</span><span class="op">};</span></span>
<span id="cb227-24"><a href="#cb227-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-25"><a href="#cb227-25" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="dv">3</span><span class="op">,</span> v<span class="op">.</span>size<span class="op">());</span></span>
<span id="cb227-26"><a href="#cb227-26" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">((</span><span class="bu">std::</span>vector<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;{</span><span class="st">&quot;1&quot;</span><span class="op">,</span> <span class="st">&quot;2&quot;</span><span class="op">,</span> <span class="st">&quot;3&quot;</span><span class="op">}),</span> v<span class="op">);</span></span>
<span id="cb227-27"><a href="#cb227-27" aria-hidden="true" tabindex="-1"></a>        ASSERT_THROW<span class="op">(</span>v<span class="op">[</span><span class="dv">3</span><span class="op">],</span> <span class="bu">std::</span>out_of_range<span class="op">);</span>  <span class="co">// エクセプションの発生</span></span>
<span id="cb227-28"><a href="#cb227-28" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<h3 id="安全な配列型コンテナ">安全な配列型コンテナ
<a id="SS_3_2_3"></a></h3>
<p>配列型コンテナはすでに述べたようにstd::vectorの他にすくなともstd::basic_string、
std::arrayがあるため、それらにも範囲チェックを導入する。</p>
<p>std::basic_stringはstd::vectorとほぼ同様に下記のようになる。</p>
<div class="sourceCode" id="cb228"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/safe_vector_ut.cpp 61</span></span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> Nstd <span class="op">{</span></span>
<span id="cb228-3"><a href="#cb228-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-4"><a href="#cb228-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> SafeString <span class="op">:</span> <span class="bu">std::</span>string<span class="op"> {</span></span>
<span id="cb228-5"><a href="#cb228-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> <span class="bu">std::</span>string<span class="bu">::</span>string<span class="op">;</span>  <span class="co">// 継承コンストラクタ</span></span>
<span id="cb228-6"><a href="#cb228-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-7"><a href="#cb228-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> <span class="dt">base_type</span> <span class="op">=</span> <span class="bu">std::</span>string<span class="op">;</span></span>
<span id="cb228-8"><a href="#cb228-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> <span class="dt">size_type</span> <span class="op">=</span> <span class="kw">typename</span> <span class="dt">base_type</span><span class="op">::</span><span class="dt">size_type</span><span class="op">;</span></span>
<span id="cb228-9"><a href="#cb228-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-10"><a href="#cb228-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">typename</span> <span class="dt">base_type</span><span class="op">::</span>reference       <span class="kw">operator</span><span class="op">[](</span><span class="dt">size_type</span> i<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> <span class="kw">this</span><span class="op">-&gt;</span>at<span class="op">(</span>i<span class="op">);</span> <span class="op">}</span></span>
<span id="cb228-11"><a href="#cb228-11" aria-hidden="true" tabindex="-1"></a>        <span class="kw">typename</span> <span class="dt">base_type</span><span class="op">::</span>const_reference <span class="kw">operator</span><span class="op">[](</span><span class="dt">size_type</span> i<span class="op">)</span> <span class="at">const</span> <span class="op">{</span> <span class="cf">return</span> <span class="kw">this</span><span class="op">-&gt;</span>at<span class="op">(</span>i<span class="op">);</span> <span class="op">}</span></span>
<span id="cb228-12"><a href="#cb228-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb228-13"><a href="#cb228-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace Nstd</span></span></code></pre></div>
<p>std::stringはstd::basic_string&lt;char&gt;のエイリアスであるため、
上記では、通常使われる形式であるstd::stringを継承したSafeStringを定義した。</p>
<p>この単体テストはSafeVectorの場合と同様に下記のようになる。</p>
<div class="sourceCode" id="cb229"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/safe_vector_ut.cpp 79</span></span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> s <span class="op">=</span> Nstd<span class="op">::</span>SafeString<span class="op">{</span><span class="st">&quot;0123456789&quot;</span><span class="op">};</span></span>
<span id="cb229-5"><a href="#cb229-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-6"><a href="#cb229-6" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="dv">10</span><span class="op">,</span> s<span class="op">.</span>size<span class="op">());</span></span>
<span id="cb229-7"><a href="#cb229-7" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;0123456789&quot;</span><span class="op">,</span> s<span class="op">);</span></span>
<span id="cb229-8"><a href="#cb229-8" aria-hidden="true" tabindex="-1"></a>        ASSERT_THROW<span class="op">(</span>s<span class="op">[</span><span class="dv">10</span><span class="op">],</span> <span class="bu">std::</span>out_of_range<span class="op">);</span></span>
<span id="cb229-9"><a href="#cb229-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb229-10"><a href="#cb229-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb229-11"><a href="#cb229-11" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> <span class="at">const</span> s <span class="op">=</span> Nstd<span class="op">::</span>SafeString<span class="op">(</span><span class="dv">3</span><span class="op">,</span> <span class="ch">&#39;c&#39;</span><span class="op">);</span>  <span class="co">// ()での初期化が必要</span></span>
<span id="cb229-12"><a href="#cb229-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-13"><a href="#cb229-13" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="dv">3</span><span class="op">,</span> s<span class="op">.</span>size<span class="op">());</span></span>
<span id="cb229-14"><a href="#cb229-14" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;ccc&quot;</span><span class="op">,</span> s<span class="op">);</span></span>
<span id="cb229-15"><a href="#cb229-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>std::arrayでは少々事情が異なるが、
std::vectorのコードパターンをそのまま適用すると下記のようになる。</p>
<div class="sourceCode" id="cb230"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/safe_vector_ut.cpp 100</span></span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-3"><a href="#cb230-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> Nstd <span class="op">{</span></span>
<span id="cb230-4"><a href="#cb230-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-5"><a href="#cb230-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">,</span> <span class="dt">size_t</span> N<span class="op">&gt;</span></span>
<span id="cb230-6"><a href="#cb230-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> SafeArray <span class="op">:</span> <span class="bu">std::</span>array<span class="op">&lt;</span>T<span class="op">,</span> N<span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb230-7"><a href="#cb230-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> <span class="bu">std::</span>array<span class="op">&lt;</span>T<span class="op">,</span> N<span class="op">&gt;::</span>array<span class="op">;</span>  <span class="co">// 継承コンストラクタ</span></span>
<span id="cb230-8"><a href="#cb230-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-9"><a href="#cb230-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> <span class="dt">base_type</span> <span class="op">=</span> <span class="bu">std::</span>array<span class="op">&lt;</span>T<span class="op">,</span> N<span class="op">&gt;;</span></span>
<span id="cb230-10"><a href="#cb230-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> <span class="dt">size_type</span> <span class="op">=</span> <span class="kw">typename</span> <span class="dt">base_type</span><span class="op">::</span><span class="dt">size_type</span><span class="op">;</span></span>
<span id="cb230-11"><a href="#cb230-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-12"><a href="#cb230-12" aria-hidden="true" tabindex="-1"></a>        <span class="kw">typename</span> <span class="dt">base_type</span><span class="op">::</span>reference       <span class="kw">operator</span><span class="op">[](</span><span class="dt">size_type</span> i<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> <span class="kw">this</span><span class="op">-&gt;</span>at<span class="op">(</span>i<span class="op">);</span> <span class="op">}</span></span>
<span id="cb230-13"><a href="#cb230-13" aria-hidden="true" tabindex="-1"></a>        <span class="kw">typename</span> <span class="dt">base_type</span><span class="op">::</span>const_reference <span class="kw">operator</span><span class="op">[](</span><span class="dt">size_type</span> i<span class="op">)</span> <span class="at">const</span> <span class="op">{</span> <span class="cf">return</span> <span class="kw">this</span><span class="op">-&gt;</span>at<span class="op">(</span>i<span class="op">);</span> <span class="op">}</span></span>
<span id="cb230-14"><a href="#cb230-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb230-15"><a href="#cb230-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace Nstd</span></span></code></pre></div>
<p>ただし、この実装には問題がある。</p>
<div class="sourceCode" id="cb231"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/safe_vector_ut.cpp 121</span></span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-3"><a href="#cb231-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> sa_not_init <span class="op">=</span> Nstd<span class="op">::</span>SafeArray<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dv">3</span><span class="op">&gt;{};</span></span>
<span id="cb231-4"><a href="#cb231-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-5"><a href="#cb231-5" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">3</span><span class="op">,</span> sa_not_init<span class="op">.</span>size<span class="op">());</span></span>
<span id="cb231-6"><a href="#cb231-6" aria-hidden="true" tabindex="-1"></a>    ASSERT_THROW<span class="op">(</span>sa_not_init<span class="op">[</span><span class="dv">3</span><span class="op">],</span> <span class="bu">std::</span>out_of_range<span class="op">);</span></span></code></pre></div>
<p>上記コードでは、その問題が露見することはないが、以下のコードはコンパイルできない。</p>
<div class="sourceCode" id="cb232"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/safe_vector_ut.cpp 131</span></span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-3"><a href="#cb232-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// std::initializer_listを引数とするコンストラクタが未定義</span></span>
<span id="cb232-4"><a href="#cb232-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> sa_init <span class="op">=</span> Nstd<span class="op">::</span>SafeArray<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dv">3</span><span class="op">&gt;{</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">};</span></span>
<span id="cb232-5"><a href="#cb232-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-6"><a href="#cb232-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">// デフォルトコンストラクタがないため、未初期化</span></span>
<span id="cb232-7"><a href="#cb232-7" aria-hidden="true" tabindex="-1"></a>    Nstd<span class="op">::</span>SafeArray<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dv">3</span><span class="op">&gt;</span> <span class="at">const</span> sa_const<span class="op">;</span></span></code></pre></div>
<p>std::arrayにはコンストラクタが明示的に定義されていないため、
std::arrayにはデフォルトで自動生成される</p>
<ul>
<li>デフォルトコンストラクタ</li>
<li>copyコンストラクタ</li>
<li>moveコンストラクタ</li>
</ul>
<p>以外のコンストラクタがないことが原因である。
従って、SafeArray(std::initializer_list)が定義されず前述したようにコンパイルエラーとなる。</p>
<p>この問題に対処したのが以下のコードである。</p>
<div class="sourceCode" id="cb233"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/safe_vector_ut.cpp 145</span></span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-3"><a href="#cb233-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> Nstd <span class="op">{</span></span>
<span id="cb233-4"><a href="#cb233-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-5"><a href="#cb233-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">,</span> <span class="dt">size_t</span> N<span class="op">&gt;</span></span>
<span id="cb233-6"><a href="#cb233-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> SafeArray <span class="op">:</span> <span class="bu">std::</span>array<span class="op">&lt;</span>T<span class="op">,</span> N<span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb233-7"><a href="#cb233-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> <span class="bu">std::</span>array<span class="op">&lt;</span>T<span class="op">,</span> N<span class="op">&gt;::</span>array<span class="op">;</span>  <span class="co">// 継承コンストラクタ</span></span>
<span id="cb233-8"><a href="#cb233-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> <span class="dt">base_type</span> <span class="op">=</span> <span class="bu">std::</span>array<span class="op">&lt;</span>T<span class="op">,</span> N<span class="op">&gt;;</span></span>
<span id="cb233-9"><a href="#cb233-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-10"><a href="#cb233-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span><span class="op">...</span> ARGS<span class="op">&gt;</span>  <span class="co">// コンストラクタを定義</span></span>
<span id="cb233-11"><a href="#cb233-11" aria-hidden="true" tabindex="-1"></a>        SafeArray<span class="op">(</span>ARGS<span class="op">...</span> args<span class="op">)</span> <span class="op">:</span> <span class="dt">base_type</span><span class="op">{</span>args<span class="op">...}</span></span>
<span id="cb233-12"><a href="#cb233-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb233-13"><a href="#cb233-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb233-14"><a href="#cb233-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-15"><a href="#cb233-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> <span class="dt">size_type</span> <span class="op">=</span> <span class="kw">typename</span> <span class="dt">base_type</span><span class="op">::</span><span class="dt">size_type</span><span class="op">;</span></span>
<span id="cb233-16"><a href="#cb233-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-17"><a href="#cb233-17" aria-hidden="true" tabindex="-1"></a>        <span class="kw">typename</span> <span class="dt">base_type</span><span class="op">::</span>reference       <span class="kw">operator</span><span class="op">[](</span><span class="dt">size_type</span> i<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> <span class="kw">this</span><span class="op">-&gt;</span>at<span class="op">(</span>i<span class="op">);</span> <span class="op">}</span></span>
<span id="cb233-18"><a href="#cb233-18" aria-hidden="true" tabindex="-1"></a>        <span class="kw">typename</span> <span class="dt">base_type</span><span class="op">::</span>const_reference <span class="kw">operator</span><span class="op">[](</span><span class="dt">size_type</span> i<span class="op">)</span> <span class="at">const</span> <span class="op">{</span> <span class="cf">return</span> <span class="kw">this</span><span class="op">-&gt;</span>at<span class="op">(</span>i<span class="op">);</span> <span class="op">}</span></span>
<span id="cb233-19"><a href="#cb233-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb233-20"><a href="#cb233-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace Nstd</span></span></code></pre></div>
<p>上記コードで注目すべきは、パラメータパックをテンプレートパラメータとしたコンストラクタである。
これにより、前例ではコンパイルすらできなかった下記のような初期化子リストを用いた単体テストが、
このコンストラクタによりパスするようになった。</p>
<div class="sourceCode" id="cb234"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/safe_vector_ut.cpp 180</span></span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb234-3"><a href="#cb234-3" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> sa_init <span class="op">=</span> Nstd<span class="op">::</span>SafeArray<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dv">3</span><span class="op">&gt;{</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">};</span></span>
<span id="cb234-4"><a href="#cb234-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-5"><a href="#cb234-5" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="dv">3</span><span class="op">,</span> sa_init<span class="op">.</span>size<span class="op">());</span></span>
<span id="cb234-6"><a href="#cb234-6" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="dv">1</span><span class="op">,</span> sa_init<span class="op">[</span><span class="dv">0</span><span class="op">]);</span></span>
<span id="cb234-7"><a href="#cb234-7" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="dv">2</span><span class="op">,</span> sa_init<span class="op">[</span><span class="dv">1</span><span class="op">]);</span></span>
<span id="cb234-8"><a href="#cb234-8" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="dv">3</span><span class="op">,</span> sa_init<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb234-9"><a href="#cb234-9" aria-hidden="true" tabindex="-1"></a>        ASSERT_THROW<span class="op">(</span>sa_init<span class="op">[</span><span class="dv">3</span><span class="op">],</span> <span class="bu">std::</span>out_of_range<span class="op">);</span></span>
<span id="cb234-10"><a href="#cb234-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb234-11"><a href="#cb234-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb234-12"><a href="#cb234-12" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> <span class="at">const</span> sa_string_const <span class="op">=</span> Nstd<span class="op">::</span>SafeArray<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">,</span> <span class="dv">5</span><span class="op">&gt;{</span><span class="st">&quot;1&quot;</span><span class="op">,</span> <span class="st">&quot;2&quot;</span><span class="op">,</span> <span class="st">&quot;3&quot;</span><span class="op">};</span></span>
<span id="cb234-13"><a href="#cb234-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-14"><a href="#cb234-14" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="dv">5</span><span class="op">,</span> sa_string_const<span class="op">.</span>size<span class="op">());</span></span>
<span id="cb234-15"><a href="#cb234-15" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;1&quot;</span><span class="op">,</span> sa_string_const<span class="op">[</span><span class="dv">0</span><span class="op">]);</span></span>
<span id="cb234-16"><a href="#cb234-16" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;2&quot;</span><span class="op">,</span> sa_string_const<span class="op">[</span><span class="dv">1</span><span class="op">]);</span></span>
<span id="cb234-17"><a href="#cb234-17" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;3&quot;</span><span class="op">,</span> sa_string_const<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb234-18"><a href="#cb234-18" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;&quot;</span><span class="op">,</span> sa_string_const<span class="op">[</span><span class="dv">3</span><span class="op">]);</span></span>
<span id="cb234-19"><a href="#cb234-19" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;&quot;</span><span class="op">,</span> sa_string_const<span class="op">[</span><span class="dv">4</span><span class="op">]);</span></span>
<span id="cb234-20"><a href="#cb234-20" aria-hidden="true" tabindex="-1"></a>        ASSERT_THROW<span class="op">(</span>sa_string_const<span class="op">[</span><span class="dv">5</span><span class="op">],</span> <span class="bu">std::</span>out_of_range<span class="op">);</span></span>
<span id="cb234-21"><a href="#cb234-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>この効果を生み出した上記を抜粋した下記のコードには解説が必要だろう。</p>
<div class="sourceCode" id="cb235"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/safe_vector_ut.cpp 154</span></span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-3"><a href="#cb235-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span><span class="op">...</span> ARGS<span class="op">&gt;</span>  <span class="co">// コンストラクタを定義</span></span>
<span id="cb235-4"><a href="#cb235-4" aria-hidden="true" tabindex="-1"></a>    SafeArray<span class="op">(</span>ARGS<span class="op">...</span> args<span class="op">)</span> <span class="op">:</span> <span class="dt">base_type</span><span class="op">{</span>args<span class="op">...}</span></span>
<span id="cb235-5"><a href="#cb235-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb235-6"><a href="#cb235-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>一般にコンストラクタには「メンバ変数の初期化」と「基底クラスの初期化」が求められるが、
SafeArrayにはメンバ変数が存在しないため、
このコンストラクタの役割は「基底クラスの初期化」のみとなる。
基底クラスstd::array(上記例ではbase_typeにエイリアスしている)
には名前が非規定の配列メンバのみを持つため、
これを初期化するためには初期化子リスト (「<a
href="#SS_5_2_2">初期化子リストコンストラクタ</a>」、 「<a
href="#SS_5_2_7">一様初期化</a>」参照)を用いるのが良い。</p>
<p>ということは、SafeArrayの初期化子リストコンストラクタには、
「基底クラスstd::arrayに初期子リストを与えて初期化する」形式が必要になる。
値を持つパラメータパックは初期化子リストに展開できるため、
ここで必要な形式はパラメータパックとなる。
これを実現したのが上記に抜粋したわずか数行のコードである。</p>
<h3 id="初期化子リストの副作用">初期化子リストの副作用
<a id="SS_3_2_4"></a></h3>
<p>上記SafeArrayの初期化子リストコンストラクタは以下のようなコードを許可しない。</p>
<div class="sourceCode" id="cb236"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/safe_vector_ut.cpp 212</span></span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb236-3"><a href="#cb236-3" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> sa_init <span class="op">=</span> Nstd<span class="op">::</span>SafeArray<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dv">3</span><span class="op">&gt;{</span><span class="fl">1.0</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">};</span></span>
<span id="cb236-4"><a href="#cb236-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-5"><a href="#cb236-5" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="dv">3</span><span class="op">,</span> sa_init<span class="op">.</span>size<span class="op">());</span></span>
<span id="cb236-6"><a href="#cb236-6" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="dv">1</span><span class="op">,</span> sa_init<span class="op">[</span><span class="dv">0</span><span class="op">]);</span></span>
<span id="cb236-7"><a href="#cb236-7" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="dv">2</span><span class="op">,</span> sa_init<span class="op">[</span><span class="dv">1</span><span class="op">]);</span></span>
<span id="cb236-8"><a href="#cb236-8" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="dv">3</span><span class="op">,</span> sa_init<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb236-9"><a href="#cb236-9" aria-hidden="true" tabindex="-1"></a>        ASSERT_THROW<span class="op">(</span>sa_init<span class="op">[</span><span class="dv">3</span><span class="op">],</span> <span class="bu">std::</span>out_of_range<span class="op">);</span></span>
<span id="cb236-10"><a href="#cb236-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>このコードをコンパイルすると、</p>
<pre><code>    safe_vector_ut.cpp:147:41: error: narrowing conversion of ‘
                                        args#0’ from ‘double’ to ‘int’ -Werror=narrowing]
      147 |     SafeArray(ARGS... args) : base_type{args...}
          |                                         ^~~~</code></pre>
<p>のようなエラーが出力されるが、</p>
<ul>
<li>double(上記例では1.0)をintに変換する際に縮小変換(narrowing
conversio)nが起こる</li>
<li>初期化子リストでの縮小変換は許可されない</li>
</ul>
<p>が原因である。これは意図しない縮小変換によるバグを防ぐ良い機能だと思うが、
ここではテンプレートメタプログラミングのテクニックを解説するため、
あえてこのコンパイルエラーを起こさないSafeArray2を開発する
(言うまでもないが、通常のソフトウェア開発では、
縮小変換によるコンパイルエラーを回避するようなコードを書いてはならない)。</p>
<p>SafeArray2のコードは、</p>
<ul>
<li>STLのtype_traitsの使用</li>
<li>テンプレートの特殊化</li>
<li>メンバ関数テンプレートとオーバーロードによる静的ディスパッチ(コンパイル時ディスパッチ)</li>
<li><a href="#SS_5_4_7">SFINAE</a></li>
</ul>
<p>等のメタ関数系のテクニックが必要になるため、
まずはこれらを含めたテンプレートのテクニックについて解説し、
その後SafeArray2を見ていくことにする。</p>
<h2 id="メタ関数のテクニック">メタ関数のテクニック
<a id="SS_3_3"></a></h2>
<p>本章で扱うメタ関数とは、型、定数、クラステンプレート等からなるテンプレート引数から、
型、エイリアス、定数等を宣言、定義するようなクラステンプレート、関数テンプレート、
定数テンプレート、エイリアステンプレートを指す
(本章ではこれらをまとめて単にテンプレート呼ぶことがある)。</p>
<h3 id="stlのtype_traits">STLのtype_traits <a id="SS_3_3_1"></a></h3>
<p>メタ関数ライブラリの代表的実装例はSTLの <a
href="https://cpprefjp.github.io/reference/type_traits.html">type_traits</a>である。</p>
<p>ここでは、よく使ういくつかのtype_traitsテンプレートの使用例や解説を示す。</p>
<h4 id="stdtrue_typestdfalse_type">std::true_type/std::false_type
<a id="SS_3_3_1_1"></a></h4>
<p>std::true_type/std::false_typeは真/偽を返すSTLメタ関数群の戻り型となる型エイリアスであるため、
最も使われるテンプレートの一つである。</p>
<p>これらは、下記で確かめられる通り、後述する<a
href="#SS_3_3_1_2">std::integral_constant</a>を使い定義されている。</p>
<div class="sourceCode" id="cb238"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/type_traits_ut.cpp 13</span></span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-3"><a href="#cb238-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// std::is_same_vの2パラメータが同一であれば、std::is_same_v&lt;&gt; == true</span></span>
<span id="cb238-4"><a href="#cb238-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="bu">std::</span>integral_constant<span class="op">&lt;</span><span class="dt">bool</span><span class="op">,</span> <span class="kw">true</span><span class="op">&gt;,</span> <span class="bu">std::</span>true_type<span class="op">&gt;);</span></span>
<span id="cb238-5"><a href="#cb238-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="bu">std::</span>integral_constant<span class="op">&lt;</span><span class="dt">bool</span><span class="op">,</span> <span class="kw">false</span><span class="op">&gt;,</span> <span class="bu">std::</span>false_type<span class="op">&gt;);</span></span></code></pre></div>
<p>それぞれの型が持つvalue定数は、下記のように定義されている。</p>
<div class="sourceCode" id="cb239"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/type_traits_ut.cpp 20</span></span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-3"><a href="#cb239-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>true_type<span class="bu">::</span>value<span class="op">,</span> <span class="st">&quot;must be true&quot;</span><span class="op">);</span></span>
<span id="cb239-4"><a href="#cb239-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span><span class="bu">std::</span>false_type<span class="bu">::</span>value<span class="op">,</span> <span class="st">&quot;must be false&quot;</span><span class="op">);</span></span></code></pre></div>
<p>これらが何の役に立つのか直ちに理解することは難しいが、
true/falseのメタ関数版と考えれば、追々理解できるだろう。</p>
<p>以下に簡単な使用例を示す。</p>
<div class="sourceCode" id="cb240"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/type_traits_ut.cpp 29</span></span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb240-3"><a href="#cb240-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 引数の型がintに変換できるかどうかを判定する関数</span></span>
<span id="cb240-4"><a href="#cb240-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// decltypeの中でのみ使用されるため、定義は不要</span></span>
<span id="cb240-5"><a href="#cb240-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="bu">std::</span>true_type<span class="op"> </span> IsCovertibleToInt<span class="op">(</span><span class="dt">int</span><span class="op">);</span>  <span class="co">// intに変換できる型はこちら</span></span>
<span id="cb240-6"><a href="#cb240-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="bu">std::</span>false_type<span class="op"> </span>IsCovertibleToInt<span class="op">(...);</span>  <span class="co">// それ以外はこちら</span></span></code></pre></div>
<p>上記の単体テストは下記のようになる。</p>
<div class="sourceCode" id="cb241"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/type_traits_ut.cpp 40</span></span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb241-3"><a href="#cb241-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="kw">decltype</span><span class="op">(</span>IsCovertibleToInt<span class="op">(</span><span class="dv">1</span><span class="op">))::</span>value<span class="op">);</span></span>
<span id="cb241-4"><a href="#cb241-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="kw">decltype</span><span class="op">(</span>IsCovertibleToInt<span class="op">(</span><span class="dv">1</span><span class="bu">u</span><span class="op">))::</span>value<span class="op">);</span></span>
<span id="cb241-5"><a href="#cb241-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span><span class="kw">decltype</span><span class="op">(</span>IsCovertibleToInt<span class="op">(</span><span class="st">&quot;&quot;</span><span class="op">))::</span>value<span class="op">);</span>  <span class="co">// ポインタはintに変換不可</span></span>
<span id="cb241-6"><a href="#cb241-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb241-7"><a href="#cb241-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> ConvertibleToInt <span class="op">{</span></span>
<span id="cb241-8"><a href="#cb241-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">operator</span> <span class="dt">int</span><span class="op">();</span></span>
<span id="cb241-9"><a href="#cb241-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb241-10"><a href="#cb241-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb241-11"><a href="#cb241-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> NotConvertibleToInt <span class="op">{};</span></span>
<span id="cb241-12"><a href="#cb241-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb241-13"><a href="#cb241-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="kw">decltype</span><span class="op">(</span>IsCovertibleToInt<span class="op">(</span>ConvertibleToInt<span class="op">{}))::</span>value<span class="op">);</span></span>
<span id="cb241-14"><a href="#cb241-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span><span class="kw">decltype</span><span class="op">(</span>IsCovertibleToInt<span class="op">(</span>NotConvertibleToInt<span class="op">{}))::</span>value<span class="op">);</span></span>
<span id="cb241-15"><a href="#cb241-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb241-16"><a href="#cb241-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">// なお、IsCovertibleToInt()やConvertibleToInt::operator int()は実際に呼び出されるわけでは</span></span>
<span id="cb241-17"><a href="#cb241-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ないため、定義は必要なく宣言のみがあれば良い。</span></span></code></pre></div>
<p>IsCovertibleToIntの呼び出しをdecltypeのオペランドにすることで、
std::true_typeかstd::false_typeを受け取ることができる。</p>
<h4 id="stdintegral_constant">std::integral_constant
<a id="SS_3_3_1_2"></a></h4>
<p>std::integral_constantは
「テンプレートパラメータとして与えられた型とその定数から新たな型を定義する」
クラステンプレートである。</p>
<p>以下に簡単な使用例を示す。</p>
<div class="sourceCode" id="cb242"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/type_traits_ut.cpp 62</span></span>
<span id="cb242-2"><a href="#cb242-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-3"><a href="#cb242-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> int3 <span class="op">=</span> <span class="bu">std::</span>integral_constant<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dv">3</span><span class="op">&gt;;</span></span>
<span id="cb242-4"><a href="#cb242-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-5"><a href="#cb242-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// std::is_same_vの2パラメータが同一であれば、std::is_same_v&lt;&gt; == true</span></span>
<span id="cb242-6"><a href="#cb242-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> int3<span class="op">::</span><span class="dt">value_type</span><span class="op">&gt;);</span></span>
<span id="cb242-7"><a href="#cb242-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="bu">std::</span>integral_constant<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dv">3</span><span class="op">&gt;,</span> int3<span class="op">::</span>type<span class="op">&gt;);</span></span>
<span id="cb242-8"><a href="#cb242-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>int3<span class="op">::</span>value <span class="op">==</span> <span class="dv">3</span><span class="op">);</span></span>
<span id="cb242-9"><a href="#cb242-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-10"><a href="#cb242-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> bool_true <span class="op">=</span> <span class="bu">std::</span>integral_constant<span class="op">&lt;</span><span class="dt">bool</span><span class="op">,</span> <span class="kw">true</span><span class="op">&gt;;</span></span>
<span id="cb242-11"><a href="#cb242-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-12"><a href="#cb242-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="dt">bool</span><span class="op">,</span> bool_true<span class="op">::</span><span class="dt">value_type</span><span class="op">&gt;);</span></span>
<span id="cb242-13"><a href="#cb242-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="bu">std::</span>integral_constant<span class="op">&lt;</span><span class="dt">bool</span><span class="op">,</span> <span class="kw">true</span><span class="op">&gt;,</span> bool_true<span class="op">::</span>type<span class="op">&gt;);</span></span>
<span id="cb242-14"><a href="#cb242-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>bool_true<span class="op">::</span>value <span class="op">==</span> <span class="kw">true</span><span class="op">);</span></span></code></pre></div>
<p>また、すでに示したようにstd::true_type/std::false_typeを実装するためのクラステンプレートでもある。</p>
<h4 id="stdis_same">std::is_same <a id="SS_3_3_1_3"></a></h4>
<p>すでに上記の例でも使用したが、std::is_sameは2つのテンプレートパラメータが</p>
<ul>
<li>同じ型である場合、std::true_type</li>
<li>違う型である場合、std::false_type</li>
</ul>
<p>から派生した型となる。</p>
<p>以下に簡単な使用例を示す。</p>
<div class="sourceCode" id="cb243"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/type_traits_ut.cpp 99</span></span>
<span id="cb243-2"><a href="#cb243-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-3"><a href="#cb243-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span><span class="op">&gt;::</span>value<span class="op">);</span></span>
<span id="cb243-4"><a href="#cb243-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int32_t</span><span class="op">&gt;::</span>value<span class="op">);</span>   <span class="co">// 64ビットg++/clang++</span></span>
<span id="cb243-5"><a href="#cb243-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span><span class="bu">std::</span>is_same<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int64_t</span><span class="op">&gt;::</span>value<span class="op">);</span>  <span class="co">// 64ビットg++/clang++</span></span>
<span id="cb243-6"><a href="#cb243-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">,</span> <span class="bu">std::</span>basic_string<span class="op">&lt;</span><span class="dt">char</span><span class="op">&gt;&gt;::</span>value<span class="op">);</span></span>
<span id="cb243-7"><a href="#cb243-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same<span class="op">&lt;</span><span class="kw">typename</span> <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;::</span>reference<span class="op">,</span> <span class="dt">int</span><span class="op">&amp;&gt;::</span>value<span class="op">);</span></span></code></pre></div>
<p>また、 C++17で導入されたstd::is_same_vは、定数テンプレートを使用し、
下記のように定義されている。</p>
<div class="sourceCode" id="cb244"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/type_traits_ut.cpp 90</span></span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb244-3"><a href="#cb244-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">,</span> <span class="kw">typename</span> U<span class="op">&gt;</span></span>
<span id="cb244-4"><a href="#cb244-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> is_same_v<span class="op">{</span><span class="bu">std::</span>is_same<span class="op">&lt;</span>T<span class="op">,</span> U<span class="op">&gt;::</span>value<span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb245"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/type_traits_ut.cpp 108</span></span>
<span id="cb245-2"><a href="#cb245-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-3"><a href="#cb245-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>is_same_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span><span class="op">&gt;);</span></span>
<span id="cb245-4"><a href="#cb245-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>is_same_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int32_t</span><span class="op">&gt;);</span>   <span class="co">// 64ビットg++/clang++</span></span>
<span id="cb245-5"><a href="#cb245-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>is_same_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int64_t</span><span class="op">&gt;);</span>  <span class="co">// 64ビットg++/clang++</span></span>
<span id="cb245-6"><a href="#cb245-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>is_same_v<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">,</span> <span class="bu">std::</span>basic_string<span class="op">&lt;</span><span class="dt">char</span><span class="op">&gt;&gt;);</span></span>
<span id="cb245-7"><a href="#cb245-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>is_same_v<span class="op">&lt;</span><span class="kw">typename</span> <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;::</span>reference<span class="op">,</span> <span class="dt">int</span><span class="op">&amp;&gt;);</span></span></code></pre></div>
<p>このような簡潔な記述の一般形式は、</p>
<pre><code>   T::value  -&gt; T_v
   T::type   -&gt; T_t</code></pre>
<p>のように定義されている(このドキュメントのほとんど場所では、簡潔な形式を用いる)。</p>
<p>第1テンプレートパラメータが第2テンプレートパラメータの基底クラスかどうかを判断する
std::is_base_ofを使うことで下記のようにstd::is_sameの基底クラス確認することもできる。</p>
<div class="sourceCode" id="cb247"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/type_traits_ut.cpp 117</span></span>
<span id="cb247-2"><a href="#cb247-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-3"><a href="#cb247-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_base_of_v<span class="op">&lt;</span><span class="bu">std::</span>true_type<span class="op">,</span> <span class="bu">std::</span>is_same<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span><span class="op">&gt;&gt;);</span></span>
<span id="cb247-4"><a href="#cb247-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_base_of_v<span class="op">&lt;</span><span class="bu">std::</span>false_type<span class="op">,</span> <span class="bu">std::</span>is_same<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">char</span><span class="op">&gt;&gt;);</span></span></code></pre></div>
<h4 id="stdenable_if">std::enable_if <a id="SS_3_3_1_4"></a></h4>
<p>std::enable_ifは、bool値である第1テンプレートパラメータが</p>
<ul>
<li>trueである場合、型である第2テンプレートパラメータをメンバ型typeとして宣言する。</li>
<li>falseである場合、メンバ型typeを持たない。</li>
</ul>
<p>下記のコードはクラステンプレートの特殊化を用いたstd::enable_ifの実装例である。</p>
<div class="sourceCode" id="cb248"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/type_traits_ut.cpp 124</span></span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-3"><a href="#cb248-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="dt">bool</span> T_F<span class="op">,</span> <span class="kw">typename</span> T <span class="op">=</span> <span class="dt">void</span><span class="op">&gt;</span></span>
<span id="cb248-4"><a href="#cb248-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> enable_if<span class="op">;</span></span>
<span id="cb248-5"><a href="#cb248-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-6"><a href="#cb248-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb248-7"><a href="#cb248-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> enable_if<span class="op">&lt;</span><span class="kw">true</span><span class="op">,</span> T<span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb248-8"><a href="#cb248-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> type <span class="op">=</span> T<span class="op">;</span></span>
<span id="cb248-9"><a href="#cb248-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb248-10"><a href="#cb248-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-11"><a href="#cb248-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb248-12"><a href="#cb248-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> enable_if<span class="op">&lt;</span><span class="kw">false</span><span class="op">,</span> T<span class="op">&gt;</span> <span class="op">{</span>  <span class="co">// メンバエイリアスtypeを持たない</span></span>
<span id="cb248-13"><a href="#cb248-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb248-14"><a href="#cb248-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-15"><a href="#cb248-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="dt">bool</span> COND<span class="op">,</span> <span class="kw">typename</span> T <span class="op">=</span> <span class="dt">void</span><span class="op">&gt;</span></span>
<span id="cb248-16"><a href="#cb248-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> <span class="dt">enable_if_t</span> <span class="op">=</span> <span class="kw">typename</span> enable_if<span class="op">&lt;</span>COND<span class="op">,</span> T<span class="op">&gt;::</span>type<span class="op">;</span></span></code></pre></div>
<p>std::enable_ifの使用例を下記に示す。</p>
<div class="sourceCode" id="cb249"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/type_traits_ut.cpp 148</span></span>
<span id="cb249-2"><a href="#cb249-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-3"><a href="#cb249-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="dt">void</span><span class="op">,</span> <span class="bu">std::</span>enable_if_t<span class="op">&lt;</span><span class="kw">true</span><span class="op">&gt;&gt;);</span></span>
<span id="cb249-4"><a href="#cb249-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="bu">std::</span>enable_if_t<span class="op">&lt;</span><span class="kw">true</span><span class="op">,</span> <span class="dt">int</span><span class="op">&gt;&gt;);</span></span></code></pre></div>
<p>実装例から明らかなように</p>
<ul>
<li>std::enable_if&lt;true&gt;::typeは<a
href="#SS_5_10_9">well-formed</a></li>
<li>std::enable_if&lt;false&gt;::typeは<a
href="#SS_5_10_8">ill-formed</a></li>
</ul>
<p>となるため、下記のコードはコンパイルできない。</p>
<div class="sourceCode" id="cb250"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/type_traits_ut.cpp 155</span></span>
<span id="cb250-2"><a href="#cb250-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-3"><a href="#cb250-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 下記はill-formedとなるため、コンパイルできない。</span></span>
<span id="cb250-4"><a href="#cb250-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="dt">void</span><span class="op">,</span> <span class="bu">std::</span>enable_if_t<span class="op">&lt;</span><span class="kw">false</span><span class="op">&gt;&gt;);</span></span>
<span id="cb250-5"><a href="#cb250-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="bu">std::</span>enable_if_t<span class="op">&lt;</span><span class="kw">false</span><span class="op">,</span> <span class="dt">int</span><span class="op">&gt;&gt;);</span></span></code></pre></div>
<p>std::enable_ifのこの特性と後述する<a
href="#SS_5_4_7">SFINAE</a>により、
様々な静的ディスパッチを行うことができる。</p>
<h4 id="stdconditional">std::conditional <a id="SS_3_3_1_5"></a></h4>
<p>std::conditionalは、bool値である第1テンプレートパラメータが</p>
<ul>
<li>trueである場合、第2テンプレートパラメータ</li>
<li>falseである場合、第3テンプレートパラメータ</li>
</ul>
<p>をメンバ型typeとして宣言する。</p>
<p>下記のコードはクラステンプレートの特殊化を用いたstd::conditionalの実装例である。</p>
<div class="sourceCode" id="cb251"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/type_traits_ut.cpp 164</span></span>
<span id="cb251-2"><a href="#cb251-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-3"><a href="#cb251-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="dt">bool</span> T_F<span class="op">,</span> <span class="kw">typename</span><span class="op">,</span> <span class="kw">typename</span><span class="op">&gt;</span></span>
<span id="cb251-4"><a href="#cb251-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> conditional<span class="op">;</span></span>
<span id="cb251-5"><a href="#cb251-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-6"><a href="#cb251-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">,</span> <span class="kw">typename</span> U<span class="op">&gt;</span></span>
<span id="cb251-7"><a href="#cb251-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> conditional<span class="op">&lt;</span><span class="kw">true</span><span class="op">,</span> T<span class="op">,</span> U<span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb251-8"><a href="#cb251-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> type <span class="op">=</span> T<span class="op">;</span></span>
<span id="cb251-9"><a href="#cb251-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb251-10"><a href="#cb251-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-11"><a href="#cb251-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">,</span> <span class="kw">typename</span> U<span class="op">&gt;</span></span>
<span id="cb251-12"><a href="#cb251-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> conditional<span class="op">&lt;</span><span class="kw">false</span><span class="op">,</span> T<span class="op">,</span> U<span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb251-13"><a href="#cb251-13" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> type <span class="op">=</span> U<span class="op">;</span></span>
<span id="cb251-14"><a href="#cb251-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb251-15"><a href="#cb251-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-16"><a href="#cb251-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="dt">bool</span> COND<span class="op">,</span> <span class="kw">typename</span> T<span class="op">,</span> <span class="kw">typename</span> U<span class="op">&gt;</span></span>
<span id="cb251-17"><a href="#cb251-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> <span class="dt">conditional_t</span> <span class="op">=</span> <span class="kw">typename</span> conditional<span class="op">&lt;</span>COND<span class="op">,</span> T<span class="op">,</span> U<span class="op">&gt;::</span>type<span class="op">;</span></span></code></pre></div>
<p>std::conditionalの使用例を下記に示す。</p>
<div class="sourceCode" id="cb252"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/type_traits_ut.cpp 189</span></span>
<span id="cb252-2"><a href="#cb252-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb252-3"><a href="#cb252-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="bu">std::</span>conditional_t<span class="op">&lt;</span><span class="kw">true</span><span class="op">,</span> <span class="dt">int</span><span class="op">,</span> <span class="dt">char</span><span class="op">&gt;&gt;);</span></span>
<span id="cb252-4"><a href="#cb252-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="dt">char</span><span class="op">,</span> <span class="bu">std::</span>conditional_t<span class="op">&lt;</span><span class="kw">false</span><span class="op">,</span> <span class="dt">int</span><span class="op">,</span> <span class="dt">char</span><span class="op">&gt;&gt;);</span></span></code></pre></div>
<h4 id="stdis_void">std::is_void <a id="SS_3_3_1_6"></a></h4>
<p>std::is_voidはテンプレートパラメータの型が</p>
<ul>
<li>voidである場合、std::true_type</li>
<li>voidでない場合、std::false_type</li>
</ul>
<p>から派生した型となる。</p>
<p>以下に簡単な使用例を示す。</p>
<div class="sourceCode" id="cb253"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/type_traits_ut.cpp 82</span></span>
<span id="cb253-2"><a href="#cb253-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb253-3"><a href="#cb253-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_void<span class="op">&lt;</span><span class="dt">void</span><span class="op">&gt;::</span>value<span class="op">);</span></span>
<span id="cb253-4"><a href="#cb253-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span><span class="bu">std::</span>is_void<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;::</span>value<span class="op">);</span></span>
<span id="cb253-5"><a href="#cb253-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span><span class="bu">std::</span>is_void<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;::</span>value<span class="op">);</span></span></code></pre></div>
<h3 id="is_void_xxxの実装">is_void_xxxの実装 <a id="SS_3_3_2"></a></h3>
<p>ここではstd::is_voidに似た以下のような仕様を持ついくつかのテンプレートis_void_xxxの実装を考える。</p>
<table>
<thead>
<tr class="header">
<th>テンプレートパラメータ</th>
<th>戻り値</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>void</td>
<td>true</td>
</tr>
<tr class="even">
<td>非void</td>
<td>false</td>
</tr>
</tbody>
</table>
<p>それぞれのis_void_xxxは下記テーブルで示した言語機能を使用して実装する。</p>
<table>
<colgroup>
<col style="width: 23%" />
<col style="width: 76%" />
</colgroup>
<thead>
<tr class="header">
<th>is_void_xxx</th>
<th>実装方法</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>is_void_f</td>
<td>関数テンプレートの特殊化</td>
</tr>
<tr class="even">
<td>is_void_s</td>
<td>クラステンプレートの特殊化</td>
</tr>
<tr class="odd">
<td>is_void_sfinae_f</td>
<td>SFINAEと関数テンプレートのオーバーロード</td>
</tr>
<tr class="even">
<td>is_void_sfinae_s</td>
<td>SFINAEとクラステンプレートの特殊化</td>
</tr>
<tr class="odd">
<td>is_void_ena_s</td>
<td>std::enable_ifによるSFINAEとクラステンプレートの特殊化</td>
</tr>
<tr class="even">
<td>is_void_cond_s</td>
<td>std::conditionalと関数テンプレートの特殊化</td>
</tr>
</tbody>
</table>
<p>なお、実装例をシンプルに保つため、
理解の妨げとなり得る下記のような正確性(例外条件の対応)等のためのコードを最低限に留めた。</p>
<ul>
<li>テンプレートパラメータの型のチェック</li>
<li>テンプレートパラメータの型からのポインタ/リファレンス/const/volatileの削除</li>
<li>戻り型からのconst/volatileの削除</li>
</ul>
<p>これは、「テンプレートプログラミングでの有用なテクニックの解説」
というここでの目的を見失わないための措置である。</p>
<h4 id="is_void_fの実装">is_void_fの実装 <a id="SS_3_3_2_1"></a></h4>
<p>関数テンプレートの特殊化を使用したis_void_fの実装は以下のようになる。</p>
<div class="sourceCode" id="cb254"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/is_void_ut.cpp 7</span></span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-3"><a href="#cb254-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb254-4"><a href="#cb254-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> is_void_f<span class="op">()</span> <span class="kw">noexcept</span></span>
<span id="cb254-5"><a href="#cb254-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb254-6"><a href="#cb254-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb254-7"><a href="#cb254-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb254-8"><a href="#cb254-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-9"><a href="#cb254-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;&gt;</span></span>
<span id="cb254-10"><a href="#cb254-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> is_void_f<span class="op">&lt;</span><span class="dt">void</span><span class="op">&gt;()</span> <span class="kw">noexcept</span></span>
<span id="cb254-11"><a href="#cb254-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb254-12"><a href="#cb254-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb254-13"><a href="#cb254-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb254-14"><a href="#cb254-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-15"><a href="#cb254-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb254-16"><a href="#cb254-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> is_void_f_v<span class="op">{</span>is_void_f<span class="op">&lt;</span>T<span class="op">&gt;()};</span></span></code></pre></div>
<p>単純なので解説は不要だろう。これらの単体テストは下記のようになる。</p>
<div class="sourceCode" id="cb255"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/is_void_ut.cpp 27</span></span>
<span id="cb255-2"><a href="#cb255-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-3"><a href="#cb255-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>is_void_f_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;);</span></span>
<span id="cb255-4"><a href="#cb255-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>is_void_f_v<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;);</span></span>
<span id="cb255-5"><a href="#cb255-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>is_void_f_v<span class="op">&lt;</span><span class="dt">void</span><span class="op">&gt;);</span></span></code></pre></div>
<p>関数テンプレートの特殊化には、</p>
<ul>
<li>特殊化された関数テンプレートとそのプライマリテンプレートのシグネチャ、
戻り値は一致しなければならない</li>
<li>クラステンプレートのような部分特殊化は許可されない</li>
</ul>
<p>のような制限があるため用途は限られるが、関数テンプレートはオーバーロードすることが可能である。</p>
<h4 id="is_void_sの実装">is_void_sの実装 <a id="SS_3_3_2_2"></a></h4>
<p>クラステンプレートの特殊化を使用したis_void_sの実装は以下のようになる。</p>
<div class="sourceCode" id="cb256"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/is_void_ut.cpp 35</span></span>
<span id="cb256-2"><a href="#cb256-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-3"><a href="#cb256-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb256-4"><a href="#cb256-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> is_void_s <span class="op">{</span></span>
<span id="cb256-5"><a href="#cb256-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="kw">constexpr</span> <span class="dt">bool</span> value<span class="op">{</span><span class="kw">false</span><span class="op">};</span></span>
<span id="cb256-6"><a href="#cb256-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb256-7"><a href="#cb256-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-8"><a href="#cb256-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;&gt;</span></span>
<span id="cb256-9"><a href="#cb256-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> is_void_s<span class="op">&lt;</span><span class="dt">void</span><span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb256-10"><a href="#cb256-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="kw">constexpr</span> <span class="dt">bool</span> value<span class="op">{</span><span class="kw">true</span><span class="op">};</span></span>
<span id="cb256-11"><a href="#cb256-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb256-12"><a href="#cb256-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-13"><a href="#cb256-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb256-14"><a href="#cb256-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> is_void_s_v<span class="op">{</span>is_void_s<span class="op">&lt;</span>T<span class="op">&gt;::</span>value<span class="op">};</span></span></code></pre></div>
<p>is_void_fと同様に単純なので解説は不要だろう。これらの単体テストは下記のようになる。</p>
<div class="sourceCode" id="cb257"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/is_void_ut.cpp 53</span></span>
<span id="cb257-2"><a href="#cb257-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb257-3"><a href="#cb257-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>is_void_s_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;);</span></span>
<span id="cb257-4"><a href="#cb257-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>is_void_s_v<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;);</span></span>
<span id="cb257-5"><a href="#cb257-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>is_void_s_v<span class="op">&lt;</span><span class="dt">void</span><span class="op">&gt;);</span></span></code></pre></div>
<h4 id="is_void_sfinae_fの実装">is_void_sfinae_fの実装
<a id="SS_3_3_2_3"></a></h4>
<p><a
href="#SS_5_4_7">SFINAE</a>を使用した関数テンプレートis_void_sfinae_fの実装は以下のようになる。</p>
<div class="sourceCode" id="cb258"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/is_void_ut.cpp 61</span></span>
<span id="cb258-2"><a href="#cb258-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb258-3"><a href="#cb258-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> Inner_ <span class="op">{</span></span>
<span id="cb258-4"><a href="#cb258-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb258-5"><a href="#cb258-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// T == void</span></span>
<span id="cb258-6"><a href="#cb258-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb258-7"><a href="#cb258-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="kw">auto</span> is_void_sfinae_f_detector<span class="op">(</span><span class="dt">void</span> <span class="at">const</span><span class="op">*</span> v<span class="op">,</span> T <span class="at">const</span><span class="op">*</span> t<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb258-8"><a href="#cb258-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">-&gt;</span> <span class="kw">decltype</span><span class="op">(</span>t <span class="op">=</span> v<span class="op">,</span> <span class="dt">bool</span><span class="op">{})</span>  <span class="co">// T != voidの場合、t = vはill-formed</span></span>
<span id="cb258-9"><a href="#cb258-9" aria-hidden="true" tabindex="-1"></a>                                    <span class="co">// T == voidの場合、well-formedでbool型生成</span></span>
<span id="cb258-10"><a href="#cb258-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb258-11"><a href="#cb258-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb258-12"><a href="#cb258-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb258-13"><a href="#cb258-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb258-14"><a href="#cb258-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">// T != void</span></span>
<span id="cb258-15"><a href="#cb258-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb258-16"><a href="#cb258-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="kw">auto</span> is_void_sfinae_f_detector<span class="op">(</span><span class="dt">void</span> <span class="at">const</span><span class="op">*,</span> T <span class="at">const</span><span class="op">*)</span> <span class="kw">noexcept</span></span>
<span id="cb258-17"><a href="#cb258-17" aria-hidden="true" tabindex="-1"></a>        <span class="op">-&gt;</span> <span class="kw">decltype</span><span class="op">(</span><span class="kw">sizeof</span><span class="op">(</span>T<span class="op">),</span> <span class="dt">bool</span><span class="op">{})</span>  <span class="co">// T != voidの場合、well-formedでbool型生成</span></span>
<span id="cb258-18"><a href="#cb258-18" aria-hidden="true" tabindex="-1"></a>                                        <span class="co">// T == voidの場合、sizeof(T)はill-formed</span></span>
<span id="cb258-19"><a href="#cb258-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb258-20"><a href="#cb258-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb258-21"><a href="#cb258-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb258-22"><a href="#cb258-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace Inner_</span></span>
<span id="cb258-23"><a href="#cb258-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb258-24"><a href="#cb258-24" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb258-25"><a href="#cb258-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> is_void_sfinae_f<span class="op">()</span> <span class="kw">noexcept</span></span>
<span id="cb258-26"><a href="#cb258-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb258-27"><a href="#cb258-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> Inner_<span class="op">::</span>is_void_sfinae_f_detector<span class="op">(</span><span class="kw">nullptr</span><span class="op">,</span> <span class="kw">static_cast</span><span class="op">&lt;</span>T<span class="op">*&gt;(</span><span class="kw">nullptr</span><span class="op">));</span></span>
<span id="cb258-28"><a href="#cb258-28" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb258-29"><a href="#cb258-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb258-30"><a href="#cb258-30" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb258-31"><a href="#cb258-31" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> is_void_sfinae_f_v<span class="op">{</span>is_void_sfinae_f<span class="op">&lt;</span>T<span class="op">&gt;()};</span></span></code></pre></div>
<p>関数テンプレートである2つのis_void_sfinae_f_detectorのオーバーロードにSFINAEを使用している。</p>
<p>1つ目のis_void_sfinae_f_detectorでは、</p>
<table>
<thead>
<tr class="header">
<th>T</th>
<th>t = v の診断(コンパイル)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>== void</td>
<td>well-formed</td>
</tr>
<tr class="even">
<td>!= void</td>
<td>ill-formed</td>
</tr>
</tbody>
</table>
<p>であるため、Tがvoidの時のみ<a href="#SS_5_4_2">name
lookup</a>の対象になる。</p>
<p>2つ目のis_void_sfinae_f_detectorでは、</p>
<table>
<thead>
<tr class="header">
<th>T</th>
<th>sizeof(T)の診断(コンパイル)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>== void</td>
<td>ill-formed</td>
</tr>
<tr class="even">
<td>!= void</td>
<td>well-formed</td>
</tr>
</tbody>
</table>
<p>であるため、Tが非voidの時のみ<a href="#SS_5_4_2">name
lookup</a>の対象になる。</p>
<p>is_void_sfinae_fはこの性質を利用し、</p>
<ul>
<li>T ==
voidの場合、1つ目のis_void_sfinae_f_detectorが選択され、戻り値はtrue</li>
<li>T !=
voidの場合、2つ目のis_void_sfinae_f_detectorが選択され、戻り値はfalse</li>
</ul>
<p>となる。念のため単体テストを示すと下記のようになる。</p>
<div class="sourceCode" id="cb259"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/is_void_ut.cpp 96</span></span>
<span id="cb259-2"><a href="#cb259-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb259-3"><a href="#cb259-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>is_void_sfinae_f_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;);</span></span>
<span id="cb259-4"><a href="#cb259-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>is_void_sfinae_f_v<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;);</span></span>
<span id="cb259-5"><a href="#cb259-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>is_void_sfinae_f_v<span class="op">&lt;</span><span class="dt">void</span><span class="op">&gt;);</span></span></code></pre></div>
<p>一般にファイル外部に公開するテンプレートは、
コンパイルの都合上ヘッダファイルにその全実装を記述することになる。
これは、本来外部公開すべきでない実装の詳細である
is_void_sfinae_f_detectorのようなテンプレートに関しては大変都合が悪い。
というのは、外部から使用されたくない実装の詳細が使われてしまうことがあり得るからである。
上記の例では、こういうことに備え
「これは外部非公開である」ということを示す名前空間Inner_
を導入した。</p>
<p>関数テンプレートはクラステンプレート内にも定義することができるため、
is_void_sfinae_fは下記のように実装することも可能である。この場合、名前空間Inner_は不要になる。</p>
<div class="sourceCode" id="cb260"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/is_void_ut.cpp 105</span></span>
<span id="cb260-2"><a href="#cb260-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-3"><a href="#cb260-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb260-4"><a href="#cb260-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> is_void_sfinae_f <span class="op">{</span></span>
<span id="cb260-5"><a href="#cb260-5" aria-hidden="true" tabindex="-1"></a>        <span class="co">// U == void</span></span>
<span id="cb260-6"><a href="#cb260-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> U<span class="op">&gt;</span></span>
<span id="cb260-7"><a href="#cb260-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="kw">constexpr</span> <span class="kw">auto</span> detector<span class="op">(</span><span class="dt">void</span> <span class="at">const</span><span class="op">*</span> v<span class="op">,</span> U <span class="at">const</span><span class="op">*</span> u<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb260-8"><a href="#cb260-8" aria-hidden="true" tabindex="-1"></a>            <span class="op">-&gt;</span> <span class="kw">decltype</span><span class="op">(</span>u <span class="op">=</span> v<span class="op">,</span> <span class="dt">bool</span><span class="op">{})</span>  <span class="co">// U != voidの場合、t = vはill-formed</span></span>
<span id="cb260-9"><a href="#cb260-9" aria-hidden="true" tabindex="-1"></a>                                        <span class="co">// U == voidの場合、well-formedでbool型生成</span></span>
<span id="cb260-10"><a href="#cb260-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb260-11"><a href="#cb260-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb260-12"><a href="#cb260-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb260-13"><a href="#cb260-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-14"><a href="#cb260-14" aria-hidden="true" tabindex="-1"></a>        <span class="co">// U != void</span></span>
<span id="cb260-15"><a href="#cb260-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> U<span class="op">&gt;</span></span>
<span id="cb260-16"><a href="#cb260-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="kw">constexpr</span> <span class="kw">auto</span> detector<span class="op">(</span><span class="dt">void</span> <span class="at">const</span><span class="op">*,</span> U <span class="at">const</span><span class="op">*)</span> <span class="kw">noexcept</span></span>
<span id="cb260-17"><a href="#cb260-17" aria-hidden="true" tabindex="-1"></a>            <span class="op">-&gt;</span> <span class="kw">decltype</span><span class="op">(</span><span class="kw">sizeof</span><span class="op">(</span>U<span class="op">),</span> <span class="dt">bool</span><span class="op">{})</span>  <span class="co">// U != voidの場合、well-formedでbool型生成</span></span>
<span id="cb260-18"><a href="#cb260-18" aria-hidden="true" tabindex="-1"></a>                                            <span class="co">// U == voidの場合、ill-formed</span></span>
<span id="cb260-19"><a href="#cb260-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb260-20"><a href="#cb260-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb260-21"><a href="#cb260-21" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb260-22"><a href="#cb260-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-23"><a href="#cb260-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb260-24"><a href="#cb260-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="kw">constexpr</span> <span class="dt">bool</span> value<span class="op">{</span>is_void_sfinae_f<span class="op">::</span>detector<span class="op">(</span><span class="kw">nullptr</span><span class="op">,</span> <span class="kw">static_cast</span><span class="op">&lt;</span>T<span class="op">*&gt;(</span><span class="kw">nullptr</span><span class="op">))};</span></span>
<span id="cb260-25"><a href="#cb260-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb260-26"><a href="#cb260-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-27"><a href="#cb260-27" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb260-28"><a href="#cb260-28" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> is_void_sfinae_f_v<span class="op">{</span>is_void_sfinae_f<span class="op">&lt;</span>T<span class="op">&gt;::</span>value<span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb261"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/is_void_ut.cpp 137</span></span>
<span id="cb261-2"><a href="#cb261-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-3"><a href="#cb261-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>is_void_sfinae_f_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;);</span></span>
<span id="cb261-4"><a href="#cb261-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>is_void_sfinae_f_v<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;);</span></span>
<span id="cb261-5"><a href="#cb261-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>is_void_sfinae_f_v<span class="op">&lt;</span><span class="dt">void</span><span class="op">&gt;);</span></span></code></pre></div>
<h4 id="is_void_sfinae_sの実装">is_void_sfinae_sの実装
<a id="SS_3_3_2_4"></a></h4>
<p><a
href="#SS_5_4_7">SFINAE</a>を使用したクラステンプレートis_void_sfinae_sの実装は以下のようになる。</p>
<div class="sourceCode" id="cb262"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/is_void_ut.cpp 146</span></span>
<span id="cb262-2"><a href="#cb262-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-3"><a href="#cb262-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> Inner_ <span class="op">{</span></span>
<span id="cb262-4"><a href="#cb262-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb262-5"><a href="#cb262-5" aria-hidden="true" tabindex="-1"></a>    T<span class="op">*&amp;</span> t2ptr<span class="op">();</span>  <span class="co">// 定義は不要</span></span>
<span id="cb262-6"><a href="#cb262-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace Inner_</span></span>
<span id="cb262-7"><a href="#cb262-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-8"><a href="#cb262-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">,</span> <span class="kw">typename</span> <span class="op">=</span> <span class="dt">void</span><span class="op">*&amp;&gt;</span></span>
<span id="cb262-9"><a href="#cb262-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> is_void_sfinae_s <span class="op">:</span> <span class="bu">std::</span>false_type<span class="op"> {</span></span>
<span id="cb262-10"><a href="#cb262-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb262-11"><a href="#cb262-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-12"><a href="#cb262-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb262-13"><a href="#cb262-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> is_void_sfinae_s<span class="op">&lt;</span></span>
<span id="cb262-14"><a href="#cb262-14" aria-hidden="true" tabindex="-1"></a>        T<span class="op">,</span></span>
<span id="cb262-15"><a href="#cb262-15" aria-hidden="true" tabindex="-1"></a>        <span class="co">// T != voidの場合、ill-formed</span></span>
<span id="cb262-16"><a href="#cb262-16" aria-hidden="true" tabindex="-1"></a>        <span class="co">// T == voidの場合、well-formedでvoid*&amp;生成</span></span>
<span id="cb262-17"><a href="#cb262-17" aria-hidden="true" tabindex="-1"></a>        <span class="kw">decltype</span><span class="op">(</span>Inner_<span class="op">::</span>t2ptr<span class="op">&lt;</span>T<span class="op">&gt;()</span> <span class="op">=</span> Inner_<span class="op">::</span>t2ptr<span class="op">&lt;</span><span class="dt">void</span><span class="op">&gt;())</span></span>
<span id="cb262-18"><a href="#cb262-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-19"><a href="#cb262-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">&gt;</span> <span class="op">:</span> <span class="bu">std::</span>true_type<span class="op"> {</span></span>
<span id="cb262-20"><a href="#cb262-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb262-21"><a href="#cb262-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-22"><a href="#cb262-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb262-23"><a href="#cb262-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> is_void_sfinae_s_v<span class="op">{</span>is_void_sfinae_s<span class="op">&lt;</span>T<span class="op">&gt;::</span>value<span class="op">};</span></span></code></pre></div>
<p>1つ目のis_void_sfinae_sはプライマリテンプレートである。
is_void_sfinae_sの特殊化が<a href="#SS_5_4_2">name
lookup</a>の対象の中に見つからなかった場合、 これが使われる。</p>
<p>2つ目のis_void_sfinae_sは、上記を抜粋した下記のコード</p>
<div class="sourceCode" id="cb263"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/is_void_ut.cpp 162</span></span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb263-3"><a href="#cb263-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// T != voidの場合、ill-formed</span></span>
<span id="cb263-4"><a href="#cb263-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// T == voidの場合、well-formedでvoid*&amp;生成</span></span>
<span id="cb263-5"><a href="#cb263-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">decltype</span><span class="op">(</span>Inner_<span class="op">::</span>t2ptr<span class="op">&lt;</span>T<span class="op">&gt;()</span> <span class="op">=</span> Inner_<span class="op">::</span>t2ptr<span class="op">&lt;</span><span class="dt">void</span><span class="op">&gt;())</span></span></code></pre></div>
<p>がT ==
voidの時のみ、well-formedになり、このテンプレートは下記のようにインスタンス化される。</p>
<div class="sourceCode" id="cb264"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> is_void_sfinae_s<span class="op">&lt;</span><span class="dt">void</span><span class="op">,</span> <span class="dt">void</span><span class="op">*&amp;&gt;</span></span></code></pre></div>
<p>この形状はプライマリテンプレートの</p>
<ul>
<li>第1パラメータにvoidを与える</li>
<li>第2パラメータには何も与えない(デフォルトのまま)</li>
</ul>
<p>とした場合の、つまりプライマリテンプレートを</p>
<div class="sourceCode" id="cb265"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> is_void_sfinae_s<span class="op">&lt;</span><span class="dt">void</span><span class="op">&gt;</span>   <span class="co">// プライマリテンプレート</span></span></code></pre></div>
<p>としてインスタンス化した場合と一致する。
プライマリと特殊化が一致した場合、特殊化されたものがname
lookupで選択される。</p>
<p>T != voidの場合、 2つ目のis_void_sfinae_sはill-formedになり、name
lookupの対象から外れるため、 プライマリが選択される。</p>
<p>以上をまとめると、</p>
<table>
<thead>
<tr class="header">
<th>T</th>
<th>is_void_sfinae_sの基底クラス</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>== void</td>
<td>std::true_type</td>
</tr>
<tr class="even">
<td>!= void</td>
<td>std::false_type</td>
</tr>
</tbody>
</table>
<p>となる。以下の単体テストによって、このことを確かめることができる。</p>
<div class="sourceCode" id="cb266"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/is_void_ut.cpp 179</span></span>
<span id="cb266-2"><a href="#cb266-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-3"><a href="#cb266-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>is_void_sfinae_s_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;);</span></span>
<span id="cb266-4"><a href="#cb266-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_base_of_v<span class="op">&lt;</span><span class="bu">std::</span>false_type<span class="op">,</span> is_void_sfinae_s<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;&gt;);</span></span>
<span id="cb266-5"><a href="#cb266-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-6"><a href="#cb266-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>is_void_sfinae_s_v<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;);</span></span>
<span id="cb266-7"><a href="#cb266-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_base_of_v<span class="op">&lt;</span><span class="bu">std::</span>false_type<span class="op">,</span> is_void_sfinae_s<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;&gt;);</span></span>
<span id="cb266-8"><a href="#cb266-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-9"><a href="#cb266-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>is_void_sfinae_s_v<span class="op">&lt;</span><span class="dt">void</span><span class="op">&gt;);</span></span>
<span id="cb266-10"><a href="#cb266-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_base_of_v<span class="op">&lt;</span><span class="bu">std::</span>true_type<span class="op">,</span> is_void_sfinae_s<span class="op">&lt;</span><span class="dt">void</span><span class="op">&gt;&gt;);</span></span></code></pre></div>
<p>上記コードのように「プライマリテンプレートのデフォルトパラメータ」と、</p>
<div class="sourceCode" id="cb267"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/is_void_ut.cpp 162</span></span>
<span id="cb267-2"><a href="#cb267-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-3"><a href="#cb267-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// T != voidの場合、ill-formed</span></span>
<span id="cb267-4"><a href="#cb267-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// T == voidの場合、well-formedでvoid*&amp;生成</span></span>
<span id="cb267-5"><a href="#cb267-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">decltype</span><span class="op">(</span>Inner_<span class="op">::</span>t2ptr<span class="op">&lt;</span>T<span class="op">&gt;()</span> <span class="op">=</span> Inner_<span class="op">::</span>t2ptr<span class="op">&lt;</span><span class="dt">void</span><span class="op">&gt;())</span></span></code></pre></div>
<p>が「well-formedであった場合に生成される型」が一致することを利用した静的ディスパッチは、
SFINAEとクラステンプレートの特殊化を組み合わせたメタ関数の典型的な実装パターンである。
ただし、一般にはill-formedを起こすためにst::enable_ifを使うことが多いため、
「<a href="#SS_3_3_2_5">is_void_ena_sの実装</a>」でその例を示す。</p>
<h4 id="is_void_ena_sの実装">is_void_ena_sの実装
<a id="SS_3_3_2_5"></a></h4>
<p><a href="#SS_3_3_1_4">std::enable_if</a>による<a
href="#SS_5_4_7">SFINAE</a>とクラステンプレートの特殊化を使用した
is_void_ena_sの実装は以下のようになる。</p>
<div class="sourceCode" id="cb268"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/is_void_ut.cpp 192</span></span>
<span id="cb268-2"><a href="#cb268-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">,</span> <span class="kw">typename</span> <span class="op">=</span> <span class="dt">void</span><span class="op">&gt;</span></span>
<span id="cb268-3"><a href="#cb268-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> is_void_ena_s <span class="op">:</span> <span class="bu">std::</span>false_type<span class="op"> {</span></span>
<span id="cb268-4"><a href="#cb268-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb268-5"><a href="#cb268-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-6"><a href="#cb268-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb268-7"><a href="#cb268-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> is_void_ena_s<span class="op">&lt;</span></span>
<span id="cb268-8"><a href="#cb268-8" aria-hidden="true" tabindex="-1"></a>        T<span class="op">,</span></span>
<span id="cb268-9"><a href="#cb268-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">typename</span> <span class="bu">std::</span>enable_if_t<span class="op">&lt;</span>is_void_f<span class="op">&lt;</span>T<span class="op">&gt;()&gt;</span></span>
<span id="cb268-10"><a href="#cb268-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">&gt;</span> <span class="op">:</span> <span class="bu">std::</span>true_type<span class="op"> {</span></span>
<span id="cb268-11"><a href="#cb268-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb268-12"><a href="#cb268-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-13"><a href="#cb268-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb268-14"><a href="#cb268-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> is_void_ena_s_v<span class="op">{</span>is_void_ena_s<span class="op">&lt;</span>T<span class="op">&gt;::</span>value<span class="op">};</span></span></code></pre></div>
<p>この例では、「<a
href="#SS_3_3_2_4">is_void_sfinae_sの実装</a>」の</p>
<div class="sourceCode" id="cb269"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/is_void_ut.cpp 162</span></span>
<span id="cb269-2"><a href="#cb269-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-3"><a href="#cb269-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// T != voidの場合、ill-formed</span></span>
<span id="cb269-4"><a href="#cb269-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// T == voidの場合、well-formedでvoid*&amp;生成</span></span>
<span id="cb269-5"><a href="#cb269-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">decltype</span><span class="op">(</span>Inner_<span class="op">::</span>t2ptr<span class="op">&lt;</span>T<span class="op">&gt;()</span> <span class="op">=</span> Inner_<span class="op">::</span>t2ptr<span class="op">&lt;</span><span class="dt">void</span><span class="op">&gt;())</span></span></code></pre></div>
<p>で示したSFINAEの処理を上記を抜粋した下記のコード</p>
<div class="sourceCode" id="cb270"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/is_void_ut.cpp 202</span></span>
<span id="cb270-2"><a href="#cb270-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-3"><a href="#cb270-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">typename</span> <span class="bu">std::</span>enable_if_t<span class="op">&lt;</span>is_void_f<span class="op">&lt;</span>T<span class="op">&gt;()&gt;</span></span></code></pre></div>
<p>で行っている。
std::enable_ifの値パラメータis_void_f&lt;T&gt;()は、「<a
href="#SS_3_3_2_1">is_void_fの実装</a>」で示したものである。</p>
<p>単体テストは、「<a
href="#SS_3_3_2_4">is_void_sfinae_sの実装</a>」で示したものとほぼ同様で、以下のようになる。</p>
<div class="sourceCode" id="cb271"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/is_void_ut.cpp 216</span></span>
<span id="cb271-2"><a href="#cb271-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-3"><a href="#cb271-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>is_void_ena_s_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;);</span></span>
<span id="cb271-4"><a href="#cb271-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_base_of_v<span class="op">&lt;</span><span class="bu">std::</span>false_type<span class="op">,</span> is_void_ena_s<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;&gt;);</span></span>
<span id="cb271-5"><a href="#cb271-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-6"><a href="#cb271-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>is_void_ena_s_v<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;);</span></span>
<span id="cb271-7"><a href="#cb271-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_base_of_v<span class="op">&lt;</span><span class="bu">std::</span>false_type<span class="op">,</span> is_void_ena_s<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;&gt;);</span></span>
<span id="cb271-8"><a href="#cb271-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-9"><a href="#cb271-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>is_void_ena_s_v<span class="op">&lt;</span><span class="dt">void</span><span class="op">&gt;);</span></span>
<span id="cb271-10"><a href="#cb271-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_base_of_v<span class="op">&lt;</span><span class="bu">std::</span>true_type<span class="op">,</span> is_void_ena_s<span class="op">&lt;</span><span class="dt">void</span><span class="op">&gt;&gt;);</span></span></code></pre></div>
<h4 id="is_void_cond_sの実装">is_void_cond_sの実装
<a id="SS_3_3_2_6"></a></h4>
<p><a
href="#SS_3_3_1_5">std::conditional</a>と関数テンプレートの特殊化を使用したis_void_cond_sの実装は以下のようになる。</p>
<div class="sourceCode" id="cb272"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/is_void_ut.cpp 229</span></span>
<span id="cb272-2"><a href="#cb272-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb272-3"><a href="#cb272-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> is_void_cond_s <span class="op">:</span> <span class="bu">std::</span>conditional_t<span class="op">&lt;</span>is_void_f<span class="op">&lt;</span>T<span class="op">&gt;(),</span> <span class="bu">std::</span>true_type<span class="op">,</span> <span class="bu">std::</span>false_type<span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb272-4"><a href="#cb272-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb272-5"><a href="#cb272-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-6"><a href="#cb272-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb272-7"><a href="#cb272-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> is_void_cond_s_v<span class="op">{</span>is_void_cond_s<span class="op">&lt;</span>T<span class="op">&gt;::</span>value<span class="op">};</span></span></code></pre></div>
<p>std::conditionalの値パラメータis_void_f&lt;T&gt;()は、「<a
href="#SS_3_3_2_1">is_void_fの実装</a>」で示したものである。
この例では、SFINAEもクラステンプレートの特殊化も使用していないが、
下記単体テストからわかる通り、「<a
href="#SS_3_3_2_4">is_void_sfinae_sの実装</a>」と同じ機能を備えている。</p>
<div class="sourceCode" id="cb273"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/is_void_ut.cpp 240</span></span>
<span id="cb273-2"><a href="#cb273-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-3"><a href="#cb273-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>is_void_cond_s_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;);</span></span>
<span id="cb273-4"><a href="#cb273-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_base_of_v<span class="op">&lt;</span><span class="bu">std::</span>false_type<span class="op">,</span> is_void_cond_s<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;&gt;);</span></span>
<span id="cb273-5"><a href="#cb273-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-6"><a href="#cb273-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>is_void_cond_s_v<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;);</span></span>
<span id="cb273-7"><a href="#cb273-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_base_of_v<span class="op">&lt;</span><span class="bu">std::</span>false_type<span class="op">,</span> is_void_cond_s<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;&gt;);</span></span>
<span id="cb273-8"><a href="#cb273-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-9"><a href="#cb273-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>is_void_cond_s_v<span class="op">&lt;</span><span class="dt">void</span><span class="op">&gt;);</span></span>
<span id="cb273-10"><a href="#cb273-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_base_of_v<span class="op">&lt;</span><span class="bu">std::</span>true_type<span class="op">,</span> is_void_cond_s<span class="op">&lt;</span><span class="dt">void</span><span class="op">&gt;&gt;);</span></span></code></pre></div>
<h3 id="is_same_xxxの実装">is_same_xxxの実装 <a id="SS_3_3_3"></a></h3>
<p>ここではstd::is_same&lt;T, U&gt;に似た、
以下のような仕様を持ついくつかのテンプレートis_same_xxxの実装を考える。</p>
<table>
<thead>
<tr class="header">
<th>テンプレートパラメータ</th>
<th>戻り値</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>T == U</td>
<td>true</td>
</tr>
<tr class="even">
<td>T != U</td>
<td>false</td>
</tr>
</tbody>
</table>
<p>それぞれのis_same_xxxは下記テーブルで示された言語機能を使用して実装する。</p>
<table>
<colgroup>
<col style="width: 23%" />
<col style="width: 76%" />
</colgroup>
<thead>
<tr class="header">
<th>is_same_xxx</th>
<th>実装方法</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>is_same_f</td>
<td>関数テンプレートのオーバーロード</td>
</tr>
<tr class="even">
<td>is_same_v</td>
<td>定数テンプレートの特殊化</td>
</tr>
<tr class="odd">
<td>is_same_s</td>
<td>クラステンプレートの特殊化</td>
</tr>
<tr class="even">
<td>is_same_sfinae_f</td>
<td>SFINAEと関数テンプレート/関数のオーバーロード</td>
</tr>
<tr class="odd">
<td>is_same_sfinae_s</td>
<td>SFINAEとクラステンプレートの特殊化</td>
</tr>
<tr class="even">
<td>is_same_templ</td>
<td>テンプレートテンプレートパラメータ</td>
</tr>
<tr class="odd">
<td>IsSameSomeOf</td>
<td>パラメータパックと再帰</td>
</tr>
</tbody>
</table>
<h4 id="is_same_fの実装">is_same_fの実装 <a id="SS_3_3_3_1"></a></h4>
<p>関数テンプレートのオーバーロードを用いたis_same_fの実装は以下のようになる。</p>
<div class="sourceCode" id="cb274"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/is_same_ut.cpp 9</span></span>
<span id="cb274-2"><a href="#cb274-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb274-3"><a href="#cb274-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">,</span> <span class="kw">typename</span> U<span class="op">&gt;</span></span>
<span id="cb274-4"><a href="#cb274-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> is_same_f_helper<span class="op">(</span>T <span class="at">const</span><span class="op">*,</span> U <span class="at">const</span><span class="op">*)</span> <span class="kw">noexcept</span></span>
<span id="cb274-5"><a href="#cb274-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb274-6"><a href="#cb274-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb274-7"><a href="#cb274-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb274-8"><a href="#cb274-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb274-9"><a href="#cb274-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb274-10"><a href="#cb274-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> is_same_f_helper<span class="op">(</span>T <span class="at">const</span><span class="op">*,</span> T <span class="at">const</span><span class="op">*)</span> <span class="kw">noexcept</span></span>
<span id="cb274-11"><a href="#cb274-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb274-12"><a href="#cb274-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb274-13"><a href="#cb274-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb274-14"><a href="#cb274-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb274-15"><a href="#cb274-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">,</span> <span class="kw">typename</span> U<span class="op">&gt;</span></span>
<span id="cb274-16"><a href="#cb274-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> is_same_f<span class="op">()</span> <span class="kw">noexcept</span></span>
<span id="cb274-17"><a href="#cb274-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb274-18"><a href="#cb274-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> is_same_f_helper<span class="op">(</span><span class="kw">static_cast</span><span class="op">&lt;</span>T<span class="op">*&gt;(</span><span class="kw">nullptr</span><span class="op">),</span> <span class="kw">static_cast</span><span class="op">&lt;</span>U<span class="op">*&gt;(</span><span class="kw">nullptr</span><span class="op">));</span></span>
<span id="cb274-19"><a href="#cb274-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb274-20"><a href="#cb274-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb274-21"><a href="#cb274-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">,</span> <span class="kw">typename</span> U<span class="op">&gt;</span></span>
<span id="cb274-22"><a href="#cb274-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> is_same_f_v<span class="op">{</span>is_same_f<span class="op">&lt;</span>T<span class="op">,</span> U<span class="op">&gt;()};</span></span></code></pre></div>
<p>すでに述べたように関数テンプレートの部分特殊化は言語仕様として認められておらず、</p>
<div class="sourceCode" id="cb275"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/is_same_ut.cpp 34</span></span>
<span id="cb275-2"><a href="#cb275-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-3"><a href="#cb275-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">,</span> <span class="kw">typename</span> U<span class="op">&gt;</span></span>
<span id="cb275-4"><a href="#cb275-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> is_same_f<span class="op">()</span></span>
<span id="cb275-5"><a href="#cb275-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb275-6"><a href="#cb275-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb275-7"><a href="#cb275-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb275-8"><a href="#cb275-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-9"><a href="#cb275-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb275-10"><a href="#cb275-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> is_same_f<span class="op">&lt;</span>T<span class="op">,</span> T<span class="op">&gt;()</span></span>
<span id="cb275-11"><a href="#cb275-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb275-12"><a href="#cb275-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb275-13"><a href="#cb275-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>上記のようなのようなコードは、以下のようなコンパイルエラーになる
(g++/clang++のような優れたコンパイラを使えば、
以下のメッセージのように簡単に問題点が理解できることもある)。</p>
<pre><code>    is_same_ut.cpp:35:32: error: non-class, non-variable partial specialization ‘
                                          is_same_f&lt;T, T&gt;’ is not allowed
        35 | constexpr bool is_same_f&lt;T, T&gt;()</code></pre>
<p>関数テンプレートは部分特殊化が出来ない代わりに、
同じ識別子を持つ関数や関数テンプレートとのオーバーロードができる。関数とのオーバーロードの場合、
is_same_f_helper&lt;T&gt;()のようなテンプレートパラメータを直接使用した静的ディスパッチが出来ないため、
常に型推測によるディスパッチが必要になる。</p>
<p>単体テストは以下のようになる。</p>
<div class="sourceCode" id="cb277"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/is_same_ut.cpp 52</span></span>
<span id="cb277-2"><a href="#cb277-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-3"><a href="#cb277-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>is_same_f_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">void</span><span class="op">&gt;);</span></span>
<span id="cb277-4"><a href="#cb277-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>is_same_f_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span><span class="op">&gt;);</span></span>
<span id="cb277-5"><a href="#cb277-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>is_same_f_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">uint32_t</span><span class="op">&gt;);</span></span>
<span id="cb277-6"><a href="#cb277-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>is_same_f_v<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">,</span> <span class="bu">std::</span>basic_string<span class="op">&lt;</span><span class="dt">char</span><span class="op">&gt;&gt;);</span></span></code></pre></div>
<h4 id="is_same_vの実装">is_same_vの実装 <a id="SS_3_3_3_2"></a></h4>
<p>定数テンプレートの特殊化を用いたis_same_vの実装は以下のようになる。</p>
<div class="sourceCode" id="cb278"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/is_same_ut.cpp 61</span></span>
<span id="cb278-2"><a href="#cb278-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-3"><a href="#cb278-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">,</span> <span class="kw">typename</span> U<span class="op">&gt;</span></span>
<span id="cb278-4"><a href="#cb278-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> is_same_v<span class="op">{</span><span class="kw">false</span><span class="op">};</span></span>
<span id="cb278-5"><a href="#cb278-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-6"><a href="#cb278-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb278-7"><a href="#cb278-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> is_same_v<span class="op">&lt;</span>T<span class="op">,</span> T<span class="op">&gt;{</span><span class="kw">true</span><span class="op">};</span></span></code></pre></div>
<p>単純であるため、解説は不要だろう。 単体テストは以下のようになる。</p>
<div class="sourceCode" id="cb279"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb279-1"><a href="#cb279-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/is_same_ut.cpp 72</span></span>
<span id="cb279-2"><a href="#cb279-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb279-3"><a href="#cb279-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>is_same_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">void</span><span class="op">&gt;);</span></span>
<span id="cb279-4"><a href="#cb279-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>is_same_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span><span class="op">&gt;);</span></span>
<span id="cb279-5"><a href="#cb279-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>is_same_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">uint32_t</span><span class="op">&gt;);</span></span>
<span id="cb279-6"><a href="#cb279-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>is_same_v<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">,</span> <span class="bu">std::</span>basic_string<span class="op">&lt;</span><span class="dt">char</span><span class="op">&gt;&gt;);</span></span></code></pre></div>
<h4 id="is_same_sの実装">is_same_sの実装 <a id="SS_3_3_3_3"></a></h4>
<p>クラステンプレートの特殊化を用いたis_same_sの実装は以下のようになる。</p>
<div class="sourceCode" id="cb280"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/is_same_ut.cpp 81</span></span>
<span id="cb280-2"><a href="#cb280-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-3"><a href="#cb280-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">class</span> T<span class="op">,</span> <span class="kw">class</span> U<span class="op">&gt;</span></span>
<span id="cb280-4"><a href="#cb280-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> is_same_s <span class="op">{</span></span>
<span id="cb280-5"><a href="#cb280-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="kw">constexpr</span> <span class="dt">bool</span> value<span class="op">{</span><span class="kw">false</span><span class="op">};</span></span>
<span id="cb280-6"><a href="#cb280-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb280-7"><a href="#cb280-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-8"><a href="#cb280-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">class</span> T<span class="op">&gt;</span></span>
<span id="cb280-9"><a href="#cb280-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> is_same_s<span class="op">&lt;</span>T<span class="op">,</span> T<span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb280-10"><a href="#cb280-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="kw">constexpr</span> <span class="dt">bool</span> value<span class="op">{</span><span class="kw">true</span><span class="op">};</span></span>
<span id="cb280-11"><a href="#cb280-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb280-12"><a href="#cb280-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-13"><a href="#cb280-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">,</span> <span class="kw">typename</span> U<span class="op">&gt;</span></span>
<span id="cb280-14"><a href="#cb280-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> is_same_s_v<span class="op">{</span>is_same_s<span class="op">&lt;</span>T<span class="op">,</span> U<span class="op">&gt;::</span>value<span class="op">};</span></span></code></pre></div>
<p>「<a
href="#SS_3_3_3_2">is_same_vの実装</a>」と同様に単純であるため、解説は不要だろう。
単体テストは以下のようになる。</p>
<div class="sourceCode" id="cb281"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb281-1"><a href="#cb281-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/is_same_ut.cpp 99</span></span>
<span id="cb281-2"><a href="#cb281-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-3"><a href="#cb281-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>is_same_s_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">void</span><span class="op">&gt;);</span></span>
<span id="cb281-4"><a href="#cb281-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>is_same_s_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span><span class="op">&gt;);</span></span>
<span id="cb281-5"><a href="#cb281-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>is_same_s_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">uint32_t</span><span class="op">&gt;);</span></span>
<span id="cb281-6"><a href="#cb281-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>is_same_s_v<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">,</span> <span class="bu">std::</span>basic_string<span class="op">&lt;</span><span class="dt">char</span><span class="op">&gt;&gt;);</span></span></code></pre></div>
<h4 id="is_same_sfinae_fの実装">is_same_sfinae_fの実装
<a id="SS_3_3_3_4"></a></h4>
<p>SFINAEと関数テンプレート/関数のオーバーロードを用いたis_same_sfinae_f実装は以下のようになる。</p>
<div class="sourceCode" id="cb282"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/is_same_ut.cpp 108</span></span>
<span id="cb282-2"><a href="#cb282-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb282-3"><a href="#cb282-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> Inner_ <span class="op">{</span></span>
<span id="cb282-4"><a href="#cb282-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">,</span> <span class="kw">typename</span> U<span class="op">&gt;</span></span>
<span id="cb282-5"><a href="#cb282-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="kw">auto</span> is_same_sfinae_f_detector<span class="op">(</span>T <span class="at">const</span><span class="op">*</span> t<span class="op">,</span> U <span class="at">const</span><span class="op">*</span> u<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb282-6"><a href="#cb282-6" aria-hidden="true" tabindex="-1"></a>        <span class="op">-&gt;</span> <span class="kw">decltype</span><span class="op">(</span>t <span class="op">=</span> u<span class="op">,</span> u <span class="op">=</span> t<span class="op">,</span> <span class="dt">bool</span><span class="op">{})</span>  <span class="co">// T != Uの場合、t = u, u = tはill-formed</span></span>
<span id="cb282-7"><a href="#cb282-7" aria-hidden="true" tabindex="-1"></a>                                           <span class="co">// T == Uの場合、well-formedでbool型生成</span></span>
<span id="cb282-8"><a href="#cb282-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb282-9"><a href="#cb282-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb282-10"><a href="#cb282-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb282-11"><a href="#cb282-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb282-12"><a href="#cb282-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> is_same_sfinae_f_detector<span class="op">(...)</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb282-13"><a href="#cb282-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace Inner_</span></span>
<span id="cb282-14"><a href="#cb282-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb282-15"><a href="#cb282-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">,</span> <span class="kw">typename</span> U<span class="op">&gt;</span></span>
<span id="cb282-16"><a href="#cb282-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> is_same_sfinae_f<span class="op">()</span> <span class="kw">noexcept</span></span>
<span id="cb282-17"><a href="#cb282-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb282-18"><a href="#cb282-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> Inner_<span class="op">::</span>is_same_sfinae_f_detector<span class="op">(</span><span class="kw">static_cast</span><span class="op">&lt;</span>T<span class="op">*&gt;(</span><span class="kw">nullptr</span><span class="op">),</span> <span class="kw">static_cast</span><span class="op">&lt;</span>U<span class="op">*&gt;(</span><span class="kw">nullptr</span><span class="op">));</span></span>
<span id="cb282-19"><a href="#cb282-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb282-20"><a href="#cb282-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb282-21"><a href="#cb282-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">,</span> <span class="kw">typename</span> U<span class="op">&gt;</span></span>
<span id="cb282-22"><a href="#cb282-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> is_same_sfinae_f_v<span class="op">{</span>is_same_sfinae_f<span class="op">&lt;</span>T<span class="op">,</span> U<span class="op">&gt;()};</span></span></code></pre></div>
<p>上記の抜粋である下記コードのコメントで示したように、</p>
<div class="sourceCode" id="cb283"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/is_same_ut.cpp 114</span></span>
<span id="cb283-2"><a href="#cb283-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb283-3"><a href="#cb283-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">-&gt;</span> <span class="kw">decltype</span><span class="op">(</span>t <span class="op">=</span> u<span class="op">,</span> u <span class="op">=</span> t<span class="op">,</span> <span class="dt">bool</span><span class="op">{})</span>  <span class="co">// T != Uの場合、t = u, u = tはill-formed</span></span>
<span id="cb283-4"><a href="#cb283-4" aria-hidden="true" tabindex="-1"></a>                                       <span class="co">// T == Uの場合、well-formedでbool型生成</span></span></code></pre></div>
<p>T != Uの場合、この関数テンプレートはill-formedとなりname
lookupの対象ではなくなる。
その結果、関数is_same_sfinae_f_detectorが選択される。
省略記号”…“(ellipsis)を引数とする関数は、そのオーバーロード群の中での最後の選択となるため、
T ==
Uの場合は、関数テンプレートis_same_sfinae_f_detectorが選択される。</p>
<p>単体テストは以下のようになる。</p>
<div class="sourceCode" id="cb284"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/is_same_ut.cpp 138</span></span>
<span id="cb284-2"><a href="#cb284-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-3"><a href="#cb284-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>is_same_sfinae_f_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">void</span><span class="op">&gt;);</span></span>
<span id="cb284-4"><a href="#cb284-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>is_same_sfinae_f_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span><span class="op">&gt;);</span></span>
<span id="cb284-5"><a href="#cb284-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>is_same_sfinae_f_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">uint32_t</span><span class="op">&gt;);</span></span>
<span id="cb284-6"><a href="#cb284-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>is_same_sfinae_f_v<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">,</span> <span class="bu">std::</span>basic_string<span class="op">&lt;</span><span class="dt">char</span><span class="op">&gt;&gt;);</span></span></code></pre></div>
<h4 id="is_same_sfinae_sの実装">is_same_sfinae_sの実装
<a id="SS_3_3_3_5"></a></h4>
<p>SFINAEとクラステンプレートの特殊化を用いたis_same_sfinae_sの実装は以下のようになる。</p>
<div class="sourceCode" id="cb285"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb285-1"><a href="#cb285-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/is_same_ut.cpp 147</span></span>
<span id="cb285-2"><a href="#cb285-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-3"><a href="#cb285-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> Inner_ <span class="op">{</span></span>
<span id="cb285-4"><a href="#cb285-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb285-5"><a href="#cb285-5" aria-hidden="true" tabindex="-1"></a>    T<span class="op">*&amp;</span> t2ptr<span class="op">();</span></span>
<span id="cb285-6"><a href="#cb285-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb285-7"><a href="#cb285-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-8"><a href="#cb285-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">,</span> <span class="kw">typename</span> U<span class="op">,</span> <span class="kw">typename</span> <span class="op">=</span> T<span class="op">*&amp;&gt;</span></span>
<span id="cb285-9"><a href="#cb285-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> is_same_sfinae_s <span class="op">:</span> <span class="bu">std::</span>false_type<span class="op"> {</span></span>
<span id="cb285-10"><a href="#cb285-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb285-11"><a href="#cb285-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-12"><a href="#cb285-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">,</span> <span class="kw">typename</span> U<span class="op">&gt;</span></span>
<span id="cb285-13"><a href="#cb285-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> is_same_sfinae_s<span class="op">&lt;</span></span>
<span id="cb285-14"><a href="#cb285-14" aria-hidden="true" tabindex="-1"></a>        T<span class="op">,</span> U<span class="op">,</span></span>
<span id="cb285-15"><a href="#cb285-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-16"><a href="#cb285-16" aria-hidden="true" tabindex="-1"></a>        <span class="co">// T != Uの場合、ill-formed</span></span>
<span id="cb285-17"><a href="#cb285-17" aria-hidden="true" tabindex="-1"></a>        <span class="co">// T == Uの場合、well-formedでT*&amp;生成</span></span>
<span id="cb285-18"><a href="#cb285-18" aria-hidden="true" tabindex="-1"></a>        <span class="kw">decltype</span><span class="op">(</span>Inner_<span class="op">::</span>t2ptr<span class="op">&lt;</span>T<span class="op">&gt;()</span> <span class="op">=</span> Inner_<span class="op">::</span>t2ptr<span class="op">&lt;</span>U<span class="op">&gt;(),</span> Inner_<span class="op">::</span>t2ptr<span class="op">&lt;</span>U<span class="op">&gt;()</span> <span class="op">=</span> Inner_<span class="op">::</span>t2ptr<span class="op">&lt;</span>T<span class="op">&gt;())</span></span>
<span id="cb285-19"><a href="#cb285-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">&gt;</span> <span class="op">:</span> <span class="bu">std::</span>true_type<span class="op"> {</span></span>
<span id="cb285-20"><a href="#cb285-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb285-21"><a href="#cb285-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-22"><a href="#cb285-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">,</span> <span class="kw">typename</span> U<span class="op">&gt;</span></span>
<span id="cb285-23"><a href="#cb285-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> is_same_sfinae_s_v<span class="op">{</span>is_same_sfinae_s<span class="op">&lt;</span>T<span class="op">,</span> U<span class="op">&gt;::</span>value<span class="op">};</span></span></code></pre></div>
<p>「<a
href="#SS_3_3_2_4">is_void_sfinae_sの実装</a>」とほぼ同様であるため、解説は不要だろう。
単体テストは以下のようになる。</p>
<div class="sourceCode" id="cb286"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/is_same_ut.cpp 176</span></span>
<span id="cb286-2"><a href="#cb286-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-3"><a href="#cb286-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>is_same_sfinae_s_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">void</span><span class="op">&gt;);</span></span>
<span id="cb286-4"><a href="#cb286-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>is_same_sfinae_s_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span><span class="op">&gt;);</span></span>
<span id="cb286-5"><a href="#cb286-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>is_same_sfinae_s_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">uint32_t</span><span class="op">&gt;);</span></span>
<span id="cb286-6"><a href="#cb286-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>is_same_sfinae_s_v<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">,</span> <span class="bu">std::</span>basic_string<span class="op">&lt;</span><span class="dt">char</span><span class="op">&gt;&gt;);</span></span></code></pre></div>
<h4 id="is_same_templの実装">is_same_templの実装
<a id="SS_3_3_3_6"></a></h4>
<p>例えば、std::stringとstd::basic_string&lt;T&gt;が同じもしくは違う型であることを確認するためには、
すでに示したis_same_sを使用し、</p>
<div class="sourceCode" id="cb287"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/is_same_ut.cpp 197</span></span>
<span id="cb287-2"><a href="#cb287-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-3"><a href="#cb287-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>is_same_s_v<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">,</span> <span class="bu">std::</span>basic_string<span class="op">&lt;</span><span class="dt">char</span><span class="op">&gt;&gt;);</span></span>
<span id="cb287-4"><a href="#cb287-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>is_same_s_v<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">,</span> <span class="bu">std::</span>basic_string<span class="op">&lt;</span><span class="dt">signed</span> <span class="dt">char</span><span class="op">&gt;&gt;);</span></span></code></pre></div>
<p>のようにすればよいが、
以下に示したコードのようにテンプレートテンプレートパラメータを使うことでも実装できる。</p>
<div class="sourceCode" id="cb288"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb288-1"><a href="#cb288-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/is_same_ut.cpp 185</span></span>
<span id="cb288-2"><a href="#cb288-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb288-3"><a href="#cb288-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">,</span> <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">class</span><span class="op">...&gt;</span> <span class="kw">class</span> TEMPL<span class="op">,</span> <span class="kw">typename</span><span class="op">...</span> ARGS<span class="op">&gt;</span></span>
<span id="cb288-4"><a href="#cb288-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> is_same_templ <span class="op">:</span> is_same_sfinae_s<span class="op">&lt;</span>T<span class="op">,</span> TEMPL<span class="op">&lt;</span>ARGS<span class="op">...&gt;&gt;</span> <span class="op">{</span></span>
<span id="cb288-5"><a href="#cb288-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb288-6"><a href="#cb288-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb288-7"><a href="#cb288-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">,</span> <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">class</span><span class="op">...&gt;</span> <span class="kw">class</span> TEMPL<span class="op">,</span> <span class="kw">typename</span><span class="op">...</span> ARGS<span class="op">&gt;</span></span>
<span id="cb288-8"><a href="#cb288-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> is_same_templ_v<span class="op">{</span>is_same_templ<span class="op">&lt;</span>T<span class="op">,</span> TEMPL<span class="op">,</span> ARGS<span class="op">...&gt;::</span>value<span class="op">};</span></span></code></pre></div>
<p>上記のis_same_templは、第2引数にクラステンプレート、
第3引数以降にそのクラステンプレートの1個以上の引数を取ることができる。
使用例を兼ねた単体テストは以下のようになる。</p>
<div class="sourceCode" id="cb289"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb289-1"><a href="#cb289-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/is_same_ut.cpp 202</span></span>
<span id="cb289-2"><a href="#cb289-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-3"><a href="#cb289-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>is_same_templ_v<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">,</span> <span class="bu">std::</span>basic_string<span class="op">,</span> <span class="dt">char</span><span class="op">&gt;);</span></span>
<span id="cb289-4"><a href="#cb289-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>is_same_templ_v<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">,</span> <span class="bu">std::</span>basic_string<span class="op">,</span> <span class="dt">signed</span> <span class="dt">char</span><span class="op">&gt;);</span></span></code></pre></div>
<p>これを応用したエイリアステンプレート</p>
<div class="sourceCode" id="cb290"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/is_same_ut.cpp 209</span></span>
<span id="cb290-2"><a href="#cb290-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb290-3"><a href="#cb290-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb290-4"><a href="#cb290-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> gen_std_string <span class="op">=</span> is_same_templ<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">,</span> <span class="bu">std::</span>basic_string<span class="op">,</span> T<span class="op">&gt;;</span></span>
<span id="cb290-5"><a href="#cb290-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb290-6"><a href="#cb290-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb290-7"><a href="#cb290-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> gen_std_string_v<span class="op">{</span>gen_std_string<span class="op">&lt;</span>T<span class="op">&gt;::</span>value<span class="op">};</span></span></code></pre></div>
<p>は与えられたテンプレートパラメータがstd::stringを生成するかどうかを判定することができる。</p>
<div class="sourceCode" id="cb291"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb291-1"><a href="#cb291-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/is_same_ut.cpp 220</span></span>
<span id="cb291-2"><a href="#cb291-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-3"><a href="#cb291-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>gen_std_string_v<span class="op">&lt;</span><span class="dt">char</span><span class="op">&gt;);</span></span>
<span id="cb291-4"><a href="#cb291-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>gen_std_string_v<span class="op">&lt;</span><span class="dt">signed</span> <span class="dt">char</span><span class="op">&gt;);</span></span></code></pre></div>
<h4 id="issamesomeofの実装">IsSameSomeOfの実装
<a id="SS_3_3_3_7"></a></h4>
<p>IsSameSomeOfはこれまでの例とは少々異なり、</p>
<ul>
<li>第1パラメータが第2パラメータ以降で指定された型の
<ul>
<li>どれかと同じであれば、std::true_typeから派生する</li>
<li>どれとも違えば、std::false_typeから派生する</li>
</ul></li>
<li>2つの型の同一性の判定にはstd::is_sameを使用する</li>
<li>汎用性が高いため名前空間Nstdで定義し、命名はキャメルにする</li>
</ul>
<p>のような特徴のを持つ。
このようなIsSameSomeOfをパラメータパックと再帰を使用して実装すると以下のようになる。</p>
<div class="sourceCode" id="cb292"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_type_traits.h 10</span></span>
<span id="cb292-2"><a href="#cb292-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb292-3"><a href="#cb292-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> Nstd <span class="op">{</span></span>
<span id="cb292-4"><a href="#cb292-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> Inner_ <span class="op">{</span></span>
<span id="cb292-5"><a href="#cb292-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb292-6"><a href="#cb292-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">,</span> <span class="kw">typename</span> U<span class="op">,</span> <span class="kw">typename</span><span class="op">...</span> Us<span class="op">&gt;</span></span>
<span id="cb292-7"><a href="#cb292-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> is_same_some_of <span class="op">{</span></span>
<span id="cb292-8"><a href="#cb292-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="kw">constexpr</span> <span class="dt">bool</span> value<span class="op">{</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span>T<span class="op">,</span> U<span class="op">&gt;</span> <span class="op">?</span> <span class="kw">true</span> <span class="op">:</span> is_same_some_of<span class="op">&lt;</span>T<span class="op">,</span> Us<span class="op">...&gt;::</span>value<span class="op">};</span></span>
<span id="cb292-9"><a href="#cb292-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb292-10"><a href="#cb292-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb292-11"><a href="#cb292-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">,</span> <span class="kw">typename</span> U<span class="op">&gt;</span></span>
<span id="cb292-12"><a href="#cb292-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> is_same_some_of<span class="op">&lt;</span>T<span class="op">,</span> U<span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb292-13"><a href="#cb292-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="kw">constexpr</span> <span class="dt">bool</span> value<span class="op">{</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span>T<span class="op">,</span> U<span class="op">&gt;};</span></span>
<span id="cb292-14"><a href="#cb292-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb292-15"><a href="#cb292-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb292-16"><a href="#cb292-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">,</span> <span class="kw">typename</span><span class="op">...</span> Us<span class="op">&gt;</span></span>
<span id="cb292-17"><a href="#cb292-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> is_same_some_of_v<span class="op">{</span>is_same_some_of<span class="op">&lt;</span>T<span class="op">,</span> Us<span class="op">...&gt;::</span>value<span class="op">};</span></span>
<span id="cb292-18"><a href="#cb292-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace Inner_</span></span>
<span id="cb292-19"><a href="#cb292-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb292-20"><a href="#cb292-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">,</span> <span class="kw">typename</span><span class="op">...</span> Us<span class="op">&gt;</span></span>
<span id="cb292-21"><a href="#cb292-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> IsSameSomeOf</span>
<span id="cb292-22"><a href="#cb292-22" aria-hidden="true" tabindex="-1"></a>        <span class="op">:</span> <span class="bu">std::</span>conditional_t<span class="op">&lt;</span>Inner_<span class="op">::</span>is_same_some_of_v<span class="op">&lt;</span>T<span class="op">,</span> Us<span class="op">...&gt;,</span> <span class="bu">std::</span>true_type<span class="op">,</span> <span class="bu">std::</span>false_type<span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb292-23"><a href="#cb292-23" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb292-24"><a href="#cb292-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb292-25"><a href="#cb292-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">,</span> <span class="kw">typename</span><span class="op">...</span> Us<span class="op">&gt;</span></span>
<span id="cb292-26"><a href="#cb292-26" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> IsSameSomeOfV<span class="op">{</span>IsSameSomeOf<span class="op">&lt;</span>T<span class="op">,</span> Us<span class="op">...&gt;::</span>value<span class="op">};</span></span>
<span id="cb292-27"><a href="#cb292-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace Nstd</span></span></code></pre></div>
<p>IsSameSomeOfは、TがUsのいずれかと一致するかどうかの処理をInner_::is_same_some_ofに移譲する。</p>
<p>Usが1つだった場合、特殊化されたInner_::is_same_some_ofのvalueがstd::is_same::valueで初期化される。
Usが複数だった場合、 プライマリのInner_::is_same_some_ofは、
IsSameSomeOfから渡されたパラメータパックUsを、UとパラメータパックUsに分割後、
TとUをstd::is_sameで比較し、</p>
<ul>
<li>同じ場合、valueはtrueで初期化される</li>
<li>違う場合、valueは再帰的に読み出されたInner_::is_same_some_of&lt;T,
Us…&gt;::valueで初期化される</li>
</ul>
<p>再帰的なInner_::is_same_some_of::valueの読み出しは、
IsSameSomeOfが受け取ったパラメータパックをひとつずつ左シフトしながら、
それが1つになるまで(特殊化されたInner_::is_same_some_ofが使われるまで)、続けられる。</p>
<p>単体テストは以下のようになる。</p>
<div class="sourceCode" id="cb293"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb293-1"><a href="#cb293-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_type_traits_ut.cpp 14</span></span>
<span id="cb293-2"><a href="#cb293-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-3"><a href="#cb293-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>Nstd<span class="op">::</span>IsSameSomeOfV<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int8_t</span><span class="op">,</span> <span class="dt">int16_t</span><span class="op">,</span> <span class="dt">uint16_t</span><span class="op">&gt;);</span></span>
<span id="cb293-4"><a href="#cb293-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>Nstd<span class="op">::</span>IsSameSomeOfV<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int8_t</span><span class="op">,</span> <span class="dt">int16_t</span><span class="op">,</span> <span class="dt">uint16_t</span><span class="op">,</span> <span class="dt">int32_t</span><span class="op">&gt;);</span></span>
<span id="cb293-5"><a href="#cb293-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>Nstd<span class="op">::</span>IsSameSomeOfV<span class="op">&lt;</span><span class="dt">int</span><span class="op">&amp;,</span> <span class="dt">int8_t</span><span class="op">,</span> <span class="dt">int16_t</span><span class="op">,</span> <span class="dt">int32_t</span><span class="op">&amp;,</span> <span class="dt">int32_t</span><span class="op">&gt;);</span></span>
<span id="cb293-6"><a href="#cb293-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>Nstd<span class="op">::</span>IsSameSomeOfV<span class="op">&lt;</span><span class="dt">int</span><span class="op">&amp;,</span> <span class="dt">int8_t</span><span class="op">,</span> <span class="dt">int16_t</span><span class="op">,</span> <span class="dt">uint32_t</span><span class="op">&amp;,</span> <span class="dt">int32_t</span><span class="op">&gt;);</span></span>
<span id="cb293-7"><a href="#cb293-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>Nstd<span class="op">::</span>IsSameSomeOfV<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">,</span> <span class="dt">int</span><span class="op">,</span> <span class="dt">char</span><span class="op">*,</span> <span class="bu">std::</span>string<span class="op">&gt;);</span></span>
<span id="cb293-8"><a href="#cb293-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>Nstd<span class="op">::</span>IsSameSomeOfV<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">,</span> <span class="dt">int</span><span class="op">,</span> <span class="dt">char</span><span class="op">*&gt;);</span></span></code></pre></div>
<h3 id="areconvertiblexxxの実装">AreConvertibleXxxの実装
<a id="SS_3_3_4"></a></h3>
<p>std::is_convertible&lt;FROM, TO&gt;は、</p>
<ul>
<li>型FROMが型TOに変換できる場合、std::true_typeから派生する</li>
<li>型FROMが型TOに変換できない場合、std::false_typeから派生する</li>
</ul>
<p>のような仕様を持つテンプレートである。</p>
<p>ここでは、</p>
<ul>
<li>std::is_convertibleを複数のFROMが指定できるように拡張したNstd::AreConvertible</li>
<li>縮小無しでの型変換ができるかどうかを判定するAreConvertibleWithoutNarrowConv</li>
</ul>
<p>の実装を考える。</p>
<h4 id="areconvertibleの実装">AreConvertibleの実装
<a id="SS_3_3_4_1"></a></h4>
<p>AreConvertibleの実装は以下のようになる。</p>
<div class="sourceCode" id="cb294"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb294-1"><a href="#cb294-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_type_traits.h 42</span></span>
<span id="cb294-2"><a href="#cb294-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb294-3"><a href="#cb294-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> Nstd <span class="op">{</span></span>
<span id="cb294-4"><a href="#cb294-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> Inner_ <span class="op">{</span></span>
<span id="cb294-5"><a href="#cb294-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb294-6"><a href="#cb294-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> TO<span class="op">,</span> <span class="kw">typename</span> FROM<span class="op">,</span> <span class="kw">typename</span><span class="op">...</span> FROMs<span class="op">&gt;</span></span>
<span id="cb294-7"><a href="#cb294-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> are_convertible <span class="op">{</span></span>
<span id="cb294-8"><a href="#cb294-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="kw">constexpr</span> <span class="dt">bool</span> value<span class="op">{</span></span>
<span id="cb294-9"><a href="#cb294-9" aria-hidden="true" tabindex="-1"></a>            <span class="bu">std::</span>is_convertible_v<span class="op">&lt;</span>FROM<span class="op">,</span> TO<span class="op">&gt;</span> <span class="op">&amp;&amp;</span> are_convertible<span class="op">&lt;</span>TO<span class="op">,</span> FROMs<span class="op">...&gt;::</span>value<span class="op">};</span></span>
<span id="cb294-10"><a href="#cb294-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb294-11"><a href="#cb294-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb294-12"><a href="#cb294-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> TO<span class="op">,</span> <span class="kw">typename</span> FROM<span class="op">&gt;</span></span>
<span id="cb294-13"><a href="#cb294-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> are_convertible<span class="op">&lt;</span>TO<span class="op">,</span> FROM<span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb294-14"><a href="#cb294-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="kw">constexpr</span> <span class="dt">bool</span> value<span class="op">{</span><span class="bu">std::</span>is_convertible_v<span class="op">&lt;</span>FROM<span class="op">,</span> TO<span class="op">&gt;};</span></span>
<span id="cb294-15"><a href="#cb294-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb294-16"><a href="#cb294-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb294-17"><a href="#cb294-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> TO<span class="op">,</span> <span class="kw">typename</span><span class="op">...</span> FROMs<span class="op">&gt;</span></span>
<span id="cb294-18"><a href="#cb294-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> are_convertible_v<span class="op">{</span>are_convertible<span class="op">&lt;</span>TO<span class="op">,</span> FROMs<span class="op">...&gt;::</span>value<span class="op">};</span></span>
<span id="cb294-19"><a href="#cb294-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace Inner_</span></span>
<span id="cb294-20"><a href="#cb294-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb294-21"><a href="#cb294-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> TO<span class="op">,</span> <span class="kw">typename</span><span class="op">...</span> FROMs<span class="op">&gt;</span></span>
<span id="cb294-22"><a href="#cb294-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> AreConvertible</span>
<span id="cb294-23"><a href="#cb294-23" aria-hidden="true" tabindex="-1"></a>        <span class="op">:</span> <span class="bu">std::</span>conditional_t<span class="op">&lt;</span>Inner_<span class="op">::</span>are_convertible_v<span class="op">&lt;</span>TO<span class="op">,</span> FROMs<span class="op">...&gt;,</span> <span class="bu">std::</span>true_type<span class="op">,</span> <span class="bu">std::</span>false_type<span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb294-24"><a href="#cb294-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb294-25"><a href="#cb294-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb294-26"><a href="#cb294-26" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> TO<span class="op">,</span> <span class="kw">typename</span><span class="op">...</span> FROMs<span class="op">&gt;</span></span>
<span id="cb294-27"><a href="#cb294-27" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> AreConvertibleV<span class="op">{</span>AreConvertible<span class="op">&lt;</span>TO<span class="op">,</span> FROMs<span class="op">...&gt;::</span>value<span class="op">};</span></span>
<span id="cb294-28"><a href="#cb294-28" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace Nstd</span></span></code></pre></div>
<p>「<a
href="#SS_3_3_3_7">IsSameSomeOfの実装</a>」のコードパターンとほぼ同様であるため、解説は不要だろうが、</p>
<ul>
<li>パラメータパックの都合上、TOとFROMのパラメータの位置がstd::is_convertibleとは逆になる</li>
<li>IsSameSomeOfでは条件の一つがtrueであればIsSameSomeOf::valueがtrueとなるが、
AreConvertibleでは全条件がtrueとならない限り、AreConvertible::valueがtrueとならない</li>
</ul>
<p>ので注意が必要である。</p>
<p>単体テストは以下のようになる。</p>
<div class="sourceCode" id="cb295"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb295-1"><a href="#cb295-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_type_traits_ut.cpp 27</span></span>
<span id="cb295-2"><a href="#cb295-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb295-3"><a href="#cb295-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>Nstd<span class="op">::</span>AreConvertibleV<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int8_t</span><span class="op">,</span> <span class="dt">int16_t</span><span class="op">,</span> <span class="dt">int</span><span class="op">&gt;);</span></span>
<span id="cb295-4"><a href="#cb295-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>Nstd<span class="op">::</span>AreConvertibleV<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">char</span><span class="op">,</span> <span class="dt">int</span><span class="op">,</span> <span class="dt">int</span><span class="op">&gt;);</span></span>
<span id="cb295-5"><a href="#cb295-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>Nstd<span class="op">::</span>AreConvertibleV<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">char</span><span class="op">*,</span> <span class="dt">int</span><span class="op">,</span> <span class="dt">int</span><span class="op">&gt;);</span></span>
<span id="cb295-6"><a href="#cb295-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>Nstd<span class="op">::</span>AreConvertibleV<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">,</span> <span class="bu">std::</span>string<span class="op">,</span> <span class="dt">char</span><span class="op">*,</span> <span class="dt">char</span><span class="op">[</span><span class="dv">3</span><span class="op">]&gt;);</span></span>
<span id="cb295-7"><a href="#cb295-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>Nstd<span class="op">::</span>AreConvertibleV<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">,</span> <span class="bu">std::</span>string<span class="op">,</span> <span class="dt">char</span><span class="op">*,</span> <span class="dt">int</span><span class="op">&gt;);</span></span></code></pre></div>
<h4
id="areconvertiblewithoutnarrowconvの実装">AreConvertibleWithoutNarrowConvの実装
<a id="SS_3_3_4_2"></a></h4>
<p>縮小無しの型変換ができるかどうかを判定するAreConvertibleWithoutNarrowConvは、
AreConvertibleと同じように実装できるが、
その場合、AreConvertibleに対してstd::is_convertibleが必要になったように、
AreConvertibleWithoutNarrowConvに対しis_convertible_without_narrow_convが必要になる。</p>
<p>縮小無しでFROMからTOへの型変換ができるかどうかを判定するis_convertible_without_narrow_convは、
SFINAEと関数テンプレート/関数のオーバーライドを使用し以下のように実装できる。</p>
<div class="sourceCode" id="cb296"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb296-1"><a href="#cb296-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_type_traits.h 75</span></span>
<span id="cb296-2"><a href="#cb296-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-3"><a href="#cb296-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> Nstd <span class="op">{</span></span>
<span id="cb296-4"><a href="#cb296-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> Inner_ <span class="op">{</span></span>
<span id="cb296-5"><a href="#cb296-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-6"><a href="#cb296-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> TO<span class="op">,</span> <span class="kw">typename</span> FROM<span class="op">&gt;</span></span>
<span id="cb296-7"><a href="#cb296-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> is_convertible_without_narrow_conv <span class="op">{</span></span>
<span id="cb296-8"><a href="#cb296-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T <span class="op">=</span> TO<span class="op">,</span> <span class="kw">typename</span> U <span class="op">=</span> FROM<span class="op">&gt;</span></span>
<span id="cb296-9"><a href="#cb296-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="kw">constexpr</span> <span class="kw">auto</span> detector<span class="op">(</span>T<span class="op">*</span> t<span class="op">,</span> U<span class="op">*</span> u<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb296-10"><a href="#cb296-10" aria-hidden="true" tabindex="-1"></a>            <span class="co">// 縮小無しでFROMからTOへ変換可能な場合、*t = T{*u}はwell-formed</span></span>
<span id="cb296-11"><a href="#cb296-11" aria-hidden="true" tabindex="-1"></a>            <span class="co">// 上記ではない場合、*t = T{*u}はill-formed</span></span>
<span id="cb296-12"><a href="#cb296-12" aria-hidden="true" tabindex="-1"></a>            <span class="op">-&gt;</span> <span class="kw">decltype</span><span class="op">(*</span>t <span class="op">=</span> T<span class="op">{*</span>u<span class="op">},</span> <span class="dt">bool</span><span class="op">{})</span></span>
<span id="cb296-13"><a href="#cb296-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb296-14"><a href="#cb296-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb296-15"><a href="#cb296-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb296-16"><a href="#cb296-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-17"><a href="#cb296-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="kw">constexpr</span> <span class="dt">bool</span> detector<span class="op">(...)</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb296-18"><a href="#cb296-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-19"><a href="#cb296-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb296-20"><a href="#cb296-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="kw">constexpr</span> <span class="dt">bool</span> value<span class="op">{</span>is_convertible_without_narrow_conv<span class="op">::</span>detector<span class="op">(</span></span>
<span id="cb296-21"><a href="#cb296-21" aria-hidden="true" tabindex="-1"></a>            <span class="kw">static_cast</span><span class="op">&lt;</span>TO<span class="op">*&gt;(</span><span class="kw">nullptr</span><span class="op">),</span> <span class="kw">static_cast</span><span class="op">&lt;</span>FROM<span class="op">*&gt;(</span><span class="kw">nullptr</span><span class="op">))};</span></span>
<span id="cb296-22"><a href="#cb296-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb296-23"><a href="#cb296-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-24"><a href="#cb296-24" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> TO<span class="op">,</span> <span class="kw">typename</span> FROM<span class="op">&gt;</span></span>
<span id="cb296-25"><a href="#cb296-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> is_convertible_without_narrow_conv_v<span class="op">{</span></span>
<span id="cb296-26"><a href="#cb296-26" aria-hidden="true" tabindex="-1"></a>        is_convertible_without_narrow_conv<span class="op">&lt;</span>TO<span class="op">,</span> FROM<span class="op">&gt;::</span>value<span class="op">};</span></span>
<span id="cb296-27"><a href="#cb296-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace Inner_</span></span>
<span id="cb296-28"><a href="#cb296-28" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace Nstd</span></span></code></pre></div>
<p>AreConvertibleWithoutNarrowConvはNstdで定義するため、その内部のみで用いる
is_convertible_without_narrow_convはNstd::Inner_で定義している。</p>
<p>上記を抜粋した下記のコードは「縮小型変換を発生さる{}による初期化は<a
href="#SS_5_10_8">ill-formed</a>になる」
ことをSFINAEに利用している。</p>
<div class="sourceCode" id="cb297"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_type_traits.h 85</span></span>
<span id="cb297-2"><a href="#cb297-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-3"><a href="#cb297-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 縮小無しでFROMからTOへ変換可能な場合、*t = T{*u}はwell-formed</span></span>
<span id="cb297-4"><a href="#cb297-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 上記ではない場合、*t = T{*u}はill-formed</span></span>
<span id="cb297-5"><a href="#cb297-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">-&gt;</span> <span class="kw">decltype</span><span class="op">(*</span>t <span class="op">=</span> T<span class="op">{*</span>u<span class="op">},</span> <span class="dt">bool</span><span class="op">{})</span></span></code></pre></div>
<p>単体テストは以下のようになる。</p>
<div class="sourceCode" id="cb298"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb298-1"><a href="#cb298-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_type_traits_ut.cpp 39</span></span>
<span id="cb298-2"><a href="#cb298-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb298-3"><a href="#cb298-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>Nstd<span class="op">::</span>Inner_<span class="op">::</span>is_convertible_without_narrow_conv_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span><span class="op">&gt;);</span></span>
<span id="cb298-4"><a href="#cb298-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>Nstd<span class="op">::</span>Inner_<span class="op">::</span>is_convertible_without_narrow_conv_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int16_t</span><span class="op">&gt;);</span></span>
<span id="cb298-5"><a href="#cb298-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>Nstd<span class="op">::</span>Inner_<span class="op">::</span>is_convertible_without_narrow_conv_v<span class="op">&lt;</span><span class="dt">int16_t</span><span class="op">,</span> <span class="dt">int</span><span class="op">&gt;);</span></span>
<span id="cb298-6"><a href="#cb298-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>Nstd<span class="op">::</span>Inner_<span class="op">::</span>is_convertible_without_narrow_conv_v<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">,</span> <span class="dt">char</span><span class="op">*&gt;);</span></span>
<span id="cb298-7"><a href="#cb298-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>Nstd<span class="op">::</span>Inner_<span class="op">::</span>is_convertible_without_narrow_conv_v<span class="op">&lt;</span><span class="dt">char</span><span class="op">*,</span> <span class="bu">std::</span>string<span class="op">&gt;);</span></span></code></pre></div>
<p>is_convertible_without_narrow_convを利用したAreConvertibleWithoutNarrowConv
の実装は以下のようになる。</p>
<div class="sourceCode" id="cb299"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_type_traits.h 108</span></span>
<span id="cb299-2"><a href="#cb299-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3"><a href="#cb299-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> Nstd <span class="op">{</span></span>
<span id="cb299-4"><a href="#cb299-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> Inner_ <span class="op">{</span></span>
<span id="cb299-5"><a href="#cb299-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-6"><a href="#cb299-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> TO<span class="op">,</span> <span class="kw">typename</span> FROM<span class="op">,</span> <span class="kw">typename</span><span class="op">...</span> FROMs<span class="op">&gt;</span></span>
<span id="cb299-7"><a href="#cb299-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> are_convertible_without_narrow_conv <span class="op">{</span></span>
<span id="cb299-8"><a href="#cb299-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="kw">constexpr</span> <span class="dt">bool</span> value<span class="op">{</span></span>
<span id="cb299-9"><a href="#cb299-9" aria-hidden="true" tabindex="-1"></a>            is_convertible_without_narrow_conv_v<span class="op">&lt;</span>TO<span class="op">,</span> FROM<span class="op">&gt;</span> </span>
<span id="cb299-10"><a href="#cb299-10" aria-hidden="true" tabindex="-1"></a>                  <span class="op">&amp;&amp;</span> are_convertible_without_narrow_conv<span class="op">&lt;</span>TO<span class="op">,</span> FROMs<span class="op">...&gt;::</span>value<span class="op">};</span></span>
<span id="cb299-11"><a href="#cb299-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb299-12"><a href="#cb299-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-13"><a href="#cb299-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> TO<span class="op">,</span> <span class="kw">typename</span> FROM<span class="op">&gt;</span></span>
<span id="cb299-14"><a href="#cb299-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> are_convertible_without_narrow_conv<span class="op">&lt;</span>TO<span class="op">,</span> FROM<span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb299-15"><a href="#cb299-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="kw">constexpr</span> <span class="dt">bool</span> value<span class="op">{</span>is_convertible_without_narrow_conv_v<span class="op">&lt;</span>TO<span class="op">,</span> FROM<span class="op">&gt;};</span></span>
<span id="cb299-16"><a href="#cb299-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb299-17"><a href="#cb299-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-18"><a href="#cb299-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> TO<span class="op">,</span> <span class="kw">typename</span> FROM<span class="op">,</span> <span class="kw">typename</span><span class="op">...</span> FROMs<span class="op">&gt;</span></span>
<span id="cb299-19"><a href="#cb299-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> are_convertible_without_narrow_conv_v<span class="op">{</span></span>
<span id="cb299-20"><a href="#cb299-20" aria-hidden="true" tabindex="-1"></a>        are_convertible_without_narrow_conv<span class="op">&lt;</span>TO<span class="op">,</span> FROM<span class="op">,</span> FROMs<span class="op">...&gt;::</span>value<span class="op">};</span></span>
<span id="cb299-21"><a href="#cb299-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace Inner_</span></span>
<span id="cb299-22"><a href="#cb299-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-23"><a href="#cb299-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> TO<span class="op">,</span> <span class="kw">typename</span> FROM<span class="op">,</span> <span class="kw">typename</span><span class="op">...</span> FROMs<span class="op">&gt;</span></span>
<span id="cb299-24"><a href="#cb299-24" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> AreConvertibleWithoutNarrowConv</span>
<span id="cb299-25"><a href="#cb299-25" aria-hidden="true" tabindex="-1"></a>        <span class="op">:</span> <span class="bu">std::</span>conditional_t<span class="op">&lt;</span>Inner_<span class="op">::</span>are_convertible_without_narrow_conv_v<span class="op">&lt;</span>TO<span class="op">,</span> FROM<span class="op">,</span> FROMs<span class="op">...&gt;,</span></span>
<span id="cb299-26"><a href="#cb299-26" aria-hidden="true" tabindex="-1"></a>                             <span class="bu">std::</span>true_type<span class="op">,</span> <span class="bu">std::</span>false_type<span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb299-27"><a href="#cb299-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb299-28"><a href="#cb299-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-29"><a href="#cb299-29" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> TO<span class="op">,</span> <span class="kw">typename</span> FROM<span class="op">,</span> <span class="kw">typename</span><span class="op">...</span> FROMs<span class="op">&gt;</span></span>
<span id="cb299-30"><a href="#cb299-30" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> AreConvertibleWithoutNarrowConvV<span class="op">{</span></span>
<span id="cb299-31"><a href="#cb299-31" aria-hidden="true" tabindex="-1"></a>        AreConvertibleWithoutNarrowConv<span class="op">&lt;</span>TO<span class="op">,</span> FROM<span class="op">,</span> FROMs<span class="op">...&gt;::</span>value<span class="op">};</span></span>
<span id="cb299-32"><a href="#cb299-32" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace Nstd</span></span></code></pre></div>
<p>単体テストは以下のようになる。</p>
<div class="sourceCode" id="cb300"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb300-1"><a href="#cb300-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_type_traits_ut.cpp 47</span></span>
<span id="cb300-2"><a href="#cb300-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-3"><a href="#cb300-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>Nstd<span class="op">::</span>AreConvertibleWithoutNarrowConvV<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">char</span><span class="op">,</span> <span class="dt">int16_t</span><span class="op">,</span> <span class="dt">uint16_t</span><span class="op">&gt;);</span></span>
<span id="cb300-4"><a href="#cb300-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>Nstd<span class="op">::</span>AreConvertibleWithoutNarrowConvV<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">char</span><span class="op">,</span> <span class="dt">int16_t</span><span class="op">,</span> <span class="dt">uint32_t</span><span class="op">&gt;);</span></span>
<span id="cb300-5"><a href="#cb300-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>Nstd<span class="op">::</span>AreConvertibleWithoutNarrowConvV<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">,</span> <span class="dt">char</span><span class="op">[</span><span class="dv">5</span><span class="op">],</span> <span class="dt">char</span><span class="op">*&gt;);</span></span>
<span id="cb300-6"><a href="#cb300-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>Nstd<span class="op">::</span>AreConvertibleWithoutNarrowConvV<span class="op">&lt;</span><span class="dt">double</span><span class="op">,</span> <span class="dt">float</span><span class="op">&gt;);</span></span>
<span id="cb300-7"><a href="#cb300-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-8"><a href="#cb300-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">// int8_t -&gt; doubleは縮小型変換</span></span>
<span id="cb300-9"><a href="#cb300-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>Nstd<span class="op">::</span>AreConvertibleWithoutNarrowConvV<span class="op">&lt;</span><span class="dt">double</span><span class="op">,</span> <span class="dt">float</span><span class="op">,</span> <span class="dt">int8_t</span><span class="op">&gt;);</span></span></code></pre></div>
<h3 id="関数の存在の診断">関数の存在の診断 <a id="SS_3_3_5"></a></h3>
<p>Nstdライブラリの開発には関数の存在の診断が欠かせない。 例えば、</p>
<ul>
<li>テンプレートパラメータに特定のメンバ関数がある場合、特殊化を作る</li>
<li>テンプレートパラメータに範囲for文が適用できる場合にのみoperator&lt;&lt;を適用する</li>
<li>テンプレートパラメータに適用できるoperator&lt;&lt;がすでにあった場合、
自作operator&lt;&lt;を不活性化する</li>
</ul>
<p>等、応用範囲は多岐にわたる。
ここでは、上記の場合分けを可能とするようなメタ関数に必要なテクニックや、
それらを使用したNstdのメタ関数の実装を下記のように示す。</p>
<ul>
<li>テンプレートパラメータである型が、メンバ関数void
func()を持つかどうかの診断について、 次の表のように実装を示す。</li>
</ul>
<table>
<colgroup>
<col style="width: 31%" />
<col style="width: 68%" />
</colgroup>
<thead>
<tr class="header">
<th>メタ関数名</th>
<th>メタ関数の目的</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>exists_void_func_sfinae_f</td>
<td>メンバ関数void func()を持つかどうかの判断</td>
</tr>
<tr class="even">
<td>exists_void_func_sfinae_s</td>
<td>同上</td>
</tr>
<tr class="odd">
<td>exists_void_func_sfinae_s2</td>
<td>同上</td>
</tr>
</tbody>
</table>
<ul>
<li>テンプレートパラメータに範囲for文ができるかどうかの診断について、
次の表のように実装を示す。</li>
</ul>
<table>
<colgroup>
<col style="width: 30%" />
<col style="width: 69%" />
</colgroup>
<thead>
<tr class="header">
<th>メタ関数名</th>
<th>メタ関数の目的</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>exists_begin</td>
<td>std::begin(T)が存在するか否かの診断</td>
</tr>
<tr class="even">
<td>exists_end</td>
<td>std::end(T)が存在するか否かの診断</td>
</tr>
<tr class="odd">
<td>IsRange</td>
<td>T const&amp; tの時に、for(auto const&amp; :
t)ができるかどうかの診断</td>
</tr>
</tbody>
</table>
<ul>
<li>テンプレートパラメータにoperator&lt;&lt;(put
toと発音する)ができるかどうかの診断について、
次の表のように実装を示す。</li>
</ul>
<table>
<colgroup>
<col style="width: 32%" />
<col style="width: 67%" />
</colgroup>
<thead>
<tr class="header">
<th>メタ関数名</th>
<th>メタ関数の目的</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>exists_put_to_as_member</td>
<td>std::ostream::operator&lt;&lt;(T)が存在するか否かの診断</td>
</tr>
<tr class="even">
<td>exists_put_to_as_non_member</td>
<td>operator&lt;&lt;(std::ostream&amp;, T)が存在するか否かの診断</td>
</tr>
<tr class="odd">
<td>ExistsPutTo</td>
<td>std::ostream&amp; &lt;&lt; Tができるかどうかの診断</td>
</tr>
</tbody>
</table>
<ul>
<li>テンプレートパラメータがT[N]やC&lt;T&gt;の形式である時のTに、
operator&lt;&lt;が適用できるかの診断については、Tの型を取り出す必要がある。
そのようなメタ関数ValueTypeの実装を示す。</li>
</ul>
<h4 id="exists_void_func_sfinae_fの実装">exists_void_func_sfinae_fの実装
<a id="SS_3_3_5_1"></a></h4>
<p>「テンプレートパラメータである型が、メンバ関数void
func()を持つかどうかを診断する」 exists_void_func_sfinae_f
のSFINAEと関数テンプレート/関数のオーバーロードを用いた実装は以下のようになる。</p>
<div class="sourceCode" id="cb301"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/exists_func_ut.cpp 13</span></span>
<span id="cb301-2"><a href="#cb301-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-3"><a href="#cb301-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> Inner_ <span class="op">{</span></span>
<span id="cb301-4"><a href="#cb301-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-5"><a href="#cb301-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb301-6"><a href="#cb301-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> exists_void_func_void <span class="op">=</span></span>
<span id="cb301-7"><a href="#cb301-7" aria-hidden="true" tabindex="-1"></a>        <span class="co">// メンバvoid func(void)があれば、voidを生成</span></span>
<span id="cb301-8"><a href="#cb301-8" aria-hidden="true" tabindex="-1"></a>        <span class="co">// メンバvoid func(void)がなければ、ill-formed</span></span>
<span id="cb301-9"><a href="#cb301-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">typename</span> <span class="bu">std::</span>enable_if_t<span class="op">&lt;</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span><span class="bu">std::</span>declval<span class="op">&lt;</span>T<span class="op">&gt;().</span>func<span class="op">()),</span> <span class="dt">void</span><span class="op">&gt;&gt;;</span></span>
<span id="cb301-10"><a href="#cb301-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace Inner_</span></span>
<span id="cb301-11"><a href="#cb301-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-12"><a href="#cb301-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">,</span> <span class="kw">typename</span> <span class="op">=</span> Inner_<span class="op">::</span>exists_void_func_void<span class="op">&lt;</span>T<span class="op">&gt;&gt;</span></span>
<span id="cb301-13"><a href="#cb301-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> exists_void_func_sfinae_f<span class="op">(</span>T<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb301-14"><a href="#cb301-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb301-15"><a href="#cb301-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb301-16"><a href="#cb301-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb301-17"><a href="#cb301-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-18"><a href="#cb301-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> exists_void_func_sfinae_f<span class="op">(...)</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span> <span class="op">}</span></span></code></pre></div>
<p>decltypeの中での関数呼び出しは、実際には呼び出されず関数の戻り値の型になる。
上記の抜粋である下記のコードはこの性質を利用してSFINAEによる静的ディスパッチを行っている。</p>
<div class="sourceCode" id="cb302"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb302-1"><a href="#cb302-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/exists_func_ut.cpp 20</span></span>
<span id="cb302-2"><a href="#cb302-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-3"><a href="#cb302-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// メンバvoid func(void)があれば、voidを生成</span></span>
<span id="cb302-4"><a href="#cb302-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// メンバvoid func(void)がなければ、ill-formed</span></span>
<span id="cb302-5"><a href="#cb302-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">typename</span> <span class="bu">std::</span>enable_if_t<span class="op">&lt;</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span><span class="bu">std::</span>declval<span class="op">&lt;</span>T<span class="op">&gt;().</span>func<span class="op">()),</span> <span class="dt">void</span><span class="op">&gt;&gt;;</span></span></code></pre></div>
<p>単体テストは以下のようになる。</p>
<div class="sourceCode" id="cb303"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/exists_func_ut.cpp 40</span></span>
<span id="cb303-2"><a href="#cb303-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb303-3"><a href="#cb303-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// テスト用クラス</span></span>
<span id="cb303-4"><a href="#cb303-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> X <span class="op">{</span></span>
<span id="cb303-5"><a href="#cb303-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> func<span class="op">();</span></span>
<span id="cb303-6"><a href="#cb303-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb303-7"><a href="#cb303-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb303-8"><a href="#cb303-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> Y <span class="op">{</span></span>
<span id="cb303-9"><a href="#cb303-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> func<span class="op">();</span></span>
<span id="cb303-10"><a href="#cb303-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb303-11"><a href="#cb303-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb303-12"><a href="#cb303-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> Z <span class="op">{</span></span>
<span id="cb303-13"><a href="#cb303-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb303-14"><a href="#cb303-14" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> func<span class="op">();</span>  <span class="co">// privateなvoid func()は外部からは呼び出せない</span></span>
<span id="cb303-15"><a href="#cb303-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb304"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb304-1"><a href="#cb304-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/exists_func_ut.cpp 60</span></span>
<span id="cb304-2"><a href="#cb304-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb304-3"><a href="#cb304-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>exists_void_func_sfinae_f<span class="op">(</span><span class="dt">int</span><span class="op">{}));</span></span>
<span id="cb304-4"><a href="#cb304-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>exists_void_func_sfinae_f<span class="op">(</span>X<span class="op">{}));</span></span>
<span id="cb304-5"><a href="#cb304-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>exists_void_func_sfinae_f<span class="op">(</span>Y<span class="op">{}));</span></span>
<span id="cb304-6"><a href="#cb304-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>exists_void_func_sfinae_f<span class="op">(</span>Z<span class="op">{}));</span></span></code></pre></div>
<h4 id="exists_void_func_sfinae_sの実装">exists_void_func_sfinae_sの実装
<a id="SS_3_3_5_2"></a></h4>
<p>「テンプレートパラメータである型が、メンバ関数void
func()を持つかどうかを診断」する exists_void_func_sfinae_s
のSFINAEとクラステンプレートの特殊化を用いた実装は以下のようになる。</p>
<div class="sourceCode" id="cb305"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/exists_func_ut.cpp 69</span></span>
<span id="cb305-2"><a href="#cb305-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-3"><a href="#cb305-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">,</span> <span class="kw">typename</span> U <span class="op">=</span> <span class="dt">void</span><span class="op">&gt;</span></span>
<span id="cb305-4"><a href="#cb305-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> exists_void_func_sfinae_s <span class="op">:</span> <span class="bu">std::</span>false_type<span class="op"> {</span></span>
<span id="cb305-5"><a href="#cb305-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb305-6"><a href="#cb305-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-7"><a href="#cb305-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb305-8"><a href="#cb305-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> exists_void_func_sfinae_s<span class="op">&lt;</span>T<span class="op">,</span></span>
<span id="cb305-9"><a href="#cb305-9" aria-hidden="true" tabindex="-1"></a>        <span class="co">// メンバvoid func()が呼び出せれば、voidを生成</span></span>
<span id="cb305-10"><a href="#cb305-10" aria-hidden="true" tabindex="-1"></a>        <span class="co">// メンバvoid func()が呼び出せなければ、ill-formed</span></span>
<span id="cb305-11"><a href="#cb305-11" aria-hidden="true" tabindex="-1"></a>        <span class="kw">decltype</span><span class="op">(</span><span class="bu">std::</span>declval<span class="op">&lt;</span>T<span class="op">&gt;().</span>func<span class="op">())</span></span>
<span id="cb305-12"><a href="#cb305-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">&gt;</span> <span class="op">:</span> <span class="bu">std::</span>true_type<span class="op"> {</span></span>
<span id="cb305-13"><a href="#cb305-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb305-14"><a href="#cb305-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-15"><a href="#cb305-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb305-16"><a href="#cb305-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> exists_void_func_sfinae_s_v<span class="op">{</span>exists_void_func_sfinae_s<span class="op">&lt;</span>T<span class="op">&gt;::</span>value<span class="op">};</span></span></code></pre></div>
<p>exists_void_func_sfinae_fとほぼ等しいSFINAEを利用したクラステンプレートの特殊化により、
静的ディスパッチを行っている。</p>
<p>単体テストは以下のようになる。</p>
<div class="sourceCode" id="cb306"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb306-1"><a href="#cb306-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/exists_func_ut.cpp 91</span></span>
<span id="cb306-2"><a href="#cb306-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb306-3"><a href="#cb306-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>exists_void_func_sfinae_s_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;);</span></span>
<span id="cb306-4"><a href="#cb306-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>exists_void_func_sfinae_s_v<span class="op">&lt;</span>X<span class="op">&gt;);</span></span>
<span id="cb306-5"><a href="#cb306-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>exists_void_func_sfinae_s_v<span class="op">&lt;</span>Y<span class="op">&gt;);</span></span>
<span id="cb306-6"><a href="#cb306-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>exists_void_func_sfinae_s_v<span class="op">&lt;</span>Z<span class="op">&gt;);</span></span></code></pre></div>
<h4
id="exists_void_func_sfinae_s2の実装">exists_void_func_sfinae_s2の実装
<a id="SS_3_3_5_3"></a></h4>
<p>exists_void_func_sfinae_sとほぼ同様の仕様を持つexists_void_func_sfinae_s2の</p>
<ul>
<li>SFINAE</li>
<li>メンバ関数テンプレート/メンバ関数のオーバーロード</li>
<li>メンバ関数へのポインタ</li>
</ul>
<p>を用いた実装は以下のようになる。</p>
<div class="sourceCode" id="cb307"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/exists_func_ut.cpp 100</span></span>
<span id="cb307-2"><a href="#cb307-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-3"><a href="#cb307-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb307-4"><a href="#cb307-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> exists_void_func_sfinae_s2 <span class="op">{</span></span>
<span id="cb307-5"><a href="#cb307-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-6"><a href="#cb307-6" aria-hidden="true" tabindex="-1"></a>        <span class="co">// メンバvoid func()が呼び出せれば、メンバ関数テンプレートはtrueを返す</span></span>
<span id="cb307-7"><a href="#cb307-7" aria-hidden="true" tabindex="-1"></a>        <span class="co">// メンバvoid func()が呼び出せなければ、ill-formed</span></span>
<span id="cb307-8"><a href="#cb307-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> U<span class="op">,</span> <span class="dt">void</span> <span class="op">(</span>U<span class="op">::*)()</span> <span class="op">=</span> <span class="op">&amp;</span>U<span class="op">::</span>func<span class="op">&gt;</span></span>
<span id="cb307-9"><a href="#cb307-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="kw">constexpr</span> <span class="dt">bool</span> detector<span class="op">(</span>U<span class="op">*)</span> <span class="kw">noexcept</span></span>
<span id="cb307-10"><a href="#cb307-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb307-11"><a href="#cb307-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb307-12"><a href="#cb307-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb307-13"><a href="#cb307-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-14"><a href="#cb307-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="kw">constexpr</span> <span class="dt">bool</span> detector<span class="op">(...)</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb307-15"><a href="#cb307-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-16"><a href="#cb307-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb307-17"><a href="#cb307-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="kw">constexpr</span> <span class="dt">bool</span> value<span class="op">{</span>exists_void_func_sfinae_s2<span class="op">::</span>detector<span class="op">(</span><span class="kw">static_cast</span><span class="op">&lt;</span>T<span class="op">*&gt;(</span><span class="kw">nullptr</span><span class="op">))};</span></span>
<span id="cb307-18"><a href="#cb307-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb307-19"><a href="#cb307-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-20"><a href="#cb307-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb307-21"><a href="#cb307-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> exists_void_func_sfinae_s2_v<span class="op">{</span>exists_void_func_sfinae_s2<span class="op">&lt;</span>T<span class="op">&gt;::</span>value<span class="op">};</span></span></code></pre></div>
<p>前2例とは異なり、上記の抜粋である下記コードのように、
メンバ関数へのポインタを使用しSFINAEを実装している。</p>
<div class="sourceCode" id="cb308"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb308-1"><a href="#cb308-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/exists_func_ut.cpp 105</span></span>
<span id="cb308-2"><a href="#cb308-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb308-3"><a href="#cb308-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// メンバvoid func()が呼び出せれば、メンバ関数テンプレートはtrueを返す</span></span>
<span id="cb308-4"><a href="#cb308-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// メンバvoid func()が呼び出せなければ、ill-formed</span></span>
<span id="cb308-5"><a href="#cb308-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> U<span class="op">,</span> <span class="dt">void</span> <span class="op">(</span>U<span class="op">::*)()</span> <span class="op">=</span> <span class="op">&amp;</span>U<span class="op">::</span>func<span class="op">&gt;</span></span>
<span id="cb308-6"><a href="#cb308-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">static</span> <span class="kw">constexpr</span> <span class="dt">bool</span> detector<span class="op">(</span>U<span class="op">*)</span> <span class="kw">noexcept</span></span>
<span id="cb308-7"><a href="#cb308-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb308-8"><a href="#cb308-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb308-9"><a href="#cb308-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>あまり応用範囲が広くない方法ではあるが、
decltypeを使っていないのでC++03コンパイラにも受け入れられるメリットがある。</p>
<p>exists_void_func_sfinae_fと同じテスト用クラスを用いた単体テストは以下のようになる。</p>
<div class="sourceCode" id="cb309"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb309-1"><a href="#cb309-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/exists_func_ut.cpp 129</span></span>
<span id="cb309-2"><a href="#cb309-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb309-3"><a href="#cb309-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>exists_void_func_sfinae_s2_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;);</span></span>
<span id="cb309-4"><a href="#cb309-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>exists_void_func_sfinae_s2_v<span class="op">&lt;</span>X<span class="op">&gt;);</span></span>
<span id="cb309-5"><a href="#cb309-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>exists_void_func_sfinae_s2_v<span class="op">&lt;</span>Y<span class="op">&gt;);</span></span>
<span id="cb309-6"><a href="#cb309-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>exists_void_func_sfinae_s2_v<span class="op">&lt;</span>Z<span class="op">&gt;);</span></span></code></pre></div>
<h4 id="exists_beginexsits_endの実装">exists_begin/exsits_endの実装
<a id="SS_3_3_5_4"></a></h4>
<p>「テンプレートパラメータTに対して、std::begin(T)が存在するか否かの診断」をするexists_beginの実装は、
「<a href="#SS_3_3_5_2">exists_void_func_sfinae_sの実装</a>」
で用いたパターンのメンバ関数を非メンバ関数に置き換えて使えば以下のようになる。</p>
<div class="sourceCode" id="cb310"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb310-1"><a href="#cb310-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/exists_func_ut.cpp 140</span></span>
<span id="cb310-2"><a href="#cb310-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb310-3"><a href="#cb310-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span><span class="op">,</span> <span class="kw">typename</span> <span class="op">=</span> <span class="dt">void</span><span class="op">&gt;</span></span>
<span id="cb310-4"><a href="#cb310-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> exists_begin <span class="op">:</span> <span class="bu">std::</span>false_type<span class="op"> {</span></span>
<span id="cb310-5"><a href="#cb310-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb310-6"><a href="#cb310-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb310-7"><a href="#cb310-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb310-8"><a href="#cb310-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> exists_begin<span class="op">&lt;</span>T<span class="op">,</span> <span class="bu">std::</span>void_t<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span><span class="bu">std::</span>begin<span class="op">(</span><span class="bu">std::</span>declval<span class="op">&lt;</span>T<span class="op">&gt;()))&gt;&gt;</span> <span class="op">:</span> <span class="bu">std::</span>true_type<span class="op"> {</span></span>
<span id="cb310-9"><a href="#cb310-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb310-10"><a href="#cb310-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb310-11"><a href="#cb310-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb310-12"><a href="#cb310-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> exists_begin_v<span class="op">{</span>exists_begin<span class="op">&lt;</span>T<span class="op">&gt;::</span>value<span class="op">};</span></span></code></pre></div>
<p>上記で使用したstd::void_tは、テンプレートパラメータが</p>
<ul>
<li><a href="#SS_5_10_8">ill-formed</a>ならばill-formedになる</li>
<li><a href="#SS_5_10_9">well-formed</a>ならvoidを生成する</li>
</ul>
<p>テンプレートである。</p>
<p>下記単体テストでは問題ないように見えるが、</p>
<div class="sourceCode" id="cb311"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb311-1"><a href="#cb311-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/exists_func_ut.cpp 156</span></span>
<span id="cb311-2"><a href="#cb311-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-3"><a href="#cb311-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>exists_begin_v<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;);</span></span>
<span id="cb311-4"><a href="#cb311-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>exists_begin_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;);</span></span>
<span id="cb311-5"><a href="#cb311-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>exists_begin_v<span class="op">&lt;</span><span class="dt">int</span> <span class="at">const</span><span class="op">[</span><span class="dv">3</span><span class="op">]&gt;);</span></span></code></pre></div>
<p>下記の単体テストはstatic_assertがフェールするためコンパイルできない。</p>
<div class="sourceCode" id="cb312"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb312-1"><a href="#cb312-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/exists_func_ut.cpp 166</span></span>
<span id="cb312-2"><a href="#cb312-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb312-3"><a href="#cb312-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 以下が問題</span></span>
<span id="cb312-4"><a href="#cb312-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>exists_begin_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">[</span><span class="dv">3</span><span class="op">]&gt;);</span></span></code></pre></div>
<p>理由は、</p>
<div class="sourceCode" id="cb313"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>declval<span class="op">&lt;</span><span class="dt">int</span><span class="op">[</span><span class="dv">3</span><span class="op">]&gt;())</span></span></code></pre></div>
<p>の戻り型が配列型の<a href="#SS_5_5_3">rvalue</a>である”int
(&amp;&amp;) [3]“となり、
これに対応するstd::beginが定義されていないためである。</p>
<p>これに対処する方法方はいくつかあるが、
すべての配列は常にstd::beginの引数になれることに気づけば、
テンプレートパラメータが配列か否かで場合分けしたクラステンプレートの特殊化を使い、
下記のように実装できることにも気付けるだろう。</p>
<div class="sourceCode" id="cb314"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb314-1"><a href="#cb314-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/exists_func_ut.cpp 183</span></span>
<span id="cb314-2"><a href="#cb314-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3"><a href="#cb314-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span><span class="op">,</span> <span class="kw">typename</span> <span class="op">=</span> <span class="dt">void</span><span class="op">&gt;</span></span>
<span id="cb314-4"><a href="#cb314-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> exists_begin <span class="op">:</span> <span class="bu">std::</span>false_type<span class="op"> {</span></span>
<span id="cb314-5"><a href="#cb314-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb314-6"><a href="#cb314-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-7"><a href="#cb314-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Tが非配列の場合の特殊化</span></span>
<span id="cb314-8"><a href="#cb314-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb314-9"><a href="#cb314-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> exists_begin<span class="op">&lt;</span>T<span class="op">,</span></span>
<span id="cb314-10"><a href="#cb314-10" aria-hidden="true" tabindex="-1"></a>                        <span class="kw">typename</span> <span class="bu">std::</span>enable_if_t<span class="op">&lt;!</span><span class="bu">std::</span>is_array_v<span class="op">&lt;</span>T<span class="op">&gt;,</span></span>
<span id="cb314-11"><a href="#cb314-11" aria-hidden="true" tabindex="-1"></a>                                                  <span class="bu">std::</span>void_t<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span><span class="bu">std::</span>begin<span class="op">(</span><span class="bu">std::</span>declval<span class="op">&lt;</span>T<span class="op">&gt;()))&gt;&gt;&gt;</span></span>
<span id="cb314-12"><a href="#cb314-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">:</span> <span class="bu">std::</span>true_type<span class="op"> {</span></span>
<span id="cb314-13"><a href="#cb314-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb314-14"><a href="#cb314-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-15"><a href="#cb314-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Tが配列の場合の特殊化</span></span>
<span id="cb314-16"><a href="#cb314-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb314-17"><a href="#cb314-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> exists_begin<span class="op">&lt;</span>T<span class="op">,</span> <span class="kw">typename</span> <span class="bu">std::</span>enable_if_t<span class="op">&lt;</span><span class="bu">std::</span>is_array_v<span class="op">&lt;</span>T<span class="op">&gt;&gt;&gt;</span> <span class="op">:</span> <span class="bu">std::</span>true_type<span class="op"> {</span></span>
<span id="cb314-18"><a href="#cb314-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb314-19"><a href="#cb314-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-20"><a href="#cb314-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb314-21"><a href="#cb314-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> exists_begin_v<span class="op">{</span>exists_begin<span class="op">&lt;</span>T<span class="op">&gt;::</span>value<span class="op">};</span></span></code></pre></div>
<p>2個目のexists_beginはTが配列でない場合、
3個目のexists_beginはTが配列ある場合にそれぞれが対応しているが、複雑すぎて何とも醜い。
ということで、このコードは却下して、別のアイデアを試そう。</p>
<p>テンプレートパラメータが配列である場合でも、 そのオブジェクトが<a
href="#SS_5_5_2">lvalue</a>(この例ではint (&amp;)[3])であれば、
std::beginはそのオブジェクトを使用できるので、
decltype内で使用できるlvalueのT型オブジェクトを生成できれば、
と考えれば下記のような実装を思いつくだろう。</p>
<div class="sourceCode" id="cb315"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb315-1"><a href="#cb315-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_type_traits.h 150</span></span>
<span id="cb315-2"><a href="#cb315-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb315-3"><a href="#cb315-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span><span class="op">,</span> <span class="kw">typename</span> <span class="op">=</span> <span class="dt">void</span><span class="op">&gt;</span></span>
<span id="cb315-4"><a href="#cb315-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> exists_begin <span class="op">:</span> <span class="bu">std::</span>false_type<span class="op"> {</span></span>
<span id="cb315-5"><a href="#cb315-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb315-6"><a href="#cb315-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb315-7"><a href="#cb315-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb315-8"><a href="#cb315-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> exists_begin<span class="op">&lt;</span>T<span class="op">,</span> <span class="bu">std::</span>void_t<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span><span class="bu">std::</span>begin<span class="op">(</span><span class="bu">std::</span>declval<span class="op">&lt;</span>T<span class="op">&amp;&gt;()))&gt;&gt;</span> <span class="op">:</span> <span class="bu">std::</span>true_type<span class="op"> {</span></span>
<span id="cb315-9"><a href="#cb315-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb315-10"><a href="#cb315-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb315-11"><a href="#cb315-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb315-12"><a href="#cb315-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> exists_begin_v<span class="op">{</span>exists_begin<span class="op">&lt;</span>T<span class="op">&gt;::</span>value<span class="op">};</span></span></code></pre></div>
<p>十分にシンプルなのでこれを採用し、exists_endも同様に実装する。</p>
<div class="sourceCode" id="cb316"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb316-1"><a href="#cb316-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_type_traits.h 163</span></span>
<span id="cb316-2"><a href="#cb316-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb316-3"><a href="#cb316-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span><span class="op">,</span> <span class="kw">typename</span> <span class="op">=</span> <span class="dt">void</span><span class="op">&gt;</span></span>
<span id="cb316-4"><a href="#cb316-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> exists_end <span class="op">:</span> <span class="bu">std::</span>false_type<span class="op"> {</span></span>
<span id="cb316-5"><a href="#cb316-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb316-6"><a href="#cb316-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb316-7"><a href="#cb316-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb316-8"><a href="#cb316-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> exists_end<span class="op">&lt;</span>T<span class="op">,</span> <span class="bu">std::</span>void_t<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span><span class="bu">std::</span>end<span class="op">(</span><span class="bu">std::</span>declval<span class="op">&lt;</span>T<span class="op">&amp;&gt;()))&gt;&gt;</span> <span class="op">:</span> <span class="bu">std::</span>true_type<span class="op"> {</span></span>
<span id="cb316-9"><a href="#cb316-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb316-10"><a href="#cb316-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb316-11"><a href="#cb316-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> exists_end_v<span class="op">{</span>exists_end<span class="op">&lt;</span>T<span class="op">&gt;::</span>value<span class="op">};</span></span></code></pre></div>
<p>単体テストは下記のようになる。</p>
<div class="sourceCode" id="cb317"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb317-1"><a href="#cb317-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_type_traits_ut.cpp 81</span></span>
<span id="cb317-2"><a href="#cb317-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb317-3"><a href="#cb317-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>exists_begin_v<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;);</span></span>
<span id="cb317-4"><a href="#cb317-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>exists_begin_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;);</span></span>
<span id="cb317-5"><a href="#cb317-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>exists_begin_v<span class="op">&lt;</span><span class="dt">int</span> <span class="at">const</span><span class="op">[</span><span class="dv">3</span><span class="op">]&gt;);</span></span>
<span id="cb317-6"><a href="#cb317-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>exists_begin_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">[</span><span class="dv">3</span><span class="op">]&gt;);</span>  <span class="co">// 問題が解決</span></span>
<span id="cb317-7"><a href="#cb317-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb317-8"><a href="#cb317-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>exists_end_v<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;);</span></span>
<span id="cb317-9"><a href="#cb317-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>exists_end_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;);</span></span>
<span id="cb317-10"><a href="#cb317-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>exists_end_v<span class="op">&lt;</span><span class="dt">int</span> <span class="at">const</span><span class="op">[</span><span class="dv">3</span><span class="op">]&gt;);</span></span>
<span id="cb317-11"><a href="#cb317-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>exists_end_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">[</span><span class="dv">3</span><span class="op">]&gt;);</span></span></code></pre></div>
<h4 id="israngeの実装">IsRangeの実装 <a id="SS_3_3_5_5"></a></h4>
<p><a
href="https://cpprefjp.github.io/lang/cpp11/range_based_for.html">範囲for文</a>
文の”:“の後ろにT型オブジェクトが指定できる要件は、</p>
<ul>
<li>std::begin(T)、std::end(T)がTのイテレータであるITOR型のオブジェクトを返す</li>
<li>std::begin(T)が返すITORオブジェクトはTが保持する先頭の要素を指す</li>
<li>std::end(T)が返すITORオブジェクトはTが保持する最後の要素の次を指す</li>
<li>++ITORによりTが保持する全要素にアクセスできる</li>
</ul>
<p>ようなことである。多くの要件はセマンティクス的なものであり、
メタ関数で診断できることは前項で見たようなstd::begin(T)、std::end(T)の可否のみであると考えれば、
IsRangeの実装は以下のようになる。</p>
<div class="sourceCode" id="cb318"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb318-1"><a href="#cb318-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_type_traits.h 177</span></span>
<span id="cb318-2"><a href="#cb318-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-3"><a href="#cb318-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb318-4"><a href="#cb318-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> IsRange <span class="op">:</span> <span class="bu">std::</span>conditional_t<span class="op">&lt;</span>Inner_<span class="op">::</span>exists_begin_v<span class="op">&lt;</span>T<span class="op">&gt;</span> <span class="op">&amp;&amp;</span> Inner_<span class="op">::</span>exists_end_v<span class="op">&lt;</span>T<span class="op">&gt;,</span></span>
<span id="cb318-5"><a href="#cb318-5" aria-hidden="true" tabindex="-1"></a>                                        <span class="bu">std::</span>true_type<span class="op">,</span> <span class="bu">std::</span>false_type<span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb318-6"><a href="#cb318-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb318-7"><a href="#cb318-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-8"><a href="#cb318-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb318-9"><a href="#cb318-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> IsRangeV<span class="op">{</span>IsRange<span class="op">&lt;</span>T<span class="op">&gt;::</span>value<span class="op">};</span></span></code></pre></div>
<p>なお、上記のコードでは、exists_begin/exsits_endは、IsRangeの実装の詳細であるため、
名前空間Inner_で宣言している。</p>
<div class="sourceCode" id="cb319"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb319-1"><a href="#cb319-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_type_traits_ut.cpp 100</span></span>
<span id="cb319-2"><a href="#cb319-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb319-3"><a href="#cb319-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>IsRangeV<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;);</span></span>
<span id="cb319-4"><a href="#cb319-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>IsRangeV<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;);</span></span>
<span id="cb319-5"><a href="#cb319-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>IsRangeV<span class="op">&lt;</span><span class="dt">int</span> <span class="at">const</span><span class="op">[</span><span class="dv">3</span><span class="op">]&gt;);</span></span>
<span id="cb319-6"><a href="#cb319-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>IsRangeV<span class="op">&lt;</span><span class="dt">int</span><span class="op">[</span><span class="dv">3</span><span class="op">]&gt;);</span></span></code></pre></div>
<h4 id="exists_put_to_as_memberの実装">exists_put_to_as_memberの実装
<a id="SS_3_3_5_6"></a></h4>
<p>std::ostreamのメンバ関数operator&lt;&lt;の戻り型はstd::ostream&amp;であるため、
exists_put_to_as_memberの実装は以下のようになる(“&lt;&lt;”は英語で”put
to”と発音する)。</p>
<div class="sourceCode" id="cb320"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb320-1"><a href="#cb320-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/exists_func_ut.cpp 219</span></span>
<span id="cb320-2"><a href="#cb320-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-3"><a href="#cb320-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span><span class="op">,</span> <span class="kw">typename</span> <span class="op">=</span> <span class="bu">std::</span>ostream<span class="op">&amp;&gt;</span></span>
<span id="cb320-4"><a href="#cb320-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> exists_put_to_as_member <span class="op">:</span> <span class="bu">std::</span>false_type<span class="op"> {</span></span>
<span id="cb320-5"><a href="#cb320-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb320-6"><a href="#cb320-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-7"><a href="#cb320-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb320-8"><a href="#cb320-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> exists_put_to_as_member<span class="op">&lt;</span>T<span class="op">,</span> <span class="kw">decltype</span><span class="op">(</span><span class="bu">std::</span>declval<span class="op">&lt;</span><span class="bu">std::</span>ostream<span class="op">&amp;&gt;().</span><span class="kw">operator</span><span class="op">&lt;&lt;(</span></span>
<span id="cb320-9"><a href="#cb320-9" aria-hidden="true" tabindex="-1"></a>                                          <span class="bu">std::</span>declval<span class="op">&lt;</span>T<span class="op">&gt;()))&gt;</span> <span class="op">:</span> <span class="bu">std::</span>true_type<span class="op"> {</span></span>
<span id="cb320-10"><a href="#cb320-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb320-11"><a href="#cb320-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-12"><a href="#cb320-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb320-13"><a href="#cb320-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> exists_put_to_as_member_v<span class="op">{</span>exists_put_to_as_member<span class="op">&lt;</span>T<span class="op">&gt;::</span>value<span class="op">};</span></span></code></pre></div>
<p>「<a
href="#SS_3_3_5_1">exists_void_func_sfinae_fの実装</a>」と同様のパターンを使用したので解説は不要だろう。</p>
<p>単体テストは以下のようになる。</p>
<div class="sourceCode" id="cb321"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb321-1"><a href="#cb321-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/test_class.h 3</span></span>
<span id="cb321-2"><a href="#cb321-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb321-3"><a href="#cb321-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> test_class_exits_put_to <span class="op">{</span></span>
<span id="cb321-4"><a href="#cb321-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb321-5"><a href="#cb321-5" aria-hidden="true" tabindex="-1"></a>        test_class_exits_put_to<span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">)</span> <span class="kw">noexcept</span> <span class="op">:</span> <span class="va">i_</span><span class="op">{</span>i<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb321-6"><a href="#cb321-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> get<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">i_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb321-7"><a href="#cb321-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb321-8"><a href="#cb321-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb321-9"><a href="#cb321-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> <span class="va">i_</span><span class="op">;</span></span>
<span id="cb321-10"><a href="#cb321-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb321-11"><a href="#cb321-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb321-12"><a href="#cb321-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">inline</span> <span class="bu">std::</span>ostream<span class="op">&amp;</span> <span class="kw">operator</span><span class="op">&lt;&lt;(</span><span class="bu">std::</span>ostream<span class="op">&amp;</span> os<span class="op">,</span> test_class_exits_put_to <span class="at">const</span><span class="op">&amp;</span> p<span class="op">)</span></span>
<span id="cb321-13"><a href="#cb321-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb321-14"><a href="#cb321-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> os <span class="op">&lt;&lt;</span> p<span class="op">.</span>get<span class="op">();</span></span>
<span id="cb321-15"><a href="#cb321-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb321-16"><a href="#cb321-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb321-17"><a href="#cb321-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> test_class_not_exits_put_to <span class="op">{};</span></span></code></pre></div>
<div class="sourceCode" id="cb322"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb322-1"><a href="#cb322-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/exists_func_ut.cpp 236</span></span>
<span id="cb322-2"><a href="#cb322-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb322-3"><a href="#cb322-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>exists_put_to_as_member_v<span class="op">&lt;</span><span class="dt">bool</span><span class="op">&gt;);</span></span>
<span id="cb322-4"><a href="#cb322-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>exists_put_to_as_member_v<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;);</span></span>
<span id="cb322-5"><a href="#cb322-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>exists_put_to_as_member_v<span class="op">&lt;</span><span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;&gt;);</span></span>
<span id="cb322-6"><a href="#cb322-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>exists_put_to_as_member_v<span class="op">&lt;</span><span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;*&gt;);</span></span>
<span id="cb322-7"><a href="#cb322-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>exists_put_to_as_member_v<span class="op">&lt;</span>test_class_exits_put_to<span class="op">&gt;);</span></span>
<span id="cb322-8"><a href="#cb322-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>exists_put_to_as_member_v<span class="op">&lt;</span>test_class_not_exits_put_to<span class="op">&gt;);</span></span>
<span id="cb322-9"><a href="#cb322-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>exists_put_to_as_member_v<span class="op">&lt;</span>test_class_not_exits_put_to<span class="op">[</span><span class="dv">3</span><span class="op">]&gt;);</span>  <span class="co">// 驚き!</span></span></code></pre></div>
<p>やや驚きなのは、上記の抜粋である下記コードがコンパイルできることである。</p>
<div class="sourceCode" id="cb323"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb323-1"><a href="#cb323-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/exists_func_ut.cpp 245</span></span>
<span id="cb323-2"><a href="#cb323-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-3"><a href="#cb323-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>exists_put_to_as_member_v<span class="op">&lt;</span>test_class_not_exits_put_to<span class="op">[</span><span class="dv">3</span><span class="op">]&gt;);</span>  <span class="co">// 驚き!</span></span></code></pre></div>
<p>これは、</p>
<div class="sourceCode" id="cb324"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb324-1"><a href="#cb324-1" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>ostream<span class="op">&amp;</span> <span class="bu">std::</span>ostream<span class="bu">::</span>operator<span class="op">&lt;&lt;(</span><span class="dt">void</span> <span class="at">const</span><span class="op">*)</span></span></code></pre></div>
<p>が定義されているため、配列がポインタに変換されてこのメンバ関数にバインドした結果である。</p>
<h4
id="exists_put_to_as_non_memberの実装">exists_put_to_as_non_memberの実装
<a id="SS_3_3_5_7"></a></h4>
<p>exists_put_to_as_non_memberの実装は以下のようになる。</p>
<div class="sourceCode" id="cb325"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb325-1"><a href="#cb325-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/exists_func_ut.cpp 254</span></span>
<span id="cb325-2"><a href="#cb325-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb325-3"><a href="#cb325-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span><span class="op">,</span> <span class="kw">typename</span> <span class="op">=</span> <span class="bu">std::</span>ostream<span class="op">&amp;&gt;</span></span>
<span id="cb325-4"><a href="#cb325-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> exists_put_to_as_non_member <span class="op">:</span> <span class="bu">std::</span>false_type<span class="op"> {</span></span>
<span id="cb325-5"><a href="#cb325-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb325-6"><a href="#cb325-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb325-7"><a href="#cb325-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb325-8"><a href="#cb325-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> exists_put_to_as_non_member<span class="op">&lt;</span>T<span class="op">,</span> <span class="kw">decltype</span><span class="op">(</span><span class="kw">operator</span><span class="op">&lt;&lt;(</span><span class="bu">std::</span>declval<span class="op">&lt;</span><span class="bu">std::</span>ostream<span class="op">&amp;&gt;(),</span></span>
<span id="cb325-9"><a href="#cb325-9" aria-hidden="true" tabindex="-1"></a>                                                              <span class="bu">std::</span>declval<span class="op">&lt;</span>T<span class="op">&gt;()))&gt;</span> <span class="op">:</span> <span class="bu">std::</span>true_type<span class="op"> {</span></span>
<span id="cb325-10"><a href="#cb325-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb325-11"><a href="#cb325-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb325-12"><a href="#cb325-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb325-13"><a href="#cb325-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> exists_put_to_as_non_member_v<span class="op">{</span>exists_put_to_as_non_member<span class="op">&lt;</span>T<span class="op">&gt;::</span>value<span class="op">};</span></span></code></pre></div>
<p>「<a href="#SS_3_3_5_4">exists_begin/exsits_endの実装</a>」と「<a
href="#SS_3_3_5_6">exists_put_to_as_memberの実装</a>」
で使用したパターンを混合しただけなので解説や単体テストは省略する。</p>
<h4 id="existsputtoの実装">ExistsPutToの実装
<a id="SS_3_3_5_8"></a></h4>
<p>テンプレートパラメータT、T型オブジェクトtに対して、 std::ostream
&lt;&lt;
tができるかどうかを判断するExistsPutToの実装は以下のようになる。</p>
<div class="sourceCode" id="cb326"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb326-1"><a href="#cb326-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/exists_func_ut.cpp 283</span></span>
<span id="cb326-2"><a href="#cb326-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-3"><a href="#cb326-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb326-4"><a href="#cb326-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> ExistsPutTo</span>
<span id="cb326-5"><a href="#cb326-5" aria-hidden="true" tabindex="-1"></a>        <span class="op">:</span> <span class="bu">std::</span>conditional_t<span class="op">&lt;</span></span>
<span id="cb326-6"><a href="#cb326-6" aria-hidden="true" tabindex="-1"></a>              Inner_<span class="op">::</span>exists_put_to_as_member_v<span class="op">&lt;</span>T<span class="op">&gt;</span> <span class="op">||</span> Inner_<span class="op">::</span>exists_put_to_as_non_member_v<span class="op">&lt;</span>T<span class="op">&gt;,</span></span>
<span id="cb326-7"><a href="#cb326-7" aria-hidden="true" tabindex="-1"></a>              <span class="bu">std::</span>true_type<span class="op">,</span> <span class="bu">std::</span>false_type<span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb326-8"><a href="#cb326-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb326-9"><a href="#cb326-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-10"><a href="#cb326-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb326-11"><a href="#cb326-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> ExistsPutToV<span class="op">{</span>ExistsPutTo<span class="op">&lt;</span>T<span class="op">&gt;::</span>value<span class="op">};</span></span></code></pre></div>
<p>「<a
href="#SS_3_3_5_5">IsRangeの実装</a>」に影響されて、一旦このように実装したが、先に書いた通り、
そもそものExistsPutToの役割はstd::ostream &lt;&lt;
tができるかどうかの診断であることを思い出せば、
下記のように、もっとシンプルに実装できることに気づくだろう。</p>
<div class="sourceCode" id="cb327"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb327-1"><a href="#cb327-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_type_traits.h 192</span></span>
<span id="cb327-2"><a href="#cb327-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb327-3"><a href="#cb327-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> Nstd <span class="op">{</span></span>
<span id="cb327-4"><a href="#cb327-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb327-5"><a href="#cb327-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span><span class="op">,</span> <span class="kw">typename</span> <span class="op">=</span> <span class="bu">std::</span>ostream<span class="op">&amp;&gt;</span></span>
<span id="cb327-6"><a href="#cb327-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> ExistsPutTo <span class="op">:</span> <span class="bu">std::</span>false_type<span class="op"> {</span></span>
<span id="cb327-7"><a href="#cb327-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb327-8"><a href="#cb327-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb327-9"><a href="#cb327-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb327-10"><a href="#cb327-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> ExistsPutTo<span class="op">&lt;</span>T<span class="op">,</span> <span class="kw">decltype</span><span class="op">(</span><span class="bu">std::</span>declval<span class="op">&lt;</span><span class="bu">std::</span>ostream<span class="op">&amp;&gt;()</span> <span class="op">&lt;&lt;</span> <span class="bu">std::</span>declval<span class="op">&lt;</span>T<span class="op">&gt;())&gt;</span></span>
<span id="cb327-11"><a href="#cb327-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">:</span> <span class="bu">std::</span>true_type<span class="op"> {</span></span>
<span id="cb327-12"><a href="#cb327-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb327-13"><a href="#cb327-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb327-14"><a href="#cb327-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb327-15"><a href="#cb327-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> ExistsPutToV<span class="op">{</span>ExistsPutTo<span class="op">&lt;</span>T<span class="op">&gt;::</span>value<span class="op">};</span></span>
<span id="cb327-16"><a href="#cb327-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace Nstd</span></span></code></pre></div>
<p>単体テストは下記のようになる。</p>
<div class="sourceCode" id="cb328"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb328-1"><a href="#cb328-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_type_traits_ut.cpp 111</span></span>
<span id="cb328-2"><a href="#cb328-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb328-3"><a href="#cb328-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>Nstd<span class="op">::</span>ExistsPutToV<span class="op">&lt;</span><span class="dt">bool</span><span class="op">&gt;);</span></span>
<span id="cb328-4"><a href="#cb328-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>Nstd<span class="op">::</span>ExistsPutToV<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;);</span></span>
<span id="cb328-5"><a href="#cb328-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>Nstd<span class="op">::</span>ExistsPutToV<span class="op">&lt;</span><span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;&gt;);</span></span>
<span id="cb328-6"><a href="#cb328-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>Nstd<span class="op">::</span>ExistsPutToV<span class="op">&lt;</span><span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;*&gt;);</span></span>
<span id="cb328-7"><a href="#cb328-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>Nstd<span class="op">::</span>ExistsPutToV<span class="op">&lt;</span>test_class_exits_put_to<span class="op">&gt;);</span></span>
<span id="cb328-8"><a href="#cb328-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>Nstd<span class="op">::</span>ExistsPutToV<span class="op">&lt;</span>test_class_not_exits_put_to<span class="op">&gt;);</span></span>
<span id="cb328-9"><a href="#cb328-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>Nstd<span class="op">::</span>ExistsPutToV<span class="op">&lt;</span>test_class_not_exits_put_to<span class="op">[</span><span class="dv">3</span><span class="op">]&gt;);</span></span></code></pre></div>
<h4 id="valuetypeの実装">ValueTypeの実装 <a id="SS_3_3_5_9"></a></h4>
<p>下記で示す通り、</p>
<div class="sourceCode" id="cb329"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb329-1"><a href="#cb329-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_type_traits_ut.cpp 129</span></span>
<span id="cb329-2"><a href="#cb329-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-3"><a href="#cb329-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> T <span class="op">{};</span></span>
<span id="cb329-4"><a href="#cb329-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-5"><a href="#cb329-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>ostream<span class="op">&amp;</span> <span class="kw">operator</span><span class="op">&lt;&lt;(</span><span class="bu">std::</span>ostream<span class="op">&amp;</span> os<span class="op">,</span> <span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;</span> <span class="at">const</span><span class="op">&amp;</span> x<span class="op">)</span></span>
<span id="cb329-6"><a href="#cb329-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb329-7"><a href="#cb329-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> os <span class="op">&lt;&lt;</span> <span class="st">&quot;T:&quot;</span> <span class="op">&lt;&lt;</span> x<span class="op">.</span>size<span class="op">();</span></span>
<span id="cb329-8"><a href="#cb329-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb329-9"><a href="#cb329-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-10"><a href="#cb329-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>ostream<span class="op">&amp;</span> <span class="kw">operator</span><span class="op">&lt;&lt;(</span><span class="bu">std::</span>ostream<span class="op">&amp;,</span> T <span class="at">const</span><span class="op">&amp;)</span> <span class="op">=</span> <span class="kw">delete</span><span class="op">;</span></span>
<span id="cb329-11"><a href="#cb329-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-12"><a href="#cb329-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>Nstd<span class="op">::</span>ExistsPutToV<span class="op">&lt;</span>T<span class="op">&gt;);</span>              <span class="co">// std::cout &lt;&lt; T{} はできない</span></span>
<span id="cb329-13"><a href="#cb329-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>Nstd<span class="op">::</span>ExistsPutToV<span class="op">&lt;</span><span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;&gt;);</span>  <span class="co">// std::cout &lt;&lt; std::vector&lt;T&gt;{} はできる</span></span>
<span id="cb329-14"><a href="#cb329-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>Nstd<span class="op">::</span>ExistsPutToV<span class="op">&lt;</span>T<span class="op">[</span><span class="dv">3</span><span class="op">]&gt;);</span>            <span class="co">// std::cout &lt;&lt; T[3]{} はできる</span></span></code></pre></div>
<p>型Xが与えれ、その形式が、</p>
<ul>
<li>クラステンプレートCとその型パラメータTにより、C&lt;T&gt;</li>
<li>型Tと定数整数Nにより、T[N]</li>
</ul>
<p>のような場合、ExistsPutToV&lt;X&gt;がtrueであっても、ExistsPutToV&lt;T&gt;の真偽はわからない。
従って上記のようなTに対して、ExistsPutToV&lt;T&gt;がtrueかどうかを診断するためには、
XからTを導出することが必要になる。ここでは、そのようなメタ関数ValueTypeの実装を考える。
このValueTypeは上記のX、Tに対して、</p>
<div class="sourceCode" id="cb330"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb330-1"><a href="#cb330-1" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>is_same<span class="op">&lt;</span>ValueType<span class="op">&lt;</span>X<span class="op">&gt;::</span>type<span class="op">,</span> T<span class="op">&gt;::</span>value <span class="op">==</span> <span class="kw">true</span></span></code></pre></div>
<p>となるような機能を持たなければならないことは明らかだろう。
その他の機能については実装しながら決定していく。</p>
<p>一見、難しそうなテンプレートを作るコツは、条件を絞って少しずつ作っていくことである。
いきなり大量のテンプレートを書いてしまうと、
その何十倍ものコンパイルエラーに打ちのめされること必至である。</p>
<p>ということで、まずは、1次元の配列に対してのみ動作するValueTypeの実装を示す
(下記で使用するstd::remove_extent_t&lt;T&gt;は、テンプレートパラメータが配列だった場合に、
その次元を一つだけ除去するメタ関数である)。</p>
<div class="sourceCode" id="cb331"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb331-1"><a href="#cb331-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/value_type_ut.cpp 14</span></span>
<span id="cb331-2"><a href="#cb331-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb331-3"><a href="#cb331-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">,</span> <span class="kw">typename</span> <span class="op">=</span> <span class="dt">void</span><span class="op">&gt;</span></span>
<span id="cb331-4"><a href="#cb331-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> ValueType <span class="op">{</span></span>
<span id="cb331-5"><a href="#cb331-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> type <span class="op">=</span> <span class="dt">void</span><span class="op">;</span></span>
<span id="cb331-6"><a href="#cb331-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb331-7"><a href="#cb331-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb331-8"><a href="#cb331-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb331-9"><a href="#cb331-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> ValueType<span class="op">&lt;</span>T<span class="op">,</span> <span class="kw">typename</span> <span class="bu">std::</span>enable_if_t<span class="op">&lt;</span><span class="bu">std::</span>is_array_v<span class="op">&lt;</span>T<span class="op">&gt;&gt;&gt;</span> <span class="op">{</span></span>
<span id="cb331-10"><a href="#cb331-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> type <span class="op">=</span> <span class="kw">typename</span> <span class="bu">std::</span>remove_extent_t<span class="op">&lt;</span>T<span class="op">&gt;;</span></span>
<span id="cb331-11"><a href="#cb331-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb331-12"><a href="#cb331-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb331-13"><a href="#cb331-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb331-14"><a href="#cb331-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> ValueTypeT <span class="op">=</span> <span class="kw">typename</span> ValueType<span class="op">&lt;</span>T<span class="op">&gt;::</span>type<span class="op">;</span></span></code></pre></div>
<p>このコードは問題なく動作するが、下記の通り、2次元配列に対するValueType::typeは1次元配列となる。</p>
<div class="sourceCode" id="cb332"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb332-1"><a href="#cb332-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/value_type_ut.cpp 32</span></span>
<span id="cb332-2"><a href="#cb332-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-3"><a href="#cb332-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> ValueTypeT<span class="op">&lt;</span><span class="dt">int</span><span class="op">[</span><span class="dv">1</span><span class="op">]&gt;&gt;);</span></span>
<span id="cb332-4"><a href="#cb332-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="dt">void</span><span class="op">,</span> ValueTypeT<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;&gt;);</span></span>
<span id="cb332-5"><a href="#cb332-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">[</span><span class="dv">2</span><span class="op">],</span> ValueTypeT<span class="op">&lt;</span><span class="dt">int</span><span class="op">[</span><span class="dv">1</span><span class="op">][</span><span class="dv">2</span><span class="op">]&gt;&gt;);</span></span></code></pre></div>
<p>これを多次元配列に拡張する前に、配列の次元をValueType::Nestで返す機能を追加することにすると、
コードは下記のようになるだろう。</p>
<div class="sourceCode" id="cb333"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb333-1"><a href="#cb333-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/value_type_ut.cpp 44</span></span>
<span id="cb333-2"><a href="#cb333-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-3"><a href="#cb333-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">,</span> <span class="kw">typename</span> <span class="op">=</span> <span class="dt">void</span><span class="op">&gt;</span></span>
<span id="cb333-4"><a href="#cb333-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> ValueType <span class="op">{</span></span>
<span id="cb333-5"><a href="#cb333-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> type <span class="op">=</span> <span class="dt">void</span><span class="op">;</span></span>
<span id="cb333-6"><a href="#cb333-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="kw">constexpr</span> <span class="dt">size_t</span> Nest<span class="op">{</span><span class="dv">0</span><span class="op">};</span></span>
<span id="cb333-7"><a href="#cb333-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb333-8"><a href="#cb333-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-9"><a href="#cb333-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb333-10"><a href="#cb333-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> ValueType<span class="op">&lt;</span>T<span class="op">,</span> <span class="kw">typename</span> <span class="bu">std::</span>enable_if_t<span class="op">&lt;</span><span class="bu">std::</span>is_array_v<span class="op">&lt;</span>T<span class="op">&gt;&gt;&gt;</span> <span class="op">{</span></span>
<span id="cb333-11"><a href="#cb333-11" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> type <span class="op">=</span> <span class="kw">typename</span> <span class="bu">std::</span>remove_extent_t<span class="op">&lt;</span>T<span class="op">&gt;;</span></span>
<span id="cb333-12"><a href="#cb333-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-13"><a href="#cb333-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="kw">constexpr</span> <span class="dt">size_t</span> Nest<span class="op">{</span>ValueType<span class="op">&lt;</span>type<span class="op">&gt;::</span>Nest <span class="op">+</span> <span class="dv">1</span><span class="op">};</span></span>
<span id="cb333-14"><a href="#cb333-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb333-15"><a href="#cb333-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-16"><a href="#cb333-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb333-17"><a href="#cb333-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> ValueTypeT <span class="op">=</span> <span class="kw">typename</span> ValueType<span class="op">&lt;</span>T<span class="op">&gt;::</span>type<span class="op">;</span></span></code></pre></div>
<p>動作は下記のようになる。</p>
<div class="sourceCode" id="cb334"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb334-1"><a href="#cb334-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/value_type_ut.cpp 69</span></span>
<span id="cb334-2"><a href="#cb334-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb334-3"><a href="#cb334-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="dv">0</span> <span class="op">==</span> ValueType<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;::</span>Nest<span class="op">);</span></span>
<span id="cb334-4"><a href="#cb334-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="dv">1</span> <span class="op">==</span> ValueType<span class="op">&lt;</span><span class="dt">int</span><span class="op">[</span><span class="dv">1</span><span class="op">]&gt;::</span>Nest<span class="op">);</span></span>
<span id="cb334-5"><a href="#cb334-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="dv">2</span> <span class="op">==</span> ValueType<span class="op">&lt;</span><span class="dt">int</span><span class="op">[</span><span class="dv">1</span><span class="op">][</span><span class="dv">2</span><span class="op">]&gt;::</span>Nest<span class="op">);</span></span></code></pre></div>
<p>ここで、下記のような仕様をもつValueType::type_n&lt;N&gt;を考える。</p>
<pre><code>    ValueType&lt;int[1][2][3]&gt;::type_n&lt;0&gt;が表す型は、int[1][2][3]
    ValueType&lt;int[1][2][3]&gt;::type_n&lt;1&gt;が表す型は、int[2][3]
    ValueType&lt;int[1][2][3]&gt;::type_n&lt;2&gt;が表す型は、int[3]
    ValueType&lt;int[1][2][3]&gt;::type_n&lt;3&gt;が表す型は、int</code></pre>
<p>ValueType::type_n&lt;N&gt;は玉ねぎの皮を一枚ずつむくようなメンバエイリアステンプレートになる。
プライマリの実装は以下のようになる。</p>
<div class="sourceCode" id="cb336"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb336-1"><a href="#cb336-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/value_type_ut.cpp 82</span></span>
<span id="cb336-2"><a href="#cb336-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb336-3"><a href="#cb336-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">,</span> <span class="kw">typename</span> <span class="op">=</span> <span class="dt">void</span><span class="op">&gt;</span></span>
<span id="cb336-4"><a href="#cb336-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> ValueType <span class="op">{</span></span>
<span id="cb336-5"><a href="#cb336-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> type <span class="op">=</span> <span class="dt">void</span><span class="op">;</span></span>
<span id="cb336-6"><a href="#cb336-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="kw">constexpr</span> <span class="dt">size_t</span> Nest<span class="op">{</span><span class="dv">0</span><span class="op">};</span></span>
<span id="cb336-7"><a href="#cb336-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb336-8"><a href="#cb336-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">template</span> <span class="op">&lt;</span><span class="dt">size_t</span> N<span class="op">&gt;</span></span>
<span id="cb336-9"><a href="#cb336-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> type_n <span class="op">=</span> <span class="kw">typename</span> <span class="bu">std::</span>conditional_t<span class="op">&lt;</span>N <span class="op">==</span> <span class="dv">0</span><span class="op">,</span> T<span class="op">,</span> <span class="dt">void</span><span class="op">&gt;;</span></span>
<span id="cb336-10"><a href="#cb336-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>Nが非0の場合、Value::type_n&lt;N&gt;はvoidになる仕様にした。</p>
<p>配列に対する特殊化は以下のようになる。</p>
<div class="sourceCode" id="cb337"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb337-1"><a href="#cb337-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/value_type_ut.cpp 94</span></span>
<span id="cb337-2"><a href="#cb337-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-3"><a href="#cb337-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">,</span> <span class="dt">size_t</span> N<span class="op">&gt;</span></span>
<span id="cb337-4"><a href="#cb337-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> ConditionalValueTypeN <span class="op">{</span></span>
<span id="cb337-5"><a href="#cb337-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> type <span class="op">=</span> <span class="kw">typename</span> <span class="bu">std::</span>conditional_t<span class="op">&lt;</span></span>
<span id="cb337-6"><a href="#cb337-6" aria-hidden="true" tabindex="-1"></a>            ValueType<span class="op">&lt;</span>T<span class="op">&gt;::</span>Nest <span class="op">!=</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb337-7"><a href="#cb337-7" aria-hidden="true" tabindex="-1"></a>            <span class="kw">typename</span> ValueType<span class="op">&lt;</span><span class="kw">typename</span> ValueType<span class="op">&lt;</span>T<span class="op">&gt;::</span>type<span class="op">&gt;::</span><span class="kw">template</span> type_n<span class="op">&lt;</span>N <span class="op">-</span> <span class="dv">1</span><span class="op">&gt;,</span> T<span class="op">&gt;;</span></span>
<span id="cb337-8"><a href="#cb337-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb337-9"><a href="#cb337-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-10"><a href="#cb337-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb337-11"><a href="#cb337-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> ConditionalValueTypeN<span class="op">&lt;</span>T<span class="op">,</span> <span class="dv">0</span><span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb337-12"><a href="#cb337-12" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> type <span class="op">=</span> T<span class="op">;</span></span>
<span id="cb337-13"><a href="#cb337-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb337-14"><a href="#cb337-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-15"><a href="#cb337-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb337-16"><a href="#cb337-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> ValueType<span class="op">&lt;</span>T<span class="op">,</span> <span class="kw">typename</span> <span class="bu">std::</span>enable_if_t<span class="op">&lt;</span><span class="bu">std::</span>is_array_v<span class="op">&lt;</span>T<span class="op">&gt;&gt;&gt;</span> <span class="op">{</span></span>
<span id="cb337-17"><a href="#cb337-17" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> type <span class="op">=</span> <span class="kw">typename</span> <span class="bu">std::</span>remove_extent_t<span class="op">&lt;</span>T<span class="op">&gt;;</span></span>
<span id="cb337-18"><a href="#cb337-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-19"><a href="#cb337-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="kw">constexpr</span> <span class="dt">size_t</span> Nest<span class="op">{</span>ValueType<span class="op">&lt;</span>type<span class="op">&gt;::</span>Nest <span class="op">+</span> <span class="dv">1</span><span class="op">};</span></span>
<span id="cb337-20"><a href="#cb337-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-21"><a href="#cb337-21" aria-hidden="true" tabindex="-1"></a>        <span class="kw">template</span> <span class="op">&lt;</span><span class="dt">size_t</span> N<span class="op">&gt;</span></span>
<span id="cb337-22"><a href="#cb337-22" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> type_n <span class="op">=</span> <span class="kw">typename</span> ConditionalValueTypeN<span class="op">&lt;</span>T<span class="op">,</span> N<span class="op">&gt;::</span>type<span class="op">;</span></span>
<span id="cb337-23"><a href="#cb337-23" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb337-24"><a href="#cb337-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-25"><a href="#cb337-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb337-26"><a href="#cb337-26" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> ValueTypeT <span class="op">=</span> <span class="kw">typename</span> ValueType<span class="op">&lt;</span>T<span class="op">&gt;::</span>type<span class="op">;</span></span>
<span id="cb337-27"><a href="#cb337-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-28"><a href="#cb337-28" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">,</span> <span class="dt">size_t</span> N<span class="op">&gt;</span></span>
<span id="cb337-29"><a href="#cb337-29" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> ValueTypeT_n <span class="op">=</span> <span class="kw">typename</span> ValueType<span class="op">&lt;</span>T<span class="op">&gt;::</span><span class="kw">template</span> type_n<span class="op">&lt;</span>N<span class="op">&gt;;</span></span></code></pre></div>
<p>下記コードのコンパイル時の展開を説明することで、上記の解説を行う。</p>
<div class="sourceCode" id="cb338"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb338-1"><a href="#cb338-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/value_type_ut.cpp 128</span></span>
<span id="cb338-2"><a href="#cb338-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb338-3"><a href="#cb338-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> T <span class="op">=</span> ValueTypeT_n<span class="op">&lt;</span><span class="dt">int</span><span class="op">[</span><span class="dv">1</span><span class="op">][</span><span class="dv">2</span><span class="op">][</span><span class="dv">3</span><span class="op">],</span> <span class="dv">3</span><span class="op">&gt;;</span></span></code></pre></div>
<ol type="1">
<li>ValueTypeのテンプレートパラメータが配列であるため、配列への特殊化であるValueTypeが選択され、
下記の疑似コードのように展開される。</li>
</ol>
<div class="sourceCode" id="cb339"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb339-1"><a href="#cb339-1" aria-hidden="true" tabindex="-1"></a>    ValueType<span class="op">&lt;</span><span class="dt">int</span><span class="op">[</span><span class="dv">1</span><span class="op">][</span><span class="dv">2</span><span class="op">][</span><span class="dv">3</span><span class="op">],</span> <span class="dt">void</span><span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb339-2"><a href="#cb339-2" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> type <span class="op">=</span> <span class="dt">int</span><span class="op">[</span><span class="dv">2</span><span class="op">][</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb339-3"><a href="#cb339-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="kw">constexpr</span> <span class="dt">size_t</span> Nest <span class="op">=</span> <span class="op">...</span></span>
<span id="cb339-4"><a href="#cb339-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> type_n <span class="op">=</span> ConditionalValueTypeN<span class="op">&lt;</span><span class="dt">int</span><span class="op">[</span><span class="dv">1</span><span class="op">][</span><span class="dv">2</span><span class="op">][</span><span class="dv">3</span><span class="op">],</span> <span class="dv">3</span><span class="op">&gt;::</span>type<span class="op">;</span></span>
<span id="cb339-5"><a href="#cb339-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<ol start="2" type="1">
<li>ConditionalValueTypeNは下記のように展開される。
なお、下記のコードの中のtype_n前で使われているキーワードtemplateは、
「外部のクラステンプレートのメンバテンプレートにアクセスする」際に必要になる記法である。</li>
</ol>
<div class="sourceCode" id="cb340"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb340-1"><a href="#cb340-1" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> ConditionalValueTypeN<span class="op">&lt;</span><span class="dt">int</span><span class="op">[</span><span class="dv">1</span><span class="op">][</span><span class="dv">2</span><span class="op">][</span><span class="dv">3</span><span class="op">],</span> <span class="dv">3</span><span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb340-2"><a href="#cb340-2" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> type <span class="op">=</span> <span class="kw">typename</span> <span class="bu">std::</span>conditional<span class="op">&lt;</span></span>
<span id="cb340-3"><a href="#cb340-3" aria-hidden="true" tabindex="-1"></a>            <span class="kw">true</span><span class="op">,</span>   <span class="co">// ValueType&lt;int[1][2][3]&gt;::Nest == 3であるためtrue</span></span>
<span id="cb340-4"><a href="#cb340-4" aria-hidden="true" tabindex="-1"></a>            ValueType<span class="op">&lt;</span>ValueType<span class="op">&lt;</span><span class="dt">int</span><span class="op">[</span><span class="dv">1</span><span class="op">][</span><span class="dv">2</span><span class="op">][</span><span class="dv">3</span><span class="op">]&gt;::</span>type<span class="op">&gt;::</span><span class="kw">template</span> type_n<span class="op">&lt;</span><span class="dv">3</span> <span class="op">-</span> <span class="dv">1</span><span class="op">&gt;,</span></span>
<span id="cb340-5"><a href="#cb340-5" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span><span class="op">[</span><span class="dv">1</span><span class="op">][</span><span class="dv">2</span><span class="op">][</span><span class="dv">3</span><span class="op">]&gt;::</span>type<span class="op">;</span></span>
<span id="cb340-6"><a href="#cb340-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<ol start="3" type="1">
<li>ValueType&lt;int[1][2][3]&gt;::typeは一枚皮をむいたint[2][3]なので、
上記はさらに下記のように展開される。</li>
</ol>
<div class="sourceCode" id="cb341"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb341-1"><a href="#cb341-1" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> ConditionalValueTypeN<span class="op">&lt;</span><span class="dt">int</span><span class="op">[</span><span class="dv">1</span><span class="op">][</span><span class="dv">2</span><span class="op">][</span><span class="dv">3</span><span class="op">],</span> <span class="dv">3</span><span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb341-2"><a href="#cb341-2" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> type <span class="op">=</span> ValueType<span class="op">&lt;</span><span class="dt">int</span><span class="op">[</span><span class="dv">2</span><span class="op">][</span><span class="dv">3</span><span class="op">]&gt;::</span><span class="kw">template</span> type_n<span class="op">&lt;</span><span class="dv">2</span><span class="op">&gt;;</span></span>
<span id="cb341-3"><a href="#cb341-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<ol start="4" type="1">
<li><p>ConditionalValueTypeN&lt;int[1][2][3],
3&gt;::typeを展開するため、 ValueType&lt;int[2][3]&gt;::template
type_n&lt;2&gt;の展開が上記1 - 3のように繰り返される。 この繰り返しはN
== 0になるまで続く。</p></li>
<li><p>3回の皮むきによりN == 0となる。
この時点で、下記の特殊化が選択されるため再帰は終了し、ConditionalValueTypeN&lt;&gt;::typeはintとなる。</p></li>
</ol>
<div class="sourceCode" id="cb342"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb342-1"><a href="#cb342-1" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> ConditionalValueTypeN<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dv">0</span><span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb342-2"><a href="#cb342-2" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> type <span class="op">=</span> <span class="dt">int</span><span class="op">;</span></span>
<span id="cb342-3"><a href="#cb342-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<ol start="6" type="1">
<li>1 - 5により最終的には下記のように展開される。</li>
</ol>
<div class="sourceCode" id="cb343"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb343-1"><a href="#cb343-1" aria-hidden="true" tabindex="-1"></a>    ValueType<span class="op">&lt;</span><span class="dt">int</span><span class="op">[</span><span class="dv">1</span><span class="op">][</span><span class="dv">2</span><span class="op">][</span><span class="dv">3</span><span class="op">]&gt;</span> <span class="op">{</span></span>
<span id="cb343-2"><a href="#cb343-2" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> type <span class="op">=</span> <span class="dt">int</span><span class="op">[</span><span class="dv">2</span><span class="op">][</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb343-3"><a href="#cb343-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="kw">constexpr</span> <span class="dt">size_t</span> Nest <span class="op">=</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb343-4"><a href="#cb343-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> type_n <span class="op">=</span> <span class="dt">int</span><span class="op">;</span></span>
<span id="cb343-5"><a href="#cb343-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>単体テストは下記のようになる。</p>
<div class="sourceCode" id="cb344"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb344-1"><a href="#cb344-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/value_type_ut.cpp 136</span></span>
<span id="cb344-2"><a href="#cb344-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3"><a href="#cb344-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> T <span class="op">=</span> <span class="dt">int</span><span class="op">[</span><span class="dv">1</span><span class="op">][</span><span class="dv">2</span><span class="op">][</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb344-4"><a href="#cb344-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-5"><a href="#cb344-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>ValueType<span class="op">&lt;</span>T<span class="op">&gt;::</span>Nest <span class="op">==</span> <span class="dv">3</span><span class="op">);</span></span>
<span id="cb344-6"><a href="#cb344-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">[</span><span class="dv">1</span><span class="op">][</span><span class="dv">2</span><span class="op">][</span><span class="dv">3</span><span class="op">],</span> ValueTypeT_n<span class="op">&lt;</span>T<span class="op">,</span> <span class="dv">0</span><span class="op">&gt;&gt;);</span></span>
<span id="cb344-7"><a href="#cb344-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">[</span><span class="dv">2</span><span class="op">][</span><span class="dv">3</span><span class="op">],</span> ValueTypeT_n<span class="op">&lt;</span>T<span class="op">,</span> <span class="dv">1</span><span class="op">&gt;&gt;);</span></span>
<span id="cb344-8"><a href="#cb344-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">[</span><span class="dv">3</span><span class="op">],</span> ValueTypeT_n<span class="op">&lt;</span>T<span class="op">,</span> <span class="dv">2</span><span class="op">&gt;&gt;);</span></span>
<span id="cb344-9"><a href="#cb344-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> ValueTypeT_n<span class="op">&lt;</span>T<span class="op">,</span> <span class="dv">3</span><span class="op">&gt;&gt;);</span></span>
<span id="cb344-10"><a href="#cb344-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="dt">void</span><span class="op">,</span> ValueTypeT_n<span class="op">&lt;</span>T<span class="op">,</span> <span class="dv">4</span><span class="op">&gt;&gt;);</span></span>
<span id="cb344-11"><a href="#cb344-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="dt">void</span><span class="op">,</span> ValueTypeT_n<span class="op">&lt;</span>T<span class="op">,</span> <span class="dv">5</span><span class="op">&gt;&gt;);</span></span></code></pre></div>
<p>また、ValueType::NestとValueType::type_n&lt;&gt;の関係に注目すれば、
上記エイリアスTに対して下記が成立する。</p>
<div class="sourceCode" id="cb345"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb345-1"><a href="#cb345-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/value_type_ut.cpp 148</span></span>
<span id="cb345-2"><a href="#cb345-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb345-3"><a href="#cb345-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> ValueTypeT_n<span class="op">&lt;</span>T<span class="op">,</span> ValueType<span class="op">&lt;</span>T<span class="op">&gt;::</span>Nest<span class="op">&gt;&gt;);</span></span></code></pre></div>
<p>このテンプレートにコンテナが渡された時の特殊化を与えることができればValueTypeは完成するが、
その前に名前の整理をした方が良いため、下記のような変更を行う。</p>
<ul>
<li>この例では、typeは配列が直接保持する型を表すが、
この名前は慣例的にメタ関数の戻り型を表すことが多いため、現在の仕様では混乱を招く。
また名は体を表す方が良いため、typeを改めtype_directとする。</li>
<li>ValueTypeの結果は、上記のようにNestとtype_nの組み合わせで得られるが、このままでは使い勝手が悪い。
慣例に従いこれをtypeとする。</li>
<li>ConditionalValueTypeNは実装の詳細であるため外部から使われたくない。
これまで通り、名前空間Inner_で定義し、名前を小文字と_で生成する。</li>
</ul>
<p>これによりValueTypeは下記のようになる。</p>
<div class="sourceCode" id="cb346"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb346-1"><a href="#cb346-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/value_type_ut.cpp 182</span></span>
<span id="cb346-2"><a href="#cb346-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-3"><a href="#cb346-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">,</span> <span class="kw">typename</span> <span class="op">=</span> <span class="dt">void</span><span class="op">&gt;</span></span>
<span id="cb346-4"><a href="#cb346-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> ValueType <span class="op">{</span></span>
<span id="cb346-5"><a href="#cb346-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> type_direct <span class="op">=</span> <span class="dt">void</span><span class="op">;</span></span>
<span id="cb346-6"><a href="#cb346-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-7"><a href="#cb346-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="kw">constexpr</span> <span class="dt">size_t</span> Nest<span class="op">{</span><span class="dv">0</span><span class="op">};</span></span>
<span id="cb346-8"><a href="#cb346-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-9"><a href="#cb346-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">template</span> <span class="op">&lt;</span><span class="dt">size_t</span> N<span class="op">&gt;</span></span>
<span id="cb346-10"><a href="#cb346-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> type_n <span class="op">=</span> <span class="kw">typename</span> <span class="bu">std::</span>conditional_t<span class="op">&lt;</span>N <span class="op">==</span> <span class="dv">0</span><span class="op">,</span> T<span class="op">,</span> <span class="dt">void</span><span class="op">&gt;;</span></span>
<span id="cb346-11"><a href="#cb346-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-12"><a href="#cb346-12" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> type <span class="op">=</span> type_n<span class="op">&lt;</span>Nest<span class="op">&gt;;</span></span>
<span id="cb346-13"><a href="#cb346-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb346-14"><a href="#cb346-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-15"><a href="#cb346-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> Inner_ <span class="op">{</span></span>
<span id="cb346-16"><a href="#cb346-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-17"><a href="#cb346-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">,</span> <span class="dt">size_t</span> N<span class="op">&gt;</span></span>
<span id="cb346-18"><a href="#cb346-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> conditional_value_type_n <span class="op">{</span></span>
<span id="cb346-19"><a href="#cb346-19" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> type <span class="op">=</span> <span class="kw">typename</span> <span class="bu">std::</span>conditional_t<span class="op">&lt;</span></span>
<span id="cb346-20"><a href="#cb346-20" aria-hidden="true" tabindex="-1"></a>            ValueType<span class="op">&lt;</span>T<span class="op">&gt;::</span>Nest <span class="op">!=</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb346-21"><a href="#cb346-21" aria-hidden="true" tabindex="-1"></a>            <span class="kw">typename</span> ValueType<span class="op">&lt;</span><span class="kw">typename</span> ValueType<span class="op">&lt;</span>T<span class="op">&gt;::</span>type_direct<span class="op">&gt;::</span><span class="kw">template</span> type_n<span class="op">&lt;</span>N <span class="op">-</span> <span class="dv">1</span><span class="op">&gt;,</span> T<span class="op">&gt;;</span></span>
<span id="cb346-22"><a href="#cb346-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb346-23"><a href="#cb346-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-24"><a href="#cb346-24" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb346-25"><a href="#cb346-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> conditional_value_type_n<span class="op">&lt;</span>T<span class="op">,</span> <span class="dv">0</span><span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb346-26"><a href="#cb346-26" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> type <span class="op">=</span> T<span class="op">;</span></span>
<span id="cb346-27"><a href="#cb346-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb346-28"><a href="#cb346-28" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace Inner_</span></span>
<span id="cb346-29"><a href="#cb346-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-30"><a href="#cb346-30" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb346-31"><a href="#cb346-31" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> ValueType<span class="op">&lt;</span>T<span class="op">,</span> <span class="kw">typename</span> <span class="bu">std::</span>enable_if_t<span class="op">&lt;</span><span class="bu">std::</span>is_array_v<span class="op">&lt;</span>T<span class="op">&gt;&gt;&gt;</span> <span class="op">{</span></span>
<span id="cb346-32"><a href="#cb346-32" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> type_direct <span class="op">=</span> <span class="kw">typename</span> <span class="bu">std::</span>remove_extent_t<span class="op">&lt;</span>T<span class="op">&gt;;</span></span>
<span id="cb346-33"><a href="#cb346-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-34"><a href="#cb346-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="kw">constexpr</span> <span class="dt">size_t</span> Nest<span class="op">{</span>ValueType<span class="op">&lt;</span>type_direct<span class="op">&gt;::</span>Nest <span class="op">+</span> <span class="dv">1</span><span class="op">};</span></span>
<span id="cb346-35"><a href="#cb346-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-36"><a href="#cb346-36" aria-hidden="true" tabindex="-1"></a>        <span class="kw">template</span> <span class="op">&lt;</span><span class="dt">size_t</span> N<span class="op">&gt;</span></span>
<span id="cb346-37"><a href="#cb346-37" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> type_n <span class="op">=</span> <span class="kw">typename</span> Inner_<span class="op">::</span>conditional_value_type_n<span class="op">&lt;</span>T<span class="op">,</span> N<span class="op">&gt;::</span>type<span class="op">;</span></span>
<span id="cb346-38"><a href="#cb346-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-39"><a href="#cb346-39" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> type <span class="op">=</span> type_n<span class="op">&lt;</span>Nest<span class="op">&gt;;</span></span>
<span id="cb346-40"><a href="#cb346-40" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb346-41"><a href="#cb346-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-42"><a href="#cb346-42" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb346-43"><a href="#cb346-43" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> ValueTypeT <span class="op">=</span> <span class="kw">typename</span> ValueType<span class="op">&lt;</span>T<span class="op">&gt;::</span>type<span class="op">;</span></span>
<span id="cb346-44"><a href="#cb346-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-45"><a href="#cb346-45" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">,</span> <span class="dt">size_t</span> N<span class="op">&gt;</span></span>
<span id="cb346-46"><a href="#cb346-46" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> ValueTypeT_n <span class="op">=</span> <span class="kw">typename</span> ValueType<span class="op">&lt;</span>T<span class="op">&gt;::</span><span class="kw">template</span> type_n<span class="op">&lt;</span>N<span class="op">&gt;;</span></span></code></pre></div>
<p>準備は整ったので上記のValueTypeに下記のようなコンテナ用特殊化を追加する。</p>
<div class="sourceCode" id="cb347"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb347-1"><a href="#cb347-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/value_type_ut.cpp 276</span></span>
<span id="cb347-2"><a href="#cb347-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb347-3"><a href="#cb347-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> Inner_ <span class="op">{</span></span>
<span id="cb347-4"><a href="#cb347-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb347-5"><a href="#cb347-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Tが配列でなく、且つIsRrangeV&lt;T&gt;が真ならばコンテナと診断する</span></span>
<span id="cb347-6"><a href="#cb347-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb347-7"><a href="#cb347-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> is_container_v<span class="op">{</span>Nstd<span class="op">::</span>IsRangeV<span class="op">&lt;</span>T<span class="op">&gt;</span> <span class="op">&amp;&amp;</span> <span class="op">!</span><span class="bu">std::</span>is_array_v<span class="op">&lt;</span>T<span class="op">&gt;};</span></span>
<span id="cb347-8"><a href="#cb347-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace Inner_</span></span>
<span id="cb347-9"><a href="#cb347-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb347-10"><a href="#cb347-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb347-11"><a href="#cb347-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> ValueType<span class="op">&lt;</span>T<span class="op">,</span> <span class="kw">typename</span> <span class="bu">std::</span>enable_if_t<span class="op">&lt;</span>Inner_<span class="op">::</span>is_container_v<span class="op">&lt;</span>T<span class="op">&gt;&gt;&gt;</span> <span class="op">{</span></span>
<span id="cb347-12"><a href="#cb347-12" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> type_direct <span class="op">=</span> <span class="kw">typename</span> T<span class="op">::</span><span class="dt">value_type</span><span class="op">;</span></span>
<span id="cb347-13"><a href="#cb347-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb347-14"><a href="#cb347-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="kw">constexpr</span> <span class="dt">size_t</span> Nest<span class="op">{</span>ValueType<span class="op">&lt;</span>type_direct<span class="op">&gt;::</span>Nest <span class="op">+</span> <span class="dv">1</span><span class="op">};</span></span>
<span id="cb347-15"><a href="#cb347-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb347-16"><a href="#cb347-16" aria-hidden="true" tabindex="-1"></a>        <span class="kw">template</span> <span class="op">&lt;</span><span class="dt">size_t</span> N<span class="op">&gt;</span></span>
<span id="cb347-17"><a href="#cb347-17" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> type_n <span class="op">=</span> <span class="kw">typename</span> Inner_<span class="op">::</span>conditional_value_type_n<span class="op">&lt;</span>T<span class="op">,</span> N<span class="op">&gt;::</span>type<span class="op">;</span></span>
<span id="cb347-18"><a href="#cb347-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb347-19"><a href="#cb347-19" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> type <span class="op">=</span> type_n<span class="op">&lt;</span>Nest<span class="op">&gt;;</span></span>
<span id="cb347-20"><a href="#cb347-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb347-21"><a href="#cb347-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb347-22"><a href="#cb347-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb347-23"><a href="#cb347-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> ValueTypeT <span class="op">=</span> <span class="kw">typename</span> ValueType<span class="op">&lt;</span>T<span class="op">&gt;::</span>type<span class="op">;</span></span>
<span id="cb347-24"><a href="#cb347-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb347-25"><a href="#cb347-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">,</span> <span class="dt">size_t</span> N<span class="op">&gt;</span></span>
<span id="cb347-26"><a href="#cb347-26" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> ValueTypeT_n <span class="op">=</span> <span class="kw">typename</span> ValueType<span class="op">&lt;</span>T<span class="op">&gt;::</span><span class="kw">template</span> type_n<span class="op">&lt;</span>N<span class="op">&gt;;</span></span></code></pre></div>
<p>単体テストは下記のようになる。</p>
<div class="sourceCode" id="cb348"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb348-1"><a href="#cb348-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/value_type_ut.cpp 307</span></span>
<span id="cb348-2"><a href="#cb348-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb348-3"><a href="#cb348-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> T <span class="op">=</span> <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="bu">std::</span>list<span class="op">&lt;</span><span class="dt">int</span><span class="op">*&gt;[</span><span class="dv">3</span><span class="op">]&gt;;</span></span>
<span id="cb348-4"><a href="#cb348-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb348-5"><a href="#cb348-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">*,</span> ValueTypeT<span class="op">&lt;</span>T<span class="op">&gt;&gt;);</span></span>
<span id="cb348-6"><a href="#cb348-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb348-7"><a href="#cb348-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span>T<span class="op">,</span> ValueTypeT_n<span class="op">&lt;</span>T<span class="op">,</span> <span class="dv">0</span><span class="op">&gt;&gt;);</span></span>
<span id="cb348-8"><a href="#cb348-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="bu">std::</span>list<span class="op">&lt;</span><span class="dt">int</span><span class="op">*&gt;[</span><span class="dv">3</span><span class="op">],</span> ValueTypeT_n<span class="op">&lt;</span>T<span class="op">,</span> <span class="dv">1</span><span class="op">&gt;&gt;);</span></span>
<span id="cb348-9"><a href="#cb348-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="bu">std::</span>list<span class="op">&lt;</span><span class="dt">int</span><span class="op">*&gt;,</span> ValueTypeT_n<span class="op">&lt;</span>T<span class="op">,</span> <span class="dv">2</span><span class="op">&gt;&gt;);</span></span>
<span id="cb348-10"><a href="#cb348-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">*,</span> ValueTypeT_n<span class="op">&lt;</span>T<span class="op">,</span> <span class="dv">3</span><span class="op">&gt;&gt;);</span></span>
<span id="cb348-11"><a href="#cb348-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="dt">void</span><span class="op">,</span> ValueTypeT_n<span class="op">&lt;</span>T<span class="op">,</span> <span class="dv">4</span><span class="op">&gt;&gt;);</span></span></code></pre></div>
<p>最初のValueTypeには、その単純さとは不釣り合いな、やや複雑なSFINAE用のコードを記述をしたが、
ここまで来ればその理由は明らかだろう。
今回のように限定的な機能を作ってから、一般化して行く開発スタイルでも、
静的ディスパッチにはSFINAE等の汎用的手法を使った方が後の修正が少なく済むことが多い。
一方で、完成時にその静的ディスパッチが不要に複雑であると気づいた場合は、
リファクタリングを行い、コードを程よいレベルに留めなければならないことは言うまでもない。</p>
<p>ValueTypeの開発はまだ終わらない。静的ディスパッチは最初のカンが当り修正の必要はないと思うが、
「配列用特殊化とコンテナ用特殊化のほとんどがコードクローンになっている」という問題がある。
この程度のクローンは問題のないレベルであるとも言えるが、演習のため修正する。
また、合わせてTが配列かどうかを示すための定数IsBuiltinArrayも追加すると下記のようなコードになる。</p>
<div class="sourceCode" id="cb349"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb349-1"><a href="#cb349-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_type_traits.h 213</span></span>
<span id="cb349-2"><a href="#cb349-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-3"><a href="#cb349-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> Nstd <span class="op">{</span></span>
<span id="cb349-4"><a href="#cb349-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-5"><a href="#cb349-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">,</span> <span class="kw">typename</span> <span class="op">=</span> <span class="dt">void</span><span class="op">&gt;</span>  <span class="co">// ValueTypeのプライマリ</span></span>
<span id="cb349-6"><a href="#cb349-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> ValueType <span class="op">{</span></span>
<span id="cb349-7"><a href="#cb349-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> type_direct <span class="op">=</span> <span class="dt">void</span><span class="op">;</span></span>
<span id="cb349-8"><a href="#cb349-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-9"><a href="#cb349-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="kw">constexpr</span> <span class="dt">bool</span>   IsBuiltinArray<span class="op">{</span><span class="kw">false</span><span class="op">};</span></span>
<span id="cb349-10"><a href="#cb349-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="kw">constexpr</span> <span class="dt">size_t</span> Nest<span class="op">{</span><span class="dv">0</span><span class="op">};</span></span>
<span id="cb349-11"><a href="#cb349-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-12"><a href="#cb349-12" aria-hidden="true" tabindex="-1"></a>        <span class="kw">template</span> <span class="op">&lt;</span><span class="dt">size_t</span> N<span class="op">&gt;</span></span>
<span id="cb349-13"><a href="#cb349-13" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> type_n <span class="op">=</span> <span class="kw">typename</span> <span class="bu">std::</span>conditional_t<span class="op">&lt;</span>N <span class="op">==</span> <span class="dv">0</span><span class="op">,</span> T<span class="op">,</span> <span class="dt">void</span><span class="op">&gt;;</span></span>
<span id="cb349-14"><a href="#cb349-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-15"><a href="#cb349-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> type <span class="op">=</span> type_n<span class="op">&lt;</span>Nest<span class="op">&gt;;</span></span>
<span id="cb349-16"><a href="#cb349-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb349-17"><a href="#cb349-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-18"><a href="#cb349-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> Inner_ <span class="op">{</span></span>
<span id="cb349-19"><a href="#cb349-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-20"><a href="#cb349-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">,</span> <span class="dt">size_t</span> N<span class="op">&gt;</span></span>
<span id="cb349-21"><a href="#cb349-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> conditional_value_type_n <span class="op">{</span></span>
<span id="cb349-22"><a href="#cb349-22" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> type <span class="op">=</span> <span class="kw">typename</span> <span class="bu">std::</span>conditional_t<span class="op">&lt;</span></span>
<span id="cb349-23"><a href="#cb349-23" aria-hidden="true" tabindex="-1"></a>            ValueType<span class="op">&lt;</span>T<span class="op">&gt;::</span>Nest <span class="op">!=</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb349-24"><a href="#cb349-24" aria-hidden="true" tabindex="-1"></a>            <span class="kw">typename</span> ValueType<span class="op">&lt;</span><span class="kw">typename</span> ValueType<span class="op">&lt;</span>T<span class="op">&gt;::</span>type_direct<span class="op">&gt;::</span><span class="kw">template</span> type_n<span class="op">&lt;</span>N <span class="op">-</span> <span class="dv">1</span><span class="op">&gt;,</span> T<span class="op">&gt;;</span></span>
<span id="cb349-25"><a href="#cb349-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb349-26"><a href="#cb349-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-27"><a href="#cb349-27" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb349-28"><a href="#cb349-28" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> conditional_value_type_n<span class="op">&lt;</span>T<span class="op">,</span> <span class="dv">0</span><span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb349-29"><a href="#cb349-29" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> type <span class="op">=</span> T<span class="op">;</span></span>
<span id="cb349-30"><a href="#cb349-30" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb349-31"><a href="#cb349-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-32"><a href="#cb349-32" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">,</span> <span class="kw">typename</span> <span class="op">=</span> <span class="dt">void</span><span class="op">&gt;</span></span>
<span id="cb349-33"><a href="#cb349-33" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> array_or_container <span class="op">:</span> <span class="bu">std::</span>false_type<span class="op"> {</span></span>
<span id="cb349-34"><a href="#cb349-34" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb349-35"><a href="#cb349-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-36"><a href="#cb349-36" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb349-37"><a href="#cb349-37" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> array_or_container<span class="op">&lt;</span>T<span class="op">,</span> <span class="kw">typename</span> <span class="bu">std::</span>enable_if_t<span class="op">&lt;</span><span class="bu">std::</span>is_array_v<span class="op">&lt;</span>T<span class="op">&gt;&gt;&gt;</span> <span class="op">:</span> <span class="bu">std::</span>true_type<span class="op"> {</span></span>
<span id="cb349-38"><a href="#cb349-38" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> type <span class="op">=</span> <span class="kw">typename</span> <span class="bu">std::</span>remove_extent_t<span class="op">&lt;</span>T<span class="op">&gt;;</span></span>
<span id="cb349-39"><a href="#cb349-39" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb349-40"><a href="#cb349-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-41"><a href="#cb349-41" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Tが配列でなく、且つT型インスタンスに範囲for文が適用できるならばstdコンテナと診断する</span></span>
<span id="cb349-42"><a href="#cb349-42" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb349-43"><a href="#cb349-43" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> is_container_v<span class="op">{</span>Nstd<span class="op">::</span>IsRange<span class="op">&lt;</span>T<span class="op">&gt;::</span>value <span class="op">&amp;&amp;</span> <span class="op">!</span><span class="bu">std::</span>is_array_v<span class="op">&lt;</span>T<span class="op">&gt;};</span></span>
<span id="cb349-44"><a href="#cb349-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-45"><a href="#cb349-45" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb349-46"><a href="#cb349-46" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> array_or_container<span class="op">&lt;</span>T<span class="op">,</span> <span class="kw">typename</span> <span class="bu">std::</span>enable_if_t<span class="op">&lt;</span>is_container_v<span class="op">&lt;</span>T<span class="op">&gt;&gt;&gt;</span> <span class="op">:</span> <span class="bu">std::</span>true_type<span class="op"> {</span></span>
<span id="cb349-47"><a href="#cb349-47" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> type <span class="op">=</span> <span class="kw">typename</span> T<span class="op">::</span><span class="dt">value_type</span><span class="op">;</span></span>
<span id="cb349-48"><a href="#cb349-48" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb349-49"><a href="#cb349-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-50"><a href="#cb349-50" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb349-51"><a href="#cb349-51" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> array_or_container_v<span class="op">{</span>array_or_container<span class="op">&lt;</span>T<span class="op">&gt;::</span>value<span class="op">};</span></span>
<span id="cb349-52"><a href="#cb349-52" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace Inner_</span></span>
<span id="cb349-53"><a href="#cb349-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-54"><a href="#cb349-54" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span>  <span class="co">// ValueTypeの特殊化</span></span>
<span id="cb349-55"><a href="#cb349-55" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> ValueType<span class="op">&lt;</span>T<span class="op">,</span> <span class="kw">typename</span> <span class="bu">std::</span>enable_if_t<span class="op">&lt;</span>Inner_<span class="op">::</span>array_or_container_v<span class="op">&lt;</span>T<span class="op">&gt;&gt;&gt;</span> <span class="op">{</span></span>
<span id="cb349-56"><a href="#cb349-56" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> type_direct <span class="op">=</span> <span class="kw">typename</span> Inner_<span class="op">::</span>array_or_container<span class="op">&lt;</span>T<span class="op">&gt;::</span>type<span class="op">;</span></span>
<span id="cb349-57"><a href="#cb349-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-58"><a href="#cb349-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="kw">constexpr</span> <span class="dt">bool</span>   IsBuiltinArray<span class="op">{</span><span class="bu">std::</span>is_array_v<span class="op">&lt;</span>T<span class="op">&gt;};</span></span>
<span id="cb349-59"><a href="#cb349-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="kw">constexpr</span> <span class="dt">size_t</span> Nest<span class="op">{</span>ValueType<span class="op">&lt;</span>type_direct<span class="op">&gt;::</span>Nest <span class="op">+</span> <span class="dv">1</span><span class="op">};</span></span>
<span id="cb349-60"><a href="#cb349-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-61"><a href="#cb349-61" aria-hidden="true" tabindex="-1"></a>        <span class="kw">template</span> <span class="op">&lt;</span><span class="dt">size_t</span> N<span class="op">&gt;</span></span>
<span id="cb349-62"><a href="#cb349-62" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> type_n <span class="op">=</span> <span class="kw">typename</span> Inner_<span class="op">::</span>conditional_value_type_n<span class="op">&lt;</span>T<span class="op">,</span> N<span class="op">&gt;::</span>type<span class="op">;</span></span>
<span id="cb349-63"><a href="#cb349-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-64"><a href="#cb349-64" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> type <span class="op">=</span> type_n<span class="op">&lt;</span>Nest<span class="op">&gt;;</span></span>
<span id="cb349-65"><a href="#cb349-65" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb349-66"><a href="#cb349-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-67"><a href="#cb349-67" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb349-68"><a href="#cb349-68" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> ValueTypeT <span class="op">=</span> <span class="kw">typename</span> ValueType<span class="op">&lt;</span>T<span class="op">&gt;::</span>type<span class="op">;</span></span>
<span id="cb349-69"><a href="#cb349-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-70"><a href="#cb349-70" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">,</span> <span class="dt">size_t</span> N<span class="op">&gt;</span></span>
<span id="cb349-71"><a href="#cb349-71" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> ValueTypeT_n <span class="op">=</span> <span class="kw">typename</span> ValueType<span class="op">&lt;</span>T<span class="op">&gt;::</span><span class="kw">template</span> type_n<span class="op">&lt;</span>N<span class="op">&gt;;</span></span>
<span id="cb349-72"><a href="#cb349-72" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace Nstd</span></span></code></pre></div>
<h2 id="nstdライブラリの開発2">Nstdライブラリの開発2
<a id="SS_3_4"></a></h2>
<p>ここでは予定していた通りSafeArray2を開発し、その後Nstdに必要なライブラリの開発を続ける。</p>
<h3 id="safearray2の開発">SafeArray2の開発 <a id="SS_3_4_1"></a></h3>
<p>「<a
href="#SS_3_2_3">安全な配列型コンテナ</a>」で断念したSafeArray2の開発を再開する前に、
SafeArray2の要件をまとめると、</p>
<ul>
<li>std::arrayを基底クラスとする</li>
<li>operator[]に範囲チェックを行う</li>
<li>SafeArrayでのパラメータパックによる初期化機能はそのまま残す</li>
<li>SafeArrayではできなかった縮小型変換が起こる初期化にも対応する</li>
<li>新規要件として、
縮小型変換により初期化されたかどうかを示すメンバ関数InitializedWithNarrowConv()を持つ。</li>
</ul>
<p>となる。この要件を満たすためには、SafeArrayが</p>
<div class="sourceCode" id="cb350"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb350-1"><a href="#cb350-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/safe_vector_ut.cpp 154</span></span>
<span id="cb350-2"><a href="#cb350-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-3"><a href="#cb350-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span><span class="op">...</span> ARGS<span class="op">&gt;</span>  <span class="co">// コンストラクタを定義</span></span>
<span id="cb350-4"><a href="#cb350-4" aria-hidden="true" tabindex="-1"></a>    SafeArray<span class="op">(</span>ARGS<span class="op">...</span> args<span class="op">)</span> <span class="op">:</span> <span class="dt">base_type</span><span class="op">{</span>args<span class="op">...}</span></span>
<span id="cb350-5"><a href="#cb350-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb350-6"><a href="#cb350-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>で行っていた初期化を、SafeArray2では、
「縮小型変換が起こるか否かによる場合分けを行い、
それぞれの場合に対応するコンストラクタテンプレートによって初期化」
するようにすれば良いことがわかる。</p>
<p>パラメータパックによるコンストラクタのシグネチャは上記した一種類しかないため、
関数のシグネチャの差異よるオーバーロードは使えない。
とすれば、テンプレートパラメータの型の差異によるオーバーロードを使うしか方法がない。
縮小型変換が起こるか否かの場合分けはSFINAEで実現させることができる。
という風な思考の変遷により以下のコードにたどり着く。</p>
<div class="sourceCode" id="cb351"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb351-1"><a href="#cb351-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/safe_vector_ut.cpp 227</span></span>
<span id="cb351-2"><a href="#cb351-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> Nstd <span class="op">{</span></span>
<span id="cb351-3"><a href="#cb351-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb351-4"><a href="#cb351-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">,</span> <span class="dt">size_t</span> N<span class="op">&gt;</span></span>
<span id="cb351-5"><a href="#cb351-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> SafeArray2 <span class="op">:</span> <span class="bu">std::</span>array<span class="op">&lt;</span>T<span class="op">,</span> N<span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb351-6"><a href="#cb351-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> <span class="bu">std::</span>array<span class="op">&lt;</span>T<span class="op">,</span> N<span class="op">&gt;::</span>array<span class="op">;</span>  <span class="co">// 継承コンストラクタ</span></span>
<span id="cb351-7"><a href="#cb351-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> <span class="dt">base_type</span> <span class="op">=</span> <span class="bu">std::</span>array<span class="op">&lt;</span>T<span class="op">,</span> N<span class="op">&gt;;</span></span>
<span id="cb351-8"><a href="#cb351-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb351-9"><a href="#cb351-9" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 縮小型変換した場合には、ill-formedになるコンストラクタ</span></span>
<span id="cb351-10"><a href="#cb351-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span><span class="op">...</span> ARGS<span class="op">,</span></span>
<span id="cb351-11"><a href="#cb351-11" aria-hidden="true" tabindex="-1"></a>                  <span class="kw">typename</span> <span class="op">=</span> </span>
<span id="cb351-12"><a href="#cb351-12" aria-hidden="true" tabindex="-1"></a>                      <span class="kw">typename</span> <span class="bu">std::</span>enable_if_t<span class="op">&lt;</span></span>
<span id="cb351-13"><a href="#cb351-13" aria-hidden="true" tabindex="-1"></a>                           AreConvertibleWithoutNarrowConvV<span class="op">&lt;</span>T<span class="op">,</span> ARGS<span class="op">...&gt;&gt;&gt;</span></span>
<span id="cb351-14"><a href="#cb351-14" aria-hidden="true" tabindex="-1"></a>        SafeArray2<span class="op">(</span>ARGS<span class="op">...</span> args<span class="op">)</span> <span class="op">:</span> <span class="dt">base_type</span><span class="op">{</span>args<span class="op">...}</span> <span class="co">// 初期化子リストによるarrayの初期化</span></span>
<span id="cb351-15"><a href="#cb351-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb351-16"><a href="#cb351-16" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb351-17"><a href="#cb351-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb351-18"><a href="#cb351-18" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 縮小型変換しない場合には、ill-formedになるコンストラクタ</span></span>
<span id="cb351-19"><a href="#cb351-19" aria-hidden="true" tabindex="-1"></a>        <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span><span class="op">...</span> ARGS<span class="op">,</span> </span>
<span id="cb351-20"><a href="#cb351-20" aria-hidden="true" tabindex="-1"></a>                  <span class="kw">typename</span> <span class="bu">std::</span>enable_if_t<span class="op">&lt;</span></span>
<span id="cb351-21"><a href="#cb351-21" aria-hidden="true" tabindex="-1"></a>                      <span class="op">!</span>AreConvertibleWithoutNarrowConvV<span class="op">&lt;</span>T<span class="op">,</span> ARGS<span class="op">...&gt;&gt;*</span> <span class="op">=</span> <span class="kw">nullptr</span><span class="op">&gt;</span></span>
<span id="cb351-22"><a href="#cb351-22" aria-hidden="true" tabindex="-1"></a>        SafeArray2<span class="op">(</span>ARGS<span class="op">...</span> args<span class="op">)</span> <span class="op">:</span></span>
<span id="cb351-23"><a href="#cb351-23" aria-hidden="true" tabindex="-1"></a>            <span class="dt">base_type</span><span class="op">{</span>T<span class="op">(</span>args<span class="op">)...},</span>  <span class="co">// 縮小型変換を抑止するため、T(args)が必要</span></span>
<span id="cb351-24"><a href="#cb351-24" aria-hidden="true" tabindex="-1"></a>            <span class="va">is_with_narrow_conv_</span><span class="op">{</span><span class="kw">true</span><span class="op">}</span></span>
<span id="cb351-25"><a href="#cb351-25" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb351-26"><a href="#cb351-26" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb351-27"><a href="#cb351-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb351-28"><a href="#cb351-28" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> <span class="dt">size_type</span> <span class="op">=</span> <span class="kw">typename</span> <span class="dt">base_type</span><span class="op">::</span><span class="dt">size_type</span><span class="op">;</span></span>
<span id="cb351-29"><a href="#cb351-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb351-30"><a href="#cb351-30" aria-hidden="true" tabindex="-1"></a>        <span class="kw">typename</span> <span class="dt">base_type</span><span class="op">::</span>reference       <span class="kw">operator</span><span class="op">[](</span><span class="dt">size_type</span> i<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> <span class="kw">this</span><span class="op">-&gt;</span>at<span class="op">(</span>i<span class="op">);</span> <span class="op">}</span></span>
<span id="cb351-31"><a href="#cb351-31" aria-hidden="true" tabindex="-1"></a>        <span class="kw">typename</span> <span class="dt">base_type</span><span class="op">::</span>const_reference <span class="kw">operator</span><span class="op">[](</span><span class="dt">size_type</span> i<span class="op">)</span> <span class="at">const</span> <span class="op">{</span> <span class="cf">return</span> <span class="kw">this</span><span class="op">-&gt;</span>at<span class="op">(</span>i<span class="op">);</span> <span class="op">}</span></span>
<span id="cb351-32"><a href="#cb351-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb351-33"><a href="#cb351-33" aria-hidden="true" tabindex="-1"></a>        <span class="dt">bool</span> InitializedWithNarrowConv<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">is_with_narrow_conv_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb351-34"><a href="#cb351-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb351-35"><a href="#cb351-35" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb351-36"><a href="#cb351-36" aria-hidden="true" tabindex="-1"></a>        <span class="dt">bool</span> <span class="at">const</span> <span class="va">is_with_narrow_conv_</span><span class="op">{</span><span class="kw">false</span><span class="op">};</span></span>
<span id="cb351-37"><a href="#cb351-37" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb351-38"><a href="#cb351-38" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace Nstd</span></span></code></pre></div>
<p>下記のようなコードでのコンストラクタ呼び出しには、</p>
<div class="sourceCode" id="cb352"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb352-1"><a href="#cb352-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/safe_vector_ut.cpp 290</span></span>
<span id="cb352-2"><a href="#cb352-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb352-3"><a href="#cb352-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> sa_init <span class="op">=</span> Nstd<span class="op">::</span>SafeArray2<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dv">3</span><span class="op">&gt;{</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">};</span></span></code></pre></div>
<p>上記の抜粋である下記のコンストラクタが置換失敗により排除される(SFINAE)。</p>
<div class="sourceCode" id="cb353"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb353-1"><a href="#cb353-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/safe_vector_ut.cpp 247</span></span>
<span id="cb353-2"><a href="#cb353-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb353-3"><a href="#cb353-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 縮小型変換しない場合には、ill-formedになるコンストラクタ</span></span>
<span id="cb353-4"><a href="#cb353-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span><span class="op">...</span> ARGS<span class="op">,</span> </span>
<span id="cb353-5"><a href="#cb353-5" aria-hidden="true" tabindex="-1"></a>              <span class="kw">typename</span> <span class="bu">std::</span>enable_if_t<span class="op">&lt;</span></span>
<span id="cb353-6"><a href="#cb353-6" aria-hidden="true" tabindex="-1"></a>                  <span class="op">!</span>AreConvertibleWithoutNarrowConvV<span class="op">&lt;</span>T<span class="op">,</span> ARGS<span class="op">...&gt;&gt;*</span> <span class="op">=</span> <span class="kw">nullptr</span><span class="op">&gt;</span></span>
<span id="cb353-7"><a href="#cb353-7" aria-hidden="true" tabindex="-1"></a>    SafeArray2<span class="op">(</span>ARGS<span class="op">...</span> args<span class="op">)</span> <span class="op">:</span></span>
<span id="cb353-8"><a href="#cb353-8" aria-hidden="true" tabindex="-1"></a>        <span class="dt">base_type</span><span class="op">{</span>T<span class="op">(</span>args<span class="op">)...},</span>  <span class="co">// 縮小型変換を抑止するため、T(args)が必要</span></span>
<span id="cb353-9"><a href="#cb353-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">is_with_narrow_conv_</span><span class="op">{</span><span class="kw">true</span><span class="op">}</span></span>
<span id="cb353-10"><a href="#cb353-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb353-11"><a href="#cb353-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>従って、マッチするコンストラクタは</p>
<div class="sourceCode" id="cb354"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb354-1"><a href="#cb354-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/safe_vector_ut.cpp 236</span></span>
<span id="cb354-2"><a href="#cb354-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-3"><a href="#cb354-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 縮小型変換した場合には、ill-formedになるコンストラクタ</span></span>
<span id="cb354-4"><a href="#cb354-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span><span class="op">...</span> ARGS<span class="op">,</span></span>
<span id="cb354-5"><a href="#cb354-5" aria-hidden="true" tabindex="-1"></a>              <span class="kw">typename</span> <span class="op">=</span> </span>
<span id="cb354-6"><a href="#cb354-6" aria-hidden="true" tabindex="-1"></a>                  <span class="kw">typename</span> <span class="bu">std::</span>enable_if_t<span class="op">&lt;</span></span>
<span id="cb354-7"><a href="#cb354-7" aria-hidden="true" tabindex="-1"></a>                       AreConvertibleWithoutNarrowConvV<span class="op">&lt;</span>T<span class="op">,</span> ARGS<span class="op">...&gt;&gt;&gt;</span></span>
<span id="cb354-8"><a href="#cb354-8" aria-hidden="true" tabindex="-1"></a>    SafeArray2<span class="op">(</span>ARGS<span class="op">...</span> args<span class="op">)</span> <span class="op">:</span> <span class="dt">base_type</span><span class="op">{</span>args<span class="op">...}</span> <span class="co">// 初期化子リストによるarrayの初期化</span></span>
<span id="cb354-9"><a href="#cb354-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb354-10"><a href="#cb354-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>のみとなり、無事にコンパイルが成功し、下記の単体テストもパスする。</p>
<div class="sourceCode" id="cb355"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb355-1"><a href="#cb355-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/safe_vector_ut.cpp 290</span></span>
<span id="cb355-2"><a href="#cb355-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb355-3"><a href="#cb355-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> sa_init <span class="op">=</span> Nstd<span class="op">::</span>SafeArray2<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dv">3</span><span class="op">&gt;{</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">};</span></span>
<span id="cb355-4"><a href="#cb355-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb355-5"><a href="#cb355-5" aria-hidden="true" tabindex="-1"></a>    ASSERT_FALSE<span class="op">(</span>sa_init<span class="op">.</span>InitializedWithNarrowConv<span class="op">());</span>  <span class="co">// 縮小型変換なし</span></span>
<span id="cb355-6"><a href="#cb355-6" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">3</span><span class="op">,</span> sa_init<span class="op">.</span>size<span class="op">());</span></span>
<span id="cb355-7"><a href="#cb355-7" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">1</span><span class="op">,</span> sa_init<span class="op">[</span><span class="dv">0</span><span class="op">]);</span></span>
<span id="cb355-8"><a href="#cb355-8" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">2</span><span class="op">,</span> sa_init<span class="op">[</span><span class="dv">1</span><span class="op">]);</span></span>
<span id="cb355-9"><a href="#cb355-9" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">3</span><span class="op">,</span> sa_init<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb355-10"><a href="#cb355-10" aria-hidden="true" tabindex="-1"></a>    ASSERT_THROW<span class="op">(</span>sa_init<span class="op">[</span><span class="dv">3</span><span class="op">],</span> <span class="bu">std::</span>out_of_range<span class="op">);</span></span></code></pre></div>
<p>下記の単体テストの場合、SFINAEにより、先述の例とは逆のコンストラクタが選択され、
コンパイルも単体テストもパスする。</p>
<div class="sourceCode" id="cb356"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb356-1"><a href="#cb356-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/safe_vector_ut.cpp 305</span></span>
<span id="cb356-2"><a href="#cb356-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> <span class="at">const</span> sa_init <span class="op">=</span> Nstd<span class="op">::</span>SafeArray2<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dv">3</span><span class="op">&gt;{</span><span class="dv">10</span><span class="op">,</span> <span class="dv">20</span><span class="op">,</span> <span class="fl">30.0</span><span class="op">};</span>  <span class="co">// 30.0はintに縮小型変換される</span></span>
<span id="cb356-3"><a href="#cb356-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-4"><a href="#cb356-4" aria-hidden="true" tabindex="-1"></a>    ASSERT_TRUE<span class="op">(</span>sa_init<span class="op">.</span>InitializedWithNarrowConv<span class="op">());</span>  <span class="co">// 縮小型変換あり</span></span>
<span id="cb356-5"><a href="#cb356-5" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">3</span><span class="op">,</span> sa_init<span class="op">.</span>size<span class="op">());</span></span>
<span id="cb356-6"><a href="#cb356-6" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">10</span><span class="op">,</span> sa_init<span class="op">[</span><span class="dv">0</span><span class="op">]);</span></span>
<span id="cb356-7"><a href="#cb356-7" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">20</span><span class="op">,</span> sa_init<span class="op">[</span><span class="dv">1</span><span class="op">]);</span></span>
<span id="cb356-8"><a href="#cb356-8" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">30</span><span class="op">,</span> sa_init<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb356-9"><a href="#cb356-9" aria-hidden="true" tabindex="-1"></a>    ASSERT_THROW<span class="op">(</span>sa_init<span class="op">[</span><span class="dv">3</span><span class="op">],</span> <span class="bu">std::</span>out_of_range<span class="op">);</span></span></code></pre></div>
<p>ここで紹介した2つのコンストラクタテンプレートの最後のパラメータには、かなりの違和感があるだろうが、
引数や戻り値に制限の多いコンストラクタテンプレートでSFINAEを起こすためには、
このような記述が必要になる。</p>
<p>なお、2つ目のコンストラクタテンプレートの中で使用した下記のコードは、
パラメータパックで与えられた全引数をそれぞれにT型オブジェクトに変換するための記法である。</p>
<div class="sourceCode" id="cb357"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb357-1"><a href="#cb357-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/safe_vector_ut.cpp 255</span></span>
<span id="cb357-2"><a href="#cb357-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-3"><a href="#cb357-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">base_type</span><span class="op">{</span>T<span class="op">(</span>args<span class="op">)...},</span>  <span class="co">// 縮小型変換を抑止するため、T(args)が必要</span></span></code></pre></div>
<p>これにより、std::array&lt;T,
N&gt;のstd::initializer_listによる初期化が縮小変換を検出しなくなる。</p>
<h3 id="nstdsafeindexの開発">Nstd::SafeIndexの開発
<a id="SS_3_4_2"></a></h3>
<p>「<a href="#SS_3_2_2">安全なvector</a>」、「<a
href="#SS_3_2_3">安全な配列型コンテナ</a>」等の中で、</p>
<ul>
<li>Nstd::SafeVector</li>
<li>Nstd::SafeString</li>
<li>Nstd::SafeArray</li>
</ul>
<p>を定義した。これらは少しだけランタイム速度を犠牲にすることで、
安全な(未定義動作を起こさない)インデックスアクセスを保障するため、
一般のソフトウェア開発にも有用であると思われるが、コードクローンして作ったため、
リファクタリングを行う必要がある。</p>
<p>まずは、Nstd::SafeVectorとNstd::SafeStringの統一を考える。</p>
<p>std::stringは、実際にはstd::basic_string&lt;char&gt;のエイリアスであることに注目すれば、
Nstd::SafeStringの基底クラスはstd::basic_string&lt;char&gt;であることがわかる。
この形式は、std::vector&lt;T&gt;と同形であるため、
Nstd::SafeVectorとNstd::SafeStringの共通コードはテンプレートテンプレートパラメータ
(「<a
href="#SS_3_3_3_6">is_same_templの実装</a>」参照)を使用し下記のように書ける。</p>
<div class="sourceCode" id="cb358"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb358-1"><a href="#cb358-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_safe_index.h 8</span></span>
<span id="cb358-2"><a href="#cb358-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb358-3"><a href="#cb358-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> Nstd <span class="op">{</span></span>
<span id="cb358-4"><a href="#cb358-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb358-5"><a href="#cb358-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">template</span> <span class="op">&lt;</span><span class="kw">class</span><span class="op">...&gt;</span> <span class="kw">class</span> C<span class="op">,</span> <span class="kw">typename</span><span class="op">...</span> Ts<span class="op">&gt;</span></span>
<span id="cb358-6"><a href="#cb358-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> SafeIndex <span class="op">:</span> C<span class="op">&lt;</span>Ts<span class="op">...&gt;</span> <span class="op">{</span></span>
<span id="cb358-7"><a href="#cb358-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> C<span class="op">&lt;</span>Ts<span class="op">...&gt;::</span>C<span class="op">;</span></span>
<span id="cb358-8"><a href="#cb358-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb358-9"><a href="#cb358-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> <span class="dt">base_type</span> <span class="op">=</span> C<span class="op">&lt;</span>Ts<span class="op">...&gt;;</span></span>
<span id="cb358-10"><a href="#cb358-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> <span class="dt">size_type</span> <span class="op">=</span> <span class="kw">typename</span> <span class="dt">base_type</span><span class="op">::</span><span class="dt">size_type</span><span class="op">;</span></span>
<span id="cb358-11"><a href="#cb358-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb358-12"><a href="#cb358-12" aria-hidden="true" tabindex="-1"></a>        <span class="kw">typename</span> <span class="dt">base_type</span><span class="op">::</span>reference       <span class="kw">operator</span><span class="op">[](</span><span class="dt">size_type</span> i<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> <span class="kw">this</span><span class="op">-&gt;</span>at<span class="op">(</span>i<span class="op">);</span> <span class="op">}</span></span>
<span id="cb358-13"><a href="#cb358-13" aria-hidden="true" tabindex="-1"></a>        <span class="kw">typename</span> <span class="dt">base_type</span><span class="op">::</span>const_reference <span class="kw">operator</span><span class="op">[](</span><span class="dt">size_type</span> i<span class="op">)</span> <span class="at">const</span> <span class="op">{</span> <span class="cf">return</span> <span class="kw">this</span><span class="op">-&gt;</span>at<span class="op">(</span>i<span class="op">);</span> <span class="op">}</span></span>
<span id="cb358-14"><a href="#cb358-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb358-15"><a href="#cb358-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace Nstd</span></span></code></pre></div>
<p>このコードの使用例を兼ねた単体テストは下記のようになる。</p>
<div class="sourceCode" id="cb359"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb359-1"><a href="#cb359-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_safe_index_ut.cpp 8</span></span>
<span id="cb359-2"><a href="#cb359-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-3"><a href="#cb359-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> v_i <span class="op">=</span> Nstd<span class="op">::</span>SafeIndex<span class="op">&lt;</span><span class="bu">std::</span>vector<span class="op">,</span> <span class="dt">int</span><span class="op">&gt;{</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">};</span></span>
<span id="cb359-4"><a href="#cb359-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-5"><a href="#cb359-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">&amp;,</span> <span class="kw">decltype</span><span class="op">(</span>v_i<span class="op">[</span><span class="dv">0</span><span class="op">])&gt;);</span></span>
<span id="cb359-6"><a href="#cb359-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_base_of_v<span class="op">&lt;</span><span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;,</span> <span class="kw">decltype</span><span class="op">(</span>v_i<span class="op">)&gt;);</span></span>
<span id="cb359-7"><a href="#cb359-7" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">1</span><span class="op">,</span> v_i<span class="op">[</span><span class="dv">0</span><span class="op">]);</span></span>
<span id="cb359-8"><a href="#cb359-8" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">2</span><span class="op">,</span> v_i<span class="op">[</span><span class="dv">1</span><span class="op">]);</span></span>
<span id="cb359-9"><a href="#cb359-9" aria-hidden="true" tabindex="-1"></a>    ASSERT_THROW<span class="op">(</span>v_i<span class="op">[</span><span class="dv">2</span><span class="op">],</span> <span class="bu">std::</span>out_of_range<span class="op">);</span></span>
<span id="cb359-10"><a href="#cb359-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-11"><a href="#cb359-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> str <span class="op">=</span> Nstd<span class="op">::</span>SafeIndex<span class="op">&lt;</span><span class="bu">std::</span>basic_string<span class="op">,</span> <span class="dt">char</span><span class="op">&gt;{</span><span class="st">&quot;123&quot;</span><span class="op">};</span></span>
<span id="cb359-12"><a href="#cb359-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-13"><a href="#cb359-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="dt">char</span><span class="op">&amp;,</span> <span class="kw">decltype</span><span class="op">(</span>str<span class="op">[</span><span class="dv">0</span><span class="op">])&gt;);</span></span>
<span id="cb359-14"><a href="#cb359-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_base_of_v<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">,</span> <span class="kw">decltype</span><span class="op">(</span>str<span class="op">)&gt;);</span></span>
<span id="cb359-15"><a href="#cb359-15" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">3</span><span class="op">,</span> str<span class="op">.</span>size<span class="op">());</span></span>
<span id="cb359-16"><a href="#cb359-16" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;123&quot;</span><span class="op">,</span> str<span class="op">);</span></span>
<span id="cb359-17"><a href="#cb359-17" aria-hidden="true" tabindex="-1"></a>    ASSERT_THROW<span class="op">(</span>str<span class="op">[</span><span class="dv">3</span><span class="op">],</span> <span class="bu">std::</span>out_of_range<span class="op">);</span></span></code></pre></div>
<p>このままでは使いづらいので下記のようにエイリアスを使い、元のテンプレートと同じ名前を与える。</p>
<div class="sourceCode" id="cb360"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb360-1"><a href="#cb360-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_safe_index.h 24</span></span>
<span id="cb360-2"><a href="#cb360-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb360-3"><a href="#cb360-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> Nstd <span class="op">{</span></span>
<span id="cb360-4"><a href="#cb360-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb360-5"><a href="#cb360-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb360-6"><a href="#cb360-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> SafeVector <span class="op">=</span> Nstd<span class="op">::</span>SafeIndex<span class="op">&lt;</span><span class="bu">std::</span>vector<span class="op">,</span> T<span class="op">&gt;;</span></span>
<span id="cb360-7"><a href="#cb360-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb360-8"><a href="#cb360-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> SafeString <span class="op">=</span> Nstd<span class="op">::</span>SafeIndex<span class="op">&lt;</span><span class="bu">std::</span>basic_string<span class="op">,</span> <span class="dt">char</span><span class="op">&gt;;</span></span>
<span id="cb360-9"><a href="#cb360-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace Nstd</span></span></code></pre></div>
<p>このコードの単体テストは下記のようになる。</p>
<div class="sourceCode" id="cb361"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb361-1"><a href="#cb361-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_safe_index_ut.cpp 54</span></span>
<span id="cb361-2"><a href="#cb361-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb361-3"><a href="#cb361-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> v_i <span class="op">=</span> Nstd<span class="op">::</span>SafeVector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;{</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">};</span></span>
<span id="cb361-4"><a href="#cb361-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb361-5"><a href="#cb361-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">&amp;,</span> <span class="kw">decltype</span><span class="op">(</span>v_i<span class="op">[</span><span class="dv">0</span><span class="op">])&gt;);</span></span>
<span id="cb361-6"><a href="#cb361-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_base_of_v<span class="op">&lt;</span><span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;,</span> <span class="kw">decltype</span><span class="op">(</span>v_i<span class="op">)&gt;);</span></span>
<span id="cb361-7"><a href="#cb361-7" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">1</span><span class="op">,</span> v_i<span class="op">[</span><span class="dv">0</span><span class="op">]);</span></span>
<span id="cb361-8"><a href="#cb361-8" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">2</span><span class="op">,</span> v_i<span class="op">[</span><span class="dv">1</span><span class="op">]);</span></span>
<span id="cb361-9"><a href="#cb361-9" aria-hidden="true" tabindex="-1"></a>    ASSERT_THROW<span class="op">(</span>v_i<span class="op">[</span><span class="dv">2</span><span class="op">],</span> <span class="bu">std::</span>out_of_range<span class="op">);</span></span>
<span id="cb361-10"><a href="#cb361-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb361-11"><a href="#cb361-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> str <span class="op">=</span> Nstd<span class="op">::</span>SafeString<span class="op">{</span><span class="st">&quot;123&quot;</span><span class="op">};</span></span>
<span id="cb361-12"><a href="#cb361-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb361-13"><a href="#cb361-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="dt">char</span><span class="op">&amp;,</span> <span class="kw">decltype</span><span class="op">(</span>str<span class="op">[</span><span class="dv">0</span><span class="op">])&gt;);</span></span>
<span id="cb361-14"><a href="#cb361-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_base_of_v<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">,</span> <span class="kw">decltype</span><span class="op">(</span>str<span class="op">)&gt;);</span></span>
<span id="cb361-15"><a href="#cb361-15" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">3</span><span class="op">,</span> str<span class="op">.</span>size<span class="op">());</span></span>
<span id="cb361-16"><a href="#cb361-16" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;123&quot;</span><span class="op">,</span> str<span class="op">);</span></span>
<span id="cb361-17"><a href="#cb361-17" aria-hidden="true" tabindex="-1"></a>    ASSERT_THROW<span class="op">(</span>str<span class="op">[</span><span class="dv">3</span><span class="op">],</span> <span class="bu">std::</span>out_of_range<span class="op">);</span></span></code></pre></div>
<p>これで、Nstd::SafeVectorとNstd::SafeStringは統一できたので、
Nstd::SafeIndexにNstd::SafeArrayの実装が取り込めれば、リファクタリングは終了となるが、
残念ながら、下記のコードはコンパイルできない。</p>
<div class="sourceCode" id="cb362"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb362-1"><a href="#cb362-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_safe_index_ut.cpp 44</span></span>
<span id="cb362-2"><a href="#cb362-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-3"><a href="#cb362-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 下記のように書きたいが、パラメータパックは型と値を混在できないのでコンパイルエラー</span></span>
<span id="cb362-4"><a href="#cb362-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> a_i <span class="op">=</span> Nstd<span class="op">::</span>SafeIndex<span class="op">&lt;</span><span class="bu">std::</span>array<span class="op">,</span> <span class="dt">int</span><span class="op">,</span> <span class="dv">5</span><span class="op">&gt;{};</span></span></code></pre></div>
<p>理由は、パラメータパックにはそのすべてに型を指定するか、そのすべてに値を指定しなければならず、
上記のコードのような型と値の混在が許されていないからである。</p>
<p>値を型に変換する<a
href="#SS_3_3_1_2">std::integral_constant</a>を使用し、この問題を解決できる。
std::arrayから派生した下記のStdArrayLikeは、std::integral_constant::valueから値を取り出し、
基底クラスstd::arrayの第2テンプレートパラメータとする。
この仕組みにより、StdArrayLikeは、
Nstd::SafeIndexのテンプレートテンプレートパラメータとして使用できるようになる。</p>
<div class="sourceCode" id="cb363"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb363-1"><a href="#cb363-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_safe_index.h 34</span></span>
<span id="cb363-2"><a href="#cb363-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-3"><a href="#cb363-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> Nstd <span class="op">{</span></span>
<span id="cb363-4"><a href="#cb363-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> Inner_ <span class="op">{</span></span>
<span id="cb363-5"><a href="#cb363-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-6"><a href="#cb363-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">,</span> <span class="kw">typename</span> U<span class="op">&gt;</span></span>
<span id="cb363-7"><a href="#cb363-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> std_array_like <span class="op">:</span> <span class="bu">std::</span>array<span class="op">&lt;</span>T<span class="op">,</span> U<span class="op">::</span>value<span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb363-8"><a href="#cb363-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> <span class="bu">std::</span>array<span class="op">&lt;</span>T<span class="op">,</span> U<span class="op">::</span>value<span class="op">&gt;::</span>array<span class="op">;</span></span>
<span id="cb363-9"><a href="#cb363-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-10"><a href="#cb363-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span><span class="op">...</span> ARGS<span class="op">&gt;</span></span>
<span id="cb363-11"><a href="#cb363-11" aria-hidden="true" tabindex="-1"></a>        std_array_like<span class="op">(</span>ARGS<span class="op">...</span> args<span class="op">)</span> <span class="kw">noexcept</span><span class="op">(</span><span class="bu">std::</span>is_nothrow_constructible_v<span class="op">&lt;</span>T<span class="op">,</span> ARGS<span class="op">...&gt;)</span></span>
<span id="cb363-12"><a href="#cb363-12" aria-hidden="true" tabindex="-1"></a>            <span class="op">:</span> <span class="bu">std::</span>array<span class="op">&lt;</span>T<span class="op">,</span> U<span class="op">::</span>value<span class="op">&gt;{</span>args<span class="op">...}</span></span>
<span id="cb363-13"><a href="#cb363-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb363-14"><a href="#cb363-14" aria-hidden="true" tabindex="-1"></a>            <span class="kw">static_assert</span><span class="op">(</span>AreConvertibleV<span class="op">&lt;</span>T<span class="op">,</span> ARGS<span class="op">...&gt;,</span> <span class="st">&quot;arguemnt error&quot;</span><span class="op">);</span></span>
<span id="cb363-15"><a href="#cb363-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb363-16"><a href="#cb363-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb363-17"><a href="#cb363-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace Inner_</span></span>
<span id="cb363-18"><a href="#cb363-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace Nstd</span></span></code></pre></div>
<p>まずは、このコードの使用例を兼ねた単体テストを下記に示す。</p>
<div class="sourceCode" id="cb364"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb364-1"><a href="#cb364-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_safe_index_ut.cpp 134</span></span>
<span id="cb364-2"><a href="#cb364-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb364-3"><a href="#cb364-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> sal <span class="op">=</span> Nstd<span class="op">::</span>Inner_<span class="op">::</span>std_array_like<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="bu">std::</span>integral_constant<span class="op">&lt;</span><span class="dt">size_t</span><span class="op">,</span> <span class="dv">3</span><span class="op">&gt;&gt;{</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">};</span></span>
<span id="cb364-4"><a href="#cb364-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb364-5"><a href="#cb364-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_nothrow_constructible_v<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span>sal<span class="op">),</span> <span class="dt">int</span><span class="op">&gt;);</span>  <span class="co">// エクセプション無し生成</span></span>
<span id="cb364-6"><a href="#cb364-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">&amp;,</span> <span class="kw">decltype</span><span class="op">(</span>sal<span class="op">[</span><span class="dv">0</span><span class="op">])&gt;);</span></span>
<span id="cb364-7"><a href="#cb364-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_base_of_v<span class="op">&lt;</span><span class="bu">std::</span>array<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dv">3</span><span class="op">&gt;,</span> <span class="kw">decltype</span><span class="op">(</span>sal<span class="op">)&gt;);</span></span>
<span id="cb364-8"><a href="#cb364-8" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">1</span><span class="op">,</span> sal<span class="op">[</span><span class="dv">0</span><span class="op">]);</span></span>
<span id="cb364-9"><a href="#cb364-9" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">2</span><span class="op">,</span> sal<span class="op">[</span><span class="dv">1</span><span class="op">]);</span></span>
<span id="cb364-10"><a href="#cb364-10" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">3</span><span class="op">,</span> sal<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb364-11"><a href="#cb364-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb364-12"><a href="#cb364-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> T   <span class="op">=</span> Nstd<span class="op">::</span>Inner_<span class="op">::</span>std_array_like<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">,</span> <span class="bu">std::</span>integral_constant<span class="op">&lt;</span><span class="dt">size_t</span><span class="op">,</span> <span class="dv">3</span><span class="op">&gt;&gt;;</span></span>
<span id="cb364-13"><a href="#cb364-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> sal2 <span class="op">=</span> T<span class="op">{</span><span class="st">&quot;1&quot;</span><span class="op">,</span> <span class="st">&quot;2&quot;</span><span class="op">,</span> <span class="st">&quot;3&quot;</span><span class="op">};</span></span>
<span id="cb364-14"><a href="#cb364-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb364-15"><a href="#cb364-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span><span class="bu">std::</span>is_nothrow_constructible_v<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">,</span> <span class="dt">char</span> <span class="at">const</span><span class="op">*&gt;);</span></span>
<span id="cb364-16"><a href="#cb364-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span><span class="bu">std::</span>is_nothrow_constructible_v<span class="op">&lt;</span>T<span class="op">,</span> <span class="dt">char</span> <span class="at">const</span><span class="op">*&gt;);</span>  <span class="co">// エクセプション有り生成</span></span>
<span id="cb364-17"><a href="#cb364-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&amp;,</span> <span class="kw">decltype</span><span class="op">(</span>sal2<span class="op">[</span><span class="dv">0</span><span class="op">])&gt;);</span></span>
<span id="cb364-18"><a href="#cb364-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_base_of_v<span class="op">&lt;</span><span class="bu">std::</span>array<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">,</span> <span class="dv">3</span><span class="op">&gt;,</span> <span class="kw">decltype</span><span class="op">(</span>sal2<span class="op">)&gt;);</span></span>
<span id="cb364-19"><a href="#cb364-19" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;1&quot;</span><span class="op">,</span> sal2<span class="op">[</span><span class="dv">0</span><span class="op">]);</span></span>
<span id="cb364-20"><a href="#cb364-20" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;2&quot;</span><span class="op">,</span> sal2<span class="op">[</span><span class="dv">1</span><span class="op">]);</span></span>
<span id="cb364-21"><a href="#cb364-21" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;3&quot;</span><span class="op">,</span> sal2<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span></code></pre></div>
<p>これを使えば、下記のような記述が可能となる。</p>
<div class="sourceCode" id="cb365"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb365-1"><a href="#cb365-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_safe_index_ut.cpp 157</span></span>
<span id="cb365-2"><a href="#cb365-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb365-3"><a href="#cb365-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> T2   <span class="op">=</span> Nstd<span class="op">::</span>SafeIndex<span class="op">&lt;</span>Nstd<span class="op">::</span>Inner_<span class="op">::</span>std_array_like<span class="op">,</span> <span class="bu">std::</span>string<span class="op">,</span></span>
<span id="cb365-4"><a href="#cb365-4" aria-hidden="true" tabindex="-1"></a>                               <span class="bu">std::</span>integral_constant<span class="op">&lt;</span><span class="dt">size_t</span><span class="op">,</span> <span class="dv">4</span><span class="op">&gt;&gt;;</span></span>
<span id="cb365-5"><a href="#cb365-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> sal_s <span class="op">=</span> T2<span class="op">{</span><span class="st">&quot;1&quot;</span><span class="op">,</span> <span class="st">&quot;2&quot;</span><span class="op">,</span> <span class="st">&quot;3&quot;</span><span class="op">};</span></span>
<span id="cb365-6"><a href="#cb365-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb365-7"><a href="#cb365-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span><span class="bu">std::</span>is_nothrow_constructible_v<span class="op">&lt;</span>T2<span class="op">,</span> <span class="dt">char</span> <span class="at">const</span><span class="op">*&gt;);</span>  <span class="co">// エクセプション有り生成</span></span>
<span id="cb365-8"><a href="#cb365-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&amp;,</span> <span class="kw">decltype</span><span class="op">(</span>sal_s<span class="op">[</span><span class="dv">0</span><span class="op">])&gt;);</span></span>
<span id="cb365-9"><a href="#cb365-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_base_of_v<span class="op">&lt;</span><span class="bu">std::</span>array<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">,</span> <span class="dv">4</span><span class="op">&gt;,</span> <span class="kw">decltype</span><span class="op">(</span>sal_s<span class="op">)&gt;);</span></span>
<span id="cb365-10"><a href="#cb365-10" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;1&quot;</span><span class="op">,</span> sal_s<span class="op">[</span><span class="dv">0</span><span class="op">]);</span></span>
<span id="cb365-11"><a href="#cb365-11" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;2&quot;</span><span class="op">,</span> sal_s<span class="op">[</span><span class="dv">1</span><span class="op">]);</span></span>
<span id="cb365-12"><a href="#cb365-12" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;3&quot;</span><span class="op">,</span> sal_s<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb365-13"><a href="#cb365-13" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;&quot;</span><span class="op">,</span> sal_s<span class="op">[</span><span class="dv">3</span><span class="op">]);</span></span>
<span id="cb365-14"><a href="#cb365-14" aria-hidden="true" tabindex="-1"></a>    ASSERT_THROW<span class="op">(</span>sal_s<span class="op">[</span><span class="dv">4</span><span class="op">],</span> <span class="bu">std::</span>out_of_range<span class="op">);</span></span></code></pre></div>
<p>このままでは使いづらいのでNstd::SafeVector、Nstd::Stringと同様にエイリアスを使えば、
下記のようになる。</p>
<div class="sourceCode" id="cb366"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb366-1"><a href="#cb366-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_safe_index.h 53</span></span>
<span id="cb366-2"><a href="#cb366-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb366-3"><a href="#cb366-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> Nstd <span class="op">{</span></span>
<span id="cb366-4"><a href="#cb366-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb366-5"><a href="#cb366-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">,</span> <span class="dt">size_t</span> N<span class="op">&gt;</span></span>
<span id="cb366-6"><a href="#cb366-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> SafeArray</span>
<span id="cb366-7"><a href="#cb366-7" aria-hidden="true" tabindex="-1"></a>        <span class="op">=</span> Nstd<span class="op">::</span>SafeIndex<span class="op">&lt;</span>Nstd<span class="op">::</span>Inner_<span class="op">::</span>std_array_like<span class="op">,</span> T<span class="op">,</span> <span class="bu">std::</span>integral_constant<span class="op">&lt;</span><span class="dt">size_t</span><span class="op">,</span> N<span class="op">&gt;&gt;;</span></span>
<span id="cb366-8"><a href="#cb366-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace Nstd</span></span></code></pre></div>
<p>このコードの単体テストは下記のようになる。</p>
<div class="sourceCode" id="cb367"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb367-1"><a href="#cb367-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_safe_index_ut.cpp 89</span></span>
<span id="cb367-2"><a href="#cb367-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb367-3"><a href="#cb367-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> sal_s <span class="op">=</span> Nstd<span class="op">::</span>SafeArray<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">,</span> <span class="dv">4</span><span class="op">&gt;{</span><span class="st">&quot;1&quot;</span><span class="op">,</span> <span class="st">&quot;2&quot;</span><span class="op">,</span> <span class="st">&quot;3&quot;</span><span class="op">};</span></span>
<span id="cb367-4"><a href="#cb367-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb367-5"><a href="#cb367-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&amp;,</span> <span class="kw">decltype</span><span class="op">(</span>sal_s<span class="op">[</span><span class="dv">0</span><span class="op">])&gt;);</span></span>
<span id="cb367-6"><a href="#cb367-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_base_of_v<span class="op">&lt;</span><span class="bu">std::</span>array<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">,</span> <span class="dv">4</span><span class="op">&gt;,</span> <span class="kw">decltype</span><span class="op">(</span>sal_s<span class="op">)&gt;);</span></span>
<span id="cb367-7"><a href="#cb367-7" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;1&quot;</span><span class="op">,</span> sal_s<span class="op">[</span><span class="dv">0</span><span class="op">]);</span></span>
<span id="cb367-8"><a href="#cb367-8" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;2&quot;</span><span class="op">,</span> sal_s<span class="op">[</span><span class="dv">1</span><span class="op">]);</span></span>
<span id="cb367-9"><a href="#cb367-9" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;3&quot;</span><span class="op">,</span> sal_s<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb367-10"><a href="#cb367-10" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;&quot;</span><span class="op">,</span> sal_s<span class="op">[</span><span class="dv">3</span><span class="op">]);</span></span>
<span id="cb367-11"><a href="#cb367-11" aria-hidden="true" tabindex="-1"></a>    ASSERT_THROW<span class="op">(</span>sal_s<span class="op">[</span><span class="dv">4</span><span class="op">],</span> <span class="bu">std::</span>out_of_range<span class="op">);</span></span></code></pre></div>
<p>これにより、当初の目的であったコードクローンの除去が完了した。
この効果により、下記に示したような拡張もコードクローンせずに簡単に行えるようになった。</p>
<div class="sourceCode" id="cb368"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb368-1"><a href="#cb368-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_safe_index.h 62</span></span>
<span id="cb368-2"><a href="#cb368-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb368-3"><a href="#cb368-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> Nstd <span class="op">{</span></span>
<span id="cb368-4"><a href="#cb368-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb368-5"><a href="#cb368-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> SafeStringU16 <span class="op">=</span> Nstd<span class="op">::</span>SafeIndex<span class="op">&lt;</span><span class="bu">std::</span>basic_string<span class="op">,</span> <span class="dt">char16_t</span><span class="op">&gt;;</span></span>
<span id="cb368-6"><a href="#cb368-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> SafeStringU32 <span class="op">=</span> Nstd<span class="op">::</span>SafeIndex<span class="op">&lt;</span><span class="bu">std::</span>basic_string<span class="op">,</span> <span class="dt">char32_t</span><span class="op">&gt;;</span></span>
<span id="cb368-7"><a href="#cb368-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace Nstd</span></span></code></pre></div>
<div class="sourceCode" id="cb369"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb369-1"><a href="#cb369-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_safe_index_ut.cpp 112</span></span>
<span id="cb369-2"><a href="#cb369-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-3"><a href="#cb369-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> u16str <span class="op">=</span> Nstd<span class="op">::</span>SafeStringU16<span class="op">{</span><span class="st">u&quot;あいうえお&quot;</span><span class="op">};</span></span>
<span id="cb369-4"><a href="#cb369-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-5"><a href="#cb369-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="dt">char16_t</span><span class="op">&amp;,</span> <span class="kw">decltype</span><span class="op">(</span>u16str<span class="op">[</span><span class="dv">0</span><span class="op">])&gt;);</span></span>
<span id="cb369-6"><a href="#cb369-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_base_of_v<span class="op">&lt;</span><span class="bu">std::</span>u16string<span class="op">,</span> <span class="kw">decltype</span><span class="op">(</span>u16str<span class="op">)&gt;);</span></span>
<span id="cb369-7"><a href="#cb369-7" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">5</span><span class="op">,</span> u16str<span class="op">.</span>size<span class="op">());</span></span>
<span id="cb369-8"><a href="#cb369-8" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">u&quot;あいうえお&quot;</span><span class="op">,</span> u16str<span class="op">);</span></span>
<span id="cb369-9"><a href="#cb369-9" aria-hidden="true" tabindex="-1"></a>    ASSERT_THROW<span class="op">(</span>u16str<span class="op">[</span><span class="dv">5</span><span class="op">],</span> <span class="bu">std::</span>out_of_range<span class="op">);</span></span>
<span id="cb369-10"><a href="#cb369-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-11"><a href="#cb369-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> u32str <span class="op">=</span> Nstd<span class="op">::</span>SafeStringU32<span class="op">{</span><span class="st">U&quot;かきくけこ&quot;</span><span class="op">};</span></span>
<span id="cb369-12"><a href="#cb369-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-13"><a href="#cb369-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="dt">char32_t</span><span class="op">&amp;,</span> <span class="kw">decltype</span><span class="op">(</span>u32str<span class="op">[</span><span class="dv">0</span><span class="op">])&gt;);</span></span>
<span id="cb369-14"><a href="#cb369-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_base_of_v<span class="op">&lt;</span><span class="bu">std::</span>u32string<span class="op">,</span> <span class="kw">decltype</span><span class="op">(</span>u32str<span class="op">)&gt;);</span></span>
<span id="cb369-15"><a href="#cb369-15" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">5</span><span class="op">,</span> u32str<span class="op">.</span>size<span class="op">());</span></span>
<span id="cb369-16"><a href="#cb369-16" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">U&quot;かきくけこ&quot;</span><span class="op">,</span> u32str<span class="op">);</span></span>
<span id="cb369-17"><a href="#cb369-17" aria-hidden="true" tabindex="-1"></a>    ASSERT_THROW<span class="op">(</span>u32str<span class="op">[</span><span class="dv">5</span><span class="op">],</span> <span class="bu">std::</span>out_of_range<span class="op">);</span></span></code></pre></div>
<h3
id="nstdsafeindexのoperatorの開発">Nstd::SafeIndexのoperator&lt;&lt;の開発
<a id="SS_3_4_3"></a></h3>
<p>ここでは、Nstd::SafeIndexのoperator&lt;&lt;の開発を行う。</p>
<p>他のoperator&lt;&lt;との間で定義が曖昧にならないようにするためには、
テンプレートテンプレートパラメータを使って以下のようにすることが考えられる。</p>
<div class="sourceCode" id="cb370"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb370-1"><a href="#cb370-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/safe_index_put_to_ut.cpp 8</span></span>
<span id="cb370-2"><a href="#cb370-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb370-3"><a href="#cb370-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">template</span> <span class="op">&lt;</span><span class="kw">class</span><span class="op">...&gt;</span> <span class="kw">class</span> C<span class="op">,</span> <span class="kw">typename</span><span class="op">...</span> Ts<span class="op">&gt;</span></span>
<span id="cb370-4"><a href="#cb370-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>ostream<span class="op">&amp;</span> <span class="kw">operator</span><span class="op">&lt;&lt;(</span><span class="bu">std::</span>ostream<span class="op">&amp;</span> os<span class="op">,</span> Nstd<span class="op">::</span>SafeIndex<span class="op">&lt;</span>C<span class="op">,</span> Ts<span class="op">...&gt;</span> <span class="at">const</span><span class="op">&amp;</span> safe_index<span class="op">)</span></span>
<span id="cb370-5"><a href="#cb370-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb370-6"><a href="#cb370-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> first <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb370-7"><a href="#cb370-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb370-8"><a href="#cb370-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> <span class="at">const</span><span class="op">&amp;</span> i <span class="op">:</span> safe_index<span class="op">)</span> <span class="op">{</span></span>
<span id="cb370-9"><a href="#cb370-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(!</span><span class="bu">std::</span>exchange<span class="op">(</span>first<span class="op">,</span> <span class="kw">false</span><span class="op">))</span> <span class="op">{</span></span>
<span id="cb370-10"><a href="#cb370-10" aria-hidden="true" tabindex="-1"></a>                os <span class="op">&lt;&lt;</span> <span class="st">&quot;, &quot;</span><span class="op">;</span></span>
<span id="cb370-11"><a href="#cb370-11" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb370-12"><a href="#cb370-12" aria-hidden="true" tabindex="-1"></a>            os <span class="op">&lt;&lt;</span> i<span class="op">;</span></span>
<span id="cb370-13"><a href="#cb370-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb370-14"><a href="#cb370-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb370-15"><a href="#cb370-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> os<span class="op">;</span></span>
<span id="cb370-16"><a href="#cb370-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>以下の単体テストで動作確認する。</p>
<div class="sourceCode" id="cb371"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb371-1"><a href="#cb371-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/safe_index_put_to_ut.cpp 28</span></span>
<span id="cb371-2"><a href="#cb371-2" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb371-3"><a href="#cb371-3" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> v_i <span class="op">=</span> Nstd<span class="op">::</span>SafeVector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;{</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">};</span></span>
<span id="cb371-4"><a href="#cb371-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-5"><a href="#cb371-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> oss <span class="op">=</span> <span class="bu">std::</span>ostringstream<span class="op">{};</span></span>
<span id="cb371-6"><a href="#cb371-6" aria-hidden="true" tabindex="-1"></a>        oss <span class="op">&lt;&lt;</span> v_i<span class="op">;</span></span>
<span id="cb371-7"><a href="#cb371-7" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;1, 2&quot;</span><span class="op">,</span> oss<span class="op">.</span>str<span class="op">());</span></span>
<span id="cb371-8"><a href="#cb371-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb371-9"><a href="#cb371-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb371-10"><a href="#cb371-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> sal_s <span class="op">=</span> Nstd<span class="op">::</span>SafeArray<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">,</span> <span class="dv">4</span><span class="op">&gt;{</span><span class="st">&quot;1&quot;</span><span class="op">,</span> <span class="st">&quot;2&quot;</span><span class="op">,</span> <span class="st">&quot;3&quot;</span><span class="op">};</span></span>
<span id="cb371-11"><a href="#cb371-11" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> oss   <span class="op">=</span> <span class="bu">std::</span>ostringstream<span class="op">{};</span></span>
<span id="cb371-12"><a href="#cb371-12" aria-hidden="true" tabindex="-1"></a>        oss <span class="op">&lt;&lt;</span> sal_s<span class="op">;</span></span>
<span id="cb371-13"><a href="#cb371-13" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;1, 2, 3, &quot;</span><span class="op">,</span> oss<span class="op">.</span>str<span class="op">());</span>  <span class="co">// 4番目には何も入っていない</span></span>
<span id="cb371-14"><a href="#cb371-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>ここまではうまく行っているが、以下の単体テストによりバグが発覚する。</p>
<div class="sourceCode" id="cb372"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb372-1"><a href="#cb372-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/safe_index_put_to_ut.cpp 43</span></span>
<span id="cb372-2"><a href="#cb372-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb372-3"><a href="#cb372-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb372-4"><a href="#cb372-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> <span class="va">s_str</span> <span class="op">=</span> Nstd<span class="op">::</span>SafeString<span class="op">{</span><span class="st">&quot;hello&quot;</span><span class="op">};</span></span>
<span id="cb372-5"><a href="#cb372-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> oss   <span class="op">=</span> <span class="bu">std::</span>ostringstream<span class="op">{};</span></span>
<span id="cb372-6"><a href="#cb372-6" aria-hidden="true" tabindex="-1"></a>        oss <span class="op">&lt;&lt;</span> <span class="va">s_str</span><span class="op">;</span></span>
<span id="cb372-7"><a href="#cb372-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb372-8"><a href="#cb372-8" aria-hidden="true" tabindex="-1"></a>        <span class="co">// ASSERT_EQ(&quot;hello&quot;, oss.s_str());     // これがパス出来たらよいが、</span></span>
<span id="cb372-9"><a href="#cb372-9" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;h, e, l, l, o&quot;</span><span class="op">,</span> oss<span class="op">.</span>str<span class="op">());</span>  <span class="co">// 実際にはこのようになる。</span></span>
<span id="cb372-10"><a href="#cb372-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb372-11"><a href="#cb372-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb372-12"><a href="#cb372-12" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> str <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{</span><span class="st">&quot;hello&quot;</span><span class="op">};</span>  <span class="co">// 上記と比較のためのstd::stringでのoperator&lt;&lt;</span></span>
<span id="cb372-13"><a href="#cb372-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb372-14"><a href="#cb372-14" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> oss <span class="op">=</span> <span class="bu">std::</span>ostringstream<span class="op">{};</span></span>
<span id="cb372-15"><a href="#cb372-15" aria-hidden="true" tabindex="-1"></a>        oss <span class="op">&lt;&lt;</span> str<span class="op">;</span></span>
<span id="cb372-16"><a href="#cb372-16" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;hello&quot;</span><span class="op">,</span> oss<span class="op">.</span>str<span class="op">());</span></span>
<span id="cb372-17"><a href="#cb372-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>この原因は、Nstd::SafeStringオブジェクトに対して、std::operator&lt;&lt;が使用されなかったからである。</p>
<p>「<a
href="#SS_3_3">メタ関数のテクニック</a>」で紹介したSFINAEにより、この問題は下記のように対処できる。</p>
<div class="sourceCode" id="cb373"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb373-1"><a href="#cb373-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/safe_index_put_to_ut.cpp 102</span></span>
<span id="cb373-2"><a href="#cb373-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-3"><a href="#cb373-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">template</span> <span class="op">&lt;</span><span class="kw">class</span><span class="op">...&gt;</span> <span class="kw">class</span> C<span class="op">,</span> <span class="kw">typename</span><span class="op">...</span> Ts<span class="op">&gt;</span></span>
<span id="cb373-4"><a href="#cb373-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> <span class="kw">operator</span><span class="op">&lt;&lt;(</span><span class="bu">std::</span>ostream<span class="op">&amp;</span> os<span class="op">,</span> Nstd<span class="op">::</span>SafeIndex<span class="op">&lt;</span>C<span class="op">,</span> Ts<span class="op">...&gt;</span> <span class="at">const</span><span class="op">&amp;</span> safe_index<span class="op">)</span> <span class="op">-&gt;</span></span>
<span id="cb373-5"><a href="#cb373-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">typename</span> <span class="bu">std::</span>enable_if_t<span class="op">&lt;</span>    <span class="co">// safe_indexがSafeString型ならば、SFINAEにより非活性化</span></span>
<span id="cb373-6"><a href="#cb373-6" aria-hidden="true" tabindex="-1"></a>            <span class="op">!</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span>Nstd<span class="op">::</span>SafeIndex<span class="op">&lt;</span>C<span class="op">,</span> Ts<span class="op">...&gt;,</span> Nstd<span class="op">::</span>SafeString<span class="op">&gt;,</span> <span class="bu">std::</span>ostream<span class="op">&amp;&gt;</span></span>
<span id="cb373-7"><a href="#cb373-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb373-8"><a href="#cb373-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> first <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb373-9"><a href="#cb373-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-10"><a href="#cb373-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> <span class="at">const</span><span class="op">&amp;</span> i <span class="op">:</span> safe_index<span class="op">)</span> <span class="op">{</span></span>
<span id="cb373-11"><a href="#cb373-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(!</span><span class="bu">std::</span>exchange<span class="op">(</span>first<span class="op">,</span> <span class="kw">false</span><span class="op">))</span> <span class="op">{</span></span>
<span id="cb373-12"><a href="#cb373-12" aria-hidden="true" tabindex="-1"></a>                os <span class="op">&lt;&lt;</span> <span class="st">&quot;, &quot;</span><span class="op">;</span></span>
<span id="cb373-13"><a href="#cb373-13" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb373-14"><a href="#cb373-14" aria-hidden="true" tabindex="-1"></a>            os <span class="op">&lt;&lt;</span> i<span class="op">;</span></span>
<span id="cb373-15"><a href="#cb373-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb373-16"><a href="#cb373-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-17"><a href="#cb373-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> os<span class="op">;</span></span>
<span id="cb373-18"><a href="#cb373-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>これにより先ほど問題が発生した単体テストも下記のようにパスする。</p>
<div class="sourceCode" id="cb374"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb374-1"><a href="#cb374-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/safe_index_put_to_ut.cpp 138</span></span>
<span id="cb374-2"><a href="#cb374-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb374-3"><a href="#cb374-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> str <span class="op">=</span> Nstd<span class="op">::</span>SafeString<span class="op">{</span><span class="st">&quot;hello&quot;</span><span class="op">};</span></span>
<span id="cb374-4"><a href="#cb374-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> oss <span class="op">=</span> <span class="bu">std::</span>ostringstream<span class="op">{};</span></span>
<span id="cb374-5"><a href="#cb374-5" aria-hidden="true" tabindex="-1"></a>    oss <span class="op">&lt;&lt;</span> str<span class="op">;</span></span>
<span id="cb374-6"><a href="#cb374-6" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;hello&quot;</span><span class="op">,</span> oss<span class="op">.</span>str<span class="op">());</span>  <span class="co">// std::operator&lt;&lt;が使われる</span></span>
<span id="cb374-7"><a href="#cb374-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ASSERT_EQ(&quot;h, e, l, l, o&quot;, oss.str());</span></span></code></pre></div>
<h3
id="コンテナ用nstdoperatorの開発">コンテナ用Nstd::operator&lt;&lt;の開発
<a id="SS_3_4_4"></a></h3>
<p>「<a
href="#SS_3_4_3">Nstd::SafeIndexのoperator&lt;&lt;の開発</a>」で定義したNstd::operator&lt;&lt;の構造は、
範囲for文に適用できる配列やstdコンテナにも使えるため、ここではその拡張を考える。</p>
<p>すでに述べたように注意すべきは、</p>
<ul>
<li>使い勝手の良いstd::operator&lt;&lt;(例えばchar[N]やstd::stringのoperator&lt;&lt;)はそのまま使う</li>
<li>ほとんど使い物にならないstd::operator&lt;&lt;(例えば、int[N]のような配列に対するoperator&lt;&lt;(void*))
の代わりに、ここで拡張するNstd::operator&lt;&lt;を使う</li>
</ul>
<p>であるため、型Tが新しいNstd::operator&lt;&lt;を使用できる条件は、</p>
<ul>
<li>Tの型が、以下の条件を満たす
<ul>
<li>T == U[N]であった場合、Uはcharではない</li>
<li>std::stringおよびその派生型ではない</li>
</ul></li>
<li>Nstd::ValueType&lt;T&gt;::typeがoperator&lt;&lt;を持つ</li>
</ul>
<p>となるだろう。この条件を診断するためのメタ関数は以下のようになる。</p>
<div class="sourceCode" id="cb375"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb375-1"><a href="#cb375-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_put_to.h 16</span></span>
<span id="cb375-2"><a href="#cb375-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3"><a href="#cb375-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> Nstd <span class="op">{</span></span>
<span id="cb375-4"><a href="#cb375-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> Inner_ <span class="op">{</span></span>
<span id="cb375-5"><a href="#cb375-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6"><a href="#cb375-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb375-7"><a href="#cb375-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> enable_range_put_to<span class="op">()</span> <span class="kw">noexcept</span></span>
<span id="cb375-8"><a href="#cb375-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb375-9"><a href="#cb375-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">constexpr</span> <span class="op">(</span>Nstd<span class="op">::</span>ValueType<span class="op">&lt;</span>T<span class="op">&gt;::</span>IsBuiltinArray<span class="op">)</span> <span class="op">{</span>  <span class="co">// Tは配列</span></span>
<span id="cb375-10"><a href="#cb375-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">constexpr</span> <span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="dt">char</span><span class="op">,</span></span>
<span id="cb375-11"><a href="#cb375-11" aria-hidden="true" tabindex="-1"></a>                                         <span class="kw">typename</span> Nstd<span class="op">::</span>ValueType<span class="op">&lt;</span>T<span class="op">&gt;::</span>type_direct<span class="op">&gt;)</span> <span class="op">{</span>  <span class="co">// Tはchar配列</span></span>
<span id="cb375-12"><a href="#cb375-12" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb375-13"><a href="#cb375-13" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb375-14"><a href="#cb375-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb375-15"><a href="#cb375-15" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> Nstd<span class="op">::</span>ExistsPutToV<span class="op">&lt;</span><span class="kw">typename</span> Nstd<span class="op">::</span>ValueTypeT<span class="op">&lt;</span>T<span class="op">&gt;&gt;;</span></span>
<span id="cb375-16"><a href="#cb375-16" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb375-17"><a href="#cb375-17" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb375-18"><a href="#cb375-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="op">{</span>  <span class="co">// Tは配列ではない</span></span>
<span id="cb375-19"><a href="#cb375-19" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#if defined(__clang__)</span></span>
<span id="cb375-20"><a href="#cb375-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">constexpr</span> <span class="op">(</span>Nstd<span class="op">::</span>ExistsPutToV<span class="op">&lt;</span>T<span class="op">&gt;)</span> <span class="op">{</span>  <span class="co">// operator&lt;&lt;を持つ(std::string等)</span></span>
<span id="cb375-21"><a href="#cb375-21" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#else                                           </span><span class="co">// g++でのワークアラウンド</span></span>
<span id="cb375-22"><a href="#cb375-22" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>Nstd<span class="op">::</span>ExistsPutToV<span class="op">&lt;</span>T<span class="op">&gt;)</span> <span class="op">{</span>  <span class="co">// operator&lt;&lt;を持つ(std::string等)</span></span>
<span id="cb375-23"><a href="#cb375-23" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#endif</span></span>
<span id="cb375-24"><a href="#cb375-24" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb375-25"><a href="#cb375-25" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb375-26"><a href="#cb375-26" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb375-27"><a href="#cb375-27" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">constexpr</span> <span class="op">(</span>Nstd<span class="op">::</span>IsRangeV<span class="op">&lt;</span>T<span class="op">&gt;)</span> <span class="op">{</span>  <span class="co">// 範囲for文に適用できる</span></span>
<span id="cb375-28"><a href="#cb375-28" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> Nstd<span class="op">::</span>ExistsPutToV<span class="op">&lt;</span><span class="kw">typename</span> Nstd<span class="op">::</span>ValueTypeT<span class="op">&lt;</span>T<span class="op">&gt;&gt;;</span></span>
<span id="cb375-29"><a href="#cb375-29" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span></span>
<span id="cb375-30"><a href="#cb375-30" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb375-31"><a href="#cb375-31" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb375-32"><a href="#cb375-32" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span></span>
<span id="cb375-33"><a href="#cb375-33" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb375-34"><a href="#cb375-34" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb375-35"><a href="#cb375-35" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb375-36"><a href="#cb375-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-37"><a href="#cb375-37" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb375-38"><a href="#cb375-38" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> enable_range_put_to_v<span class="op">{</span>enable_range_put_to<span class="op">&lt;</span>T<span class="op">&gt;()};</span></span>
<span id="cb375-39"><a href="#cb375-39" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace Inner_</span></span>
<span id="cb375-40"><a href="#cb375-40" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace Nstd</span></span></code></pre></div>
<p>ただし、このようなコードはコンパイラのバグによりコンパイルできないことがある。
実際、現在使用中の<a
href="#SS_5_9_1">g++</a>ではこのコードはコンパイルできず、
上記コードではそのワークアラウンドを行っている。</p>
<p>このような場合、条件分岐に三項演算子を使うことで回避できることが多いが、
ここではg++の問題を明示するためにプリプロセッサ命令を用いた。</p>
<p>このような複雑なメタ関数には単体テストは必須である。</p>
<div class="sourceCode" id="cb376"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb376-1"><a href="#cb376-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/test_class.h 3</span></span>
<span id="cb376-2"><a href="#cb376-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb376-3"><a href="#cb376-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> test_class_exits_put_to <span class="op">{</span></span>
<span id="cb376-4"><a href="#cb376-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb376-5"><a href="#cb376-5" aria-hidden="true" tabindex="-1"></a>        test_class_exits_put_to<span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">)</span> <span class="kw">noexcept</span> <span class="op">:</span> <span class="va">i_</span><span class="op">{</span>i<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb376-6"><a href="#cb376-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> get<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">i_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb376-7"><a href="#cb376-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb376-8"><a href="#cb376-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb376-9"><a href="#cb376-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> <span class="va">i_</span><span class="op">;</span></span>
<span id="cb376-10"><a href="#cb376-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb376-11"><a href="#cb376-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb376-12"><a href="#cb376-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">inline</span> <span class="bu">std::</span>ostream<span class="op">&amp;</span> <span class="kw">operator</span><span class="op">&lt;&lt;(</span><span class="bu">std::</span>ostream<span class="op">&amp;</span> os<span class="op">,</span> test_class_exits_put_to <span class="at">const</span><span class="op">&amp;</span> p<span class="op">)</span></span>
<span id="cb376-13"><a href="#cb376-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb376-14"><a href="#cb376-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> os <span class="op">&lt;&lt;</span> p<span class="op">.</span>get<span class="op">();</span></span>
<span id="cb376-15"><a href="#cb376-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb376-16"><a href="#cb376-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb376-17"><a href="#cb376-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> test_class_not_exits_put_to <span class="op">{};</span></span></code></pre></div>
<div class="sourceCode" id="cb377"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb377-1"><a href="#cb377-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_put_to_ut.cpp 31</span></span>
<span id="cb377-2"><a href="#cb377-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb377-3"><a href="#cb377-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>enable_range_put_to_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">[</span><span class="dv">3</span><span class="op">]&gt;);</span>                         <span class="co">// Nstd::operator&lt;&lt;</span></span>
<span id="cb377-4"><a href="#cb377-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>enable_range_put_to_v<span class="op">&lt;</span><span class="dt">char</span><span class="op">[</span><span class="dv">3</span><span class="op">]&gt;);</span>                       <span class="co">// std::operator&lt;&lt;</span></span>
<span id="cb377-5"><a href="#cb377-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>enable_range_put_to_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;);</span>                           <span class="co">// std::operator&lt;&lt;</span></span>
<span id="cb377-6"><a href="#cb377-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>enable_range_put_to_v<span class="op">&lt;</span><span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;&gt;);</span>               <span class="co">// Nstd::operator&lt;&lt;</span></span>
<span id="cb377-7"><a href="#cb377-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>enable_range_put_to_v<span class="op">&lt;</span><span class="bu">std::</span>vector<span class="op">&lt;</span><span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;&gt;&gt;);</span>  <span class="co">// Nstd::operator&lt;&lt;</span></span>
<span id="cb377-8"><a href="#cb377-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>enable_range_put_to_v<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;);</span>                   <span class="co">// std::operator&lt;&lt;</span></span>
<span id="cb377-9"><a href="#cb377-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>enable_range_put_to_v<span class="op">&lt;</span><span class="bu">std::</span>vector<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;&gt;);</span>       <span class="co">// Nstd::operator&lt;&lt;</span></span>
<span id="cb377-10"><a href="#cb377-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb377-11"><a href="#cb377-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>enable_range_put_to_v<span class="op">&lt;</span>test_class_not_exits_put_to<span class="op">&gt;);</span>  <span class="co">// operator&lt;&lt;無し</span></span>
<span id="cb377-12"><a href="#cb377-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span>enable_range_put_to_v<span class="op">&lt;</span>test_class_exits_put_to<span class="op">&gt;);</span>  <span class="co">// ユーザ定義operator&lt;&lt;</span></span>
<span id="cb377-13"><a href="#cb377-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span></span>
<span id="cb377-14"><a href="#cb377-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">!</span>enable_range_put_to_v<span class="op">&lt;</span><span class="bu">std::</span>vector<span class="op">&lt;</span>test_class_not_exits_put_to<span class="op">&gt;&gt;);</span>       <span class="co">// operator&lt;&lt;無し</span></span>
<span id="cb377-15"><a href="#cb377-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>enable_range_put_to_v<span class="op">&lt;</span><span class="bu">std::</span>vector<span class="op">&lt;</span>test_class_exits_put_to<span class="op">&gt;&gt;);</span>  <span class="co">// Nstd::operator&lt;&lt;</span></span>
<span id="cb377-16"><a href="#cb377-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span></span>
<span id="cb377-17"><a href="#cb377-17" aria-hidden="true" tabindex="-1"></a>        <span class="op">!</span>enable_range_put_to_v<span class="op">&lt;</span><span class="bu">std::</span>list<span class="op">&lt;</span>test_class_not_exits_put_to<span class="op">&gt;&gt;);</span>       <span class="co">// operator&lt;&lt;無し</span></span>
<span id="cb377-18"><a href="#cb377-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>enable_range_put_to_v<span class="op">&lt;</span><span class="bu">std::</span>list<span class="op">&lt;</span>test_class_exits_put_to<span class="op">&gt;&gt;);</span>  <span class="co">// Nstd::operator&lt;&lt;</span></span></code></pre></div>
<p>以上によりstd::enable_ifの第1引数に渡す値(enable_range_put_to_vはconstexpr)が用意できたので、
Nstd::operator&lt;&lt;は下記のように定義できる。</p>
<div class="sourceCode" id="cb378"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb378-1"><a href="#cb378-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_put_to.h 58</span></span>
<span id="cb378-2"><a href="#cb378-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-3"><a href="#cb378-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> Nstd <span class="op">{</span></span>
<span id="cb378-4"><a href="#cb378-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> Inner_ <span class="op">{</span></span>
<span id="cb378-5"><a href="#cb378-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-6"><a href="#cb378-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="dt">size_t</span> N<span class="op">&gt;</span></span>
<span id="cb378-7"><a href="#cb378-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="bu">std::</span>string_view<span class="op"> </span>range_put_to_sep<span class="op">()</span> <span class="kw">noexcept</span></span>
<span id="cb378-8"><a href="#cb378-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb378-9"><a href="#cb378-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">static_assert</span><span class="op">(</span>N <span class="op">!=</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb378-10"><a href="#cb378-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">switch</span> <span class="op">(</span>N<span class="op">)</span> <span class="op">{</span></span>
<span id="cb378-11"><a href="#cb378-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="dv">1</span><span class="op">:</span></span>
<span id="cb378-12"><a href="#cb378-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&quot;, &quot;</span><span class="op">;</span></span>
<span id="cb378-13"><a href="#cb378-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="dv">2</span><span class="op">:</span></span>
<span id="cb378-14"><a href="#cb378-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&quot; | &quot;</span><span class="op">;</span></span>
<span id="cb378-15"><a href="#cb378-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="dv">3</span><span class="op">:</span></span>
<span id="cb378-16"><a href="#cb378-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">default</span><span class="op">:</span></span>
<span id="cb378-17"><a href="#cb378-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&quot; # &quot;</span><span class="op">;</span></span>
<span id="cb378-18"><a href="#cb378-18" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb378-19"><a href="#cb378-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb378-20"><a href="#cb378-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace Inner_</span></span>
<span id="cb378-21"><a href="#cb378-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-22"><a href="#cb378-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb378-23"><a href="#cb378-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> <span class="kw">operator</span><span class="op">&lt;&lt;(</span><span class="bu">std::</span>ostream<span class="op">&amp;</span> os<span class="op">,</span> T <span class="at">const</span><span class="op">&amp;</span> t<span class="op">)</span> <span class="op">-&gt;</span></span>
<span id="cb378-24"><a href="#cb378-24" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#if defined(__clang__)</span></span>
<span id="cb378-25"><a href="#cb378-25" aria-hidden="true" tabindex="-1"></a>        <span class="kw">typename</span> <span class="bu">std::</span>enable_if_t<span class="op">&lt;</span>Inner_<span class="op">::</span>enable_range_put_to_v<span class="op">&lt;</span>T<span class="op">&gt;,</span> <span class="bu">std::</span>ostream<span class="op">&amp;&gt;</span></span>
<span id="cb378-26"><a href="#cb378-26" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#else  </span><span class="co">// g++でのワークアラウンド</span></span>
<span id="cb378-27"><a href="#cb378-27" aria-hidden="true" tabindex="-1"></a>        <span class="kw">typename</span> <span class="bu">std::</span>enable_if_t<span class="op">&lt;</span>Inner_<span class="op">::</span>enable_range_put_to<span class="op">&lt;</span>T<span class="op">&gt;(),</span> <span class="bu">std::</span>ostream<span class="op">&amp;&gt;</span></span>
<span id="cb378-28"><a href="#cb378-28" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#endif</span></span>
<span id="cb378-29"><a href="#cb378-29" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb378-30"><a href="#cb378-30" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span>           first <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb378-31"><a href="#cb378-31" aria-hidden="true" tabindex="-1"></a>        <span class="kw">constexpr</span> <span class="kw">auto</span> s     <span class="op">=</span> Inner_<span class="op">::</span>range_put_to_sep<span class="op">&lt;</span>ValueType<span class="op">&lt;</span>T<span class="op">&gt;::</span>Nest<span class="op">&gt;();</span></span>
<span id="cb378-32"><a href="#cb378-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-33"><a href="#cb378-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> <span class="at">const</span><span class="op">&amp;</span> i <span class="op">:</span> t<span class="op">)</span> <span class="op">{</span></span>
<span id="cb378-34"><a href="#cb378-34" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(!</span><span class="bu">std::</span>exchange<span class="op">(</span>first<span class="op">,</span> <span class="kw">false</span><span class="op">))</span> <span class="op">{</span></span>
<span id="cb378-35"><a href="#cb378-35" aria-hidden="true" tabindex="-1"></a>                os <span class="op">&lt;&lt;</span> s<span class="op">;</span></span>
<span id="cb378-36"><a href="#cb378-36" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb378-37"><a href="#cb378-37" aria-hidden="true" tabindex="-1"></a>            os <span class="op">&lt;&lt;</span> i<span class="op">;</span></span>
<span id="cb378-38"><a href="#cb378-38" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb378-39"><a href="#cb378-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-40"><a href="#cb378-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> os<span class="op">;</span></span>
<span id="cb378-41"><a href="#cb378-41" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb378-42"><a href="#cb378-42" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace Nstd</span></span></code></pre></div>
<p>値表示用のセパレータに”,“のみを用いるとコンテナや配列が多次元(ValueType::Nest
&gt; 2)の場合、
各次元でのデータの判別が難しくなるため、ValueType::Nestの値によってセパレータの種類を変える
range_put_to_sep&lt;&gt;()を用意した。
下記単体テストでわかる通り、この効果により値の構造が見やすくなっている。</p>
<p>まずは、配列の単体テストを示す。</p>
<div class="sourceCode" id="cb379"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb379-1"><a href="#cb379-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_put_to_ut.cpp 61</span></span>
<span id="cb379-2"><a href="#cb379-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-3"><a href="#cb379-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> <span class="kw">namespace</span> Nstd<span class="op">;</span></span>
<span id="cb379-4"><a href="#cb379-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb379-5"><a href="#cb379-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">char</span> str<span class="op">[]</span> <span class="op">=</span> <span class="st">&quot;abcdef&quot;</span><span class="op">;</span></span>
<span id="cb379-6"><a href="#cb379-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> oss   <span class="op">=</span> <span class="bu">std::</span>ostringstream<span class="op">{};</span></span>
<span id="cb379-7"><a href="#cb379-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-8"><a href="#cb379-8" aria-hidden="true" tabindex="-1"></a>        oss <span class="op">&lt;&lt;</span> str<span class="op">;</span>  <span class="co">// std::operator&lt;&lt;</span></span>
<span id="cb379-9"><a href="#cb379-9" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span>str<span class="op">,</span> oss<span class="op">.</span>str<span class="op">());</span></span>
<span id="cb379-10"><a href="#cb379-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb379-11"><a href="#cb379-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb379-12"><a href="#cb379-12" aria-hidden="true" tabindex="-1"></a>        <span class="dt">char</span> str<span class="op">[</span><span class="dv">2</span><span class="op">][</span><span class="dv">4</span><span class="op">]</span> <span class="op">=</span> <span class="op">{</span><span class="st">&quot;abc&quot;</span><span class="op">,</span> <span class="st">&quot;def&quot;</span><span class="op">};</span></span>
<span id="cb379-13"><a href="#cb379-13" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> oss       <span class="op">=</span> <span class="bu">std::</span>ostringstream<span class="op">{};</span></span>
<span id="cb379-14"><a href="#cb379-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-15"><a href="#cb379-15" aria-hidden="true" tabindex="-1"></a>        oss <span class="op">&lt;&lt;</span> str<span class="op">;</span>  <span class="co">// Nstd::operator&lt;&lt;</span></span>
<span id="cb379-16"><a href="#cb379-16" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;abc | def&quot;</span><span class="op">,</span> oss<span class="op">.</span>str<span class="op">());</span></span>
<span id="cb379-17"><a href="#cb379-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb379-18"><a href="#cb379-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb379-19"><a href="#cb379-19" aria-hidden="true" tabindex="-1"></a>        test_class_exits_put_to p1<span class="op">[</span><span class="dv">3</span><span class="op">]{</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">};</span></span>
<span id="cb379-20"><a href="#cb379-20" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span>                    oss <span class="op">=</span> <span class="bu">std::</span>ostringstream<span class="op">{};</span></span>
<span id="cb379-21"><a href="#cb379-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-22"><a href="#cb379-22" aria-hidden="true" tabindex="-1"></a>        oss <span class="op">&lt;&lt;</span> p1<span class="op">;</span>  <span class="co">// Nstd::operator&lt;&lt;</span></span>
<span id="cb379-23"><a href="#cb379-23" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;1, 2, 3&quot;</span><span class="op">,</span> oss<span class="op">.</span>str<span class="op">());</span></span>
<span id="cb379-24"><a href="#cb379-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb379-25"><a href="#cb379-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb379-26"><a href="#cb379-26" aria-hidden="true" tabindex="-1"></a>        <span class="dt">char</span> <span class="at">const</span><span class="op">*</span> str<span class="op">[]</span> <span class="op">=</span> <span class="op">{</span><span class="st">&quot;abc&quot;</span><span class="op">,</span> <span class="st">&quot;def&quot;</span><span class="op">,</span> <span class="st">&quot;ghi&quot;</span><span class="op">};</span></span>
<span id="cb379-27"><a href="#cb379-27" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span>        oss   <span class="op">=</span> <span class="bu">std::</span>ostringstream<span class="op">{};</span></span>
<span id="cb379-28"><a href="#cb379-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-29"><a href="#cb379-29" aria-hidden="true" tabindex="-1"></a>        oss <span class="op">&lt;&lt;</span> str<span class="op">;</span>  <span class="co">// Nstd::operator&lt;&lt;</span></span>
<span id="cb379-30"><a href="#cb379-30" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;abc, def, ghi&quot;</span><span class="op">,</span> oss<span class="op">.</span>str<span class="op">());</span></span>
<span id="cb379-31"><a href="#cb379-31" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb379-32"><a href="#cb379-32" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb379-33"><a href="#cb379-33" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span>  v<span class="op">[</span><span class="dv">2</span><span class="op">][</span><span class="dv">3</span><span class="op">][</span><span class="dv">2</span><span class="op">]{{{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="op">{</span><span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">},</span> <span class="op">{</span><span class="dv">4</span><span class="op">,</span> <span class="dv">5</span><span class="op">}},</span> <span class="op">{{</span><span class="dv">6</span><span class="op">,</span> <span class="dv">7</span><span class="op">},</span> <span class="op">{</span><span class="dv">8</span><span class="op">,</span> <span class="dv">9</span><span class="op">},</span> <span class="op">{</span><span class="dv">10</span><span class="op">,</span> <span class="dv">11</span><span class="op">}}};</span></span>
<span id="cb379-34"><a href="#cb379-34" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> oss <span class="op">=</span> <span class="bu">std::</span>ostringstream<span class="op">{};</span></span>
<span id="cb379-35"><a href="#cb379-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-36"><a href="#cb379-36" aria-hidden="true" tabindex="-1"></a>        oss <span class="op">&lt;&lt;</span> v<span class="op">;</span></span>
<span id="cb379-37"><a href="#cb379-37" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;0, 1 | 2, 3 | 4, 5 # 6, 7 | 8, 9 | 10, 11&quot;</span><span class="op">,</span> oss<span class="op">.</span>str<span class="op">());</span></span>
<span id="cb379-38"><a href="#cb379-38" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>次に、コンテナの単体テストを示す。</p>
<div class="sourceCode" id="cb380"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb380-1"><a href="#cb380-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_put_to_ut.cpp 118</span></span>
<span id="cb380-2"><a href="#cb380-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb380-3"><a href="#cb380-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> <span class="kw">namespace</span> Nstd<span class="op">;</span></span>
<span id="cb380-4"><a href="#cb380-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb380-5"><a href="#cb380-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> v   <span class="op">=</span> <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;{</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">};</span></span>
<span id="cb380-6"><a href="#cb380-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> oss <span class="op">=</span> <span class="bu">std::</span>ostringstream<span class="op">{};</span></span>
<span id="cb380-7"><a href="#cb380-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb380-8"><a href="#cb380-8" aria-hidden="true" tabindex="-1"></a>        oss <span class="op">&lt;&lt;</span> v<span class="op">;</span></span>
<span id="cb380-9"><a href="#cb380-9" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;1, 2, 3&quot;</span><span class="op">,</span> oss<span class="op">.</span>str<span class="op">());</span></span>
<span id="cb380-10"><a href="#cb380-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb380-11"><a href="#cb380-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb380-12"><a href="#cb380-12" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> p1  <span class="op">=</span> <span class="bu">std::</span>list<span class="op">&lt;</span>test_class_exits_put_to<span class="op">&gt;{</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">4</span><span class="op">};</span></span>
<span id="cb380-13"><a href="#cb380-13" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> oss <span class="op">=</span> <span class="bu">std::</span>ostringstream<span class="op">{};</span></span>
<span id="cb380-14"><a href="#cb380-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb380-15"><a href="#cb380-15" aria-hidden="true" tabindex="-1"></a>        oss <span class="op">&lt;&lt;</span> p1<span class="op">;</span></span>
<span id="cb380-16"><a href="#cb380-16" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;1, 2, 3, 4&quot;</span><span class="op">,</span> oss<span class="op">.</span>str<span class="op">());</span></span>
<span id="cb380-17"><a href="#cb380-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb380-18"><a href="#cb380-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb380-19"><a href="#cb380-19" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> v<span class="op">[</span><span class="dv">2</span><span class="op">]{{</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">},</span> <span class="op">{</span><span class="dv">3</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">5</span><span class="op">}};</span>  <span class="co">// std::vectorの配列</span></span>
<span id="cb380-20"><a href="#cb380-20" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span>             oss <span class="op">=</span> <span class="bu">std::</span>ostringstream<span class="op">{};</span></span>
<span id="cb380-21"><a href="#cb380-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb380-22"><a href="#cb380-22" aria-hidden="true" tabindex="-1"></a>        oss <span class="op">&lt;&lt;</span> v<span class="op">;</span></span>
<span id="cb380-23"><a href="#cb380-23" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;1, 2 | 3, 4, 5&quot;</span><span class="op">,</span> oss<span class="op">.</span>str<span class="op">());</span></span>
<span id="cb380-24"><a href="#cb380-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>最後に、Nstd::SafeIndexの単体テストを示す。</p>
<div class="sourceCode" id="cb381"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb381-1"><a href="#cb381-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_put_to_ut.cpp 168</span></span>
<span id="cb381-2"><a href="#cb381-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb381-3"><a href="#cb381-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb381-4"><a href="#cb381-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> sal_s <span class="op">=</span> Nstd<span class="op">::</span>SafeArray<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">,</span> <span class="dv">4</span><span class="op">&gt;{</span><span class="st">&quot;1&quot;</span><span class="op">,</span> <span class="st">&quot;2&quot;</span><span class="op">,</span> <span class="st">&quot;3&quot;</span><span class="op">};</span></span>
<span id="cb381-5"><a href="#cb381-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> oss   <span class="op">=</span> <span class="bu">std::</span>ostringstream<span class="op">{};</span></span>
<span id="cb381-6"><a href="#cb381-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb381-7"><a href="#cb381-7" aria-hidden="true" tabindex="-1"></a>        oss <span class="op">&lt;&lt;</span> sal_s<span class="op">;</span></span>
<span id="cb381-8"><a href="#cb381-8" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;1 | 2 | 3 | &quot;</span><span class="op">,</span> oss<span class="op">.</span>str<span class="op">());</span></span>
<span id="cb381-9"><a href="#cb381-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb381-10"><a href="#cb381-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb381-11"><a href="#cb381-11" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> sv</span>
<span id="cb381-12"><a href="#cb381-12" aria-hidden="true" tabindex="-1"></a>            <span class="op">=</span> Nstd<span class="op">::</span>SafeVector<span class="op">&lt;</span>Nstd<span class="op">::</span>SafeArray<span class="op">&lt;</span>Nstd<span class="op">::</span>SafeString<span class="op">,</span> <span class="dv">2</span><span class="op">&gt;&gt;{{</span><span class="st">&quot;ab&quot;</span><span class="op">,</span> <span class="st">&quot;cd&quot;</span><span class="op">},</span> <span class="op">{</span><span class="st">&quot;ef&quot;</span><span class="op">,</span> <span class="st">&quot;gh&quot;</span><span class="op">}};</span></span>
<span id="cb381-13"><a href="#cb381-13" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> oss <span class="op">=</span> <span class="bu">std::</span>ostringstream<span class="op">{};</span></span>
<span id="cb381-14"><a href="#cb381-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb381-15"><a href="#cb381-15" aria-hidden="true" tabindex="-1"></a>        oss <span class="op">&lt;&lt;</span> sv<span class="op">;</span></span>
<span id="cb381-16"><a href="#cb381-16" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;ab | cd # ef | gh&quot;</span><span class="op">,</span> oss<span class="op">.</span>str<span class="op">());</span></span>
<span id="cb381-17"><a href="#cb381-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<h2 id="ログ取得ライブラリの開発2">ログ取得ライブラリの開発2
<a id="SS_3_5"></a></h2>
<p>ログ取得ライブラリでの問題は「Logging名前空間が依存してよい名前空間」に</p>
<div class="sourceCode" id="cb382"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb382-1"><a href="#cb382-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/app_ints.h 6</span></span>
<span id="cb382-2"><a href="#cb382-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb382-3"><a href="#cb382-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> App <span class="op">{</span></span>
<span id="cb382-4"><a href="#cb382-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> <span class="dt">Ints_t</span> <span class="op">=</span> <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;;</span></span>
<span id="cb382-5"><a href="#cb382-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>のようなコンテナに共通したoperator&lt;&lt;を定義することで解決する。
それは 「<a
href="#SS_3_4_4">コンテナ用Nstd::operator&lt;&lt;の開発</a>」で示したコードそのものであるため、
これを使い、問題を解決したログ取得ライブラリを以下に示す。</p>
<div class="sourceCode" id="cb383"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb383-1"><a href="#cb383-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/logger.h 7</span></span>
<span id="cb383-2"><a href="#cb383-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb383-3"><a href="#cb383-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> Logging <span class="op">{</span></span>
<span id="cb383-4"><a href="#cb383-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Logger <span class="op">{</span></span>
<span id="cb383-5"><a href="#cb383-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb383-6"><a href="#cb383-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> Logger<span class="op">&amp;</span>       Inst<span class="op">();</span></span>
<span id="cb383-7"><a href="#cb383-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> Logger <span class="at">const</span><span class="op">&amp;</span> InstConst<span class="op">()</span> <span class="op">{</span> <span class="cf">return</span> Inst<span class="op">();</span> <span class="op">}</span></span>
<span id="cb383-8"><a href="#cb383-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb383-9"><a href="#cb383-9" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span>Get<span class="op">()</span> <span class="at">const</span><span class="op">;</span>  <span class="co">// ログデータの取得</span></span>
<span id="cb383-10"><a href="#cb383-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span>        Clear<span class="op">();</span>      <span class="co">// ログデータの消去</span></span>
<span id="cb383-11"><a href="#cb383-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb383-12"><a href="#cb383-12" aria-hidden="true" tabindex="-1"></a>        <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span><span class="op">...</span> ARGS<span class="op">&gt;</span>  <span class="co">// ログの登録</span></span>
<span id="cb383-13"><a href="#cb383-13" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> Set<span class="op">(</span><span class="dt">char</span> <span class="at">const</span><span class="op">*</span> filename<span class="op">,</span> <span class="dt">uint32_t</span> line_no<span class="op">,</span> ARGS <span class="at">const</span><span class="op">&amp;...</span> args<span class="op">)</span></span>
<span id="cb383-14"><a href="#cb383-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb383-15"><a href="#cb383-15" aria-hidden="true" tabindex="-1"></a>            <span class="va">oss_</span><span class="op">.</span>width<span class="op">(</span><span class="dv">32</span><span class="op">);</span></span>
<span id="cb383-16"><a href="#cb383-16" aria-hidden="true" tabindex="-1"></a>            <span class="va">oss_</span> <span class="op">&lt;&lt;</span> filename <span class="op">&lt;&lt;</span> <span class="st">&quot;:&quot;</span><span class="op">;</span></span>
<span id="cb383-17"><a href="#cb383-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb383-18"><a href="#cb383-18" aria-hidden="true" tabindex="-1"></a>            <span class="va">oss_</span><span class="op">.</span>width<span class="op">(</span><span class="dv">3</span><span class="op">);</span></span>
<span id="cb383-19"><a href="#cb383-19" aria-hidden="true" tabindex="-1"></a>            <span class="va">oss_</span> <span class="op">&lt;&lt;</span> line_no<span class="op">;</span></span>
<span id="cb383-20"><a href="#cb383-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb383-21"><a href="#cb383-21" aria-hidden="true" tabindex="-1"></a>            set_inner<span class="op">(</span>args<span class="op">...);</span></span>
<span id="cb383-22"><a href="#cb383-22" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb383-23"><a href="#cb383-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb383-24"><a href="#cb383-24" aria-hidden="true" tabindex="-1"></a>        Logger<span class="op">(</span>Logger <span class="at">const</span><span class="op">&amp;)</span>            <span class="op">=</span> <span class="kw">delete</span><span class="op">;</span></span>
<span id="cb383-25"><a href="#cb383-25" aria-hidden="true" tabindex="-1"></a>        Logger<span class="op">&amp;</span> <span class="kw">operator</span><span class="op">=(</span>Logger <span class="at">const</span><span class="op">&amp;)</span> <span class="op">=</span> <span class="kw">delete</span><span class="op">;</span></span>
<span id="cb383-26"><a href="#cb383-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb383-27"><a href="#cb383-27" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb383-28"><a href="#cb383-28" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> set_inner<span class="op">()</span> <span class="op">{</span> <span class="va">oss_</span> <span class="op">&lt;&lt;</span> <span class="bu">std::</span>endl<span class="op">;</span> <span class="op">}</span></span>
<span id="cb383-29"><a href="#cb383-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb383-30"><a href="#cb383-30" aria-hidden="true" tabindex="-1"></a>        <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> HEAD<span class="op">,</span> <span class="kw">typename</span><span class="op">...</span> TAIL<span class="op">&gt;</span></span>
<span id="cb383-31"><a href="#cb383-31" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> set_inner<span class="op">(</span>HEAD <span class="at">const</span><span class="op">&amp;</span> head<span class="op">,</span> TAIL <span class="at">const</span><span class="op">&amp;...</span> tails<span class="op">)</span></span>
<span id="cb383-32"><a href="#cb383-32" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb383-33"><a href="#cb383-33" aria-hidden="true" tabindex="-1"></a>            <span class="kw">using</span> Nstd<span class="op">::</span><span class="kw">operator</span><span class="op">&lt;&lt;;</span>  <span class="co">// Nstd::operator&lt;&lt;もname lookupの対象にする</span></span>
<span id="cb383-34"><a href="#cb383-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb383-35"><a href="#cb383-35" aria-hidden="true" tabindex="-1"></a>            <span class="va">oss_</span> <span class="op">&lt;&lt;</span> <span class="st">&quot;:&quot;</span> <span class="op">&lt;&lt;</span> head<span class="op">;</span></span>
<span id="cb383-36"><a href="#cb383-36" aria-hidden="true" tabindex="-1"></a>            set_inner<span class="op">(</span>tails<span class="op">...);</span></span>
<span id="cb383-37"><a href="#cb383-37" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb383-38"><a href="#cb383-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb383-39"><a href="#cb383-39" aria-hidden="true" tabindex="-1"></a>        Logger<span class="op">()</span> <span class="op">{}</span></span>
<span id="cb383-40"><a href="#cb383-40" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>ostringstream<span class="op"> </span><span class="va">oss_</span><span class="op">{};</span></span>
<span id="cb383-41"><a href="#cb383-41" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb383-42"><a href="#cb383-42" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace Logging</span></span>
<span id="cb383-43"><a href="#cb383-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb383-44"><a href="#cb383-44" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#define LOGGER_P</span><span class="op">(...)</span><span class="pp"> </span>Logging<span class="op">::</span>Logger<span class="op">::</span>Inst<span class="op">().</span>Set<span class="op">(</span><span class="ot">__FILE__</span><span class="op">,</span><span class="pp"> </span><span class="ot">__LINE__</span><span class="op">)</span></span>
<span id="cb383-45"><a href="#cb383-45" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#define LOGGER</span><span class="op">(...)</span><span class="pp"> </span>Logging<span class="op">::</span>Logger<span class="op">::</span>Inst<span class="op">().</span>Set<span class="op">(</span><span class="ot">__FILE__</span><span class="op">,</span><span class="pp"> </span><span class="ot">__LINE__</span><span class="op">,</span><span class="pp"> </span><span class="ot">__VA_ARGS__</span><span class="op">)</span></span></code></pre></div>
<p>問題のあったコードとの差分は、メンバ関数テンプレートset_innerの</p>
<div class="sourceCode" id="cb384"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb384-1"><a href="#cb384-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/logger.h 40</span></span>
<span id="cb384-2"><a href="#cb384-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-3"><a href="#cb384-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> Nstd<span class="op">::</span><span class="kw">operator</span><span class="op">&lt;&lt;;</span>  <span class="co">// Nstd::operator&lt;&lt;もname lookupの対象にする</span></span></code></pre></div>
<p>のみである。実際に解決できたことを以下の単体テストで示す。</p>
<div class="sourceCode" id="cb385"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb385-1"><a href="#cb385-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/logger_0_ints_ut.h 8</span></span>
<span id="cb385-2"><a href="#cb385-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb385-3"><a href="#cb385-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> ints <span class="op">=</span> App<span class="op">::</span><span class="dt">Ints_t</span><span class="op">{</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">};</span></span>
<span id="cb385-4"><a href="#cb385-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb385-5"><a href="#cb385-5" aria-hidden="true" tabindex="-1"></a>    LOGGER<span class="op">(</span><span class="st">&quot;Ints&quot;</span><span class="op">,</span> ints<span class="op">);</span></span>
<span id="cb385-6"><a href="#cb385-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> line_num <span class="op">=</span> <span class="ot">__LINE__</span><span class="op">;</span></span>
<span id="cb385-7"><a href="#cb385-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb385-8"><a href="#cb385-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> s <span class="op">=</span> Logging<span class="op">::</span>Logger<span class="op">::</span>InstConst<span class="op">().</span>Get<span class="op">();</span></span>
<span id="cb385-9"><a href="#cb385-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb385-10"><a href="#cb385-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> exp <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{</span>log_str_exp<span class="op">(</span><span class="ot">__FILE__</span><span class="op">,</span> line_num <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> <span class="st">&quot;:Ints:1, 2, 3</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">)};</span></span>
<span id="cb385-11"><a href="#cb385-11" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>exp<span class="op">,</span> s<span class="op">);</span></span></code></pre></div>
<p>また、</p>
<div class="sourceCode" id="cb386"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb386-1"><a href="#cb386-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/app_ints.h 12</span></span>
<span id="cb386-2"><a href="#cb386-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb386-3"><a href="#cb386-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> App <span class="op">{</span></span>
<span id="cb386-4"><a href="#cb386-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb386-5"><a href="#cb386-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> X <span class="op">{</span></span>
<span id="cb386-6"><a href="#cb386-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb386-7"><a href="#cb386-7" aria-hidden="true" tabindex="-1"></a>        X<span class="op">(</span><span class="bu">std::</span>string<span class="op"> </span>str<span class="op">,</span> <span class="dt">int</span> num<span class="op">)</span> <span class="op">:</span> <span class="va">str_</span><span class="op">{</span><span class="bu">std::</span>move<span class="op">(</span>str<span class="op">)},</span> <span class="va">num_</span><span class="op">{</span>num<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb386-8"><a href="#cb386-8" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span>ToString<span class="op">()</span> <span class="at">const</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">str_</span> <span class="op">+</span> <span class="st">&quot;/&quot;</span> <span class="op">+</span> <span class="bu">std::</span>to_string<span class="op">(</span><span class="va">num_</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb386-9"><a href="#cb386-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb386-10"><a href="#cb386-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb386-11"><a href="#cb386-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace App</span></span></code></pre></div>
<p>のように定義されたクラスも、</p>
<div class="sourceCode" id="cb387"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb387-1"><a href="#cb387-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/app_ints.h 28</span></span>
<span id="cb387-2"><a href="#cb387-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb387-3"><a href="#cb387-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> App <span class="op">{</span></span>
<span id="cb387-4"><a href="#cb387-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb387-5"><a href="#cb387-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">inline</span> <span class="bu">std::</span>ostream<span class="op">&amp;</span> <span class="kw">operator</span><span class="op">&lt;&lt;(</span><span class="bu">std::</span>ostream<span class="op">&amp;</span> os<span class="op">,</span> X <span class="at">const</span><span class="op">&amp;</span> x<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> os <span class="op">&lt;&lt;</span> x<span class="op">.</span>ToString<span class="op">();</span> <span class="op">}</span></span>
<span id="cb387-6"><a href="#cb387-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace App</span></span></code></pre></div>
<p>のような型専用のoperator&lt;&lt;があれば、そのオブジェクトのみではなく、
コンテナや配列に対しても下記のようにログ取得が可能となる。</p>
<div class="sourceCode" id="cb388"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb388-1"><a href="#cb388-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/logger_ut.cpp 37</span></span>
<span id="cb388-2"><a href="#cb388-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb388-3"><a href="#cb388-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> <span class="kw">namespace</span> Nstd<span class="op">;</span></span>
<span id="cb388-4"><a href="#cb388-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb388-5"><a href="#cb388-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span>         x  <span class="op">=</span> App<span class="op">::</span>X<span class="op">{</span><span class="st">&quot;name&quot;</span><span class="op">,</span> <span class="dv">3</span><span class="op">};</span></span>
<span id="cb388-6"><a href="#cb388-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span>         lx <span class="op">=</span> <span class="bu">std::</span>list<span class="op">&lt;</span>App<span class="op">::</span>X<span class="op">&gt;{{</span><span class="st">&quot;lx3&quot;</span><span class="op">,</span> <span class="dv">3</span><span class="op">},</span> <span class="op">{</span><span class="st">&quot;lx4&quot;</span><span class="op">,</span> <span class="dv">1</span><span class="op">}};</span></span>
<span id="cb388-7"><a href="#cb388-7" aria-hidden="true" tabindex="-1"></a>    App<span class="op">::</span>X <span class="at">const</span> x3<span class="op">[</span><span class="dv">3</span><span class="op">]{{</span><span class="st">&quot;x0&quot;</span><span class="op">,</span> <span class="dv">0</span><span class="op">},</span> <span class="op">{</span><span class="st">&quot;x1&quot;</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="op">{</span><span class="st">&quot;x2&quot;</span><span class="op">,</span> <span class="dv">2</span><span class="op">}};</span></span>
<span id="cb388-8"><a href="#cb388-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb388-9"><a href="#cb388-9" aria-hidden="true" tabindex="-1"></a>    LOGGER<span class="op">(</span><span class="dv">1</span><span class="op">,</span> x<span class="op">,</span> x3<span class="op">,</span> lx<span class="op">);</span></span>
<span id="cb388-10"><a href="#cb388-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> line_num <span class="op">=</span> <span class="ot">__LINE__</span><span class="op">;</span></span>
<span id="cb388-11"><a href="#cb388-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb388-12"><a href="#cb388-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> s <span class="op">=</span> Logging<span class="op">::</span>Logger<span class="op">::</span>InstConst<span class="op">().</span>Get<span class="op">();</span></span>
<span id="cb388-13"><a href="#cb388-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb388-14"><a href="#cb388-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> <span class="at">const</span> exp</span>
<span id="cb388-15"><a href="#cb388-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">=</span> log_str_exp<span class="op">(</span><span class="ot">__FILE__</span><span class="op">,</span> line_num <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> <span class="st">&quot;:1:name/3:x0/0, x1/1, x2/2:lx3/3, lx4/1</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">);</span></span>
<span id="cb388-16"><a href="#cb388-16" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>exp<span class="op">,</span> s<span class="op">);</span></span></code></pre></div>
<p>「<a
href="#SS_3_2">Nstdライブラリの開発</a>」で示した依存関係も維持されており、
これでログ取得ライブラリは完成したと言って良いだろう。</p>
<h2 id="その他のテンプレートテクニック">その他のテンプレートテクニック
<a id="SS_3_6"></a></h2>
<p>ここでは、これまでの議論の対象にならなかったテンプレートのテクニックや注意点について記述する。</p>
<h3
id="ユニバーサルリファレンスとstdforward">ユニバーサルリファレンスとstd::forward
<a id="SS_3_6_1"></a></h3>
<p>2個の文字列からstd::vector&lt;std::string&gt;を生成する下記のような関数について考える。</p>
<div class="sourceCode" id="cb389"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb389-1"><a href="#cb389-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/universal_ref_ut.cpp 9</span></span>
<span id="cb389-2"><a href="#cb389-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb389-3"><a href="#cb389-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;</span> gen_vector<span class="op">(</span><span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span><span class="op">&amp;</span> s0<span class="op">,</span> <span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span><span class="op">&amp;</span> s1<span class="op">)</span></span>
<span id="cb389-4"><a href="#cb389-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb389-5"><a href="#cb389-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> ret <span class="op">=</span> <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;{};</span></span>
<span id="cb389-6"><a href="#cb389-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb389-7"><a href="#cb389-7" aria-hidden="true" tabindex="-1"></a>        ret<span class="op">.</span>push_back<span class="op">(</span>s0<span class="op">);</span></span>
<span id="cb389-8"><a href="#cb389-8" aria-hidden="true" tabindex="-1"></a>        ret<span class="op">.</span>push_back<span class="op">(</span>s1<span class="op">);</span></span>
<span id="cb389-9"><a href="#cb389-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb389-10"><a href="#cb389-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> ret<span class="op">;</span></span>
<span id="cb389-11"><a href="#cb389-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>これは下記のように動作する。</p>
<div class="sourceCode" id="cb390"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb390-1"><a href="#cb390-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/universal_ref_ut.cpp 25</span></span>
<span id="cb390-2"><a href="#cb390-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb390-3"><a href="#cb390-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> a <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{</span><span class="st">&quot;a&quot;</span><span class="op">};</span></span>
<span id="cb390-4"><a href="#cb390-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> b <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{</span><span class="st">&quot;b&quot;</span><span class="op">};</span></span>
<span id="cb390-5"><a href="#cb390-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb390-6"><a href="#cb390-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> v <span class="op">=</span> gen_vector<span class="op">(</span>a<span class="op">,</span> <span class="bu">std::</span>move<span class="op">(</span>b<span class="op">));</span></span>
<span id="cb390-7"><a href="#cb390-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb390-8"><a href="#cb390-8" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">((</span><span class="bu">std::</span>vector<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;{</span><span class="st">&quot;a&quot;</span><span class="op">,</span> <span class="st">&quot;b&quot;</span><span class="op">}),</span> v<span class="op">);</span></span>
<span id="cb390-9"><a href="#cb390-9" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;a&quot;</span><span class="op">,</span> a<span class="op">);</span></span>
<span id="cb390-10"><a href="#cb390-10" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;b&quot;</span><span class="op">,</span> b<span class="op">);</span>  <span class="co">// bはmoveされない</span></span></code></pre></div>
<p>このコードは正しく動作するものの、move代入できず、パフォーマンス問題を引き起こす可能性があるため、
<a
href="#SS_5_6_1">ユニバーサルリファレンス</a>を使って下記のように書き直した。</p>
<div class="sourceCode" id="cb391"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb391-1"><a href="#cb391-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/universal_ref_ut.cpp 41</span></span>
<span id="cb391-2"><a href="#cb391-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb391-3"><a href="#cb391-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> STR0<span class="op">,</span> <span class="kw">typename</span> STR1<span class="op">&gt;</span></span>
<span id="cb391-4"><a href="#cb391-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;</span> gen_vector<span class="op">(</span>STR0<span class="op">&amp;&amp;</span> s0<span class="op">,</span> STR1<span class="op">&amp;&amp;</span> s1<span class="op">)</span></span>
<span id="cb391-5"><a href="#cb391-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb391-6"><a href="#cb391-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> ret <span class="op">=</span> <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;{};</span></span>
<span id="cb391-7"><a href="#cb391-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb391-8"><a href="#cb391-8" aria-hidden="true" tabindex="-1"></a>        ret<span class="op">.</span>push_back<span class="op">(</span>s0<span class="op">);</span></span>
<span id="cb391-9"><a href="#cb391-9" aria-hidden="true" tabindex="-1"></a>        ret<span class="op">.</span>push_back<span class="op">(</span>s1<span class="op">);</span></span>
<span id="cb391-10"><a href="#cb391-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb391-11"><a href="#cb391-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> ret<span class="op">;</span></span>
<span id="cb391-12"><a href="#cb391-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>残念ながら、このコードは意図したようには動作せず、下記に示した通り相変わらずmove代入ができない。</p>
<div class="sourceCode" id="cb392"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb392-1"><a href="#cb392-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/universal_ref_ut.cpp 58</span></span>
<span id="cb392-2"><a href="#cb392-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb392-3"><a href="#cb392-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> a <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{</span><span class="st">&quot;a&quot;</span><span class="op">};</span></span>
<span id="cb392-4"><a href="#cb392-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> b <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{</span><span class="st">&quot;b&quot;</span><span class="op">};</span></span>
<span id="cb392-5"><a href="#cb392-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb392-6"><a href="#cb392-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> v <span class="op">=</span> gen_vector<span class="op">(</span>a<span class="op">,</span> <span class="bu">std::</span>move<span class="op">(</span>b<span class="op">));</span></span>
<span id="cb392-7"><a href="#cb392-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb392-8"><a href="#cb392-8" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">((</span><span class="bu">std::</span>vector<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;{</span><span class="st">&quot;a&quot;</span><span class="op">,</span> <span class="st">&quot;b&quot;</span><span class="op">}),</span> v<span class="op">);</span></span>
<span id="cb392-9"><a href="#cb392-9" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;a&quot;</span><span class="op">,</span> a<span class="op">);</span></span>
<span id="cb392-10"><a href="#cb392-10" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;b&quot;</span><span class="op">,</span> b<span class="op">);</span>  <span class="co">// bはmoveされない</span></span></code></pre></div>
<p>この原因は、 「関数が受け取った<a
href="#SS_5_5_3">rvalue</a>リファレンスは、
その関数から別の関数に受け渡される時に<a
href="#SS_5_5_2">lvalue</a>リファレンスとして扱われる」からである。</p>
<p>この現象について下記の関数テンプレートを用いて解説を行う。</p>
<div class="sourceCode" id="cb393"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb393-1"><a href="#cb393-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/universal_ref_ut.cpp 71</span></span>
<span id="cb393-2"><a href="#cb393-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb393-3"><a href="#cb393-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">enum</span> <span class="kw">class</span> ExpressionType <span class="op">{</span> Lvalue<span class="op">,</span> Rvalue <span class="op">};</span></span>
<span id="cb393-4"><a href="#cb393-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb393-5"><a href="#cb393-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb393-6"><a href="#cb393-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> ExpressionType universal_ref2<span class="op">(</span>T<span class="op">&amp;&amp;</span> t<span class="op">)</span></span>
<span id="cb393-7"><a href="#cb393-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb393-8"><a href="#cb393-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">std::</span>is_lvalue_reference_v<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span>t<span class="op">)&gt;</span> <span class="op">?</span> ExpressionType<span class="op">::</span>Lvalue</span>
<span id="cb393-9"><a href="#cb393-9" aria-hidden="true" tabindex="-1"></a>                                                       <span class="op">:</span> ExpressionType<span class="op">::</span>Rvalue<span class="op">;</span></span>
<span id="cb393-10"><a href="#cb393-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb393-11"><a href="#cb393-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb393-12"><a href="#cb393-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">// std::pair&lt;&gt;::first  : universal_refの中のtのExpressionType</span></span>
<span id="cb393-13"><a href="#cb393-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">// std::pair&lt;&gt;::second : universal_ref2の中でtのExpressionType</span></span>
<span id="cb393-14"><a href="#cb393-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb393-15"><a href="#cb393-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="bu">std::</span>pair<span class="op">&lt;</span>ExpressionType<span class="op">,</span> ExpressionType<span class="op">&gt;</span> universal_ref<span class="op">(</span>T<span class="op">&amp;&amp;</span> t<span class="op">)</span></span>
<span id="cb393-16"><a href="#cb393-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb393-17"><a href="#cb393-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">std::</span>make_pair<span class="op">(</span></span>
<span id="cb393-18"><a href="#cb393-18" aria-hidden="true" tabindex="-1"></a>            <span class="bu">std::</span>is_lvalue_reference_v<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span>t<span class="op">)&gt;</span> <span class="op">?</span> ExpressionType<span class="op">::</span>Lvalue <span class="op">:</span> ExpressionType<span class="op">::</span>Rvalue<span class="op">,</span></span>
<span id="cb393-19"><a href="#cb393-19" aria-hidden="true" tabindex="-1"></a>            universal_ref2<span class="op">(</span>t<span class="op">));</span></span>
<span id="cb393-20"><a href="#cb393-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>下記に示した通り、universal_refとuniversal_ref2のパラメータが同じ型であるとは限らない。</p>
<div class="sourceCode" id="cb394"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb394-1"><a href="#cb394-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/universal_ref_ut.cpp 95</span></span>
<span id="cb394-2"><a href="#cb394-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb394-3"><a href="#cb394-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb394-4"><a href="#cb394-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb394-5"><a href="#cb394-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="kw">auto</span> p <span class="op">=</span> universal_ref<span class="op">(</span>i<span class="op">);</span></span>
<span id="cb394-6"><a href="#cb394-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb394-7"><a href="#cb394-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>universal_ref2<span class="op">(</span>i<span class="op">)</span> <span class="op">==</span> ExpressionType<span class="op">::</span>Lvalue<span class="op">);</span></span>
<span id="cb394-8"><a href="#cb394-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>p<span class="op">.</span>first <span class="op">==</span> ExpressionType<span class="op">::</span>Lvalue<span class="op">);</span></span>
<span id="cb394-9"><a href="#cb394-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>p<span class="op">.</span>second <span class="op">==</span> ExpressionType<span class="op">::</span>Lvalue<span class="op">);</span></span>
<span id="cb394-10"><a href="#cb394-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb394-11"><a href="#cb394-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="kw">auto</span> pm <span class="op">=</span> universal_ref<span class="op">(</span><span class="bu">std::</span>move<span class="op">(</span>i<span class="op">));</span></span>
<span id="cb394-12"><a href="#cb394-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb394-13"><a href="#cb394-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>universal_ref2<span class="op">(</span><span class="bu">std::</span>move<span class="op">(</span>i<span class="op">))</span> <span class="op">==</span> ExpressionType<span class="op">::</span>Rvalue<span class="op">);</span></span>
<span id="cb394-14"><a href="#cb394-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>pm<span class="op">.</span>first <span class="op">==</span> ExpressionType<span class="op">::</span>Rvalue<span class="op">);</span></span>
<span id="cb394-15"><a href="#cb394-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>pm<span class="op">.</span>second <span class="op">==</span> ExpressionType<span class="op">::</span>Lvalue<span class="op">);</span></span>
<span id="cb394-16"><a href="#cb394-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb394-17"><a href="#cb394-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="kw">auto</span> pm2 <span class="op">=</span> universal_ref<span class="op">(</span><span class="dt">int</span><span class="op">{});</span></span>
<span id="cb394-18"><a href="#cb394-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb394-19"><a href="#cb394-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>universal_ref2<span class="op">(</span><span class="dt">int</span><span class="op">{})</span> <span class="op">==</span> ExpressionType<span class="op">::</span>Rvalue<span class="op">);</span></span>
<span id="cb394-20"><a href="#cb394-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>pm2<span class="op">.</span>first <span class="op">==</span> ExpressionType<span class="op">::</span>Rvalue<span class="op">);</span></span>
<span id="cb394-21"><a href="#cb394-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>pm2<span class="op">.</span>second <span class="op">==</span> ExpressionType<span class="op">::</span>Lvalue<span class="op">);</span></span></code></pre></div>
<p>この問題はstd::forwardにより対処できる。これによって改良されたコードを下記に示す。</p>
<div class="sourceCode" id="cb395"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb395-1"><a href="#cb395-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/universal_ref_ut.cpp 124</span></span>
<span id="cb395-2"><a href="#cb395-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-3"><a href="#cb395-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> STR0<span class="op">,</span> <span class="kw">typename</span> STR1<span class="op">&gt;</span></span>
<span id="cb395-4"><a href="#cb395-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;</span> gen_vector<span class="op">(</span>STR0<span class="op">&amp;&amp;</span> s0<span class="op">,</span> STR1<span class="op">&amp;&amp;</span> s1<span class="op">)</span></span>
<span id="cb395-5"><a href="#cb395-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb395-6"><a href="#cb395-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> ret <span class="op">=</span> <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;{};</span></span>
<span id="cb395-7"><a href="#cb395-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-8"><a href="#cb395-8" aria-hidden="true" tabindex="-1"></a>        ret<span class="op">.</span>push_back<span class="op">(</span><span class="bu">std::</span>forward<span class="op">&lt;</span>STR0<span class="op">&gt;(</span>s0<span class="op">));</span></span>
<span id="cb395-9"><a href="#cb395-9" aria-hidden="true" tabindex="-1"></a>        ret<span class="op">.</span>push_back<span class="op">(</span><span class="bu">std::</span>forward<span class="op">&lt;</span>STR1<span class="op">&gt;(</span>s1<span class="op">));</span></span>
<span id="cb395-10"><a href="#cb395-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-11"><a href="#cb395-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> ret<span class="op">;</span></span>
<span id="cb395-12"><a href="#cb395-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>下記単体テストが示す通り、rvalueリファレンスはmove代入され、lvalueリファレンスはcopy代入されている。</p>
<div class="sourceCode" id="cb396"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb396-1"><a href="#cb396-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/universal_ref_ut.cpp 142</span></span>
<span id="cb396-2"><a href="#cb396-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb396-3"><a href="#cb396-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> a <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{</span><span class="st">&quot;a&quot;</span><span class="op">};</span></span>
<span id="cb396-4"><a href="#cb396-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> b <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{</span><span class="st">&quot;b&quot;</span><span class="op">};</span></span>
<span id="cb396-5"><a href="#cb396-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb396-6"><a href="#cb396-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> v <span class="op">=</span> gen_vector<span class="op">(</span>a<span class="op">,</span> <span class="bu">std::</span>move<span class="op">(</span>b<span class="op">));</span></span>
<span id="cb396-7"><a href="#cb396-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb396-8"><a href="#cb396-8" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">((</span><span class="bu">std::</span>vector<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;{</span><span class="st">&quot;a&quot;</span><span class="op">,</span> <span class="st">&quot;b&quot;</span><span class="op">}),</span> v<span class="op">);</span></span>
<span id="cb396-9"><a href="#cb396-9" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;a&quot;</span><span class="op">,</span> a<span class="op">);</span></span>
<span id="cb396-10"><a href="#cb396-10" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;&quot;</span><span class="op">,</span> b<span class="op">);</span>  <span class="co">// bはmoveされた</span></span></code></pre></div>
<p>しかし残念ながら、このコードにも改良すべき点がある。</p>
<div class="sourceCode" id="cb397"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb397-1"><a href="#cb397-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/universal_ref_ut.cpp 155</span></span>
<span id="cb397-2"><a href="#cb397-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb397-3"><a href="#cb397-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> a <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{</span><span class="st">&quot;a&quot;</span><span class="op">};</span></span>
<span id="cb397-4"><a href="#cb397-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb397-5"><a href="#cb397-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> v <span class="op">=</span> gen_vector<span class="op">(</span>a<span class="op">,</span> <span class="st">&quot;b&quot;</span><span class="op">);</span></span>
<span id="cb397-6"><a href="#cb397-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb397-7"><a href="#cb397-7" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">((</span><span class="bu">std::</span>vector<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;{</span><span class="st">&quot;a&quot;</span><span class="op">,</span> <span class="st">&quot;b&quot;</span><span class="op">}),</span> v<span class="op">);</span></span>
<span id="cb397-8"><a href="#cb397-8" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;a&quot;</span><span class="op">,</span> a<span class="op">);</span></span></code></pre></div>
<p>上記の”b”のような文字列リテラルを引数にした場合、
それをstd::vector&lt;std::string&gt;::push_backに渡した時に、
“b”はテンポラリオブジェクトstd::string(“b”)のに変換されてしまう。
std::vector&lt;std::string&gt;へのオブジェクトの挿入は、文字列リテラルから行うことが出来るため、
このテンポラリオブジェクトの生成は明らかに不要な処理である。</p>
<p>下記は、この対策を施すとともに任意の数の引数を受け取れるように改良したコードである。</p>
<div class="sourceCode" id="cb398"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb398-1"><a href="#cb398-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/universal_ref_ut.cpp 170</span></span>
<span id="cb398-2"><a href="#cb398-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb398-3"><a href="#cb398-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> emplace_back<span class="op">(</span><span class="bu">std::</span>vector<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;&amp;)</span> <span class="kw">noexcept</span> <span class="op">{}</span></span>
<span id="cb398-4"><a href="#cb398-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb398-5"><a href="#cb398-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> HEAD<span class="op">,</span> <span class="kw">typename</span><span class="op">...</span> TAIL<span class="op">&gt;</span></span>
<span id="cb398-6"><a href="#cb398-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> emplace_back<span class="op">(</span><span class="bu">std::</span>vector<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;&amp;</span> strs<span class="op">,</span> HEAD<span class="op">&amp;&amp;</span> head<span class="op">,</span> TAIL<span class="op">&amp;&amp;...</span> tails<span class="op">)</span></span>
<span id="cb398-7"><a href="#cb398-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb398-8"><a href="#cb398-8" aria-hidden="true" tabindex="-1"></a>        strs<span class="op">.</span>emplace_back<span class="op">(</span><span class="bu">std::</span>forward<span class="op">&lt;</span>HEAD<span class="op">&gt;(</span>head<span class="op">));</span></span>
<span id="cb398-9"><a href="#cb398-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb398-10"><a href="#cb398-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">constexpr</span> <span class="op">(</span><span class="kw">sizeof</span><span class="op">...(</span>tails<span class="op">)</span> <span class="op">!=</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb398-11"><a href="#cb398-11" aria-hidden="true" tabindex="-1"></a>            emplace_back<span class="op">(</span>strs<span class="op">,</span> <span class="bu">std::</span>forward<span class="op">&lt;</span>TAIL<span class="op">&gt;(</span>tails<span class="op">)...);</span></span>
<span id="cb398-12"><a href="#cb398-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb398-13"><a href="#cb398-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb398-14"><a href="#cb398-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb398-15"><a href="#cb398-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span><span class="op">...</span> STR<span class="op">&gt;</span></span>
<span id="cb398-16"><a href="#cb398-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;</span> gen_vector<span class="op">(</span>STR<span class="op">&amp;&amp;...</span> ss<span class="op">)</span></span>
<span id="cb398-17"><a href="#cb398-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb398-18"><a href="#cb398-18" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> ret <span class="op">=</span> <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;{};</span></span>
<span id="cb398-19"><a href="#cb398-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb398-20"><a href="#cb398-20" aria-hidden="true" tabindex="-1"></a>        emplace_back<span class="op">(</span>ret<span class="op">,</span> <span class="bu">std::</span>forward<span class="op">&lt;</span>STR<span class="op">&gt;(</span>ss<span class="op">)...);</span></span>
<span id="cb398-21"><a href="#cb398-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb398-22"><a href="#cb398-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> ret<span class="op">;</span></span>
<span id="cb398-23"><a href="#cb398-23" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>上記の</p>
<div class="sourceCode" id="cb399"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb399-1"><a href="#cb399-1" aria-hidden="true" tabindex="-1"></a>    <span class="kw">sizeof</span><span class="op">...(</span>tails<span class="op">)</span></span></code></pre></div>
<p>はパラメータパックの個数を受け取るための記法である。
従ってこのコードではすべてのパラメータパック変数を消費するまでリカーシブコールを続けることになる
(が、このリカーシブコールはコンパイル時に行われるため、実行時の速度低下は起こさない)。</p>
<p>上記の</p>
<div class="sourceCode" id="cb400"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb400-1"><a href="#cb400-1" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>forward<span class="op">&lt;</span>TAIL<span class="op">&gt;(</span>tails<span class="op">)...</span></span></code></pre></div>
<p>は、それぞれのパラメータパック変数をstd::forwardに渡した戻り値を、
再びパラメータパックにするための記法である。</p>
<p>このコードは下記の単体テストが示すように正しく動作する
(が、残念ならがテンポラリオブジェクトが生成されていないことを単体テストで証明することはできない)。</p>
<div class="sourceCode" id="cb401"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb401-1"><a href="#cb401-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/universal_ref_ut.cpp 198</span></span>
<span id="cb401-2"><a href="#cb401-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb401-3"><a href="#cb401-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> a <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{</span><span class="st">&quot;a&quot;</span><span class="op">};</span></span>
<span id="cb401-4"><a href="#cb401-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> b <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{</span><span class="st">&quot;b&quot;</span><span class="op">};</span></span>
<span id="cb401-5"><a href="#cb401-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb401-6"><a href="#cb401-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> v <span class="op">=</span> gen_vector<span class="op">(</span>a<span class="op">,</span> <span class="bu">std::</span>move<span class="op">(</span>b<span class="op">),</span> <span class="st">&quot;c&quot;</span><span class="op">);</span></span>
<span id="cb401-7"><a href="#cb401-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb401-8"><a href="#cb401-8" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">((</span><span class="bu">std::</span>vector<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;{</span><span class="st">&quot;a&quot;</span><span class="op">,</span> <span class="st">&quot;b&quot;</span><span class="op">,</span> <span class="st">&quot;c&quot;</span><span class="op">}),</span> v<span class="op">);</span></span>
<span id="cb401-9"><a href="#cb401-9" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;a&quot;</span><span class="op">,</span> a<span class="op">);</span></span>
<span id="cb401-10"><a href="#cb401-10" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;&quot;</span><span class="op">,</span> b<span class="op">);</span>  <span class="co">// bはmoveされた</span></span></code></pre></div>
<p>ユニバーサルリファレンスはconstにすることができないが (T
const&amp;&amp;はconstな<a
href="#SS_5_5_3">rvalue</a>リファレンスである)、
ユニバーサルリファレンスが<a
href="#SS_5_5_2">lvalue</a>リファレンスであった場合は、
constなlvalueリファレンスとして扱うべきである。</p>
<p>従って、下記のようなコードは書くべきではない。</p>
<div class="sourceCode" id="cb402"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb402-1"><a href="#cb402-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/universal_ref_ut.cpp 215</span></span>
<span id="cb402-2"><a href="#cb402-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb402-3"><a href="#cb402-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> STR0<span class="op">,</span> <span class="kw">typename</span> STR1<span class="op">&gt;</span></span>
<span id="cb402-4"><a href="#cb402-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;</span> gen_vector<span class="op">(</span>STR0<span class="op">&amp;&amp;</span> s0<span class="op">,</span> STR1<span class="op">&amp;&amp;</span> s1<span class="op">)</span></span>
<span id="cb402-5"><a href="#cb402-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb402-6"><a href="#cb402-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> ret <span class="op">=</span> <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;{};</span></span>
<span id="cb402-7"><a href="#cb402-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb402-8"><a href="#cb402-8" aria-hidden="true" tabindex="-1"></a>        ret<span class="op">.</span>push_back<span class="op">(</span><span class="bu">std::</span>move<span class="op">(</span>s0<span class="op">));</span></span>
<span id="cb402-9"><a href="#cb402-9" aria-hidden="true" tabindex="-1"></a>        ret<span class="op">.</span>push_back<span class="op">(</span><span class="bu">std::</span>move<span class="op">(</span>s1<span class="op">));</span></span>
<span id="cb402-10"><a href="#cb402-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb402-11"><a href="#cb402-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> ret<span class="op">;</span></span>
<span id="cb402-12"><a href="#cb402-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>もしそのようにしてしまえば、
下記単体テストが示すように非constな実引数はmoveされてしまうことになる。</p>
<div class="sourceCode" id="cb403"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb403-1"><a href="#cb403-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/universal_ref_ut.cpp 232</span></span>
<span id="cb403-2"><a href="#cb403-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb403-3"><a href="#cb403-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span>       a <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{</span><span class="st">&quot;a&quot;</span><span class="op">};</span></span>
<span id="cb403-4"><a href="#cb403-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> <span class="at">const</span> b <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{</span><span class="st">&quot;b&quot;</span><span class="op">};</span></span>
<span id="cb403-5"><a href="#cb403-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb403-6"><a href="#cb403-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> v <span class="op">=</span> gen_vector<span class="op">(</span>a<span class="op">,</span> <span class="bu">std::</span>move<span class="op">(</span>b<span class="op">));</span></span>
<span id="cb403-7"><a href="#cb403-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb403-8"><a href="#cb403-8" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">((</span><span class="bu">std::</span>vector<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;{</span><span class="st">&quot;a&quot;</span><span class="op">,</span> <span class="st">&quot;b&quot;</span><span class="op">}),</span> v<span class="op">);</span></span>
<span id="cb403-9"><a href="#cb403-9" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;&quot;</span><span class="op">,</span> a<span class="op">);</span>   <span class="co">// aはmoveされてしまう</span></span>
<span id="cb403-10"><a href="#cb403-10" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;b&quot;</span><span class="op">,</span> b<span class="op">);</span>  <span class="co">// bはconstなのでmoveされない</span></span></code></pre></div>
<p>任意の型Tのrvalueのみを引数に取る関数テンプレートを下記のように記述した場合、
すでに述べたように引数はユニバーサルリファレンスとなってしまうため、lvalueにもバインドしてしまう。</p>
<div class="sourceCode" id="cb404"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb404-1"><a href="#cb404-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/universal_ref_ut.cpp 248</span></span>
<span id="cb404-2"><a href="#cb404-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb404-3"><a href="#cb404-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb404-4"><a href="#cb404-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> f<span class="op">(</span>T<span class="op">&amp;&amp;</span> t<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb404-5"><a href="#cb404-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb404-6"><a href="#cb404-6" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb404-7"><a href="#cb404-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>このような場合、下記の記述が必要になる。</p>
<div class="sourceCode" id="cb405"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb405-1"><a href="#cb405-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/universal_ref_ut.cpp 267</span></span>
<span id="cb405-2"><a href="#cb405-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb405-3"><a href="#cb405-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb405-4"><a href="#cb405-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> f<span class="op">(</span>T<span class="op">&amp;)</span> <span class="op">=</span> <span class="kw">delete</span><span class="op">;</span></span></code></pre></div>
<p>この効果により、下記に示した通りlvalueにはバインドできなくなり、
当初の目的通り、rvalueのみを引数に取る関数テンプレートが定義できたことになる。</p>
<div class="sourceCode" id="cb406"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb406-1"><a href="#cb406-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/universal_ref_ut.cpp 275</span></span>
<span id="cb406-2"><a href="#cb406-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb406-3"><a href="#cb406-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> s <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{};</span></span>
<span id="cb406-4"><a href="#cb406-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb406-5"><a href="#cb406-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// f(s);           // f(std::string&amp;)はdeleteされたため、コンパイルエラー</span></span>
<span id="cb406-6"><a href="#cb406-6" aria-hidden="true" tabindex="-1"></a>    f<span class="op">(</span><span class="bu">std::</span>string<span class="op">{});</span>  <span class="co">// f(std::string&amp;&amp;)にはバインドできる</span></span></code></pre></div>
<p>なお、ユニバーサルリファレンスは、<a
href="#SS_5_6_4">リファレンスcollapsing</a>の一機能としても理解できる。</p>
<h3 id="ジェネリックラムダ">ジェネリックラムダ
<a id="SS_3_6_2"></a></h3>
<p>下記のようなクラスとoperator&lt;&lt;があった場合を考える。</p>
<div class="sourceCode" id="cb407"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb407-1"><a href="#cb407-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/generic_lambda_ut.cpp 13</span></span>
<span id="cb407-2"><a href="#cb407-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb407-3"><a href="#cb407-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> XYZ <span class="op">{</span></span>
<span id="cb407-4"><a href="#cb407-4" aria-hidden="true" tabindex="-1"></a>        XYZ<span class="op">(</span><span class="dt">int</span> ax<span class="op">,</span> <span class="dt">int</span> ay<span class="op">,</span> <span class="dt">int</span> az<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">:</span> x<span class="op">{</span>ax<span class="op">},</span> y<span class="op">{</span>ay<span class="op">},</span> z<span class="op">{</span>az<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb407-5"><a href="#cb407-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> x<span class="op">;</span></span>
<span id="cb407-6"><a href="#cb407-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> y<span class="op">;</span></span>
<span id="cb407-7"><a href="#cb407-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> z<span class="op">;</span></span>
<span id="cb407-8"><a href="#cb407-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb407-9"><a href="#cb407-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb407-10"><a href="#cb407-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>ostream<span class="op">&amp;</span> <span class="kw">operator</span><span class="op">&lt;&lt;(</span><span class="bu">std::</span>ostream<span class="op">&amp;</span> os<span class="op">,</span> XYZ <span class="at">const</span><span class="op">&amp;</span> xyz<span class="op">)</span></span>
<span id="cb407-11"><a href="#cb407-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb407-12"><a href="#cb407-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> os <span class="op">&lt;&lt;</span> <span class="bu">std::</span>to_string<span class="op">(</span>xyz<span class="op">.</span>x<span class="op">)</span> <span class="op">+</span> <span class="st">&quot;/&quot;</span> <span class="op">+</span> <span class="bu">std::</span>to_string<span class="op">(</span>xyz<span class="op">.</span>y<span class="op">)</span> <span class="op">+</span> <span class="st">&quot;/&quot;</span> <span class="op">+</span> <span class="bu">std::</span>to_string<span class="op">(</span>xyz<span class="op">.</span>z<span class="op">);</span></span>
<span id="cb407-13"><a href="#cb407-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>「<a href="#SS_3_4_2">Nstd::SafeIndexの開発</a>」や「<a
href="#SS_3_4_4">コンテナ用Nstd::operator&lt;&lt;の開発</a>」
の成果物との組み合わせの単体テストは下記のように書けるだろう。</p>
<div class="sourceCode" id="cb408"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb408-1"><a href="#cb408-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/generic_lambda_ut.cpp 31</span></span>
<span id="cb408-2"><a href="#cb408-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb408-3"><a href="#cb408-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> v   <span class="op">=</span> Nstd<span class="op">::</span>SafeVector<span class="op">&lt;</span>XYZ<span class="op">&gt;{{</span><span class="dv">9</span><span class="op">,</span> <span class="dv">8</span><span class="op">,</span> <span class="dv">7</span><span class="op">},</span> <span class="op">{</span><span class="dv">6</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">4</span><span class="op">},</span> <span class="op">{</span><span class="dv">3</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">}};</span></span>
<span id="cb408-4"><a href="#cb408-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> oss <span class="op">=</span> <span class="bu">std::</span>ostringstream<span class="op">{};</span></span>
<span id="cb408-5"><a href="#cb408-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb408-6"><a href="#cb408-6" aria-hidden="true" tabindex="-1"></a>    oss <span class="op">&lt;&lt;</span> v<span class="op">;</span></span>
<span id="cb408-7"><a href="#cb408-7" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;9/8/7, 6/5/4, 3/2/1, 0/1/2&quot;</span><span class="op">,</span> oss<span class="op">.</span>str<span class="op">());</span></span></code></pre></div>
<p>std::sortによるソートができるかどうかのテストは、C++11までは、</p>
<div class="sourceCode" id="cb409"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb409-1"><a href="#cb409-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/generic_lambda_ut.cpp 41</span></span>
<span id="cb409-2"><a href="#cb409-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb409-3"><a href="#cb409-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> v <span class="op">=</span> Nstd<span class="op">::</span>SafeVector<span class="op">&lt;</span>XYZ<span class="op">&gt;{{</span><span class="dv">9</span><span class="op">,</span> <span class="dv">8</span><span class="op">,</span> <span class="dv">7</span><span class="op">},</span> <span class="op">{</span><span class="dv">6</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">4</span><span class="op">},</span> <span class="op">{</span><span class="dv">3</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">}};</span></span>
<span id="cb409-4"><a href="#cb409-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb409-5"><a href="#cb409-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// C++11 lambda                  型の明示が必要</span></span>
<span id="cb409-6"><a href="#cb409-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">//                               ↓               ↓</span></span>
<span id="cb409-7"><a href="#cb409-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>sort<span class="op">(</span>v<span class="op">.</span>begin<span class="op">(),</span> v<span class="op">.</span>end<span class="op">(),</span> <span class="op">[](</span>XYZ <span class="at">const</span><span class="op">&amp;</span> lhs<span class="op">,</span> XYZ <span class="at">const</span><span class="op">&amp;</span> rhs<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span></span>
<span id="cb409-8"><a href="#cb409-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">std::</span>tie<span class="op">(</span>lhs<span class="op">.</span>x<span class="op">,</span> lhs<span class="op">.</span>y<span class="op">,</span> lhs<span class="op">.</span>z<span class="op">)</span> <span class="op">&lt;</span> <span class="bu">std::</span>tie<span class="op">(</span>rhs<span class="op">.</span>x<span class="op">,</span> rhs<span class="op">.</span>y<span class="op">,</span> rhs<span class="op">.</span>z<span class="op">);</span></span>
<span id="cb409-9"><a href="#cb409-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">});</span></span>
<span id="cb409-10"><a href="#cb409-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> oss <span class="op">=</span> <span class="bu">std::</span>ostringstream<span class="op">{};</span></span>
<span id="cb409-11"><a href="#cb409-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb409-12"><a href="#cb409-12" aria-hidden="true" tabindex="-1"></a>    oss <span class="op">&lt;&lt;</span> v<span class="op">;</span></span>
<span id="cb409-13"><a href="#cb409-13" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;0/1/2, 3/2/1, 6/5/4, 9/8/7&quot;</span><span class="op">,</span> oss<span class="op">.</span>str<span class="op">());</span></span></code></pre></div>
<p>のように書くのが一般的だろう。ラムダ式の引数の型を指定しなければならないのは、
範囲for文でautoが使用出来ること等と比べると見劣りがするが、
C++14からは下記のコードで示した通り引数にautoが使えるようになった。</p>
<div class="sourceCode" id="cb410"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb410-1"><a href="#cb410-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/generic_lambda_ut.cpp 57</span></span>
<span id="cb410-2"><a href="#cb410-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb410-3"><a href="#cb410-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> v <span class="op">=</span> Nstd<span class="op">::</span>SafeVector<span class="op">&lt;</span>XYZ<span class="op">&gt;{{</span><span class="dv">9</span><span class="op">,</span> <span class="dv">8</span><span class="op">,</span> <span class="dv">7</span><span class="op">},</span> <span class="op">{</span><span class="dv">6</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">4</span><span class="op">},</span> <span class="op">{</span><span class="dv">3</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">}};</span></span>
<span id="cb410-4"><a href="#cb410-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb410-5"><a href="#cb410-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// C++14 generic lambda          型の明示が不要</span></span>
<span id="cb410-6"><a href="#cb410-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">//                               ↓                ↓</span></span>
<span id="cb410-7"><a href="#cb410-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>sort<span class="op">(</span>v<span class="op">.</span>begin<span class="op">(),</span> v<span class="op">.</span>end<span class="op">(),</span> <span class="op">[](</span><span class="kw">auto</span> <span class="at">const</span><span class="op">&amp;</span> lhs<span class="op">,</span> <span class="kw">auto</span> <span class="at">const</span><span class="op">&amp;</span> rhs<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span></span>
<span id="cb410-8"><a href="#cb410-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">std::</span>tie<span class="op">(</span>lhs<span class="op">.</span>x<span class="op">,</span> lhs<span class="op">.</span>y<span class="op">,</span> lhs<span class="op">.</span>z<span class="op">)</span> <span class="op">&lt;</span> <span class="bu">std::</span>tie<span class="op">(</span>rhs<span class="op">.</span>x<span class="op">,</span> rhs<span class="op">.</span>y<span class="op">,</span> rhs<span class="op">.</span>z<span class="op">);</span></span>
<span id="cb410-9"><a href="#cb410-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">});</span></span>
<span id="cb410-10"><a href="#cb410-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> oss <span class="op">=</span> <span class="bu">std::</span>ostringstream<span class="op">{};</span></span>
<span id="cb410-11"><a href="#cb410-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb410-12"><a href="#cb410-12" aria-hidden="true" tabindex="-1"></a>    oss <span class="op">&lt;&lt;</span> v<span class="op">;</span></span>
<span id="cb410-13"><a href="#cb410-13" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;0/1/2, 3/2/1, 6/5/4, 9/8/7&quot;</span><span class="op">,</span> oss<span class="op">.</span>str<span class="op">());</span></span></code></pre></div>
<p>この記法はジェネリックラムダと呼ばれる。
この機能により関数の中で関数テンプレートと同等のものが定義できるようになった。</p>
<h4 id="ジェネリックラムダの内部構造">ジェネリックラムダの内部構造
<a id="SS_3_6_2_1"></a></h4>
<p>ジェネリックラムダは下記のように使用することができる。</p>
<div class="sourceCode" id="cb411"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb411-1"><a href="#cb411-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/generic_lambda_ut.cpp 73</span></span>
<span id="cb411-2"><a href="#cb411-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb411-3"><a href="#cb411-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> PUTTO<span class="op">&gt;</span></span>
<span id="cb411-4"><a href="#cb411-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> f<span class="op">(</span>PUTTO<span class="op">&amp;&amp;</span> p<span class="op">)</span></span>
<span id="cb411-5"><a href="#cb411-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb411-6"><a href="#cb411-6" aria-hidden="true" tabindex="-1"></a>        p<span class="op">(</span><span class="dv">1</span><span class="op">);</span>       <span class="co">// ラムダの引数elemの型はint</span></span>
<span id="cb411-7"><a href="#cb411-7" aria-hidden="true" tabindex="-1"></a>        p<span class="op">(</span><span class="fl">2.71</span><span class="op">);</span>    <span class="co">// ラムダの引数elemは型はdouble</span></span>
<span id="cb411-8"><a href="#cb411-8" aria-hidden="true" tabindex="-1"></a>        p<span class="op">(</span><span class="st">&quot;hehe&quot;</span><span class="op">);</span>  <span class="co">// ラムダの引数elemは型はchar [5]</span></span>
<span id="cb411-9"><a href="#cb411-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb411-10"><a href="#cb411-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb411-11"><a href="#cb411-11" aria-hidden="true" tabindex="-1"></a>    TEST<span class="op">(</span>Template<span class="op">,</span> generic_lambda<span class="op">)</span></span>
<span id="cb411-12"><a href="#cb411-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb411-13"><a href="#cb411-13" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> oss <span class="op">=</span> <span class="bu">std::</span>ostringstream<span class="op">{};</span></span>
<span id="cb411-14"><a href="#cb411-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb411-15"><a href="#cb411-15" aria-hidden="true" tabindex="-1"></a>        f<span class="op">([&amp;</span>oss<span class="op">](</span><span class="kw">auto</span> <span class="at">const</span><span class="op">&amp;</span> elem<span class="op">)</span> <span class="op">{</span> oss <span class="op">&lt;&lt;</span> elem <span class="op">&lt;&lt;</span> <span class="bu">std::</span>endl<span class="op">;</span> <span class="op">});</span></span>
<span id="cb411-16"><a href="#cb411-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb411-17"><a href="#cb411-17" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;1</span><span class="sc">\n</span><span class="st">2.71</span><span class="sc">\n</span><span class="st">hehe</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">,</span> oss<span class="op">.</span>str<span class="op">());</span></span>
<span id="cb411-18"><a href="#cb411-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>この例で使用しているクロージャは一見、型をダイナミックに扱っているように見えるが、
下記のような「テンプレートoperator()を持つ関数型」オブジェクトとして展開されていると考えれば、
理解できる。</p>
<div class="sourceCode" id="cb412"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb412-1"><a href="#cb412-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/generic_lambda_ut.cpp 92</span></span>
<span id="cb412-2"><a href="#cb412-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb412-3"><a href="#cb412-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Closure <span class="op">{</span></span>
<span id="cb412-4"><a href="#cb412-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb412-5"><a href="#cb412-5" aria-hidden="true" tabindex="-1"></a>        Closure<span class="op">(</span><span class="bu">std::</span>ostream<span class="op">&amp;</span> os<span class="op">)</span> <span class="op">:</span> <span class="va">os_</span><span class="op">{</span>os<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb412-6"><a href="#cb412-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb412-7"><a href="#cb412-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb412-8"><a href="#cb412-8" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> <span class="kw">operator</span><span class="op">()(</span>T<span class="op">&amp;&amp;</span> t<span class="op">)</span></span>
<span id="cb412-9"><a href="#cb412-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb412-10"><a href="#cb412-10" aria-hidden="true" tabindex="-1"></a>            <span class="va">os_</span> <span class="op">&lt;&lt;</span> t <span class="op">&lt;&lt;</span> <span class="bu">std::</span>endl<span class="op">;</span></span>
<span id="cb412-11"><a href="#cb412-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb412-12"><a href="#cb412-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb412-13"><a href="#cb412-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb412-14"><a href="#cb412-14" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>ostream<span class="op">&amp;</span> <span class="va">os_</span><span class="op">;</span></span>
<span id="cb412-15"><a href="#cb412-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb412-16"><a href="#cb412-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb412-17"><a href="#cb412-17" aria-hidden="true" tabindex="-1"></a>    TEST<span class="op">(</span>Template<span class="op">,</span> generic_lambda_like<span class="op">)</span></span>
<span id="cb412-18"><a href="#cb412-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb412-19"><a href="#cb412-19" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> oss <span class="op">=</span> <span class="bu">std::</span>ostringstream<span class="op">{};</span></span>
<span id="cb412-20"><a href="#cb412-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb412-21"><a href="#cb412-21" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> closure <span class="op">=</span> Closure<span class="op">{</span>oss<span class="op">};</span></span>
<span id="cb412-22"><a href="#cb412-22" aria-hidden="true" tabindex="-1"></a>        f<span class="op">(</span>closure<span class="op">);</span></span>
<span id="cb412-23"><a href="#cb412-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb412-24"><a href="#cb412-24" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;1</span><span class="sc">\n</span><span class="st">2.71</span><span class="sc">\n</span><span class="st">hehe</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">,</span> oss<span class="op">.</span>str<span class="op">());</span></span>
<span id="cb412-25"><a href="#cb412-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<h4 id="stdvariantとジェネリックラムダ">std::variantとジェネリックラムダ
<a id="SS_3_6_2_2"></a></h4>
<p>unionは、オブジェクトを全く無関係な複数の型に切り替えることができるため、
これが必要な場面では有用な機能であるが、未定義動作を誘発してしまう問題がある。
この対策としてC++17で導入されたものが、std::variantである。</p>
<p>まずは、std::variantの使用例を下記する。</p>
<div class="sourceCode" id="cb413"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb413-1"><a href="#cb413-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/variant_ut.cpp 13</span></span>
<span id="cb413-2"><a href="#cb413-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-3"><a href="#cb413-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> v <span class="op">=</span> <span class="bu">std::</span>variant<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="bu">std::</span>string<span class="op">,</span> <span class="dt">double</span><span class="op">&gt;{};</span>  <span class="co">// 3つの型を切り替える</span></span>
<span id="cb413-4"><a href="#cb413-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-5"><a href="#cb413-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// std::get&lt;N&gt;()の戻り値型は、下記の通りで、</span></span>
<span id="cb413-6"><a href="#cb413-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">// N == 0, 1, 2 は、それぞれint, std::string, doubleに対応</span></span>
<span id="cb413-7"><a href="#cb413-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span><span class="bu">std::</span>get<span class="op">&lt;</span><span class="dv">0</span><span class="op">&gt;(</span>v<span class="op">)),</span> <span class="dt">int</span><span class="op">&amp;&gt;);</span></span>
<span id="cb413-8"><a href="#cb413-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span><span class="bu">std::</span>get<span class="op">&lt;</span><span class="dv">1</span><span class="op">&gt;(</span>v<span class="op">)),</span> <span class="bu">std::</span>string<span class="op">&amp;&gt;);</span></span>
<span id="cb413-9"><a href="#cb413-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span><span class="bu">std::</span>get<span class="op">&lt;</span><span class="dv">2</span><span class="op">&gt;(</span>v<span class="op">)),</span> <span class="dt">double</span><span class="op">&amp;&gt;);</span></span>
<span id="cb413-10"><a href="#cb413-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-11"><a href="#cb413-11" aria-hidden="true" tabindex="-1"></a>    v <span class="op">=</span> <span class="dt">int</span><span class="op">{</span><span class="dv">3</span><span class="op">};</span>  <span class="co">// int型の3を代入</span></span>
<span id="cb413-12"><a href="#cb413-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-13"><a href="#cb413-13" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>v<span class="op">.</span>index<span class="op">(),</span> <span class="dv">0</span><span class="op">);</span>                                <span class="co">// intを保持</span></span>
<span id="cb413-14"><a href="#cb413-14" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="bu">std::</span>get<span class="op">&lt;</span><span class="dv">0</span><span class="op">&gt;(</span>v<span class="op">),</span> <span class="dv">3</span><span class="op">);</span>                           <span class="co">// intなので問題なくアクセス</span></span>
<span id="cb413-15"><a href="#cb413-15" aria-hidden="true" tabindex="-1"></a>    ASSERT_THROW<span class="op">(</span><span class="bu">std::</span>get<span class="op">&lt;</span><span class="dv">1</span><span class="op">&gt;(</span>v<span class="op">),</span> <span class="bu">std::</span>bad_variant_access<span class="op">);</span>  <span class="co">// std::stringではないのでエクセプション</span></span>
<span id="cb413-16"><a href="#cb413-16" aria-hidden="true" tabindex="-1"></a>    ASSERT_THROW<span class="op">(</span><span class="bu">std::</span>get<span class="op">&lt;</span><span class="dv">2</span><span class="op">&gt;(</span>v<span class="op">),</span> <span class="bu">std::</span>bad_variant_access<span class="op">);</span>  <span class="co">// doubleではないのでエクセプション</span></span>
<span id="cb413-17"><a href="#cb413-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-18"><a href="#cb413-18" aria-hidden="true" tabindex="-1"></a>    v <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{</span><span class="st">&quot;str&quot;</span><span class="op">};</span>  <span class="co">// std::stringオブジェクトを代入</span></span>
<span id="cb413-19"><a href="#cb413-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-20"><a href="#cb413-20" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>v<span class="op">.</span>index<span class="op">(),</span> <span class="dv">1</span><span class="op">);</span>                                <span class="co">// std::stringを保持</span></span>
<span id="cb413-21"><a href="#cb413-21" aria-hidden="true" tabindex="-1"></a>    ASSERT_THROW<span class="op">(</span><span class="bu">std::</span>get<span class="op">&lt;</span><span class="dv">0</span><span class="op">&gt;(</span>v<span class="op">),</span> <span class="bu">std::</span>bad_variant_access<span class="op">);</span>  <span class="co">// intではないのでエクセプション</span></span>
<span id="cb413-22"><a href="#cb413-22" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="bu">std::</span>get<span class="op">&lt;</span><span class="dv">1</span><span class="op">&gt;(</span>v<span class="op">),</span> <span class="bu">std::</span>string<span class="op">{</span><span class="st">&quot;str&quot;</span><span class="op">});</span>  <span class="co">// std::stringなので問題なくアクセス</span></span>
<span id="cb413-23"><a href="#cb413-23" aria-hidden="true" tabindex="-1"></a>    ASSERT_THROW<span class="op">(</span><span class="bu">std::</span>get<span class="op">&lt;</span><span class="dv">2</span><span class="op">&gt;(</span>v<span class="op">),</span> <span class="bu">std::</span>bad_variant_access<span class="op">);</span>  <span class="co">// doubleではないのでエクセプション</span></span></code></pre></div>
<p>上記からわかる通り、std::variantオブジェクトは、直前に代入されたオブジェクトの型以外で、
値を読み出した場合、問題なく読み出せるが、それ以外ではエクセプションを発生させる。</p>
<p>このstd::variantオブジェクトの保持する型とその値を文字列として取り出すラムダ式は、
下記のように書ける。</p>
<div class="sourceCode" id="cb414"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb414-1"><a href="#cb414-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/variant_ut.cpp 37</span></span>
<span id="cb414-2"><a href="#cb414-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb414-3"><a href="#cb414-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> oss <span class="op">=</span> <span class="bu">std::</span>ostringstream<span class="op">{};</span></span>
<span id="cb414-4"><a href="#cb414-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb414-5"><a href="#cb414-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// type_valueはvが保持する型をその値を文字列で返す</span></span>
<span id="cb414-6"><a href="#cb414-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> type_value <span class="op">=</span> <span class="op">[&amp;</span>oss<span class="op">](</span><span class="kw">auto</span> <span class="at">const</span><span class="op">&amp;</span> v<span class="op">)</span> <span class="op">{</span>  <span class="co">// ジェネリックラムダでなくても実装可能</span></span>
<span id="cb414-7"><a href="#cb414-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>v<span class="op">.</span>index<span class="op">()</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb414-8"><a href="#cb414-8" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> a  <span class="op">=</span> <span class="bu">std::</span>get<span class="op">&lt;</span><span class="dv">0</span><span class="op">&gt;(</span>v<span class="op">);</span></span>
<span id="cb414-9"><a href="#cb414-9" aria-hidden="true" tabindex="-1"></a>            <span class="kw">using</span> T <span class="op">=</span> <span class="bu">std::</span>remove_const_t<span class="op">&lt;</span><span class="bu">std::</span>remove_reference_t<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span>a<span class="op">)&gt;&gt;;</span></span>
<span id="cb414-10"><a href="#cb414-10" aria-hidden="true" tabindex="-1"></a>            oss <span class="op">&lt;&lt;</span> Nstd<span class="op">::</span>Type2Str<span class="op">&lt;</span>T<span class="op">&gt;()</span> <span class="op">&lt;&lt;</span> <span class="st">&quot; : &quot;</span> <span class="op">&lt;&lt;</span> a<span class="op">;</span>  <span class="co">// Nstd::Type2Str&lt;T&gt;はTの型を文字列にする</span></span>
<span id="cb414-11"><a href="#cb414-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb414-12"><a href="#cb414-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>v<span class="op">.</span>index<span class="op">()</span> <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb414-13"><a href="#cb414-13" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> a  <span class="op">=</span> <span class="bu">std::</span>get<span class="op">&lt;</span><span class="dv">1</span><span class="op">&gt;(</span>v<span class="op">);</span></span>
<span id="cb414-14"><a href="#cb414-14" aria-hidden="true" tabindex="-1"></a>            <span class="kw">using</span> T <span class="op">=</span> <span class="bu">std::</span>remove_const_t<span class="op">&lt;</span><span class="bu">std::</span>remove_reference_t<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span>a<span class="op">)&gt;&gt;;</span></span>
<span id="cb414-15"><a href="#cb414-15" aria-hidden="true" tabindex="-1"></a>            oss <span class="op">&lt;&lt;</span> Nstd<span class="op">::</span>Type2Str<span class="op">&lt;</span>T<span class="op">&gt;()</span> <span class="op">&lt;&lt;</span> <span class="st">&quot; : &quot;</span> <span class="op">&lt;&lt;</span> a<span class="op">;</span>  <span class="co">// Nstd::Type2Str&lt;T&gt;はTの型を文字列にする</span></span>
<span id="cb414-16"><a href="#cb414-16" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb414-17"><a href="#cb414-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>v<span class="op">.</span>index<span class="op">()</span> <span class="op">==</span> <span class="dv">2</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb414-18"><a href="#cb414-18" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> a  <span class="op">=</span> <span class="bu">std::</span>get<span class="op">&lt;</span><span class="dv">2</span><span class="op">&gt;(</span>v<span class="op">);</span></span>
<span id="cb414-19"><a href="#cb414-19" aria-hidden="true" tabindex="-1"></a>            <span class="kw">using</span> T <span class="op">=</span> <span class="bu">std::</span>remove_const_t<span class="op">&lt;</span><span class="bu">std::</span>remove_reference_t<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span>a<span class="op">)&gt;&gt;;</span></span>
<span id="cb414-20"><a href="#cb414-20" aria-hidden="true" tabindex="-1"></a>            oss <span class="op">&lt;&lt;</span> Nstd<span class="op">::</span>Type2Str<span class="op">&lt;</span>T<span class="op">&gt;()</span> <span class="op">&lt;&lt;</span> <span class="st">&quot; : &quot;</span> <span class="op">&lt;&lt;</span> a<span class="op">;</span>  <span class="co">// Nstd::Type2Str&lt;T&gt;はTの型を文字列にする</span></span>
<span id="cb414-21"><a href="#cb414-21" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb414-22"><a href="#cb414-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb414-23"><a href="#cb414-23" aria-hidden="true" tabindex="-1"></a>            <span class="ot">assert</span><span class="op">(</span><span class="kw">false</span><span class="op">);</span>  <span class="co">// ここには来ないはず</span></span>
<span id="cb414-24"><a href="#cb414-24" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb414-25"><a href="#cb414-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb414-26"><a href="#cb414-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb414-27"><a href="#cb414-27" aria-hidden="true" tabindex="-1"></a>    v <span class="op">=</span> <span class="dv">3</span><span class="op">;</span>  <span class="co">// int型の3を代入</span></span>
<span id="cb414-28"><a href="#cb414-28" aria-hidden="true" tabindex="-1"></a>    type_value<span class="op">(</span>v<span class="op">);</span></span>
<span id="cb414-29"><a href="#cb414-29" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;int : 3&quot;</span><span class="op">,</span> oss<span class="op">.</span>str<span class="op">());</span></span>
<span id="cb414-30"><a href="#cb414-30" aria-hidden="true" tabindex="-1"></a>    oss <span class="op">=</span> <span class="bu">std::</span>ostringstream<span class="op">{};</span>  <span class="co">// ossのリセット</span></span>
<span id="cb414-31"><a href="#cb414-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb414-32"><a href="#cb414-32" aria-hidden="true" tabindex="-1"></a>    v <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{</span><span class="st">&quot;str&quot;</span><span class="op">};</span>  <span class="co">// std::stringオブジェクトを代入</span></span>
<span id="cb414-33"><a href="#cb414-33" aria-hidden="true" tabindex="-1"></a>    type_value<span class="op">(</span>v<span class="op">);</span></span>
<span id="cb414-34"><a href="#cb414-34" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;std::string : str&quot;</span><span class="op">,</span> oss<span class="op">.</span>str<span class="op">());</span></span>
<span id="cb414-35"><a href="#cb414-35" aria-hidden="true" tabindex="-1"></a>    oss <span class="op">=</span> <span class="bu">std::</span>ostringstream<span class="op">{};</span>  <span class="co">// ossのリセット</span></span>
<span id="cb414-36"><a href="#cb414-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb414-37"><a href="#cb414-37" aria-hidden="true" tabindex="-1"></a>    v <span class="op">=</span> <span class="fl">1.1</span><span class="op">;</span>  <span class="co">// double型の1.1を代入</span></span>
<span id="cb414-38"><a href="#cb414-38" aria-hidden="true" tabindex="-1"></a>    type_value<span class="op">(</span>v<span class="op">);</span></span>
<span id="cb414-39"><a href="#cb414-39" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;double : 1.1&quot;</span><span class="op">,</span> oss<span class="op">.</span>str<span class="op">());</span></span></code></pre></div>
<p>このラムダは、
3つの型をテンプレートパラメータとするstd::variantオブジェクト以外には適用できないため、
型の個数に制限のない方法を考える。</p>
<p>この実装は、</p>
<ul>
<li>保持する型が何番目かを見つけるための関数テンプレート</li>
<li>関数テンプレートの引数となるジェネリックラムダ</li>
</ul>
<p>の2つによって下記のように行うことができる。</p>
<div class="sourceCode" id="cb415"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb415-1"><a href="#cb415-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/variant_ut.cpp 79</span></span>
<span id="cb415-2"><a href="#cb415-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb415-3"><a href="#cb415-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> VARIANT<span class="op">,</span> <span class="kw">typename</span> F<span class="op">,</span> <span class="dt">size_t</span> INDEX <span class="op">=</span> <span class="dv">0</span><span class="op">&gt;</span></span>
<span id="cb415-4"><a href="#cb415-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> org_visit<span class="op">(</span><span class="at">const</span> F<span class="op">&amp;</span> f<span class="op">,</span> <span class="at">const</span> VARIANT<span class="op">&amp;</span> v<span class="op">)</span></span>
<span id="cb415-5"><a href="#cb415-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb415-6"><a href="#cb415-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">constexpr</span> <span class="kw">auto</span> n <span class="op">=</span> <span class="bu">std::</span>variant_size_v<span class="op">&lt;</span>VARIANT<span class="op">&gt;;</span></span>
<span id="cb415-7"><a href="#cb415-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb415-8"><a href="#cb415-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">constexpr</span> <span class="op">(</span>INDEX <span class="op">&lt;</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb415-9"><a href="#cb415-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>v<span class="op">.</span>index<span class="op">()</span> <span class="op">==</span> INDEX<span class="op">)</span> <span class="op">{</span>  <span class="co">// 保持する型が見つかった</span></span>
<span id="cb415-10"><a href="#cb415-10" aria-hidden="true" tabindex="-1"></a>                f<span class="op">(</span><span class="bu">std::</span>get<span class="op">&lt;</span>INDEX<span class="op">&gt;(</span>v<span class="op">));</span></span>
<span id="cb415-11"><a href="#cb415-11" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span><span class="op">;</span></span>
<span id="cb415-12"><a href="#cb415-12" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb415-13"><a href="#cb415-13" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> <span class="op">{</span>  <span class="co">// 保持する型が見つかるまでリカーシブ</span></span>
<span id="cb415-14"><a href="#cb415-14" aria-hidden="true" tabindex="-1"></a>                org_visit<span class="op">&lt;</span>VARIANT<span class="op">,</span> F<span class="op">,</span> INDEX <span class="op">+</span> <span class="dv">1</span><span class="op">&gt;(</span>f<span class="op">,</span> v<span class="op">);</span></span>
<span id="cb415-15"><a href="#cb415-15" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb415-16"><a href="#cb415-16" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb415-17"><a href="#cb415-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb415-18"><a href="#cb415-18" aria-hidden="true" tabindex="-1"></a>            <span class="ot">assert</span><span class="op">(</span><span class="kw">false</span><span class="op">);</span>  <span class="co">// ここには来ないはず</span></span>
<span id="cb415-19"><a href="#cb415-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb415-20"><a href="#cb415-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb416"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb416-1"><a href="#cb416-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/variant_ut.cpp 103</span></span>
<span id="cb416-2"><a href="#cb416-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb416-3"><a href="#cb416-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> oss <span class="op">=</span> <span class="bu">std::</span>ostringstream<span class="op">{};</span></span>
<span id="cb416-4"><a href="#cb416-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb416-5"><a href="#cb416-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 文字列を返すためのジェネリックラムダ</span></span>
<span id="cb416-6"><a href="#cb416-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> type_value <span class="op">=</span> <span class="op">[&amp;</span>oss<span class="op">](</span><span class="kw">auto</span> <span class="at">const</span><span class="op">&amp;</span> a<span class="op">)</span> <span class="op">{</span></span>
<span id="cb416-7"><a href="#cb416-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> T <span class="op">=</span> <span class="bu">std::</span>remove_const_t<span class="op">&lt;</span><span class="bu">std::</span>remove_reference_t<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span>a<span class="op">)&gt;&gt;;</span></span>
<span id="cb416-8"><a href="#cb416-8" aria-hidden="true" tabindex="-1"></a>        oss <span class="op">&lt;&lt;</span> Nstd<span class="op">::</span>Type2Str<span class="op">&lt;</span>T<span class="op">&gt;()</span> <span class="op">&lt;&lt;</span> <span class="st">&quot; : &quot;</span> <span class="op">&lt;&lt;</span> a<span class="op">;</span></span>
<span id="cb416-9"><a href="#cb416-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>単体テストは、以下のようになる。</p>
<div class="sourceCode" id="cb417"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb417-1"><a href="#cb417-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/variant_ut.cpp 113</span></span>
<span id="cb417-2"><a href="#cb417-2" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb417-3"><a href="#cb417-3" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> v <span class="op">=</span> <span class="bu">std::</span>variant<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="bu">std::</span>string<span class="op">,</span> <span class="dt">double</span><span class="op">&gt;{};</span>  <span class="co">// 3つの型を切り替える</span></span>
<span id="cb417-4"><a href="#cb417-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb417-5"><a href="#cb417-5" aria-hidden="true" tabindex="-1"></a>        v <span class="op">=</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb417-6"><a href="#cb417-6" aria-hidden="true" tabindex="-1"></a>        org_visit<span class="op">(</span>type_value<span class="op">,</span> v<span class="op">);</span></span>
<span id="cb417-7"><a href="#cb417-7" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;int : 3&quot;</span><span class="op">,</span> oss<span class="op">.</span>str<span class="op">());</span></span>
<span id="cb417-8"><a href="#cb417-8" aria-hidden="true" tabindex="-1"></a>        oss <span class="op">=</span> <span class="bu">std::</span>ostringstream<span class="op">{};</span>  <span class="co">// ossのリセット</span></span>
<span id="cb417-9"><a href="#cb417-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb417-10"><a href="#cb417-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb417-11"><a href="#cb417-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb417-12"><a href="#cb417-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb417-13"><a href="#cb417-13" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> v <span class="op">=</span> <span class="bu">std::</span>variant<span class="op">&lt;</span><span class="dt">char</span><span class="op">,</span> <span class="dt">int</span><span class="op">,</span> <span class="bu">std::</span>string<span class="op">,</span> <span class="dt">double</span><span class="op">&gt;{};</span>  <span class="co">// 4つの型を切り替える</span></span>
<span id="cb417-14"><a href="#cb417-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb417-15"><a href="#cb417-15" aria-hidden="true" tabindex="-1"></a>        v <span class="op">=</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb417-16"><a href="#cb417-16" aria-hidden="true" tabindex="-1"></a>        org_visit<span class="op">(</span>type_value<span class="op">,</span> v<span class="op">);</span></span>
<span id="cb417-17"><a href="#cb417-17" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;int : 3&quot;</span><span class="op">,</span> oss<span class="op">.</span>str<span class="op">());</span></span>
<span id="cb417-18"><a href="#cb417-18" aria-hidden="true" tabindex="-1"></a>        oss <span class="op">=</span> <span class="bu">std::</span>ostringstream<span class="op">{};</span>  <span class="co">// ossのリセット</span></span>
<span id="cb417-19"><a href="#cb417-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb417-20"><a href="#cb417-20" aria-hidden="true" tabindex="-1"></a>        v <span class="op">=</span> <span class="ch">&#39;c&#39;</span><span class="op">;</span></span>
<span id="cb417-21"><a href="#cb417-21" aria-hidden="true" tabindex="-1"></a>        org_visit<span class="op">(</span>type_value<span class="op">,</span> v<span class="op">);</span></span>
<span id="cb417-22"><a href="#cb417-22" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;char : c&quot;</span><span class="op">,</span> oss<span class="op">.</span>str<span class="op">());</span></span>
<span id="cb417-23"><a href="#cb417-23" aria-hidden="true" tabindex="-1"></a>        oss <span class="op">=</span> <span class="bu">std::</span>ostringstream<span class="op">{};</span>  <span class="co">// ossのリセット</span></span>
<span id="cb417-24"><a href="#cb417-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb417-25"><a href="#cb417-25" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb417-26"><a href="#cb417-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>下記のように継承関係のない複数のクラスが同じシグネチャのメンバ関数を持つ場合、</p>
<div class="sourceCode" id="cb418"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb418-1"><a href="#cb418-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/variant_ut.cpp 177</span></span>
<span id="cb418-2"><a href="#cb418-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb418-3"><a href="#cb418-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> A <span class="op">{</span></span>
<span id="cb418-4"><a href="#cb418-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb418-5"><a href="#cb418-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">char</span> f<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="ch">&#39;A&#39;</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb418-6"><a href="#cb418-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb418-7"><a href="#cb418-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb418-8"><a href="#cb418-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> B <span class="op">{</span></span>
<span id="cb418-9"><a href="#cb418-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb418-10"><a href="#cb418-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">char</span> f<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="ch">&#39;B&#39;</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb418-11"><a href="#cb418-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb418-12"><a href="#cb418-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb418-13"><a href="#cb418-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> C <span class="op">{</span></span>
<span id="cb418-14"><a href="#cb418-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb418-15"><a href="#cb418-15" aria-hidden="true" tabindex="-1"></a>        <span class="dt">char</span> f<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="ch">&#39;C&#39;</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb418-16"><a href="#cb418-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>std::variant、上に示した関数テンプレート、ジェネリックラムダを使い、
下記に示したような疑似的なポリモーフィズムを実現できる。</p>
<div class="sourceCode" id="cb419"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb419-1"><a href="#cb419-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/variant_ut.cpp 197</span></span>
<span id="cb419-2"><a href="#cb419-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3"><a href="#cb419-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> ret<span class="op">{};</span></span>
<span id="cb419-4"><a href="#cb419-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> call_f <span class="op">=</span> <span class="op">[&amp;</span>ret<span class="op">](</span><span class="kw">auto</span> <span class="at">const</span><span class="op">&amp;</span> a<span class="op">)</span> <span class="op">{</span> ret <span class="op">=</span> a<span class="op">.</span>f<span class="op">();</span> <span class="op">};</span></span>
<span id="cb419-5"><a href="#cb419-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6"><a href="#cb419-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> v <span class="op">=</span> <span class="bu">std::</span>variant<span class="op">&lt;</span>A<span class="op">,</span> B<span class="op">,</span> C<span class="op">&gt;{};</span></span>
<span id="cb419-7"><a href="#cb419-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-8"><a href="#cb419-8" aria-hidden="true" tabindex="-1"></a>    org_visit<span class="op">(</span>call_f<span class="op">,</span> v<span class="op">);</span>  <span class="co">// 疑似的なポリモーフィズム</span></span>
<span id="cb419-9"><a href="#cb419-9" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="ch">&#39;A&#39;</span><span class="op">,</span> ret<span class="op">);</span></span>
<span id="cb419-10"><a href="#cb419-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-11"><a href="#cb419-11" aria-hidden="true" tabindex="-1"></a>    v <span class="op">=</span> B<span class="op">{};</span></span>
<span id="cb419-12"><a href="#cb419-12" aria-hidden="true" tabindex="-1"></a>    org_visit<span class="op">(</span>call_f<span class="op">,</span> v<span class="op">);</span>  <span class="co">// 疑似的なポリモーフィズム</span></span>
<span id="cb419-13"><a href="#cb419-13" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="ch">&#39;B&#39;</span><span class="op">,</span> ret<span class="op">);</span></span>
<span id="cb419-14"><a href="#cb419-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-15"><a href="#cb419-15" aria-hidden="true" tabindex="-1"></a>    v <span class="op">=</span> C<span class="op">{};</span></span>
<span id="cb419-16"><a href="#cb419-16" aria-hidden="true" tabindex="-1"></a>    org_visit<span class="op">(</span>call_f<span class="op">,</span> v<span class="op">);</span>  <span class="co">// 疑似的なポリモーフィズム</span></span>
<span id="cb419-17"><a href="#cb419-17" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="ch">&#39;C&#39;</span><span class="op">,</span> ret<span class="op">);</span></span></code></pre></div>
<p>ここで示した関数テンプレートは、デザインパターン<a
href="#SS_2_20">Visitor</a>の例であり、
ほぼこれと同様のものがstd::visitとして定義されている。</p>
<div class="sourceCode" id="cb420"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb420-1"><a href="#cb420-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/variant_ut.cpp 215</span></span>
<span id="cb420-2"><a href="#cb420-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb420-3"><a href="#cb420-3" aria-hidden="true" tabindex="-1"></a>    v <span class="op">=</span> A<span class="op">{};</span></span>
<span id="cb420-4"><a href="#cb420-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>visit<span class="op">(</span>call_f<span class="op">,</span> v<span class="op">);</span>  <span class="co">// 疑似的なポリモーフィズム</span></span>
<span id="cb420-5"><a href="#cb420-5" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="ch">&#39;A&#39;</span><span class="op">,</span> ret<span class="op">);</span></span>
<span id="cb420-6"><a href="#cb420-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb420-7"><a href="#cb420-7" aria-hidden="true" tabindex="-1"></a>    v <span class="op">=</span> B<span class="op">{};</span></span>
<span id="cb420-8"><a href="#cb420-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>visit<span class="op">(</span>call_f<span class="op">,</span> v<span class="op">);</span>  <span class="co">// 疑似的なポリモーフィズム</span></span>
<span id="cb420-9"><a href="#cb420-9" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="ch">&#39;B&#39;</span><span class="op">,</span> ret<span class="op">);</span></span>
<span id="cb420-10"><a href="#cb420-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb420-11"><a href="#cb420-11" aria-hidden="true" tabindex="-1"></a>    v <span class="op">=</span> C<span class="op">{};</span></span>
<span id="cb420-12"><a href="#cb420-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>visit<span class="op">(</span>call_f<span class="op">,</span> v<span class="op">);</span>  <span class="co">// 疑似的なポリモーフィズム</span></span>
<span id="cb420-13"><a href="#cb420-13" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="ch">&#39;C&#39;</span><span class="op">,</span> ret<span class="op">);</span></span></code></pre></div>
<h3
id="クラステンプレートと継承の再帰構造">クラステンプレートと継承の再帰構造
<a id="SS_3_6_3"></a></h3>
<p>クラステンプレートと継承の再帰構造はCRTPと呼ばれる。
このコードパターンについては、 「<a href="#SS_2_21">CRTP(curiously
recurring template pattern)</a>」で説明している。</p>
<h3 id="constexpr-if文">constexpr if文 <a id="SS_3_6_4"></a></h3>
<p>C++17で導入された<a
href="https://cpprefjp.github.io/lang/cpp17/if_constexpr.html">constexpr
if文</a>とは、
文を条件付きコンパイルすることができるようにするための制御構文である。</p>
<p>まずは、この構文を使用しない例を示す。</p>
<div class="sourceCode" id="cb421"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb421-1"><a href="#cb421-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/constexpr_if_ut.cpp 9</span></span>
<span id="cb421-2"><a href="#cb421-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb421-3"><a href="#cb421-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 配列のサイズ</span></span>
<span id="cb421-4"><a href="#cb421-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb421-5"><a href="#cb421-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> Length<span class="op">(</span>T <span class="at">const</span><span class="op">&amp;)</span> <span class="op">-&gt;</span> <span class="bu">std::</span>enable_if_t<span class="op">&lt;</span><span class="bu">std::</span>is_array_v<span class="op">&lt;</span>T<span class="op">&gt;,</span> <span class="dt">size_t</span><span class="op">&gt;</span></span>
<span id="cb421-6"><a href="#cb421-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb421-7"><a href="#cb421-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">std::</span>extent_v<span class="op">&lt;</span>T<span class="op">&gt;;</span></span>
<span id="cb421-8"><a href="#cb421-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb421-9"><a href="#cb421-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb421-10"><a href="#cb421-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">// コンテナのサイズ</span></span>
<span id="cb421-11"><a href="#cb421-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb421-12"><a href="#cb421-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> Length<span class="op">(</span>T <span class="at">const</span><span class="op">&amp;</span> t<span class="op">)</span> <span class="op">-&gt;</span> <span class="kw">decltype</span><span class="op">(</span>t<span class="op">.</span>size<span class="op">())</span></span>
<span id="cb421-13"><a href="#cb421-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb421-14"><a href="#cb421-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> t<span class="op">.</span>size<span class="op">();</span></span>
<span id="cb421-15"><a href="#cb421-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb421-16"><a href="#cb421-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb421-17"><a href="#cb421-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">// その他のサイズ</span></span>
<span id="cb421-18"><a href="#cb421-18" aria-hidden="true" tabindex="-1"></a>    <span class="dt">size_t</span> Length<span class="op">(...)</span> <span class="op">{</span> <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span> <span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb422"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb422-1"><a href="#cb422-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/constexpr_if_ut.cpp 31</span></span>
<span id="cb422-2"><a href="#cb422-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb422-3"><a href="#cb422-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">uint32_t</span> a<span class="op">[</span><span class="dv">5</span><span class="op">];</span></span>
<span id="cb422-4"><a href="#cb422-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span>     v <span class="op">=</span> <span class="bu">std::</span>vector<span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">};</span></span>
<span id="cb422-5"><a href="#cb422-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> SizeTest <span class="op">{</span></span>
<span id="cb422-6"><a href="#cb422-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> t<span class="op">;</span></span>
<span id="cb422-7"><a href="#cb422-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb422-8"><a href="#cb422-8" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">5</span><span class="op">,</span> Length<span class="op">(</span>a<span class="op">));</span></span>
<span id="cb422-9"><a href="#cb422-9" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">3</span><span class="op">,</span> Length<span class="op">(</span>v<span class="op">));</span></span>
<span id="cb422-10"><a href="#cb422-10" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">0</span><span class="op">,</span> Length<span class="op">(</span>t<span class="op">));</span></span>
<span id="cb422-11"><a href="#cb422-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb422-12"><a href="#cb422-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">// C++17で、Lengthと同様の機能の関数テンプレートがSTLに追加された</span></span>
<span id="cb422-13"><a href="#cb422-13" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="bu">std::</span>size<span class="op">(</span>a<span class="op">),</span> Length<span class="op">(</span>a<span class="op">));</span></span>
<span id="cb422-14"><a href="#cb422-14" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="bu">std::</span>size<span class="op">(</span>v<span class="op">),</span> Length<span class="op">(</span>v<span class="op">));</span></span></code></pre></div>
<p>このような場合、<a
href="#SS_5_4_7">SFINAE</a>によるオーバーロードが必須であったが、
この文を使用することで、下記のようにオーバーロードを使用せずに記述できるため、
条件分岐の可読性の向上が見込める。</p>
<div class="sourceCode" id="cb423"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb423-1"><a href="#cb423-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/constexpr_if_ut.cpp 52</span></span>
<span id="cb423-2"><a href="#cb423-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb423-3"><a href="#cb423-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> helper <span class="op">{</span></span>
<span id="cb423-4"><a href="#cb423-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb423-5"><a href="#cb423-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> <span class="kw">operator</span><span class="op">()(</span>T <span class="at">const</span><span class="op">&amp;</span> t<span class="op">)</span> <span class="op">-&gt;</span> <span class="kw">decltype</span><span class="op">(</span>t<span class="op">.</span>size<span class="op">());</span></span>
<span id="cb423-6"><a href="#cb423-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb423-7"><a href="#cb423-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb423-8"><a href="#cb423-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb423-9"><a href="#cb423-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">size_t</span> Length<span class="op">(</span>T <span class="at">const</span><span class="op">&amp;</span> t<span class="op">)</span></span>
<span id="cb423-10"><a href="#cb423-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb423-11"><a href="#cb423-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">constexpr</span> <span class="op">(</span><span class="bu">std::</span>is_array_v<span class="op">&lt;</span>T<span class="op">&gt;)</span> <span class="op">{</span>  <span class="co">// Tが配列の場合</span></span>
<span id="cb423-12"><a href="#cb423-12" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Tが配列でない場合、他の条件のブロックはコンパイル対象外</span></span>
<span id="cb423-13"><a href="#cb423-13" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="bu">std::</span>extent_v<span class="op">&lt;</span>T<span class="op">&gt;;</span></span>
<span id="cb423-14"><a href="#cb423-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb423-15"><a href="#cb423-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="cf">if</span> <span class="kw">constexpr</span> <span class="op">(</span><span class="bu">std::</span>is_invocable_v<span class="op">&lt;</span>helper<span class="op">,</span> T<span class="op">&gt;)</span> <span class="op">{</span>  <span class="co">// T::Lengthが呼び出せる場合</span></span>
<span id="cb423-16"><a href="#cb423-16" aria-hidden="true" tabindex="-1"></a>            <span class="co">// T::Lengthが呼び出せない場合、他の条件のブロックはコンパイル対象外</span></span>
<span id="cb423-17"><a href="#cb423-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> t<span class="op">.</span>size<span class="op">();</span></span>
<span id="cb423-18"><a href="#cb423-18" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb423-19"><a href="#cb423-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="op">{</span>  <span class="co">// それ以外</span></span>
<span id="cb423-20"><a href="#cb423-20" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Tが配列でなく且つ、T::Lengthが呼び出ない場合、他の条件のブロックはコンパイル対象外</span></span>
<span id="cb423-21"><a href="#cb423-21" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb423-22"><a href="#cb423-22" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb423-23"><a href="#cb423-23" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>この構文は<a
href="#SS_3_1_3">パラメータパック</a>の展開においても有用な場合がある。</p>
<div class="sourceCode" id="cb424"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb424-1"><a href="#cb424-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/constexpr_if_ut.cpp 93</span></span>
<span id="cb424-2"><a href="#cb424-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb424-3"><a href="#cb424-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// テンプレートパラメータで与えられた型のsizeofの値が最も大きな値を返す。</span></span>
<span id="cb424-4"><a href="#cb424-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> HEAD<span class="op">&gt;</span></span>
<span id="cb424-5"><a href="#cb424-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">size_t</span> MaxSizeof<span class="op">()</span></span>
<span id="cb424-6"><a href="#cb424-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb424-7"><a href="#cb424-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">sizeof</span><span class="op">(</span>HEAD<span class="op">);</span></span>
<span id="cb424-8"><a href="#cb424-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb424-9"><a href="#cb424-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb424-10"><a href="#cb424-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> HEAD<span class="op">,</span> <span class="kw">typename</span> T<span class="op">,</span> <span class="kw">typename</span><span class="op">...</span> TAILS<span class="op">&gt;</span></span>
<span id="cb424-11"><a href="#cb424-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">size_t</span> MaxSizeof<span class="op">()</span></span>
<span id="cb424-12"><a href="#cb424-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb424-13"><a href="#cb424-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">std::</span>max<span class="op">(</span><span class="kw">sizeof</span><span class="op">(</span>HEAD<span class="op">),</span> MaxSizeof<span class="op">&lt;</span>T<span class="op">,</span> TAILS<span class="op">...&gt;());</span></span>
<span id="cb424-14"><a href="#cb424-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb425"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb425-1"><a href="#cb425-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/constexpr_if_ut.cpp 111</span></span>
<span id="cb425-2"><a href="#cb425-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb425-3"><a href="#cb425-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="dv">4</span> <span class="op">==</span> <span class="op">(</span>MaxSizeof<span class="op">&lt;</span><span class="dt">int8_t</span><span class="op">,</span> <span class="dt">int16_t</span><span class="op">,</span> <span class="dt">int32_t</span><span class="op">&gt;()));</span></span>
<span id="cb425-4"><a href="#cb425-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="dv">4</span> <span class="op">==</span> <span class="op">(</span>MaxSizeof<span class="op">&lt;</span><span class="dt">int32_t</span><span class="op">,</span> <span class="dt">int16_t</span><span class="op">,</span> <span class="dt">int8_t</span><span class="op">&gt;()));</span></span>
<span id="cb425-5"><a href="#cb425-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="kw">sizeof</span><span class="op">(</span><span class="bu">std::</span>string<span class="op">)</span> <span class="op">==</span> MaxSizeof<span class="op">&lt;</span><span class="dt">int32_t</span><span class="op">,</span> <span class="dt">int16_t</span><span class="op">,</span> <span class="dt">int8_t</span><span class="op">,</span> <span class="bu">std::</span>string<span class="op">&gt;());</span></span></code></pre></div>
<p>C++14までの構文を使用する場合、
上記のようなオーバーロードとリカーシブコールの組み合わせが必要であったが、
constexpr ifを使用することで、やや単純に記述できる。</p>
<div class="sourceCode" id="cb426"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb426-1"><a href="#cb426-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/constexpr_if_ut.cpp 123</span></span>
<span id="cb426-2"><a href="#cb426-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb426-3"><a href="#cb426-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// テンプレートパラメータで与えられた型のsizeofの値が最も大きな値を返す。</span></span>
<span id="cb426-4"><a href="#cb426-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> HEAD<span class="op">,</span> <span class="kw">typename</span><span class="op">...</span> TAILS<span class="op">&gt;</span></span>
<span id="cb426-5"><a href="#cb426-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">size_t</span> MaxSizeof<span class="op">()</span></span>
<span id="cb426-6"><a href="#cb426-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb426-7"><a href="#cb426-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">constexpr</span> <span class="op">(</span><span class="kw">sizeof</span><span class="op">...(</span>TAILS<span class="op">)</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span>  <span class="co">// TAILSが存在しない場合</span></span>
<span id="cb426-8"><a href="#cb426-8" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="kw">sizeof</span><span class="op">(</span>HEAD<span class="op">);</span></span>
<span id="cb426-9"><a href="#cb426-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb426-10"><a href="#cb426-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb426-11"><a href="#cb426-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="bu">std::</span>max<span class="op">(</span><span class="kw">sizeof</span><span class="op">(</span>HEAD<span class="op">),</span> MaxSizeof<span class="op">&lt;</span>TAILS<span class="op">...&gt;());</span></span>
<span id="cb426-12"><a href="#cb426-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb426-13"><a href="#cb426-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<h3 id="意図しないname-lookupの防止">意図しないname lookupの防止
<a id="SS_3_6_5"></a></h3>
<p>下記のようにクラスや関数テンプレートが定義されている場合を考える。</p>
<div class="sourceCode" id="cb427"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb427-1"><a href="#cb427-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/suppress_adl_ut.cpp 11</span></span>
<span id="cb427-2"><a href="#cb427-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb427-3"><a href="#cb427-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> App <span class="op">{</span></span>
<span id="cb427-4"><a href="#cb427-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb427-5"><a href="#cb427-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> XY <span class="op">{</span></span>
<span id="cb427-6"><a href="#cb427-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> x<span class="op">;</span></span>
<span id="cb427-7"><a href="#cb427-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> y<span class="op">;</span></span>
<span id="cb427-8"><a href="#cb427-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb427-9"><a href="#cb427-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb427-10"><a href="#cb427-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">// このような関数テンプレートは適用範囲が広すぎるので定義すべきではないが、</span></span>
<span id="cb427-11"><a href="#cb427-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 危険な例を示すためあえて定義している</span></span>
<span id="cb427-12"><a href="#cb427-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">,</span> <span class="kw">typename</span> U<span class="op">&gt;</span></span>
<span id="cb427-13"><a href="#cb427-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">inline</span> <span class="kw">auto</span> is_equal<span class="op">(</span>T <span class="at">const</span><span class="op">&amp;</span> lhs<span class="op">,</span> U <span class="at">const</span><span class="op">&amp;</span> rhs<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb427-14"><a href="#cb427-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">-&gt;</span> <span class="kw">decltype</span><span class="op">(</span>lhs<span class="op">.</span>x <span class="op">==</span> rhs<span class="op">.</span>x<span class="op">,</span> lhs<span class="op">.</span>y <span class="op">==</span> rhs<span class="op">.</span>y<span class="op">)</span></span>
<span id="cb427-15"><a href="#cb427-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb427-16"><a href="#cb427-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> lhs<span class="op">.</span>x <span class="op">==</span> rhs<span class="op">.</span>x <span class="op">&amp;&amp;</span> lhs<span class="op">.</span>y <span class="op">==</span> rhs<span class="op">.</span>y<span class="op">;</span></span>
<span id="cb427-17"><a href="#cb427-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb427-18"><a href="#cb427-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace App</span></span></code></pre></div>
<p>これに対しての単体テストは下記のようになる。</p>
<div class="sourceCode" id="cb428"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb428-1"><a href="#cb428-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/suppress_adl_ut.cpp 37</span></span>
<span id="cb428-2"><a href="#cb428-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb428-3"><a href="#cb428-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> xy0 <span class="op">=</span> App<span class="op">::</span>XY<span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">};</span></span>
<span id="cb428-4"><a href="#cb428-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> xy1 <span class="op">=</span> App<span class="op">::</span>XY<span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">2</span><span class="op">};</span></span>
<span id="cb428-5"><a href="#cb428-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> xy2 <span class="op">=</span> App<span class="op">::</span>XY<span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">};</span></span>
<span id="cb428-6"><a href="#cb428-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb428-7"><a href="#cb428-7" aria-hidden="true" tabindex="-1"></a>    ASSERT_FALSE<span class="op">(</span>is_equal<span class="op">(</span>xy0<span class="op">,</span> xy1<span class="op">));</span></span>
<span id="cb428-8"><a href="#cb428-8" aria-hidden="true" tabindex="-1"></a>    ASSERT_TRUE<span class="op">(</span>is_equal<span class="op">(</span>xy0<span class="op">,</span> xy2<span class="op">));</span></span>
<span id="cb428-9"><a href="#cb428-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb428-10"><a href="#cb428-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> point <span class="op">{</span></span>
<span id="cb428-11"><a href="#cb428-11" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> x<span class="op">;</span></span>
<span id="cb428-12"><a href="#cb428-12" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> y<span class="op">;</span></span>
<span id="cb428-13"><a href="#cb428-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb428-14"><a href="#cb428-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> p0 <span class="op">=</span> point<span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">};</span></span>
<span id="cb428-15"><a href="#cb428-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb428-16"><a href="#cb428-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 下記のような比較ができるようにするためis_equalはテンプレートで実装している</span></span>
<span id="cb428-17"><a href="#cb428-17" aria-hidden="true" tabindex="-1"></a>    ASSERT_TRUE<span class="op">(</span>is_equal<span class="op">(</span>p0<span class="op">,</span> xy0<span class="op">));</span></span>
<span id="cb428-18"><a href="#cb428-18" aria-hidden="true" tabindex="-1"></a>    ASSERT_FALSE<span class="op">(</span>is_equal<span class="op">(</span>p0<span class="op">,</span> xy1<span class="op">));</span></span></code></pre></div>
<p>上記の抜粋である</p>
<div class="sourceCode" id="cb429"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb429-1"><a href="#cb429-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/suppress_adl_ut.cpp 43</span></span>
<span id="cb429-2"><a href="#cb429-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb429-3"><a href="#cb429-3" aria-hidden="true" tabindex="-1"></a>    ASSERT_FALSE<span class="op">(</span>is_equal<span class="op">(</span>xy0<span class="op">,</span> xy1<span class="op">));</span></span>
<span id="cb429-4"><a href="#cb429-4" aria-hidden="true" tabindex="-1"></a>    ASSERT_TRUE<span class="op">(</span>is_equal<span class="op">(</span>xy0<span class="op">,</span> xy2<span class="op">));</span></span></code></pre></div>
<p>が名前空間Appの指定なしでコンパイルできる理由は、 <a
href="#SS_5_4_5">ADL</a>(実引数依存探索)により、Appもis_equalの<a
href="#SS_5_4_2">name lookup</a>の対象になるからである。
これは便利な機能であるが、その副作用として意図しないname
lookupによるバグの混入を起こしてしまうことがある。</p>
<p>上記の名前空間での定義が可視である状態で、下記のようなコードを書いた場合を考える。</p>
<div class="sourceCode" id="cb430"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb430-1"><a href="#cb430-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/suppress_adl_ut.cpp 63</span></span>
<span id="cb430-2"><a href="#cb430-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb430-3"><a href="#cb430-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> App2 <span class="op">{</span></span>
<span id="cb430-4"><a href="#cb430-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> XYZ <span class="op">{</span></span>
<span id="cb430-5"><a href="#cb430-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> x<span class="op">;</span></span>
<span id="cb430-6"><a href="#cb430-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> y<span class="op">;</span></span>
<span id="cb430-7"><a href="#cb430-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> z<span class="op">;</span></span>
<span id="cb430-8"><a href="#cb430-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb430-9"><a href="#cb430-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb430-10"><a href="#cb430-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">inline</span> <span class="dt">bool</span> is_equal<span class="op">(</span>XYZ <span class="at">const</span><span class="op">&amp;</span> lhs<span class="op">,</span> XYZ <span class="at">const</span><span class="op">&amp;</span> rhs<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb430-11"><a href="#cb430-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb430-12"><a href="#cb430-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> lhs<span class="op">.</span>x <span class="op">==</span> rhs<span class="op">.</span>x <span class="op">&amp;&amp;</span> lhs<span class="op">.</span>y <span class="op">==</span> rhs<span class="op">.</span>y <span class="op">&amp;&amp;</span> lhs<span class="op">.</span>z <span class="op">==</span> rhs<span class="op">.</span>z<span class="op">;</span></span>
<span id="cb430-13"><a href="#cb430-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb430-14"><a href="#cb430-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace App2</span></span></code></pre></div>
<p>この単体テストは、やはりADLを使い下記のように書ける。</p>
<div class="sourceCode" id="cb431"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb431-1"><a href="#cb431-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/suppress_adl_ut.cpp 84</span></span>
<span id="cb431-2"><a href="#cb431-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> xyz0 <span class="op">=</span> App2<span class="op">::</span>XYZ<span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">2</span><span class="op">};</span></span>
<span id="cb431-3"><a href="#cb431-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> xyz1 <span class="op">=</span> App2<span class="op">::</span>XYZ<span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">};</span></span>
<span id="cb431-4"><a href="#cb431-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb431-5"><a href="#cb431-5" aria-hidden="true" tabindex="-1"></a>    ASSERT_TRUE<span class="op">(</span>is_equal<span class="op">(</span>xyz0<span class="op">,</span> xyz0<span class="op">));</span></span>
<span id="cb431-6"><a href="#cb431-6" aria-hidden="true" tabindex="-1"></a>    ASSERT_FALSE<span class="op">(</span>is_equal<span class="op">(</span>xyz0<span class="op">,</span> xyz1<span class="op">));</span></span></code></pre></div>
<p>これに問題はないが、下記のテストもコンパイルでき、且つテストもパスしてしまうことには問題がある。</p>
<div class="sourceCode" id="cb432"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb432-1"><a href="#cb432-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/suppress_adl_ut.cpp 93</span></span>
<span id="cb432-2"><a href="#cb432-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb432-3"><a href="#cb432-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> xyz0 <span class="op">=</span> App2<span class="op">::</span>XYZ<span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">2</span><span class="op">};</span></span>
<span id="cb432-4"><a href="#cb432-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> xyz1 <span class="op">=</span> App2<span class="op">::</span>XYZ<span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">};</span></span>
<span id="cb432-5"><a href="#cb432-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> xy0  <span class="op">=</span> App<span class="op">::</span>XY<span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">};</span></span>
<span id="cb432-6"><a href="#cb432-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb432-7"><a href="#cb432-7" aria-hidden="true" tabindex="-1"></a>    ASSERT_FALSE<span class="op">(</span>is_equal<span class="op">(</span>xy0<span class="op">,</span> xyz0<span class="op">));</span>  <span class="co">// これがコンパイルできてしまう</span></span>
<span id="cb432-8"><a href="#cb432-8" aria-hidden="true" tabindex="-1"></a>    ASSERT_TRUE<span class="op">(</span>is_equal<span class="op">(</span>xy0<span class="op">,</span> xyz1<span class="op">));</span>   <span class="co">// このis_equalはAppで定義されたもの</span></span></code></pre></div>
<p>このセマンティクス的に無意味な(もしくは混乱を引き起こしてしまうであろう)コードは、</p>
<ul>
<li>is_equalの引数の型XY、XYZはそれぞれ名前空間App、App2で定義されている</li>
<li>従って、ADLによりis_equalのname
lookupには名前空間App、App2も使われる</li>
<li>引数の型XY、XYZを取り得るis_equalはAppで定義されたもののみである</li>
</ul>
<p>というメカニズムによりコンパイルできてしまう。</p>
<p>こういったname lookup、特にADLの問題に対処する方法は、</p>
<ul>
<li><a
href="#SS_3_6_5_1">ジェネリックすぎるテンプレートを書かない</a></li>
<li><a
href="#SS_3_6_5_2">ADLが本当に必要でない限り名前を修飾する</a></li>
<li><a href="#SS_3_6_5_3">ADL Firewallを使う</a></li>
</ul>
<p>のようにいくつか考えられる。これらについて以下で説明を行う。</p>
<h4
id="ジェネリックすぎるテンプレートを書かない">ジェネリックすぎるテンプレートを書かない
<a id="SS_3_6_5_1"></a></h4>
<p>ここでの「ジェネリックすぎるテンプレート」とは、
シンタックス的には適用範囲が広いにもかかわらず、セマンティクス的な適用範囲は限られているものを指す。
従って下記のような関数テンプレートを指す概念ではない。</p>
<div class="sourceCode" id="cb433"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb433-1"><a href="#cb433-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/suppress_adl_ut.cpp 108</span></span>
<span id="cb433-2"><a href="#cb433-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb433-3"><a href="#cb433-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">,</span> <span class="dt">size_t</span> N<span class="op">&gt;</span></span>
<span id="cb433-4"><a href="#cb433-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="kw">auto</span> array_length<span class="op">(</span>T <span class="at">const</span> <span class="op">(&amp;)[</span>N<span class="op">])</span> <span class="kw">noexcept</span></span>
<span id="cb433-5"><a href="#cb433-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb433-6"><a href="#cb433-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> N<span class="op">;</span></span>
<span id="cb433-7"><a href="#cb433-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>前記で問題を起こした関数テンプレート</p>
<div class="sourceCode" id="cb434"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb434-1"><a href="#cb434-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/suppress_adl_ut.cpp 20</span></span>
<span id="cb434-2"><a href="#cb434-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb434-3"><a href="#cb434-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// このような関数テンプレートは適用範囲が広すぎるので定義すべきではないが、</span></span>
<span id="cb434-4"><a href="#cb434-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 危険な例を示すためあえて定義している</span></span>
<span id="cb434-5"><a href="#cb434-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">,</span> <span class="kw">typename</span> U<span class="op">&gt;</span></span>
<span id="cb434-6"><a href="#cb434-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">inline</span> <span class="kw">auto</span> is_equal<span class="op">(</span>T <span class="at">const</span><span class="op">&amp;</span> lhs<span class="op">,</span> U <span class="at">const</span><span class="op">&amp;</span> rhs<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb434-7"><a href="#cb434-7" aria-hidden="true" tabindex="-1"></a>        <span class="op">-&gt;</span> <span class="kw">decltype</span><span class="op">(</span>lhs<span class="op">.</span>x <span class="op">==</span> rhs<span class="op">.</span>x<span class="op">,</span> lhs<span class="op">.</span>y <span class="op">==</span> rhs<span class="op">.</span>y<span class="op">)</span></span>
<span id="cb434-8"><a href="#cb434-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb434-9"><a href="#cb434-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> lhs<span class="op">.</span>x <span class="op">==</span> rhs<span class="op">.</span>x <span class="op">&amp;&amp;</span> lhs<span class="op">.</span>y <span class="op">==</span> rhs<span class="op">.</span>y<span class="op">;</span></span>
<span id="cb434-10"><a href="#cb434-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb434-11"><a href="#cb434-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace App</span></span></code></pre></div>
<p>が典型的な「ジェネリックすぎるテンプレート」である。
これに対する最も安全な対処は下記コードで示す通りテンプレートを使わないことである。</p>
<div class="sourceCode" id="cb435"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb435-1"><a href="#cb435-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/suppress_adl_ut.cpp 126</span></span>
<span id="cb435-2"><a href="#cb435-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb435-3"><a href="#cb435-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> App <span class="op">{</span></span>
<span id="cb435-4"><a href="#cb435-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb435-5"><a href="#cb435-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> XY <span class="op">{</span></span>
<span id="cb435-6"><a href="#cb435-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> x<span class="op">;</span></span>
<span id="cb435-7"><a href="#cb435-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> y<span class="op">;</span></span>
<span id="cb435-8"><a href="#cb435-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb435-9"><a href="#cb435-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb435-10"><a href="#cb435-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">inline</span> <span class="dt">bool</span> is_equal<span class="op">(</span>XY <span class="at">const</span><span class="op">&amp;</span> lhs<span class="op">,</span> XY <span class="at">const</span><span class="op">&amp;</span> rhs<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb435-11"><a href="#cb435-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb435-12"><a href="#cb435-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> lhs<span class="op">.</span>x <span class="op">==</span> rhs<span class="op">.</span>x <span class="op">&amp;&amp;</span> lhs<span class="op">.</span>y <span class="op">==</span> rhs<span class="op">.</span>y<span class="op">;</span></span>
<span id="cb435-13"><a href="#cb435-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb435-14"><a href="#cb435-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace App</span></span></code></pre></div>
<p>ジェネリックなis_equalが必要であれば下記単体テストのように <a
href="#SS_3_6_2">ジェネリックラムダ</a>を使えばよい。
こうすることでその適用範囲はそれを定義した関数内に留まる。</p>
<div class="sourceCode" id="cb436"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb436-1"><a href="#cb436-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/suppress_adl_ut.cpp 153</span></span>
<span id="cb436-2"><a href="#cb436-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb436-3"><a href="#cb436-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 下記のpointのようなクラスが他にもいくつかあった場合、</span></span>
<span id="cb436-4"><a href="#cb436-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// このジェネリックラムダでコードの被りは回避できる</span></span>
<span id="cb436-5"><a href="#cb436-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> is_equal <span class="op">=</span> <span class="op">[](</span><span class="kw">auto</span> <span class="at">const</span><span class="op">&amp;</span> lhs<span class="op">,</span> <span class="kw">auto</span> <span class="at">const</span><span class="op">&amp;</span> rhs<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span></span>
<span id="cb436-6"><a href="#cb436-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> lhs<span class="op">.</span>x <span class="op">==</span> rhs<span class="op">.</span>x <span class="op">&amp;&amp;</span> lhs<span class="op">.</span>y <span class="op">==</span> rhs<span class="op">.</span>y<span class="op">;</span></span>
<span id="cb436-7"><a href="#cb436-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb436-8"><a href="#cb436-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb436-9"><a href="#cb436-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> point <span class="op">{</span></span>
<span id="cb436-10"><a href="#cb436-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> x<span class="op">;</span></span>
<span id="cb436-11"><a href="#cb436-11" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> y<span class="op">;</span></span>
<span id="cb436-12"><a href="#cb436-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb436-13"><a href="#cb436-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> p0 <span class="op">=</span> point<span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">};</span></span>
<span id="cb436-14"><a href="#cb436-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb436-15"><a href="#cb436-15" aria-hidden="true" tabindex="-1"></a>    ASSERT_TRUE<span class="op">(</span>is_equal<span class="op">(</span>p0<span class="op">,</span> xy0<span class="op">));</span></span>
<span id="cb436-16"><a href="#cb436-16" aria-hidden="true" tabindex="-1"></a>    ASSERT_FALSE<span class="op">(</span>is_equal<span class="op">(</span>p0<span class="op">,</span> xy1<span class="op">));</span></span></code></pre></div>
<p>上記で示した</p>
<ul>
<li>テンプレートを使わない</li>
<li>適用範囲の広いテンプレート(ジェネリック)に対してはアクセスできる箇所を局所化する</li>
</ul>
<p>といった方法の他にも、「<a
href="#SS_3_4_4">コンテナ用Nstd::operator&lt;&lt;の開発</a>」で示した</p>
<ul>
<li>std::enable_if等を使用してテンプレートに適用できる型を制限する</li>
</ul>
<p>ことも考えられる。
ベストな方法は状況に大きく依存するため一概には決められない。
その状況でのもっとも単純は方法を選ぶべきだろう(が、何が単純かも一概に決めることは難しい)。</p>
<h4
id="adlが本当に必要でない限り名前を修飾する">ADLが本当に必要でない限り名前を修飾する
<a id="SS_3_6_5_2"></a></h4>
<p>下記のコードについて考える。</p>
<div class="sourceCode" id="cb437"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb437-1"><a href="#cb437-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/suppress_adl_ut.cpp 176</span></span>
<span id="cb437-2"><a href="#cb437-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb437-3"><a href="#cb437-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> A <span class="op">{</span></span>
<span id="cb437-4"><a href="#cb437-4" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> f<span class="op">(</span><span class="dt">int</span> i<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> i <span class="op">*</span> <span class="dv">3</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb437-5"><a href="#cb437-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb437-6"><a href="#cb437-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb437-7"><a href="#cb437-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> f<span class="op">(</span><span class="dt">int</span> i<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> i <span class="op">*</span> <span class="dv">2</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb437-8"><a href="#cb437-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb437-9"><a href="#cb437-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> App <span class="op">{</span></span>
<span id="cb437-10"><a href="#cb437-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb437-11"><a href="#cb437-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb437-12"><a href="#cb437-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> ExecF <span class="op">:</span> <span class="kw">public</span> T <span class="op">{</span></span>
<span id="cb437-13"><a href="#cb437-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb437-14"><a href="#cb437-14" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> <span class="kw">operator</span><span class="op">()(</span><span class="dt">int</span> i<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb437-15"><a href="#cb437-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb437-16"><a href="#cb437-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> f<span class="op">(</span>i<span class="op">);</span>  <span class="co">// T::fの呼び出しにも見えるが、::fの呼び出し</span></span>
<span id="cb437-17"><a href="#cb437-17" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb437-18"><a href="#cb437-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb437-19"><a href="#cb437-19" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Tを使ったコード</span></span>
<span id="cb437-20"><a href="#cb437-20" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb437-21"><a href="#cb437-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb437-22"><a href="#cb437-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace App</span></span></code></pre></div>
<p>基底クラスのメンバ関数を呼び出す場合は、T::f()、もしくは、this-&gt;f()と書く必要があるため、
下記コードで呼び出した関数fは外部関数fの呼び出しになる (<a
href="#SS_5_4_3">two phase name lookup</a>の一回目のname
lookupでfがバインドされるため)。</p>
<div class="sourceCode" id="cb438"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb438-1"><a href="#cb438-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/suppress_adl_ut.cpp 203</span></span>
<span id="cb438-2"><a href="#cb438-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb438-3"><a href="#cb438-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> ef <span class="op">=</span> App<span class="op">::</span>ExecF<span class="op">&lt;</span>A<span class="op">&gt;{};</span></span>
<span id="cb438-4"><a href="#cb438-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb438-5"><a href="#cb438-5" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">4</span><span class="op">,</span> ef<span class="op">(</span><span class="dv">2</span><span class="op">));</span>  <span class="co">// ::fの呼び出しなので、2 * 2 == 4となる</span></span></code></pre></div>
<p>これだけでも十分わかりづらいが、
ExecFのテンプレートパラメータにはクラスAしか使われないことがわかったので、
下記のようにリファクタリングしたとしよう。</p>
<div class="sourceCode" id="cb439"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb439-1"><a href="#cb439-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/suppress_adl_ut.cpp 213</span></span>
<span id="cb439-2"><a href="#cb439-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb439-3"><a href="#cb439-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> A <span class="op">{</span></span>
<span id="cb439-4"><a href="#cb439-4" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> f<span class="op">(</span><span class="dt">int</span> i<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> i <span class="op">*</span> <span class="dv">3</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb439-5"><a href="#cb439-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb439-6"><a href="#cb439-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb439-7"><a href="#cb439-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> f<span class="op">(</span><span class="dt">int</span> i<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> i <span class="op">*</span> <span class="dv">2</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb439-8"><a href="#cb439-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb439-9"><a href="#cb439-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> App <span class="op">{</span></span>
<span id="cb439-10"><a href="#cb439-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb439-11"><a href="#cb439-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> ExecF <span class="op">:</span> <span class="kw">public</span> A <span class="op">{</span></span>
<span id="cb439-12"><a href="#cb439-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb439-13"><a href="#cb439-13" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> <span class="kw">operator</span><span class="op">()(</span><span class="dt">int</span> i<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> f<span class="op">(</span>i<span class="op">);</span> <span class="op">}</span></span>
<span id="cb439-14"><a href="#cb439-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb439-15"><a href="#cb439-15" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Tを使ったコード</span></span>
<span id="cb439-16"><a href="#cb439-16" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb439-17"><a href="#cb439-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb439-18"><a href="#cb439-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace App</span></span></code></pre></div>
<p>すると、fのname
lookupの対象が変わってしまい、元の単体テストはパスしなくなる。</p>
<div class="sourceCode" id="cb440"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb440-1"><a href="#cb440-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/suppress_adl_ut.cpp 236</span></span>
<span id="cb440-2"><a href="#cb440-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb440-3"><a href="#cb440-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> ef <span class="op">=</span> App<span class="op">::</span>ExecF<span class="op">{};</span></span>
<span id="cb440-4"><a href="#cb440-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb440-5"><a href="#cb440-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ASSERT_EQ(4, ef(2));</span></span>
<span id="cb440-6"><a href="#cb440-6" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">6</span><span class="op">,</span> ef<span class="op">(</span><span class="dv">2</span><span class="op">));</span>  <span class="co">// リファクタリングでname lookupの対象が変わり、A::fが呼ばれる</span></span></code></pre></div>
<p>こういった場合に備え単体テストを実行すべきなのだが、この程度の問題はコンパイルで検出したい。
<a href="#SS_5_4_5">ADL</a>や<a href="#SS_5_4_3">two phase name
lookup</a>が絡む場合ならなおさらである。</p>
<p>こういう意図しない<a href="#SS_5_4_2">name
lookup</a>に備えるためには、
修飾されていない識別子を使わないこと、つまり、
識別子には、名前空間、クラス名、this-&gt;等による修飾を施すことが重要である。</p>
<p>ただし、「<a
href="#SS_3_4_4">コンテナ用Nstd::operator&lt;&lt;の開発</a>」で示したコード等にはADLが欠かせないため、
修飾することをルール化することはできない。場合に合わせた運用が唯一の解となる。</p>
<h4 id="adl-firewallを使う">ADL Firewallを使う
<a id="SS_3_6_5_3"></a></h4>
<p>下記のコードについて考える。</p>
<div class="sourceCode" id="cb441"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb441-1"><a href="#cb441-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/adl_firewall_0_ut.cpp 10</span></span>
<span id="cb441-2"><a href="#cb441-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb441-3"><a href="#cb441-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> App <span class="op">{</span></span>
<span id="cb441-4"><a href="#cb441-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb441-5"><a href="#cb441-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb441-6"><a href="#cb441-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>string<span class="op"> </span>ToString<span class="op">(</span><span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;</span> <span class="at">const</span><span class="op">&amp;</span> t<span class="op">)</span></span>
<span id="cb441-7"><a href="#cb441-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb441-8"><a href="#cb441-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> oss <span class="op">=</span> <span class="bu">std::</span>ostringstream<span class="op">{};</span></span>
<span id="cb441-9"><a href="#cb441-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb441-10"><a href="#cb441-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> Nstd<span class="op">::</span><span class="kw">operator</span><span class="op">&lt;&lt;;</span></span>
<span id="cb441-11"><a href="#cb441-11" aria-hidden="true" tabindex="-1"></a>        oss <span class="op">&lt;&lt;</span> t<span class="op">;</span>  <span class="co">// Nstd::operator&lt;&lt;もname lookupの対象に含める</span></span>
<span id="cb441-12"><a href="#cb441-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb441-13"><a href="#cb441-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> oss<span class="op">.</span>str<span class="op">();</span></span>
<span id="cb441-14"><a href="#cb441-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb441-15"><a href="#cb441-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace App</span></span>
<span id="cb441-16"><a href="#cb441-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb441-17"><a href="#cb441-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span></span>
<span id="cb441-18"><a href="#cb441-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb441-19"><a href="#cb441-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> App <span class="op">{</span></span>
<span id="cb441-20"><a href="#cb441-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> XY <span class="op">{</span></span>
<span id="cb441-21"><a href="#cb441-21" aria-hidden="true" tabindex="-1"></a>        XY<span class="op">(</span><span class="dt">int</span> ax<span class="op">,</span> <span class="dt">int</span> ay<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">:</span> x<span class="op">{</span>ax<span class="op">},</span> y<span class="op">{</span>ay<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb441-22"><a href="#cb441-22" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> x<span class="op">;</span></span>
<span id="cb441-23"><a href="#cb441-23" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> y<span class="op">;</span></span>
<span id="cb441-24"><a href="#cb441-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb441-25"><a href="#cb441-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb441-26"><a href="#cb441-26" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>ostream<span class="op">&amp;</span> <span class="kw">operator</span><span class="op">&lt;&lt;(</span><span class="bu">std::</span>ostream<span class="op">&amp;</span> os<span class="op">,</span> XY <span class="at">const</span><span class="op">&amp;</span> xyz<span class="op">)</span></span>
<span id="cb441-27"><a href="#cb441-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb441-28"><a href="#cb441-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> os <span class="op">&lt;&lt;</span> <span class="bu">std::</span>to_string<span class="op">(</span>xyz<span class="op">.</span>x<span class="op">)</span> <span class="op">+</span> <span class="st">&quot;/&quot;</span> <span class="op">+</span> <span class="bu">std::</span>to_string<span class="op">(</span>xyz<span class="op">.</span>y<span class="op">);</span></span>
<span id="cb441-29"><a href="#cb441-29" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb441-30"><a href="#cb441-30" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace App</span></span></code></pre></div>
<p>上記のApp::ToStringは「<a
href="#SS_3_4_4">コンテナ用Nstd::operator&lt;&lt;の開発</a>」のコードを使用し、
std::vectorオブジェクトをstd::stringに変換する。</p>
<p>これに対しての単体テストは下記のようになる。</p>
<div class="sourceCode" id="cb442"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb442-1"><a href="#cb442-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/adl_firewall_0_ut.cpp 47</span></span>
<span id="cb442-2"><a href="#cb442-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb442-3"><a href="#cb442-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> xys <span class="op">=</span> <span class="bu">std::</span>vector<span class="op">&lt;</span>App<span class="op">::</span>XY<span class="op">&gt;{{</span><span class="dv">9</span><span class="op">,</span> <span class="dv">8</span><span class="op">},</span> <span class="op">{</span><span class="dv">7</span><span class="op">,</span> <span class="dv">6</span><span class="op">}};</span></span>
<span id="cb442-4"><a href="#cb442-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb442-5"><a href="#cb442-5" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;9/8, 7/6&quot;</span><span class="op">,</span> App<span class="op">::</span>ToString<span class="op">(</span>xys<span class="op">));</span></span></code></pre></div>
<p>これは想定通りの動作だが、上記のAppの後に下記のコードを追加するとApp::ToStringは影響を受ける。</p>
<div class="sourceCode" id="cb443"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb443-1"><a href="#cb443-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/adl_firewall_1_ut.cpp 40</span></span>
<span id="cb443-2"><a href="#cb443-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb443-3"><a href="#cb443-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Appに下記を追加</span></span>
<span id="cb443-4"><a href="#cb443-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> App <span class="op">{</span></span>
<span id="cb443-5"><a href="#cb443-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb443-6"><a href="#cb443-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>ostream<span class="op">&amp;</span> <span class="kw">operator</span><span class="op">&lt;&lt;(</span><span class="bu">std::</span>ostream<span class="op">&amp;</span> os<span class="op">,</span> <span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;</span> <span class="at">const</span><span class="op">&amp;</span> t<span class="op">)</span></span>
<span id="cb443-7"><a href="#cb443-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb443-8"><a href="#cb443-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> os <span class="op">&lt;&lt;</span> <span class="st">&quot;size:&quot;</span> <span class="op">&lt;&lt;</span> t<span class="op">.</span>size<span class="op">();</span></span>
<span id="cb443-9"><a href="#cb443-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb443-10"><a href="#cb443-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace App</span></span></code></pre></div>
<p>これにより元の単体テストはエラーとなり、新しい単体テストは下記のようになる。</p>
<div class="sourceCode" id="cb444"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb444-1"><a href="#cb444-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/adl_firewall_1_ut.cpp 56</span></span>
<span id="cb444-2"><a href="#cb444-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb444-3"><a href="#cb444-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> xys <span class="op">=</span> <span class="bu">std::</span>vector<span class="op">&lt;</span>App<span class="op">::</span>XY<span class="op">&gt;{{</span><span class="dv">9</span><span class="op">,</span> <span class="dv">8</span><span class="op">},</span> <span class="op">{</span><span class="dv">7</span><span class="op">,</span> <span class="dv">6</span><span class="op">}};</span></span>
<span id="cb444-4"><a href="#cb444-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb444-5"><a href="#cb444-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// App::operator&lt;&lt;の追加で、App::ToStringの出力が影響を受ける</span></span>
<span id="cb444-6"><a href="#cb444-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ASSERT_EQ(&quot;9/8, 7/6&quot;, App::ToString(xys));</span></span>
<span id="cb444-7"><a href="#cb444-7" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;size:2&quot;</span><span class="op">,</span> App<span class="op">::</span>ToString<span class="op">(</span>xys<span class="op">));</span></span></code></pre></div>
<p>これが意図通りなら問題ないが、
ここでは「新たに追加した関数テンプレートApp::operator&lt;&lt;はstd::vector&lt;App::XY&gt;用ではなかった」
としよう。その場合、これは意図しないADLによるバグの混入となる。 「<a
href="#SS_3_6_5_1">ジェネリックすぎるテンプレートを書かない</a>」
で述べたように追加した関数テンプレートの適用範囲が広すぎることが原因であるが、
XY型から生成されたオブジェクト(std::vector&lt;App::XY&gt;も含む)によるADLのため、
Appの宣言がname lookupの対象になったことにも原因がある。</p>
<p>下記のコードは後者の原因を解消する。</p>
<div class="sourceCode" id="cb445"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb445-1"><a href="#cb445-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/adl_firewall_2_ut.cpp 23</span></span>
<span id="cb445-2"><a href="#cb445-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb445-3"><a href="#cb445-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Appの中の新たな名前空間XY_Firewall_でstruct XYとoperator&lt;&lt;を宣言</span></span>
<span id="cb445-4"><a href="#cb445-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> App <span class="op">{</span></span>
<span id="cb445-5"><a href="#cb445-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> XY_Firewall_ <span class="op">{</span></span>
<span id="cb445-6"><a href="#cb445-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb445-7"><a href="#cb445-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> XY <span class="op">{</span></span>
<span id="cb445-8"><a href="#cb445-8" aria-hidden="true" tabindex="-1"></a>        XY<span class="op">(</span><span class="dt">int</span> ax<span class="op">,</span> <span class="dt">int</span> ay<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">:</span> x<span class="op">{</span>ax<span class="op">},</span> y<span class="op">{</span>ay<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb445-9"><a href="#cb445-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> x<span class="op">;</span></span>
<span id="cb445-10"><a href="#cb445-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> y<span class="op">;</span></span>
<span id="cb445-11"><a href="#cb445-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb445-12"><a href="#cb445-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb445-13"><a href="#cb445-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>ostream<span class="op">&amp;</span> <span class="kw">operator</span><span class="op">&lt;&lt;(</span><span class="bu">std::</span>ostream<span class="op">&amp;</span> os<span class="op">,</span> XY <span class="at">const</span><span class="op">&amp;</span> xyz<span class="op">)</span></span>
<span id="cb445-14"><a href="#cb445-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb445-15"><a href="#cb445-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> os <span class="op">&lt;&lt;</span> <span class="bu">std::</span>to_string<span class="op">(</span>xyz<span class="op">.</span>x<span class="op">)</span> <span class="op">+</span> <span class="st">&quot;/&quot;</span> <span class="op">+</span> <span class="bu">std::</span>to_string<span class="op">(</span>xyz<span class="op">.</span>y<span class="op">);</span></span>
<span id="cb445-16"><a href="#cb445-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb445-17"><a href="#cb445-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace XY_Firewall_</span></span>
<span id="cb445-18"><a href="#cb445-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb445-19"><a href="#cb445-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> XY <span class="op">=</span> XY_Firewall_<span class="op">::</span>XY<span class="op">;</span></span>
<span id="cb445-20"><a href="#cb445-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb445-21"><a href="#cb445-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace App</span></span></code></pre></div>
<p>XY型オブジェクトを引数にした関数呼び出しによる<a
href="#SS_5_4_6">関連名前空間</a>は、
極小なApp::XY_Firewall_であるため、意図しないADLは起こりづらく、起こっても発見しやすい。
また、XY型用operator&lt;&lt;もApp::XY_Firewall_で定義し、 App内でusing
XYを宣言したことで、これまで通りApp::XYが使える。</p>
<p>このようなテクニックをADL firewallと呼ぶ。</p>
<h3 id="nstdtype2strの開発">Nstd::Type2Strの開発
<a id="SS_3_6_6"></a></h3>
<p>「<a
href="#SS_3_2">Nstdライブラリの開発</a>」等で行ったメタ関数の実装は、</p>
<ul>
<li>入り組んだ&lt;&gt;や()の対応漏れ</li>
<li>&amp;や&amp;&amp;のつけ忘れ</li>
<li>typenameやtemplateキーワードの漏れ</li>
<li>メタ関数メンバー::valueや::typeの漏れ</li>
</ul>
<p>等によるコンパイルエラーとの戦いである。 また、これをクリアしても<a
href="#SS_5_4_3">two phase name lookup</a>や<a
href="#SS_5_4_5">ADL</a>が次の関門になる。
これには、デバッガのステップ実行が強力な武器となるが、
型を文字列に変換する関数があればこれもまた強力な武器となる。</p>
<p>以下に示すNstd::Type2Strは、「<a
href="#SS_3_2">Nstdライブラリの開発</a>」等で実際に使用したそのような関数である。</p>
<div class="sourceCode" id="cb446"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb446-1"><a href="#cb446-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ h/nstd_type2str.h 9</span></span>
<span id="cb446-2"><a href="#cb446-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb446-3"><a href="#cb446-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> Nstd <span class="op">{</span></span>
<span id="cb446-4"><a href="#cb446-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> Inner_ <span class="op">{</span></span>
<span id="cb446-5"><a href="#cb446-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb446-6"><a href="#cb446-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">inline</span> <span class="bu">std::</span>string<span class="op"> </span>demangle<span class="op">(</span><span class="dt">char</span> <span class="at">const</span><span class="op">*</span> to_demagle<span class="op">)</span></span>
<span id="cb446-7"><a href="#cb446-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb446-8"><a href="#cb446-8" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> status<span class="op">;</span></span>
<span id="cb446-9"><a href="#cb446-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb446-10"><a href="#cb446-10" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span><span class="dt">char</span><span class="op">,</span> <span class="kw">decltype</span><span class="op">(&amp;</span><span class="bu">std::</span>free<span class="op">)&gt;</span> demangled<span class="op">{</span></span>
<span id="cb446-11"><a href="#cb446-11" aria-hidden="true" tabindex="-1"></a>            abi<span class="op">::</span>__cxa_demangle<span class="op">(</span>to_demagle<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="op">&amp;</span>status<span class="op">),</span> <span class="op">&amp;</span><span class="bu">std::</span>free<span class="op">};</span></span>
<span id="cb446-12"><a href="#cb446-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb446-13"><a href="#cb446-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> demangled<span class="op">.</span>get<span class="op">();</span></span>
<span id="cb446-14"><a href="#cb446-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb446-15"><a href="#cb446-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb446-16"><a href="#cb446-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span><span class="op">&gt;</span>  <span class="co">// typenameを取り出すためだけのクラステンプレート</span></span>
<span id="cb446-17"><a href="#cb446-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> type_capture <span class="op">{</span></span>
<span id="cb446-18"><a href="#cb446-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb446-19"><a href="#cb446-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace Inner_</span></span>
<span id="cb446-20"><a href="#cb446-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb446-21"><a href="#cb446-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb446-22"><a href="#cb446-22" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>string<span class="op"> </span>Type2Str<span class="op">()</span></span>
<span id="cb446-23"><a href="#cb446-23" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb446-24"><a href="#cb446-24" aria-hidden="true" tabindex="-1"></a>        <span class="co">// typeid(T)とした場合、const/volatile/&amp;の情報が捨てられるため、</span></span>
<span id="cb446-25"><a href="#cb446-25" aria-hidden="true" tabindex="-1"></a>        <span class="co">// typeid(type_capture&lt;T&gt;)とし、それを防ぐ。</span></span>
<span id="cb446-26"><a href="#cb446-26" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> str <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{</span>Inner_<span class="op">::</span>demangle<span class="op">(</span><span class="kw">typeid</span><span class="op">(</span>Inner_<span class="op">::</span>type_capture<span class="op">&lt;</span>T<span class="op">&gt;).</span>name<span class="op">())};</span></span>
<span id="cb446-27"><a href="#cb446-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb446-28"><a href="#cb446-28" aria-hidden="true" tabindex="-1"></a>        <span class="co">// T   == const int ならば、</span></span>
<span id="cb446-29"><a href="#cb446-29" aria-hidden="true" tabindex="-1"></a>        <span class="co">// str == Nstd::Inner_::type_capture&lt;int const&gt;</span></span>
<span id="cb446-30"><a href="#cb446-30" aria-hidden="true" tabindex="-1"></a>        <span class="co">//        &lt;----------- 27 ----------&gt;&lt;-- x --&gt; 下記ではxを切り出す</span></span>
<span id="cb446-31"><a href="#cb446-31" aria-hidden="true" tabindex="-1"></a>        <span class="kw">constexpr</span> <span class="kw">auto</span> beg <span class="op">=</span> <span class="dv">27</span><span class="bu">U</span><span class="op">;</span>                           <span class="co">// 先頭の不要な文字列数</span></span>
<span id="cb446-32"><a href="#cb446-32" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> name <span class="op">=</span> str<span class="op">.</span>substr<span class="op">(</span>beg<span class="op">,</span> str<span class="op">.</span>size<span class="op">()</span> <span class="op">-</span> beg <span class="op">-</span> <span class="dv">1</span><span class="op">);</span>  <span class="co">// 最後の文字は&gt;なので不要</span></span>
<span id="cb446-33"><a href="#cb446-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb446-34"><a href="#cb446-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="op">(</span>name<span class="op">.</span>back<span class="op">()</span> <span class="op">==</span> <span class="ch">&#39; &#39;</span><span class="op">)</span> <span class="op">{</span>  <span class="co">// 無駄なスペースを消す</span></span>
<span id="cb446-35"><a href="#cb446-35" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> last <span class="op">=</span> <span class="op">--</span>name<span class="op">.</span>end<span class="op">();</span></span>
<span id="cb446-36"><a href="#cb446-36" aria-hidden="true" tabindex="-1"></a>            name<span class="op">.</span>erase<span class="op">(</span>last<span class="op">);</span></span>
<span id="cb446-37"><a href="#cb446-37" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb446-38"><a href="#cb446-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb446-39"><a href="#cb446-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> name<span class="op">;</span></span>
<span id="cb446-40"><a href="#cb446-40" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb446-41"><a href="#cb446-41" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace Nstd</span></span></code></pre></div>
<p>typeid::name()が返す文字列リテラルは引数の型の文字列表現を持つが、
マングリングされているためヒューマンリーダブルではない。
それをデマングルするのがabi::__cxa_demangleであるが、
残念なことにこの関数は非標準であるため、
それを使っているNstd::Inner_::demangleは<a href="#SS_5_9_1">g++</a>/<a
href="#SS_5_9_2">clang++</a> でなければコンパイルできないだろう。</p>
<p>それを除けば、
複雑なシンタックスを持つ型を文字列で表現できるNstd::Type2Strは、
テンプレートプログラミングおける有効なデバッグツールであると言える。</p>
<p>下記単体テストは、そのことを示している。</p>
<div class="sourceCode" id="cb447"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb447-1"><a href="#cb447-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_type2str_ut.cpp 11</span></span>
<span id="cb447-2"><a href="#cb447-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb447-3"><a href="#cb447-3" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;int const&quot;</span><span class="op">,</span> Nstd<span class="op">::</span>Type2Str<span class="op">&lt;</span><span class="dt">int</span> <span class="at">const</span><span class="op">&gt;());</span></span>
<span id="cb447-4"><a href="#cb447-4" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;std::string&quot;</span><span class="op">,</span> Nstd<span class="op">::</span>Type2Str<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;());</span></span>
<span id="cb447-5"><a href="#cb447-5" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;std::vector&lt;int, std::allocator&lt;int&gt; &gt;&quot;</span><span class="op">,</span> Nstd<span class="op">::</span>Type2Str<span class="op">&lt;</span><span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;&gt;());</span></span>
<span id="cb447-6"><a href="#cb447-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb447-7"><a href="#cb447-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">extern</span> <span class="dt">void</span> f<span class="op">(</span><span class="dt">int</span><span class="op">);</span></span>
<span id="cb447-8"><a href="#cb447-8" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;void (int)&quot;</span><span class="op">,</span> Nstd<span class="op">::</span>Type2Str<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span>f<span class="op">)&gt;());</span>  <span class="co">// 関数の型</span></span>
<span id="cb447-9"><a href="#cb447-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb447-10"><a href="#cb447-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> lamda <span class="op">=</span> <span class="op">[]()</span> <span class="kw">noexcept</span> <span class="op">{};</span></span>
<span id="cb447-11"><a href="#cb447-11" aria-hidden="true" tabindex="-1"></a>    ASSERT_NE<span class="op">(</span><span class="st">&quot;&quot;</span><span class="op">,</span> Nstd<span class="op">::</span>Type2Str<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span>lamda<span class="op">)&gt;());</span>  <span class="co">// XXX::{lambda()#1}な感じになる</span></span>
<span id="cb447-12"><a href="#cb447-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb447-13"><a href="#cb447-13" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;std::ostream&amp; (std::ostream&amp;, int const (&amp;) [3])&quot;</span><span class="op">,</span></span>
<span id="cb447-14"><a href="#cb447-14" aria-hidden="true" tabindex="-1"></a>              Nstd<span class="op">::</span>Type2Str<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span>Nstd<span class="op">::</span><span class="kw">operator</span><span class="op">&lt;&lt;</span> <span class="op">&lt;</span><span class="dt">int</span><span class="op">[</span><span class="dv">3</span><span class="op">]&gt;)&gt;());</span></span>
<span id="cb447-15"><a href="#cb447-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb447-16"><a href="#cb447-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">// std::declvalはrvalueリファレンスを返す</span></span>
<span id="cb447-17"><a href="#cb447-17" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;int (&amp;&amp;) [3]&quot;</span><span class="op">,</span> Nstd<span class="op">::</span>Type2Str<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span><span class="bu">std::</span>declval<span class="op">&lt;</span><span class="dt">int</span><span class="op">[</span><span class="dv">3</span><span class="op">]&gt;())&gt;());</span></span>
<span id="cb447-18"><a href="#cb447-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb447-19"><a href="#cb447-19" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i3<span class="op">[</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb447-20"><a href="#cb447-20" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;int [3]&quot;</span><span class="op">,</span> Nstd<span class="op">::</span>Type2Str<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span>i3<span class="op">)&gt;());</span></span>
<span id="cb447-21"><a href="#cb447-21" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;int (&amp;) [3]&quot;</span><span class="op">,</span> Nstd<span class="op">::</span>Type2Str<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">((</span>i3<span class="op">))&gt;());</span>  <span class="co">// (i3)はlvalueリファレンス</span></span>
<span id="cb447-22"><a href="#cb447-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb447-23"><a href="#cb447-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span><span class="op">&amp;</span> r <span class="op">=</span> i3<span class="op">;</span></span>
<span id="cb447-24"><a href="#cb447-24" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;int (&amp;) [3]&quot;</span><span class="op">,</span> Nstd<span class="op">::</span>Type2Str<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span>r<span class="op">)&gt;());</span></span></code></pre></div>
<h3 id="静的な文字列オブジェクト">静的な文字列オブジェクト
<a id="SS_3_6_7"></a></h3>
<p>std::stringは文字列を扱うことにおいて、非常に有益なクラスではあるが、
コンパイル時に文字列が決定できる場合でも、動的にメモリを確保する。</p>
<p>この振る舞いは、</p>
<ul>
<li>ランタイム時にnew/deleteを行うため、処理の遅さにつながる。</li>
<li>下記のようにエクセプションオブジェクトにファイル位置を埋め込むことは、
デバッグに便利であるが、メモリ確保失敗を通知するような場面ではこの方法は使えない。</li>
</ul>
<div class="sourceCode" id="cb448"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb448-1"><a href="#cb448-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_exception_ut.cpp 6</span></span>
<span id="cb448-2"><a href="#cb448-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb448-3"><a href="#cb448-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Exception <span class="op">:</span> <span class="bu">std::</span>exception<span class="op"> {</span></span>
<span id="cb448-4"><a href="#cb448-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb448-5"><a href="#cb448-5" aria-hidden="true" tabindex="-1"></a>        Exception<span class="op">(</span><span class="dt">char</span> <span class="at">const</span><span class="op">*</span> filename<span class="op">,</span> <span class="dt">uint32_t</span> line_num<span class="op">,</span> <span class="dt">char</span> <span class="at">const</span><span class="op">*</span> msg<span class="op">)</span></span>
<span id="cb448-6"><a href="#cb448-6" aria-hidden="true" tabindex="-1"></a>            <span class="op">:</span> <span class="va">what_str_</span><span class="op">{</span><span class="bu">std::</span>string<span class="op">{</span>filename<span class="op">}</span> <span class="op">+</span> <span class="st">&quot;:&quot;</span> <span class="op">+</span> <span class="bu">std::</span>to_string<span class="op">(</span>line_num<span class="op">)</span> <span class="op">+</span> <span class="st">&quot;:&quot;</span> <span class="op">+</span> msg<span class="op">}</span></span>
<span id="cb448-7"><a href="#cb448-7" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb448-8"><a href="#cb448-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb448-9"><a href="#cb448-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb448-10"><a href="#cb448-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">char</span> <span class="at">const</span><span class="op">*</span> what<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="kw">override</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">what_str_</span><span class="op">.</span>c_str<span class="op">();</span> <span class="op">}</span></span>
<span id="cb448-11"><a href="#cb448-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb448-12"><a href="#cb448-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb448-13"><a href="#cb448-13" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span><span class="va">what_str_</span><span class="op">;</span></span>
<span id="cb448-14"><a href="#cb448-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb448-15"><a href="#cb448-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb448-16"><a href="#cb448-16" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int32_t</span> div<span class="op">(</span><span class="dt">int32_t</span> a<span class="op">,</span> <span class="dt">int32_t</span> b<span class="op">)</span></span>
<span id="cb448-17"><a href="#cb448-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb448-18"><a href="#cb448-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>b <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb448-19"><a href="#cb448-19" aria-hidden="true" tabindex="-1"></a>            <span class="cf">throw</span> Exception<span class="op">{</span><span class="ot">__FILE__</span><span class="op">,</span> <span class="ot">__LINE__</span><span class="op">,</span> <span class="st">&quot;divided by 0&quot;</span><span class="op">};</span>  <span class="co">// 24行目</span></span>
<span id="cb448-20"><a href="#cb448-20" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb448-21"><a href="#cb448-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb448-22"><a href="#cb448-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> a <span class="op">/</span> b<span class="op">;</span></span>
<span id="cb448-23"><a href="#cb448-23" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb449"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb449-1"><a href="#cb449-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_exception_ut.cpp 34</span></span>
<span id="cb449-2"><a href="#cb449-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb449-3"><a href="#cb449-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> caught <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb449-4"><a href="#cb449-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span> <span class="op">{</span></span>
<span id="cb449-5"><a href="#cb449-5" aria-hidden="true" tabindex="-1"></a>        div<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb449-6"><a href="#cb449-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb449-7"><a href="#cb449-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">catch</span> <span class="op">(</span>Exception <span class="at">const</span><span class="op">&amp;</span> e<span class="op">)</span> <span class="op">{</span></span>
<span id="cb449-8"><a href="#cb449-8" aria-hidden="true" tabindex="-1"></a>        ASSERT_STREQ<span class="op">(</span><span class="st">&quot;nstd_exception_ut.cpp:24:divided by 0&quot;</span><span class="op">,</span> e<span class="op">.</span>what<span class="op">());</span></span>
<span id="cb449-9"><a href="#cb449-9" aria-hidden="true" tabindex="-1"></a>        caught <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb449-10"><a href="#cb449-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb449-11"><a href="#cb449-11" aria-hidden="true" tabindex="-1"></a>    ASSERT_TRUE<span class="op">(</span>caught<span class="op">);</span></span></code></pre></div>
<p>このような問題を回避するために、ここでは静的に文字列を扱うためのクラスStaticStringを開発する。</p>
<h4
id="staticstringのヘルパークラスの開発">StaticStringのヘルパークラスの開発
<a id="SS_3_6_7_1"></a></h4>
<p>StaticStringオブジェクトは、char配列をメンバとして持つが、
コンパイル時に解決できる配列の初期化にはパラメータパックが利用できる。
そのパラメータパック生成クラスを下記のように定義する。</p>
<div class="sourceCode" id="cb450"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb450-1"><a href="#cb450-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_seq.h 4</span></span>
<span id="cb450-2"><a href="#cb450-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb450-3"><a href="#cb450-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// パラメータパック展開ヘルパクラス</span></span>
<span id="cb450-4"><a href="#cb450-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="dt">size_t</span><span class="op">...</span> Ns<span class="op">&gt;</span></span>
<span id="cb450-5"><a href="#cb450-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> index_sequence <span class="op">{</span></span>
<span id="cb450-6"><a href="#cb450-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb450-7"><a href="#cb450-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb450-8"><a href="#cb450-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">// index_sequence&lt;0, 1, 2, ...&gt;を作るためのクラステンプレート</span></span>
<span id="cb450-9"><a href="#cb450-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">// make_index_sequence&lt;3&gt;</span></span>
<span id="cb450-10"><a href="#cb450-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">// -&gt; make_index_sequence&lt;2, 2&gt;</span></span>
<span id="cb450-11"><a href="#cb450-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">// -&gt; make_index_sequence&lt;1, 1, 2&gt;</span></span>
<span id="cb450-12"><a href="#cb450-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">// -&gt; make_index_sequence&lt;0, 0, 1, 2&gt;</span></span>
<span id="cb450-13"><a href="#cb450-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">// -&gt; index_sequence&lt;0, 1, 2&gt;</span></span>
<span id="cb450-14"><a href="#cb450-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="dt">size_t</span> N<span class="op">,</span> <span class="dt">size_t</span><span class="op">...</span> Ns<span class="op">&gt;</span></span>
<span id="cb450-15"><a href="#cb450-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> make_index_sequence <span class="op">:</span> make_index_sequence<span class="op">&lt;</span>N <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> N <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> Ns<span class="op">...&gt;</span> <span class="op">{</span></span>
<span id="cb450-16"><a href="#cb450-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb450-17"><a href="#cb450-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb450-18"><a href="#cb450-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="dt">size_t</span><span class="op">...</span> Ns<span class="op">&gt;</span></span>
<span id="cb450-19"><a href="#cb450-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> make_index_sequence<span class="op">&lt;</span><span class="dv">0</span><span class="op">,</span> Ns<span class="op">...&gt;</span> <span class="op">:</span> index_sequence<span class="op">&lt;</span>Ns<span class="op">...&gt;</span> <span class="op">{</span></span>
<span id="cb450-20"><a href="#cb450-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>このクラスにより、下記のような配列メンバの初期ができるようになる。</p>
<div class="sourceCode" id="cb451"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb451-1"><a href="#cb451-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_seq_ut.cpp 7</span></span>
<span id="cb451-2"><a href="#cb451-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb451-3"><a href="#cb451-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="dt">size_t</span> N<span class="op">&gt;</span></span>
<span id="cb451-4"><a href="#cb451-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> seq_test <span class="op">{</span></span>
<span id="cb451-5"><a href="#cb451-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">template</span> <span class="op">&lt;</span><span class="dt">size_t</span><span class="op">...</span> S<span class="op">&gt;</span></span>
<span id="cb451-6"><a href="#cb451-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">constexpr</span> seq_test<span class="op">(</span>index_sequence<span class="op">&lt;</span>S<span class="op">...&gt;)</span> <span class="kw">noexcept</span> <span class="op">:</span> data<span class="op">{</span>S<span class="op">...}</span></span>
<span id="cb451-7"><a href="#cb451-7" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb451-8"><a href="#cb451-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb451-9"><a href="#cb451-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> <span class="at">const</span> data<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb451-10"><a href="#cb451-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb452"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb452-1"><a href="#cb452-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_seq_ut.cpp 24</span></span>
<span id="cb452-2"><a href="#cb452-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb452-3"><a href="#cb452-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="kw">auto</span> st <span class="op">=</span> seq_test<span class="op">&lt;</span><span class="dv">3</span><span class="op">&gt;{</span>index_sequence<span class="op">&lt;</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">&gt;()};</span></span>
<span id="cb452-4"><a href="#cb452-4" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">1</span><span class="op">,</span> st<span class="op">.</span>data<span class="op">[</span><span class="dv">0</span><span class="op">]);</span></span>
<span id="cb452-5"><a href="#cb452-5" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">2</span><span class="op">,</span> st<span class="op">.</span>data<span class="op">[</span><span class="dv">1</span><span class="op">]);</span></span>
<span id="cb452-6"><a href="#cb452-6" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">3</span><span class="op">,</span> st<span class="op">.</span>data<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span></code></pre></div>
<p>これを下記のように使うことで、メンバである文字列配列のコンパイル時初期化ができるようになる。</p>
<div class="sourceCode" id="cb453"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb453-1"><a href="#cb453-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_seq_ut.cpp 33</span></span>
<span id="cb453-2"><a href="#cb453-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb453-3"><a href="#cb453-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="dt">size_t</span> N<span class="op">&gt;</span></span>
<span id="cb453-4"><a href="#cb453-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> seq_test2 <span class="op">{</span></span>
<span id="cb453-5"><a href="#cb453-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb453-6"><a href="#cb453-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">template</span> <span class="op">&lt;</span><span class="dt">size_t</span><span class="op">...</span> S<span class="op">&gt;</span></span>
<span id="cb453-7"><a href="#cb453-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">constexpr</span> seq_test2<span class="op">(</span><span class="dt">char</span> <span class="at">const</span> <span class="op">(&amp;</span>str<span class="op">)[</span>N<span class="op">],</span> index_sequence<span class="op">&lt;</span>S<span class="op">...&gt;)</span> <span class="kw">noexcept</span> <span class="op">:</span> <span class="va">string_</span><span class="op">{</span>str<span class="op">[</span>S<span class="op">]...}</span></span>
<span id="cb453-8"><a href="#cb453-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb453-9"><a href="#cb453-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb453-10"><a href="#cb453-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb453-11"><a href="#cb453-11" aria-hidden="true" tabindex="-1"></a>        <span class="kw">constexpr</span> <span class="dt">char</span> <span class="at">const</span> <span class="op">(&amp;</span>String<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span><span class="op">)[</span>N<span class="op">]</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">string_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb453-12"><a href="#cb453-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb453-13"><a href="#cb453-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb453-14"><a href="#cb453-14" aria-hidden="true" tabindex="-1"></a>        <span class="dt">char</span> <span class="at">const</span> <span class="va">string_</span><span class="op">[</span>N<span class="op">];</span></span>
<span id="cb453-15"><a href="#cb453-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb454"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb454-1"><a href="#cb454-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_seq_ut.cpp 52</span></span>
<span id="cb454-2"><a href="#cb454-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb454-3"><a href="#cb454-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">char</span> <span class="at">const</span> str<span class="op">[]{</span><span class="st">&quot;123&quot;</span><span class="op">};</span></span>
<span id="cb454-4"><a href="#cb454-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb454-5"><a href="#cb454-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="kw">auto</span> st <span class="op">=</span> seq_test2<span class="op">&lt;</span><span class="dv">4</span><span class="op">&gt;{</span>str<span class="op">,</span> index_sequence<span class="op">&lt;</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">&gt;()};</span></span>
<span id="cb454-6"><a href="#cb454-6" aria-hidden="true" tabindex="-1"></a>    ASSERT_STREQ<span class="op">(</span><span class="st">&quot;123&quot;</span><span class="op">,</span> st<span class="op">.</span>String<span class="op">());</span></span>
<span id="cb454-7"><a href="#cb454-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb454-8"><a href="#cb454-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="kw">auto</span> st2 <span class="op">=</span> seq_test2<span class="op">&lt;</span><span class="dv">4</span><span class="op">&gt;{</span>str<span class="op">,</span> make_index_sequence<span class="op">&lt;</span><span class="kw">sizeof</span><span class="op">(</span>str<span class="op">)</span> <span class="op">-</span> <span class="dv">1</span><span class="op">&gt;()};</span></span>
<span id="cb454-9"><a href="#cb454-9" aria-hidden="true" tabindex="-1"></a>    ASSERT_STREQ<span class="op">(</span><span class="st">&quot;123&quot;</span><span class="op">,</span> st2<span class="op">.</span>String<span class="op">());</span></span></code></pre></div>
<p>上記とほぼ同様のクラステンプレートstd::index_sequence、std::make_index_sequenceが、
utilityで定義されているため、以下ではこれらを使用する。</p>
<h4 id="staticstringの開発">StaticStringの開発
<a id="SS_3_6_7_2"></a></h4>
<p>StaticStringはすでに示したテクニックを使い、下記のように定義できる。</p>
<div class="sourceCode" id="cb455"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb455-1"><a href="#cb455-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/h/nstd_static_string.h 8</span></span>
<span id="cb455-2"><a href="#cb455-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb455-3"><a href="#cb455-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="dt">size_t</span> N<span class="op">&gt;</span></span>
<span id="cb455-4"><a href="#cb455-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> StaticString <span class="op">{</span></span>
<span id="cb455-5"><a href="#cb455-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb455-6"><a href="#cb455-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">constexpr</span> StaticString<span class="op">(</span><span class="dt">char</span> <span class="at">const</span> <span class="op">(&amp;</span>str<span class="op">)[</span>N<span class="op">])</span> <span class="kw">noexcept</span></span>
<span id="cb455-7"><a href="#cb455-7" aria-hidden="true" tabindex="-1"></a>            <span class="op">:</span> StaticString<span class="op">{</span>str<span class="op">,</span> <span class="bu">std::</span>make_index_sequence<span class="op">&lt;</span>N <span class="op">-</span> <span class="dv">1</span><span class="op">&gt;{}}</span></span>
<span id="cb455-8"><a href="#cb455-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb455-9"><a href="#cb455-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb455-10"><a href="#cb455-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb455-11"><a href="#cb455-11" aria-hidden="true" tabindex="-1"></a>        <span class="kw">constexpr</span> StaticString<span class="op">(</span><span class="bu">std::</span>initializer_list<span class="op">&lt;</span><span class="dt">char</span><span class="op">&gt;</span> args<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb455-12"><a href="#cb455-12" aria-hidden="true" tabindex="-1"></a>            <span class="op">:</span> StaticString<span class="op">{</span>args<span class="op">,</span> <span class="bu">std::</span>make_index_sequence<span class="op">&lt;</span>N <span class="op">-</span> <span class="dv">1</span><span class="op">&gt;{}}</span></span>
<span id="cb455-13"><a href="#cb455-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb455-14"><a href="#cb455-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb455-15"><a href="#cb455-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb455-16"><a href="#cb455-16" aria-hidden="true" tabindex="-1"></a>        <span class="kw">constexpr</span> <span class="dt">char</span> <span class="at">const</span> <span class="op">(&amp;</span>String<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span><span class="op">)[</span>N<span class="op">]</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">string_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb455-17"><a href="#cb455-17" aria-hidden="true" tabindex="-1"></a>        <span class="kw">constexpr</span> <span class="dt">size_t</span> Size<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> N<span class="op">;</span> <span class="op">}</span></span>
<span id="cb455-18"><a href="#cb455-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb455-19"><a href="#cb455-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb455-20"><a href="#cb455-20" aria-hidden="true" tabindex="-1"></a>        <span class="dt">char</span> <span class="at">const</span> <span class="va">string_</span><span class="op">[</span>N<span class="op">];</span></span>
<span id="cb455-21"><a href="#cb455-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb455-22"><a href="#cb455-22" aria-hidden="true" tabindex="-1"></a>        <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">,</span> <span class="dt">size_t</span><span class="op">...</span> I<span class="op">&gt;</span></span>
<span id="cb455-23"><a href="#cb455-23" aria-hidden="true" tabindex="-1"></a>        <span class="kw">constexpr</span> StaticString<span class="op">(</span>T<span class="op">&amp;</span> t<span class="op">,</span> <span class="bu">std::</span>index_sequence<span class="op">&lt;</span>I<span class="op">...&gt;)</span> <span class="kw">noexcept</span> <span class="op">:</span> <span class="va">string_</span><span class="op">{</span><span class="bu">std::</span>begin<span class="op">(</span>t<span class="op">)[</span>I<span class="op">]...}</span></span>
<span id="cb455-24"><a href="#cb455-24" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb455-25"><a href="#cb455-25" aria-hidden="true" tabindex="-1"></a>            <span class="kw">static_assert</span><span class="op">(</span></span>
<span id="cb455-26"><a href="#cb455-26" aria-hidden="true" tabindex="-1"></a>                <span class="bu">std::</span>is_same_v<span class="op">&lt;</span>T<span class="op">,</span> <span class="bu">std::</span>initializer_list<span class="op">&lt;</span><span class="dt">char</span><span class="op">&gt;&gt;</span> <span class="op">||</span> <span class="bu">std::</span>is_same_v<span class="op">&lt;</span>T<span class="op">,</span> <span class="dt">char</span> <span class="at">const</span><span class="op">[</span>N<span class="op">]&gt;);</span></span>
<span id="cb455-27"><a href="#cb455-27" aria-hidden="true" tabindex="-1"></a>            <span class="kw">static_assert</span><span class="op">(</span>N <span class="op">-</span> <span class="dv">1</span> <span class="op">==</span> <span class="kw">sizeof</span><span class="op">...(</span>I<span class="op">));</span></span>
<span id="cb455-28"><a href="#cb455-28" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb455-29"><a href="#cb455-29" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>文字列リテラルからStaticStringを生成する単体テストは下記のようになる。</p>
<div class="sourceCode" id="cb456"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb456-1"><a href="#cb456-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_static_string_ut.cpp 11</span></span>
<span id="cb456-2"><a href="#cb456-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb456-3"><a href="#cb456-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">const</span> <span class="kw">auto</span> fs <span class="op">=</span> StaticString<span class="op">{</span><span class="st">&quot;abc&quot;</span><span class="op">};</span>  <span class="co">// C++17からのNの指定は不要</span></span>
<span id="cb456-4"><a href="#cb456-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb456-5"><a href="#cb456-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="kw">sizeof</span><span class="op">(</span><span class="dv">4</span><span class="op">)</span> <span class="op">==</span> fs<span class="op">.</span>Size<span class="op">());</span></span>
<span id="cb456-6"><a href="#cb456-6" aria-hidden="true" tabindex="-1"></a>    ASSERT_STREQ<span class="op">(</span><span class="st">&quot;abc&quot;</span><span class="op">,</span> fs<span class="op">.</span>String<span class="op">());</span></span>
<span id="cb456-7"><a href="#cb456-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb456-8"><a href="#cb456-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 文字列不足であるため、下記はコンパイルさせない</span></span>
<span id="cb456-9"><a href="#cb456-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">// constexpr StaticString&lt;4&gt; fs2{&quot;ab&quot;};</span></span></code></pre></div>
<p>また、std::initializer_list&lt;char&gt;による初期化の単体テストは下記のようになる。</p>
<div class="sourceCode" id="cb457"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb457-1"><a href="#cb457-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_static_string_ut.cpp 23</span></span>
<span id="cb457-2"><a href="#cb457-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb457-3"><a href="#cb457-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">const</span> <span class="kw">auto</span> fs <span class="op">=</span> StaticString<span class="op">&lt;</span><span class="dv">4</span><span class="op">&gt;{</span><span class="ch">&#39;a&#39;</span><span class="op">,</span> <span class="ch">&#39;b&#39;</span><span class="op">,</span> <span class="ch">&#39;c&#39;</span><span class="op">};</span>  <span class="co">// C++17でもNの指定は必要</span></span>
<span id="cb457-4"><a href="#cb457-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb457-5"><a href="#cb457-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="kw">sizeof</span><span class="op">(</span><span class="dv">4</span><span class="op">)</span> <span class="op">==</span> fs<span class="op">.</span>Size<span class="op">());</span></span>
<span id="cb457-6"><a href="#cb457-6" aria-hidden="true" tabindex="-1"></a>    ASSERT_STREQ<span class="op">(</span><span class="st">&quot;abc&quot;</span><span class="op">,</span> fs<span class="op">.</span>String<span class="op">());</span></span>
<span id="cb457-7"><a href="#cb457-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb457-8"><a href="#cb457-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 文字列不足であるため、下記はコンパイルさせない</span></span>
<span id="cb457-9"><a href="#cb457-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">// constexpr StaticString&lt;4&gt; fs2{&#39;a&#39;, &#39;b&#39;};</span></span></code></pre></div>
<p>次にこのクラスにoperator == を追加する。</p>
<div class="sourceCode" id="cb458"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb458-1"><a href="#cb458-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/h/nstd_static_string.h 38</span></span>
<span id="cb458-2"><a href="#cb458-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb458-3"><a href="#cb458-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> Inner_ <span class="op">{</span></span>
<span id="cb458-4"><a href="#cb458-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="dt">size_t</span> N<span class="op">&gt;</span></span>
<span id="cb458-5"><a href="#cb458-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> equal_n<span class="op">(</span><span class="dt">size_t</span> n<span class="op">,</span> StaticString<span class="op">&lt;</span>N<span class="op">&gt;</span> <span class="at">const</span><span class="op">&amp;</span> lhs<span class="op">,</span> StaticString<span class="op">&lt;</span>N<span class="op">&gt;</span> <span class="at">const</span><span class="op">&amp;</span> rhs<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb458-6"><a href="#cb458-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb458-7"><a href="#cb458-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>n <span class="op">==</span> N<span class="op">)</span> <span class="op">{</span></span>
<span id="cb458-8"><a href="#cb458-8" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb458-9"><a href="#cb458-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb458-10"><a href="#cb458-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb458-11"><a href="#cb458-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> lhs<span class="op">.</span>String<span class="op">()[</span>n<span class="op">]</span> <span class="op">!=</span> rhs<span class="op">.</span>String<span class="op">()[</span>n<span class="op">]</span> <span class="op">?</span> <span class="kw">false</span> <span class="op">:</span> equal_n<span class="op">(</span>n <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> lhs<span class="op">,</span> rhs<span class="op">);</span></span>
<span id="cb458-12"><a href="#cb458-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb458-13"><a href="#cb458-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb458-14"><a href="#cb458-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace Inner_</span></span>
<span id="cb458-15"><a href="#cb458-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb458-16"><a href="#cb458-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="dt">size_t</span> N1<span class="op">,</span> <span class="dt">size_t</span> N2<span class="op">&gt;</span></span>
<span id="cb458-17"><a href="#cb458-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> <span class="kw">operator</span><span class="op">==(</span>StaticString<span class="op">&lt;</span>N1<span class="op">&gt;</span> <span class="at">const</span><span class="op">&amp;,</span> StaticString<span class="op">&lt;</span>N2<span class="op">&gt;</span> <span class="at">const</span><span class="op">&amp;)</span> <span class="kw">noexcept</span></span>
<span id="cb458-18"><a href="#cb458-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb458-19"><a href="#cb458-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb458-20"><a href="#cb458-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb458-21"><a href="#cb458-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb458-22"><a href="#cb458-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="dt">size_t</span> N1<span class="op">,</span> <span class="dt">size_t</span> N2<span class="op">&gt;</span></span>
<span id="cb458-23"><a href="#cb458-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> <span class="kw">operator</span><span class="op">!=(</span>StaticString<span class="op">&lt;</span>N1<span class="op">&gt;</span> <span class="at">const</span><span class="op">&amp;</span> lhs<span class="op">,</span> StaticString<span class="op">&lt;</span>N2<span class="op">&gt;</span> <span class="at">const</span><span class="op">&amp;</span> rhs<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb458-24"><a href="#cb458-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb458-25"><a href="#cb458-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="op">!(</span>lhs <span class="op">==</span> rhs<span class="op">);</span></span>
<span id="cb458-26"><a href="#cb458-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb458-27"><a href="#cb458-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb458-28"><a href="#cb458-28" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="dt">size_t</span> N<span class="op">&gt;</span></span>
<span id="cb458-29"><a href="#cb458-29" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> <span class="kw">operator</span><span class="op">==(</span>StaticString<span class="op">&lt;</span>N<span class="op">&gt;</span> <span class="at">const</span><span class="op">&amp;</span> lhs<span class="op">,</span> StaticString<span class="op">&lt;</span>N<span class="op">&gt;</span> <span class="at">const</span><span class="op">&amp;</span> rhs<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb458-30"><a href="#cb458-30" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb458-31"><a href="#cb458-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> Inner_<span class="op">::</span>equal_n<span class="op">(</span><span class="dv">0</span><span class="op">,</span> lhs<span class="op">,</span> rhs<span class="op">);</span></span>
<span id="cb458-32"><a href="#cb458-32" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb458-33"><a href="#cb458-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb458-34"><a href="#cb458-34" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="dt">size_t</span> N<span class="op">&gt;</span></span>
<span id="cb458-35"><a href="#cb458-35" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> <span class="kw">operator</span><span class="op">!=(</span>StaticString<span class="op">&lt;</span>N<span class="op">&gt;</span> <span class="at">const</span><span class="op">&amp;</span> lhs<span class="op">,</span> StaticString<span class="op">&lt;</span>N<span class="op">&gt;</span> <span class="at">const</span><span class="op">&amp;</span> rhs<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb458-36"><a href="#cb458-36" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb458-37"><a href="#cb458-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="op">!(</span>lhs <span class="op">==</span> rhs<span class="op">);</span></span>
<span id="cb458-38"><a href="#cb458-38" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb458-39"><a href="#cb458-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb458-40"><a href="#cb458-40" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="dt">size_t</span> N1<span class="op">,</span> <span class="dt">size_t</span> N2<span class="op">&gt;</span></span>
<span id="cb458-41"><a href="#cb458-41" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> <span class="kw">operator</span><span class="op">==(</span>StaticString<span class="op">&lt;</span>N1<span class="op">&gt;</span> <span class="at">const</span><span class="op">&amp;</span> lhs<span class="op">,</span> <span class="dt">char</span> <span class="at">const</span> <span class="op">(&amp;</span>rhs<span class="op">)[</span>N2<span class="op">])</span> <span class="kw">noexcept</span></span>
<span id="cb458-42"><a href="#cb458-42" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb458-43"><a href="#cb458-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> lhs <span class="op">==</span> StaticString<span class="op">{</span>rhs<span class="op">};</span></span>
<span id="cb458-44"><a href="#cb458-44" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb458-45"><a href="#cb458-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb458-46"><a href="#cb458-46" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="dt">size_t</span> N1<span class="op">,</span> <span class="dt">size_t</span> N2<span class="op">&gt;</span></span>
<span id="cb458-47"><a href="#cb458-47" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> <span class="kw">operator</span><span class="op">!=(</span>StaticString<span class="op">&lt;</span>N1<span class="op">&gt;</span> <span class="at">const</span><span class="op">&amp;</span> lhs<span class="op">,</span> <span class="dt">char</span> <span class="at">const</span> <span class="op">(&amp;</span>rhs<span class="op">)[</span>N2<span class="op">])</span> <span class="kw">noexcept</span></span>
<span id="cb458-48"><a href="#cb458-48" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb458-49"><a href="#cb458-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="op">!(</span>lhs <span class="op">==</span> rhs<span class="op">);</span></span>
<span id="cb458-50"><a href="#cb458-50" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb458-51"><a href="#cb458-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb458-52"><a href="#cb458-52" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="dt">size_t</span> N1<span class="op">,</span> <span class="dt">size_t</span> N2<span class="op">&gt;</span></span>
<span id="cb458-53"><a href="#cb458-53" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> <span class="kw">operator</span><span class="op">==(</span><span class="dt">char</span> <span class="at">const</span> <span class="op">(&amp;</span>lhs<span class="op">)[</span>N1<span class="op">],</span> StaticString<span class="op">&lt;</span>N2<span class="op">&gt;</span> <span class="at">const</span><span class="op">&amp;</span> rhs<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb458-54"><a href="#cb458-54" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb458-55"><a href="#cb458-55" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> StaticString<span class="op">{</span>lhs<span class="op">}</span> <span class="op">==</span> rhs<span class="op">;</span></span>
<span id="cb458-56"><a href="#cb458-56" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb458-57"><a href="#cb458-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb458-58"><a href="#cb458-58" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="dt">size_t</span> N1<span class="op">,</span> <span class="dt">size_t</span> N2<span class="op">&gt;</span></span>
<span id="cb458-59"><a href="#cb458-59" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">bool</span> <span class="kw">operator</span><span class="op">!=(</span><span class="dt">char</span> <span class="at">const</span> <span class="op">(&amp;</span>lhs<span class="op">)[</span>N1<span class="op">],</span> StaticString<span class="op">&lt;</span>N2<span class="op">&gt;</span> <span class="at">const</span><span class="op">&amp;</span> rhs<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb458-60"><a href="#cb458-60" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb458-61"><a href="#cb458-61" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="op">!(</span>lhs <span class="op">==</span> rhs<span class="op">);</span></span>
<span id="cb458-62"><a href="#cb458-62" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>単体テストは下記のようになる。</p>
<div class="sourceCode" id="cb459"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb459-1"><a href="#cb459-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_static_string_ut.cpp 38</span></span>
<span id="cb459-2"><a href="#cb459-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb459-3"><a href="#cb459-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>StaticString<span class="op">{</span><span class="st">&quot;123&quot;</span><span class="op">}</span> <span class="op">==</span> StaticString<span class="op">{</span><span class="st">&quot;123&quot;</span><span class="op">});</span></span>
<span id="cb459-4"><a href="#cb459-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>StaticString<span class="op">{</span><span class="st">&quot;123&quot;</span><span class="op">}</span> <span class="op">!=</span> StaticString<span class="op">{</span><span class="st">&quot;1234&quot;</span><span class="op">});</span></span>
<span id="cb459-5"><a href="#cb459-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>StaticString<span class="op">{</span><span class="st">&quot;123&quot;</span><span class="op">}</span> <span class="op">==</span> <span class="st">&quot;123&quot;</span><span class="op">);</span></span>
<span id="cb459-6"><a href="#cb459-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="st">&quot;123&quot;</span> <span class="op">==</span> StaticString<span class="op">{</span><span class="st">&quot;123&quot;</span><span class="op">});</span></span>
<span id="cb459-7"><a href="#cb459-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>StaticString<span class="op">{</span><span class="st">&quot;123&quot;</span><span class="op">}</span> <span class="op">!=</span> <span class="st">&quot;1234&quot;</span><span class="op">);</span></span>
<span id="cb459-8"><a href="#cb459-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="st">&quot;1234&quot;</span> <span class="op">!=</span> StaticString<span class="op">{</span><span class="st">&quot;123&quot;</span><span class="op">});</span></span></code></pre></div>
<p><a href="#SS_5_2_5">非explitなコンストラクタによる暗黙の型変換</a>
を利用した文字列リテラルからStaticStringオブジェクトへの変換は、
StaticStringがテンプレートであるため機能せず、上記のように書く必要がある。</p>
<p>同様にoperator + を追加する。</p>
<div class="sourceCode" id="cb460"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb460-1"><a href="#cb460-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/h/nstd_static_string.h 101</span></span>
<span id="cb460-2"><a href="#cb460-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb460-3"><a href="#cb460-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> Inner_ <span class="op">{</span></span>
<span id="cb460-4"><a href="#cb460-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="dt">size_t</span> N1<span class="op">,</span> <span class="dt">size_t</span><span class="op">...</span> I1<span class="op">,</span> <span class="dt">size_t</span> N2<span class="op">,</span> <span class="dt">size_t</span><span class="op">...</span> I2<span class="op">&gt;</span></span>
<span id="cb460-5"><a href="#cb460-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> StaticString<span class="op">&lt;</span>N1 <span class="op">+</span> N2 <span class="op">-</span> <span class="dv">1</span><span class="op">&gt;</span> concat<span class="op">(</span><span class="dt">char</span> <span class="at">const</span> <span class="op">(&amp;</span>str1<span class="op">)[</span>N1<span class="op">],</span> <span class="bu">std::</span>index_sequence<span class="op">&lt;</span>I1<span class="op">...&gt;,</span></span>
<span id="cb460-6"><a href="#cb460-6" aria-hidden="true" tabindex="-1"></a>                                               <span class="dt">char</span> <span class="at">const</span> <span class="op">(&amp;</span>str2<span class="op">)[</span>N2<span class="op">],</span></span>
<span id="cb460-7"><a href="#cb460-7" aria-hidden="true" tabindex="-1"></a>                                               <span class="bu">std::</span>index_sequence<span class="op">&lt;</span>I2<span class="op">...&gt;)</span> <span class="kw">noexcept</span></span>
<span id="cb460-8"><a href="#cb460-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb460-9"><a href="#cb460-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="op">{</span>str1<span class="op">[</span>I1<span class="op">]...,</span> str2<span class="op">[</span>I2<span class="op">]...};</span></span>
<span id="cb460-10"><a href="#cb460-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb460-11"><a href="#cb460-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace Inner_</span></span>
<span id="cb460-12"><a href="#cb460-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb460-13"><a href="#cb460-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="dt">size_t</span> N1<span class="op">,</span> <span class="dt">size_t</span> N2<span class="op">&gt;</span></span>
<span id="cb460-14"><a href="#cb460-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="kw">auto</span> <span class="kw">operator</span><span class="op">+(</span>StaticString<span class="op">&lt;</span>N1<span class="op">&gt;</span> <span class="at">const</span><span class="op">&amp;</span> lhs<span class="op">,</span> StaticString<span class="op">&lt;</span>N2<span class="op">&gt;</span> <span class="at">const</span><span class="op">&amp;</span> rhs<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb460-15"><a href="#cb460-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb460-16"><a href="#cb460-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> Inner_<span class="op">::</span>concat<span class="op">(</span>lhs<span class="op">.</span>String<span class="op">(),</span> <span class="bu">std::</span>make_index_sequence<span class="op">&lt;</span>N1 <span class="op">-</span> <span class="dv">1</span><span class="op">&gt;{},</span> rhs<span class="op">.</span>String<span class="op">(),</span></span>
<span id="cb460-17"><a href="#cb460-17" aria-hidden="true" tabindex="-1"></a>                              <span class="bu">std::</span>make_index_sequence<span class="op">&lt;</span>N2<span class="op">&gt;{});</span></span>
<span id="cb460-18"><a href="#cb460-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb460-19"><a href="#cb460-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb460-20"><a href="#cb460-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="dt">size_t</span> N1<span class="op">,</span> <span class="dt">size_t</span> N2<span class="op">&gt;</span></span>
<span id="cb460-21"><a href="#cb460-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="kw">auto</span> <span class="kw">operator</span><span class="op">+(</span>StaticString<span class="op">&lt;</span>N1<span class="op">&gt;</span> <span class="at">const</span><span class="op">&amp;</span> lhs<span class="op">,</span> <span class="dt">char</span> <span class="at">const</span> <span class="op">(&amp;</span>rhs<span class="op">)[</span>N2<span class="op">])</span> <span class="kw">noexcept</span></span>
<span id="cb460-22"><a href="#cb460-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb460-23"><a href="#cb460-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> lhs <span class="op">+</span> StaticString<span class="op">{</span>rhs<span class="op">};</span></span>
<span id="cb460-24"><a href="#cb460-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb460-25"><a href="#cb460-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb460-26"><a href="#cb460-26" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="dt">size_t</span> N1<span class="op">,</span> <span class="dt">size_t</span> N2<span class="op">&gt;</span></span>
<span id="cb460-27"><a href="#cb460-27" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="kw">auto</span> <span class="kw">operator</span><span class="op">+(</span><span class="dt">char</span> <span class="at">const</span> <span class="op">(&amp;</span>lhs<span class="op">)[</span>N1<span class="op">],</span> StaticString<span class="op">&lt;</span>N2<span class="op">&gt;</span> <span class="at">const</span><span class="op">&amp;</span> rhs<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb460-28"><a href="#cb460-28" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb460-29"><a href="#cb460-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> StaticString<span class="op">{</span>lhs<span class="op">}</span> <span class="op">+</span> rhs<span class="op">;</span></span>
<span id="cb460-30"><a href="#cb460-30" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb461"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb461-1"><a href="#cb461-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_static_string_ut.cpp 51</span></span>
<span id="cb461-2"><a href="#cb461-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb461-3"><a href="#cb461-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="kw">auto</span> fs0 <span class="op">=</span> StaticString<span class="op">{</span><span class="st">&quot;1234&quot;</span><span class="op">}</span> <span class="op">+</span> StaticString<span class="op">{</span><span class="st">&quot;567&quot;</span><span class="op">};</span></span>
<span id="cb461-4"><a href="#cb461-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span>StaticString<span class="op">&lt;</span>fs0<span class="op">.</span>Size<span class="op">()&gt;</span> <span class="at">const</span><span class="op">,</span> <span class="kw">decltype</span><span class="op">(</span>fs0<span class="op">)&gt;);</span></span>
<span id="cb461-5"><a href="#cb461-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="st">&quot;1234567&quot;</span> <span class="op">==</span> fs0<span class="op">);</span></span>
<span id="cb461-6"><a href="#cb461-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb461-7"><a href="#cb461-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="kw">auto</span> fs1 <span class="op">=</span> StaticString<span class="op">{</span><span class="st">&quot;1234&quot;</span><span class="op">}</span> <span class="op">+</span> <span class="st">&quot;:&quot;</span><span class="op">;</span></span>
<span id="cb461-8"><a href="#cb461-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span>StaticString<span class="op">&lt;</span>fs1<span class="op">.</span>Size<span class="op">()&gt;</span> <span class="at">const</span><span class="op">,</span> <span class="kw">decltype</span><span class="op">(</span>fs1<span class="op">)&gt;);</span></span>
<span id="cb461-9"><a href="#cb461-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="st">&quot;1234:&quot;</span> <span class="op">==</span> fs1<span class="op">);</span></span>
<span id="cb461-10"><a href="#cb461-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb461-11"><a href="#cb461-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="kw">auto</span> fs2 <span class="op">=</span> <span class="st">&quot;:&quot;</span> <span class="op">+</span> StaticString<span class="op">{</span><span class="st">&quot;567&quot;</span><span class="op">};</span></span>
<span id="cb461-12"><a href="#cb461-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span>StaticString<span class="op">&lt;</span>fs2<span class="op">.</span>Size<span class="op">()&gt;</span> <span class="at">const</span><span class="op">,</span> <span class="kw">decltype</span><span class="op">(</span>fs2<span class="op">)&gt;);</span></span>
<span id="cb461-13"><a href="#cb461-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="st">&quot;:567&quot;</span> <span class="op">==</span> fs2<span class="op">);</span></span>
<span id="cb461-14"><a href="#cb461-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb461-15"><a href="#cb461-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="kw">auto</span> fs3 <span class="op">=</span> StaticString<span class="op">{</span><span class="st">&quot;1234&quot;</span><span class="op">}</span> <span class="op">+</span> <span class="st">&quot;:&quot;</span> <span class="op">+</span> StaticString<span class="op">{</span><span class="st">&quot;567&quot;</span><span class="op">};</span></span>
<span id="cb461-16"><a href="#cb461-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span>StaticString<span class="op">&lt;</span>fs3<span class="op">.</span>Size<span class="op">()&gt;</span> <span class="at">const</span><span class="op">,</span> <span class="kw">decltype</span><span class="op">(</span>fs3<span class="op">)&gt;);</span></span>
<span id="cb461-17"><a href="#cb461-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="st">&quot;1234:567&quot;</span> <span class="op">==</span> fs3<span class="op">);</span></span></code></pre></div>
<h4
id="整数をstaticstringに変換する関数の開発">整数をStaticStringに変換する関数の開発
<a id="SS_3_6_7_3"></a></h4>
<p>コンパイル時に__LINE__をStaticStringに変換できれば、
ファイル位置をStaticStringで表現できるため、
ここではその変換関数Int2StaticString&lt;&gt;()の実装を行う。</p>
<p>行番号を10進数での文字列で表現するため、いくつかのヘルパ関数を下記のように定義する。</p>
<div class="sourceCode" id="cb462"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb462-1"><a href="#cb462-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/h/nstd_static_string_num.h 8</span></span>
<span id="cb462-2"><a href="#cb462-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb462-3"><a href="#cb462-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> Inner_ <span class="op">{</span></span>
<span id="cb462-4"><a href="#cb462-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb462-5"><a href="#cb462-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 10進数桁数を返す</span></span>
<span id="cb462-6"><a href="#cb462-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">size_t</span> num_of_digits<span class="op">(</span><span class="dt">size_t</span> n<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> n <span class="op">&gt;</span> <span class="dv">0</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">+</span> num_of_digits<span class="op">(</span>n <span class="op">/</span> <span class="dv">10</span><span class="op">)</span> <span class="op">:</span> <span class="dv">0</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb462-7"><a href="#cb462-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb462-8"><a href="#cb462-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 10のn乗を返す</span></span>
<span id="cb462-9"><a href="#cb462-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">uint32_t</span> ten_to_nth_power<span class="op">(</span><span class="dt">uint32_t</span> n<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb462-10"><a href="#cb462-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb462-11"><a href="#cb462-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> n <span class="op">==</span> <span class="dv">0</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="dv">10</span> <span class="op">*</span> ten_to_nth_power<span class="op">(</span>n <span class="op">-</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb462-12"><a href="#cb462-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb462-13"><a href="#cb462-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb462-14"><a href="#cb462-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 10進数の桁の若い順番に左から並べなおす(12345 -&gt; 54321)</span></span>
<span id="cb462-15"><a href="#cb462-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">uint32_t</span> reverse_num<span class="op">(</span><span class="dt">uint32_t</span> num<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb462-16"><a href="#cb462-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb462-17"><a href="#cb462-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> num <span class="op">!=</span> <span class="dv">0</span> <span class="op">?</span> <span class="op">(</span>num <span class="op">%</span> <span class="dv">10</span><span class="op">)</span> <span class="op">*</span> ten_to_nth_power<span class="op">(</span>num_of_digits<span class="op">(</span>num<span class="op">)</span> <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="op">+</span> reverse_num<span class="op">(</span>num <span class="op">/</span> <span class="dv">10</span><span class="op">)</span></span>
<span id="cb462-18"><a href="#cb462-18" aria-hidden="true" tabindex="-1"></a>                        <span class="op">:</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb462-19"><a href="#cb462-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb462-20"><a href="#cb462-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb462-21"><a href="#cb462-21" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 10進数一桁をacsii文字に変換</span></span>
<span id="cb462-22"><a href="#cb462-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">char</span> digit_to_char<span class="op">(</span><span class="dt">uint32_t</span> num<span class="op">,</span> <span class="dt">uint32_t</span> n_th<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb462-23"><a href="#cb462-23" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb462-24"><a href="#cb462-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="ch">&#39;0&#39;</span> <span class="op">+</span> <span class="op">(</span>num <span class="op">%</span> <span class="op">(</span>ten_to_nth_power<span class="op">(</span>n_th <span class="op">+</span> <span class="dv">1</span><span class="op">)))</span> <span class="op">/</span> ten_to_nth_power<span class="op">(</span>n_th<span class="op">);</span></span>
<span id="cb462-25"><a href="#cb462-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb462-26"><a href="#cb462-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb462-27"><a href="#cb462-27" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Int2StaticStringのヘルパ関数</span></span>
<span id="cb462-28"><a href="#cb462-28" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="dt">size_t</span> N<span class="op">,</span> <span class="dt">size_t</span><span class="op">...</span> Cs<span class="op">&gt;</span></span>
<span id="cb462-29"><a href="#cb462-29" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> StaticString<span class="op">&lt;</span>num_of_digits<span class="op">(</span>N<span class="op">)</span> <span class="op">+</span> <span class="dv">1</span><span class="op">&gt;</span> make_static_string<span class="op">(</span><span class="bu">std::</span>index_sequence<span class="op">&lt;</span>Cs<span class="op">...&gt;)</span> <span class="kw">noexcept</span></span>
<span id="cb462-30"><a href="#cb462-30" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb462-31"><a href="#cb462-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="op">{</span>digit_to_char<span class="op">(</span>reverse_num<span class="op">(</span>N<span class="op">),</span> Cs<span class="op">)...};</span></span>
<span id="cb462-32"><a href="#cb462-32" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb462-33"><a href="#cb462-33" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace Inner_</span></span></code></pre></div>
<p>単体テストは下記のようになる。</p>
<div class="sourceCode" id="cb463"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb463-1"><a href="#cb463-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_static_string_num_ut.cpp 47</span></span>
<span id="cb463-2"><a href="#cb463-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb463-3"><a href="#cb463-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="kw">auto</span> ns</span>
<span id="cb463-4"><a href="#cb463-4" aria-hidden="true" tabindex="-1"></a>        <span class="op">=</span> make_static_string<span class="op">&lt;</span><span class="ot">__LINE__</span><span class="op">&gt;(</span><span class="bu">std::</span>make_index_sequence<span class="op">&lt;</span>Inner_<span class="op">::</span>num_of_digits<span class="op">(</span><span class="ot">__LINE__</span><span class="op">)&gt;());</span></span>
<span id="cb463-5"><a href="#cb463-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> line_num <span class="op">=</span> <span class="ot">__LINE__</span> <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb463-6"><a href="#cb463-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb463-7"><a href="#cb463-7" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="bu">std::</span>to_string<span class="op">(</span>line_num<span class="op">),</span> ns<span class="op">.</span>String<span class="op">());</span></span></code></pre></div>
<p>このままでは使いづらいため、これをラッピングした関数を下記のように定義することで、
Int2StaticString&lt;&gt;()が得られる。</p>
<div class="sourceCode" id="cb464"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb464-1"><a href="#cb464-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/h/nstd_static_string_num.h 42</span></span>
<span id="cb464-2"><a href="#cb464-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb464-3"><a href="#cb464-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="dt">size_t</span> N<span class="op">&gt;</span></span>
<span id="cb464-4"><a href="#cb464-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> StaticString<span class="op">&lt;</span>Inner_<span class="op">::</span>num_of_digits<span class="op">(</span>N<span class="op">)</span> <span class="op">+</span> <span class="dv">1</span><span class="op">&gt;</span> Int2StaticString<span class="op">()</span> <span class="kw">noexcept</span></span>
<span id="cb464-5"><a href="#cb464-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb464-6"><a href="#cb464-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> Inner_<span class="op">::</span>make_static_string<span class="op">&lt;</span>N<span class="op">&gt;(</span><span class="bu">std::</span>make_index_sequence<span class="op">&lt;</span>Inner_<span class="op">::</span>num_of_digits<span class="op">(</span>N<span class="op">)&gt;());</span></span>
<span id="cb464-7"><a href="#cb464-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>単体テストは下記のようになる。</p>
<div class="sourceCode" id="cb465"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb465-1"><a href="#cb465-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_static_string_num_ut.cpp 66</span></span>
<span id="cb465-2"><a href="#cb465-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb465-3"><a href="#cb465-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="kw">auto</span> ns       <span class="op">=</span> Int2StaticString<span class="op">&lt;</span><span class="ot">__LINE__</span><span class="op">&gt;();</span></span>
<span id="cb465-4"><a href="#cb465-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span>           line_num <span class="op">=</span> <span class="ot">__LINE__</span> <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb465-5"><a href="#cb465-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb465-6"><a href="#cb465-6" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="bu">std::</span>to_string<span class="op">(</span>line_num<span class="op">),</span> ns<span class="op">.</span>String<span class="op">());</span></span></code></pre></div>
<h4
id="ファイル位置を静的に保持したエクセプションクラスの開発">ファイル位置を静的に保持したエクセプションクラスの開発
<a id="SS_3_6_7_4"></a></h4>
<p>「<a href="#SS_3_6_7">静的な文字列オブジェクト</a>」で見たように、
ファイル位置を動的に保持するエクセプションクラスは使い勝手が悪い。
ここでは、その問題を解決するためのExceptionクラスの実装を示す。</p>
<div class="sourceCode" id="cb466"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb466-1"><a href="#cb466-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/h/nstd_exception.h 10</span></span>
<span id="cb466-2"><a href="#cb466-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb466-3"><a href="#cb466-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@class</span><span class="co"> </span><span class="cv">Exception</span></span>
<span id="cb466-4"><a href="#cb466-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@brief</span><span class="co"> StaticString&lt;&gt;を使ったエクセプションクラス</span></span>
<span id="cb466-5"><a href="#cb466-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">///        下記のMAKE_EXCEPTIONを使い生成</span></span>
<span id="cb466-6"><a href="#cb466-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@tparam</span><span class="co"> </span><span class="cv">E</span><span class="co">   std::exceptionから派生したエクセプションクラス</span></span>
<span id="cb466-7"><a href="#cb466-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@tparam</span><span class="co"> </span><span class="cv">N</span><span class="co">   StaticString</span><span class="kw">&lt;N&gt;</span></span>
<span id="cb466-8"><a href="#cb466-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">class</span> E<span class="op">,</span> <span class="dt">size_t</span> N<span class="op">&gt;</span></span>
<span id="cb466-9"><a href="#cb466-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Exception <span class="op">:</span> <span class="kw">public</span> E <span class="op">{</span></span>
<span id="cb466-10"><a href="#cb466-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb466-11"><a href="#cb466-11" aria-hidden="true" tabindex="-1"></a>        <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_base_of_v<span class="op">&lt;</span><span class="bu">std::</span>exception<span class="op">,</span> E<span class="op">&gt;);</span></span>
<span id="cb466-12"><a href="#cb466-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb466-13"><a href="#cb466-13" aria-hidden="true" tabindex="-1"></a>        Exception<span class="op">(</span>StaticString<span class="op">&lt;</span>N<span class="op">&gt;</span> <span class="at">const</span><span class="op">&amp;</span> what_str<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">:</span> <span class="va">what_str_</span><span class="op">{</span>what_str<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb466-14"><a href="#cb466-14" aria-hidden="true" tabindex="-1"></a>        <span class="dt">char</span> <span class="at">const</span><span class="op">*</span> what<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="kw">override</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">what_str_</span><span class="op">.</span>String<span class="op">();</span> <span class="op">}</span></span>
<span id="cb466-15"><a href="#cb466-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb466-16"><a href="#cb466-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb466-17"><a href="#cb466-17" aria-hidden="true" tabindex="-1"></a>        StaticString<span class="op">&lt;</span>N<span class="op">&gt;</span> <span class="at">const</span> <span class="va">what_str_</span><span class="op">;</span></span>
<span id="cb466-18"><a href="#cb466-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>StaticStringと同様に、このままでは不便であるため、下記の関数を定義する。</p>
<div class="sourceCode" id="cb467"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb467-1"><a href="#cb467-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/h/nstd_exception.h 29</span></span>
<span id="cb467-2"><a href="#cb467-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb467-3"><a href="#cb467-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> Inner_ <span class="op">{</span></span>
<span id="cb467-4"><a href="#cb467-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">class</span> E<span class="op">,</span> <span class="kw">template</span> <span class="op">&lt;</span><span class="dt">size_t</span><span class="op">&gt;</span> <span class="kw">class</span> STATIC_STR<span class="op">,</span> <span class="dt">size_t</span> N<span class="op">&gt;</span></span>
<span id="cb467-5"><a href="#cb467-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> make_exception<span class="op">(</span>STATIC_STR<span class="op">&lt;</span>N<span class="op">&gt;</span> exception_str<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb467-6"><a href="#cb467-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb467-7"><a href="#cb467-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> Exception<span class="op">&lt;</span>E<span class="op">,</span> N<span class="op">&gt;{</span>exception_str<span class="op">};</span></span>
<span id="cb467-8"><a href="#cb467-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb467-9"><a href="#cb467-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace Inner_</span></span>
<span id="cb467-10"><a href="#cb467-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb467-11"><a href="#cb467-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">class</span> E<span class="op">,</span> <span class="dt">size_t</span> LINE_NUM<span class="op">,</span> <span class="dt">size_t</span> F_N<span class="op">,</span> <span class="dt">size_t</span> M_N<span class="op">&gt;</span></span>
<span id="cb467-12"><a href="#cb467-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> MakeException<span class="op">(</span><span class="dt">char</span> <span class="at">const</span> <span class="op">(&amp;</span>filename<span class="op">)[</span>F_N<span class="op">],</span> <span class="dt">char</span> <span class="at">const</span> <span class="op">(&amp;</span>msg<span class="op">)[</span>M_N<span class="op">])</span> <span class="kw">noexcept</span></span>
<span id="cb467-13"><a href="#cb467-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb467-14"><a href="#cb467-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> Inner_<span class="op">::</span>make_exception<span class="op">&lt;</span>E<span class="op">&gt;(</span>StaticString<span class="op">{</span>filename<span class="op">}</span> <span class="op">+</span> <span class="st">&quot;:&quot;</span> <span class="op">+</span> Int2StaticString<span class="op">&lt;</span>LINE_NUM<span class="op">&gt;()</span></span>
<span id="cb467-15"><a href="#cb467-15" aria-hidden="true" tabindex="-1"></a>                                         <span class="op">+</span> <span class="st">&quot;:&quot;</span> <span class="op">+</span> msg<span class="op">);</span></span>
<span id="cb467-16"><a href="#cb467-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>単体テストは下記のようになる。</p>
<div class="sourceCode" id="cb468"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb468-1"><a href="#cb468-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_exception_ut.cpp 89</span></span>
<span id="cb468-2"><a href="#cb468-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb468-3"><a href="#cb468-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> caught   <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb468-4"><a href="#cb468-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> line_num <span class="op">=</span> <span class="ot">__LINE__</span> <span class="op">+</span> <span class="dv">2</span><span class="op">;</span>  <span class="co">// 2行下の行番号</span></span>
<span id="cb468-5"><a href="#cb468-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span> <span class="op">{</span></span>
<span id="cb468-6"><a href="#cb468-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">throw</span> MakeException<span class="op">&lt;</span><span class="bu">std::</span>exception<span class="op">,</span> <span class="ot">__LINE__</span><span class="op">&gt;(</span><span class="ot">__FILE__</span><span class="op">,</span> <span class="st">&quot;some error message&quot;</span><span class="op">);</span></span>
<span id="cb468-7"><a href="#cb468-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb468-8"><a href="#cb468-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">catch</span> <span class="op">(</span><span class="bu">std::</span>exception<span class="op"> </span><span class="at">const</span><span class="op">&amp;</span> e<span class="op">)</span> <span class="op">{</span></span>
<span id="cb468-9"><a href="#cb468-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> oss <span class="op">=</span> <span class="bu">std::</span>ostringstream<span class="op">{};</span></span>
<span id="cb468-10"><a href="#cb468-10" aria-hidden="true" tabindex="-1"></a>        oss <span class="op">&lt;&lt;</span> <span class="ot">__FILE__</span> <span class="op">&lt;&lt;</span> <span class="st">&quot;:&quot;</span> <span class="op">&lt;&lt;</span> line_num <span class="op">&lt;&lt;</span> <span class="st">&quot;:some error message&quot;</span><span class="op">;</span></span>
<span id="cb468-11"><a href="#cb468-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb468-12"><a href="#cb468-12" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span>oss<span class="op">.</span>str<span class="op">(),</span> e<span class="op">.</span>what<span class="op">());</span></span>
<span id="cb468-13"><a href="#cb468-13" aria-hidden="true" tabindex="-1"></a>        caught <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb468-14"><a href="#cb468-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb468-15"><a href="#cb468-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb468-16"><a href="#cb468-16" aria-hidden="true" tabindex="-1"></a>    ASSERT_TRUE<span class="op">(</span>caught<span class="op">);</span></span></code></pre></div>
<p>Exceptionクラスの利便性をさらに高めるため、下記の定義を行う。</p>
<div class="sourceCode" id="cb469"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb469-1"><a href="#cb469-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/h/nstd_exception.h 48</span></span>
<span id="cb469-2"><a href="#cb469-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb469-3"><a href="#cb469-3" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#define MAKE_EXCEPTION</span><span class="op">(</span>E__<span class="op">,</span><span class="pp"> </span><span class="va">msg__</span><span class="op">)</span><span class="pp"> </span>Nstd<span class="op">::</span>MakeException<span class="op">&lt;</span>E__<span class="op">,</span><span class="pp"> </span><span class="ot">__LINE__</span><span class="op">&gt;(</span><span class="ot">__FILE__</span><span class="op">,</span><span class="pp"> </span><span class="va">msg__</span><span class="op">)</span></span></code></pre></div>
<p>上記は、関数型マクロの数少ない使いどころである。</p>
<p>単体テストは下記のようになる。</p>
<div class="sourceCode" id="cb470"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb470-1"><a href="#cb470-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_exception_ut.cpp 109</span></span>
<span id="cb470-2"><a href="#cb470-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb470-3"><a href="#cb470-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">uint32_t</span> line_num_div<span class="op">;</span>  <span class="co">// エクセプション行を指定</span></span>
<span id="cb470-4"><a href="#cb470-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb470-5"><a href="#cb470-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int32_t</span> div<span class="op">(</span><span class="dt">int32_t</span> a<span class="op">,</span> <span class="dt">int32_t</span> b<span class="op">)</span></span>
<span id="cb470-6"><a href="#cb470-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb470-7"><a href="#cb470-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>b <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb470-8"><a href="#cb470-8" aria-hidden="true" tabindex="-1"></a>            line_num_div <span class="op">=</span> <span class="ot">__LINE__</span> <span class="op">+</span> <span class="dv">1</span><span class="op">;</span>  <span class="co">// 次の行番号</span></span>
<span id="cb470-9"><a href="#cb470-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">throw</span> MAKE_EXCEPTION<span class="op">(</span><span class="bu">std::</span>exception<span class="op">,</span> <span class="st">&quot;divided by 0&quot;</span><span class="op">);</span></span>
<span id="cb470-10"><a href="#cb470-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb470-11"><a href="#cb470-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb470-12"><a href="#cb470-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> a <span class="op">/</span> b<span class="op">;</span></span>
<span id="cb470-13"><a href="#cb470-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb471"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb471-1"><a href="#cb471-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/nstd_exception_ut.cpp 126</span></span>
<span id="cb471-2"><a href="#cb471-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb471-3"><a href="#cb471-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> caught <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb471-4"><a href="#cb471-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb471-5"><a href="#cb471-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span> <span class="op">{</span></span>
<span id="cb471-6"><a href="#cb471-6" aria-hidden="true" tabindex="-1"></a>        div<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb471-7"><a href="#cb471-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb471-8"><a href="#cb471-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">catch</span> <span class="op">(</span><span class="bu">std::</span>exception<span class="op"> </span><span class="at">const</span><span class="op">&amp;</span> e<span class="op">)</span> <span class="op">{</span>  <span class="co">// リファレンスでcatchしなければならない</span></span>
<span id="cb471-9"><a href="#cb471-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> oss <span class="op">=</span> <span class="bu">std::</span>ostringstream<span class="op">{};</span></span>
<span id="cb471-10"><a href="#cb471-10" aria-hidden="true" tabindex="-1"></a>        oss <span class="op">&lt;&lt;</span> <span class="ot">__FILE__</span> <span class="op">&lt;&lt;</span> <span class="st">&quot;:&quot;</span> <span class="op">&lt;&lt;</span> line_num_div <span class="op">&lt;&lt;</span> <span class="st">&quot;:divided by 0&quot;</span><span class="op">;</span></span>
<span id="cb471-11"><a href="#cb471-11" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span>oss<span class="op">.</span>str<span class="op">(),</span> e<span class="op">.</span>what<span class="op">());</span></span>
<span id="cb471-12"><a href="#cb471-12" aria-hidden="true" tabindex="-1"></a>        caught <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb471-13"><a href="#cb471-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb471-14"><a href="#cb471-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb471-15"><a href="#cb471-15" aria-hidden="true" tabindex="-1"></a>    ASSERT_TRUE<span class="op">(</span>caught<span class="op">);</span></span></code></pre></div>
<h3
id="関数型をテンプレートパラメータで使う">関数型をテンプレートパラメータで使う
<a id="SS_3_6_8"></a></h3>
<p>ここで使う「関数型」とは、</p>
<ul>
<li>関数へのポインタの型</li>
<li>クロージャの型、もしくはラムダ式の型</li>
<li>関数オブジェクトの型</li>
</ul>
<p>の総称を指す。</p>
<p>std::unique_ptrは、</p>
<ul>
<li>第1パラメータにポインタの型</li>
<li>第2パラメータにそのポインタの解放用の関数ポインタの型</li>
</ul>
<p>を取ることができるが、通常は第2パラメータは省略される。
省略時にはstd::default_deleteが割り当てられ、そのオブジェクトによって、
第1パラメータに対応するポインタがdeleteされる。</p>
<p>下記コードではこの第2パラメータにstd::freeのポインタの型を与え、
それから生成されるstd::unique_ptrオブジェクトを、</p>
<ul>
<li>abi::__cxa_demangleがstd::mallocで取得したchar型ポインタ</li>
<li>std::freeのポインタ</li>
</ul>
<p>で初期化することでメモリの解放を行っている。</p>
<div class="sourceCode" id="cb472"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb472-1"><a href="#cb472-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ h/nstd_type2str.h 18</span></span>
<span id="cb472-2"><a href="#cb472-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb472-3"><a href="#cb472-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span><span class="dt">char</span><span class="op">,</span> <span class="kw">decltype</span><span class="op">(&amp;</span><span class="bu">std::</span>free<span class="op">)&gt;</span> demangled<span class="op">{</span></span>
<span id="cb472-4"><a href="#cb472-4" aria-hidden="true" tabindex="-1"></a>        abi<span class="op">::</span>__cxa_demangle<span class="op">(</span>to_demagle<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="op">&amp;</span>status<span class="op">),</span> <span class="op">&amp;</span><span class="bu">std::</span>free<span class="op">};</span></span></code></pre></div>
<p>std::unique_ptrの第2パラメータには、上記のような関数へのポインタのみではなく、
関数型を取ることができる。</p>
<p>そのことを順を追って示す。
まずは、std::unique_ptrの動作を確かめるためのクラスを下記のように定義する。</p>
<div class="sourceCode" id="cb473"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb473-1"><a href="#cb473-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/func_type_ut.cpp 10</span></span>
<span id="cb473-2"><a href="#cb473-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb473-3"><a href="#cb473-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// デストラクタが呼び出された時に、外部から渡されたフラグをtrueにする</span></span>
<span id="cb473-4"><a href="#cb473-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> A <span class="op">{</span></span>
<span id="cb473-5"><a href="#cb473-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> A<span class="op">(</span><span class="dt">bool</span><span class="op">&amp;</span> destructor_called<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">:</span> destructor_called<span class="op">{</span>destructor_called<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb473-6"><a href="#cb473-6" aria-hidden="true" tabindex="-1"></a>        <span class="op">~</span>A<span class="op">()</span> <span class="op">{</span> destructor_called <span class="op">=</span> <span class="kw">true</span><span class="op">;</span> <span class="op">};</span></span>
<span id="cb473-7"><a href="#cb473-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb473-8"><a href="#cb473-8" aria-hidden="true" tabindex="-1"></a>        <span class="dt">bool</span><span class="op">&amp;</span> destructor_called<span class="op">;</span></span>
<span id="cb473-9"><a href="#cb473-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>次に示すのは、第2パラメータに何も指定しないパターンである。
テスト用クラスAの動作確認ができるはずである。</p>
<div class="sourceCode" id="cb474"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb474-1"><a href="#cb474-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/func_type_ut.cpp 27</span></span>
<span id="cb474-2"><a href="#cb474-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb474-3"><a href="#cb474-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span>  <span class="co">// 第2パラメータに何も指定しない</span></span>
<span id="cb474-4"><a href="#cb474-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> is_called <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb474-5"><a href="#cb474-5" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb474-6"><a href="#cb474-6" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> ua <span class="op">=</span> <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>A<span class="op">&gt;{</span><span class="kw">new</span> A<span class="op">{</span>is_called<span class="op">}};</span></span>
<span id="cb474-7"><a href="#cb474-7" aria-hidden="true" tabindex="-1"></a>            ASSERT_FALSE<span class="op">(</span>is_called<span class="op">);</span>  <span class="co">// uaのデストラクタは呼ばれていない</span></span>
<span id="cb474-8"><a href="#cb474-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb474-9"><a href="#cb474-9" aria-hidden="true" tabindex="-1"></a>        ASSERT_TRUE<span class="op">(</span>is_called<span class="op">);</span>  <span class="co">// uaのデストラクタは呼ばれた</span></span>
<span id="cb474-10"><a href="#cb474-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>次に示すのは、</p>
<div class="sourceCode" id="cb475"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb475-1"><a href="#cb475-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/func_type_ut.cpp 20</span></span>
<span id="cb475-2"><a href="#cb475-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-3"><a href="#cb475-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> delete_func<span class="op">(</span>A<span class="op">*</span> a<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="kw">delete</span> a<span class="op">;</span> <span class="op">}</span></span></code></pre></div>
<p>のポインタをstd::unique_ptrの第2パラメータに与えた例である。</p>
<div class="sourceCode" id="cb476"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb476-1"><a href="#cb476-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/func_type_ut.cpp 38</span></span>
<span id="cb476-2"><a href="#cb476-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb476-3"><a href="#cb476-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span>  <span class="co">// 第2パラメータに関数ポインタを与える</span></span>
<span id="cb476-4"><a href="#cb476-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> is_called <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb476-5"><a href="#cb476-5" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb476-6"><a href="#cb476-6" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> ua <span class="op">=</span> <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>A<span class="op">,</span> <span class="dt">void</span> <span class="op">(*)(</span>A<span class="op">*)&gt;{</span><span class="kw">new</span> A<span class="op">{</span>is_called<span class="op">},</span> <span class="op">&amp;</span>delete_func<span class="op">};</span></span>
<span id="cb476-7"><a href="#cb476-7" aria-hidden="true" tabindex="-1"></a>            ASSERT_FALSE<span class="op">(</span>is_called<span class="op">);</span>  <span class="co">// uaのデストラクタは呼ばれていない</span></span>
<span id="cb476-8"><a href="#cb476-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb476-9"><a href="#cb476-9" aria-hidden="true" tabindex="-1"></a>        ASSERT_TRUE<span class="op">(</span>is_called<span class="op">);</span>  <span class="co">// uaのデストラクタは呼ばれた</span></span>
<span id="cb476-10"><a href="#cb476-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>次に示すのは、std::unique_ptrの第2パラメータにラムダを与えた例である。</p>
<div class="sourceCode" id="cb477"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb477-1"><a href="#cb477-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/func_type_ut.cpp 49</span></span>
<span id="cb477-2"><a href="#cb477-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb477-3"><a href="#cb477-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span>  <span class="co">// 第2パラメータにラムダを与える</span></span>
<span id="cb477-4"><a href="#cb477-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> is_called <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb477-5"><a href="#cb477-5" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb477-6"><a href="#cb477-6" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> delete_lambda <span class="op">=</span> <span class="op">[](</span>A<span class="op">*</span> a<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="kw">delete</span> a<span class="op">;</span> <span class="op">};</span></span>
<span id="cb477-7"><a href="#cb477-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb477-8"><a href="#cb477-8" aria-hidden="true" tabindex="-1"></a>            <span class="co">// ラムダ式の型はインスタンス毎に異なるため、</span></span>
<span id="cb477-9"><a href="#cb477-9" aria-hidden="true" tabindex="-1"></a>            <span class="co">// ラムダ式の型を取得するためには下記のようにdecltypeを使う必要がある</span></span>
<span id="cb477-10"><a href="#cb477-10" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> ua <span class="op">=</span> <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>A<span class="op">,</span> <span class="kw">decltype</span><span class="op">(</span>delete_lambda<span class="op">)&gt;{</span><span class="kw">new</span> A<span class="op">{</span>is_called<span class="op">},</span> delete_lambda<span class="op">};</span></span>
<span id="cb477-11"><a href="#cb477-11" aria-hidden="true" tabindex="-1"></a>            ASSERT_FALSE<span class="op">(</span>is_called<span class="op">);</span>  <span class="co">// uaのデストラクタは呼ばれていない</span></span>
<span id="cb477-12"><a href="#cb477-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb477-13"><a href="#cb477-13" aria-hidden="true" tabindex="-1"></a>        ASSERT_TRUE<span class="op">(</span>is_called<span class="op">);</span>  <span class="co">// uaのデストラクタは呼ばれた</span></span>
<span id="cb477-14"><a href="#cb477-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>次に示すのは、
std::unique_ptrの第2パラメータに関数型オブジェクトの型(std::function)を与えた例である。</p>
<div class="sourceCode" id="cb478"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb478-1"><a href="#cb478-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/func_type_ut.cpp 64</span></span>
<span id="cb478-2"><a href="#cb478-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb478-3"><a href="#cb478-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span>  <span class="co">// 第2パラメータにstd::function型オブジェクトを与える</span></span>
<span id="cb478-4"><a href="#cb478-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> is_called <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb478-5"><a href="#cb478-5" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb478-6"><a href="#cb478-6" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> delete_obj <span class="op">=</span> <span class="bu">std::</span>function<span class="op">&lt;</span><span class="dt">void</span><span class="op">(</span>A<span class="op">*)&gt;{[](</span>A<span class="op">*</span> a<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="kw">delete</span> a<span class="op">;</span> <span class="op">}};</span></span>
<span id="cb478-7"><a href="#cb478-7" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> ua <span class="op">=</span> <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>A<span class="op">,</span> <span class="bu">std::</span>function<span class="op">&lt;</span><span class="dt">void</span><span class="op">(</span>A<span class="op">*)&gt;&amp;&gt;{</span><span class="kw">new</span> A<span class="op">{</span>is_called<span class="op">},</span> delete_obj<span class="op">};</span></span>
<span id="cb478-8"><a href="#cb478-8" aria-hidden="true" tabindex="-1"></a>            ASSERT_FALSE<span class="op">(</span>is_called<span class="op">);</span>  <span class="co">// uaのデストラクタは呼ばれていない</span></span>
<span id="cb478-9"><a href="#cb478-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb478-10"><a href="#cb478-10" aria-hidden="true" tabindex="-1"></a>        ASSERT_TRUE<span class="op">(</span>is_called<span class="op">);</span>  <span class="co">// uaのデストラクタは呼ばれた</span></span>
<span id="cb478-11"><a href="#cb478-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>以上で見てきたようにstd::unique_ptrの第2パラメータには、
第1パラメータのポインタを引数に取る関数型であれば指定できる。</p>
<p>このようなテンプレートパラメータを持つクラステンプレートの実装例を示すため、
「<a href="#SS_2_9">RAII(scoped
guard)</a>でも示したScopedGuardの実装を下記する。</p>
<p>やや意外だが、このようなテンプレートパラメータに特別な記法はなく、以下のようにすれば良い。</p>
<div class="sourceCode" id="cb479"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb479-1"><a href="#cb479-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ h/scoped_guard.h 4</span></span>
<span id="cb479-2"><a href="#cb479-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb479-3"><a href="#cb479-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@class</span><span class="co"> </span><span class="cv">ScopedGuard</span></span>
<span id="cb479-4"><a href="#cb479-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@brief</span><span class="co"> RAIIのためのクラス。</span></span>
<span id="cb479-5"><a href="#cb479-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">///        コンストラクタ引数の関数オブジェクトをデストラクタから呼び出す。</span></span>
<span id="cb479-6"><a href="#cb479-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> F<span class="op">&gt;</span></span>
<span id="cb479-7"><a href="#cb479-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> ScopedGuard <span class="op">{</span></span>
<span id="cb479-8"><a href="#cb479-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb479-9"><a href="#cb479-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> ScopedGuard<span class="op">(</span>F<span class="op">&amp;&amp;</span> f<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">:</span> <span class="va">f_</span><span class="op">{</span>f<span class="op">}</span></span>
<span id="cb479-10"><a href="#cb479-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb479-11"><a href="#cb479-11" aria-hidden="true" tabindex="-1"></a>            <span class="co">// f()がill-formedにならず、その戻りがvoidでなければならない</span></span>
<span id="cb479-12"><a href="#cb479-12" aria-hidden="true" tabindex="-1"></a>            <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_invocable_r_v<span class="op">&lt;</span><span class="dt">void</span><span class="op">,</span> F<span class="op">&gt;,</span> <span class="st">&quot;F must be callable and return void&quot;</span><span class="op">);</span></span>
<span id="cb479-13"><a href="#cb479-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb479-14"><a href="#cb479-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb479-15"><a href="#cb479-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">~</span>ScopedGuard<span class="op">()</span> <span class="op">{</span> <span class="va">f_</span><span class="op">();</span> <span class="op">}</span></span>
<span id="cb479-16"><a href="#cb479-16" aria-hidden="true" tabindex="-1"></a>        ScopedGuard<span class="op">(</span>ScopedGuard <span class="at">const</span><span class="op">&amp;)</span>            <span class="op">=</span> <span class="kw">delete</span><span class="op">;</span>  <span class="co">// copyは禁止</span></span>
<span id="cb479-17"><a href="#cb479-17" aria-hidden="true" tabindex="-1"></a>        ScopedGuard<span class="op">&amp;</span> <span class="kw">operator</span><span class="op">=(</span>ScopedGuard <span class="at">const</span><span class="op">&amp;)</span> <span class="op">=</span> <span class="kw">delete</span><span class="op">;</span>  <span class="co">// copyは禁止</span></span>
<span id="cb479-18"><a href="#cb479-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb479-19"><a href="#cb479-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb479-20"><a href="#cb479-20" aria-hidden="true" tabindex="-1"></a>        F <span class="va">f_</span><span class="op">;</span></span>
<span id="cb479-21"><a href="#cb479-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>上記コードの抜粋である下記は、テンプレートパラメータである関数型を規定するものである。</p>
<div class="sourceCode" id="cb480"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb480-1"><a href="#cb480-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ h/scoped_guard.h 15</span></span>
<span id="cb480-2"><a href="#cb480-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb480-3"><a href="#cb480-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// f()がill-formedにならず、その戻りがvoidでなければならない</span></span>
<span id="cb480-4"><a href="#cb480-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_invocable_r_v<span class="op">&lt;</span><span class="dt">void</span><span class="op">,</span> F<span class="op">&gt;,</span> <span class="st">&quot;F must be callable and return void&quot;</span><span class="op">);</span></span></code></pre></div>
<p>これがなければ、誤った型の関数型をテンプレートパラメータに指定できてしまう。</p>
<p>以下にこのクラステンプレートの単体テストを示す。</p>
<p>まずは、以下の関数と静的変数の組み合わせ</p>
<div class="sourceCode" id="cb481"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb481-1"><a href="#cb481-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/func_type_ut.cpp 80</span></span>
<span id="cb481-2"><a href="#cb481-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb481-3"><a href="#cb481-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bool</span> is_caleded_in_static<span class="op">{</span><span class="kw">false</span><span class="op">};</span></span>
<span id="cb481-4"><a href="#cb481-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> caleded_by_destructor<span class="op">()</span> <span class="kw">noexcept</span> <span class="op">{</span> is_caleded_in_static <span class="op">=</span> <span class="kw">true</span><span class="op">;</span> <span class="op">}</span></span></code></pre></div>
<p>を使った例である。</p>
<div class="sourceCode" id="cb482"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb482-1"><a href="#cb482-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/func_type_ut.cpp 88</span></span>
<span id="cb482-2"><a href="#cb482-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb482-3"><a href="#cb482-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span>  <span class="co">// Fに関数ポインタを与える</span></span>
<span id="cb482-4"><a href="#cb482-4" aria-hidden="true" tabindex="-1"></a>        is_caleded_in_static <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb482-5"><a href="#cb482-5" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb482-6"><a href="#cb482-6" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> sg <span class="op">=</span> ScopedGuard<span class="op">{&amp;</span>caleded_by_destructor<span class="op">};</span></span>
<span id="cb482-7"><a href="#cb482-7" aria-hidden="true" tabindex="-1"></a>            ASSERT_FALSE<span class="op">(</span>is_caleded_in_static<span class="op">);</span>  <span class="co">// sgのデストラクタは呼ばれていない</span></span>
<span id="cb482-8"><a href="#cb482-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb482-9"><a href="#cb482-9" aria-hidden="true" tabindex="-1"></a>        ASSERT_TRUE<span class="op">(</span>is_caleded_in_static<span class="op">);</span>  <span class="co">// sgのデストラクタは呼ばれた</span></span>
<span id="cb482-10"><a href="#cb482-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>次に示すのは、それぞれにラムダ式とstd::functionを使った2例である。</p>
<div class="sourceCode" id="cb483"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb483-1"><a href="#cb483-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/func_type_ut.cpp 103</span></span>
<span id="cb483-2"><a href="#cb483-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb483-3"><a href="#cb483-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span>  <span class="co">// Fにラムダ式を与える</span></span>
<span id="cb483-4"><a href="#cb483-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> is_called <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb483-5"><a href="#cb483-5" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb483-6"><a href="#cb483-6" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> gs <span class="op">=</span> ScopedGuard<span class="op">{[&amp;</span>is_called<span class="op">]()</span> <span class="kw">noexcept</span> <span class="op">{</span> is_called <span class="op">=</span> <span class="kw">true</span><span class="op">;</span> <span class="op">}};</span></span>
<span id="cb483-7"><a href="#cb483-7" aria-hidden="true" tabindex="-1"></a>            ASSERT_FALSE<span class="op">(</span>is_called<span class="op">);</span>  <span class="co">// sgのデストラクタは呼ばれていない</span></span>
<span id="cb483-8"><a href="#cb483-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb483-9"><a href="#cb483-9" aria-hidden="true" tabindex="-1"></a>        ASSERT_TRUE<span class="op">(</span>is_called<span class="op">);</span>  <span class="co">// sgのデストラクタは呼ばれた</span></span>
<span id="cb483-10"><a href="#cb483-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb483-11"><a href="#cb483-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span>  <span class="co">// Fにstd::function型オブジェクトを与える</span></span>
<span id="cb483-12"><a href="#cb483-12" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> is_called <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb483-13"><a href="#cb483-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb483-14"><a href="#cb483-14" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> f  <span class="op">=</span> <span class="bu">std::</span>function<span class="op">&lt;</span><span class="dt">void</span><span class="op">(</span><span class="dt">void</span><span class="op">)&gt;{[&amp;</span>is_called<span class="op">]()</span> <span class="kw">noexcept</span> <span class="op">{</span> is_called <span class="op">=</span> <span class="kw">true</span><span class="op">;</span> <span class="op">}};</span></span>
<span id="cb483-15"><a href="#cb483-15" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> gs <span class="op">=</span> ScopedGuard<span class="op">{</span><span class="bu">std::</span>move<span class="op">(</span>f<span class="op">)};</span>  <span class="co">// sgのデストラクタは呼ばれていない</span></span>
<span id="cb483-16"><a href="#cb483-16" aria-hidden="true" tabindex="-1"></a>            ASSERT_FALSE<span class="op">(</span>is_called<span class="op">);</span>              <span class="co">// sgのデストラクタは呼ばれた</span></span>
<span id="cb483-17"><a href="#cb483-17" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb483-18"><a href="#cb483-18" aria-hidden="true" tabindex="-1"></a>        ASSERT_TRUE<span class="op">(</span>is_called<span class="op">);</span></span>
<span id="cb483-19"><a href="#cb483-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>次に示すのは関数型オブジェクト</p>
<div class="sourceCode" id="cb484"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb484-1"><a href="#cb484-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/func_type_ut.cpp 125</span></span>
<span id="cb484-2"><a href="#cb484-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb484-3"><a href="#cb484-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> TestFunctor <span class="op">{</span></span>
<span id="cb484-4"><a href="#cb484-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> TestFunctor<span class="op">(</span><span class="dt">bool</span><span class="op">&amp;</span> is_called<span class="op">)</span> <span class="op">:</span> <span class="va">is_called_</span><span class="op">{</span>is_called<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb484-5"><a href="#cb484-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span>  <span class="kw">operator</span><span class="op">()()</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="va">is_called_</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb484-6"><a href="#cb484-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">bool</span><span class="op">&amp;</span> <span class="va">is_called_</span><span class="op">;</span></span>
<span id="cb484-7"><a href="#cb484-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>を使った例である。</p>
<div class="sourceCode" id="cb485"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb485-1"><a href="#cb485-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/func_type_ut.cpp 136</span></span>
<span id="cb485-2"><a href="#cb485-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb485-3"><a href="#cb485-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span>  <span class="co">// Fに関数型オブジェクトを与える</span></span>
<span id="cb485-4"><a href="#cb485-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> is_called <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb485-5"><a href="#cb485-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> tf        <span class="op">=</span> TestFunctor<span class="op">{</span>is_called<span class="op">};</span></span>
<span id="cb485-6"><a href="#cb485-6" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb485-7"><a href="#cb485-7" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> sg <span class="op">=</span> ScopedGuard<span class="op">{</span><span class="bu">std::</span>move<span class="op">(</span>tf<span class="op">)};</span>  <span class="co">// C++17以降の記法</span></span>
<span id="cb485-8"><a href="#cb485-8" aria-hidden="true" tabindex="-1"></a>            ASSERT_FALSE<span class="op">(</span>is_called<span class="op">);</span>  <span class="co">// sgのデストラクタは呼ばれていない</span></span>
<span id="cb485-9"><a href="#cb485-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb485-10"><a href="#cb485-10" aria-hidden="true" tabindex="-1"></a>        ASSERT_TRUE<span class="op">(</span>is_called<span class="op">);</span>  <span class="co">// sgのデストラクタは呼ばれた</span></span>
<span id="cb485-11"><a href="#cb485-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>C++17からサポートされた「クラステンプレートのテンプレートパラメータ推論」が使えないC++14以前では、
下記に示すようにScopedGuardのテンプレートラメータ型を指定しなければならない煩雑さがある。</p>
<div class="sourceCode" id="cb486"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb486-1"><a href="#cb486-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/func_type_ut.cpp 148</span></span>
<span id="cb486-2"><a href="#cb486-2" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span>  <span class="co">// Fに関数型オブジェクトを与える</span></span>
<span id="cb486-3"><a href="#cb486-3" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> is_called <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb486-4"><a href="#cb486-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> tf        <span class="op">=</span> TestFunctor<span class="op">{</span>is_called<span class="op">};</span></span>
<span id="cb486-5"><a href="#cb486-5" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb486-6"><a href="#cb486-6" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> sg <span class="op">=</span> ScopedGuard<span class="op">&lt;</span>TestFunctor<span class="op">&gt;{</span><span class="bu">std::</span>move<span class="op">(</span>tf<span class="op">)};</span>  <span class="co">// C++14以前の記法</span></span>
<span id="cb486-7"><a href="#cb486-7" aria-hidden="true" tabindex="-1"></a>            ASSERT_FALSE<span class="op">(</span>is_called<span class="op">);</span>  <span class="co">// sgのデストラクタは呼ばれていない</span></span>
<span id="cb486-8"><a href="#cb486-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb486-9"><a href="#cb486-9" aria-hidden="true" tabindex="-1"></a>        ASSERT_TRUE<span class="op">(</span>is_called<span class="op">);</span>  <span class="co">// sgのデストラクタは呼ばれた</span></span>
<span id="cb486-10"><a href="#cb486-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>これを回避するためには下記のような関数テンプレートを用意すればよい。</p>
<div class="sourceCode" id="cb487"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb487-1"><a href="#cb487-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/func_type_ut.cpp 161</span></span>
<span id="cb487-2"><a href="#cb487-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-3"><a href="#cb487-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> F<span class="op">&gt;</span></span>
<span id="cb487-4"><a href="#cb487-4" aria-hidden="true" tabindex="-1"></a>    ScopedGuard<span class="op">&lt;</span>F<span class="op">&gt;</span> MakeScopedGuard<span class="op">(</span>F<span class="op">&amp;&amp;</span> f<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb487-5"><a href="#cb487-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb487-6"><a href="#cb487-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> ScopedGuard<span class="op">&lt;</span>F<span class="op">&gt;(</span><span class="bu">std::</span>move<span class="op">(</span>f<span class="op">));</span></span>
<span id="cb487-7"><a href="#cb487-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>下記に示した単体テストから明らかな通り、関数テンプレートの型推測の機能により、
テンプレートパラメータを指定する必要がなくなる。</p>
<div class="sourceCode" id="cb488"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb488-1"><a href="#cb488-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/func_type_ut.cpp 172</span></span>
<span id="cb488-2"><a href="#cb488-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb488-3"><a href="#cb488-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span>  <span class="co">// Fに関数ポインタを与える</span></span>
<span id="cb488-4"><a href="#cb488-4" aria-hidden="true" tabindex="-1"></a>        is_caleded_in_static <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb488-5"><a href="#cb488-5" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb488-6"><a href="#cb488-6" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> sg <span class="op">=</span> MakeScopedGuard<span class="op">(&amp;</span>caleded_by_destructor<span class="op">);</span></span>
<span id="cb488-7"><a href="#cb488-7" aria-hidden="true" tabindex="-1"></a>            ASSERT_FALSE<span class="op">(</span>is_caleded_in_static<span class="op">);</span>  <span class="co">// sgのデストラクタは呼ばれていない</span></span>
<span id="cb488-8"><a href="#cb488-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb488-9"><a href="#cb488-9" aria-hidden="true" tabindex="-1"></a>        ASSERT_TRUE<span class="op">(</span>is_caleded_in_static<span class="op">);</span>  <span class="co">// sgのデストラクタは呼ばれた</span></span>
<span id="cb488-10"><a href="#cb488-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb488-11"><a href="#cb488-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span>  <span class="co">// Fにラムダ式を与える</span></span>
<span id="cb488-12"><a href="#cb488-12" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> is_called <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb488-13"><a href="#cb488-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb488-14"><a href="#cb488-14" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> sg <span class="op">=</span> MakeScopedGuard<span class="op">([&amp;</span>is_called<span class="op">]()</span> <span class="kw">noexcept</span> <span class="op">{</span> is_called <span class="op">=</span> <span class="kw">true</span><span class="op">;</span> <span class="op">});</span></span>
<span id="cb488-15"><a href="#cb488-15" aria-hidden="true" tabindex="-1"></a>            ASSERT_FALSE<span class="op">(</span>is_called<span class="op">);</span>  <span class="co">// sgのデストラクタは呼ばれていない</span></span>
<span id="cb488-16"><a href="#cb488-16" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb488-17"><a href="#cb488-17" aria-hidden="true" tabindex="-1"></a>        ASSERT_TRUE<span class="op">(</span>is_called<span class="op">);</span>  <span class="co">// sgのデストラクタは呼ばれた</span></span>
<span id="cb488-18"><a href="#cb488-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb488-19"><a href="#cb488-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span>  <span class="co">// Fにstd::function型オブジェクトを与える</span></span>
<span id="cb488-20"><a href="#cb488-20" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> is_called <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb488-21"><a href="#cb488-21" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb488-22"><a href="#cb488-22" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> f  <span class="op">=</span> <span class="bu">std::</span>function<span class="op">&lt;</span><span class="dt">void</span><span class="op">(</span><span class="dt">void</span><span class="op">)&gt;{[&amp;</span>is_called<span class="op">]()</span> <span class="kw">noexcept</span> <span class="op">{</span> is_called <span class="op">=</span> <span class="kw">true</span><span class="op">;</span> <span class="op">}};</span></span>
<span id="cb488-23"><a href="#cb488-23" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> sg <span class="op">=</span> MakeScopedGuard<span class="op">(</span><span class="bu">std::</span>move<span class="op">(</span>f<span class="op">));</span></span>
<span id="cb488-24"><a href="#cb488-24" aria-hidden="true" tabindex="-1"></a>            ASSERT_FALSE<span class="op">(</span>is_called<span class="op">);</span>  <span class="co">// sgのデストラクタは呼ばれていない</span></span>
<span id="cb488-25"><a href="#cb488-25" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb488-26"><a href="#cb488-26" aria-hidden="true" tabindex="-1"></a>        ASSERT_TRUE<span class="op">(</span>is_called<span class="op">);</span>  <span class="co">// sgのデストラクタは呼ばれた</span></span>
<span id="cb488-27"><a href="#cb488-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb488-28"><a href="#cb488-28" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span>  <span class="co">// Fに関数型オブジェクトを与える</span></span>
<span id="cb488-29"><a href="#cb488-29" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> is_called <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb488-30"><a href="#cb488-30" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> tf        <span class="op">=</span> TestFunctor<span class="op">{</span>is_called<span class="op">};</span></span>
<span id="cb488-31"><a href="#cb488-31" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb488-32"><a href="#cb488-32" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> sg <span class="op">=</span> MakeScopedGuard<span class="op">(</span><span class="bu">std::</span>ref<span class="op">(</span>tf<span class="op">));</span>  <span class="co">// std::refが必要</span></span>
<span id="cb488-33"><a href="#cb488-33" aria-hidden="true" tabindex="-1"></a>            ASSERT_FALSE<span class="op">(</span>is_called<span class="op">);</span>  <span class="co">// sgのデストラクタは呼ばれていない</span></span>
<span id="cb488-34"><a href="#cb488-34" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb488-35"><a href="#cb488-35" aria-hidden="true" tabindex="-1"></a>        ASSERT_TRUE<span class="op">(</span>is_called<span class="op">);</span>  <span class="co">// sgのデストラクタは呼ばれた</span></span>
<span id="cb488-36"><a href="#cb488-36" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>このような便利なテンプレートは、Nstdのようなライブラリで定義、宣言し、
ソースコード全域からアクセスできるようにするとプロジェクトの開発効率が少しだけ高まる。</p>
<h2 id="注意点まとめ">注意点まとめ <a id="SS_3_7"></a></h2>
<p>本章では、テンプレートメタプログラミングのテクニックや注意点について解説したが、
本章の情報量は多く、また他の章で行ったものもあるため以下にそれらをまとめる。</p>
<ul>
<li><p><a href="#SS_5_4_2">name
lookup</a>には複雑なルールが適用されるため、非直感的なバインドが行われる場合がある。
従って、テンプレートライブラリの開発には単体テストは必須である。</p></li>
<li><p>使用しているコンパイラが<a href="#SS_5_4_3">two phase name
lookup</a>をサポートしているか否かに気を付ける。
それがオプションである場合は、two phase name
lookupを活性化させる。</p></li>
<li><p>関数型マクロはそれ以外に実装方法がない時のみに使用する
。</p></li>
<li><p>可変長引数を持つ関数の実装には<a
href="#SS_3_1_3">パラメータパック</a>を使う。</p></li>
<li><p>処理速度や関数のリターンの型に影響する場合があるため、
パラメータパックの処理の順番に気を付ける(「<a
href="#SS_3_1_3_2">前から演算するパラメータパック</a>」参照)。</p></li>
<li><p><a
href="#SS_5_4_5">ADL</a>を利用しない場合、テンプレートで使う識別子は名前空間名やthis-&gt;等で修飾する
(「<a href="#SS_3_6_5">意図しないname lookupの防止</a>」参照)。</p></li>
<li><p>テンプレートのインターフェースではないが、実装の都合上ヘッダファイルに記述する定義は、
“namespace Inner_”を使用し、非公開であることを明示する。
また、“namespace
Inner_”で宣言、定義されている宣言、定義は単体テストを除き、
外部から参照しない(「<a
href="#SS_3_3_2_3">is_void_sfinae_fの実装</a>」参照)。</p></li>
<li><p>ユニバーサルリファレンスの実際の型がlvalueリファレンスであるならば、
constなlvalueリファレンスとして扱う 。</p></li>
<li><p>ユニバーサルリファレンス引数を他の関数に渡すのであれば、std::forwardを使う
(「<a href="#SS_5_6_1">ユニバーサルリファレンス</a>」、「<a
href="#SS_3_6_1">ユニバーサルリファレンスとstd::forward</a>」参照)。</p></li>
<li><p>関数テンプレートとその特殊化はソースコード上なるべく近い位置で定義する
(「<a href="#SS_5_4_3">two phase name lookup</a>」参照)。</p></li>
<li><p><a href="#SS_5_4_3">two phase name
lookup</a>により意図しない副作用が発生する可能性があるため、
STLが特殊化を想定しているstd::hash等を除き、STLの拡張は行わない。</p></li>
<li><p>ユーザが定義するテンプレートは適切に定義された名前空間内で定義する
。</p></li>
<li><p>型とその2項演算子オーバーロードは同じ名前空間で定義する (「<a
href="#SS_5_4_3">two phase name lookup</a>」参照)。</p></li>
<li><p>関数テンプレートのオーバーロードと特殊化の<a
href="#SS_5_4_2">name lookup</a>の優先度に気を付ける。
オーバーロードのベストマッチ選択後に特殊化された関数テンプレートがname
lookupの対象になるため、
下記コードが示すように直感に反する関数が選択される場合がある。</p></li>
</ul>
<div class="sourceCode" id="cb489"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb489-1"><a href="#cb489-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/etc_ut.cpp 7</span></span>
<span id="cb489-2"><a href="#cb489-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb489-3"><a href="#cb489-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span> <span class="kw">constexpr</span> <span class="dt">int32_t</span> f<span class="op">(</span>T<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span> <span class="op">}</span>                   <span class="co">// f-0</span></span>
<span id="cb489-4"><a href="#cb489-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span> <span class="kw">constexpr</span> <span class="dt">int32_t</span> f<span class="op">(</span>T<span class="op">*)</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span> <span class="op">}</span>                  <span class="co">// f-1</span></span>
<span id="cb489-5"><a href="#cb489-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;&gt;</span>           <span class="kw">constexpr</span> <span class="dt">int32_t</span> f<span class="op">&lt;</span><span class="dt">int32_t</span><span class="op">*&gt;(</span><span class="dt">int32_t</span><span class="op">*)</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="dv">2</span><span class="op">;</span> <span class="op">}</span>  <span class="co">// f-2</span></span>
<span id="cb489-6"><a href="#cb489-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">// f-2はf-1の特殊化のように見えるが、T == int32_t*の場合のf-0の特殊化である。</span></span></code></pre></div>
<div class="sourceCode" id="cb490"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb490-1"><a href="#cb490-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/template/etc_ut.cpp 18</span></span>
<span id="cb490-2"><a href="#cb490-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb490-3"><a href="#cb490-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 以下、f-0/f-1/f-2のテスト</span></span>
<span id="cb490-4"><a href="#cb490-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> c   <span class="op">=</span> <span class="dt">char</span><span class="op">{</span><span class="dv">0</span><span class="op">};</span></span>
<span id="cb490-5"><a href="#cb490-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> i32 <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb490-6"><a href="#cb490-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb490-7"><a href="#cb490-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 以下はおそらく直感通り</span></span>
<span id="cb490-8"><a href="#cb490-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>f<span class="op">(</span><span class="dv">0</span><span class="op">)</span> <span class="op">==</span> <span class="dv">0</span><span class="op">);</span>               <span class="co">// f-0が呼ばれる</span></span>
<span id="cb490-9"><a href="#cb490-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>f<span class="op">(&amp;</span>c<span class="op">)</span> <span class="op">==</span> <span class="dv">1</span><span class="op">);</span>              <span class="co">// f-1が呼ばれる</span></span>
<span id="cb490-10"><a href="#cb490-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>f<span class="op">&lt;</span><span class="dt">int32_t</span><span class="op">*&gt;(&amp;</span>i32<span class="op">)</span> <span class="op">==</span> <span class="dv">2</span><span class="op">);</span>  <span class="co">// f-2が呼ばれる</span></span>
<span id="cb490-11"><a href="#cb490-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb490-12"><a href="#cb490-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 以下はおそらく直感に反する</span></span>
<span id="cb490-13"><a href="#cb490-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>f<span class="op">(</span><span class="kw">nullptr</span><span class="op">)</span> <span class="op">==</span> <span class="dv">0</span><span class="op">);</span>  <span class="co">// f-1ではなく、f-0が呼ばれる</span></span>
<span id="cb490-14"><a href="#cb490-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>f<span class="op">(&amp;</span>i32<span class="op">)</span> <span class="op">==</span> <span class="dv">1</span><span class="op">);</span>     <span class="co">// f-2ではなく、f-1が呼ばれる</span></span></code></pre></div>
<ul>
<li><p>ユニバーサルリファレンスを持つ関数テンプレートをオーバーロードしない。
「<a
href="#SS_3_6_1">ユニバーサルリファレンスとstd::forward</a>」で述べたように、
ユニバーサルリファレンスはオーバーロードするためのものではなく、
lvalue、rvalue両方を受け取ることができる関数テンプレートを、
オーバーロードを使わずに実現するための記法である。</p></li>
<li><p>テンプレートに関数型オブジェクトを渡す場合、リファレンスの付け忘れに気を付ける
(「<a href="#SS_3_6_8">関数型をテンプレートパラメータで使う</a>」
参照)。</p></li>
<li><p>意図しないテンプレートパラメータによるインスタンス化の防止や、
コンパイルエラーを解読しやすくするために、 適切にstatic_assert(「<a
href="#SS_3_3_5_4">exists_begin/exsits_endの実装</a>」
参照)を使う。</p></li>
<li><p>ランタイム時の処理を削減する、static_assertを適切に用いる等の目的のために、
関数テンプレートには適切にconstexprを付けて宣言する (「<a
href="#SS_3_4_4">コンテナ用Nstd::operator&lt;&lt;の開発</a>」
参照)。</p></li>
</ul>
<!-- ./md/dynamic_memory_allocation.md -->
<h1
id="ダイナミックメモリアロケーション">ダイナミックメモリアロケーション
<a id="SS_4"></a></h1>
<p>本章で扱うダイナミックメモリアロケーションとは、new/delete、malloc/free
によるメモリ確保/解放のことである。</p>
<p>malloc/freeは、</p>
<ul>
<li>最長処理時間を規定できない(リアルタイム性の欠如)</li>
<li>メモリのフラグメントを起こす</li>
</ul>
<p>等の問題(「<a
href="#SS_4_1">malloc/freeの問題点</a>」参照)を持っている。
new/deleteは通常malloc/freeを使って実装されているため同じ問題を持っているが、
これらが汎用OS上でのアプリケーションで実際の不具合につながることはほとんどない。一方で、</p>
<ul>
<li>リアルタイムな応答が要求される</li>
<li>メモリの使用制限が厳しい(ページングと2次記憶がない)</li>
</ul>
<p>ような組み込みソフトでは、上記の2点は致命的な不具合につながる。</p>
<p>本章では、この問題を回避するための技法を紹介する。</p>
<h2 id="mallocfreeの問題点">malloc/freeの問題点 <a id="SS_4_1"></a></h2>
<p>UNIX系のOSでの典型的なmalloc/freeの実装例の一部を以下に示す
(この実装は長いため、全体は巻末の”<a
href="#SS_6_1_1">example/dynamic_memory_allocation/malloc_ut.cpp</a>“に掲載する)。</p>
<div class="sourceCode" id="cb491"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb491-1"><a href="#cb491-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/dynamic_memory_allocation/malloc_ut.cpp 19</span></span>
<span id="cb491-2"><a href="#cb491-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb491-3"><a href="#cb491-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> <span class="op">{</span></span>
<span id="cb491-4"><a href="#cb491-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb491-5"><a href="#cb491-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> <span class="dt">header_t</span> <span class="op">{</span></span>
<span id="cb491-6"><a href="#cb491-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">header_t</span><span class="op">*</span> next<span class="op">;</span></span>
<span id="cb491-7"><a href="#cb491-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">size_t</span>    n_nuits<span class="op">;</span>  <span class="co">// header_tが何個あるか</span></span>
<span id="cb491-8"><a href="#cb491-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb491-9"><a href="#cb491-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb491-10"><a href="#cb491-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">header_t</span><span class="op">*</span>        header<span class="op">{</span><span class="kw">nullptr</span><span class="op">};</span></span>
<span id="cb491-11"><a href="#cb491-11" aria-hidden="true" tabindex="-1"></a>    SpinLock         spin_lock<span class="op">{};</span></span>
<span id="cb491-12"><a href="#cb491-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">size_t</span> unit_size<span class="op">{</span><span class="kw">sizeof</span><span class="op">(</span><span class="dt">header_t</span><span class="op">)};</span></span>
<span id="cb491-13"><a href="#cb491-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb491-14"><a href="#cb491-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">inline</span> <span class="dt">bool</span> sprit<span class="op">(</span><span class="dt">header_t</span><span class="op">*</span> header<span class="op">,</span> <span class="dt">size_t</span> n_nuits<span class="op">,</span> <span class="dt">header_t</span><span class="op">*&amp;</span> next<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb491-15"><a href="#cb491-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb491-16"><a href="#cb491-16" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb491-17"><a href="#cb491-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb491-18"><a href="#cb491-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb491-19"><a href="#cb491-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">inline</span> <span class="dt">void</span> concat<span class="op">(</span><span class="dt">header_t</span><span class="op">*</span> front<span class="op">,</span> <span class="dt">header_t</span><span class="op">*</span> rear<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb491-20"><a href="#cb491-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb491-21"><a href="#cb491-21" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb491-22"><a href="#cb491-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb491-23"><a href="#cb491-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb491-24"><a href="#cb491-24" aria-hidden="true" tabindex="-1"></a>    <span class="dt">header_t</span><span class="op">*</span> set_back<span class="op">(</span><span class="dt">void</span><span class="op">*</span> mem<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="kw">static_cast</span><span class="op">&lt;</span><span class="dt">header_t</span><span class="op">*&gt;(</span>mem<span class="op">)</span> <span class="op">-</span> <span class="dv">1</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb491-25"><a href="#cb491-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb491-26"><a href="#cb491-26" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="kw">sizeof</span><span class="op">(</span><span class="dt">header_t</span><span class="op">)</span> <span class="op">==</span> <span class="kw">alignof</span><span class="op">(</span><span class="bu">std::</span>max_align_t<span class="op">));</span></span>
<span id="cb491-27"><a href="#cb491-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb491-28"><a href="#cb491-28" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span><span class="op">*</span> malloc_inner<span class="op">(</span><span class="dt">size_t</span> size<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb491-29"><a href="#cb491-29" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb491-30"><a href="#cb491-30" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb491-31"><a href="#cb491-31" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb491-32"><a href="#cb491-32" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace</span></span></code></pre></div>
<div class="sourceCode" id="cb492"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb492-1"><a href="#cb492-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/dynamic_memory_allocation/malloc_ut.cpp 105</span></span>
<span id="cb492-2"><a href="#cb492-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb492-3"><a href="#cb492-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> free<span class="op">(</span><span class="dt">void</span><span class="op">*</span> mem<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb492-4"><a href="#cb492-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb492-5"><a href="#cb492-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">header_t</span><span class="op">*</span> mem_to_free <span class="op">=</span> set_back<span class="op">(</span>mem<span class="op">);</span></span>
<span id="cb492-6"><a href="#cb492-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb492-7"><a href="#cb492-7" aria-hidden="true" tabindex="-1"></a>        mem_to_free<span class="op">-&gt;</span>next <span class="op">=</span> <span class="kw">nullptr</span><span class="op">;</span></span>
<span id="cb492-8"><a href="#cb492-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb492-9"><a href="#cb492-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> lock <span class="op">=</span> <span class="bu">std::</span>lock_guard<span class="op">{</span>spin_lock<span class="op">};</span></span>
<span id="cb492-10"><a href="#cb492-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb492-11"><a href="#cb492-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>header <span class="op">==</span> <span class="kw">nullptr</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb492-12"><a href="#cb492-12" aria-hidden="true" tabindex="-1"></a>            header <span class="op">=</span> mem_to_free<span class="op">;</span></span>
<span id="cb492-13"><a href="#cb492-13" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span><span class="op">;</span></span>
<span id="cb492-14"><a href="#cb492-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb492-15"><a href="#cb492-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb492-16"><a href="#cb492-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>mem_to_free <span class="op">&lt;</span> header<span class="op">)</span> <span class="op">{</span></span>
<span id="cb492-17"><a href="#cb492-17" aria-hidden="true" tabindex="-1"></a>            concat<span class="op">(</span>mem_to_free<span class="op">,</span> header<span class="op">);</span></span>
<span id="cb492-18"><a href="#cb492-18" aria-hidden="true" tabindex="-1"></a>            header <span class="op">=</span> mem_to_free<span class="op">;</span></span>
<span id="cb492-19"><a href="#cb492-19" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span><span class="op">;</span></span>
<span id="cb492-20"><a href="#cb492-20" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb492-21"><a href="#cb492-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb492-22"><a href="#cb492-22" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> curr <span class="op">=</span> header<span class="op">;</span></span>
<span id="cb492-23"><a href="#cb492-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(;</span> curr<span class="op">-&gt;</span>next <span class="op">!=</span> <span class="kw">nullptr</span><span class="op">;</span> curr <span class="op">=</span> curr<span class="op">-&gt;</span>next<span class="op">)</span> <span class="op">{</span></span>
<span id="cb492-24"><a href="#cb492-24" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>mem_to_free <span class="op">&lt;</span> curr<span class="op">-&gt;</span>next<span class="op">)</span> <span class="op">{</span>  <span class="co">// 常に curr &lt; mem_to_free</span></span>
<span id="cb492-25"><a href="#cb492-25" aria-hidden="true" tabindex="-1"></a>                concat<span class="op">(</span>mem_to_free<span class="op">,</span> curr<span class="op">-&gt;</span>next<span class="op">);</span></span>
<span id="cb492-26"><a href="#cb492-26" aria-hidden="true" tabindex="-1"></a>                concat<span class="op">(</span>curr<span class="op">,</span> mem_to_free<span class="op">);</span></span>
<span id="cb492-27"><a href="#cb492-27" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span><span class="op">;</span></span>
<span id="cb492-28"><a href="#cb492-28" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb492-29"><a href="#cb492-29" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb492-30"><a href="#cb492-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb492-31"><a href="#cb492-31" aria-hidden="true" tabindex="-1"></a>        concat<span class="op">(</span>curr<span class="op">,</span> mem_to_free<span class="op">);</span></span>
<span id="cb492-32"><a href="#cb492-32" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb492-33"><a href="#cb492-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb492-34"><a href="#cb492-34" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span><span class="op">*</span> malloc<span class="op">(</span><span class="dt">size_t</span> size<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb492-35"><a href="#cb492-35" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb492-36"><a href="#cb492-36" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span><span class="op">*</span> mem <span class="op">=</span> malloc_inner<span class="op">(</span>size<span class="op">);</span></span>
<span id="cb492-37"><a href="#cb492-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb492-38"><a href="#cb492-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>mem <span class="op">==</span> <span class="kw">nullptr</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb492-39"><a href="#cb492-39" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> <span class="at">const</span> add_size <span class="op">=</span> Roundup<span class="op">(</span>unit_size<span class="op">,</span> <span class="dv">1024</span> <span class="op">*</span> <span class="dv">1024</span> <span class="op">+</span> size<span class="op">);</span>  <span class="co">// 1MB追加</span></span>
<span id="cb492-40"><a href="#cb492-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb492-41"><a href="#cb492-41" aria-hidden="true" tabindex="-1"></a>            <span class="dt">header_t</span><span class="op">*</span> add <span class="op">=</span> <span class="kw">static_cast</span><span class="op">&lt;</span><span class="dt">header_t</span><span class="op">*&gt;(</span>sbrk<span class="op">(</span>add_size<span class="op">));</span></span>
<span id="cb492-42"><a href="#cb492-42" aria-hidden="true" tabindex="-1"></a>            add<span class="op">-&gt;</span>n_nuits  <span class="op">=</span> add_size <span class="op">/</span> unit_size<span class="op">;</span></span>
<span id="cb492-43"><a href="#cb492-43" aria-hidden="true" tabindex="-1"></a>            free<span class="op">(++</span>add<span class="op">);</span></span>
<span id="cb492-44"><a href="#cb492-44" aria-hidden="true" tabindex="-1"></a>            mem <span class="op">=</span> malloc_inner<span class="op">(</span>size<span class="op">);</span></span>
<span id="cb492-45"><a href="#cb492-45" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb492-46"><a href="#cb492-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb492-47"><a href="#cb492-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> mem<span class="op">;</span></span>
<span id="cb492-48"><a href="#cb492-48" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>上記で示したようにmalloc/freeで使用されるメモリはHeader_t型のheaderで管理され、
このアクセスの競合はspin_lockによって回避される。
headerが管理するメモリ用域からのメモリの切り出しはmalloc_innerによって行われるが、
下のフラグメントの説明でも示す通り、
headerで管理されたメモリは長さの上限が単純には決まらないリスト構造になるため、
このリストをなぞるmalloc/freeにリアルタイム性の保証をすることは困難である。</p>
<p>アプリケーションが実行する最初のmallocから呼び出されるmalloc_innerは、
headerがnullptrであるため必ずnullptrを返すことになる。</p>
<p>上記の抜粋である下記のコードによりmalloc_innerの戻りがnullptrであった場合、sbrkが呼び出される。</p>
<div class="sourceCode" id="cb493"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb493-1"><a href="#cb493-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/dynamic_memory_allocation/malloc_ut.cpp 148</span></span>
<span id="cb493-2"><a href="#cb493-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb493-3"><a href="#cb493-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>mem <span class="op">==</span> <span class="kw">nullptr</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb493-4"><a href="#cb493-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> <span class="at">const</span> add_size <span class="op">=</span> Roundup<span class="op">(</span>unit_size<span class="op">,</span> <span class="dv">1024</span> <span class="op">*</span> <span class="dv">1024</span> <span class="op">+</span> size<span class="op">);</span>  <span class="co">// 1MB追加</span></span>
<span id="cb493-5"><a href="#cb493-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb493-6"><a href="#cb493-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">header_t</span><span class="op">*</span> add <span class="op">=</span> <span class="kw">static_cast</span><span class="op">&lt;</span><span class="dt">header_t</span><span class="op">*&gt;(</span>sbrk<span class="op">(</span>add_size<span class="op">));</span></span>
<span id="cb493-7"><a href="#cb493-7" aria-hidden="true" tabindex="-1"></a>        add<span class="op">-&gt;</span>n_nuits  <span class="op">=</span> add_size <span class="op">/</span> unit_size<span class="op">;</span></span>
<span id="cb493-8"><a href="#cb493-8" aria-hidden="true" tabindex="-1"></a>        free<span class="op">(++</span>add<span class="op">);</span></span>
<span id="cb493-9"><a href="#cb493-9" aria-hidden="true" tabindex="-1"></a>        mem <span class="op">=</span> malloc_inner<span class="op">(</span>size<span class="op">);</span></span>
<span id="cb493-10"><a href="#cb493-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>sbrkとはOSからメモリを新たに取得するための下記のようなシステムコールである。</p>
<div class="sourceCode" id="cb494"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb494-1"><a href="#cb494-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/dynamic_memory_allocation/malloc_ut.cpp 13</span></span>
<span id="cb494-2"><a href="#cb494-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb494-3"><a href="#cb494-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">extern</span> <span class="st">&quot;C&quot;</span> <span class="dt">void</span><span class="op">*</span> sbrk<span class="op">(</span><span class="dt">ptrdiff_t</span> __incr<span class="op">);</span></span></code></pre></div>
<p>OSがアプリケーションに割り当てるための十分なメモリを持っていない場合、
sbrkは <a
href="https://ja.wikipedia.org/wiki/%E3%83%9A%E3%83%BC%E3%82%B8%E3%83%B3%E3%82%B0%E6%96%B9%E5%BC%8F">ページング</a>
によるメモリ確保のトリガーとなる。
これはOSのファイルシステムの動作を含む処理であるため、やはりリアルタイム性の保証は困難である。</p>
<p><a
href="#SS_5_10_20">フリースタンディング環境</a>では、sbrkのようなシステムコールは存在しないため、
アプリケーションの未使用領域や静的に確保した領域を上記コードで示したようなリスト構造で管理し、
mallocで使用することになる。
このような環境では、sbrkによるリアルタイム性の阻害は発生しないものの、
メモリ管理ためのリスト構造があるため、やはりリアルタイム性の保証は難しい。</p>
<p>次にもう一つの問題である「メモリのフラグメントを起こす」ことについて見て行く。</p>
<div class="sourceCode" id="cb495"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb495-1"><a href="#cb495-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/dynamic_memory_allocation/malloc_ut.cpp 190</span></span>
<span id="cb495-2"><a href="#cb495-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb495-3"><a href="#cb495-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span><span class="op">*</span> mem<span class="op">[</span><span class="dv">1024</span><span class="op">];</span></span>
<span id="cb495-4"><a href="#cb495-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb495-5"><a href="#cb495-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span><span class="op">&amp;</span> m <span class="op">:</span> mem<span class="op">)</span> <span class="op">{</span>  <span class="co">// 32バイト x 1024個のメモリ確保</span></span>
<span id="cb495-6"><a href="#cb495-6" aria-hidden="true" tabindex="-1"></a>        m <span class="op">=</span> malloc<span class="op">(</span><span class="dv">32</span><span class="op">);</span></span>
<span id="cb495-7"><a href="#cb495-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb495-8"><a href="#cb495-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb495-9"><a href="#cb495-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">// memを使用した何らかの処理</span></span>
<span id="cb495-10"><a href="#cb495-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span></span>
<span id="cb495-11"><a href="#cb495-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb495-12"><a href="#cb495-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> i <span class="op">=</span> <span class="dv">0</span><span class="bu">U</span><span class="op">;</span> i <span class="op">&lt;</span> ArrayLength<span class="op">(</span>mem<span class="op">);</span> i <span class="op">+=</span> <span class="dv">2</span><span class="op">)</span> <span class="op">{</span>  <span class="co">// 512個のメモリを解放</span></span>
<span id="cb495-13"><a href="#cb495-13" aria-hidden="true" tabindex="-1"></a>        free<span class="op">(</span>mem<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb495-14"><a href="#cb495-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>上記のような処理の後、解放されたメモリは、32バイト
(メモリヘッダがあるため、実際はもう少し大きい)の断片が512個ある状態になるため、
このサイズを超える新たなmallocの呼び出しには使えない。
このため、ページングが行えないようなOS上のアプリケーションでは、
メモリは十分にあるにもかかわらずmallocが失敗してしまうことが起こり得る。</p>
<p>また、上記freeの実装例の抜粋である下記のコードからわかるように、
このように断片化されたメモリは、そのアドレス順にソートされた単方向リストによって管理される。</p>
<div class="sourceCode" id="cb496"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb496-1"><a href="#cb496-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/dynamic_memory_allocation/malloc_ut.cpp 120</span></span>
<span id="cb496-2"><a href="#cb496-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb496-3"><a href="#cb496-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>mem_to_free <span class="op">&lt;</span> header<span class="op">)</span> <span class="op">{</span></span>
<span id="cb496-4"><a href="#cb496-4" aria-hidden="true" tabindex="-1"></a>        concat<span class="op">(</span>mem_to_free<span class="op">,</span> header<span class="op">);</span></span>
<span id="cb496-5"><a href="#cb496-5" aria-hidden="true" tabindex="-1"></a>        header <span class="op">=</span> mem_to_free<span class="op">;</span></span>
<span id="cb496-6"><a href="#cb496-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span><span class="op">;</span></span>
<span id="cb496-7"><a href="#cb496-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb496-8"><a href="#cb496-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb496-9"><a href="#cb496-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> curr <span class="op">=</span> header<span class="op">;</span></span>
<span id="cb496-10"><a href="#cb496-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(;</span> curr<span class="op">-&gt;</span>next <span class="op">!=</span> <span class="kw">nullptr</span><span class="op">;</span> curr <span class="op">=</span> curr<span class="op">-&gt;</span>next<span class="op">)</span> <span class="op">{</span></span>
<span id="cb496-11"><a href="#cb496-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>mem_to_free <span class="op">&lt;</span> curr<span class="op">-&gt;</span>next<span class="op">)</span> <span class="op">{</span>  <span class="co">// 常に curr &lt; mem_to_free</span></span>
<span id="cb496-12"><a href="#cb496-12" aria-hidden="true" tabindex="-1"></a>            concat<span class="op">(</span>mem_to_free<span class="op">,</span> curr<span class="op">-&gt;</span>next<span class="op">);</span></span>
<span id="cb496-13"><a href="#cb496-13" aria-hidden="true" tabindex="-1"></a>            concat<span class="op">(</span>curr<span class="op">,</span> mem_to_free<span class="op">);</span></span>
<span id="cb496-14"><a href="#cb496-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span><span class="op">;</span></span>
<span id="cb496-15"><a href="#cb496-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb496-16"><a href="#cb496-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb496-17"><a href="#cb496-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb496-18"><a href="#cb496-18" aria-hidden="true" tabindex="-1"></a>    concat<span class="op">(</span>curr<span class="op">,</span> mem_to_free<span class="op">);</span></span></code></pre></div>
<p>この状態でさらにメモリ解放が行われた場合、
freeはこのリストを辿りメモリを最適な場所に戻す必要がある。
戻したメモリがリスト前後のメモリと隣接していれば、それらは結合される。
この処理は断片化への対策であるが、
ページングの無いOS上のアプリケーションにとっては不十分であるばかりでなく、</p>
<ul>
<li>freeの排他ロックする期間が長い</li>
<li>freeの処理が遅い</li>
</ul>
<p>といったリアルタイム処理を阻害する別の問題も発生させる
(繰り返しになるが、windows/linuxのような通常のOS上のアプリケーションでは、
このような仕様が問題になることはほとんどない)。</p>
<h2
id="グローバルnewdeleteのオーバーロード">グローバルnew/deleteのオーバーロード
<a id="SS_4_2"></a></h2>
<p>すでに述べたように、組み込みソフトにはmalloc/freeを使用したnew/deleteは使えない可能性が高い。
そのような場合に備えC++11ではグローバルなnew/deleteのオーバーロードをサポートする。
ここでは、そのようなnew/deleteの実装例を示すが、
その前にnew/deleteの内部実装用メモリ管理用ライブラリを実装する。</p>
<h3 id="固定長メモリプール">固定長メモリプール
<a id="SS_4_2_1"></a></h3>
<p>malloc/freeにリアルタイム性がない原因は、</p>
<ul>
<li>リアルタイム性がないOSのシステムコールを使用している</li>
<li>メモリを可変長で管理しているため処理が重いにもかかわらず、この処理中にグローバルロックを行う。</li>
</ul>
<p>ためである。従って、この問題に対処するためのメモリ管理システムは、</p>
<ul>
<li>初期に静的なメモリを確保</li>
<li>メモリを固定長で管理</li>
</ul>
<p>する必要がある。これを含めこの章で開発するメモリ管理システムをメモリプールと呼ぶことにする。</p>
<p>「<a
href="#SS_4_2_2">グローバルnew/deleteのオーバーロードの実装</a>」で示すように、
このメモリプールは管理する固定長のメモリブロックのサイズごとに複数必要になる一方で、
これらを統合的に扱う必要も出てくる。</p>
<p>そのため、固定長のメモリプールは、</p>
<ul>
<li>複数個のメモリプールを統合的に扱う<a
href="#SS_5_1_13">インターフェースクラス</a>MPool</li>
<li>MPoolを基底クラスとし、固定長メモリブロックを管理するクラステンプレートMPoolFixed</li>
</ul>
<p>によって実装することにする。</p>
<p>まずは、MPoolを下記に示す (「<a
href="#SS_3_6_7_4">ファイル位置を静的に保持したエクセプションクラスの開発</a>」参照)。</p>
<div class="sourceCode" id="cb497"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb497-1"><a href="#cb497-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/dynamic_memory_allocation/mpool.h 12</span></span>
<span id="cb497-2"><a href="#cb497-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb497-3"><a href="#cb497-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> MPool <span class="op">{</span></span>
<span id="cb497-4"><a href="#cb497-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb497-5"><a href="#cb497-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> MPool<span class="op">(</span><span class="dt">size_t</span> max_size<span class="op">)</span> <span class="op">:</span> <span class="va">max_size_</span><span class="op">{</span>max_size<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb497-6"><a href="#cb497-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb497-7"><a href="#cb497-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span><span class="op">*</span> Alloc<span class="op">(</span><span class="dt">size_t</span> size<span class="op">)</span></span>
<span id="cb497-8"><a href="#cb497-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb497-9"><a href="#cb497-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>size <span class="op">&gt;</span> <span class="va">max_size_</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb497-10"><a href="#cb497-10" aria-hidden="true" tabindex="-1"></a>                <span class="cf">throw</span> MAKE_EXCEPTION<span class="op">(</span>MPoolBadAlloc<span class="op">,</span> <span class="st">&quot;MPF : memory size too big&quot;</span><span class="op">);</span></span>
<span id="cb497-11"><a href="#cb497-11" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb497-12"><a href="#cb497-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb497-13"><a href="#cb497-13" aria-hidden="true" tabindex="-1"></a>            <span class="dt">void</span><span class="op">*</span> mem <span class="op">=</span> alloc<span class="op">(</span>size<span class="op">);</span></span>
<span id="cb497-14"><a href="#cb497-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb497-15"><a href="#cb497-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>mem <span class="op">==</span> <span class="kw">nullptr</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb497-16"><a href="#cb497-16" aria-hidden="true" tabindex="-1"></a>                <span class="cf">throw</span> MAKE_EXCEPTION<span class="op">(</span>MPoolBadAlloc<span class="op">,</span> <span class="st">&quot;MPF : out of memory&quot;</span><span class="op">);</span></span>
<span id="cb497-17"><a href="#cb497-17" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb497-18"><a href="#cb497-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb497-19"><a href="#cb497-19" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> mem<span class="op">;</span></span>
<span id="cb497-20"><a href="#cb497-20" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb497-21"><a href="#cb497-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb497-22"><a href="#cb497-22" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span><span class="op">*</span> AllocNoExcept<span class="op">(</span><span class="dt">size_t</span> size<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> alloc<span class="op">(</span>size<span class="op">);</span> <span class="op">}</span></span>
<span id="cb497-23"><a href="#cb497-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb497-24"><a href="#cb497-24" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span>   Free<span class="op">(</span><span class="dt">void</span><span class="op">*</span> area<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span> free<span class="op">(</span>area<span class="op">);</span> <span class="op">}</span></span>
<span id="cb497-25"><a href="#cb497-25" aria-hidden="true" tabindex="-1"></a>        <span class="dt">size_t</span> GetSize<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> get_size<span class="op">();</span> <span class="op">}</span>  <span class="co">// メモリ最小単位</span></span>
<span id="cb497-26"><a href="#cb497-26" aria-hidden="true" tabindex="-1"></a>        <span class="dt">size_t</span> GetCount<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> get_count<span class="op">();</span> <span class="op">}</span>  <span class="co">// メモリ最小単位が何個取れるか</span></span>
<span id="cb497-27"><a href="#cb497-27" aria-hidden="true" tabindex="-1"></a>        <span class="dt">size_t</span> GetCountMin<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> get_count_min<span class="op">();</span> <span class="op">}</span>  <span class="co">// GetCount()の最小値</span></span>
<span id="cb497-28"><a href="#cb497-28" aria-hidden="true" tabindex="-1"></a>        <span class="dt">bool</span>   IsValid<span class="op">(</span><span class="dt">void</span> <span class="at">const</span><span class="op">*</span> area<span class="op">)</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> is_valid<span class="op">(</span>area<span class="op">);</span> <span class="op">}</span></span>
<span id="cb497-29"><a href="#cb497-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb497-30"><a href="#cb497-30" aria-hidden="true" tabindex="-1"></a>    <span class="kw">protected</span><span class="op">:</span></span>
<span id="cb497-31"><a href="#cb497-31" aria-hidden="true" tabindex="-1"></a>        <span class="op">~</span>MPool<span class="op">()</span> <span class="op">=</span> <span class="cf">default</span><span class="op">;</span></span>
<span id="cb497-32"><a href="#cb497-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb497-33"><a href="#cb497-33" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb497-34"><a href="#cb497-34" aria-hidden="true" tabindex="-1"></a>        <span class="dt">size_t</span> <span class="at">const</span> <span class="va">max_size_</span><span class="op">;</span></span>
<span id="cb497-35"><a href="#cb497-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb497-36"><a href="#cb497-36" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span><span class="op">*</span>  alloc<span class="op">(</span><span class="dt">size_t</span> size<span class="op">)</span> <span class="kw">noexcept</span>               <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb497-37"><a href="#cb497-37" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span>   free<span class="op">(</span><span class="dt">void</span><span class="op">*</span> area<span class="op">)</span> <span class="kw">noexcept</span>                 <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb497-38"><a href="#cb497-38" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">size_t</span> get_size<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span>                 <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb497-39"><a href="#cb497-39" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">size_t</span> get_count<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span>                <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb497-40"><a href="#cb497-40" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">size_t</span> get_count_min<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span>            <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb497-41"><a href="#cb497-41" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">bool</span>   is_valid<span class="op">(</span><span class="dt">void</span> <span class="at">const</span><span class="op">*</span> area<span class="op">)</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb497-42"><a href="#cb497-42" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>次に、MPoolFixedを下記に示す。</p>
<div class="sourceCode" id="cb498"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb498-1"><a href="#cb498-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/dynamic_memory_allocation/mpool_fixed.h 25</span></span>
<span id="cb498-2"><a href="#cb498-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb498-3"><a href="#cb498-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="dt">uint32_t</span> MEM_SIZE<span class="op">,</span> <span class="dt">uint32_t</span> MEM_COUNT<span class="op">&gt;</span></span>
<span id="cb498-4"><a href="#cb498-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> MPoolFixed <span class="kw">final</span> <span class="op">:</span> <span class="kw">public</span> MPool <span class="op">{</span></span>
<span id="cb498-5"><a href="#cb498-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb498-6"><a href="#cb498-6" aria-hidden="true" tabindex="-1"></a>        MPoolFixed<span class="op">()</span> <span class="kw">noexcept</span> <span class="op">:</span> MPool<span class="op">{</span><span class="va">mem_chunk_size_</span><span class="op">}</span> <span class="op">{}</span></span>
<span id="cb498-7"><a href="#cb498-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb498-8"><a href="#cb498-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb498-9"><a href="#cb498-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> <span class="dt">chunk_t</span> <span class="op">=</span> Inner_<span class="op">::</span>mem_chunk<span class="op">&lt;</span>MEM_SIZE<span class="op">&gt;;</span></span>
<span id="cb498-10"><a href="#cb498-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="kw">constexpr</span> <span class="dt">size_t</span> <span class="va">mem_chunk_size_</span><span class="op">{</span><span class="kw">sizeof</span><span class="op">(</span><span class="dt">chunk_t</span><span class="op">)};</span></span>
<span id="cb498-11"><a href="#cb498-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb498-12"><a href="#cb498-12" aria-hidden="true" tabindex="-1"></a>        <span class="dt">size_t</span>           <span class="va">mem_count_</span><span class="op">{</span>MEM_COUNT<span class="op">};</span></span>
<span id="cb498-13"><a href="#cb498-13" aria-hidden="true" tabindex="-1"></a>        <span class="dt">size_t</span>           <span class="va">mem_count_min_</span><span class="op">{</span>MEM_COUNT<span class="op">};</span></span>
<span id="cb498-14"><a href="#cb498-14" aria-hidden="true" tabindex="-1"></a>        <span class="dt">chunk_t</span>          <span class="va">mem_chunk_</span><span class="op">[</span>MEM_COUNT<span class="op">]{};</span></span>
<span id="cb498-15"><a href="#cb498-15" aria-hidden="true" tabindex="-1"></a>        <span class="dt">chunk_t</span><span class="op">*</span>         <span class="va">mem_head_</span><span class="op">{</span>setup_mem<span class="op">()};</span></span>
<span id="cb498-16"><a href="#cb498-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">mutable</span> SpinLock <span class="va">spin_lock_</span><span class="op">{};</span></span>
<span id="cb498-17"><a href="#cb498-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb498-18"><a href="#cb498-18" aria-hidden="true" tabindex="-1"></a>        <span class="dt">chunk_t</span><span class="op">*</span> setup_mem<span class="op">()</span> <span class="kw">noexcept</span></span>
<span id="cb498-19"><a href="#cb498-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb498-20"><a href="#cb498-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> i <span class="op">=</span> <span class="dv">0</span><span class="bu">U</span><span class="op">;</span> i <span class="op">&lt;</span> MEM_COUNT <span class="op">-</span> <span class="dv">1</span><span class="op">;</span> <span class="op">++</span>i<span class="op">)</span> <span class="op">{</span></span>
<span id="cb498-21"><a href="#cb498-21" aria-hidden="true" tabindex="-1"></a>                <span class="va">mem_chunk_</span><span class="op">[</span>i<span class="op">].</span>next <span class="op">=</span> <span class="op">&amp;</span><span class="va">mem_chunk_</span><span class="op">[</span>i <span class="op">+</span> <span class="dv">1</span><span class="op">];</span></span>
<span id="cb498-22"><a href="#cb498-22" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb498-23"><a href="#cb498-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb498-24"><a href="#cb498-24" aria-hidden="true" tabindex="-1"></a>            <span class="va">mem_chunk_</span><span class="op">[</span>MEM_COUNT <span class="op">-</span> <span class="dv">1</span><span class="op">].</span>next <span class="op">=</span> <span class="kw">nullptr</span><span class="op">;</span></span>
<span id="cb498-25"><a href="#cb498-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb498-26"><a href="#cb498-26" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">mem_chunk_</span><span class="op">;</span></span>
<span id="cb498-27"><a href="#cb498-27" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb498-28"><a href="#cb498-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb498-29"><a href="#cb498-29" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span><span class="op">*</span> alloc<span class="op">(</span><span class="dt">size_t</span> size<span class="op">)</span> <span class="kw">noexcept</span> <span class="kw">override</span></span>
<span id="cb498-30"><a href="#cb498-30" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb498-31"><a href="#cb498-31" aria-hidden="true" tabindex="-1"></a>            <span class="ot">assert</span><span class="op">(</span>size <span class="op">&lt;=</span> <span class="va">mem_chunk_size_</span><span class="op">);</span></span>
<span id="cb498-32"><a href="#cb498-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb498-33"><a href="#cb498-33" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> lock <span class="op">=</span> <span class="bu">std::</span>lock_guard<span class="op">{</span><span class="va">spin_lock_</span><span class="op">};</span></span>
<span id="cb498-34"><a href="#cb498-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb498-35"><a href="#cb498-35" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> mem <span class="op">=</span> <span class="va">mem_head_</span><span class="op">;</span></span>
<span id="cb498-36"><a href="#cb498-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb498-37"><a href="#cb498-37" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>mem <span class="op">!=</span> <span class="kw">nullptr</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb498-38"><a href="#cb498-38" aria-hidden="true" tabindex="-1"></a>                <span class="va">mem_head_</span>      <span class="op">=</span> <span class="va">mem_head_</span><span class="op">-&gt;</span>next<span class="op">;</span></span>
<span id="cb498-39"><a href="#cb498-39" aria-hidden="true" tabindex="-1"></a>                <span class="va">mem_count_min_</span> <span class="op">=</span> <span class="bu">std::</span>min<span class="op">(--</span><span class="va">mem_count_</span><span class="op">,</span> <span class="va">mem_count_min_</span><span class="op">);</span></span>
<span id="cb498-40"><a href="#cb498-40" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb498-41"><a href="#cb498-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb498-42"><a href="#cb498-42" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> mem<span class="op">;</span></span>
<span id="cb498-43"><a href="#cb498-43" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb498-44"><a href="#cb498-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb498-45"><a href="#cb498-45" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span> free<span class="op">(</span><span class="dt">void</span><span class="op">*</span> mem<span class="op">)</span> <span class="kw">noexcept</span> <span class="kw">override</span></span>
<span id="cb498-46"><a href="#cb498-46" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb498-47"><a href="#cb498-47" aria-hidden="true" tabindex="-1"></a>            <span class="ot">assert</span><span class="op">(</span>is_valid<span class="op">(</span>mem<span class="op">));</span></span>
<span id="cb498-48"><a href="#cb498-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb498-49"><a href="#cb498-49" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> lock <span class="op">=</span> <span class="bu">std::</span>lock_guard<span class="op">{</span><span class="va">spin_lock_</span><span class="op">};</span></span>
<span id="cb498-50"><a href="#cb498-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb498-51"><a href="#cb498-51" aria-hidden="true" tabindex="-1"></a>            <span class="dt">chunk_t</span><span class="op">*</span> curr_head <span class="op">=</span> <span class="kw">static_cast</span><span class="op">&lt;</span><span class="dt">chunk_t</span><span class="op">*&gt;(</span>mem<span class="op">);</span></span>
<span id="cb498-52"><a href="#cb498-52" aria-hidden="true" tabindex="-1"></a>            curr_head<span class="op">-&gt;</span>next    <span class="op">=</span> <span class="va">mem_head_</span><span class="op">;</span></span>
<span id="cb498-53"><a href="#cb498-53" aria-hidden="true" tabindex="-1"></a>            <span class="va">mem_head_</span>          <span class="op">=</span> curr_head<span class="op">;</span></span>
<span id="cb498-54"><a href="#cb498-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb498-55"><a href="#cb498-55" aria-hidden="true" tabindex="-1"></a>            <span class="va">mem_count_min_</span> <span class="op">=</span> <span class="bu">std::</span>min<span class="op">(++</span><span class="va">mem_count_</span><span class="op">,</span> <span class="va">mem_count_min_</span><span class="op">);</span></span>
<span id="cb498-56"><a href="#cb498-56" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb498-57"><a href="#cb498-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb498-58"><a href="#cb498-58" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">size_t</span> get_size<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="kw">override</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">mem_chunk_size_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb498-59"><a href="#cb498-59" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">size_t</span> get_count<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="kw">override</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">mem_count_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb498-60"><a href="#cb498-60" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">size_t</span> get_count_min<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="kw">override</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">mem_count_min_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb498-61"><a href="#cb498-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb498-62"><a href="#cb498-62" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">bool</span> is_valid<span class="op">(</span><span class="dt">void</span> <span class="at">const</span><span class="op">*</span> mem<span class="op">)</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="kw">override</span></span>
<span id="cb498-63"><a href="#cb498-63" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb498-64"><a href="#cb498-64" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="op">(&amp;</span><span class="va">mem_chunk_</span><span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">&lt;=</span> mem<span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="op">(</span>mem <span class="op">&lt;=</span> <span class="op">&amp;</span><span class="va">mem_chunk_</span><span class="op">[</span>MEM_COUNT <span class="op">-</span> <span class="dv">1</span><span class="op">]);</span></span>
<span id="cb498-65"><a href="#cb498-65" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb498-66"><a href="#cb498-66" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>上記コードからわかる通り、MPoolFixedは初期化直後、
サイズMEM_SIZのメモリブロックをMEM_COUNT個、保持する。
個々のメモリブロックは、下記のコードのalignas/alignofでアライメントされた領域となる。</p>
<div class="sourceCode" id="cb499"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb499-1"><a href="#cb499-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/dynamic_memory_allocation/mpool_fixed.h 11</span></span>
<span id="cb499-2"><a href="#cb499-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb499-3"><a href="#cb499-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">size_t</span> MPoolFixed_MinSize<span class="op">{</span><span class="dv">32</span><span class="op">};</span></span>
<span id="cb499-4"><a href="#cb499-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb499-5"><a href="#cb499-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> Inner_ <span class="op">{</span></span>
<span id="cb499-6"><a href="#cb499-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="dt">uint32_t</span> MEM_SIZE<span class="op">&gt;</span></span>
<span id="cb499-7"><a href="#cb499-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">union</span> mem_chunk <span class="op">{</span></span>
<span id="cb499-8"><a href="#cb499-8" aria-hidden="true" tabindex="-1"></a>        mem_chunk<span class="op">*</span> next<span class="op">;</span></span>
<span id="cb499-9"><a href="#cb499-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb499-10"><a href="#cb499-10" aria-hidden="true" tabindex="-1"></a>        <span class="co">// MPoolFixed_MinSizeの整数倍のエリアを、最大アラインメントが必要な基本型にアライン</span></span>
<span id="cb499-11"><a href="#cb499-11" aria-hidden="true" tabindex="-1"></a>        <span class="kw">alignas</span><span class="op">(</span><span class="kw">alignof</span><span class="op">(</span><span class="bu">std::</span>max_align_t<span class="op">))</span> <span class="dt">uint8_t</span> mem<span class="op">[</span>Roundup<span class="op">(</span>MPoolFixed_MinSize<span class="op">,</span> MEM_SIZE<span class="op">)];</span></span>
<span id="cb499-12"><a href="#cb499-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb499-13"><a href="#cb499-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace Inner_</span></span></code></pre></div>
<p>MPoolFixedに限らずメモリアロケータが返すメモリは、
どのようなアライメントにも対応できなければならないため、このようにする必要がある。</p>
<p>MPoolFixed::alloc/MPoolFixed::freeを見ればわかる通り、malloc/freeの実装に比べ格段にシンプルであり、
これによりリアルタイム性の保障は容易である。</p>
<p>なお、この実装ではmalloc/freeと同様に下記のSpinLockを使用したが、
このロックは、ラウンドロビンでスケジューリングされるスレッドの競合を防ぐためのものであり、
固定プライオリティでのスケジューリングが前提となるような組み込みソフトで使用した場合、
デッドロックを引き起こす可能性がある。
組み込みソフトでは、割り込みディセーブル/イネーブルを使ってロックすることを推奨する。</p>
<div class="sourceCode" id="cb500"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb500-1"><a href="#cb500-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/dynamic_memory_allocation/spin_lock.h 3</span></span>
<span id="cb500-2"><a href="#cb500-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb500-3"><a href="#cb500-3" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#include </span><span class="im">&lt;atomic&gt;</span></span>
<span id="cb500-4"><a href="#cb500-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb500-5"><a href="#cb500-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> SpinLock <span class="op">{</span></span>
<span id="cb500-6"><a href="#cb500-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb500-7"><a href="#cb500-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> lock<span class="op">()</span> <span class="kw">noexcept</span></span>
<span id="cb500-8"><a href="#cb500-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb500-9"><a href="#cb500-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">while</span> <span class="op">(</span><span class="va">state_</span><span class="op">.</span>exchange<span class="op">(</span>state<span class="op">::</span>locked<span class="op">,</span> <span class="bu">std::</span>memory_order_acquire<span class="op">)</span> <span class="op">==</span> state<span class="op">::</span>locked<span class="op">)</span> <span class="op">{</span></span>
<span id="cb500-10"><a href="#cb500-10" aria-hidden="true" tabindex="-1"></a>                <span class="op">;</span>  <span class="co">// busy wait</span></span>
<span id="cb500-11"><a href="#cb500-11" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb500-12"><a href="#cb500-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb500-13"><a href="#cb500-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb500-14"><a href="#cb500-14" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> unlock<span class="op">()</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="va">state_</span><span class="op">.</span>store<span class="op">(</span>state<span class="op">::</span>unlocked<span class="op">,</span> <span class="bu">std::</span>memory_order_release<span class="op">);</span> <span class="op">}</span></span>
<span id="cb500-15"><a href="#cb500-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb500-16"><a href="#cb500-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb500-17"><a href="#cb500-17" aria-hidden="true" tabindex="-1"></a>        <span class="kw">enum</span> <span class="kw">class</span> state <span class="op">{</span> locked<span class="op">,</span> unlocked <span class="op">};</span></span>
<span id="cb500-18"><a href="#cb500-18" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>atomic<span class="op">&lt;</span>state<span class="op">&gt;</span> <span class="va">state_</span><span class="op">{</span>state<span class="op">::</span>unlocked<span class="op">};</span></span>
<span id="cb500-19"><a href="#cb500-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>MPoolFixedの単体テストは、下記のようになる。</p>
<div class="sourceCode" id="cb501"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb501-1"><a href="#cb501-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/dynamic_memory_allocation/mpool_fixed_ut.cpp 10</span></span>
<span id="cb501-2"><a href="#cb501-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb501-3"><a href="#cb501-3" aria-hidden="true" tabindex="-1"></a>    Inner_<span class="op">::</span>mem_chunk<span class="op">&lt;</span><span class="dv">5</span><span class="op">&gt;</span> mc5<span class="op">[</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb501-4"><a href="#cb501-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="dv">32</span> <span class="op">==</span> <span class="kw">sizeof</span><span class="op">(</span>mc5<span class="op">[</span><span class="dv">0</span><span class="op">]));</span></span>
<span id="cb501-5"><a href="#cb501-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="dv">96</span> <span class="op">==</span> <span class="kw">sizeof</span><span class="op">(</span>mc5<span class="op">));</span></span>
<span id="cb501-6"><a href="#cb501-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb501-7"><a href="#cb501-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> mc33 <span class="op">=</span> Inner_<span class="op">::</span>mem_chunk<span class="op">&lt;</span><span class="dv">33</span><span class="op">&gt;{};</span></span>
<span id="cb501-8"><a href="#cb501-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="dv">64</span> <span class="op">==</span> <span class="kw">sizeof</span><span class="op">(</span>mc33<span class="op">));</span></span></code></pre></div>
<div class="sourceCode" id="cb502"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb502-1"><a href="#cb502-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/dynamic_memory_allocation/mpool_fixed_ut.cpp 106</span></span>
<span id="cb502-2"><a href="#cb502-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb502-3"><a href="#cb502-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> mpf <span class="op">=</span> MPoolFixed<span class="op">&lt;</span><span class="dv">33</span><span class="op">,</span> <span class="dv">2</span><span class="op">&gt;{};</span></span>
<span id="cb502-4"><a href="#cb502-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb502-5"><a href="#cb502-5" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">64</span><span class="op">,</span> mpf<span class="op">.</span>GetSize<span class="op">());</span></span>
<span id="cb502-6"><a href="#cb502-6" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">2</span><span class="op">,</span> mpf<span class="op">.</span>GetCount<span class="op">());</span></span>
<span id="cb502-7"><a href="#cb502-7" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">2</span><span class="op">,</span> mpf<span class="op">.</span>GetCountMin<span class="op">());</span></span>
<span id="cb502-8"><a href="#cb502-8" aria-hidden="true" tabindex="-1"></a>    ASSERT_FALSE<span class="op">(</span>mpf<span class="op">.</span>IsValid<span class="op">(&amp;</span>mpf<span class="op">));</span>  <span class="co">// mpfの管理外のアドレス</span></span>
<span id="cb502-9"><a href="#cb502-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb502-10"><a href="#cb502-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> m0 <span class="op">=</span> mpf<span class="op">.</span>Alloc<span class="op">(</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb502-11"><a href="#cb502-11" aria-hidden="true" tabindex="-1"></a>    ASSERT_TRUE<span class="op">(</span>mpf<span class="op">.</span>IsValid<span class="op">(</span>m0<span class="op">));</span>  <span class="co">// mpfの管理のアドレス</span></span>
<span id="cb502-12"><a href="#cb502-12" aria-hidden="true" tabindex="-1"></a>    ASSERT_NE<span class="op">(</span><span class="kw">nullptr</span><span class="op">,</span> m0<span class="op">);</span></span>
<span id="cb502-13"><a href="#cb502-13" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">1</span><span class="op">,</span> mpf<span class="op">.</span>GetCount<span class="op">());</span></span>
<span id="cb502-14"><a href="#cb502-14" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">1</span><span class="op">,</span> mpf<span class="op">.</span>GetCountMin<span class="op">());</span></span>
<span id="cb502-15"><a href="#cb502-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb502-16"><a href="#cb502-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> m1 <span class="op">=</span> mpf<span class="op">.</span>Alloc<span class="op">(</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb502-17"><a href="#cb502-17" aria-hidden="true" tabindex="-1"></a>    ASSERT_TRUE<span class="op">(</span>mpf<span class="op">.</span>IsValid<span class="op">(</span>m1<span class="op">));</span>  <span class="co">// mpfの管理のアドレス</span></span>
<span id="cb502-18"><a href="#cb502-18" aria-hidden="true" tabindex="-1"></a>    ASSERT_NE<span class="op">(</span><span class="kw">nullptr</span><span class="op">,</span> m1<span class="op">);</span></span>
<span id="cb502-19"><a href="#cb502-19" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">0</span><span class="op">,</span> mpf<span class="op">.</span>GetCount<span class="op">());</span></span>
<span id="cb502-20"><a href="#cb502-20" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">0</span><span class="op">,</span> mpf<span class="op">.</span>GetCountMin<span class="op">());</span></span>
<span id="cb502-21"><a href="#cb502-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb502-22"><a href="#cb502-22" aria-hidden="true" tabindex="-1"></a>    <span class="co">// mpfが空の場合のテスト</span></span>
<span id="cb502-23"><a href="#cb502-23" aria-hidden="true" tabindex="-1"></a>    ASSERT_THROW<span class="op">(</span>mpf<span class="op">.</span>Alloc<span class="op">(</span><span class="dv">1</span><span class="op">),</span> MPoolBadAlloc<span class="op">);</span>  <span class="co">// MPoolBadAlloc例外が発生するはず</span></span>
<span id="cb502-24"><a href="#cb502-24" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> m2 <span class="op">=</span> mpf<span class="op">.</span>AllocNoExcept<span class="op">(</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb502-25"><a href="#cb502-25" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="kw">nullptr</span><span class="op">,</span> m2<span class="op">);</span></span>
<span id="cb502-26"><a href="#cb502-26" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">0</span><span class="op">,</span> mpf<span class="op">.</span>GetCount<span class="op">());</span></span>
<span id="cb502-27"><a href="#cb502-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb502-28"><a href="#cb502-28" aria-hidden="true" tabindex="-1"></a>    mpf<span class="op">.</span>Free<span class="op">(</span>m0<span class="op">);</span></span>
<span id="cb502-29"><a href="#cb502-29" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">1</span><span class="op">,</span> mpf<span class="op">.</span>GetCount<span class="op">());</span></span>
<span id="cb502-30"><a href="#cb502-30" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">0</span><span class="op">,</span> mpf<span class="op">.</span>GetCountMin<span class="op">());</span></span>
<span id="cb502-31"><a href="#cb502-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb502-32"><a href="#cb502-32" aria-hidden="true" tabindex="-1"></a>    mpf<span class="op">.</span>Free<span class="op">(</span>m1<span class="op">);</span></span>
<span id="cb502-33"><a href="#cb502-33" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">2</span><span class="op">,</span> mpf<span class="op">.</span>GetCount<span class="op">());</span></span>
<span id="cb502-34"><a href="#cb502-34" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">0</span><span class="op">,</span> mpf<span class="op">.</span>GetCountMin<span class="op">());</span></span>
<span id="cb502-35"><a href="#cb502-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb502-36"><a href="#cb502-36" aria-hidden="true" tabindex="-1"></a>    ASSERT_THROW<span class="op">(</span>mpf<span class="op">.</span>Alloc<span class="op">(</span><span class="dv">65</span><span class="op">),</span> MPoolBadAlloc<span class="op">);</span>  <span class="co">// MPoolBadAlloc例外が発生するはず</span></span></code></pre></div>
<p>上記テストで使用したMPoolBadAllocは下記のように定義されたクラスであり
(「<a
href="#SS_3_6_7_4">ファイル位置を静的に保持したエクセプションクラスの開発</a>」参照)、</p>
<div class="sourceCode" id="cb503"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb503-1"><a href="#cb503-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/h/nstd_exception.h 10</span></span>
<span id="cb503-2"><a href="#cb503-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb503-3"><a href="#cb503-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@class</span><span class="co"> </span><span class="cv">Exception</span></span>
<span id="cb503-4"><a href="#cb503-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@brief</span><span class="co"> StaticString&lt;&gt;を使ったエクセプションクラス</span></span>
<span id="cb503-5"><a href="#cb503-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">///        下記のMAKE_EXCEPTIONを使い生成</span></span>
<span id="cb503-6"><a href="#cb503-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@tparam</span><span class="co"> </span><span class="cv">E</span><span class="co">   std::exceptionから派生したエクセプションクラス</span></span>
<span id="cb503-7"><a href="#cb503-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">/// </span><span class="an">@tparam</span><span class="co"> </span><span class="cv">N</span><span class="co">   StaticString</span><span class="kw">&lt;N&gt;</span></span>
<span id="cb503-8"><a href="#cb503-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">class</span> E<span class="op">,</span> <span class="dt">size_t</span> N<span class="op">&gt;</span></span>
<span id="cb503-9"><a href="#cb503-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Exception <span class="op">:</span> <span class="kw">public</span> E <span class="op">{</span></span>
<span id="cb503-10"><a href="#cb503-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb503-11"><a href="#cb503-11" aria-hidden="true" tabindex="-1"></a>        <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_base_of_v<span class="op">&lt;</span><span class="bu">std::</span>exception<span class="op">,</span> E<span class="op">&gt;);</span></span>
<span id="cb503-12"><a href="#cb503-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb503-13"><a href="#cb503-13" aria-hidden="true" tabindex="-1"></a>        Exception<span class="op">(</span>StaticString<span class="op">&lt;</span>N<span class="op">&gt;</span> <span class="at">const</span><span class="op">&amp;</span> what_str<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">:</span> <span class="va">what_str_</span><span class="op">{</span>what_str<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb503-14"><a href="#cb503-14" aria-hidden="true" tabindex="-1"></a>        <span class="dt">char</span> <span class="at">const</span><span class="op">*</span> what<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="kw">override</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">what_str_</span><span class="op">.</span>String<span class="op">();</span> <span class="op">}</span></span>
<span id="cb503-15"><a href="#cb503-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb503-16"><a href="#cb503-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb503-17"><a href="#cb503-17" aria-hidden="true" tabindex="-1"></a>        StaticString<span class="op">&lt;</span>N<span class="op">&gt;</span> <span class="at">const</span> <span class="va">what_str_</span><span class="op">;</span></span>
<span id="cb503-18"><a href="#cb503-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb503-19"><a href="#cb503-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb503-20"><a href="#cb503-20" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#define MAKE_EXCEPTION</span><span class="op">(</span>E__<span class="op">,</span><span class="pp"> </span><span class="va">msg__</span><span class="op">)</span><span class="pp"> </span>Nstd<span class="op">::</span>MakeException<span class="op">&lt;</span>E__<span class="op">,</span><span class="pp"> </span><span class="ot">__LINE__</span><span class="op">&gt;(</span><span class="ot">__FILE__</span><span class="op">,</span><span class="pp"> </span><span class="va">msg__</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb504"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb504-1"><a href="#cb504-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/dynamic_memory_allocation/mpool.h 7</span></span>
<span id="cb504-2"><a href="#cb504-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb504-3"><a href="#cb504-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> MPoolBadAlloc <span class="op">:</span> <span class="kw">public</span> <span class="bu">std::</span>bad_alloc<span class="op"> {</span>  <span class="co">// Nstd::Exceptionの基底クラス</span></span>
<span id="cb504-4"><a href="#cb504-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>MPoolから派生したクラスが、</p>
<ul>
<li>メモリブロックを保持していない状態でのMPool::alloc(size,
true)の呼び出し</li>
<li>MEM_SIZEを超えたsizeでのMPool::alloc(size, true)の呼び出し</li>
</ul>
<p>のような処理の継続ができない場合に用いるエクセプション用クラスである。</p>
<h3
id="グローバルnewdeleteのオーバーロードの実装">グローバルnew/deleteのオーバーロードの実装
<a id="SS_4_2_2"></a></h3>
<p><a href="#SS_4_2_1">固定長メモリプール</a>を使用したoperator
newのオーバーロードの実装例を以下に示す。</p>
<div class="sourceCode" id="cb505"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb505-1"><a href="#cb505-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/dynamic_memory_allocation/global_new_delete.cpp 31</span></span>
<span id="cb505-2"><a href="#cb505-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb505-3"><a href="#cb505-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> <span class="op">{</span></span>
<span id="cb505-4"><a href="#cb505-4" aria-hidden="true" tabindex="-1"></a>    MPool<span class="op">*</span> mpool_table<span class="op">[</span><span class="dv">32</span><span class="op">];</span></span>
<span id="cb505-5"><a href="#cb505-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb505-6"><a href="#cb505-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">// mainの前に呼ばれるため、mpool_tableを初期化するには下記のような方法が必要</span></span>
<span id="cb505-7"><a href="#cb505-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bool</span> is_setup<span class="op">{</span><span class="kw">false</span><span class="op">};</span></span>
<span id="cb505-8"><a href="#cb505-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb505-9"><a href="#cb505-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> setup<span class="op">()</span> <span class="kw">noexcept</span></span>
<span id="cb505-10"><a href="#cb505-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb505-11"><a href="#cb505-11" aria-hidden="true" tabindex="-1"></a>        is_setup <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb505-12"><a href="#cb505-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb505-13"><a href="#cb505-13" aria-hidden="true" tabindex="-1"></a>        mpool_table<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> gen_mpool<span class="op">&lt;</span><span class="dv">1</span><span class="op">,</span> <span class="dv">128</span><span class="op">&gt;();</span>  <span class="co">//   32</span></span>
<span id="cb505-14"><a href="#cb505-14" aria-hidden="true" tabindex="-1"></a>        mpool_table<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> gen_mpool<span class="op">&lt;</span><span class="dv">2</span><span class="op">,</span> <span class="dv">128</span><span class="op">&gt;();</span>  <span class="co">//   64</span></span>
<span id="cb505-15"><a href="#cb505-15" aria-hidden="true" tabindex="-1"></a>        mpool_table<span class="op">[</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> gen_mpool<span class="op">&lt;</span><span class="dv">3</span><span class="op">,</span> <span class="dv">128</span><span class="op">&gt;();</span>  <span class="co">//   96</span></span>
<span id="cb505-16"><a href="#cb505-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb505-17"><a href="#cb505-17" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb505-18"><a href="#cb505-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb505-19"><a href="#cb505-19" aria-hidden="true" tabindex="-1"></a>        mpool_table<span class="op">[</span><span class="dv">29</span><span class="op">]</span> <span class="op">=</span> gen_mpool<span class="op">&lt;</span><span class="dv">30</span><span class="op">,</span> <span class="dv">128</span><span class="op">&gt;();</span>  <span class="co">//  960</span></span>
<span id="cb505-20"><a href="#cb505-20" aria-hidden="true" tabindex="-1"></a>        mpool_table<span class="op">[</span><span class="dv">30</span><span class="op">]</span> <span class="op">=</span> gen_mpool<span class="op">&lt;</span><span class="dv">31</span><span class="op">,</span> <span class="dv">128</span><span class="op">&gt;();</span>  <span class="co">//  992</span></span>
<span id="cb505-21"><a href="#cb505-21" aria-hidden="true" tabindex="-1"></a>        mpool_table<span class="op">[</span><span class="dv">31</span><span class="op">]</span> <span class="op">=</span> gen_mpool<span class="op">&lt;</span><span class="dv">32</span><span class="op">,</span> <span class="dv">128</span><span class="op">&gt;();</span>  <span class="co">// 1024</span></span>
<span id="cb505-22"><a href="#cb505-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb505-23"><a href="#cb505-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb505-24"><a href="#cb505-24" aria-hidden="true" tabindex="-1"></a>    <span class="dt">size_t</span> size2index<span class="op">(</span><span class="dt">size_t</span> v<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb505-25"><a href="#cb505-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb505-26"><a href="#cb505-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="op">(((</span>v <span class="op">+</span> <span class="op">(</span>min_unit <span class="op">-</span> <span class="dv">1</span><span class="op">))</span> <span class="op">&amp;</span> <span class="op">~(</span>min_unit <span class="op">-</span> <span class="dv">1</span><span class="op">))</span> <span class="op">/</span> min_unit<span class="op">)</span> <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb505-27"><a href="#cb505-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb505-28"><a href="#cb505-28" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace</span></span>
<span id="cb505-29"><a href="#cb505-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb505-30"><a href="#cb505-30" aria-hidden="true" tabindex="-1"></a>    <span class="op">[[</span><span class="at">nodiscard</span><span class="op">]]</span> <span class="dt">void</span><span class="op">*</span> <span class="kw">operator</span> <span class="kw">new</span><span class="op">(</span><span class="bu">std::</span>size_t<span class="op"> </span>size<span class="op">)</span></span>
<span id="cb505-31"><a href="#cb505-31" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb505-32"><a href="#cb505-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!</span>is_setup<span class="op">)</span> <span class="op">{</span></span>
<span id="cb505-33"><a href="#cb505-33" aria-hidden="true" tabindex="-1"></a>            setup<span class="op">();</span></span>
<span id="cb505-34"><a href="#cb505-34" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb505-35"><a href="#cb505-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb505-36"><a href="#cb505-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> i <span class="op">=</span> size2index<span class="op">(</span>size<span class="op">);</span> i <span class="op">&lt;</span> ArrayLength<span class="op">(</span>mpool_table<span class="op">);</span> <span class="op">++</span>i<span class="op">)</span> <span class="op">{</span></span>
<span id="cb505-37"><a href="#cb505-37" aria-hidden="true" tabindex="-1"></a>            <span class="dt">void</span><span class="op">*</span> mem <span class="op">=</span> mpool_table<span class="op">[</span>i<span class="op">]-&gt;</span>AllocNoExcept<span class="op">(</span>size<span class="op">);</span></span>
<span id="cb505-38"><a href="#cb505-38" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>mem <span class="op">!=</span> <span class="kw">nullptr</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb505-39"><a href="#cb505-39" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> mem<span class="op">;</span></span>
<span id="cb505-40"><a href="#cb505-40" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb505-41"><a href="#cb505-41" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb505-42"><a href="#cb505-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb505-43"><a href="#cb505-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">throw</span> <span class="bu">std::</span>bad_alloc<span class="op">{};</span></span>
<span id="cb505-44"><a href="#cb505-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb505-45"><a href="#cb505-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="dt">char</span> fake<span class="op">[</span><span class="dv">0</span><span class="op">];</span></span>
<span id="cb505-46"><a href="#cb505-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb505-47"><a href="#cb505-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> fake<span class="op">;</span></span>
<span id="cb505-48"><a href="#cb505-48" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>上記で定義されたoperator newは、</p>
<ul>
<li>32の整数倍のサイズを持つ32個のメモリプールを持つ</li>
<li>各メモリープールは128個のメモリブロックを持つ</li>
<li>メモリブロックの最大長は1024バイト</li>
</ul>
<p>のような仕様を持つため、実際に使う場合は、メモリのサイズや個数の調整が必要だろうが、
後で詳しく見るようにリアルタイム性の阻害となるようなコードはないため、
リアルタイム性が必要なソフトウェアでも使用可能である。</p>
<p>静的オブジェクトを含まないアプリケーションでは、
上記のコードのsetupで行っているmpool_tableの初期化は <a
href="#SS_5_2_7">一様初期化</a>で行った方が良いが、
例で用いたアプリケーションにはnewを行う静的オブジェクトが存在するため
(google testは静的オブジェクトを利用する)、
setupで行っているような方法以外では、 最初のoperator
newの呼び出しより前にmpool_tableの初期化をすることはできない。</p>
<p>mpool_tableはMPoolポインタを保持するが、そのポインタが指すオブジェクトの実態は、
gen_mpool&lt;&gt;が生成したMPoolFixed&lt;&gt;オブジェクトである。
gen_mpool&lt;&gt;については、「<a
href="#SS_4_2_3">プレースメントnew</a>」で説明する。</p>
<p>size2indexは、要求されたサイズから、
それに対応するMPoolポインタを保持するmpool_tableのインデックスを導出する関数である。</p>
<p>この実装では対応するMPoolが空であった場合、
それよりも大きいメモリブロックを持つMPoolからメモリを返す仕様としたが、
その時点でアサーションフェールさせ
(つまり、対応するMPoolが空である状態でのAllocの呼び出しをバグとして扱う)、
MEM_COUNTの値を見直した方が、
より少ないメモリで動作する組み込みソフトを作りやすいだろう。</p>
<p>operator deleteについては、下記の2種類が必要となる。</p>
<div class="sourceCode" id="cb506"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb506-1"><a href="#cb506-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/dynamic_memory_allocation/global_new_delete.cpp 109</span></span>
<span id="cb506-2"><a href="#cb506-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb506-3"><a href="#cb506-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> <span class="kw">operator</span> <span class="kw">delete</span><span class="op">(</span><span class="dt">void</span><span class="op">*</span> mem<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb506-4"><a href="#cb506-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb506-5"><a href="#cb506-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span>MPool<span class="op">*</span> mp <span class="op">:</span> mpool_table<span class="op">)</span> <span class="op">{</span></span>
<span id="cb506-6"><a href="#cb506-6" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>mp<span class="op">-&gt;</span>IsValid<span class="op">(</span>mem<span class="op">))</span> <span class="op">{</span></span>
<span id="cb506-7"><a href="#cb506-7" aria-hidden="true" tabindex="-1"></a>                mp<span class="op">-&gt;</span>Free<span class="op">(</span>mem<span class="op">);</span></span>
<span id="cb506-8"><a href="#cb506-8" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span><span class="op">;</span></span>
<span id="cb506-9"><a href="#cb506-9" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb506-10"><a href="#cb506-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb506-11"><a href="#cb506-11" aria-hidden="true" tabindex="-1"></a>        <span class="ot">assert</span><span class="op">(</span><span class="kw">false</span><span class="op">);</span></span>
<span id="cb506-12"><a href="#cb506-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb506-13"><a href="#cb506-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb506-14"><a href="#cb506-14" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> <span class="kw">operator</span> <span class="kw">delete</span><span class="op">(</span><span class="dt">void</span><span class="op">*</span> mem<span class="op">,</span> <span class="bu">std::</span>size_t<span class="op"> </span>size<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb506-15"><a href="#cb506-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb506-16"><a href="#cb506-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> i <span class="op">=</span> size2index<span class="op">(</span>size<span class="op">);</span> i <span class="op">&lt;</span> ArrayLength<span class="op">(</span>mpool_table<span class="op">);</span> <span class="op">++</span>i<span class="op">)</span> <span class="op">{</span></span>
<span id="cb506-17"><a href="#cb506-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>mpool_table<span class="op">[</span>i<span class="op">]-&gt;</span>IsValid<span class="op">(</span>mem<span class="op">))</span> <span class="op">{</span></span>
<span id="cb506-18"><a href="#cb506-18" aria-hidden="true" tabindex="-1"></a>                mpool_table<span class="op">[</span>i<span class="op">]-&gt;</span>Free<span class="op">(</span>mem<span class="op">);</span></span>
<span id="cb506-19"><a href="#cb506-19" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span><span class="op">;</span></span>
<span id="cb506-20"><a href="#cb506-20" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb506-21"><a href="#cb506-21" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb506-22"><a href="#cb506-22" aria-hidden="true" tabindex="-1"></a>        <span class="ot">assert</span><span class="op">(</span><span class="kw">false</span><span class="op">);</span></span>
<span id="cb506-23"><a href="#cb506-23" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>operator delete(void* mem, std::size_t
size)は、完全型のオブジェクトのメモリ解放に使用され、 operator
delete(void* mem)は、それ以外のメモリ解放に使用される。</p>
<p>コードから明らかな通り、size付きのoperator
deleteの方がループの回転数が少なくなるため、
高速に動作するが、malloc/freeの実装(「<a
href="#SS_4_1">malloc/freeの問題点</a>」参照)で使用したHeader_t
を導入することでこの実行コストはほとんど排除できる。
そのトレードオフとしてメモリコストが増えるため、ここでは例示した仕様にした。</p>
<h3 id="プレースメントnew">プレースメントnew <a id="SS_4_2_3"></a></h3>
<p>「<a
href="#SS_4_2_2">グローバルnew/deleteのオーバーロードの実装</a>」で使用したgen_mpool&lt;&gt;は、
下記のように定義されている。</p>
<div class="sourceCode" id="cb507"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb507-1"><a href="#cb507-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/dynamic_memory_allocation/global_new_delete.cpp 8</span></span>
<span id="cb507-2"><a href="#cb507-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb507-3"><a href="#cb507-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> <span class="op">{</span></span>
<span id="cb507-4"><a href="#cb507-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb507-5"><a href="#cb507-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">size_t</span> min_unit<span class="op">{</span>MPoolFixed_MinSize<span class="op">};</span></span>
<span id="cb507-6"><a href="#cb507-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb507-7"><a href="#cb507-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="dt">uint32_t</span> N_UNITS<span class="op">,</span> <span class="dt">uint32_t</span> MEM_COUNT<span class="op">&gt;</span></span>
<span id="cb507-8"><a href="#cb507-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">[[</span><span class="at">nodiscard</span><span class="op">]]</span> MPool<span class="op">*</span> gen_mpool<span class="op">()</span> <span class="kw">noexcept</span></span>
<span id="cb507-9"><a href="#cb507-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb507-10"><a href="#cb507-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> <span class="dt">mp_t</span> <span class="op">=</span> MPoolFixed<span class="op">&lt;</span>min_unit <span class="op">*</span> N_UNITS<span class="op">,</span> MEM_COUNT<span class="op">&gt;;</span></span>
<span id="cb507-11"><a href="#cb507-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb507-12"><a href="#cb507-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="kw">union</span> <span class="op">{</span></span>
<span id="cb507-13"><a href="#cb507-13" aria-hidden="true" tabindex="-1"></a>            <span class="bu">std::</span>max_align_t<span class="op"> </span>max_align<span class="op">;</span></span>
<span id="cb507-14"><a href="#cb507-14" aria-hidden="true" tabindex="-1"></a>            <span class="dt">uint8_t</span>          mem<span class="op">[</span><span class="kw">sizeof</span><span class="op">(</span><span class="dt">mp_t</span><span class="op">)];</span></span>
<span id="cb507-15"><a href="#cb507-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span> mem<span class="op">;</span></span>
<span id="cb507-16"><a href="#cb507-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb507-17"><a href="#cb507-17" aria-hidden="true" tabindex="-1"></a>        <span class="kw">static_assert</span><span class="op">(</span><span class="kw">static_cast</span><span class="op">&lt;</span><span class="dt">void</span><span class="op">*&gt;(&amp;</span>mem<span class="op">.</span>max_align<span class="op">)</span> <span class="op">==</span> <span class="kw">static_cast</span><span class="op">&lt;</span><span class="dt">void</span><span class="op">*&gt;(</span>mem<span class="op">.</span>mem<span class="op">));</span></span>
<span id="cb507-18"><a href="#cb507-18" aria-hidden="true" tabindex="-1"></a>        <span class="kw">static_assert</span><span class="op">(</span><span class="kw">sizeof</span><span class="op">(</span>mem<span class="op">)</span> <span class="op">&gt;=</span> <span class="kw">sizeof</span><span class="op">(</span><span class="dt">mp_t</span><span class="op">));</span></span>
<span id="cb507-19"><a href="#cb507-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb507-20"><a href="#cb507-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">new</span> <span class="op">(</span>mem<span class="op">.</span>mem<span class="op">)</span> <span class="dt">mp_t</span><span class="op">;</span>  <span class="co">// プレースメントnew</span></span>
<span id="cb507-21"><a href="#cb507-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb507-22"><a href="#cb507-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace</span></span></code></pre></div>
<p>この関数テンプレートは、MPoolFixed&lt;&gt;オブジェクトを生成し、それをMPool型のポインタとして返す。
MPoolFixedの生成は、上記で示したようにプレースメントnewを使用して行っている。</p>
<p>gen_mpool&lt;&gt;内でMPoolFixedのstaticなインスタンスを定義した方がシンプルに実装できるが、
その場合、main()終了後、そのインスタンスは解放され(デストラクタが呼び出され)、その後、
他の静的オブジェクトの解放が行われると、その延長でoperator
deleteが呼び出され、
ライフタイム終了後のMPoolFixedのstaticなインスタンスが使われてしまう。</p>
<p>現在のMPoolFixedの実装ではこの操作で不具合は発生しないが、
解放済のオブジェクトを操作することは避けるべきであるため、
MPoolFixedの生成にプレースメントnewを用いている。</p>
<p>プレースメントnewで生成したオブジェクトをdeleteすることはできず、
デストラクタはユーザが明示的に呼び出さない限り、呼び出されない。
ここでは、プレースメントnewのこの特性を利用したが、
逆に、この特性があるため、
ここでの実装のような特殊な事情がある場合を除き、プレースメントnewを使うべきではない
(デストラクタの明示的な呼び出しを忘れるとリソースリークしてしまう)。</p>
<h3 id="デバッグ用イテレータ">デバッグ用イテレータ
<a id="SS_4_2_4"></a></h3>
<p>この章で例示したグローバルnew/deleteは、すでに述べたように適切なメモリの量を調整する必要がある。
そのためには、これを使用するアプリケーションをある程度動作させた後、
グローバルnew/deleteのメモリの消費量を計測しなければならない。</p>
<p>下記のコードは、そのためのインターフェースを提供する。</p>
<div class="sourceCode" id="cb508"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb508-1"><a href="#cb508-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/dynamic_memory_allocation/global_new_delete.h 4</span></span>
<span id="cb508-2"><a href="#cb508-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb508-3"><a href="#cb508-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> GlobalNewDeleteMonitor <span class="op">{</span></span>
<span id="cb508-4"><a href="#cb508-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb508-5"><a href="#cb508-5" aria-hidden="true" tabindex="-1"></a>        MPool <span class="at">const</span><span class="op">*</span> <span class="at">const</span><span class="op">*</span> cbegin<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span><span class="op">;</span></span>
<span id="cb508-6"><a href="#cb508-6" aria-hidden="true" tabindex="-1"></a>        MPool <span class="at">const</span><span class="op">*</span> <span class="at">const</span><span class="op">*</span> cend<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span><span class="op">;</span></span>
<span id="cb508-7"><a href="#cb508-7" aria-hidden="true" tabindex="-1"></a>        MPool <span class="at">const</span><span class="op">*</span> <span class="at">const</span><span class="op">*</span> begin<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span><span class="op">;</span></span>
<span id="cb508-8"><a href="#cb508-8" aria-hidden="true" tabindex="-1"></a>        MPool <span class="at">const</span><span class="op">*</span> <span class="at">const</span><span class="op">*</span> end<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span><span class="op">;</span></span>
<span id="cb508-9"><a href="#cb508-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb509"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb509-1"><a href="#cb509-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/dynamic_memory_allocation/global_new_delete.cpp 135</span></span>
<span id="cb509-2"><a href="#cb509-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb509-3"><a href="#cb509-3" aria-hidden="true" tabindex="-1"></a>    MPool <span class="at">const</span><span class="op">*</span> <span class="at">const</span><span class="op">*</span> GlobalNewDeleteMonitor<span class="op">::</span>begin<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="op">&amp;</span>mpool_table<span class="op">[</span><span class="dv">0</span><span class="op">];</span> <span class="op">}</span></span>
<span id="cb509-4"><a href="#cb509-4" aria-hidden="true" tabindex="-1"></a>    MPool <span class="at">const</span><span class="op">*</span> <span class="at">const</span><span class="op">*</span> GlobalNewDeleteMonitor<span class="op">::</span>end<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span></span>
<span id="cb509-5"><a href="#cb509-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb509-6"><a href="#cb509-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="op">&amp;</span>mpool_table<span class="op">[</span>ArrayLength<span class="op">(</span>mpool_table<span class="op">)];</span></span>
<span id="cb509-7"><a href="#cb509-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb509-8"><a href="#cb509-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb509-9"><a href="#cb509-9" aria-hidden="true" tabindex="-1"></a>    MPool <span class="at">const</span><span class="op">*</span> <span class="at">const</span><span class="op">*</span> GlobalNewDeleteMonitor<span class="op">::</span>cbegin<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> begin<span class="op">();</span> <span class="op">}</span></span>
<span id="cb509-10"><a href="#cb509-10" aria-hidden="true" tabindex="-1"></a>    MPool <span class="at">const</span><span class="op">*</span> <span class="at">const</span><span class="op">*</span> GlobalNewDeleteMonitor<span class="op">::</span>cend<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> end<span class="op">();</span> <span class="op">}</span></span></code></pre></div>
<p>このインターフェースを下記のように使用することで、</p>
<div class="sourceCode" id="cb510"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb510-1"><a href="#cb510-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/dynamic_memory_allocation/global_new_delete_ut.cpp 124</span></span>
<span id="cb510-2"><a href="#cb510-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb510-3"><a href="#cb510-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> gm <span class="op">=</span> GlobalNewDeleteMonitor<span class="op">{};</span></span>
<span id="cb510-4"><a href="#cb510-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb510-5"><a href="#cb510-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>cout<span class="op"> &lt;&lt;</span> <span class="st">&quot;  size current   min&quot;</span> <span class="op">&lt;&lt;</span> <span class="bu">std::</span>endl<span class="op">;</span></span>
<span id="cb510-6"><a href="#cb510-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>cout<span class="op"> &lt;&lt;</span> <span class="st">&quot;  ------------------&quot;</span> <span class="op">&lt;&lt;</span> <span class="bu">std::</span>endl<span class="op">;</span></span>
<span id="cb510-7"><a href="#cb510-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb510-8"><a href="#cb510-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>MPool <span class="at">const</span><span class="op">*</span> mp <span class="op">:</span> gm<span class="op">)</span> <span class="op">{</span></span>
<span id="cb510-9"><a href="#cb510-9" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>cout<span class="op"> &lt;&lt;</span> <span class="bu">std::</span>setw<span class="op">(</span><span class="dv">6</span><span class="op">)</span> <span class="op">&lt;&lt;</span> mp<span class="op">-&gt;</span>GetSize<span class="op">()</span> <span class="op">&lt;&lt;</span> <span class="bu">std::</span>setw<span class="op">(</span><span class="dv">8</span><span class="op">)</span> <span class="op">&lt;&lt;</span> mp<span class="op">-&gt;</span>GetCount<span class="op">()</span> <span class="op">&lt;&lt;</span> <span class="bu">std::</span>setw<span class="op">(</span><span class="dv">6</span><span class="op">)</span></span>
<span id="cb510-10"><a href="#cb510-10" aria-hidden="true" tabindex="-1"></a>                  <span class="op">&lt;&lt;</span> mp<span class="op">-&gt;</span>GetCountMin<span class="op">()</span> <span class="op">&lt;&lt;</span> <span class="bu">std::</span>endl<span class="op">;</span></span>
<span id="cb510-11"><a href="#cb510-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>下記のようにメモリの現在の状態や使用履歴を見ることができる。</p>
<pre><code>          size current   min
          ------------------
            32      90     0
            64      78    74
            96     127   125

           ...

           992     128   128
          1024     128     0</code></pre>
<p>実際の組み込みソフトの開発では、
デバッグ用入出力機能からこのようなコードを実行できるようにすることで、
グローバルnew/deleteが使用するそれぞれのMPoolFixedインスタンスのメモリの調整ができるだろう。</p>
<h2
id="クラスnewdeleteのオーバーロード">クラスnew/deleteのオーバーロード
<a id="SS_4_3"></a></h2>
<p>「<a
href="#SS_4_2_2">グローバルnew/deleteのオーバーロードの実装</a>」で示したコードのロックを、
「割り込みディセーブル/イネーブル」に置き換えることで、リアルタイム性を保障することができるが、
この機構はある程度多くのメモリを必要とするため、
極めてメモリ制限の厳しいシステムでは使用が困難である場合もあるだろう。</p>
<p>そのような場合、非スタック上でのオブジェクト生成には、</p>
<ul>
<li>限定的なクラスのみ、newによる動的な方法を用いる</li>
<li>その他のクラスに対しては、<a href="#SS_2_12">Singleton</a>や<a
href="#SS_2_17">Named Constructor</a>と同様な静的な方法を用いる</li>
</ul>
<p>とし、グローバルnewを使用しないことが、より良いメモリ使用方法となり得る。</p>
<p>グローバルnewを使わずに動的にオブジェクトを生成するためには、</p>
<ul>
<li>プレースメントnewを使う</li>
<li>クラス毎にnew/deleteをオーバーロードする</li>
</ul>
<p>という2つの選択肢が考えられるが、すでに述べた理由によりプレースメントnewの使用は避けるべきである。
従って、その方法はクラス毎のnew/deleteのオーバーロードになる。</p>
<p>メモリ管理に「<a
href="#SS_4_2_1">固定長メモリプール</a>」で示したMPoolFixedを利用した実装例を以下に示す。</p>
<div class="sourceCode" id="cb512"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb512-1"><a href="#cb512-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/dynamic_memory_allocation/class_new_delete_ut.cpp 14</span></span>
<span id="cb512-2"><a href="#cb512-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb512-3"><a href="#cb512-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> A <span class="op">{</span></span>
<span id="cb512-4"><a href="#cb512-4" aria-hidden="true" tabindex="-1"></a>        A<span class="op">()</span> <span class="kw">noexcept</span> <span class="op">:</span> name0<span class="op">{</span><span class="st">&quot;A&quot;</span><span class="op">}</span> <span class="op">{}</span></span>
<span id="cb512-5"><a href="#cb512-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">char</span> <span class="at">const</span><span class="op">*</span> name0<span class="op">;</span></span>
<span id="cb512-6"><a href="#cb512-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb512-7"><a href="#cb512-7" aria-hidden="true" tabindex="-1"></a>        <span class="op">[[</span><span class="at">nodiscard</span><span class="op">]]</span> <span class="at">static</span> <span class="dt">void</span><span class="op">*</span> <span class="kw">operator</span> <span class="kw">new</span><span class="op">(</span><span class="dt">size_t</span> size<span class="op">);</span></span>
<span id="cb512-8"><a href="#cb512-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="dt">void</span>                <span class="kw">operator</span> <span class="kw">delete</span><span class="op">(</span><span class="dt">void</span><span class="op">*</span> mem<span class="op">)</span> <span class="kw">noexcept</span><span class="op">;</span></span>
<span id="cb512-9"><a href="#cb512-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="dt">void</span>                <span class="kw">operator</span> <span class="kw">delete</span><span class="op">(</span><span class="dt">void</span><span class="op">*</span> mem<span class="op">,</span> <span class="bu">std::</span>size_t<span class="op"> </span>size<span class="op">)</span> <span class="kw">noexcept</span><span class="op">;</span></span>
<span id="cb512-10"><a href="#cb512-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb512-11"><a href="#cb512-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">[[</span><span class="at">nodiscard</span><span class="op">]]</span> <span class="at">static</span> <span class="dt">void</span><span class="op">*</span> <span class="kw">operator</span> <span class="kw">new</span><span class="op">[](</span><span class="dt">size_t</span> size<span class="op">)</span>                             <span class="op">=</span> <span class="kw">delete</span><span class="op">;</span></span>
<span id="cb512-12"><a href="#cb512-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="dt">void</span>                <span class="kw">operator</span> <span class="kw">delete</span><span class="op">[](</span><span class="dt">void</span><span class="op">*</span> mem<span class="op">)</span> <span class="kw">noexcept</span>                   <span class="op">=</span> <span class="kw">delete</span><span class="op">;</span></span>
<span id="cb512-13"><a href="#cb512-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="dt">void</span>                <span class="kw">operator</span> <span class="kw">delete</span><span class="op">[](</span><span class="dt">void</span><span class="op">*</span> mem<span class="op">,</span> <span class="bu">std::</span>size_t<span class="op"> </span>size<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">=</span> <span class="kw">delete</span><span class="op">;</span></span>
<span id="cb512-14"><a href="#cb512-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb512-15"><a href="#cb512-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb512-16"><a href="#cb512-16" aria-hidden="true" tabindex="-1"></a>    MPoolFixed<span class="op">&lt;</span><span class="kw">sizeof</span><span class="op">(</span>A<span class="op">),</span> <span class="dv">3</span><span class="op">&gt;</span> mpf_A<span class="op">;</span></span>
<span id="cb512-17"><a href="#cb512-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb512-18"><a href="#cb512-18" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span><span class="op">*</span> A<span class="op">::</span><span class="kw">operator</span> <span class="kw">new</span><span class="op">(</span><span class="dt">size_t</span> size<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> mpf_A<span class="op">.</span>Alloc<span class="op">(</span>size<span class="op">);</span> <span class="op">}</span></span>
<span id="cb512-19"><a href="#cb512-19" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> A<span class="op">::</span><span class="kw">operator</span> <span class="kw">delete</span><span class="op">(</span><span class="dt">void</span><span class="op">*</span> mem<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span> mpf_A<span class="op">.</span>Free<span class="op">(</span>mem<span class="op">);</span> <span class="op">}</span></span>
<span id="cb512-20"><a href="#cb512-20" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> A<span class="op">::</span><span class="kw">operator</span> <span class="kw">delete</span><span class="op">(</span><span class="dt">void</span><span class="op">*</span> mem<span class="op">,</span> <span class="bu">std::</span>size_t<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span> mpf_A<span class="op">.</span>Free<span class="op">(</span>mem<span class="op">);</span> <span class="op">}</span></span></code></pre></div>
<p>以下の単体テストが示す通り、
静的に定義したMPoolFixedインスタンスがオーバーロードしたnew/deleteから使われていることがわかる
(従ってグローバルnew/deleteは使われていないこともわかる)。</p>
<div class="sourceCode" id="cb513"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb513-1"><a href="#cb513-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/dynamic_memory_allocation/class_new_delete_ut.cpp 43</span></span>
<span id="cb513-2"><a href="#cb513-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb513-3"><a href="#cb513-3" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">3</span><span class="op">,</span> mpf_A<span class="op">.</span>GetCount<span class="op">());</span></span>
<span id="cb513-4"><a href="#cb513-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb513-5"><a href="#cb513-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb513-6"><a href="#cb513-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> a <span class="op">=</span> <span class="bu">std::</span>make_unique<span class="op">&lt;</span>A<span class="op">&gt;();</span></span>
<span id="cb513-7"><a href="#cb513-7" aria-hidden="true" tabindex="-1"></a>        ASSERT_STREQ<span class="op">(</span><span class="st">&quot;A&quot;</span><span class="op">,</span> a<span class="op">-&gt;</span>name0<span class="op">);</span></span>
<span id="cb513-8"><a href="#cb513-8" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="dv">2</span><span class="op">,</span> mpf_A<span class="op">.</span>GetCount<span class="op">());</span></span>
<span id="cb513-9"><a href="#cb513-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb513-10"><a href="#cb513-10" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">3</span><span class="op">,</span> mpf_A<span class="op">.</span>GetCount<span class="op">());</span></span>
<span id="cb513-11"><a href="#cb513-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb513-12"><a href="#cb513-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb513-13"><a href="#cb513-13" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> a <span class="op">=</span> <span class="bu">std::</span>make_unique<span class="op">&lt;</span>A<span class="op">&gt;();</span></span>
<span id="cb513-14"><a href="#cb513-14" aria-hidden="true" tabindex="-1"></a>        ASSERT_STREQ<span class="op">(</span><span class="st">&quot;A&quot;</span><span class="op">,</span> a<span class="op">-&gt;</span>name0<span class="op">);</span></span>
<span id="cb513-15"><a href="#cb513-15" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="dv">2</span><span class="op">,</span> mpf_A<span class="op">.</span>GetCount<span class="op">());</span></span>
<span id="cb513-16"><a href="#cb513-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb513-17"><a href="#cb513-17" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> b <span class="op">=</span> <span class="bu">std::</span>make_unique<span class="op">&lt;</span>A<span class="op">&gt;();</span></span>
<span id="cb513-18"><a href="#cb513-18" aria-hidden="true" tabindex="-1"></a>        ASSERT_STREQ<span class="op">(</span><span class="st">&quot;A&quot;</span><span class="op">,</span> b<span class="op">-&gt;</span>name0<span class="op">);</span></span>
<span id="cb513-19"><a href="#cb513-19" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="dv">1</span><span class="op">,</span> mpf_A<span class="op">.</span>GetCount<span class="op">());</span></span>
<span id="cb513-20"><a href="#cb513-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb513-21"><a href="#cb513-21" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> c <span class="op">=</span> <span class="bu">std::</span>make_unique<span class="op">&lt;</span>A<span class="op">&gt;();</span></span>
<span id="cb513-22"><a href="#cb513-22" aria-hidden="true" tabindex="-1"></a>        ASSERT_STREQ<span class="op">(</span><span class="st">&quot;A&quot;</span><span class="op">,</span> c<span class="op">-&gt;</span>name0<span class="op">);</span></span>
<span id="cb513-23"><a href="#cb513-23" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="dv">0</span><span class="op">,</span> mpf_A<span class="op">.</span>GetCount<span class="op">());</span></span>
<span id="cb513-24"><a href="#cb513-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb513-25"><a href="#cb513-25" aria-hidden="true" tabindex="-1"></a>        ASSERT_THROW<span class="op">(</span><span class="bu">std::</span>make_unique<span class="op">&lt;</span>A<span class="op">&gt;(),</span> MPoolBadAlloc<span class="op">);</span></span>
<span id="cb513-26"><a href="#cb513-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb513-27"><a href="#cb513-27" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">3</span><span class="op">,</span> mpf_A<span class="op">.</span>GetCount<span class="op">());</span></span></code></pre></div>
<p>しかし、この方法ではnewのオーバーロードを行うクラス毎に、</p>
<div class="sourceCode" id="cb514"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb514-1"><a href="#cb514-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/dynamic_memory_allocation/class_new_delete_ut.cpp 20</span></span>
<span id="cb514-2"><a href="#cb514-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb514-3"><a href="#cb514-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">[[</span><span class="at">nodiscard</span><span class="op">]]</span> <span class="at">static</span> <span class="dt">void</span><span class="op">*</span> <span class="kw">operator</span> <span class="kw">new</span><span class="op">(</span><span class="dt">size_t</span> size<span class="op">);</span></span>
<span id="cb514-4"><a href="#cb514-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">static</span> <span class="dt">void</span>                <span class="kw">operator</span> <span class="kw">delete</span><span class="op">(</span><span class="dt">void</span><span class="op">*</span> mem<span class="op">)</span> <span class="kw">noexcept</span><span class="op">;</span></span>
<span id="cb514-5"><a href="#cb514-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">static</span> <span class="dt">void</span>                <span class="kw">operator</span> <span class="kw">delete</span><span class="op">(</span><span class="dt">void</span><span class="op">*</span> mem<span class="op">,</span> <span class="bu">std::</span>size_t<span class="op"> </span>size<span class="op">)</span> <span class="kw">noexcept</span><span class="op">;</span></span>
<span id="cb514-6"><a href="#cb514-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb514-7"><a href="#cb514-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">[[</span><span class="at">nodiscard</span><span class="op">]]</span> <span class="at">static</span> <span class="dt">void</span><span class="op">*</span> <span class="kw">operator</span> <span class="kw">new</span><span class="op">[](</span><span class="dt">size_t</span> size<span class="op">)</span>                             <span class="op">=</span> <span class="kw">delete</span><span class="op">;</span></span>
<span id="cb514-8"><a href="#cb514-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">static</span> <span class="dt">void</span>                <span class="kw">operator</span> <span class="kw">delete</span><span class="op">[](</span><span class="dt">void</span><span class="op">*</span> mem<span class="op">)</span> <span class="kw">noexcept</span>                   <span class="op">=</span> <span class="kw">delete</span><span class="op">;</span></span>
<span id="cb514-9"><a href="#cb514-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">static</span> <span class="dt">void</span>                <span class="kw">operator</span> <span class="kw">delete</span><span class="op">[](</span><span class="dt">void</span><span class="op">*</span> mem<span class="op">,</span> <span class="bu">std::</span>size_t<span class="op"> </span>size<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">=</span> <span class="kw">delete</span><span class="op">;</span></span></code></pre></div>
<p>を記述しなければならず、コードクローンの温床となってしまう。
これを避けるためには、 <a href="#SS_2_21">CRTP(curiously recurring
template pattern)</a>
を利用した下記のようなクラステンプレートを導入すれば良い。</p>
<div class="sourceCode" id="cb515"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb515-1"><a href="#cb515-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/dynamic_memory_allocation/op_new.h 5</span></span>
<span id="cb515-2"><a href="#cb515-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb515-3"><a href="#cb515-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb515-4"><a href="#cb515-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> OpNew <span class="op">{</span></span>
<span id="cb515-5"><a href="#cb515-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb515-6"><a href="#cb515-6" aria-hidden="true" tabindex="-1"></a>        <span class="op">[[</span><span class="at">nodiscard</span><span class="op">]]</span> <span class="at">static</span> <span class="dt">void</span><span class="op">*</span> <span class="kw">operator</span> <span class="kw">new</span><span class="op">(</span><span class="dt">size_t</span> size<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">mpool_</span><span class="op">.</span>Alloc<span class="op">(</span>size<span class="op">);</span> <span class="op">}</span></span>
<span id="cb515-7"><a href="#cb515-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="dt">void</span>                <span class="kw">operator</span> <span class="kw">delete</span><span class="op">(</span><span class="dt">void</span><span class="op">*</span> mem<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="va">mpool_</span><span class="op">.</span>Free<span class="op">(</span>mem<span class="op">);</span> <span class="op">}</span></span>
<span id="cb515-8"><a href="#cb515-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="dt">void</span> <span class="kw">operator</span> <span class="kw">delete</span><span class="op">(</span><span class="dt">void</span><span class="op">*</span> mem<span class="op">,</span> <span class="bu">std::</span>size_t<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="va">mpool_</span><span class="op">.</span>Free<span class="op">(</span>mem<span class="op">);</span> <span class="op">}</span></span>
<span id="cb515-9"><a href="#cb515-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb515-10"><a href="#cb515-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">[[</span><span class="at">nodiscard</span><span class="op">]]</span> <span class="at">static</span> <span class="dt">void</span><span class="op">*</span> <span class="kw">operator</span> <span class="kw">new</span><span class="op">[](</span><span class="dt">size_t</span> size<span class="op">)</span>                             <span class="op">=</span> <span class="kw">delete</span><span class="op">;</span></span>
<span id="cb515-11"><a href="#cb515-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="dt">void</span>                <span class="kw">operator</span> <span class="kw">delete</span><span class="op">[](</span><span class="dt">void</span><span class="op">*</span> mem<span class="op">)</span> <span class="kw">noexcept</span>                   <span class="op">=</span> <span class="kw">delete</span><span class="op">;</span></span>
<span id="cb515-12"><a href="#cb515-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="dt">void</span>                <span class="kw">operator</span> <span class="kw">delete</span><span class="op">[](</span><span class="dt">void</span><span class="op">*</span> mem<span class="op">,</span> <span class="bu">std::</span>size_t<span class="op"> </span>size<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">=</span> <span class="kw">delete</span><span class="op">;</span></span>
<span id="cb515-13"><a href="#cb515-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb515-14"><a href="#cb515-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb515-15"><a href="#cb515-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> MPool<span class="op">&amp;</span> <span class="va">mpool_</span><span class="op">;</span></span>
<span id="cb515-16"><a href="#cb515-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>このOpeNewを使用した「new/deleteのオーバーロードを持つ基底クラスとその一連の派生クラス」
の実装例を以下に示す。</p>
<div class="sourceCode" id="cb516"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb516-1"><a href="#cb516-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/dynamic_memory_allocation/class_new_delete_ut.cpp 77</span></span>
<span id="cb516-2"><a href="#cb516-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb516-3"><a href="#cb516-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> A <span class="op">:</span> <span class="kw">public</span> OpNew<span class="op">&lt;</span>A<span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb516-4"><a href="#cb516-4" aria-hidden="true" tabindex="-1"></a>        A<span class="op">()</span> <span class="kw">noexcept</span> <span class="op">:</span> name0<span class="op">{</span><span class="st">&quot;A&quot;</span><span class="op">}</span> <span class="op">{}</span></span>
<span id="cb516-5"><a href="#cb516-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">char</span> <span class="at">const</span><span class="op">*</span> name0<span class="op">;</span></span>
<span id="cb516-6"><a href="#cb516-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb516-7"><a href="#cb516-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb516-8"><a href="#cb516-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> B <span class="op">:</span> A <span class="op">{</span></span>
<span id="cb516-9"><a href="#cb516-9" aria-hidden="true" tabindex="-1"></a>        B<span class="op">()</span> <span class="kw">noexcept</span> <span class="op">:</span> name1<span class="op">{</span><span class="st">&quot;B&quot;</span><span class="op">}</span> <span class="op">{}</span></span>
<span id="cb516-10"><a href="#cb516-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">char</span> <span class="at">const</span><span class="op">*</span> name1<span class="op">;</span></span>
<span id="cb516-11"><a href="#cb516-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb516-12"><a href="#cb516-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb516-13"><a href="#cb516-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> C <span class="op">:</span> A <span class="op">{</span></span>
<span id="cb516-14"><a href="#cb516-14" aria-hidden="true" tabindex="-1"></a>        C<span class="op">()</span> <span class="kw">noexcept</span> <span class="op">:</span> name1<span class="op">{</span><span class="st">&quot;C&quot;</span><span class="op">}</span> <span class="op">{}</span></span>
<span id="cb516-15"><a href="#cb516-15" aria-hidden="true" tabindex="-1"></a>        <span class="dt">char</span> <span class="at">const</span><span class="op">*</span> name1<span class="op">;</span></span>
<span id="cb516-16"><a href="#cb516-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb516-17"><a href="#cb516-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb516-18"><a href="#cb516-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> D <span class="op">:</span> C <span class="op">{</span></span>
<span id="cb516-19"><a href="#cb516-19" aria-hidden="true" tabindex="-1"></a>        D<span class="op">()</span> <span class="kw">noexcept</span> <span class="op">:</span> name2<span class="op">{</span><span class="st">&quot;D&quot;</span><span class="op">}</span> <span class="op">{}</span></span>
<span id="cb516-20"><a href="#cb516-20" aria-hidden="true" tabindex="-1"></a>        <span class="dt">char</span> <span class="at">const</span><span class="op">*</span> name2<span class="op">;</span></span>
<span id="cb516-21"><a href="#cb516-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb516-22"><a href="#cb516-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb516-23"><a href="#cb516-23" aria-hidden="true" tabindex="-1"></a>    MPoolFixed<span class="op">&lt;</span>MaxSizeof<span class="op">&lt;</span>A<span class="op">,</span> B<span class="op">,</span> C<span class="op">,</span> D<span class="op">&gt;(),</span> <span class="dv">10</span><span class="op">&gt;</span> mpf_ABCD<span class="op">;</span></span>
<span id="cb516-24"><a href="#cb516-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb516-25"><a href="#cb516-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;&gt;</span></span>
<span id="cb516-26"><a href="#cb516-26" aria-hidden="true" tabindex="-1"></a>    MPool<span class="op">&amp;</span> OpNew<span class="op">&lt;</span>A<span class="op">&gt;::</span><span class="va">mpool_</span> <span class="op">=</span> mpf_ABCD<span class="op">;</span></span></code></pre></div>
<p>OpNewをクラステンプレートとし、内部で利用しないテンプレートパラメータを宣言した理由は、
別のクラスからはOpNewの別インスタンスを使用できるようにするためである。</p>
<p>この方法は、コードが若干複雑にることを除けば、 「<a
href="#SS_4_2">グローバルnew/deleteのオーバーロード</a>」に比べ、優れているように見えてしまうかもしれないが、
下記のように、さらに派生クラスを定義してしまうとnewが失敗してしまうことがあるので注意が必要である。</p>
<div class="sourceCode" id="cb517"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb517-1"><a href="#cb517-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/dynamic_memory_allocation/class_new_delete_ut.cpp 135</span></span>
<span id="cb517-2"><a href="#cb517-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb517-3"><a href="#cb517-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> Large <span class="op">:</span> A <span class="op">{</span></span>
<span id="cb517-4"><a href="#cb517-4" aria-hidden="true" tabindex="-1"></a>        <span class="dt">uint8_t</span> buff<span class="op">[</span><span class="dv">1024</span><span class="op">];</span>  <span class="co">// mpf_ABCDのメモリブロックのサイズを超える</span></span>
<span id="cb517-5"><a href="#cb517-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb517-6"><a href="#cb517-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb517-7"><a href="#cb517-7" aria-hidden="true" tabindex="-1"></a>    TEST<span class="op">(</span>NewDelete_Opt<span class="op">,</span> class_new_delete_fixed_derived_large<span class="op">)</span></span>
<span id="cb517-8"><a href="#cb517-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb517-9"><a href="#cb517-9" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="dv">10</span><span class="op">,</span> mpf_ABCD<span class="op">.</span>GetCount<span class="op">());</span></span>
<span id="cb517-10"><a href="#cb517-10" aria-hidden="true" tabindex="-1"></a>        ASSERT_THROW<span class="op">(</span><span class="kw">auto</span> large <span class="op">=</span> <span class="bu">std::</span>make_unique<span class="op">&lt;</span>Large<span class="op">&gt;(),</span> MPoolBadAlloc<span class="op">);</span>  <span class="co">// サイズが大きすぎる</span></span>
<span id="cb517-11"><a href="#cb517-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>なお、
下記のようなクラスをnew/deleteをオーバーロードしないすべのクラスの基底クラスとすることで、
偶発的にグローバルnewを使ってしまわないようにすることもできる。</p>
<div class="sourceCode" id="cb518"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb518-1"><a href="#cb518-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/dynamic_memory_allocation/op_new_deleted.h 3</span></span>
<span id="cb518-2"><a href="#cb518-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb518-3"><a href="#cb518-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> OpNewDeleted <span class="op">{</span></span>
<span id="cb518-4"><a href="#cb518-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="dt">void</span><span class="op">*</span> <span class="kw">operator</span> <span class="kw">new</span><span class="op">(</span><span class="dt">size_t</span> size<span class="op">)</span>                             <span class="op">=</span> <span class="kw">delete</span><span class="op">;</span></span>
<span id="cb518-5"><a href="#cb518-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="dt">void</span>  <span class="kw">operator</span> <span class="kw">delete</span><span class="op">(</span><span class="dt">void</span><span class="op">*</span> mem<span class="op">)</span> <span class="kw">noexcept</span>                   <span class="op">=</span> <span class="kw">delete</span><span class="op">;</span></span>
<span id="cb518-6"><a href="#cb518-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="dt">void</span>  <span class="kw">operator</span> <span class="kw">delete</span><span class="op">(</span><span class="dt">void</span><span class="op">*</span> mem<span class="op">,</span> <span class="bu">std::</span>size_t<span class="op"> </span>size<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">=</span> <span class="kw">delete</span><span class="op">;</span></span>
<span id="cb518-7"><a href="#cb518-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb519"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb519-1"><a href="#cb519-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/dynamic_memory_allocation/class_new_delete_ut.cpp 150</span></span>
<span id="cb519-2"><a href="#cb519-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb519-3"><a href="#cb519-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> DeletedNew <span class="op">:</span> OpNewDeleted <span class="op">{</span>  <span class="co">// プライベート継承</span></span>
<span id="cb519-4"><a href="#cb519-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb519-5"><a href="#cb519-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb519-6"><a href="#cb519-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> DelivedDeletedNew <span class="op">:</span> DeletedNew <span class="op">{</span>  <span class="co">// プライベート継承</span></span>
<span id="cb519-7"><a href="#cb519-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb519-8"><a href="#cb519-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb519-9"><a href="#cb519-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">// DeletedNew* ptr0 { new DeletedNew };                // OpNewDeletedの効果でコンパイルエラー</span></span>
<span id="cb519-10"><a href="#cb519-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">// DelivedDeletedNew* ptr1 { new DelivedDeletedNew };  // 同上</span></span></code></pre></div>
<p>この記述方法は、コードインスペクションの省力化にも繋がるため、
OpNewを使うプロジェクトには導入するべきだろう。</p>
<h2 id="stlコンテナのアロケーター">STLコンテナのアロケーター
<a id="SS_4_4"></a></h2>
<p>ここまで前提として来たような組み込みソフトにおいても、
その大部分のコードにリアルタイム性は不要であり、このような部分のコードにSTLコンテナが使用できれば、</p>
<ul>
<li>開発効率が向上する</li>
<li>開発コード量が少なくなる</li>
</ul>
<p>等のポジティブな影響を期待できることは多い。
STLコンテナはこういった状況に備えて、ユーザ定義のアロケータを使用できるように定義されている。
ここでは、アロケータの定義例や、その使い方を示す。</p>
<h3 id="stlコンテナ用アロケータ">STLコンテナ用アロケータ
<a id="SS_4_4_1"></a></h3>
<p>アロケータの定義例を以下に示す。</p>
<div class="sourceCode" id="cb520"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb520-1"><a href="#cb520-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/dynamic_memory_allocation/mpool_allocator.h 7</span></span>
<span id="cb520-2"><a href="#cb520-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb520-3"><a href="#cb520-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb520-4"><a href="#cb520-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> MPoolBasedAllocator <span class="op">{</span></span>
<span id="cb520-5"><a href="#cb520-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb520-6"><a href="#cb520-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> pointer                                <span class="op">=</span> T<span class="op">*;</span></span>
<span id="cb520-7"><a href="#cb520-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> const_pointer                          <span class="op">=</span> T <span class="at">const</span><span class="op">*;</span></span>
<span id="cb520-8"><a href="#cb520-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> <span class="dt">value_type</span>                             <span class="op">=</span> T<span class="op">;</span></span>
<span id="cb520-9"><a href="#cb520-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> propagate_on_container_move_assignment <span class="op">=</span> <span class="bu">std::</span>true_type<span class="op">;</span></span>
<span id="cb520-10"><a href="#cb520-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> is_always_equal                        <span class="op">=</span> <span class="bu">std::</span>true_type<span class="op">;</span></span>
<span id="cb520-11"><a href="#cb520-11" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> <span class="dt">size_type</span>                              <span class="op">=</span> <span class="dt">size_t</span><span class="op">;</span></span>
<span id="cb520-12"><a href="#cb520-12" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> <span class="dt">difference_type</span>                        <span class="op">=</span> <span class="dt">size_t</span><span class="op">;</span></span>
<span id="cb520-13"><a href="#cb520-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb520-14"><a href="#cb520-14" aria-hidden="true" tabindex="-1"></a>        <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">class</span> U<span class="op">&gt;</span></span>
<span id="cb520-15"><a href="#cb520-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">struct</span> rebind <span class="op">{</span></span>
<span id="cb520-16"><a href="#cb520-16" aria-hidden="true" tabindex="-1"></a>            <span class="kw">using</span> other <span class="op">=</span> MPoolBasedAllocator<span class="op">&lt;</span>U<span class="op">&gt;;</span></span>
<span id="cb520-17"><a href="#cb520-17" aria-hidden="true" tabindex="-1"></a>        <span class="op">};</span></span>
<span id="cb520-18"><a href="#cb520-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb520-19"><a href="#cb520-19" aria-hidden="true" tabindex="-1"></a>        T<span class="op">*</span>   allocate<span class="op">(</span><span class="dt">size_type</span> count<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> <span class="kw">static_cast</span><span class="op">&lt;</span>pointer<span class="op">&gt;(</span><span class="va">mpool_</span><span class="op">.</span>Alloc<span class="op">(</span>count <span class="op">*</span> <span class="kw">sizeof</span><span class="op">(</span>T<span class="op">)));</span> <span class="op">}</span></span>
<span id="cb520-20"><a href="#cb520-20" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> deallocate<span class="op">(</span>T<span class="op">*</span> mem<span class="op">,</span> <span class="dt">size_type</span><span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="va">mpool_</span><span class="op">.</span>Free<span class="op">(</span>mem<span class="op">);</span> <span class="op">}</span></span>
<span id="cb520-21"><a href="#cb520-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb520-22"><a href="#cb520-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb520-23"><a href="#cb520-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> MPool<span class="op">&amp;</span> <span class="va">mpool_</span><span class="op">;</span></span>
<span id="cb520-24"><a href="#cb520-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb520-25"><a href="#cb520-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb520-26"><a href="#cb520-26" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">class</span> T<span class="op">&gt;</span>  <span class="co">// T型のMPoolBasedAllocatorはシステムに唯一</span></span>
<span id="cb520-27"><a href="#cb520-27" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bool</span> <span class="kw">operator</span><span class="op">==(</span>MPoolBasedAllocator<span class="op">&lt;</span>T<span class="op">&gt;</span> <span class="at">const</span><span class="op">&amp;,</span> MPoolBasedAllocator<span class="op">&lt;</span>T<span class="op">&gt;</span> <span class="at">const</span><span class="op">&amp;)</span> <span class="kw">noexcept</span></span>
<span id="cb520-28"><a href="#cb520-28" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb520-29"><a href="#cb520-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb520-30"><a href="#cb520-30" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb520-31"><a href="#cb520-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb520-32"><a href="#cb520-32" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">class</span> T<span class="op">,</span> <span class="kw">class</span> U<span class="op">&gt;</span></span>
<span id="cb520-33"><a href="#cb520-33" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bool</span> <span class="kw">operator</span><span class="op">==(</span>MPoolBasedAllocator<span class="op">&lt;</span>T<span class="op">&gt;</span> <span class="at">const</span><span class="op">&amp;,</span> MPoolBasedAllocator<span class="op">&lt;</span>U<span class="op">&gt;</span> <span class="at">const</span><span class="op">&amp;)</span> <span class="kw">noexcept</span></span>
<span id="cb520-34"><a href="#cb520-34" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb520-35"><a href="#cb520-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb520-36"><a href="#cb520-36" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb520-37"><a href="#cb520-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb520-38"><a href="#cb520-38" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">class</span> T<span class="op">,</span> <span class="kw">class</span> U<span class="op">&gt;</span></span>
<span id="cb520-39"><a href="#cb520-39" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bool</span> <span class="kw">operator</span><span class="op">!=(</span>MPoolBasedAllocator<span class="op">&lt;</span>T<span class="op">&gt;</span> <span class="at">const</span><span class="op">&amp;</span> lhs<span class="op">,</span> MPoolBasedAllocator<span class="op">&lt;</span>U<span class="op">&gt;</span> <span class="at">const</span><span class="op">&amp;</span> rhs<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb520-40"><a href="#cb520-40" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb520-41"><a href="#cb520-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="op">!(</span>lhs <span class="op">==</span> rhs<span class="op">);</span></span>
<span id="cb520-42"><a href="#cb520-42" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>アロケータのパブリックなメンバやoperator ==、operator
!=は、STLに従い定義している (<a
href="https://cpprefjp.github.io/reference/memory/allocator.html">STL
allocator</a>参照)。</p>
<p>上記コードからわかるようにメモリの実際のアロケーションには、
これまでと同様にMPoolから派生したクラスを使用するが、
リアルタイム性は不要であるためメモリ効率が悪いMPoolFixedは使わない。
代わりに、可変長メモリを扱うためメモリ効率がよいMPoolVariabl (「<a
href="#SS_4_4_2">可変長メモリプール</a>」参照)を使う。</p>
<h3 id="可変長メモリプール">可変長メモリプール
<a id="SS_4_4_2"></a></h3>
<p>可変長メモリプールを生成するMPoolVariableの実装は下記のようになる
(全体は巻末の”<a
href="#SS_6_1_2">example/dynamic_memory_allocation/mpool_variable.h</a>“に掲載する)。</p>
<div class="sourceCode" id="cb521"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb521-1"><a href="#cb521-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/dynamic_memory_allocation/mpool_variable.h 59</span></span>
<span id="cb521-2"><a href="#cb521-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb521-3"><a href="#cb521-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="dt">uint32_t</span> MEM_SIZE<span class="op">&gt;</span></span>
<span id="cb521-4"><a href="#cb521-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> MPoolVariable <span class="kw">final</span> <span class="op">:</span> <span class="kw">public</span> MPool <span class="op">{</span></span>
<span id="cb521-5"><a href="#cb521-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb521-6"><a href="#cb521-6" aria-hidden="true" tabindex="-1"></a>        MPoolVariable<span class="op">()</span> <span class="kw">noexcept</span> <span class="op">:</span> MPool<span class="op">{</span>MEM_SIZE<span class="op">}</span></span>
<span id="cb521-7"><a href="#cb521-7" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb521-8"><a href="#cb521-8" aria-hidden="true" tabindex="-1"></a>            <span class="va">header_</span><span class="op">-&gt;</span>next    <span class="op">=</span> <span class="kw">nullptr</span><span class="op">;</span></span>
<span id="cb521-9"><a href="#cb521-9" aria-hidden="true" tabindex="-1"></a>            <span class="va">header_</span><span class="op">-&gt;</span>n_nuits <span class="op">=</span> <span class="kw">sizeof</span><span class="op">(</span><span class="va">buff_</span><span class="op">)</span> <span class="op">/</span> Inner_<span class="op">::</span>unit_size<span class="op">;</span></span>
<span id="cb521-10"><a href="#cb521-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb521-11"><a href="#cb521-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb521-12"><a href="#cb521-12" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 中略</span></span>
<span id="cb521-13"><a href="#cb521-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb521-14"><a href="#cb521-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb521-15"><a href="#cb521-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb521-16"><a href="#cb521-16" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> <span class="dt">header_t</span> <span class="op">=</span> Inner_<span class="op">::</span><span class="dt">header_t</span><span class="op">;</span></span>
<span id="cb521-17"><a href="#cb521-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb521-18"><a href="#cb521-18" aria-hidden="true" tabindex="-1"></a>        Inner_<span class="op">::</span><span class="dt">buffer_t</span><span class="op">&lt;</span>MEM_SIZE<span class="op">&gt;</span> <span class="va">buff_</span><span class="op">{};</span></span>
<span id="cb521-19"><a href="#cb521-19" aria-hidden="true" tabindex="-1"></a>        <span class="dt">header_t</span><span class="op">*</span>                  <span class="va">header_</span><span class="op">{</span><span class="kw">reinterpret_cast</span><span class="op">&lt;</span><span class="dt">header_t</span><span class="op">*&gt;(</span><span class="va">buff_</span><span class="op">.</span>buffer<span class="op">)};</span></span>
<span id="cb521-20"><a href="#cb521-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">mutable</span> SpinLock           <span class="va">spin_lock_</span><span class="op">{};</span></span>
<span id="cb521-21"><a href="#cb521-21" aria-hidden="true" tabindex="-1"></a>        <span class="dt">size_t</span>                     <span class="va">unit_count_</span><span class="op">{</span><span class="kw">sizeof</span><span class="op">(</span><span class="va">buff_</span><span class="op">)</span> <span class="op">/</span> Inner_<span class="op">::</span>unit_size<span class="op">};</span></span>
<span id="cb521-22"><a href="#cb521-22" aria-hidden="true" tabindex="-1"></a>        <span class="dt">size_t</span>                     <span class="va">unit_count_min_</span><span class="op">{</span><span class="kw">sizeof</span><span class="op">(</span><span class="va">buff_</span><span class="op">)</span> <span class="op">/</span> Inner_<span class="op">::</span>unit_size<span class="op">};</span></span>
<span id="cb521-23"><a href="#cb521-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb521-24"><a href="#cb521-24" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span><span class="op">*</span> alloc<span class="op">(</span><span class="dt">size_t</span> size<span class="op">)</span> <span class="kw">noexcept</span> <span class="kw">override</span></span>
<span id="cb521-25"><a href="#cb521-25" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb521-26"><a href="#cb521-26" aria-hidden="true" tabindex="-1"></a>            <span class="op">...</span></span>
<span id="cb521-27"><a href="#cb521-27" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb521-28"><a href="#cb521-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb521-29"><a href="#cb521-29" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span> free<span class="op">(</span><span class="dt">void</span><span class="op">*</span> mem<span class="op">)</span> <span class="kw">noexcept</span> <span class="kw">override</span></span>
<span id="cb521-30"><a href="#cb521-30" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb521-31"><a href="#cb521-31" aria-hidden="true" tabindex="-1"></a>            <span class="op">...</span></span>
<span id="cb521-32"><a href="#cb521-32" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb521-33"><a href="#cb521-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb521-34"><a href="#cb521-34" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">size_t</span> get_size<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="kw">override</span> <span class="op">{</span> <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb521-35"><a href="#cb521-35" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">size_t</span> get_count<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="kw">override</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">unit_count_</span> <span class="op">*</span> Inner_<span class="op">::</span>unit_size<span class="op">;</span> <span class="op">}</span></span>
<span id="cb521-36"><a href="#cb521-36" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">size_t</span> get_count_min<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="kw">override</span></span>
<span id="cb521-37"><a href="#cb521-37" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb521-38"><a href="#cb521-38" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">unit_count_min_</span> <span class="op">*</span> Inner_<span class="op">::</span>unit_size<span class="op">;</span></span>
<span id="cb521-39"><a href="#cb521-39" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb521-40"><a href="#cb521-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb521-41"><a href="#cb521-41" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">bool</span> is_valid<span class="op">(</span><span class="dt">void</span> <span class="at">const</span><span class="op">*</span> mem<span class="op">)</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="kw">override</span></span>
<span id="cb521-42"><a href="#cb521-42" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb521-43"><a href="#cb521-43" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="op">(&amp;</span><span class="va">buff_</span> <span class="op">&lt;</span> mem<span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="op">(</span>mem <span class="op">&lt;</span> <span class="op">&amp;</span><span class="va">buff_</span><span class="op">.</span>buffer<span class="op">[</span>ArrayLength<span class="op">(</span><span class="va">buff_</span><span class="op">.</span>buffer<span class="op">)]);</span></span>
<span id="cb521-44"><a href="#cb521-44" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb521-45"><a href="#cb521-45" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>下記のようにMPoolVariable、 MPoolBasedAllocatorを使うことでnew
char[]に対応するアロケータが定義できる。</p>
<div class="sourceCode" id="cb522"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb522-1"><a href="#cb522-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/dynamic_memory_allocation/mpool_allocator_ut.cpp 11</span></span>
<span id="cb522-2"><a href="#cb522-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb522-3"><a href="#cb522-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> <span class="op">{</span></span>
<span id="cb522-4"><a href="#cb522-4" aria-hidden="true" tabindex="-1"></a>    MPoolVariable<span class="op">&lt;</span><span class="dv">1024</span> <span class="op">*</span> <span class="dv">64</span><span class="op">&gt;</span> mpv_allocator<span class="op">;</span></span>
<span id="cb522-5"><a href="#cb522-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb522-6"><a href="#cb522-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb522-7"><a href="#cb522-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;&gt;</span></span>
<span id="cb522-8"><a href="#cb522-8" aria-hidden="true" tabindex="-1"></a>    MPool<span class="op">&amp;</span> MPoolBasedAllocator<span class="op">&lt;</span><span class="dt">char</span><span class="op">&gt;::</span><span class="va">mpool_</span> <span class="op">=</span> mpv_allocator<span class="op">;</span></span></code></pre></div>
<p>下記の単体テストは、このアロケータを使うstd::stringオブジェクトの宣言方法と、
その振る舞いを示している。</p>
<div class="sourceCode" id="cb523"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb523-1"><a href="#cb523-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/dynamic_memory_allocation/mpool_allocator_ut.cpp 24</span></span>
<span id="cb523-2"><a href="#cb523-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb523-3"><a href="#cb523-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> rest <span class="op">=</span> mpv_allocator<span class="op">.</span>GetCount<span class="op">();</span></span>
<span id="cb523-4"><a href="#cb523-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> str  <span class="op">=</span> <span class="bu">std::</span>basic_string<span class="op">&lt;</span><span class="dt">char</span><span class="op">,</span> <span class="bu">std::</span>char_traits<span class="op">&lt;</span><span class="dt">char</span><span class="op">&gt;,</span> MPoolBasedAllocator<span class="op">&lt;</span><span class="dt">char</span><span class="op">&gt;&gt;{</span><span class="st">&quot;hehe&quot;</span><span class="op">};</span></span>
<span id="cb523-5"><a href="#cb523-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb523-6"><a href="#cb523-6" aria-hidden="true" tabindex="-1"></a>    ASSERT_TRUE<span class="op">(</span>mpv_allocator<span class="op">.</span>IsValid<span class="op">(</span>str<span class="op">.</span>c_str<span class="op">()));</span>  <span class="co">// mpv_allocatorを使用してメモリ確保</span></span>
<span id="cb523-7"><a href="#cb523-7" aria-hidden="true" tabindex="-1"></a>    ASSERT_GT<span class="op">(</span>rest<span class="op">,</span> mpv_allocator<span class="op">.</span>GetCount<span class="op">());</span>  <span class="co">// mpv_allocatorのメモリが減っていることの確認</span></span></code></pre></div>
<p>この長い宣言は、下記のようにすることで簡潔に記述できるようになる。</p>
<div class="sourceCode" id="cb524"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb524-1"><a href="#cb524-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/dynamic_memory_allocation/mpool_allocator_ut.cpp 34</span></span>
<span id="cb524-2"><a href="#cb524-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb524-3"><a href="#cb524-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> mpv_string <span class="op">=</span> <span class="bu">std::</span>basic_string<span class="op">&lt;</span><span class="dt">char</span><span class="op">,</span> <span class="bu">std::</span>char_traits<span class="op">&lt;</span><span class="dt">char</span><span class="op">&gt;,</span> MPoolBasedAllocator<span class="op">&lt;</span><span class="dt">char</span><span class="op">&gt;&gt;;</span></span></code></pre></div>
<p>下記のように宣言、定義することで、</p>
<div class="sourceCode" id="cb525"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb525-1"><a href="#cb525-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/dynamic_memory_allocation/mpool_allocator_ut.cpp 50</span></span>
<span id="cb525-2"><a href="#cb525-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb525-3"><a href="#cb525-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;&gt;</span></span>
<span id="cb525-4"><a href="#cb525-4" aria-hidden="true" tabindex="-1"></a>    MPool<span class="op">&amp;</span> MPoolBasedAllocator<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;::</span><span class="va">mpool_</span> <span class="op">=</span> mpv_allocator<span class="op">;</span></span>
<span id="cb525-5"><a href="#cb525-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb525-6"><a href="#cb525-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> mpv_vector_int <span class="op">=</span> <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> MPoolBasedAllocator<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;&gt;;</span></span></code></pre></div>
<p>下記の単体テストが示す通り、std::vector&lt;int&gt;にこのアロケータを使わせることもできる。</p>
<div class="sourceCode" id="cb526"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb526-1"><a href="#cb526-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/dynamic_memory_allocation/mpool_allocator_ut.cpp 61</span></span>
<span id="cb526-2"><a href="#cb526-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb526-3"><a href="#cb526-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> rest <span class="op">=</span> mpv_allocator<span class="op">.</span>GetCount<span class="op">();</span></span>
<span id="cb526-4"><a href="#cb526-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> ints <span class="op">=</span> mpv_vector_int<span class="op">{</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">};</span></span>
<span id="cb526-5"><a href="#cb526-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb526-6"><a href="#cb526-6" aria-hidden="true" tabindex="-1"></a>    ASSERT_TRUE<span class="op">(</span>mpv_allocator<span class="op">.</span>IsValid<span class="op">(&amp;</span>ints<span class="op">[</span><span class="dv">0</span><span class="op">]));</span>  <span class="co">// mpv_allocatorのメモリであることの確認</span></span>
<span id="cb526-7"><a href="#cb526-7" aria-hidden="true" tabindex="-1"></a>    ASSERT_GT<span class="op">(</span>rest<span class="op">,</span> mpv_allocator<span class="op">.</span>GetCount<span class="op">());</span>  <span class="co">// mpv_allocatorのメモリが減っていることの確認</span></span></code></pre></div>
<p>これまでの手法を組み合わせ下記のようにすることで、
std::stringと同等のオブジェクトを保持するstd::vectorを宣言することもできる。</p>
<div class="sourceCode" id="cb527"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb527-1"><a href="#cb527-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/dynamic_memory_allocation/mpool_allocator_ut.cpp 72</span></span>
<span id="cb527-2"><a href="#cb527-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-3"><a href="#cb527-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> mpv_vector_str <span class="op">=</span> <span class="bu">std::</span>vector<span class="op">&lt;</span>mpv_string<span class="op">,</span> MPoolBasedAllocator<span class="op">&lt;</span>mpv_string<span class="op">&gt;&gt;;</span></span>
<span id="cb527-4"><a href="#cb527-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-5"><a href="#cb527-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;&gt;</span></span>
<span id="cb527-6"><a href="#cb527-6" aria-hidden="true" tabindex="-1"></a>    MPool<span class="op">&amp;</span> MPoolBasedAllocator<span class="op">&lt;</span>mpv_string<span class="op">&gt;::</span><span class="va">mpool_</span> <span class="op">=</span> mpv_allocator<span class="op">;</span></span></code></pre></div>
<div class="sourceCode" id="cb528"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb528-1"><a href="#cb528-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/dynamic_memory_allocation/mpool_allocator_ut.cpp 94</span></span>
<span id="cb528-2"><a href="#cb528-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb528-3"><a href="#cb528-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> strs <span class="op">=</span> mpv_vector_str<span class="op">{</span><span class="st">&quot;1&quot;</span><span class="op">,</span> <span class="st">&quot;2&quot;</span><span class="op">,</span> <span class="st">&quot;3&quot;</span><span class="op">};</span></span>
<span id="cb528-4"><a href="#cb528-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb528-5"><a href="#cb528-5" aria-hidden="true" tabindex="-1"></a>    ASSERT_GT<span class="op">(</span>rest<span class="op">,</span> mpv_allocator<span class="op">.</span>GetCount<span class="op">());</span></span>
<span id="cb528-6"><a href="#cb528-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb528-7"><a href="#cb528-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> <span class="at">const</span><span class="op">&amp;</span> s <span class="op">:</span> strs<span class="op">)</span> <span class="op">{</span></span>
<span id="cb528-8"><a href="#cb528-8" aria-hidden="true" tabindex="-1"></a>        ASSERT_TRUE<span class="op">(</span>mpv_allocator<span class="op">.</span>IsValid<span class="op">(&amp;</span>s<span class="op">));</span>  <span class="co">// mpv_allocatorのメモリであることの確認</span></span>
<span id="cb528-9"><a href="#cb528-9" aria-hidden="true" tabindex="-1"></a>        ASSERT_TRUE<span class="op">(</span>mpv_allocator<span class="op">.</span>IsValid<span class="op">(</span>s<span class="op">.</span>c_str<span class="op">()));</span>  <span class="co">// mpv_allocatorのメモリであることの確認</span></span>
<span id="cb528-10"><a href="#cb528-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>しかし、下記に示すように、これまでの定義、
宣言のみではmpv_stringのnewにこのアロケータを使わせることはできない。</p>
<div class="sourceCode" id="cb529"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb529-1"><a href="#cb529-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/dynamic_memory_allocation/mpool_allocator_ut.cpp 121</span></span>
<span id="cb529-2"><a href="#cb529-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb529-3"><a href="#cb529-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> rest <span class="op">=</span> mpv_allocator<span class="op">.</span>GetCount<span class="op">();</span></span>
<span id="cb529-4"><a href="#cb529-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb529-5"><a href="#cb529-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> str0 <span class="op">=</span> <span class="bu">std::</span>make_unique<span class="op">&lt;</span>mpv_string<span class="op">&gt;();</span>  <span class="co">// グローバルnewが使われる</span></span>
<span id="cb529-6"><a href="#cb529-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb529-7"><a href="#cb529-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">// mpv_stringのnewにはmpv_allocatorは使われない</span></span>
<span id="cb529-8"><a href="#cb529-8" aria-hidden="true" tabindex="-1"></a>    ASSERT_FALSE<span class="op">(</span>mpv_allocator<span class="op">.</span>IsValid<span class="op">(</span>str0<span class="op">.</span>get<span class="op">()));</span></span>
<span id="cb529-9"><a href="#cb529-9" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>rest<span class="op">,</span> mpv_allocator<span class="op">.</span>GetCount<span class="op">());</span></span></code></pre></div>
<p>そうするためには、さらに下記のような定義が必要になる。</p>
<div class="sourceCode" id="cb530"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb530-1"><a href="#cb530-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/dynamic_memory_allocation/mpool_allocator_ut.cpp 108</span></span>
<span id="cb530-2"><a href="#cb530-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb530-3"><a href="#cb530-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> mpv_string_op_new <span class="op">:</span> OpNew<span class="op">&lt;</span>mpv_string_op_new<span class="op">&gt;,</span> mpv_string <span class="op">{</span></span>
<span id="cb530-4"><a href="#cb530-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> mpv_string<span class="op">::</span>basic_string<span class="op">;</span></span>
<span id="cb530-5"><a href="#cb530-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb530-6"><a href="#cb530-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb530-7"><a href="#cb530-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;&gt;</span></span>
<span id="cb530-8"><a href="#cb530-8" aria-hidden="true" tabindex="-1"></a>    MPool<span class="op">&amp;</span> OpNew<span class="op">&lt;</span>mpv_string_op_new<span class="op">&gt;::</span><span class="va">mpool_</span> <span class="op">=</span> mpv_allocator<span class="op">;</span></span></code></pre></div>
<p>このようにすることで、下記に示すように期待した動きになる。</p>
<div class="sourceCode" id="cb531"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb531-1"><a href="#cb531-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/dynamic_memory_allocation/mpool_allocator_ut.cpp 133</span></span>
<span id="cb531-2"><a href="#cb531-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb531-3"><a href="#cb531-3" aria-hidden="true" tabindex="-1"></a>    rest <span class="op">=</span> mpv_allocator<span class="op">.</span>GetCount<span class="op">();</span></span>
<span id="cb531-4"><a href="#cb531-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb531-5"><a href="#cb531-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> str1 <span class="op">=</span> <span class="bu">std::</span>make_unique<span class="op">&lt;</span>mpv_string_op_new<span class="op">&gt;();</span></span>
<span id="cb531-6"><a href="#cb531-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb531-7"><a href="#cb531-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">// mpv_string_op_newのnewにmpv_allocatorが使われる</span></span>
<span id="cb531-8"><a href="#cb531-8" aria-hidden="true" tabindex="-1"></a>    ASSERT_TRUE<span class="op">(</span>mpv_allocator<span class="op">.</span>IsValid<span class="op">(</span>str1<span class="op">.</span>get<span class="op">()));</span></span>
<span id="cb531-9"><a href="#cb531-9" aria-hidden="true" tabindex="-1"></a>    ASSERT_GT<span class="op">(</span>rest<span class="op">,</span> mpv_allocator<span class="op">.</span>GetCount<span class="op">());</span></span></code></pre></div>
<p>ただし、std::make_sharedを使用した場合、この関数のメモリアロケーションの最適化により、
下記に示すように期待した結果にならないため、注意が必要である。</p>
<div class="sourceCode" id="cb532"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb532-1"><a href="#cb532-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/dynamic_memory_allocation/mpool_allocator_ut.cpp 145</span></span>
<span id="cb532-2"><a href="#cb532-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb532-3"><a href="#cb532-3" aria-hidden="true" tabindex="-1"></a>    rest <span class="op">=</span> mpv_allocator<span class="op">.</span>GetCount<span class="op">();</span></span>
<span id="cb532-4"><a href="#cb532-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb532-5"><a href="#cb532-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> str2 <span class="op">=</span> <span class="bu">std::</span>make_shared<span class="op">&lt;</span>mpv_string_op_new<span class="op">&gt;();</span></span>
<span id="cb532-6"><a href="#cb532-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb532-7"><a href="#cb532-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">// mpv_string_op_newのnewにmpv_allocatorが使われない!!!</span></span>
<span id="cb532-8"><a href="#cb532-8" aria-hidden="true" tabindex="-1"></a>    ASSERT_FALSE<span class="op">(</span>mpv_allocator<span class="op">.</span>IsValid<span class="op">(</span>str2<span class="op">.</span>get<span class="op">()));</span></span>
<span id="cb532-9"><a href="#cb532-9" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>rest<span class="op">,</span> mpv_allocator<span class="op">.</span>GetCount<span class="op">());</span></span></code></pre></div>
<p>newをオーバーロードしたクラスをstd::shared_ptrで管理する場合、下記のようにしなければならない。</p>
<div class="sourceCode" id="cb533"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb533-1"><a href="#cb533-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/dynamic_memory_allocation/mpool_allocator_ut.cpp 157</span></span>
<span id="cb533-2"><a href="#cb533-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb533-3"><a href="#cb533-3" aria-hidden="true" tabindex="-1"></a>    rest <span class="op">=</span> mpv_allocator<span class="op">.</span>GetCount<span class="op">();</span></span>
<span id="cb533-4"><a href="#cb533-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb533-5"><a href="#cb533-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> str3 <span class="op">=</span> <span class="bu">std::</span>shared_ptr<span class="op">&lt;</span>mpv_string_op_new<span class="op">&gt;{</span><span class="kw">new</span> mpv_string_op_new<span class="op">};</span></span>
<span id="cb533-6"><a href="#cb533-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb533-7"><a href="#cb533-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">// mpv_string_op_newのnewにmpv_allocatorが使われる</span></span>
<span id="cb533-8"><a href="#cb533-8" aria-hidden="true" tabindex="-1"></a>    ASSERT_TRUE<span class="op">(</span>mpv_allocator<span class="op">.</span>IsValid<span class="op">(</span>str3<span class="op">.</span>get<span class="op">()));</span></span>
<span id="cb533-9"><a href="#cb533-9" aria-hidden="true" tabindex="-1"></a>    ASSERT_GT<span class="op">(</span>rest<span class="op">,</span> mpv_allocator<span class="op">.</span>GetCount<span class="op">());</span></span></code></pre></div>
<h3 id="デバッグ用イテレータ-1">デバッグ用イテレータ
<a id="SS_4_4_3"></a></h3>
<p><a href="#SS_4_4_2">可変長メモリプール</a>を使用すると、
メモリのフラグメントによりアロケーションが失敗することがあり得る。
このような事態が発生している可能性がある場合、
アロケータが保持しているメモリの状態を表示させることがデバッグの第一歩となる。</p>
<p>下記のコードは、そのためのインターフェースを提供する。</p>
<div class="sourceCode" id="cb534"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb534-1"><a href="#cb534-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/dynamic_memory_allocation/mpool_variable.h 59</span></span>
<span id="cb534-2"><a href="#cb534-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb534-3"><a href="#cb534-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="dt">uint32_t</span> MEM_SIZE<span class="op">&gt;</span></span>
<span id="cb534-4"><a href="#cb534-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> MPoolVariable <span class="kw">final</span> <span class="op">:</span> <span class="kw">public</span> MPool <span class="op">{</span></span>
<span id="cb534-5"><a href="#cb534-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb534-6"><a href="#cb534-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb534-7"><a href="#cb534-7" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 中略</span></span>
<span id="cb534-8"><a href="#cb534-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb534-9"><a href="#cb534-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb534-10"><a href="#cb534-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">class</span> const_iterator <span class="op">{</span></span>
<span id="cb534-11"><a href="#cb534-11" aria-hidden="true" tabindex="-1"></a>        <span class="kw">public</span><span class="op">:</span></span>
<span id="cb534-12"><a href="#cb534-12" aria-hidden="true" tabindex="-1"></a>            <span class="kw">explicit</span> const_iterator<span class="op">(</span>Inner_<span class="op">::</span><span class="dt">header_t</span> <span class="at">const</span><span class="op">*</span> header<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">:</span> <span class="va">header_</span><span class="op">{</span>header<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb534-13"><a href="#cb534-13" aria-hidden="true" tabindex="-1"></a>            const_iterator<span class="op">(</span>const_iterator <span class="at">const</span><span class="op">&amp;)</span> <span class="op">=</span> <span class="cf">default</span><span class="op">;</span></span>
<span id="cb534-14"><a href="#cb534-14" aria-hidden="true" tabindex="-1"></a>            const_iterator<span class="op">(</span>const_iterator<span class="op">&amp;&amp;)</span>      <span class="op">=</span> <span class="cf">default</span><span class="op">;</span></span>
<span id="cb534-15"><a href="#cb534-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb534-16"><a href="#cb534-16" aria-hidden="true" tabindex="-1"></a>            const_iterator<span class="op">&amp;</span> <span class="kw">operator</span><span class="op">++()</span> <span class="kw">noexcept</span>  <span class="co">// 前置++のみ実装</span></span>
<span id="cb534-17"><a href="#cb534-17" aria-hidden="true" tabindex="-1"></a>            <span class="op">{</span></span>
<span id="cb534-18"><a href="#cb534-18" aria-hidden="true" tabindex="-1"></a>                <span class="ot">assert</span><span class="op">(</span><span class="va">header_</span> <span class="op">!=</span> <span class="kw">nullptr</span><span class="op">);</span></span>
<span id="cb534-19"><a href="#cb534-19" aria-hidden="true" tabindex="-1"></a>                <span class="va">header_</span> <span class="op">=</span> <span class="va">header_</span><span class="op">-&gt;</span>next<span class="op">;</span></span>
<span id="cb534-20"><a href="#cb534-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb534-21"><a href="#cb534-21" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="op">*</span><span class="kw">this</span><span class="op">;</span></span>
<span id="cb534-22"><a href="#cb534-22" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb534-23"><a href="#cb534-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb534-24"><a href="#cb534-24" aria-hidden="true" tabindex="-1"></a>            Inner_<span class="op">::</span><span class="dt">header_t</span> <span class="at">const</span><span class="op">*</span> <span class="kw">operator</span><span class="op">*()</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">header_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb534-25"><a href="#cb534-25" aria-hidden="true" tabindex="-1"></a>            <span class="dt">bool</span> <span class="kw">operator</span><span class="op">==(</span>const_iterator <span class="at">const</span><span class="op">&amp;</span> rhs<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">header_</span> <span class="op">==</span> rhs<span class="op">.</span><span class="va">header_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb534-26"><a href="#cb534-26" aria-hidden="true" tabindex="-1"></a>            <span class="dt">bool</span> <span class="kw">operator</span><span class="op">!=(</span>const_iterator <span class="at">const</span><span class="op">&amp;</span> rhs<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="op">!(*</span><span class="kw">this</span> <span class="op">==</span> rhs<span class="op">);</span> <span class="op">}</span></span>
<span id="cb534-27"><a href="#cb534-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb534-28"><a href="#cb534-28" aria-hidden="true" tabindex="-1"></a>        <span class="kw">private</span><span class="op">:</span></span>
<span id="cb534-29"><a href="#cb534-29" aria-hidden="true" tabindex="-1"></a>            Inner_<span class="op">::</span><span class="dt">header_t</span> <span class="at">const</span><span class="op">*</span> <span class="va">header_</span><span class="op">;</span></span>
<span id="cb534-30"><a href="#cb534-30" aria-hidden="true" tabindex="-1"></a>        <span class="op">};</span></span>
<span id="cb534-31"><a href="#cb534-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb534-32"><a href="#cb534-32" aria-hidden="true" tabindex="-1"></a>        const_iterator begin<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> const_iterator<span class="op">{</span><span class="va">header_</span><span class="op">};</span> <span class="op">}</span></span>
<span id="cb534-33"><a href="#cb534-33" aria-hidden="true" tabindex="-1"></a>        const_iterator end<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> const_iterator<span class="op">{</span><span class="kw">nullptr</span><span class="op">};</span> <span class="op">}</span></span>
<span id="cb534-34"><a href="#cb534-34" aria-hidden="true" tabindex="-1"></a>        const_iterator cbegin<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> const_iterator<span class="op">{</span><span class="va">header_</span><span class="op">};</span> <span class="op">}</span></span>
<span id="cb534-35"><a href="#cb534-35" aria-hidden="true" tabindex="-1"></a>        const_iterator cend<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> const_iterator<span class="op">{</span><span class="kw">nullptr</span><span class="op">};</span> <span class="op">}</span></span>
<span id="cb534-36"><a href="#cb534-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb534-37"><a href="#cb534-37" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 中略</span></span>
<span id="cb534-38"><a href="#cb534-38" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb534-39"><a href="#cb534-39" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>このインターフェースを下記のように使用することで、</p>
<div class="sourceCode" id="cb535"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb535-1"><a href="#cb535-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/dynamic_memory_allocation/mpool_allocator_ut.cpp 213</span></span>
<span id="cb535-2"><a href="#cb535-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb535-3"><a href="#cb535-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> mem <span class="op">:</span> mpv_allocator<span class="op">)</span> <span class="op">{</span></span>
<span id="cb535-4"><a href="#cb535-4" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>cout<span class="op"> &lt;&lt;</span> <span class="bu">std::</span>setw<span class="op">(</span><span class="dv">16</span><span class="op">)</span> <span class="op">&lt;&lt;</span> mem<span class="op">-&gt;</span>next <span class="op">&lt;&lt;</span> <span class="st">&quot;:&quot;</span> <span class="op">&lt;&lt;</span> mem<span class="op">-&gt;</span>n_nuits <span class="op">&lt;&lt;</span> <span class="bu">std::</span>endl<span class="op">;</span></span>
<span id="cb535-5"><a href="#cb535-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>下記のようにmpv_allocator.header_が保持するメモリの現在の状態を見ることができる
(これによるとmpv_allocatorが保持するメモリの先頭付近では多少フラグメントを起こしているが、
最後に大きなメモリブロックがあるため、全体としては問題ないレベルである)。</p>
<pre><code>        0x7f073afe59d0:3
        0x7f073afe5a60:3
        0x7f073afe5ac0:3
        0x7f073afe5b70:3
        0x7f073afe5c50:11
        0x7f073afe5cb0:3
        0x7f073afe5e50:13
                     0:4018</code></pre>
<p>「<a
href="#SS_4_2_2">グローバルnew/deleteのオーバーロードの実装</a>」でも述べたように、
デバッグ用入出力機能からこのような出力を得られるようにしておくべきである。</p>
<h3 id="エクセプション処理機構の変更">エクセプション処理機構の変更
<a id="SS_4_4_4"></a></h3>
<p>多くのコンパイラのエクセプション処理機構にはnew/deleteやmalloc/freeが使われているため、
リアルタイム性が必要な個所でエクセプション処理を行ってはならない。
そういった規制でプログラミングを行っていると、
リアルタイム性が不要な処理であるため使用しているSTLコンテナにすら、
既存のエクセプション処理機構を使わせたく無くなるものである。</p>
<p>コンパイラに<a href="#SS_5_9_1">g++</a>や<a
href="#SS_5_9_2">clang++</a>を使っている場合、
下記関数を置き換えることでそういった要望を叶えることができる。</p>
<table>
<colgroup>
<col style="width: 58%" />
<col style="width: 41%" />
</colgroup>
<thead>
<tr class="header">
<th>関数</th>
<th>機能</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>__cxa_allocate_exception(size_t thrown_size)</td>
<td>エクセプション処理用のメモリ確保</td>
</tr>
<tr class="even">
<td>__cxa_free_exception(void* thrown_exception)</td>
<td>上記で確保したメモリの解放</td>
</tr>
</tbody>
</table>
<p>オープンソースである<a
href="https://github.com/ApexAI/static_exception">static
exception</a>を使うことで、
上記2関数を置き換えることもできるが、この実装が複雑すぎると思うのであれば、
下記に示すような、これまで使用したMPoolFixedによる単純な実装を使うこともできる。</p>
<div class="sourceCode" id="cb537"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb537-1"><a href="#cb537-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/dynamic_memory_allocation/exception_allocator_ut.cpp 12</span></span>
<span id="cb537-2"><a href="#cb537-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb537-3"><a href="#cb537-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// https://github.com/hjl-tools/gcc/blob/master/libstdc%2B%2B-v3/libsupc%2B%2B/unwind-cxx.h</span></span>
<span id="cb537-4"><a href="#cb537-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// の抜粋</span></span>
<span id="cb537-5"><a href="#cb537-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> __cxxabiv1 <span class="op">{</span></span>
<span id="cb537-6"><a href="#cb537-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> __cxa_exception <span class="op">{</span></span>
<span id="cb537-7"><a href="#cb537-7" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb537-8"><a href="#cb537-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb537-9"><a href="#cb537-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace __cxxabiv1</span></span>
<span id="cb537-10"><a href="#cb537-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb537-11"><a href="#cb537-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> <span class="op">{</span></span>
<span id="cb537-12"><a href="#cb537-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb537-13"><a href="#cb537-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">size_t</span>             offset<span class="op">{</span><span class="kw">sizeof</span><span class="op">(</span>__cxxabiv1<span class="op">::</span>__cxa_exception<span class="op">)};</span></span>
<span id="cb537-14"><a href="#cb537-14" aria-hidden="true" tabindex="-1"></a>    MPoolFixed<span class="op">&lt;</span>offset <span class="op">+</span> <span class="dv">128</span><span class="op">,</span> <span class="dv">50</span><span class="op">&gt;</span> mpf_exception<span class="op">;</span></span>
<span id="cb537-15"><a href="#cb537-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace</span></span>
<span id="cb537-16"><a href="#cb537-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb537-17"><a href="#cb537-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">extern</span> <span class="st">&quot;C&quot;</span> <span class="op">{</span></span>
<span id="cb537-18"><a href="#cb537-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb537-19"><a href="#cb537-19" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span><span class="op">*</span> __cxa_allocate_exception<span class="op">(</span><span class="dt">size_t</span> thrown_size<span class="op">)</span></span>
<span id="cb537-20"><a href="#cb537-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb537-21"><a href="#cb537-21" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> alloc_size <span class="op">=</span> thrown_size <span class="op">+</span> offset<span class="op">;</span>  <span class="co">// メモリの実際の必要量はthrown_size+offset</span></span>
<span id="cb537-22"><a href="#cb537-22" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> mem        <span class="op">=</span> mpf_exception<span class="op">.</span>AllocNoExcept<span class="op">(</span>alloc_size<span class="op">);</span></span>
<span id="cb537-23"><a href="#cb537-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb537-24"><a href="#cb537-24" aria-hidden="true" tabindex="-1"></a>        <span class="ot">assert</span><span class="op">(</span>mem <span class="op">!=</span> <span class="kw">nullptr</span><span class="op">);</span></span>
<span id="cb537-25"><a href="#cb537-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb537-26"><a href="#cb537-26" aria-hidden="true" tabindex="-1"></a>        memset<span class="op">(</span>mem<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> alloc_size<span class="op">);</span></span>
<span id="cb537-27"><a href="#cb537-27" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span><span class="op">*</span> ret <span class="op">=</span> <span class="kw">static_cast</span><span class="op">&lt;</span><span class="dt">uint8_t</span><span class="op">*&gt;(</span>mem<span class="op">);</span></span>
<span id="cb537-28"><a href="#cb537-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb537-29"><a href="#cb537-29" aria-hidden="true" tabindex="-1"></a>        ret <span class="op">+=</span> offset<span class="op">;</span></span>
<span id="cb537-30"><a href="#cb537-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb537-31"><a href="#cb537-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> ret<span class="op">;</span></span>
<span id="cb537-32"><a href="#cb537-32" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb537-33"><a href="#cb537-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb537-34"><a href="#cb537-34" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> __cxa_free_exception<span class="op">(</span><span class="dt">void</span><span class="op">*</span> thrown_exception<span class="op">)</span></span>
<span id="cb537-35"><a href="#cb537-35" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb537-36"><a href="#cb537-36" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span><span class="op">*</span> ret <span class="op">=</span> <span class="kw">static_cast</span><span class="op">&lt;</span><span class="dt">uint8_t</span><span class="op">*&gt;(</span>thrown_exception<span class="op">);</span></span>
<span id="cb537-37"><a href="#cb537-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb537-38"><a href="#cb537-38" aria-hidden="true" tabindex="-1"></a>        ret <span class="op">-=</span> offset<span class="op">;</span></span>
<span id="cb537-39"><a href="#cb537-39" aria-hidden="true" tabindex="-1"></a>        mpf_exception<span class="op">.</span>Free<span class="op">(</span>ret<span class="op">);</span></span>
<span id="cb537-40"><a href="#cb537-40" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>以下に単体テストを示す。</p>
<div class="sourceCode" id="cb538"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb538-1"><a href="#cb538-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/dynamic_memory_allocation/exception_allocator_ut.cpp 100</span></span>
<span id="cb538-2"><a href="#cb538-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-3"><a href="#cb538-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> count             <span class="op">=</span> mpf_exception<span class="op">.</span>GetCount<span class="op">();</span></span>
<span id="cb538-4"><a href="#cb538-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> exception_occured <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb538-5"><a href="#cb538-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-6"><a href="#cb538-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span> <span class="op">{</span></span>
<span id="cb538-7"><a href="#cb538-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">throw</span> <span class="bu">std::</span>exception<span class="op">{};</span></span>
<span id="cb538-8"><a href="#cb538-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb538-9"><a href="#cb538-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">catch</span> <span class="op">(</span><span class="bu">std::</span>exception<span class="op"> </span><span class="at">const</span><span class="op">&amp;</span> e<span class="op">)</span> <span class="op">{</span></span>
<span id="cb538-10"><a href="#cb538-10" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span>count <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> mpf_exception<span class="op">.</span>GetCount<span class="op">());</span>  <span class="co">// 1個消費</span></span>
<span id="cb538-11"><a href="#cb538-11" aria-hidden="true" tabindex="-1"></a>        exception_occured <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb538-12"><a href="#cb538-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb538-13"><a href="#cb538-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-14"><a href="#cb538-14" aria-hidden="true" tabindex="-1"></a>    ASSERT_TRUE<span class="op">(</span>exception_occured<span class="op">);</span></span>
<span id="cb538-15"><a href="#cb538-15" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>count<span class="op">,</span> mpf_exception<span class="op">.</span>GetCount<span class="op">());</span>  <span class="co">// 1個解放</span></span></code></pre></div>
<p>すでに述べたが、残念なことに、この方法はC++の標準外であるため、
これを適用できるコンパイラは限られている。
しかし、多くのコンパイラはこれと同様の拡張方法を備えているため、
安易にエクセプションやSTLコンテナを使用禁止することなく、安全に使用する方法を探るべきだろう。</p>
<!-- ./md/term_explanation.md -->
<h1 id="用語解説">用語解説 <a id="SS_5"></a></h1>
<p>この章では、このドキュメントで使用する用語の解説をする。</p>
<h2 id="型とインスタンス">型とインスタンス <a id="SS_5_1"></a></h2>
<h3 id="算術型">算術型 <a id="SS_5_1_1"></a></h3>
<p>算術型とは下記の型の総称である。</p>
<ul>
<li><a href="#SS_5_1_2">汎整数型</a>(bool, char, int, unsigned int, long
long等)</li>
<li>浮動小数点型(float、double、long double)</li>
</ul>
<p>算術型のサイズは下記のように規定されている。</p>
<ul>
<li>1 == sizeof(bool) == sizeof(char)</li>
<li>sizeof(char) &lt;= sizeof(short) &lt;= sizeof(int) &lt;=
sizeof(long) &lt;= sizeof(long long)</li>
<li>4 &lt;= sizeof(long)</li>
<li>8 &lt;= sizeof(long long)</li>
<li>4 == sizeof(float)</li>
<li>8 == sizeof(double) &lt;= sizeof(long double)</li>
</ul>
<h3 id="汎整数型">汎整数型 <a id="SS_5_1_2"></a></h3>
<p>汎整数型とは下記の型の総称である。</p>
<ul>
<li>論理型(bool)</li>
<li>文字型(char、wchar_t等)</li>
<li><a href="#SS_5_1_3">整数型</a>(int、unsigned int、long等)</li>
</ul>
<h3 id="整数型">整数型 <a id="SS_5_1_3"></a></h3>
<p>整数型とは下記の型の総称である。</p>
<ul>
<li>char</li>
<li>signed char</li>
<li>unsigned char</li>
<li>short</li>
<li>unsigned short</li>
<li>int</li>
<li>unsigned int</li>
<li>long</li>
<li>unsigned long</li>
<li>long long</li>
<li>unsigned long long</li>
</ul>
<h3 id="算術変換">算術変換 <a id="SS_5_1_4"></a></h3>
<p>C++における算術変換とは、算術演算の1つのオペランドが他のオペランドと同じ型でない場合、
1つのオペランドを他のオペランドと同じ型に変換するプロセスのことを指す。</p>
<p>算術変換は、<a
href="#SS_5_1_5">汎整数拡張</a>と通常算術変換に分けられる。</p>
<div class="sourceCode" id="cb539"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb539-1"><a href="#cb539-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/integral_promotion_ut.cpp 11</span></span>
<span id="cb539-2"><a href="#cb539-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb539-3"><a href="#cb539-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bool</span>           bval<span class="op">{};</span></span>
<span id="cb539-4"><a href="#cb539-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span>           cval<span class="op">{};</span></span>
<span id="cb539-5"><a href="#cb539-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">short</span>          sval<span class="op">{};</span></span>
<span id="cb539-6"><a href="#cb539-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">unsigned</span> <span class="dt">short</span> usval<span class="op">{};</span></span>
<span id="cb539-7"><a href="#cb539-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span>            ival<span class="op">{};</span></span>
<span id="cb539-8"><a href="#cb539-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">unsigned</span> <span class="dt">int</span>   uival<span class="op">{};</span></span>
<span id="cb539-9"><a href="#cb539-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span>           lval<span class="op">{};</span></span>
<span id="cb539-10"><a href="#cb539-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">unsigned</span> <span class="dt">long</span>  ulval<span class="op">{};</span></span>
<span id="cb539-11"><a href="#cb539-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">float</span>          fval<span class="op">{};</span></span>
<span id="cb539-12"><a href="#cb539-12" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span>         dval<span class="op">{};</span></span>
<span id="cb539-13"><a href="#cb539-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb539-14"><a href="#cb539-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> ret_0 <span class="op">=</span> <span class="fl">3.14159</span> <span class="op">+</span> <span class="ch">&#39;a&#39;</span><span class="op">;</span>  <span class="co">// &#39;a&#39;は汎整数拡張でintになった後、さらに通常算術変換でdoubleに</span></span>
<span id="cb539-15"><a href="#cb539-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span>ret_0<span class="op">),</span> <span class="dt">double</span><span class="op">&gt;::</span>value<span class="op">,</span> <span class="st">&quot;&quot;</span><span class="op">);</span></span>
<span id="cb539-16"><a href="#cb539-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb539-17"><a href="#cb539-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> ret_1 <span class="op">=</span> dval <span class="op">+</span> ival<span class="op">;</span>  <span class="co">// ivalは通常算術変換でdoubleに</span></span>
<span id="cb539-18"><a href="#cb539-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span>ret_1<span class="op">),</span> <span class="dt">double</span><span class="op">&gt;::</span>value<span class="op">,</span> <span class="st">&quot;&quot;</span><span class="op">);</span></span>
<span id="cb539-19"><a href="#cb539-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb539-20"><a href="#cb539-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> ret_2 <span class="op">=</span> dval <span class="op">+</span> fval<span class="op">;</span>  <span class="co">// fvalは通常算術変換でdoubleに</span></span>
<span id="cb539-21"><a href="#cb539-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span>ret_2<span class="op">),</span> <span class="dt">double</span><span class="op">&gt;::</span>value<span class="op">,</span> <span class="st">&quot;&quot;</span><span class="op">);</span></span>
<span id="cb539-22"><a href="#cb539-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb539-23"><a href="#cb539-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> ret_3 <span class="op">=</span> ival <span class="op">=</span> dval<span class="op">;</span>  <span class="co">// dvalは通常算術変換でintに</span></span>
<span id="cb539-24"><a href="#cb539-24" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span>ret_3<span class="op">),</span> <span class="dt">int</span><span class="op">&gt;::</span>value<span class="op">,</span> <span class="st">&quot;&quot;</span><span class="op">);</span></span>
<span id="cb539-25"><a href="#cb539-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb539-26"><a href="#cb539-26" aria-hidden="true" tabindex="-1"></a>    bval <span class="op">=</span> dval<span class="op">;</span>  <span class="co">// dvalは通常算術変換でboolに</span></span>
<span id="cb539-27"><a href="#cb539-27" aria-hidden="true" tabindex="-1"></a>    ASSERT_FALSE<span class="op">(</span>bval<span class="op">);</span></span>
<span id="cb539-28"><a href="#cb539-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb539-29"><a href="#cb539-29" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> ret_4 <span class="op">=</span> cval <span class="op">+</span> fval<span class="op">;</span>  <span class="co">// cvalは汎整数拡張でintになった後、さらに通常算術変換でfloatに</span></span>
<span id="cb539-30"><a href="#cb539-30" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span>ret_4<span class="op">),</span> <span class="dt">float</span><span class="op">&gt;::</span>value<span class="op">,</span> <span class="st">&quot;&quot;</span><span class="op">);</span></span>
<span id="cb539-31"><a href="#cb539-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb539-32"><a href="#cb539-32" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> ret_5 <span class="op">=</span> sval <span class="op">+</span> cval<span class="op">;</span>  <span class="co">// svalとcvalは汎整数拡張でintに</span></span>
<span id="cb539-33"><a href="#cb539-33" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span>ret_5<span class="op">),</span> <span class="dt">int</span><span class="op">&gt;::</span>value<span class="op">,</span> <span class="st">&quot;&quot;</span><span class="op">);</span></span>
<span id="cb539-34"><a href="#cb539-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb539-35"><a href="#cb539-35" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> ret_6 <span class="op">=</span> cval <span class="op">+</span> lval<span class="op">;</span>  <span class="co">// cvalはは汎整数拡張でintになった後、通常算術変換でlongに</span></span>
<span id="cb539-36"><a href="#cb539-36" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span>ret_6<span class="op">),</span> <span class="dt">long</span><span class="op">&gt;::</span>value<span class="op">,</span> <span class="st">&quot;&quot;</span><span class="op">);</span></span>
<span id="cb539-37"><a href="#cb539-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb539-38"><a href="#cb539-38" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> ret_7 <span class="op">=</span> ival <span class="op">+</span> ulval<span class="op">;</span>  <span class="co">// ivalは通常算術変換でunsigned longに</span></span>
<span id="cb539-39"><a href="#cb539-39" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span>ret_7<span class="op">),</span> <span class="dt">unsigned</span> <span class="dt">long</span><span class="op">&gt;::</span>value<span class="op">,</span> <span class="st">&quot;&quot;</span><span class="op">);</span></span>
<span id="cb539-40"><a href="#cb539-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb539-41"><a href="#cb539-41" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> ret_8 <span class="op">=</span> usval <span class="op">+</span> ival<span class="op">;</span>  <span class="co">// usvalは汎整数拡張でintに</span></span>
<span id="cb539-42"><a href="#cb539-42" aria-hidden="true" tabindex="-1"></a>                                <span class="co">// ただし、この変換はunsigned shortとintのサイズに依存する</span></span>
<span id="cb539-43"><a href="#cb539-43" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span>ret_8<span class="op">),</span> <span class="dt">int</span><span class="op">&gt;::</span>value<span class="op">,</span> <span class="st">&quot;&quot;</span><span class="op">);</span></span>
<span id="cb539-44"><a href="#cb539-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb539-45"><a href="#cb539-45" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> ret_9 <span class="op">=</span> uival <span class="op">+</span> lval<span class="op">;</span>  <span class="co">// uivalは通常算術変換でlongに</span></span>
<span id="cb539-46"><a href="#cb539-46" aria-hidden="true" tabindex="-1"></a>                                <span class="co">// ただし、この変換はunsigned intとlongのサイズに依存する</span></span>
<span id="cb539-47"><a href="#cb539-47" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span>ret_9<span class="op">),</span> <span class="dt">long</span><span class="op">&gt;::</span>value<span class="op">,</span> <span class="st">&quot;&quot;</span><span class="op">);</span></span></code></pre></div>
<p>一様初期を使用することで、
変数定義時の算術変換による意図しない値の変換(縮小型変換)を防ぐことができる。</p>
<div class="sourceCode" id="cb540"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb540-1"><a href="#cb540-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/integral_promotion_ut.cpp 62</span></span>
<span id="cb540-2"><a href="#cb540-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb540-3"><a href="#cb540-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i<span class="op">{-</span><span class="dv">1</span><span class="op">};</span></span>
<span id="cb540-4"><a href="#cb540-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// int8_t i8 {i};  縮小型変換によりコンパイル不可</span></span>
<span id="cb540-5"><a href="#cb540-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int8_t</span> i8 <span class="op">=</span> i<span class="op">;</span>  <span class="co">// intからint8_tへの型変換</span></span>
<span id="cb540-6"><a href="#cb540-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">// これには問題ないが</span></span>
<span id="cb540-7"><a href="#cb540-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb540-8"><a href="#cb540-8" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(-</span><span class="dv">1</span><span class="op">,</span> i8<span class="op">);</span></span>
<span id="cb540-9"><a href="#cb540-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb540-10"><a href="#cb540-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">// uint8_t ui8 {i};  縮小型変換によりコンパイル不可</span></span>
<span id="cb540-11"><a href="#cb540-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">uint8_t</span> ui8 <span class="op">=</span> i<span class="op">;</span>  <span class="co">// intからuint8_tへの型変換</span></span>
<span id="cb540-12"><a href="#cb540-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">// おそらく意図通りではない</span></span>
<span id="cb540-13"><a href="#cb540-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb540-14"><a href="#cb540-14" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">255</span><span class="op">,</span> ui8<span class="op">);</span></span></code></pre></div>
<p>以下に示すように、算術変換の結果は直感に反することがあるため、注意が必要である。</p>
<div class="sourceCode" id="cb541"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb541-1"><a href="#cb541-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/integral_promotion_ut.cpp 81</span></span>
<span id="cb541-2"><a href="#cb541-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb541-3"><a href="#cb541-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span>          i<span class="op">{-</span><span class="dv">1</span><span class="op">};</span></span>
<span id="cb541-4"><a href="#cb541-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">unsigned</span> <span class="dt">int</span> ui<span class="op">{</span><span class="dv">1</span><span class="op">};</span></span>
<span id="cb541-5"><a href="#cb541-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb541-6"><a href="#cb541-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ASSERT_TRUE(i &lt; ui);</span></span>
<span id="cb541-7"><a href="#cb541-7" aria-hidden="true" tabindex="-1"></a>    ASSERT_TRUE<span class="op">(</span>i <span class="op">&gt;</span> ui<span class="op">);</span>  <span class="co">// 算術変換の影響で、-1 &lt; 1が成立しない</span></span>
<span id="cb541-8"><a href="#cb541-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb541-9"><a href="#cb541-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">signed</span> <span class="dt">short</span>   s<span class="op">{-</span><span class="dv">1</span><span class="op">};</span></span>
<span id="cb541-10"><a href="#cb541-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">unsigned</span> <span class="dt">short</span> us<span class="op">{</span><span class="dv">1</span><span class="op">};</span></span>
<span id="cb541-11"><a href="#cb541-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb541-12"><a href="#cb541-12" aria-hidden="true" tabindex="-1"></a>    ASSERT_TRUE<span class="op">(</span>s <span class="op">&lt;</span> us<span class="op">);</span>  <span class="co">// 汎整数拡張により、-1 &lt; 1が成立</span></span></code></pre></div>
<h3 id="汎整数拡張">汎整数拡張 <a id="SS_5_1_5"></a></h3>
<p>bool、char、signed char、unsigned char、short、unsigned
short型の変数が、 算術のオペランドとして使用される場合、</p>
<ul>
<li>その変数の型の取り得る値全てがintで表現できるのならば、int型に変換される。</li>
<li>そうでなければ、その変数はunsigned int型に変換される。</li>
</ul>
<p>この変換を汎整数拡張と呼ぶ。</p>
<p>従って、sizof(short) &lt; sizeof(int)である処理系では、
bool、char、signed char、unsigned char、short、unsigned
short型の変数は、 下記のようにintに変換される。</p>
<div class="sourceCode" id="cb542"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb542-1"><a href="#cb542-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/integral_promotion_ut.cpp 100</span></span>
<span id="cb542-2"><a href="#cb542-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb542-3"><a href="#cb542-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bool</span> bval<span class="op">;</span></span>
<span id="cb542-4"><a href="#cb542-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="kw">decltype</span><span class="op">(</span>bval <span class="op">+</span> bval<span class="op">)&gt;::</span>value<span class="op">,</span> <span class="st">&quot;&quot;</span><span class="op">);</span></span>
<span id="cb542-5"><a href="#cb542-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb542-6"><a href="#cb542-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> cval<span class="op">;</span></span>
<span id="cb542-7"><a href="#cb542-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="kw">decltype</span><span class="op">(</span>cval <span class="op">+</span> cval<span class="op">)&gt;::</span>value<span class="op">,</span> <span class="st">&quot;&quot;</span><span class="op">);</span></span>
<span id="cb542-8"><a href="#cb542-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb542-9"><a href="#cb542-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">unsigned</span> <span class="dt">char</span> ucval <span class="op">=</span> <span class="dv">128</span><span class="op">;</span></span>
<span id="cb542-10"><a href="#cb542-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="kw">decltype</span><span class="op">(</span>ucval <span class="op">+</span> ucval<span class="op">)&gt;::</span>value<span class="op">,</span> <span class="st">&quot;&quot;</span><span class="op">);</span></span>
<span id="cb542-11"><a href="#cb542-11" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">256</span><span class="op">,</span> ucval <span class="op">+</span> ucval<span class="op">);</span>  <span class="co">// 汎整数拡張により256になる</span></span>
<span id="cb542-12"><a href="#cb542-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb542-13"><a href="#cb542-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="kw">decltype</span><span class="op">(</span>cval <span class="op">+</span> ucval<span class="op">)&gt;::</span>value<span class="op">,</span> <span class="st">&quot;&quot;</span><span class="op">);</span></span>
<span id="cb542-14"><a href="#cb542-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb542-15"><a href="#cb542-15" aria-hidden="true" tabindex="-1"></a>    <span class="dt">short</span> sval<span class="op">;</span></span>
<span id="cb542-16"><a href="#cb542-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="kw">decltype</span><span class="op">(</span>sval <span class="op">+</span> sval<span class="op">)&gt;::</span>value<span class="op">,</span> <span class="st">&quot;&quot;</span><span class="op">);</span></span>
<span id="cb542-17"><a href="#cb542-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb542-18"><a href="#cb542-18" aria-hidden="true" tabindex="-1"></a>    <span class="dt">unsigned</span> <span class="dt">short</span> usval<span class="op">;</span></span>
<span id="cb542-19"><a href="#cb542-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="kw">decltype</span><span class="op">(</span>usval <span class="op">+</span> usval<span class="op">)&gt;::</span>value<span class="op">,</span> <span class="st">&quot;&quot;</span><span class="op">);</span></span>
<span id="cb542-20"><a href="#cb542-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb542-21"><a href="#cb542-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="kw">decltype</span><span class="op">(</span>sval <span class="op">+</span> usval<span class="op">)&gt;::</span>value<span class="op">,</span> <span class="st">&quot;&quot;</span><span class="op">);</span></span></code></pre></div>
<h3 id="pod">POD <a id="SS_5_1_6"></a></h3>
<p>PODとは、 Plain Old Dataの略語であり、</p>
<div class="sourceCode" id="cb543"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb543-1"><a href="#cb543-1" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>is_pod<span class="op">&lt;</span>T<span class="op">&gt;::</span>value</span></code></pre></div>
<p>がtrueとなる型Tを指す。下記のコードはその使用例である。</p>
<div class="sourceCode" id="cb544"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb544-1"><a href="#cb544-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/pod_ut.cpp 7</span></span>
<span id="cb544-2"><a href="#cb544-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb544-3"><a href="#cb544-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_pod<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;::</span>value<span class="op">,</span> <span class="st">&quot;&quot;</span><span class="op">);</span></span>
<span id="cb544-4"><a href="#cb544-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_pod<span class="op">&lt;</span><span class="dt">int</span> <span class="at">const</span><span class="op">&gt;::</span>value<span class="op">,</span> <span class="st">&quot;&quot;</span><span class="op">);</span></span>
<span id="cb544-5"><a href="#cb544-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_pod<span class="op">&lt;</span><span class="dt">int</span><span class="op">*&gt;::</span>value<span class="op">,</span> <span class="st">&quot;&quot;</span><span class="op">);</span></span>
<span id="cb544-6"><a href="#cb544-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_pod<span class="op">&lt;</span><span class="dt">int</span><span class="op">[</span><span class="dv">3</span><span class="op">]&gt;::</span>value<span class="op">,</span> <span class="st">&quot;&quot;</span><span class="op">);</span></span>
<span id="cb544-7"><a href="#cb544-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span><span class="bu">std::</span>is_pod<span class="op">&lt;</span><span class="dt">int</span><span class="op">&amp;&gt;::</span>value<span class="op">,</span> <span class="st">&quot;&quot;</span><span class="op">);</span>  <span class="co">// リファレンスはPODではない</span></span>
<span id="cb544-8"><a href="#cb544-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb544-9"><a href="#cb544-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> Pod <span class="op">{};</span></span>
<span id="cb544-10"><a href="#cb544-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb544-11"><a href="#cb544-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_pod<span class="op">&lt;</span>Pod<span class="op">&gt;::</span>value<span class="op">,</span> <span class="st">&quot;&quot;</span><span class="op">);</span></span>
<span id="cb544-12"><a href="#cb544-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_pod<span class="op">&lt;</span>Pod <span class="at">const</span><span class="op">&gt;::</span>value<span class="op">,</span> <span class="st">&quot;&quot;</span><span class="op">);</span></span>
<span id="cb544-13"><a href="#cb544-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_pod<span class="op">&lt;</span>Pod<span class="op">*&gt;::</span>value<span class="op">,</span> <span class="st">&quot;&quot;</span><span class="op">);</span></span>
<span id="cb544-14"><a href="#cb544-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_pod<span class="op">&lt;</span>Pod<span class="op">[</span><span class="dv">3</span><span class="op">]&gt;::</span>value<span class="op">,</span> <span class="st">&quot;&quot;</span><span class="op">);</span></span>
<span id="cb544-15"><a href="#cb544-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span><span class="bu">std::</span>is_pod<span class="op">&lt;</span>Pod<span class="op">&amp;&gt;::</span>value<span class="op">,</span> <span class="st">&quot;&quot;</span><span class="op">);</span></span>
<span id="cb544-16"><a href="#cb544-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb544-17"><a href="#cb544-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> NonPod <span class="op">{</span>  <span class="co">// コンストラクタがあるためPODではない</span></span>
<span id="cb544-18"><a href="#cb544-18" aria-hidden="true" tabindex="-1"></a>        NonPod<span class="op">();</span></span>
<span id="cb544-19"><a href="#cb544-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb544-20"><a href="#cb544-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb544-21"><a href="#cb544-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span><span class="bu">std::</span>is_pod<span class="op">&lt;</span>NonPod<span class="op">&gt;::</span>value<span class="op">,</span> <span class="st">&quot;&quot;</span><span class="op">);</span></span></code></pre></div>
<p>概ね、C言語と互換性のある型を指すと思って良い。</p>
<p>「型が<a href="#SS_5_1_8">トリビアル型</a>且つ<a
href="#SS_5_1_7">標準レイアウト型</a>であること」と 「型が<a
href="#SS_5_1_6">POD</a>であること」は等価であるため、C++20では、 <a
href="https://cpprefjp.github.io/lang/cpp20/deprecate_pod.html">PODという用語は非推奨</a>となった。</p>
<h3 id="標準レイアウト型">標準レイアウト型 <a id="SS_5_1_7"></a></h3>
<p>標準レイアウト型とは、</p>
<div class="sourceCode" id="cb545"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb545-1"><a href="#cb545-1" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>is_standard_layout<span class="op">&lt;</span>T<span class="op">&gt;::</span>value</span></code></pre></div>
<p>がtrueとなる型Tを指す。下記のコードはその使用例である。</p>
<div class="sourceCode" id="cb546"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb546-1"><a href="#cb546-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/pod_ut.cpp 31</span></span>
<span id="cb546-2"><a href="#cb546-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb546-3"><a href="#cb546-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_standard_layout<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;::</span>value<span class="op">,</span> <span class="st">&quot;&quot;</span><span class="op">);</span></span>
<span id="cb546-4"><a href="#cb546-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_standard_layout<span class="op">&lt;</span><span class="dt">int</span><span class="op">*&gt;::</span>value<span class="op">,</span> <span class="st">&quot;&quot;</span><span class="op">);</span></span>
<span id="cb546-5"><a href="#cb546-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_standard_layout<span class="op">&lt;</span><span class="dt">int</span><span class="op">[</span><span class="dv">1</span><span class="op">]&gt;::</span>value<span class="op">,</span> <span class="st">&quot;&quot;</span><span class="op">);</span></span>
<span id="cb546-6"><a href="#cb546-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span><span class="bu">std::</span>is_standard_layout<span class="op">&lt;</span><span class="dt">int</span><span class="op">&amp;&gt;::</span>value<span class="op">,</span> <span class="st">&quot;&quot;</span><span class="op">);</span></span>
<span id="cb546-7"><a href="#cb546-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb546-8"><a href="#cb546-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">enum</span> <span class="kw">class</span> SizeUndefined <span class="op">{</span> su_0<span class="op">,</span> su_1 <span class="op">};</span></span>
<span id="cb546-9"><a href="#cb546-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb546-10"><a href="#cb546-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> StanderdLayout <span class="op">{</span>  <span class="co">// 標準レイアウトだがトリビアルではない</span></span>
<span id="cb546-11"><a href="#cb546-11" aria-hidden="true" tabindex="-1"></a>        StanderdLayout<span class="op">()</span> <span class="op">:</span> a<span class="op">{</span><span class="dv">0</span><span class="op">},</span> b<span class="op">{</span>SizeUndefined<span class="op">::</span>su_0<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb546-12"><a href="#cb546-12" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span>           a<span class="op">;</span></span>
<span id="cb546-13"><a href="#cb546-13" aria-hidden="true" tabindex="-1"></a>        SizeUndefined b<span class="op">;</span></span>
<span id="cb546-14"><a href="#cb546-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb546-15"><a href="#cb546-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb546-16"><a href="#cb546-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_standard_layout<span class="op">&lt;</span>StanderdLayout<span class="op">&gt;::</span>value<span class="op">,</span> <span class="st">&quot;&quot;</span><span class="op">);</span></span>
<span id="cb546-17"><a href="#cb546-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span><span class="bu">std::</span>is_trivial<span class="op">&lt;</span>StanderdLayout<span class="op">&gt;::</span>value<span class="op">,</span> <span class="st">&quot;&quot;</span><span class="op">);</span></span>
<span id="cb546-18"><a href="#cb546-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span><span class="bu">std::</span>is_pod<span class="op">&lt;</span>StanderdLayout<span class="op">&gt;::</span>value<span class="op">,</span> <span class="st">&quot;&quot;</span><span class="op">);</span></span></code></pre></div>
<p>型がPODである場合、その型は標準レイアウト型である。</p>
<h3 id="トリビアル型">トリビアル型 <a id="SS_5_1_8"></a></h3>
<p>トリビアル型とは、</p>
<div class="sourceCode" id="cb547"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb547-1"><a href="#cb547-1" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>is_trivial<span class="op">&lt;</span>T<span class="op">&gt;::</span>value</span></code></pre></div>
<p>がtrueとなる型Tを指す。下記のコードはその使用例である。</p>
<div class="sourceCode" id="cb548"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb548-1"><a href="#cb548-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/pod_ut.cpp 52</span></span>
<span id="cb548-2"><a href="#cb548-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb548-3"><a href="#cb548-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_trivial<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;::</span>value<span class="op">,</span> <span class="st">&quot;&quot;</span><span class="op">);</span></span>
<span id="cb548-4"><a href="#cb548-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_trivial<span class="op">&lt;</span><span class="dt">int</span><span class="op">*&gt;::</span>value<span class="op">,</span> <span class="st">&quot;&quot;</span><span class="op">);</span></span>
<span id="cb548-5"><a href="#cb548-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_trivial<span class="op">&lt;</span><span class="dt">int</span><span class="op">[</span><span class="dv">1</span><span class="op">]&gt;::</span>value<span class="op">,</span> <span class="st">&quot;&quot;</span><span class="op">);</span></span>
<span id="cb548-6"><a href="#cb548-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span><span class="bu">std::</span>is_trivial<span class="op">&lt;</span><span class="dt">int</span><span class="op">&amp;&gt;::</span>value<span class="op">,</span> <span class="st">&quot;&quot;</span><span class="op">);</span></span>
<span id="cb548-7"><a href="#cb548-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb548-8"><a href="#cb548-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">enum</span> <span class="kw">class</span> SizeUndefined <span class="op">{</span> su_0<span class="op">,</span> su_1 <span class="op">};</span></span>
<span id="cb548-9"><a href="#cb548-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb548-10"><a href="#cb548-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> Trivial <span class="op">{</span>      <span class="co">// トリビアルだが標準レイアウトではない</span></span>
<span id="cb548-11"><a href="#cb548-11" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span><span class="op">&amp;</span>          a<span class="op">;</span>  <span class="co">// リファレンスは標準レイアウトではない</span></span>
<span id="cb548-12"><a href="#cb548-12" aria-hidden="true" tabindex="-1"></a>        SizeUndefined b<span class="op">;</span></span>
<span id="cb548-13"><a href="#cb548-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb548-14"><a href="#cb548-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb548-15"><a href="#cb548-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span><span class="bu">std::</span>is_standard_layout<span class="op">&lt;</span>Trivial<span class="op">&gt;::</span>value<span class="op">,</span> <span class="st">&quot;&quot;</span><span class="op">);</span></span>
<span id="cb548-16"><a href="#cb548-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_trivial<span class="op">&lt;</span>Trivial<span class="op">&gt;::</span>value<span class="op">,</span> <span class="st">&quot;&quot;</span><span class="op">);</span></span>
<span id="cb548-17"><a href="#cb548-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(!</span><span class="bu">std::</span>is_pod<span class="op">&lt;</span>Trivial<span class="op">&gt;::</span>value<span class="op">,</span> <span class="st">&quot;&quot;</span><span class="op">);</span></span></code></pre></div>
<p>型がPODである場合、その型はトリビアル型である。</p>
<h3 id="underlying-type">underlying type <a id="SS_5_1_9"></a></h3>
<p>underlying typeとは、enumやenum
classの汎整数表現を指定できるようにするために、
C++11で導入されたシンタックスである。</p>
<div class="sourceCode" id="cb549"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb549-1"><a href="#cb549-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/underlying_type_ut.cpp 9</span></span>
<span id="cb549-2"><a href="#cb549-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb549-3"><a href="#cb549-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 従来のenum</span></span>
<span id="cb549-4"><a href="#cb549-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">enum</span> NormalEnum <span class="op">{</span></span>
<span id="cb549-5"><a href="#cb549-5" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb549-6"><a href="#cb549-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb549-7"><a href="#cb549-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb549-8"><a href="#cb549-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">// enum underlying typeがint8_tに指定された従来のenum</span></span>
<span id="cb549-9"><a href="#cb549-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">enum</span> NormalEnumWithUnderlyingType <span class="op">:</span> <span class="dt">int8_t</span> <span class="op">{</span></span>
<span id="cb549-10"><a href="#cb549-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb549-11"><a href="#cb549-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb549-12"><a href="#cb549-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb549-13"><a href="#cb549-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">// enum class</span></span>
<span id="cb549-14"><a href="#cb549-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">enum</span> <span class="kw">class</span> EnumClass <span class="op">{</span></span>
<span id="cb549-15"><a href="#cb549-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb549-16"><a href="#cb549-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb549-17"><a href="#cb549-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb549-18"><a href="#cb549-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">// enum underlying typeがint64_tに指定されたenum class</span></span>
<span id="cb549-19"><a href="#cb549-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">enum</span> <span class="kw">class</span> EnumClassWithUnderlyingType <span class="op">:</span> <span class="dt">int64_t</span> <span class="op">{</span></span>
<span id="cb549-20"><a href="#cb549-20" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb549-21"><a href="#cb549-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb550"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb550-1"><a href="#cb550-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/underlying_type_ut.cpp 38</span></span>
<span id="cb550-2"><a href="#cb550-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb550-3"><a href="#cb550-3" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">4</span><span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>NormalEnum<span class="op">));</span>  <span class="co">// 列挙子の値を表現するのに十分なサイズの整数型で処理系依存</span></span>
<span id="cb550-4"><a href="#cb550-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb550-5"><a href="#cb550-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// NormalEnumWithUnderlyingTypeのunderlying typeはint8_t</span></span>
<span id="cb550-6"><a href="#cb550-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="dt">int8_t</span><span class="op">,</span> <span class="bu">std::</span>underlying_type_t<span class="op">&lt;</span>NormalEnumWithUnderlyingType<span class="op">&gt;&gt;);</span></span>
<span id="cb550-7"><a href="#cb550-7" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="kw">sizeof</span><span class="op">(</span><span class="dt">int8_t</span><span class="op">),</span> <span class="kw">sizeof</span><span class="op">(</span>NormalEnumWithUnderlyingType<span class="op">));</span></span>
<span id="cb550-8"><a href="#cb550-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb550-9"><a href="#cb550-9" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">4</span><span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>EnumClass<span class="op">));</span>  <span class="co">// 列挙子の値を表現するのに十分なサイズの整数型で処理系依存</span></span>
<span id="cb550-10"><a href="#cb550-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb550-11"><a href="#cb550-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">// EnumClassWithUnderlyingTypeのunderlying typeはint64_t</span></span>
<span id="cb550-12"><a href="#cb550-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="dt">int64_t</span><span class="op">,</span> <span class="bu">std::</span>underlying_type_t<span class="op">&lt;</span>EnumClassWithUnderlyingType<span class="op">&gt;&gt;);</span></span>
<span id="cb550-13"><a href="#cb550-13" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="kw">sizeof</span><span class="op">(</span><span class="dt">int64_t</span><span class="op">),</span> <span class="kw">sizeof</span><span class="op">(</span>EnumClassWithUnderlyingType<span class="op">));</span></span></code></pre></div>
<h3 id="不完全型">不完全型 <a id="SS_5_1_10"></a></h3>
<p>不完全型とは、型のサイズや構造が不明な型を指す。
下記のような場合、不完全型となる。</p>
<div class="sourceCode" id="cb551"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb551-1"><a href="#cb551-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/incomplete_type_ut.cpp 6</span></span>
<span id="cb551-2"><a href="#cb551-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb551-3"><a href="#cb551-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> A<span class="op">;</span>  <span class="co">// Aの前方宣言</span></span>
<span id="cb551-4"><a href="#cb551-4" aria-hidden="true" tabindex="-1"></a>              <span class="co">// これ以降、Aは不完全型となる</span></span>
<span id="cb551-5"><a href="#cb551-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb551-6"><a href="#cb551-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">// auto a = sizeof(A);  Aが不完全型であるため、コンパイルエラー</span></span>
<span id="cb551-7"><a href="#cb551-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb551-8"><a href="#cb551-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> A <span class="op">{</span>  <span class="co">// この宣言により、この行以降はAは完全型になる</span></span>
<span id="cb551-9"><a href="#cb551-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb551-10"><a href="#cb551-10" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 何らかの宣言</span></span>
<span id="cb551-11"><a href="#cb551-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb551-12"><a href="#cb551-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb551-13"><a href="#cb551-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> a <span class="op">=</span> <span class="kw">sizeof</span><span class="op">(</span>A<span class="op">);</span>  <span class="co">// Aが完全型であるため、コンパイル可能</span></span></code></pre></div>
<h3 id="完全型">完全型 <a id="SS_5_1_11"></a></h3>
<p><a href="#SS_5_1_10">不完全型</a>ではない型を指す。</p>
<h3 id="ポリモーフィックなクラス">ポリモーフィックなクラス
<a id="SS_5_1_12"></a></h3>
<p>ポリモーフィックなクラスとは、仮想関数を持つクラスを指す。
なお、純粋仮想関数を持つクラスは、仮想クラスと呼ばれれる。</p>
<h3 id="インターフェースクラス">インターフェースクラス
<a id="SS_5_1_13"></a></h3>
<p>インターフェースクラスとは、純粋仮想関数のみを持つ抽象クラスのことを指す。
インターフェースクラスは、クラスの実装を提供することなく、
クラスのインターフェースを定義するために使用される。
インターフェースクラスは、クラスの仕様を定義するために使用されるため、
多くの場合、抽象基底クラスとして使用される。</p>
<div class="sourceCode" id="cb552"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb552-1"><a href="#cb552-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/interface_class.cpp 8</span></span>
<span id="cb552-2"><a href="#cb552-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb552-3"><a href="#cb552-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> InterfaceClass <span class="op">{</span>  <span class="co">// インターフェースクラス</span></span>
<span id="cb552-4"><a href="#cb552-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb552-5"><a href="#cb552-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span> DoSomething<span class="op">(</span><span class="dt">int32_t</span><span class="op">)</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb552-6"><a href="#cb552-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">bool</span> IsXxx<span class="op">()</span> <span class="at">const</span>        <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb552-7"><a href="#cb552-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="op">~</span>InterfaceClass<span class="op">()</span>         <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb552-8"><a href="#cb552-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb552-9"><a href="#cb552-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb552-10"><a href="#cb552-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> NotInterfaceClass <span class="op">{</span>  <span class="co">// メンバ変数があるためインターフェースクラスではない</span></span>
<span id="cb552-11"><a href="#cb552-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb552-12"><a href="#cb552-12" aria-hidden="true" tabindex="-1"></a>        NotInterfaceClass<span class="op">();</span></span>
<span id="cb552-13"><a href="#cb552-13" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span> DoSomething<span class="op">(</span><span class="dt">int32_t</span><span class="op">)</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb552-14"><a href="#cb552-14" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">bool</span> IsXxx<span class="op">()</span> <span class="at">const</span>        <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb552-15"><a href="#cb552-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="op">~</span>NotInterfaceClass<span class="op">()</span>      <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb552-16"><a href="#cb552-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb552-17"><a href="#cb552-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb552-18"><a href="#cb552-18" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span> <span class="va">num_</span><span class="op">;</span></span>
<span id="cb552-19"><a href="#cb552-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<h3 id="constインスタンス">constインスタンス <a id="SS_5_1_14"></a></h3>
<p>constインスタンスとはランタイムの初期化時に値が確定し、その後、状態が不変であるインスタンスである。</p>
<h3 id="constexprインスタンスと関数">constexprインスタンスと関数
<a id="SS_5_1_15"></a></h3>
<p>constexprインスタンスとはコンパイル時に値が確定するインスタンスである。
当然、ランタイム時でも不変である。</p>
<div class="sourceCode" id="cb553"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb553-1"><a href="#cb553-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/constexpr_ut.cpp 6</span></span>
<span id="cb553-2"><a href="#cb553-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb553-3"><a href="#cb553-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">double</span> PI<span class="op">{</span><span class="fl">3.14159265358979323846</span><span class="op">};</span>  <span class="co">// PIはconstexpr</span></span></code></pre></div>
<p>constexprとして宣言された関数の戻り値がコンパイル時に確定する場合、
その関数の呼び出し式はconstexprと扱われる。
従って、この値はテンプレートパラメータやstatic_assertのオペランドに使用することができる。</p>
<div class="sourceCode" id="cb554"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb554-1"><a href="#cb554-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/constexpr_ut.cpp 10</span></span>
<span id="cb554-2"><a href="#cb554-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb554-3"><a href="#cb554-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">int</span> f<span class="op">(</span><span class="dt">int</span> a<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> a <span class="op">*</span> <span class="dv">3</span><span class="op">;</span> <span class="op">}</span>  <span class="co">// aがconstexprならばf(a)もconstexpr</span></span>
<span id="cb554-4"><a href="#cb554-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb554-5"><a href="#cb554-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> g<span class="op">(</span><span class="dt">int</span> a<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> a <span class="op">*</span> <span class="dv">3</span><span class="op">;</span> <span class="op">}</span>  <span class="co">// aがconstexprであってもg(a)は非constexpr</span></span>
<span id="cb554-6"><a href="#cb554-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb554-7"><a href="#cb554-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="dt">int</span> N<span class="op">&gt;</span></span>
<span id="cb554-8"><a href="#cb554-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> Templ <span class="op">{</span></span>
<span id="cb554-9"><a href="#cb554-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="kw">constexpr</span> <span class="kw">auto</span> value <span class="op">=</span> N<span class="op">;</span></span>
<span id="cb554-10"><a href="#cb554-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb555"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb555-1"><a href="#cb555-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/constexpr_ut.cpp 25</span></span>
<span id="cb555-2"><a href="#cb555-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb555-3"><a href="#cb555-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> x <span class="op">=</span> <span class="dt">int</span><span class="op">{</span><span class="dv">0</span><span class="op">};</span></span>
<span id="cb555-4"><a href="#cb555-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb555-5"><a href="#cb555-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="kw">auto</span> a <span class="op">=</span> f<span class="op">(</span><span class="dv">3</span><span class="op">);</span>  <span class="co">// f(3)はconstexprなのでaの初期化が可能</span></span>
<span id="cb555-6"><a href="#cb555-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">// constexpr auto b = f(x);  // xは非constexprなのでbの初期化はコンパイルエラー</span></span>
<span id="cb555-7"><a href="#cb555-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> <span class="at">const</span> c <span class="op">=</span> f<span class="op">(</span><span class="dv">3</span><span class="op">);</span>  <span class="co">// cはconstexprとすべき</span></span>
<span id="cb555-8"><a href="#cb555-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">// constexpr auto d = g(3);  // g(3)は非constexprなのでdの初期化はコンパイルエラー</span></span>
<span id="cb555-9"><a href="#cb555-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> <span class="at">const</span> e <span class="op">=</span> g<span class="op">(</span>x<span class="op">);</span>  <span class="co">// eはここで初期化して、この後不変</span></span>
<span id="cb555-10"><a href="#cb555-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb555-11"><a href="#cb555-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="kw">auto</span> pi <span class="op">=</span> PI<span class="op">;</span>  <span class="co">// PIもconstexprなので初期化が可能</span></span>
<span id="cb555-12"><a href="#cb555-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb555-13"><a href="#cb555-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> templ_a <span class="op">=</span> Templ<span class="op">&lt;</span>a<span class="op">&gt;{};</span>     <span class="co">// aはconstexprなのでaの初期化が可能</span></span>
<span id="cb555-14"><a href="#cb555-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> templ_f <span class="op">=</span> Templ<span class="op">&lt;</span>f<span class="op">(</span>a<span class="op">)&gt;{};</span>  <span class="co">// f(a)はconstexprなのでaの初期化が可能</span></span>
<span id="cb555-15"><a href="#cb555-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">// auto templ_x = Templ&lt;x&gt;{};  // xは非constexprなのでテンプレートパラメータに指定できない</span></span>
<span id="cb555-16"><a href="#cb555-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb555-17"><a href="#cb555-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>templ_a<span class="op">.</span>value <span class="op">==</span> <span class="dv">9</span><span class="op">);</span></span>
<span id="cb555-18"><a href="#cb555-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">// static_assert(x == 0);  // xは非constexprなのでstatic_assertで使用できない</span></span></code></pre></div>
<p>下記のようなリカーシブな関数でも場合によってはconstexprにできる。
これによりこの関数の実行速度は劇的に向上する。</p>
<div class="sourceCode" id="cb556"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb556-1"><a href="#cb556-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/constexpr_ut.cpp 48</span></span>
<span id="cb556-2"><a href="#cb556-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb556-3"><a href="#cb556-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">inline</span> <span class="kw">constexpr</span> <span class="dt">uint32_t</span> BitMask<span class="op">(</span><span class="dt">uint32_t</span> bit_len<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb556-4"><a href="#cb556-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb556-5"><a href="#cb556-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>bit_len <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb556-6"><a href="#cb556-6" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="bn">0x0</span><span class="op">;</span></span>
<span id="cb556-7"><a href="#cb556-7" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb556-8"><a href="#cb556-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb556-9"><a href="#cb556-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> BitMask<span class="op">(</span>bit_len <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="op">|</span> <span class="op">(</span><span class="bn">0x01</span> <span class="op">&lt;&lt;</span> <span class="op">(</span>bit_len <span class="op">-</span> <span class="dv">1</span><span class="op">));</span></span>
<span id="cb556-10"><a href="#cb556-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>下記の単体テストが示すように、</p>
<ul>
<li>引数がconstexprである場合、上記constexpr関数の戻り値はconstexprになるため、
static_assertのオペランド式としても利用できる。</li>
<li>引数がconstexprでない場合、上記constexpr関数は通常の関数として振舞うため、
戻り値はconstexprとならない。</li>
</ul>
<div class="sourceCode" id="cb557"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb557-1"><a href="#cb557-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/constexpr_ut.cpp 63</span></span>
<span id="cb557-2"><a href="#cb557-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb557-3"><a href="#cb557-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="kw">auto</span> b_0x00000000 <span class="op">=</span> BitMask<span class="op">(</span><span class="dv">0</span><span class="op">);</span></span>
<span id="cb557-4"><a href="#cb557-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="kw">auto</span> b_0x000000ff <span class="op">=</span> BitMask<span class="op">(</span><span class="dv">8</span><span class="op">);</span></span>
<span id="cb557-5"><a href="#cb557-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb557-6"><a href="#cb557-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>b_0x00000000 <span class="op">==</span> <span class="bn">0x00000000</span><span class="op">);</span></span>
<span id="cb557-7"><a href="#cb557-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>b_0x000000ff <span class="op">==</span> <span class="bn">0x000000ff</span><span class="op">);</span></span>
<span id="cb557-8"><a href="#cb557-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>BitMask<span class="op">(</span><span class="dv">16</span><span class="op">)</span> <span class="op">==</span> <span class="bn">0x0000&#39;ffff</span><span class="op">);</span></span>
<span id="cb557-9"><a href="#cb557-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb557-10"><a href="#cb557-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="kw">auto</span> bit_len_constexpr <span class="op">=</span> <span class="dv">24</span><span class="bu">U</span><span class="op">;</span></span>
<span id="cb557-11"><a href="#cb557-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>BitMask<span class="op">(</span>bit_len_constexpr<span class="op">)</span> <span class="op">==</span> <span class="bn">0x00ff&#39;ffff</span><span class="op">);</span></span>
<span id="cb557-12"><a href="#cb557-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb557-13"><a href="#cb557-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> bit_len <span class="op">=</span> <span class="dv">24</span><span class="bu">U</span><span class="op">;</span></span>
<span id="cb557-14"><a href="#cb557-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb557-15"><a href="#cb557-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">// bit_lenがconstexprでないことによりBitMask(bit_len)もconstexprでないため、</span></span>
<span id="cb557-16"><a href="#cb557-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">// コンパイルできない</span></span>
<span id="cb557-17"><a href="#cb557-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">// constexpr auto b_0x00ffffff = BitMask(bit_len);</span></span>
<span id="cb557-18"><a href="#cb557-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb557-19"><a href="#cb557-19" aria-hidden="true" tabindex="-1"></a>    <span class="co">// b_0x00ffffffの定義からconstexprを外せばコンパイル可能</span></span>
<span id="cb557-20"><a href="#cb557-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ただし、コンパイル時でなくランタイム時動作になるため動作が遅い</span></span>
<span id="cb557-21"><a href="#cb557-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> b_0x00ffffff <span class="op">=</span> BitMask<span class="op">(</span>bit_len<span class="op">);</span></span>
<span id="cb557-22"><a href="#cb557-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb557-23"><a href="#cb557-23" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>b_0x00ffffff<span class="op">,</span> <span class="bn">0x00ff&#39;ffff</span><span class="op">);</span></span></code></pre></div>
<p>下記のようにクラスのコンストラクタをconstexprとすることで、
コンパイル時にリテラルとして振る舞うクラスを定義することができる。</p>
<div class="sourceCode" id="cb558"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb558-1"><a href="#cb558-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/constexpr_ut.cpp 90</span></span>
<span id="cb558-2"><a href="#cb558-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb558-3"><a href="#cb558-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Integer <span class="op">{</span></span>
<span id="cb558-4"><a href="#cb558-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb558-5"><a href="#cb558-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">constexpr</span> Integer<span class="op">(</span><span class="dt">int32_t</span> integer<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">:</span> <span class="va">integer_</span><span class="op">{</span>integer<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb558-6"><a href="#cb558-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">constexpr</span> <span class="dt">int32_t</span> Get<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">integer_</span><span class="op">;</span> <span class="op">}</span>  <span class="co">// constexprメンバ関数はconst</span></span>
<span id="cb558-7"><a href="#cb558-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">constexpr</span> <span class="dt">int32_t</span> Allways2<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="dv">2</span><span class="op">;</span> <span class="op">}</span>    <span class="co">// constexprメンバ関数はconst</span></span>
<span id="cb558-8"><a href="#cb558-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="kw">constexpr</span> <span class="dt">int32_t</span> Allways3<span class="op">()</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="dv">3</span><span class="op">;</span> <span class="op">}</span>   <span class="co">// static関数のconstexpr化</span></span>
<span id="cb558-9"><a href="#cb558-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb558-10"><a href="#cb558-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb558-11"><a href="#cb558-11" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span> <span class="va">integer_</span><span class="op">;</span></span>
<span id="cb558-12"><a href="#cb558-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb559"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb559-1"><a href="#cb559-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/constexpr_ut.cpp 107</span></span>
<span id="cb559-2"><a href="#cb559-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb559-3"><a href="#cb559-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="kw">auto</span> int3     <span class="op">=</span> <span class="dv">3</span><span class="op">;</span>                         <span class="co">// int3はconstexpr</span></span>
<span id="cb559-4"><a href="#cb559-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="kw">auto</span> integer3 <span class="op">=</span> Integer<span class="op">{</span>int3<span class="op">};</span>             <span class="co">// integer3自体がconstexpr</span></span>
<span id="cb559-5"><a href="#cb559-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>integer3<span class="op">.</span>Get<span class="op">()</span> <span class="op">==</span> <span class="dv">3</span><span class="op">,</span> <span class="st">&quot;wrong number&quot;</span><span class="op">);</span>  <span class="co">// integer3.Get()もconstexpr</span></span>
<span id="cb559-6"><a href="#cb559-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb559-7"><a href="#cb559-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> integer4 <span class="op">=</span> Integer<span class="op">{</span><span class="dv">4</span><span class="op">};</span></span>
<span id="cb559-8"><a href="#cb559-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">// integer4は非constexprであるため、integer4.Get()も非constexprとなり、コンパイル不可</span></span>
<span id="cb559-9"><a href="#cb559-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">// static_assert(integer4.Get() == 4, &quot;wrong number&quot;);</span></span>
<span id="cb559-10"><a href="#cb559-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb559-11"><a href="#cb559-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">// integer4は非constexprだが、integer4.Allway2()はconstexprであるため、コンパイル可能</span></span>
<span id="cb559-12"><a href="#cb559-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span>integer4<span class="op">.</span>Allways2<span class="op">()</span> <span class="op">==</span> <span class="dv">2</span><span class="op">,</span> <span class="st">&quot;wrong number&quot;</span><span class="op">);</span></span></code></pre></div>
<h3 id="ユーザ定義リテラル演算子">ユーザ定義リテラル演算子
<a id="SS_5_1_16"></a></h3>
<p>ユーザ定義リテラル演算子とは以下のようなものである。</p>
<div class="sourceCode" id="cb560"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb560-1"><a href="#cb560-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/user_defined_literal_ut.cpp 4</span></span>
<span id="cb560-2"><a href="#cb560-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb560-3"><a href="#cb560-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">int32_t</span> one_km <span class="op">=</span> <span class="dv">1000</span><span class="op">;</span></span>
<span id="cb560-4"><a href="#cb560-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb560-5"><a href="#cb560-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ユーザ定義リテラル演算子の定義</span></span>
<span id="cb560-6"><a href="#cb560-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">int32_t</span> <span class="kw">operator</span><span class="st">&quot;&quot;</span>_kilo_meter<span class="op">(</span><span class="dt">unsigned</span> <span class="dt">long</span> <span class="dt">long</span> num_by_mk<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> num_by_mk <span class="op">*</span> one_km<span class="op">;</span> <span class="op">}</span></span>
<span id="cb560-7"><a href="#cb560-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">constexpr</span> <span class="dt">int32_t</span> <span class="kw">operator</span><span class="st">&quot;&quot;</span>_meter<span class="op">(</span><span class="dt">unsigned</span> <span class="dt">long</span> <span class="dt">long</span> num_by_m<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> num_by_m<span class="op">;</span> <span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb561"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb561-1"><a href="#cb561-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/user_defined_literal_ut.cpp 15</span></span>
<span id="cb561-2"><a href="#cb561-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb561-3"><a href="#cb561-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int32_t</span> km <span class="op">=</span> <span class="dv">3_kilo_meter</span><span class="op">;</span>  <span class="co">// ユーザ定義リテラル演算子の利用</span></span>
<span id="cb561-4"><a href="#cb561-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int32_t</span> m  <span class="op">=</span> <span class="dv">3000_meter</span><span class="op">;</span>    <span class="co">// ユーザ定義リテラル演算子の利用</span></span>
<span id="cb561-5"><a href="#cb561-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb561-6"><a href="#cb561-6" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>m<span class="op">,</span> km<span class="op">);</span></span></code></pre></div>
<h3 id="stdstring型リテラル">std::string型リテラル
<a id="SS_5_1_17"></a></h3>
<p>“xxx”sとすることで、std::string型のリテラルを作ることができる。</p>
<div class="sourceCode" id="cb562"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb562-1"><a href="#cb562-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/user_defined_literal_ut.cpp 26</span></span>
<span id="cb562-2"><a href="#cb562-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb562-3"><a href="#cb562-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> <span class="kw">namespace</span> <span class="bu">std::</span>literals<span class="bu">::</span>string_literals<span class="op">;</span></span>
<span id="cb562-4"><a href="#cb562-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb562-5"><a href="#cb562-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> a <span class="op">=</span> <span class="st">&quot;str&quot;</span><span class="bu">s</span><span class="op">;</span>  <span class="co">// aはstd::string</span></span>
<span id="cb562-6"><a href="#cb562-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> b <span class="op">=</span> <span class="st">&quot;str&quot;</span><span class="op">;</span>   <span class="co">// bはconst char*</span></span>
<span id="cb562-7"><a href="#cb562-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb562-8"><a href="#cb562-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span>a<span class="op">),</span> <span class="bu">std::</span>string<span class="op">&gt;);</span></span>
<span id="cb562-9"><a href="#cb562-9" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="bu">std::</span>string<span class="op">{</span><span class="st">&quot;str&quot;</span><span class="op">},</span> a<span class="op">);</span></span>
<span id="cb562-10"><a href="#cb562-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb562-11"><a href="#cb562-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span>b<span class="op">),</span> <span class="dt">char</span> <span class="at">const</span><span class="op">*&gt;);</span></span>
<span id="cb562-12"><a href="#cb562-12" aria-hidden="true" tabindex="-1"></a>    ASSERT_STREQ<span class="op">(</span><span class="st">&quot;str&quot;</span><span class="op">,</span> b<span class="op">);</span></span></code></pre></div>
<h2 id="オブジェクトと生成">オブジェクトと生成 <a id="SS_5_2"></a></h2>
<h3 id="特殊メンバ関数">特殊メンバ関数 <a id="SS_5_2_1"></a></h3>
<p>特殊メンバ関数とは下記の関数を指す。</p>
<ul>
<li>デフォルトコンストラクタ</li>
<li>copyコンストラクタ</li>
<li>copy代入演算子</li>
<li>moveコンストラクタ</li>
<li>move代入演算子</li>
<li>デストラクタ</li>
</ul>
<p>ユーザがこれらを一切定義しない場合、または一部のみを定義する場合、
コンパイラは、下記のテーブル等で示すルールに従い、特殊関数メンバの宣言、定義の状態をを定める。</p>
<p>左1列目がユーザによる各関数の宣言を表し、2列目以降はユーザ宣言の影響による各関数の宣言の状態を表す。<br />
下記表において、</p>
<ul>
<li>「= default」とは、「コンパイラによってその関数が=
defaultと宣言された」状態であることを表す。</li>
<li>「<del>= default</del>」とは、=
defaultと同じであるが、バグが発生しやすいので推奨されない。</li>
<li>「宣言無し」とは、「コンパイラによってその関数が=
defaultと宣言された状態ではない」ことを表す。
<ul>
<li>「moveコンストラクタが= defaultと宣言された状態ではない」且つ
「copyコンストラクタが宣言されている」場合、
rvalueを使用したオブジェクトの初期化には、
moveコンストラクタの代わりにcopyコンストラクタが使われる。</li>
<li>「move代入演算子が= defaultと宣言された状態ではない」且つ
「copy代入演算子が宣言されている」場合、
rvalueを使用したオブジェクトの代入には、
move代入演算子の代わりにcopy代入演算子が使われる。</li>
</ul></li>
<li>「= delete」とは「コンパイラによってその関数が=
deleteと宣言された」状態であることを表す。</li>
</ul>
<table style="width:100%;">
<colgroup>
<col style="width: 25%" />
<col style="width: 14%" />
<col style="width: 12%" />
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 10%" />
<col style="width: 10%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">ユーザによる特殊関数の宣言</th>
<th style="text-align: center;">デフォルト<br>コンストラクタ</th>
<th style="text-align: center;">デストラクタ</th>
<th style="text-align: center;">copy<br>コンストラクタ</th>
<th style="text-align: center;">copy<br>代入演算子</th>
<th style="text-align: center;">move<br>コンストラクタ</th>
<th style="text-align: center;">move<br>代入演算子</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">宣言無し</td>
<td style="text-align: center;">= default</td>
<td style="text-align: center;">= default</td>
<td style="text-align: center;">= default</td>
<td style="text-align: center;">= default</td>
<td style="text-align: center;">= default</td>
<td style="text-align: center;">= default</td>
</tr>
<tr class="even">
<td style="text-align: center;">非デフォルトコンストラクタ</td>
<td style="text-align: center;">宣言なし</td>
<td style="text-align: center;">= default</td>
<td style="text-align: center;">= default</td>
<td style="text-align: center;">= default</td>
<td style="text-align: center;">= default</td>
<td style="text-align: center;">= default</td>
</tr>
<tr class="odd">
<td style="text-align: center;">デフォルトコンストラクタ</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">= default</td>
<td style="text-align: center;">= default</td>
<td style="text-align: center;">= default</td>
<td style="text-align: center;">= default</td>
<td style="text-align: center;">= default</td>
</tr>
<tr class="even">
<td style="text-align: center;">デストラクタ</td>
<td style="text-align: center;">= default</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;"><del>= default</del></td>
<td style="text-align: center;"><del>= default</del></td>
<td style="text-align: center;">宣言なし</td>
<td style="text-align: center;">宣言なし</td>
</tr>
<tr class="odd">
<td style="text-align: center;">copyコンストラクタ</td>
<td style="text-align: center;">宣言なし</td>
<td style="text-align: center;">= default</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;"><del>= default</del></td>
<td style="text-align: center;">宣言なし</td>
<td style="text-align: center;">宣言なし</td>
</tr>
<tr class="even">
<td style="text-align: center;">copy代入演算子</td>
<td style="text-align: center;">= default</td>
<td style="text-align: center;">= default</td>
<td style="text-align: center;"><del>= default</del></td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">宣言なし</td>
<td style="text-align: center;">宣言なし</td>
</tr>
<tr class="odd">
<td style="text-align: center;">moveコンストラクタ</td>
<td style="text-align: center;">宣言なし</td>
<td style="text-align: center;">= default</td>
<td style="text-align: center;">= delete</td>
<td style="text-align: center;">= delete</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">宣言なし</td>
</tr>
<tr class="even">
<td style="text-align: center;">move代入演算子</td>
<td style="text-align: center;">= default</td>
<td style="text-align: center;">= default</td>
<td style="text-align: center;">= delete</td>
<td style="text-align: center;">= delete</td>
<td style="text-align: center;">宣言なし</td>
<td style="text-align: center;">-</td>
</tr>
</tbody>
</table>
<p>上記表より、下記のようなことがわかる。</p>
<ul>
<li>ユーザが上記6メンバ関数を一切宣言しない場合、それらはコンパイラにより暗黙に宣言、定義される。</li>
<li>ユーザがcopyコンストラクタを宣言した場合、デフォルトコンストラクタは暗黙に宣言、定義されない。</li>
<li>ユーザがcopyコンストラクタを宣言した場合、copy代入演算子はコンパイラにより暗黙に宣言、
定義されるが、そのことは推奨されない(<del>=
default</del>は非推奨のdefault宣言を指す)。</li>
<li>moveコンストラクタ、move代入演算子は、
以下のいずれもが明示的に宣言されていない場合にのみ暗黙に宣言、定義される。
<ul>
<li>copyコンストラクタ</li>
<li>copy代入演算子(operator =)</li>
<li>moveコンストラクタ</li>
<li>move代入演算子</li>
<li>デストラクタ</li>
</ul></li>
<li>ユーザがmoveコンストラクタまたはmove代入演算子を宣言した場合、
copyコンストラクタ、copy代入演算子は= deleteされる。</li>
</ul>
<h3 id="初期化子リストコンストラクタ">初期化子リストコンストラクタ
<a id="SS_5_2_2"></a></h3>
<p>初期化子リストコンストラクタ(リスト初期化用のコンストラクタ)とは、
{}によるリスト初期化をサポートするためのコンストラクタである。
下記コードでは、
E::E(std::initializer_list&lt;uint32_t&gt;)が初期化子リストコンストラクタである。</p>
<div class="sourceCode" id="cb563"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb563-1"><a href="#cb563-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/constructor_ut.cpp 6</span></span>
<span id="cb563-2"><a href="#cb563-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb563-3"><a href="#cb563-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> E <span class="op">{</span></span>
<span id="cb563-4"><a href="#cb563-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb563-5"><a href="#cb563-5" aria-hidden="true" tabindex="-1"></a>        E<span class="op">()</span> <span class="op">:</span> <span class="va">str_</span><span class="op">{</span><span class="st">&quot;default constructor&quot;</span><span class="op">}</span> <span class="op">{}</span></span>
<span id="cb563-6"><a href="#cb563-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb563-7"><a href="#cb563-7" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 初期化子リストコンストラクタ</span></span>
<span id="cb563-8"><a href="#cb563-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> E<span class="op">(</span><span class="bu">std::</span>initializer_list<span class="op">&lt;</span><span class="dt">uint32_t</span><span class="op">&gt;)</span> <span class="op">:</span> <span class="va">str_</span><span class="op">{</span><span class="st">&quot;initializer list constructor&quot;</span><span class="op">}</span> <span class="op">{}</span></span>
<span id="cb563-9"><a href="#cb563-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb563-10"><a href="#cb563-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> E<span class="op">(</span><span class="dt">uint32_t</span><span class="op">,</span> <span class="dt">uint32_t</span><span class="op">)</span> <span class="op">:</span> <span class="va">str_</span><span class="op">{</span><span class="st">&quot;uint32_t uint32_t constructor&quot;</span><span class="op">}</span> <span class="op">{}</span></span>
<span id="cb563-11"><a href="#cb563-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb563-12"><a href="#cb563-12" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span><span class="op">&amp;</span> GetString<span class="op">()</span> <span class="at">const</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">str_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb563-13"><a href="#cb563-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb563-14"><a href="#cb563-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb563-15"><a href="#cb563-15" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span> <span class="va">str_</span><span class="op">;</span></span>
<span id="cb563-16"><a href="#cb563-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb563-17"><a href="#cb563-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb563-18"><a href="#cb563-18" aria-hidden="true" tabindex="-1"></a>    TEST<span class="op">(</span>Constructor<span class="op">,</span> initializer_list_constructor<span class="op">)</span></span>
<span id="cb563-19"><a href="#cb563-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb563-20"><a href="#cb563-20" aria-hidden="true" tabindex="-1"></a>        E <span class="at">const</span> e0<span class="op">;</span></span>
<span id="cb563-21"><a href="#cb563-21" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;default constructor&quot;</span><span class="op">,</span> e0<span class="op">.</span>GetString<span class="op">());</span></span>
<span id="cb563-22"><a href="#cb563-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb563-23"><a href="#cb563-23" aria-hidden="true" tabindex="-1"></a>        E <span class="at">const</span> e1<span class="op">{};</span></span>
<span id="cb563-24"><a href="#cb563-24" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;default constructor&quot;</span><span class="op">,</span> e1<span class="op">.</span>GetString<span class="op">());</span></span>
<span id="cb563-25"><a href="#cb563-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb563-26"><a href="#cb563-26" aria-hidden="true" tabindex="-1"></a>        E <span class="at">const</span> e2<span class="op">{</span><span class="dv">3</span><span class="op">,</span> <span class="dv">4</span><span class="op">};</span>  <span class="co">// E::E(uint32_t, uint32_t)の呼び出しと区別が困難</span></span>
<span id="cb563-27"><a href="#cb563-27" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;initializer list constructor&quot;</span><span class="op">,</span> e2<span class="op">.</span>GetString<span class="op">());</span></span>
<span id="cb563-28"><a href="#cb563-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb563-29"><a href="#cb563-29" aria-hidden="true" tabindex="-1"></a>        E <span class="at">const</span> e3<span class="op">(</span><span class="dv">3</span><span class="op">,</span> <span class="dv">4</span><span class="op">);</span>  <span class="co">// E::E(std::initializer_list&lt;uint32_t&gt;)の呼び出しと区別が困難</span></span>
<span id="cb563-30"><a href="#cb563-30" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;uint32_t uint32_t constructor&quot;</span><span class="op">,</span> e3<span class="op">.</span>GetString<span class="op">());</span></span>
<span id="cb563-31"><a href="#cb563-31" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>デフォルトコンストラクタと初期化子リストコンストラクタが、
それぞれに定義されているクラスの初期化時に空の初期化子リストが渡された場合、
デフォルトコンストラクタが呼び出される。</p>
<p>初期化子リストコンストラクタと、
「その初期化子リストの要素型と同じ型の仮引数のみを受け取るコンストラクタ
(上記コードのE::E(uint32_t, uint32_t))」
の両方を持つクラスの初期化時にどちらでも呼び出せる初期化子リストが渡された場合({}を使った呼び出し)、
初期化子コンストラクタが呼び出される。</p>
<h3 id="継承コンストラクタ">継承コンストラクタ
<a id="SS_5_2_3"></a></h3>
<p>継承コンストラクタとは、基底クラスで定義したコンストラクタ群を、
派生クラスのインターフェースとしても使用できるようにするための機能である。
下記コードのように、継承コンストラクタは派生クラス内でusingを用いて宣言される。</p>
<div class="sourceCode" id="cb564"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb564-1"><a href="#cb564-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/constructor_ut.cpp 40</span></span>
<span id="cb564-2"><a href="#cb564-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb564-3"><a href="#cb564-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Base <span class="op">{</span></span>
<span id="cb564-4"><a href="#cb564-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb564-5"><a href="#cb564-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> Base<span class="op">(</span><span class="dt">int32_t</span> b<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">:</span> <span class="va">b_</span><span class="op">{</span>b<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb564-6"><a href="#cb564-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="op">~</span>Base<span class="op">()</span> <span class="op">=</span> <span class="cf">default</span><span class="op">;</span></span>
<span id="cb564-7"><a href="#cb564-7" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb564-8"><a href="#cb564-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb564-9"><a href="#cb564-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb564-10"><a href="#cb564-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Derived <span class="op">:</span> <span class="kw">public</span> Base <span class="op">{</span></span>
<span id="cb564-11"><a href="#cb564-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb564-12"><a href="#cb564-12" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> Base<span class="op">::</span>Base<span class="op">;</span>  <span class="co">// 継承コンストラクタ</span></span>
<span id="cb564-13"><a href="#cb564-13" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#if 0</span></span>
<span id="cb564-14"><a href="#cb564-14" aria-hidden="true" tabindex="-1"></a><span class="co">        Derived(int32_t b) : Base{b} {}  // オールドスタイル</span></span>
<span id="cb564-15"><a href="#cb564-15" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="pp">#endif</span></span>
<span id="cb564-16"><a href="#cb564-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb564-17"><a href="#cb564-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb564-18"><a href="#cb564-18" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> f<span class="op">()</span> <span class="kw">noexcept</span></span>
<span id="cb564-19"><a href="#cb564-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb564-20"><a href="#cb564-20" aria-hidden="true" tabindex="-1"></a>        Derived d<span class="op">{</span><span class="dv">1</span><span class="op">};</span>  <span class="co">// Derived::Derived(int32_t)が使える</span></span>
<span id="cb564-21"><a href="#cb564-21" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb564-22"><a href="#cb564-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<h3 id="委譲コンストラクタ">委譲コンストラクタ
<a id="SS_5_2_4"></a></h3>
<p>委譲コンストラクタとは、コンストラクタから同じクラスの他のコンストラクタに処理を委譲する機能である。
以下のコード中では、委譲コンストラクタを使い、
A::A(uint32_t)の処理をA::A(std::string const&amp;)へ委譲している。</p>
<div class="sourceCode" id="cb565"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb565-1"><a href="#cb565-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/constructor_ut.cpp 72</span></span>
<span id="cb565-2"><a href="#cb565-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb565-3"><a href="#cb565-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> A <span class="op">{</span></span>
<span id="cb565-4"><a href="#cb565-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb565-5"><a href="#cb565-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> A<span class="op">(</span><span class="bu">std::</span>string<span class="op"> </span>str<span class="op">)</span> <span class="op">:</span> <span class="va">str_</span><span class="op">{</span><span class="bu">std::</span>move<span class="op">(</span>str<span class="op">)}</span></span>
<span id="cb565-6"><a href="#cb565-6" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb565-7"><a href="#cb565-7" aria-hidden="true" tabindex="-1"></a>            <span class="op">...</span></span>
<span id="cb565-8"><a href="#cb565-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb565-9"><a href="#cb565-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb565-10"><a href="#cb565-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> A<span class="op">(</span><span class="dt">uint32_t</span> num<span class="op">)</span> <span class="op">:</span> A<span class="op">{</span><span class="bu">std::</span>to_string<span class="op">(</span>num<span class="op">)}</span>  <span class="co">// 委譲コンストラクタ</span></span>
<span id="cb565-11"><a href="#cb565-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb565-12"><a href="#cb565-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb565-13"><a href="#cb565-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb565-14"><a href="#cb565-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb565-15"><a href="#cb565-15" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span><span class="va">str_</span><span class="op">;</span></span>
<span id="cb565-16"><a href="#cb565-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<h3
id="非explitなコンストラクタによる暗黙の型変換">非explitなコンストラクタによる暗黙の型変換
<a id="SS_5_2_5"></a></h3>
<p>非explitなコンストラクタによる暗黙の型変換とは、</p>
<div class="sourceCode" id="cb566"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb566-1"><a href="#cb566-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/implicit_conversion_ut.cpp 6</span></span>
<span id="cb566-2"><a href="#cb566-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb566-3"><a href="#cb566-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Person <span class="op">{</span></span>
<span id="cb566-4"><a href="#cb566-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb566-5"><a href="#cb566-5" aria-hidden="true" tabindex="-1"></a>        Person<span class="op">(</span><span class="dt">char</span> <span class="at">const</span><span class="op">*</span> name<span class="op">,</span> <span class="dt">uint32_t</span> age <span class="op">=</span> <span class="dv">0</span><span class="op">)</span> <span class="op">:</span> <span class="va">name_</span><span class="op">{</span>name<span class="op">},</span> <span class="va">age_</span><span class="op">{</span>age<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb566-6"><a href="#cb566-6" aria-hidden="true" tabindex="-1"></a>        Person<span class="op">(</span>Person <span class="at">const</span><span class="op">&amp;)</span>            <span class="op">=</span> <span class="cf">default</span><span class="op">;</span></span>
<span id="cb566-7"><a href="#cb566-7" aria-hidden="true" tabindex="-1"></a>        Person<span class="op">&amp;</span> <span class="kw">operator</span><span class="op">=(</span>Person <span class="at">const</span><span class="op">&amp;)</span> <span class="op">=</span> <span class="cf">default</span><span class="op">;</span></span>
<span id="cb566-8"><a href="#cb566-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb566-9"><a href="#cb566-9" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span><span class="op">&amp;</span> GetName<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">name_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb566-10"><a href="#cb566-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">uint32_t</span>           GetAge<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">age_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb566-11"><a href="#cb566-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb566-12"><a href="#cb566-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb566-13"><a href="#cb566-13" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span><span class="va">name_</span><span class="op">;</span>  <span class="co">// コピーをするため非const</span></span>
<span id="cb566-14"><a href="#cb566-14" aria-hidden="true" tabindex="-1"></a>        <span class="dt">uint32_t</span>    <span class="va">age_</span><span class="op">;</span></span>
<span id="cb566-15"><a href="#cb566-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb566-16"><a href="#cb566-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb566-17"><a href="#cb566-17" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bool</span> <span class="kw">operator</span><span class="op">==(</span>Person <span class="at">const</span><span class="op">&amp;</span> lhs<span class="op">,</span> Person <span class="at">const</span><span class="op">&amp;</span> rhs<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb566-18"><a href="#cb566-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb566-19"><a href="#cb566-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="op">(</span>lhs<span class="op">.</span>GetName<span class="op">()</span> <span class="op">==</span> rhs<span class="op">.</span>GetName<span class="op">())</span> <span class="op">&amp;&amp;</span> <span class="op">(</span>lhs<span class="op">.</span>GetAge<span class="op">()</span> <span class="op">==</span> rhs<span class="op">.</span>GetAge<span class="op">());</span></span>
<span id="cb566-20"><a href="#cb566-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>上記のクラスPersonを使用して、下記のようなコードをコンパイルできるようにする機能である。</p>
<div class="sourceCode" id="cb567"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb567-1"><a href="#cb567-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/implicit_conversion_ut.cpp 27</span></span>
<span id="cb567-2"><a href="#cb567-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb567-3"><a href="#cb567-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> f<span class="op">(</span>Person <span class="at">const</span><span class="op">&amp;</span> person<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb567-4"><a href="#cb567-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb567-5"><a href="#cb567-5" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb567-6"><a href="#cb567-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb567-7"><a href="#cb567-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb567-8"><a href="#cb567-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> using_implicit_coversion<span class="op">()</span></span>
<span id="cb567-9"><a href="#cb567-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb567-10"><a href="#cb567-10" aria-hidden="true" tabindex="-1"></a>        f<span class="op">(</span><span class="st">&quot;Ohtani&quot;</span><span class="op">);</span>  <span class="co">// &quot;Ohtani&quot;はPerson型ではないが、コンパイル可能</span></span>
<span id="cb567-11"><a href="#cb567-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>この記法は下記コードの短縮形であり、コードの見た目をシンプルに保つ効果がある。</p>
<div class="sourceCode" id="cb568"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb568-1"><a href="#cb568-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/implicit_conversion_ut.cpp 41</span></span>
<span id="cb568-2"><a href="#cb568-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-3"><a href="#cb568-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> not_using_implicit_coversion<span class="op">()</span></span>
<span id="cb568-4"><a href="#cb568-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb568-5"><a href="#cb568-5" aria-hidden="true" tabindex="-1"></a>        f<span class="op">(</span>Person<span class="op">{</span><span class="st">&quot;Ohtani&quot;</span><span class="op">});</span>  <span class="co">// 本来は、fの引数はPerson型</span></span>
<span id="cb568-6"><a href="#cb568-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>この記法は下記のようにstd::string等のSTLでも多用され、その効果は十分に発揮されているものの、</p>
<div class="sourceCode" id="cb569"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb569-1"><a href="#cb569-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/implicit_conversion_ut.cpp 53</span></span>
<span id="cb569-2"><a href="#cb569-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb569-3"><a href="#cb569-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> otani <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{</span><span class="st">&quot;Ohtani&quot;</span><span class="op">};</span></span>
<span id="cb569-4"><a href="#cb569-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb569-5"><a href="#cb569-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span></span>
<span id="cb569-6"><a href="#cb569-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb569-7"><a href="#cb569-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>otani <span class="op">==</span> <span class="st">&quot;Ohtani&quot;</span><span class="op">)</span> <span class="op">{</span>  <span class="co">// 暗黙の型変換によりコンパイルできる</span></span>
<span id="cb569-8"><a href="#cb569-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb569-9"><a href="#cb569-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>以下のようなコードがコンパイルできてしまうため、わかりづらいバグの元にもなる。</p>
<div class="sourceCode" id="cb570"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb570-1"><a href="#cb570-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/implicit_conversion_ut.cpp 67</span></span>
<span id="cb570-2"><a href="#cb570-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb570-3"><a href="#cb570-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> otani <span class="op">=</span> Person<span class="op">{</span><span class="st">&quot;Ohtani&quot;</span><span class="op">,</span> <span class="dv">26</span><span class="op">};</span></span>
<span id="cb570-4"><a href="#cb570-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb570-5"><a href="#cb570-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span></span>
<span id="cb570-6"><a href="#cb570-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb570-7"><a href="#cb570-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>otani <span class="op">==</span> <span class="st">&quot;Otani&quot;</span><span class="op">)</span> <span class="op">{</span>  <span class="co">// このコードがコンパイルされる。</span></span>
<span id="cb570-8"><a href="#cb570-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb570-9"><a href="#cb570-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>下記のようにコンストラクタにexplicitを付けて宣言することにより、この問題を防ぐことができる。</p>
<div class="sourceCode" id="cb571"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb571-1"><a href="#cb571-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/implicit_conversion_ut.cpp 94</span></span>
<span id="cb571-2"><a href="#cb571-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-3"><a href="#cb571-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Person <span class="op">{</span></span>
<span id="cb571-4"><a href="#cb571-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb571-5"><a href="#cb571-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> Person<span class="op">(</span><span class="dt">char</span> <span class="at">const</span><span class="op">*</span> name<span class="op">,</span> <span class="dt">uint32_t</span> age <span class="op">=</span> <span class="dv">0</span><span class="op">)</span> <span class="op">:</span> <span class="va">name_</span><span class="op">{</span>name<span class="op">},</span> <span class="va">age_</span><span class="op">{</span>age<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb571-6"><a href="#cb571-6" aria-hidden="true" tabindex="-1"></a>        Person<span class="op">(</span>Person <span class="at">const</span><span class="op">&amp;)</span>            <span class="op">=</span> <span class="cf">default</span><span class="op">;</span></span>
<span id="cb571-7"><a href="#cb571-7" aria-hidden="true" tabindex="-1"></a>        Person<span class="op">&amp;</span> <span class="kw">operator</span><span class="op">=(</span>Person <span class="at">const</span><span class="op">&amp;)</span> <span class="op">=</span> <span class="cf">default</span><span class="op">;</span></span>
<span id="cb571-8"><a href="#cb571-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-9"><a href="#cb571-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb571-10"><a href="#cb571-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb571-11"><a href="#cb571-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-12"><a href="#cb571-12" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> prohibit_implicit_coversion<span class="op">()</span></span>
<span id="cb571-13"><a href="#cb571-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb571-14"><a href="#cb571-14" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#if 0  </span><span class="co">// explicit付きのコンストラクタを持つPersonと違い、コンパイルできない。</span></span>
<span id="cb571-15"><a href="#cb571-15" aria-hidden="true" tabindex="-1"></a><span class="co">        f(&quot;Ohtani&quot;);</span></span>
<span id="cb571-16"><a href="#cb571-16" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="pp">#else</span></span>
<span id="cb571-17"><a href="#cb571-17" aria-hidden="true" tabindex="-1"></a>        f<span class="op">(</span>Person<span class="op">{</span><span class="st">&quot;Ohtani&quot;</span><span class="op">});</span></span>
<span id="cb571-18"><a href="#cb571-18" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#endif</span></span>
<span id="cb571-19"><a href="#cb571-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-20"><a href="#cb571-20" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> otani <span class="op">=</span> Person<span class="op">{</span><span class="st">&quot;Ohtani&quot;</span><span class="op">,</span> <span class="dv">26</span><span class="op">};</span></span>
<span id="cb571-21"><a href="#cb571-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-22"><a href="#cb571-22" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb571-23"><a href="#cb571-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-24"><a href="#cb571-24" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#if 0</span></span>
<span id="cb571-25"><a href="#cb571-25" aria-hidden="true" tabindex="-1"></a><span class="co">        if (otani == &quot;Otani&quot;) {  // このコードもコンパイルできない。</span></span>
<span id="cb571-26"><a href="#cb571-26" aria-hidden="true" tabindex="-1"></a><span class="co">            ...</span></span>
<span id="cb571-27"><a href="#cb571-27" aria-hidden="true" tabindex="-1"></a><span class="co">        }</span></span>
<span id="cb571-28"><a href="#cb571-28" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="pp">#else</span></span>
<span id="cb571-29"><a href="#cb571-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>otani <span class="op">==</span> Person<span class="op">{</span><span class="st">&quot;Otani&quot;</span><span class="op">,</span> <span class="dv">26</span><span class="op">})</span> <span class="op">{</span>  <span class="co">// この記述を強制できる。</span></span>
<span id="cb571-30"><a href="#cb571-30" aria-hidden="true" tabindex="-1"></a>            <span class="op">...</span></span>
<span id="cb571-31"><a href="#cb571-31" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb571-32"><a href="#cb571-32" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#endif</span></span>
<span id="cb571-33"><a href="#cb571-33" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>std::stringは暗黙の型変換を許して良く、(多くの場合)Personには暗黙の型変換をしない方が良い理由は、</p>
<ul>
<li>std::stringの役割は文字列の管理と演算のみであるため、
std::stringを文字列リテラルと等価なもののように扱っても違和感がない</li>
<li>Personは、明らかに文字列リテラルと等価なものではない</li>
</ul>
<p>といったセマンティクス的観点(「<a
href="#SS_5_8">シンタックス、セマンティクス</a>」参照)によるものである。</p>
<p>クラスPersonと同様に、
ほとんどのユーザ定義クラスには非explitなコンストラクタによる暗黙の型変換は必要ない。</p>
<h3 id="nsdmi">NSDMI <a id="SS_5_2_6"></a></h3>
<p>NSDMIとは、non-static data member initializerの略語であり、
下記のような非静的なメンバ変数の初期化子を指す。</p>
<div class="sourceCode" id="cb572"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb572-1"><a href="#cb572-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/nsdmi.cpp 8</span></span>
<span id="cb572-2"><a href="#cb572-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb572-3"><a href="#cb572-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> A <span class="op">{</span></span>
<span id="cb572-4"><a href="#cb572-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb572-5"><a href="#cb572-5" aria-hidden="true" tabindex="-1"></a>        A<span class="op">()</span> <span class="op">:</span> <span class="va">a_</span><span class="op">{</span><span class="dv">1</span><span class="op">}</span>  <span class="co">// NSDMIではなく、非静的なメンバ初期化子による初期化</span></span>
<span id="cb572-6"><a href="#cb572-6" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb572-7"><a href="#cb572-7" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb572-8"><a href="#cb572-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb572-9"><a href="#cb572-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb572-10"><a href="#cb572-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span>     <span class="va">a_</span><span class="op">;</span></span>
<span id="cb572-11"><a href="#cb572-11" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span>     <span class="va">b_</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span>        <span class="co">// NSDMI</span></span>
<span id="cb572-12"><a href="#cb572-12" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span><span class="va">str_</span><span class="op">{</span><span class="st">&quot;init&quot;</span><span class="op">};</span>  <span class="co">// NSDMI</span></span>
<span id="cb572-13"><a href="#cb572-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<h3 id="一様初期化">一様初期化 <a id="SS_5_2_7"></a></h3>
<p>一様初期化(uniform initialization)とは、
C++11で導入された、コンストラクタの呼び出しをリスト初期化と合わせて{}で記述する構文である。</p>
<div class="sourceCode" id="cb573"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb573-1"><a href="#cb573-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/uniform_initialization_ut.cpp 12</span></span>
<span id="cb573-2"><a href="#cb573-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb573-3"><a href="#cb573-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> X <span class="op">{</span></span>
<span id="cb573-4"><a href="#cb573-4" aria-hidden="true" tabindex="-1"></a>        X<span class="op">(</span><span class="dt">int</span><span class="op">)</span> <span class="op">{}</span></span>
<span id="cb573-5"><a href="#cb573-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb573-6"><a href="#cb573-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb573-7"><a href="#cb573-7" aria-hidden="true" tabindex="-1"></a>    X x0<span class="op">(</span><span class="dv">0</span><span class="op">);</span>   <span class="co">// 通常従来のコンストラクタ呼び出し</span></span>
<span id="cb573-8"><a href="#cb573-8" aria-hidden="true" tabindex="-1"></a>    X x1 <span class="op">=</span> <span class="dv">0</span><span class="op">;</span>  <span class="co">// 暗黙の型変換を使用した従来のコンストラクタ呼び出し</span></span>
<span id="cb573-9"><a href="#cb573-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb573-10"><a href="#cb573-10" aria-hidden="true" tabindex="-1"></a>    X x2<span class="op">{</span><span class="dv">0</span><span class="op">};</span>     <span class="co">// 一様初期化</span></span>
<span id="cb573-11"><a href="#cb573-11" aria-hidden="true" tabindex="-1"></a>    X x3 <span class="op">=</span> <span class="op">{</span><span class="dv">0</span><span class="op">};</span>  <span class="co">// 暗黙の型変換を使用した一様初期化</span></span>
<span id="cb573-12"><a href="#cb573-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb573-13"><a href="#cb573-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> Y <span class="op">{</span></span>
<span id="cb573-14"><a href="#cb573-14" aria-hidden="true" tabindex="-1"></a>        Y<span class="op">(</span><span class="dt">int</span><span class="op">,</span> <span class="dt">double</span><span class="op">,</span> <span class="bu">std::</span>string<span class="op">)</span> <span class="op">{}</span></span>
<span id="cb573-15"><a href="#cb573-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb573-16"><a href="#cb573-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb573-17"><a href="#cb573-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> lamda <span class="op">=</span> <span class="op">[](</span><span class="dt">int</span><span class="op">,</span> <span class="dt">double</span><span class="op">,</span> <span class="bu">std::</span>string<span class="op">)</span> <span class="op">-&gt;</span> Y <span class="op">{</span></span>
<span id="cb573-18"><a href="#cb573-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="op">{</span><span class="dv">1</span><span class="op">,</span> <span class="fl">3.14</span><span class="op">,</span> <span class="st">&quot;hello&quot;</span><span class="op">};</span>  <span class="co">// 暗黙の型変換を使用した一様初期化でのYの生成</span></span>
<span id="cb573-19"><a href="#cb573-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>変数による一様初期化が縮小型変換を起こす場合や、
リテラルによる一様初期化がその値を変更する場合、コンパイルエラーとなるため、
この機能を積極的に使用することで、縮小型変換による初期化のバグを未然に防ぐことができる。</p>
<div class="sourceCode" id="cb574"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb574-1"><a href="#cb574-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/uniform_initialization_ut.cpp 34</span></span>
<span id="cb574-2"><a href="#cb574-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb574-3"><a href="#cb574-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i<span class="op">{</span><span class="dv">0</span><span class="op">};</span>  <span class="co">// 一様初期化</span></span>
<span id="cb574-4"><a href="#cb574-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb574-5"><a href="#cb574-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bool</span> b0 <span class="op">=</span> <span class="dv">7</span><span class="op">;</span>  <span class="co">// 縮小型変換のため、b0の値はtrue(通常は1)となる</span></span>
<span id="cb574-6"><a href="#cb574-6" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>b0<span class="op">,</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb574-7"><a href="#cb574-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb574-8"><a href="#cb574-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">// bool b1{7};  // 縮小型変換のため、コンパイルエラー</span></span>
<span id="cb574-9"><a href="#cb574-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">// bool b2{i};  // 縮小型変換のため、コンパイルエラー</span></span>
<span id="cb574-10"><a href="#cb574-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb574-11"><a href="#cb574-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">uint8_t</span> u8_0 <span class="op">=</span> <span class="dv">256</span><span class="op">;</span>  <span class="co">// 縮小型変換のためu8_0は0となる</span></span>
<span id="cb574-12"><a href="#cb574-12" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>u8_0<span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb574-13"><a href="#cb574-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb574-14"><a href="#cb574-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">// uint8_t u8_1{256};  // 縮小型変換のため、コンパイルエラー</span></span>
<span id="cb574-15"><a href="#cb574-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">// uint8_t u8_2{i};    // 縮小型変換のため、コンパイルエラー</span></span>
<span id="cb574-16"><a href="#cb574-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb574-17"><a href="#cb574-17" aria-hidden="true" tabindex="-1"></a>    <span class="dt">uint8_t</span> array0<span class="op">[</span><span class="dv">3</span><span class="op">]{</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">255</span><span class="op">};</span>  <span class="co">// 一様初期化</span></span>
<span id="cb574-18"><a href="#cb574-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">// uint8_t array1[3] = {1, 2, 256};  // 縮小型変換のため、コンパイルエラー</span></span>
<span id="cb574-19"><a href="#cb574-19" aria-hidden="true" tabindex="-1"></a>    <span class="co">// uint8_t array2[3]{1, 2, 256};     // 縮小型変換のため、コンパイルエラー</span></span>
<span id="cb574-20"><a href="#cb574-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">// uint8_t array2[3]{1, 2, i};       // 縮小型変換のため、コンパイルエラー</span></span>
<span id="cb574-21"><a href="#cb574-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb574-22"><a href="#cb574-22" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i0 <span class="op">=</span> <span class="fl">1.0</span><span class="op">;</span>  <span class="co">// 縮小型変換のため、i0の値は1</span></span>
<span id="cb574-23"><a href="#cb574-23" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>i0<span class="op">,</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb574-24"><a href="#cb574-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb574-25"><a href="#cb574-25" aria-hidden="true" tabindex="-1"></a>    <span class="co">// int i1{1.0};  // 縮小型変換のため、コンパイルエラー</span></span>
<span id="cb574-26"><a href="#cb574-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb574-27"><a href="#cb574-27" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> d<span class="op">{</span><span class="dv">1</span><span class="op">};</span>  <span class="co">// 縮小型変換は起こらないのでコンパイル可能</span></span>
<span id="cb574-28"><a href="#cb574-28" aria-hidden="true" tabindex="-1"></a>    <span class="co">// int i2{d};  // 縮小型変換のため、コンパイルエラー</span></span></code></pre></div>
<h3 id="aaaスタイル">AAAスタイル <a id="SS_5_2_8"></a></h3>
<p>このドキュメントでのAAAとは、単体テストのパターンarrange-act-assertではなく、
almost always autoを指し、
AAAスタイルとは、「可能な場合、型を左辺に明示して変数を宣言する代わりに、autoを使用する」
というコーディングスタイルである。 この用語は、Andrei
Alexandrescuによって造られ、Herb Sutterによって広く推奨されている。</p>
<p>特定の型を明示して使用する必要がない場合、下記のように書く。</p>
<div class="sourceCode" id="cb575"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb575-1"><a href="#cb575-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/aaa.cpp 11</span></span>
<span id="cb575-2"><a href="#cb575-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb575-3"><a href="#cb575-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> i  <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb575-4"><a href="#cb575-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> ui <span class="op">=</span> <span class="dv">1</span><span class="bu">U</span><span class="op">;</span></span>
<span id="cb575-5"><a href="#cb575-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> d  <span class="op">=</span> <span class="fl">1.0</span><span class="op">;</span></span>
<span id="cb575-6"><a href="#cb575-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> s  <span class="op">=</span> <span class="st">&quot;str&quot;</span><span class="op">;</span></span>
<span id="cb575-7"><a href="#cb575-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> v  <span class="op">=</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">};</span></span>
<span id="cb575-8"><a href="#cb575-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb575-9"><a href="#cb575-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> i <span class="op">:</span> v<span class="op">)</span> <span class="op">{</span></span>
<span id="cb575-10"><a href="#cb575-10" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 何らかの処理</span></span>
<span id="cb575-11"><a href="#cb575-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb575-12"><a href="#cb575-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb575-13"><a href="#cb575-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> add <span class="op">=</span> <span class="op">[](</span><span class="kw">auto</span> lhs<span class="op">,</span> <span class="kw">auto</span> rhs<span class="op">)</span> <span class="op">{</span>  <span class="co">// -&gt; return_typeのような記述は不要</span></span>
<span id="cb575-14"><a href="#cb575-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> lhs <span class="op">+</span> rhs<span class="op">;</span>                <span class="co">// addの型もautoで良い</span></span>
<span id="cb575-15"><a href="#cb575-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb575-16"><a href="#cb575-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb575-17"><a href="#cb575-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 上記変数の型の確認</span></span>
<span id="cb575-18"><a href="#cb575-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span>i<span class="op">),</span> <span class="dt">int</span><span class="op">&gt;);</span></span>
<span id="cb575-19"><a href="#cb575-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span>ui<span class="op">),</span> <span class="dt">unsigned</span> <span class="dt">int</span><span class="op">&gt;);</span></span>
<span id="cb575-20"><a href="#cb575-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span>d<span class="op">),</span> <span class="dt">double</span><span class="op">&gt;);</span></span>
<span id="cb575-21"><a href="#cb575-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span>s<span class="op">),</span> <span class="dt">char</span> <span class="at">const</span><span class="op">*&gt;);</span></span>
<span id="cb575-22"><a href="#cb575-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span>v<span class="op">),</span> <span class="bu">std::</span>initializer_list<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;&gt;);</span></span>
<span id="cb575-23"><a href="#cb575-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb575-24"><a href="#cb575-24" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> s2<span class="op">[]</span> <span class="op">=</span> <span class="st">&quot;str&quot;</span><span class="op">;</span>  <span class="co">// 配列の宣言には、AAAは使えない</span></span>
<span id="cb575-25"><a href="#cb575-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span>s2<span class="op">),</span> <span class="dt">char</span><span class="op">[</span><span class="dv">4</span><span class="op">]&gt;);</span></span>
<span id="cb575-26"><a href="#cb575-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb575-27"><a href="#cb575-27" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span><span class="op">*</span> p0 <span class="op">=</span> <span class="kw">nullptr</span><span class="op">;</span>  <span class="co">// 初期値がnullptrであるポインタの初期化には、AAAは使うべきではない</span></span>
<span id="cb575-28"><a href="#cb575-28" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> p1 <span class="op">=</span> <span class="kw">static_cast</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">*&gt;(</span><span class="kw">nullptr</span><span class="op">);</span>  <span class="co">// NG</span></span>
<span id="cb575-29"><a href="#cb575-29" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> p2 <span class="op">=</span> p0<span class="op">;</span>                          <span class="co">// OK</span></span>
<span id="cb575-30"><a href="#cb575-30" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> p3 <span class="op">=</span> <span class="kw">nullptr</span><span class="op">;</span>                     <span class="co">// NG 通常、想定通りにならない</span></span>
<span id="cb575-31"><a href="#cb575-31" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span>p3<span class="op">),</span> <span class="bu">std::</span>nullptr_t<span class="op">&gt;);</span></span></code></pre></div>
<p>特定の型を明示して使用する必要がある場合、下記のように書く。</p>
<div class="sourceCode" id="cb576"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb576-1"><a href="#cb576-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/aaa.cpp 51</span></span>
<span id="cb576-2"><a href="#cb576-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb576-3"><a href="#cb576-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> b  <span class="op">=</span> <span class="kw">new</span> <span class="dt">char</span><span class="op">[</span><span class="dv">10</span><span class="op">]{</span><span class="dv">0</span><span class="op">};</span></span>
<span id="cb576-4"><a href="#cb576-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> v  <span class="op">=</span> <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">};</span></span>
<span id="cb576-5"><a href="#cb576-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> s  <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{</span><span class="st">&quot;str&quot;</span><span class="op">};</span></span>
<span id="cb576-6"><a href="#cb576-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> sv <span class="op">=</span> <span class="bu">std::</span>string_view<span class="op">{</span><span class="st">&quot;str&quot;</span><span class="op">};</span></span>
<span id="cb576-7"><a href="#cb576-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb576-8"><a href="#cb576-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span>b<span class="op">),</span> <span class="dt">char</span><span class="op">*&gt;);</span></span>
<span id="cb576-9"><a href="#cb576-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span>v<span class="op">),</span> <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;&gt;);</span></span>
<span id="cb576-10"><a href="#cb576-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span>s<span class="op">),</span> <span class="bu">std::</span>string<span class="op">&gt;);</span></span>
<span id="cb576-11"><a href="#cb576-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span>sv<span class="op">),</span> <span class="bu">std::</span>string_view<span class="op">&gt;);</span></span>
<span id="cb576-12"><a href="#cb576-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb576-13"><a href="#cb576-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 大量のstd::stringオブジェクトを定義する場合</span></span>
<span id="cb576-14"><a href="#cb576-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> <span class="bu">std::</span>literals<span class="bu">::</span>string_literals<span class="bu">::</span>operator<span class="bu">&quot;&quot;</span>s<span class="op">;</span></span>
<span id="cb576-15"><a href="#cb576-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb576-16"><a href="#cb576-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> <span class="va">s_0</span> <span class="op">=</span> <span class="st">&quot;222&quot;</span><span class="bu">s</span><span class="op">;</span>  <span class="co">// OK</span></span>
<span id="cb576-17"><a href="#cb576-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ...</span></span>
<span id="cb576-18"><a href="#cb576-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> <span class="va">s_N</span> <span class="op">=</span> <span class="st">&quot;222&quot;</span><span class="bu">s</span><span class="op">;</span>  <span class="co">// OK</span></span>
<span id="cb576-19"><a href="#cb576-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb576-20"><a href="#cb576-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span><span class="va">s_0</span><span class="op">),</span> <span class="bu">std::</span>string<span class="op">&gt;);</span></span>
<span id="cb576-21"><a href="#cb576-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span><span class="va">s_N</span><span class="op">),</span> <span class="bu">std::</span>string<span class="op">&gt;);</span></span>
<span id="cb576-22"><a href="#cb576-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb576-23"><a href="#cb576-23" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 大量のstd::string_viewオブジェクトを定義する場合</span></span>
<span id="cb576-24"><a href="#cb576-24" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> <span class="bu">std::</span>literals<span class="bu">::</span>string_view_literals<span class="bu">::</span>operator<span class="bu">&quot;&quot;</span>sv<span class="op">;</span></span>
<span id="cb576-25"><a href="#cb576-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb576-26"><a href="#cb576-26" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> sv_0 <span class="op">=</span> <span class="st">&quot;222&quot;</span><span class="bu">sv</span><span class="op">;</span>  <span class="co">// OK</span></span>
<span id="cb576-27"><a href="#cb576-27" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ...</span></span>
<span id="cb576-28"><a href="#cb576-28" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> sv_N <span class="op">=</span> <span class="st">&quot;222&quot;</span><span class="bu">sv</span><span class="op">;</span>  <span class="co">// OK</span></span>
<span id="cb576-29"><a href="#cb576-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb576-30"><a href="#cb576-30" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span>sv_0<span class="op">),</span> <span class="bu">std::</span>string_view<span class="op">&gt;);</span></span>
<span id="cb576-31"><a href="#cb576-31" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span>sv_N<span class="op">),</span> <span class="bu">std::</span>string_view<span class="op">&gt;);</span></span>
<span id="cb576-32"><a href="#cb576-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb576-33"><a href="#cb576-33" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>mutex<span class="op"> </span>mtx<span class="op">;</span>  <span class="co">// std::mutexはmove出来ないので、AAAスタイル不可</span></span>
<span id="cb576-34"><a href="#cb576-34" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span>       lock <span class="op">=</span> <span class="bu">std::</span>lock_guard<span class="op">{</span>mtx<span class="op">};</span></span>
<span id="cb576-35"><a href="#cb576-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb576-36"><a href="#cb576-36" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span>lock<span class="op">),</span> <span class="bu">std::</span>lock_guard<span class="op">&lt;</span><span class="bu">std::</span>mutex<span class="op">&gt;&gt;);</span></span></code></pre></div>
<p>関数の戻り値を受け取る変数を宣言する場合、下記のように書く。</p>
<div class="sourceCode" id="cb577"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb577-1"><a href="#cb577-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/aaa.cpp 94</span></span>
<span id="cb577-2"><a href="#cb577-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb577-3"><a href="#cb577-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> v <span class="op">=</span> <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">};</span></span>
<span id="cb577-4"><a href="#cb577-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb577-5"><a href="#cb577-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// AAAを使わない例</span></span>
<span id="cb577-6"><a href="#cb577-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;::</span><span class="dt">size_type</span> t0<span class="op">{</span>v<span class="op">.</span>size<span class="op">()};</span>      <span class="co">// 正確に書くとこうなる</span></span>
<span id="cb577-7"><a href="#cb577-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;::</span>iterator  itr0 <span class="op">=</span> v<span class="op">.</span>begin<span class="op">();</span>  <span class="co">// 正確に書くとこうなる</span></span>
<span id="cb577-8"><a href="#cb577-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb577-9"><a href="#cb577-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> p0 <span class="op">=</span> <span class="bu">std::</span>make_unique<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="dv">3</span><span class="op">);</span></span>
<span id="cb577-10"><a href="#cb577-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb577-11"><a href="#cb577-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 上記をAAAにした例</span></span>
<span id="cb577-12"><a href="#cb577-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> t1   <span class="op">=</span> v<span class="op">.</span>size<span class="op">();</span>   <span class="co">// size()の戻りは算術型であると推測できる</span></span>
<span id="cb577-13"><a href="#cb577-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> itr1 <span class="op">=</span> v<span class="op">.</span>begin<span class="op">();</span>  <span class="co">// begin()の戻りはイテレータであると推測できる</span></span>
<span id="cb577-14"><a href="#cb577-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb577-15"><a href="#cb577-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> p1 <span class="op">=</span> <span class="bu">std::</span>make_unique<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="dv">3</span><span class="op">);</span>  <span class="co">// make_uniqueの戻りはstd::unique_ptrであると推測できる</span></span></code></pre></div>
<p>ただし、関数の戻り値型が容易に推測しがたい下記のような場合、
型を明示しないAAAスタイルは使うべきではない。</p>
<div class="sourceCode" id="cb578"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb578-1"><a href="#cb578-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/aaa.cpp 121</span></span>
<span id="cb578-2"><a href="#cb578-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb578-3"><a href="#cb578-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">extern</span> <span class="bu">std::</span>map<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">,</span> <span class="dt">int</span><span class="op">&gt;</span> gen_map<span class="op">();</span></span>
<span id="cb578-4"><a href="#cb578-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb578-5"><a href="#cb578-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 上記のような複雑な型を戻す関数の場合、AAAを使うと可読性が落ちる</span></span>
<span id="cb578-6"><a href="#cb578-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> map0 <span class="op">=</span> gen_map<span class="op">();</span></span>
<span id="cb578-7"><a href="#cb578-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb578-8"><a href="#cb578-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> <span class="op">[</span>str<span class="op">,</span> i<span class="op">]</span> <span class="op">:</span> gen_map<span class="op">())</span> <span class="op">{</span></span>
<span id="cb578-9"><a href="#cb578-9" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 何らかの処理</span></span>
<span id="cb578-10"><a href="#cb578-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb578-11"><a href="#cb578-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb578-12"><a href="#cb578-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 上記のような複雑な型を戻す関数の場合、AAAを使うと可読性が落ちるため、AAAにしない</span></span>
<span id="cb578-13"><a href="#cb578-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>map<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">,</span> <span class="dt">int</span><span class="op">&gt;</span> map1 <span class="op">=</span> gen_map<span class="op">();</span>  <span class="co">// 型がコメントとして役に立つ</span></span>
<span id="cb578-14"><a href="#cb578-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb578-15"><a href="#cb578-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="bu">std::</span>pair<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">,</span> <span class="dt">int</span><span class="op">&gt;</span> str_i <span class="op">:</span> gen_map<span class="op">())</span> <span class="op">{</span></span>
<span id="cb578-16"><a href="#cb578-16" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 何らかの処理</span></span>
<span id="cb578-17"><a href="#cb578-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb578-18"><a href="#cb578-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb578-19"><a href="#cb578-19" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 型を明示したAAAスタイルでも良い</span></span>
<span id="cb578-20"><a href="#cb578-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> map2 <span class="op">=</span> <span class="bu">std::</span>map<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">,</span> <span class="dt">int</span><span class="op">&gt;{</span>gen_map<span class="op">()};</span>  <span class="co">// 型がコメントとして役に立つ</span></span></code></pre></div>
<p>インライン関数や関数テンプレートの宣言は、下記のように書く。</p>
<div class="sourceCode" id="cb579"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb579-1"><a href="#cb579-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/aaa.cpp 148</span></span>
<span id="cb579-2"><a href="#cb579-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb579-3"><a href="#cb579-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> F<span class="op">,</span> <span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb579-4"><a href="#cb579-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> apply_0<span class="op">(</span>F<span class="op">&amp;&amp;</span> f<span class="op">,</span> T value<span class="op">)</span></span>
<span id="cb579-5"><a href="#cb579-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb579-6"><a href="#cb579-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> f<span class="op">(</span>value<span class="op">);</span></span>
<span id="cb579-7"><a href="#cb579-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>ただし、インライン関数や関数テンプレートが複雑な下記のような場合、
AAAスタイルは出来る限り避けるべきである。</p>
<div class="sourceCode" id="cb580"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb580-1"><a href="#cb580-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/aaa.cpp 156</span></span>
<span id="cb580-2"><a href="#cb580-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb580-3"><a href="#cb580-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> F<span class="op">,</span> <span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb580-4"><a href="#cb580-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> apply_1<span class="op">(</span>F<span class="op">&amp;&amp;</span> f<span class="op">,</span> T value<span class="op">)</span> <span class="op">-&gt;</span> <span class="kw">decltype</span><span class="op">(</span>f<span class="op">(</span><span class="bu">std::</span>declval<span class="op">&lt;</span>T<span class="op">&gt;()))</span>  <span class="co">// autoを使用しているが、AAAではない</span></span>
<span id="cb580-5"><a href="#cb580-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb580-6"><a href="#cb580-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> cond  <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb580-7"><a href="#cb580-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> param <span class="op">=</span> value<span class="op">;</span></span>
<span id="cb580-8"><a href="#cb580-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb580-9"><a href="#cb580-9" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 複雑な処理</span></span>
<span id="cb580-10"><a href="#cb580-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb580-11"><a href="#cb580-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>cond<span class="op">)</span> <span class="op">{</span></span>
<span id="cb580-12"><a href="#cb580-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> f<span class="op">(</span>param<span class="op">);</span></span>
<span id="cb580-13"><a href="#cb580-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb580-14"><a href="#cb580-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb580-15"><a href="#cb580-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> f<span class="op">(</span>value<span class="op">);</span></span>
<span id="cb580-16"><a href="#cb580-16" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb580-17"><a href="#cb580-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>このスタイルには下記のような狙いがある。</p>
<ul>
<li>コードの安全性の向上<br />
autoで宣言された変数は未初期化にすることができないため、未初期化変数によるバグを防げる。
また、下記のように縮小型変換(下記では、unsignedからsignedの変換)を防ぐこともできる。</li>
</ul>
<div class="sourceCode" id="cb581"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb581-1"><a href="#cb581-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/aaa.cpp 183</span></span>
<span id="cb581-2"><a href="#cb581-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb581-3"><a href="#cb581-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> v <span class="op">=</span> <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">};</span></span>
<span id="cb581-4"><a href="#cb581-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb581-5"><a href="#cb581-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> t0 <span class="op">=</span> v<span class="op">.</span>size<span class="op">();</span>  <span class="co">// 縮小型変換されるため、バグが発生する可能性がある</span></span>
<span id="cb581-6"><a href="#cb581-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">// int t1{v.size()};   縮小型変換のため、コンパイルエラー</span></span>
<span id="cb581-7"><a href="#cb581-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> t2 <span class="op">=</span> v<span class="op">.</span>size<span class="op">();</span>  <span class="co">// t2は正確な型</span></span></code></pre></div>
<ul>
<li><p>コードの可読性の向上<br />
冗長なコードを排除することで、可読性の向上が見込める。</p></li>
<li><p>コードの保守性の向上<br />
「変数宣言時での左辺と右辺を同一の型にする」非AAAスタイルは <a
href="#:~:text=Don&#39;t%20repeat%20yourself%EF%BC%88DRY,%E3%81%A7%E3%81%AA%E3%81%84%E3%81%93%E3%81%A8%E3%82%92%E5%BC%B7%E8%AA%BF%E3%81%99%E3%82%8B%E3%80%82">DRYの原則</a>
に反するが、この観点において、AAAスタイルはDRYの原則に沿うため、
コード修正時に型の変更があった場合でも、それに付随したコード修正を最小限に留められる。</p></li>
</ul>
<p>AAAスタイルでは、以下のような場合に注意が必要である。</p>
<ul>
<li><p>関数の戻り値をautoで宣言された変数で受ける場合<br />
上記で述べた通り、AAAの過剰な仕様は、可読性を下げてしまう。</p></li>
<li><p>autoで推論された型が直感に反する場合<br />
下記のような型推論は、直感に反する場合があるため、autoの使い方に対する習熟が必要である。</p></li>
</ul>
<div class="sourceCode" id="cb582"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb582-1"><a href="#cb582-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/aaa.cpp 197</span></span>
<span id="cb582-2"><a href="#cb582-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb582-3"><a href="#cb582-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> str0 <span class="op">=</span> <span class="st">&quot;str&quot;</span><span class="op">;</span></span>
<span id="cb582-4"><a href="#cb582-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="dt">char</span> <span class="at">const</span><span class="op">*,</span> <span class="kw">decltype</span><span class="op">(</span>str0<span class="op">)&gt;);</span>  <span class="co">// str0はchar[4]ではない</span></span>
<span id="cb582-5"><a href="#cb582-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb582-6"><a href="#cb582-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">// char[]が必要ならば、AAAを使わずに下記のように書く</span></span>
<span id="cb582-7"><a href="#cb582-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> str1<span class="op">[]</span> <span class="op">=</span> <span class="st">&quot;str&quot;</span><span class="op">;</span></span>
<span id="cb582-8"><a href="#cb582-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="dt">char</span><span class="op">[</span><span class="dv">4</span><span class="op">],</span> <span class="kw">decltype</span><span class="op">(</span>str1<span class="op">)&gt;);</span></span>
<span id="cb582-9"><a href="#cb582-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb582-10"><a href="#cb582-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">// &amp;が必要になるパターン</span></span>
<span id="cb582-11"><a href="#cb582-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> X <span class="op">{</span></span>
<span id="cb582-12"><a href="#cb582-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb582-13"><a href="#cb582-13" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> X<span class="op">(</span><span class="dt">int32_t</span> a<span class="op">)</span> <span class="op">:</span> <span class="va">a_</span><span class="op">{</span>a<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb582-14"><a href="#cb582-14" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span><span class="op">&amp;</span> Get<span class="op">()</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">a_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb582-15"><a href="#cb582-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb582-16"><a href="#cb582-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb582-17"><a href="#cb582-17" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span> <span class="va">a_</span><span class="op">;</span></span>
<span id="cb582-18"><a href="#cb582-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb582-19"><a href="#cb582-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb582-20"><a href="#cb582-20" aria-hidden="true" tabindex="-1"></a>    X x<span class="op">{</span><span class="dv">3</span><span class="op">};</span></span>
<span id="cb582-21"><a href="#cb582-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb582-22"><a href="#cb582-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> a0 <span class="op">=</span> x<span class="op">.</span>Get<span class="op">();</span></span>
<span id="cb582-23"><a href="#cb582-23" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">3</span><span class="op">,</span> a0<span class="op">);</span></span>
<span id="cb582-24"><a href="#cb582-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb582-25"><a href="#cb582-25" aria-hidden="true" tabindex="-1"></a>    a0 <span class="op">=</span> <span class="dv">4</span><span class="op">;</span></span>
<span id="cb582-26"><a href="#cb582-26" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">4</span><span class="op">,</span> a0<span class="op">);</span></span>
<span id="cb582-27"><a href="#cb582-27" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">3</span><span class="op">,</span> x<span class="op">.</span>Get<span class="op">());</span>  <span class="co">// a0はリファレンスではないため、このような結果になる</span></span>
<span id="cb582-28"><a href="#cb582-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb582-29"><a href="#cb582-29" aria-hidden="true" tabindex="-1"></a>    <span class="co">// X::a_のリファレンスが必要ならば、下記のように書く</span></span>
<span id="cb582-30"><a href="#cb582-30" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span><span class="op">&amp;</span> a1 <span class="op">=</span> x<span class="op">.</span>Get<span class="op">();</span></span>
<span id="cb582-31"><a href="#cb582-31" aria-hidden="true" tabindex="-1"></a>    a1       <span class="op">=</span> <span class="dv">4</span><span class="op">;</span></span>
<span id="cb582-32"><a href="#cb582-32" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">4</span><span class="op">,</span> a1<span class="op">);</span></span>
<span id="cb582-33"><a href="#cb582-33" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">4</span><span class="op">,</span> x<span class="op">.</span>Get<span class="op">());</span>  <span class="co">// a1はリファレンスであるため、このような結果になる</span></span>
<span id="cb582-34"><a href="#cb582-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb582-35"><a href="#cb582-35" aria-hidden="true" tabindex="-1"></a>    <span class="co">// constが必要になるパターン</span></span>
<span id="cb582-36"><a href="#cb582-36" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Y <span class="op">{</span></span>
<span id="cb582-37"><a href="#cb582-37" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb582-38"><a href="#cb582-38" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op">&amp;</span>       Name<span class="op">()</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">name_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb582-39"><a href="#cb582-39" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span><span class="op">&amp;</span> Name<span class="op">()</span> <span class="at">const</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">name_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb582-40"><a href="#cb582-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb582-41"><a href="#cb582-41" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb582-42"><a href="#cb582-42" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span><span class="va">name_</span><span class="op">{</span><span class="st">&quot;str&quot;</span><span class="op">};</span></span>
<span id="cb582-43"><a href="#cb582-43" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb582-44"><a href="#cb582-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb582-45"><a href="#cb582-45" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> <span class="at">const</span> y <span class="op">=</span> Y<span class="op">{};</span></span>
<span id="cb582-46"><a href="#cb582-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb582-47"><a href="#cb582-47" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span>        name0 <span class="op">=</span> y<span class="op">.</span>Name<span class="op">();</span>  <span class="co">// std::stringがコピーされる</span></span>
<span id="cb582-48"><a href="#cb582-48" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span><span class="op">&amp;</span>       name1 <span class="op">=</span> y<span class="op">.</span>Name<span class="op">();</span>  <span class="co">// name1はconstに見えない</span></span>
<span id="cb582-49"><a href="#cb582-49" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> <span class="at">const</span><span class="op">&amp;</span> name2 <span class="op">=</span> y<span class="op">.</span>Name<span class="op">();</span>  <span class="co">// このように書くべき</span></span>
<span id="cb582-50"><a href="#cb582-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb582-51"><a href="#cb582-51" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">,</span> <span class="kw">decltype</span><span class="op">(</span>name0<span class="op">)&gt;);</span></span>
<span id="cb582-52"><a href="#cb582-52" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span><span class="op">&amp;,</span> <span class="kw">decltype</span><span class="op">(</span>name1<span class="op">)&gt;);</span></span>
<span id="cb582-53"><a href="#cb582-53" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span><span class="op">&amp;,</span> <span class="kw">decltype</span><span class="op">(</span>name2<span class="op">)&gt;);</span></span>
<span id="cb582-54"><a href="#cb582-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb582-55"><a href="#cb582-55" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 範囲for文でのauto const&amp;</span></span>
<span id="cb582-56"><a href="#cb582-56" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> <span class="at">const</span> v <span class="op">=</span> <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;{</span><span class="st">&quot;0&quot;</span><span class="op">,</span> <span class="st">&quot;1&quot;</span><span class="op">,</span> <span class="st">&quot;2&quot;</span><span class="op">};</span></span>
<span id="cb582-57"><a href="#cb582-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb582-58"><a href="#cb582-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> s <span class="op">:</span> v<span class="op">)</span> <span class="op">{</span>  <span class="co">// sはコピー生成される</span></span>
<span id="cb582-59"><a href="#cb582-59" aria-hidden="true" tabindex="-1"></a>        <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">,</span> <span class="kw">decltype</span><span class="op">(</span>s<span class="op">)&gt;);</span></span>
<span id="cb582-60"><a href="#cb582-60" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb582-61"><a href="#cb582-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb582-62"><a href="#cb582-62" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span><span class="op">&amp;</span> s <span class="op">:</span> v<span class="op">)</span> <span class="op">{</span>  <span class="co">// sはconstに見えない</span></span>
<span id="cb582-63"><a href="#cb582-63" aria-hidden="true" tabindex="-1"></a>        <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span><span class="op">&amp;,</span> <span class="kw">decltype</span><span class="op">(</span>s<span class="op">)&gt;);</span></span>
<span id="cb582-64"><a href="#cb582-64" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb582-65"><a href="#cb582-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb582-66"><a href="#cb582-66" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> <span class="at">const</span><span class="op">&amp;</span> s <span class="op">:</span> v<span class="op">)</span> <span class="op">{</span>  <span class="co">// このように書くべき</span></span>
<span id="cb582-67"><a href="#cb582-67" aria-hidden="true" tabindex="-1"></a>        <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span><span class="op">&amp;,</span> <span class="kw">decltype</span><span class="op">(</span>s<span class="op">)&gt;);</span></span>
<span id="cb582-68"><a href="#cb582-68" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<h3 id="オブジェクトの所有権">オブジェクトの所有権
<a id="SS_5_2_9"></a></h3>
<p>オブジェクトxがオブジェクトaの解放責務を持つ場合、
xはaの所有権を持つ(もしくは、所有する) という。</p>
<p>定義から明らかな通り、ダイナミックに生成されたaをxが所有する場合、
xはa(へのポインタ)をdeleteする責務を持つ。</p>
<p>xがaを所有し、且つxがaを他のオブジェクトと共有しない場合、「xはaを排他所有する」という。</p>
<p>オブジェクト群x0、x1、…、xNがaを所有する場合、
「x0、x1、…、xNはaを共有所有する」という。</p>
<p>x0、x1、…、xNがaを共有所有する場合、x0、x1、…、xN全体で、a(へのポインタ)をdeleteする責務を持つ。</p>
<p>下記で示したような状況では、
ダイナミックに生成されたオブジェクトの所有権の所在をコードから直ちに読み取ることは困難であり、
その解放責務も曖昧となる。</p>
<div class="sourceCode" id="cb583"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb583-1"><a href="#cb583-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/ambiguous_ownership_ut.cpp 11</span></span>
<span id="cb583-2"><a href="#cb583-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb583-3"><a href="#cb583-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> A <span class="op">{</span></span>
<span id="cb583-4"><a href="#cb583-4" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 何らかの宣言</span></span>
<span id="cb583-5"><a href="#cb583-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb583-6"><a href="#cb583-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb583-7"><a href="#cb583-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> X <span class="op">{</span></span>
<span id="cb583-8"><a href="#cb583-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb583-9"><a href="#cb583-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> X<span class="op">(</span>A<span class="op">*</span> a<span class="op">)</span> <span class="op">:</span> <span class="va">a_</span><span class="op">{</span>a<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb583-10"><a href="#cb583-10" aria-hidden="true" tabindex="-1"></a>        A<span class="op">*</span> GetA<span class="op">()</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">a_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb583-11"><a href="#cb583-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb583-12"><a href="#cb583-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb583-13"><a href="#cb583-13" aria-hidden="true" tabindex="-1"></a>        A<span class="op">*</span> <span class="va">a_</span><span class="op">;</span></span>
<span id="cb583-14"><a href="#cb583-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb583-15"><a href="#cb583-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb583-16"><a href="#cb583-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span><span class="op">*</span> a <span class="op">=</span> <span class="kw">new</span> A<span class="op">;</span></span>
<span id="cb583-17"><a href="#cb583-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span>  x <span class="op">=</span> X<span class="op">{</span>a<span class="op">};</span></span>
<span id="cb583-18"><a href="#cb583-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">// aがxに排他所有されているのか否かの判断は難しい</span></span>
<span id="cb583-19"><a href="#cb583-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb583-20"><a href="#cb583-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> x0 <span class="op">=</span> X<span class="op">{</span><span class="kw">new</span> A<span class="op">};</span></span>
<span id="cb583-21"><a href="#cb583-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> x1 <span class="op">=</span> X<span class="op">{</span>x0<span class="op">.</span>GetA<span class="op">()};</span></span>
<span id="cb583-22"><a href="#cb583-22" aria-hidden="true" tabindex="-1"></a>    <span class="co">// x0生成時にnewされたオブジェクトがx0とx1に共有所有されているのか否かの判断は難しい</span></span></code></pre></div>
<p>こういった問題に対処するためのプログラミングパターンを以下の 「<a
href="#SS_5_2_9_1">オブジェクトの排他所有</a>」と「<a
href="#SS_5_2_9_2">オブジェクトの共有所有</a>」で解説する。</p>
<h4 id="オブジェクトの排他所有">オブジェクトの排他所有
<a id="SS_5_2_9_1"></a></h4>
<p>オブジェクトの排他所有や、それを容易に実現するための <a
href="https://cpprefjp.github.io/reference/memory/unique_ptr.html">std::unique_ptr</a>
の仕様をを説明するために、下記のようにクラスA、Xを定義する。</p>
<div class="sourceCode" id="cb584"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb584-1"><a href="#cb584-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/unique_ptr_ownership_ut.cpp 7</span></span>
<span id="cb584-2"><a href="#cb584-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb584-3"><a href="#cb584-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> A <span class="kw">final</span> <span class="op">{</span></span>
<span id="cb584-4"><a href="#cb584-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb584-5"><a href="#cb584-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> A<span class="op">(</span><span class="dt">int32_t</span> n<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">:</span> <span class="va">num_</span><span class="op">{</span>n<span class="op">}</span> <span class="op">{</span> <span class="va">last_constructed_num_</span> <span class="op">=</span> <span class="va">num_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb584-6"><a href="#cb584-6" aria-hidden="true" tabindex="-1"></a>        <span class="op">~</span>A<span class="op">()</span> <span class="op">{</span> <span class="va">last_destructed_num_</span> <span class="op">=</span> <span class="va">num_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb584-7"><a href="#cb584-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb584-8"><a href="#cb584-8" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span> GetNum<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">num_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb584-9"><a href="#cb584-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb584-10"><a href="#cb584-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="dt">int32_t</span> LastConstructedNum<span class="op">()</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">last_constructed_num_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb584-11"><a href="#cb584-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="dt">int32_t</span> LastDestructedNum<span class="op">()</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">last_destructed_num_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb584-12"><a href="#cb584-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb584-13"><a href="#cb584-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb584-14"><a href="#cb584-14" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span> <span class="at">const</span>  <span class="va">num_</span><span class="op">;</span></span>
<span id="cb584-15"><a href="#cb584-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="dt">int32_t</span> <span class="va">last_constructed_num_</span><span class="op">;</span></span>
<span id="cb584-16"><a href="#cb584-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="dt">int32_t</span> <span class="va">last_destructed_num_</span><span class="op">;</span></span>
<span id="cb584-17"><a href="#cb584-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb584-18"><a href="#cb584-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb584-19"><a href="#cb584-19" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int32_t</span> A<span class="op">::</span><span class="va">last_constructed_num_</span> <span class="op">=</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb584-20"><a href="#cb584-20" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int32_t</span> A<span class="op">::</span><span class="va">last_destructed_num_</span>  <span class="op">=</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb584-21"><a href="#cb584-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb584-22"><a href="#cb584-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> X <span class="kw">final</span> <span class="op">{</span></span>
<span id="cb584-23"><a href="#cb584-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb584-24"><a href="#cb584-24" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Xオブジェクトの生成と、ptrからptr_へ所有権の移動</span></span>
<span id="cb584-25"><a href="#cb584-25" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> X<span class="op">(</span><span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>A<span class="op">&gt;&amp;&amp;</span> ptr<span class="op">)</span> <span class="op">:</span> <span class="va">ptr_</span><span class="op">{</span><span class="bu">std::</span>move<span class="op">(</span>ptr<span class="op">)}</span> <span class="op">{}</span></span>
<span id="cb584-26"><a href="#cb584-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb584-27"><a href="#cb584-27" aria-hidden="true" tabindex="-1"></a>        <span class="co">// ptrからptr_へ所有権の移動</span></span>
<span id="cb584-28"><a href="#cb584-28" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> Move<span class="op">(</span><span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>A<span class="op">&gt;&amp;&amp;</span> ptr<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="va">ptr_</span> <span class="op">=</span> <span class="bu">std::</span>move<span class="op">(</span>ptr<span class="op">);</span> <span class="op">}</span></span>
<span id="cb584-29"><a href="#cb584-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb584-30"><a href="#cb584-30" aria-hidden="true" tabindex="-1"></a>        <span class="co">// ptr_から外部への所有権の移動</span></span>
<span id="cb584-31"><a href="#cb584-31" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>A<span class="op">&gt;</span> Release<span class="op">()</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="bu">std::</span>move<span class="op">(</span><span class="va">ptr_</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb584-32"><a href="#cb584-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb584-33"><a href="#cb584-33" aria-hidden="true" tabindex="-1"></a>        A <span class="at">const</span><span class="op">*</span> GetA<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">ptr_</span> <span class="op">?</span> <span class="va">ptr_</span><span class="op">.</span>get<span class="op">()</span> <span class="op">:</span> <span class="kw">nullptr</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb584-34"><a href="#cb584-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb584-35"><a href="#cb584-35" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb584-36"><a href="#cb584-36" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>A<span class="op">&gt;</span> <span class="va">ptr_</span><span class="op">{};</span></span>
<span id="cb584-37"><a href="#cb584-37" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>下記に示した上記クラスの単体テストにより、
オブジェクトの所有権やその移動、 std::unique_ptr、std::move()、<a
href="#SS_5_5_3">rvalue</a>の関係を解説する。</p>
<div class="sourceCode" id="cb585"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb585-1"><a href="#cb585-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/unique_ptr_ownership_ut.cpp 48</span></span>
<span id="cb585-2"><a href="#cb585-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb585-3"><a href="#cb585-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ステップ0</span></span>
<span id="cb585-4"><a href="#cb585-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// まだ、クラスAオブジェクトは生成されていないため、</span></span>
<span id="cb585-5"><a href="#cb585-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// A::LastConstructedNum()、A::LastDestructedNum()は初期値である-1である。</span></span>
<span id="cb585-6"><a href="#cb585-6" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(-</span><span class="dv">1</span><span class="op">,</span> A<span class="op">::</span>LastConstructedNum<span class="op">());</span>     <span class="co">// まだ、A::A()は呼ばれてない</span></span>
<span id="cb585-7"><a href="#cb585-7" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(-</span><span class="dv">1</span><span class="op">,</span> A<span class="op">::</span>LastDestructedNum<span class="op">());</span>      <span class="co">// まだ、A::~A()は呼ばれてない</span></span></code></pre></div>
<div class="sourceCode" id="cb586"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb586-1"><a href="#cb586-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/unique_ptr_ownership_ut.cpp 57</span></span>
<span id="cb586-2"><a href="#cb586-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb586-3"><a href="#cb586-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ステップ1</span></span>
<span id="cb586-4"><a href="#cb586-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// a0、a1がそれぞれ初期化される。</span></span>
<span id="cb586-5"><a href="#cb586-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> a0 <span class="op">=</span> <span class="bu">std::</span>make_unique<span class="op">&lt;</span>A<span class="op">&gt;(</span><span class="dv">0</span><span class="op">);</span>           <span class="co">// a0はA{0}を所有</span></span>
<span id="cb586-6"><a href="#cb586-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> a1 <span class="op">=</span> <span class="bu">std::</span>make_unique<span class="op">&lt;</span>A<span class="op">&gt;(</span><span class="dv">1</span><span class="op">);</span>           <span class="co">// a1はA{1}を所有</span></span>
<span id="cb586-7"><a href="#cb586-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb586-8"><a href="#cb586-8" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">1</span><span class="op">,</span>  A<span class="op">::</span>LastConstructedNum<span class="op">());</span>     <span class="co">// A{1}は生成された</span></span>
<span id="cb586-9"><a href="#cb586-9" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(-</span><span class="dv">1</span><span class="op">,</span> A<span class="op">::</span>LastDestructedNum<span class="op">());</span>      <span class="co">// まだ、A::~A()は呼ばれてない</span></span></code></pre></div>
<p>
<img src="data:image/png;base64,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" />
</p>
<div class="sourceCode" id="cb587"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb587-1"><a href="#cb587-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/unique_ptr_ownership_ut.cpp 67</span></span>
<span id="cb587-2"><a href="#cb587-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb587-3"><a href="#cb587-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ステップ2</span></span>
<span id="cb587-4"><a href="#cb587-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// xが生成され、オブジェクトA{0}の所有がa0からxへ移動する。</span></span>
<span id="cb587-5"><a href="#cb587-5" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">0</span><span class="op">,</span> a0<span class="op">-&gt;</span>GetNum<span class="op">());</span>                 <span class="co">// a0はA{0}を所有</span></span>
<span id="cb587-6"><a href="#cb587-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> x <span class="op">=</span> X<span class="op">{</span><span class="bu">std::</span>move<span class="op">(</span>a0<span class="op">)};</span>                  <span class="co">// xの生成と、a0からxへA{0}の所有権の移動</span></span>
<span id="cb587-7"><a href="#cb587-7" aria-hidden="true" tabindex="-1"></a>    ASSERT_FALSE<span class="op">(</span>a0<span class="op">);</span>                           <span class="co">// a0は何も所有していない</span></span></code></pre></div>
<p>
<img src="data:image/png;base64,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" />
</p>
<div class="sourceCode" id="cb588"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb588-1"><a href="#cb588-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/unique_ptr_ownership_ut.cpp 75</span></span>
<span id="cb588-2"><a href="#cb588-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb588-3"><a href="#cb588-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ステップ3</span></span>
<span id="cb588-4"><a href="#cb588-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// オブジェクトA{1}の所有がa1からxへ移動する。</span></span>
<span id="cb588-5"><a href="#cb588-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// xは以前保持していたA{0}オブジェクトへのポインタをdeleteするため</span></span>
<span id="cb588-6"><a href="#cb588-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">// (std::unique_ptrによる自動delete)、A::LastDestructedNum()の値が0になる。</span></span>
<span id="cb588-7"><a href="#cb588-7" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">1</span><span class="op">,</span> a1<span class="op">-&gt;</span>GetNum<span class="op">());</span>                 <span class="co">// a1はA{1}を所有</span></span>
<span id="cb588-8"><a href="#cb588-8" aria-hidden="true" tabindex="-1"></a>    x<span class="op">.</span>Move<span class="op">(</span><span class="bu">std::</span>move<span class="op">(</span>a1<span class="op">));</span>                      <span class="co">// xによるA{0}の解放</span></span>
<span id="cb588-9"><a href="#cb588-9" aria-hidden="true" tabindex="-1"></a>                                                <span class="co">// a1からxへA{1}の所有権の移動</span></span>
<span id="cb588-10"><a href="#cb588-10" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">0</span><span class="op">,</span> A<span class="op">::</span>LastDestructedNum<span class="op">());</span>       <span class="co">// A{0}は解放された</span></span>
<span id="cb588-11"><a href="#cb588-11" aria-hidden="true" tabindex="-1"></a>    ASSERT_FALSE<span class="op">(</span>a1<span class="op">);</span>                           <span class="co">// a1は何も所有していない</span></span>
<span id="cb588-12"><a href="#cb588-12" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">1</span><span class="op">,</span> x<span class="op">.</span>GetA<span class="op">()-&gt;</span>GetNum<span class="op">());</span>           <span class="co">// xはA{1}を所有</span></span></code></pre></div>
<p>
<img src="data:image/png;base64,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" />
</p>
<div class="sourceCode" id="cb589"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb589-1"><a href="#cb589-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/unique_ptr_ownership_ut.cpp 88</span></span>
<span id="cb589-2"><a href="#cb589-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb589-3"><a href="#cb589-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ステップ4</span></span>
<span id="cb589-4"><a href="#cb589-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// x.ptr_はstd::unique_ptr&lt;A&gt;であるため、ステップ3の状態では、</span></span>
<span id="cb589-5"><a href="#cb589-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// x.ptr_はA{1}オブジェクトのポインタを保持しているが、</span></span>
<span id="cb589-6"><a href="#cb589-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">// x.Release()はそれをrvalueに変換し戻り値にする。</span></span>
<span id="cb589-7"><a href="#cb589-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">// その戻り値をa2で受け取るため、A{1}の所有はxからa2に移動する。</span></span>
<span id="cb589-8"><a href="#cb589-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>A<span class="op">&gt;</span> a2<span class="op">{</span>x<span class="op">.</span>Release<span class="op">()};</span>         <span class="co">// xからa2へA{1}の所有権の移動</span></span>
<span id="cb589-9"><a href="#cb589-9" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="kw">nullptr</span><span class="op">,</span> x<span class="op">.</span>GetA<span class="op">());</span>               <span class="co">// xは何も所有していない</span></span>
<span id="cb589-10"><a href="#cb589-10" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">1</span><span class="op">,</span> a2<span class="op">-&gt;</span>GetNum<span class="op">());</span>                 <span class="co">// a2はA{1}を所有</span></span></code></pre></div>
<p>
<img src="data:image/png;base64,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" />
</p>
<div class="sourceCode" id="cb590"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb590-1"><a href="#cb590-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/unique_ptr_ownership_ut.cpp 99</span></span>
<span id="cb590-2"><a href="#cb590-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb590-3"><a href="#cb590-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ステップ5</span></span>
<span id="cb590-4"><a href="#cb590-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// a2をstd::move()によりrvalueに変換し、ブロック内のa3に渡すことで、</span></span>
<span id="cb590-5"><a href="#cb590-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// A{1}の所有はa2からa3に移動する。</span></span>
<span id="cb590-6"><a href="#cb590-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb590-7"><a href="#cb590-7" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>A<span class="op">&gt;</span> a3<span class="op">{</span><span class="bu">std::</span>move<span class="op">(</span>a2<span class="op">)};</span></span>
<span id="cb590-8"><a href="#cb590-8" aria-hidden="true" tabindex="-1"></a>        ASSERT_FALSE<span class="op">(</span>a2<span class="op">);</span>                       <span class="co">// a2は何も所有していない</span></span>
<span id="cb590-9"><a href="#cb590-9" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="dv">1</span><span class="op">,</span> a3<span class="op">-&gt;</span>GetNum<span class="op">());</span>             <span class="co">// a3はA{1}を所有</span></span></code></pre></div>
<p>
<img src="data:image/png;base64,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" />
</p>
<div class="sourceCode" id="cb591"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb591-1"><a href="#cb591-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/unique_ptr_ownership_ut.cpp 109</span></span>
<span id="cb591-2"><a href="#cb591-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb591-3"><a href="#cb591-3" aria-hidden="true" tabindex="-1"></a>        <span class="co">// ステップ6</span></span>
<span id="cb591-4"><a href="#cb591-4" aria-hidden="true" tabindex="-1"></a>        <span class="co">// このブロックが終了することで、std::unique_ptrであるa3のデストラクタが呼び出される。</span></span>
<span id="cb591-5"><a href="#cb591-5" aria-hidden="true" tabindex="-1"></a>        <span class="co">// これはA{1}オブジェクトへのポインタをdeleteする。</span></span>
<span id="cb591-6"><a href="#cb591-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>                                      <span class="co">// a3によるA{1}の解放</span></span>
<span id="cb591-7"><a href="#cb591-7" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">1</span><span class="op">,</span> A<span class="op">::</span>LastDestructedNum<span class="op">());</span>  <span class="co">// A{1}が解放されたことの確認</span></span></code></pre></div>
<p>
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAhIAAAE0CAIAAAD2Qk1eAAAq5UlEQVR42u2dCXQV5R23CQlLAgkSRAISLWERRQwgiCxlESzoaRQRtFIpahWrpz30WHuQ1iNUEREoVaws2kMQCbJVRTZZBCUsgdBokABlT8IStpiEEBII+v0+3o/5pvfeTO5NQsjNfZ7D4cy88868M3P/7/+Zd2buTY2fAAAAvKYGpwAAANAGAABcY238CAAAUAJoAwAA0AYAAKANAABAGwAAgDYAAABtAAAAoA0AAEAbAACANgAAAG0AAADaAAAAtAEAAIA2AAAAbQAAANoAAAC0AQAAaAMAANAGAAAA2gAAALQBAABoAwAA0AYAAKANAABAGwAAAGgDAADQBgAAoA0HLl26VFRUZJ/NycmxV0hKStq5c+f3V0lOTs7Pzy9bW5s3b3788cc//PBDogcA0Ia/aiMxMbHG/xIaGnrgwAGrQg03JA9vtrxo0aKVK1euuoqmH3744R07djz77LNEDwCgDX/VxsmTJz/77DMrubds2bJjx472CgUFBfbZwsLC4uJib7Zcv359d+X07t1bYxfLK/fcc094eLhZREgBANrwM1JTU5W+582bZ2bz8/M3bdqU7MaWLVvOnj2rCjk5OcuXL5dXOnTosHHjRpVMmDBhzZo1ZvULFy7YN75+/Xpt3FQTM2bM0OzLL798+vRpggkA0Ib/cfny5Z49e2qoYQ0m9uzZU6MENmzYYEwQFBS0f//+gQMH/va3v9WKERERMofH7Y8ePVpLL168aGZbt26t7bRv3z40NPTee+/18sYXAADaqCq89NJLyuOPPPKI/GGJxMryf/3rX2NiYsx08RXM9G233TZ+/Hj5Q8OOL774QluwPxex0JBCzlATVknt2rVVWUOT1atXa6Jz586EFACgDb9BQwHjDP1vT+4WDz744AMPPOBenpGRYTRTUFBw5513/upXv3Kvk5+f369fP40qjh07ZhXeeuutaqvwCpqoX78+IQUAaMMP0ODgF7/4hRK3Bg2WP2bOnGmvk5KSEhwcPGvWrJI2cuLEia5du8oER48edd9+z549NbZYtmyZvfzPf/6zfbQxcOBAQgoA0EZVJycn58YbbwwLC5sxY4YpKS4u7tu3b8OGDc+dO2dK1q1b17Rp07vvvtv+9Q6LvLy8V155JTIysmXLlkeOHLEv0vhjyJAhEkbjxo2XLl3qPgT5/e9/HxUV1aBBA41y3H0DAIA2qiK62N+7d6+9JCMj45tvvrFmV6xYMXjw4FOnTpW0hT/96U+vv/66pRk7H3744dixY3NzcwkXAAB+XAQAANAGAACgDQAAQBsAAIA2AAAAbQAAAKANAABAGwAAgDYAAABtVCRt27atAeA7ipwKibqxY8faF2nW3gpLWWpfWp6oQxsVhj6bnwB8R5GTl5eXn59/4cKFoqIiL//yoxV1XH5C2fIV2kAb4MfayMzMPHnyZHZ2tuTh8fcu0QagDbQB8P+1kZaWdvDgwWPHjskcLn95Hm0A2kAbAK7a2LJlS2pqqsyRlZXl8YeQ0QZULC5PO9AG2gA/08aqVatkjl27dmVkZOTk5ARC5wdAG2gDyq6NhQsXrlmzJjk5+cCBA2fPniU1AKANACdtfPLJJ19++eX27dv379+PNgDQhs9JpNRNeVOnApNaVTZi+Xfv4sWL77//fq9evS5dumQvz87Orl27tjZep04dTbus0rNnzxkzZmiiemjDnMby16nM/bm+nb2cu1dUVPTPf/5TUacQspfr07eiziUStIqibvr06T69a4c20AbaqMjdu3z58ty5c1u0aKEt3HPPPZmZmfalsoLKTR+eOXOmfVF6enrnzp1V3rJly3nz5mk7aANteElxcfFHH31kRV1GRoZ9qaxgRZ0i0L7oyJEjVtR9/PHHPn2/xx0eiaONgL7DU7ZT8dlnn7Vr107rtm/f/vPPP3ev0K1bNy2dNm2a/u/evbt7hU8//dRs4c4771y6dOl10UZFdf6qpo2q39nLdiqsmFHUKQLdK5ioe/fdd03UuVf497//bUWd4rY8h4A2/EkbR48eHTFiRPPmzTUO1UXHsGHDNm7caE+CFtYquijWJUZYWFinTp10qWJf6p43fS0x00uWLNGQuWHDhpGRkXFxcYcOHfK4bnn2JDExsX///uHh4REREeoSK1as8NIKakjNqVFzneWy1OV0menCwsJRo0Y1bty4Zs2aLttcu3Ztly5dVKd169YJCQkexwoHDhxQhdtvv13T5gc8VOJxvKL90V6pQteuXb/66qtK1ob3nV9jKZeo++abb+xJ0MJaRafd+qznzJljX+qeN30tMdOLFy+2R93Bgwc9rluePVHnskfd8uXLvbSCGrKiTmHvstTldJnpCxcuWFHnss01a9ZYUacRqsexgj59E3U/Xv3ZGJV4HK+Ybmiibt26dWij+mujd+/eqqxrjYKCAoVFfHy84skhxSvNqaRHjx7pV9BEGbQRFBTkrI3Y2Nhvv/02Ly/vjTfe0Kx20r1mqXvi0MqGDRtCQkKUI5R/s7Ozhw8fbnzgjTZ0CaYRuobzpsX169eXasQpU6bocNTB7Iu2bt3at29fLb3llls+/PBDl4cZdl577TVVmzhxoqbfeust86s+JVXWdmbNmqWMrGrKUNu2bauC2jBRp6vd8+fP79u3b/bs2Yo6hxSvNGc+6yNXsD5rnySheHDWhqIuJSUlNzf39ddfN1HnXrPUPXFoRaFios6cWBN18oE32lDUHT582IpzXROUasTJkyfrcBQP9kVbtmyxou6DDz5weZhhx0Sd4k3TEyZMcP8tKTvazsyZM62oS0pKQhvVWRv16tVTZV0E2U+BQx7s06eP+UaYmd28eXMZtBEcHOysDYWdmT137px5Iudes9Q9cWhFXVfTO3fuNLMnT57UbJs2bbzRhhqyt6hOWKo2duzY4TJ6eOihh1Suq853331XYxHndmNiYnQsx44dM6NDXTzq4s55FW3zH//4R/369dXKoEGDdOFcpbRhok4jDI2QvLnrYj5rnXAzu2nTpjJoQ+fQWRsSuZnV9YqJOveape6JQysm6lJTU81sVlaWiTpvtKGG7C0q6krVRnJyssvowYq6d955R2MR53ZN1CnezOjQRJ3zKtrm1KlTrahTnKON6qmNnj17miDT+LdDhw4a1Zr0VFIe1PhdJcrmZtZ0MJ9u6HujjaKiIusjKElLznvi3IoO1v3HX13ql6QNlxYbNWpUqjZc3nHS7PTp05s2bapFDz74oC4JHRpNTExUtYEDB1olAwYMMHnEYS2JSquo2s0336zLQO9fsqocbbhHnUlPJeVB81nrhJtZDQh8vaHvjTbkWjMrmZWkJec9cW6lpKjzRhsuLSrqStWGyztOmn3//fetqPvPf/7j0KiuI03UWSUm6hSNDmtJVFbUzZgxw/uXrHgk7mfayMjIePrpp6Ojo604Vpf2XhtmNOCrNuy3+BVb3o9XHLThsifOrZgOfOrUqTI88XZp0RtteNxaQUHBpEmTdBRBQUFDhgzZvXu3x2ojR470+Avnzz//vMf6u3btGjx4sCrceOONU6ZM0QVgFXwknp6e7h513mvDukTwqUfYb/HLEN6PVxy04bInzq2YqNPQtgxPvF1a9EYbHrd2/vz5t99+24q6tLQ0j9Ucos5j/e+//96KusmTJ/v0U2Z+TaC/SaWrGOULrVivXj2rULHlsilzV7o8N6nM+3wKXzO7bdu2smnDeU+cWzG3GpYsWVIGbTjcpHI/XaU6Vaf9tddeCw8PV7r5zW9+Yz38t+413XDDDfpErAMR+fn5KmnYsKHL3a0DBw48+eST2k5ERMS4ceOUX6r+C7g5OTnz5883UWcVmtPo/iykPDepTDzo1JnZpKSksmnDeU+cWzFRt3jx4jJow+EmlfvpKtWpOu32qLMe/lv3mkzUWQcidJFkos7l7paCxIo6XTconn8MJAJUG926dVu4cOHhw4d1Pb5y5UrzRMta2qxZM5XYL4RXr15dzkfi5g7vhAkTFIipqakdO3Ysmzac98S5FfU99fAWLVqoYysj79mz54MPPujcubM32jAtWo/E161b53C6vByKnT59+qWXXqpbt26tWrVeeOEF6z6hUoxWHzZsmEv9J554wq69zMxMXQaGhISEhoa+/PLLZ86cqeLf21DULViwQI6U+VasWGGizlpqTqP9Qlj7U85H4iYe3nzzTdn0u+++s+LBV20474lzK4mJiSbqtm7dqoysOJk1a5aizhttmBatOF+7dq3D6fJyKKbRtj3qrPuEixYtMlHnUt9EnaU9dQF71CmGfww8AlQbimBFw6233lqnTp3o6OhnnnkmKyvLWhofH9+kSROX3KfCmJgYxUpsbKz1AqL32lCyiIuL0zC5QYMG3bt3N5mxDNpw3hPnVkRycvKgQYM02FdPbtWq1YgRI5QovdGGGlJzalT93+XlK/fT5dMdPGX/kSNHqh+qJ0vkKjHPMJctW+ZS84svvlC5lmpayd30/N/97nf251JVWRsaI7pE3YkTJ6yls2fPtk6jvdD6rHWefdWGLqjt8WAyYxm04bwnzq0InVWXqNM42BttqCEr6lxevnI/XT7dwVP2t6JOvUYlJuoUYy41ly5daqJO0/v27bOizv5cCm3wdb9A+bZdlfqOupL122+/7dMqb731lvfvSlX9b4n7XV+7pi8CVc4XG6WBiRMn+rSKhvLevyvFI3G0gTaq8zm87t8SRxuVr43rfg7RBtpAG4GojcD8tQ+0gTbQRkDw7bff/uEPf2jdunXt2rWbNGnSt29f68dFapRA4KgXbVwjkpKSRowYYaIuIiKiS5cukyZNMt/TLinqAke9aANtVHViY2OnTp2ampqan5+v5Hj//fe7/7JsYII2rh3yRHx8/N69ewsKCvbs2fPAAw/ojD333HOcGbSBNvyPjIwMnbGf/exnnAq0UWkcO3bM5QsrAQuPxNFGVcF8j8z8uFCbNm1effVV6zdLXDh16pT5uwKcNB6Jl5OEhASXqLN+s8SjNm688UZOmv+CNqobo0ePXrVqVX5+fm5u7uTJk3VOxowZ47Hmyy+/bP5mACeNF3DLiaJu5cqV586dy8nJmTRpkok6lzoXL17cu3ev+XrEX/7yF04a2kAbVZFLly7pnMTExLgvmjp1qrk8XLBgAScKbVQg0oOJOpe+aXHHHXecOXOGE4U20EaV4NSpU0899VTz5s1DQkKsXur+V5LMKCQoKGjatGk4A22Uk5MnT3qMOpdqRUVFO3fuNL8pO3ToUM4b2kAbVQLTJ8eMGXP69OmfrvwmoPt7tBMnTjTO+Ne//oUw0Eb5saJOVy0/XvlNQIf3aDMzM7Wofv36nDceiaONKkF4eLj9R86//vprF22MHz/eXAnGx8djCx6JVwgm6qwfOd+wYYODNo4ePcojcStfoQ20cf3p16+fTsLUqVPPnz+/bdu21q1b27Xxt7/9zfyFHPsfAwdewC0nJur+/ve/5+fnJyUlWVFnlnbt2nXu3Lk6qwUFBbt27TJDk3HjxqENtIE2qgTHjx9/7LHHIiMj69Sp06FDB+u1SCs5BvJXwdHGNeLYsWP2qJs3b57LD6c/+uij0dHRISEhjRo1uu+++1QBZ6ANtAFoAwBtoA1AG2gDrhk8EkcbwCNxgIAAbQDwAi4A2gBAGwBoA20A2gBAG2gD0AYEIjwSRxvAI3EA3/IV2kAbwAu4AGjDr4iKiqoB4DsRERFl1oYVdS7DDs3am2ApS12WKnLQRpUgJycnPT19586diYmJy5cvTwhgFJcJ4DWKFsWMIkfxoyjiWjjQrqAhcLWRl5d3/Pjxffv2paSkbNy4cWUAow68ErxG0aKYUeQofqwfcwW0AdVfG+fPnz9z5kxmZqb6f2pqalIAow6cBF6jaFHMKHIUP4oiUgPagEDRRmFhoS4V1fN1zXjkyJH/BjDqwP8Fr1G0KGYUOYofRRGpAW1AoGjj0qVL6vO6WszNzc3Ozj4dwKgDnwavUbQoZhQ5ih9FEakBbUCgaMNw+SrFAYw6cDF4jRUzJAW0AYGoDaADA1EHaAPowEDUAdoAOjAQdYA2gA4MRB2gDaADAxB1gDbowABEHaANoAMDUQdoA+jAQNQB2gA6MBB1gDaADgxEHaANoAMDEHWANujAAEQdoA2gAwNRB2gD6MBA1AHagIqjefPmNUrg3nvv5fwAUQdoA/6Hl19+uaQO/N5773F+gKgDtAH/Q0pKisfeGxIScurUKc4PEHWANsCVO++8070D//KXv+TMAFEHaAM88MYbb7h34I8//pgzA0QdoA3wQEZGhkvvrV+/fkFBAWcGiDpAG+CZnj172jvwk08+yTkBog7QBpTIhx9+aO/Aa9eu5ZwAUQdoA0rk1KlTdevWNb03Kirq4sWLnBMg6gBtgBODBg0yHfiPf/wjZwOIOkAbUAqLFy82HXj79u2cDSDqAG1AKRQUFNSvX79Vq1acCiDqAG2AVzz77LNvvPEG5wGIOkAb4BVr167dt28f5wGIOkAbAACANqBqYx51uk/7tCIAUYc2gA5MBwaiDm2gDaADA1EHaANMX1q8eHGvXr0aNmwYGRkZFxd38ODBknpaSZ3WfXrOnDmdOnUKCwtr2bLl3LlzXbZgYS+8cOHCqFGjGjduXLNmTT4aoo6oQxtQdTtwbGxsSkpKbm7u66+/rtnevXtbS4OCgsrWgbt163b48OH09PQePXpo9quvvnK47jMlkydP1m5cunSJz4WoI+rQBlTpDrx161Yzm5eXp9k6depYS4ODg8vWgTdt2mRmNaHZvn37ltqBk5OT+USIOqIObYAfdODCwkIze/nyZZeuWOYOrFxgZnU5qdlGjRqV2oGLior4RIg6og5tgB90YIcuar/hq35ehg5sriW96cB8HEQdUYc2wL87cO3atTWdn59vZpOSkirkdkFQUBAdmKgj6tAGVMMO3KtXL02/+eabunb77rvvOnbs6H0H7tGjx5EjR6yHk/Y/0dOsWTOVpKWl0YGJOqIObUC16sAHDx6Mi4uLjIxs0KBB9+7dFy1a5H0Hjo+Pj42NDQ0NbdGixZw5c+xNzJ49u0mTJmV+AR+IOqIObUA1TwoARB3aAKADA1EHaAPowEDUAdoAAAC0AQAAaAMAANAGAACgDQAAALQBAABoAwCuL23bth07dqy9RLP2v5vkd0t1RHysaAMArhXV7xsVfEcEbQAASRZtoA0AIMlyRGgDAPwOl4cEaANtAAAgQrSBNgAAAG0AAADaAADwb7z/4XeffiK+Mn9PHm0AQIVxTZ8EJCQkxMTEBAcHe592Q0JCtIpWRBtoAwCq6KV0mdd95513TO579913PVZo1KiRlq5Zs+bSpUsu6dJj0lS1L7/8UuVaseqIEG0AAFSANi5fvnzbbbcFX6Ft27aaLSkzFhcXe580ZY5y5tPy5+KPPvqoZcuWYWFhnTp1mjNnjsv+bNy4sX///uHh4REREd27d1++fHlJB1VqTXd9OqyCNgDAv7WxevVqrfvoo48OHjzYDClcKly4cEHlNWvW9PVaOygoSIsKCwuvizZ0INpCjx49jlxBE/ZdXb9+fUhISK9evfbv33/27Nnhw4drkdTiflDONT2egVJXQRsA4MfaeOihh7Tuhg0blOw08fDDD9uXFhUVzZ49W+UxMTG+akOraJFW10YqXxt9+vTRFjZv3mxmN23aZN9V5XRNp6ammtmsrCzNtmnTxv2gnGt6PAOlroI2AOD6U7YnAYcPHw4ODm7fvr2Z1YRmdW3ukhNVuHjxYl+1sWTJEvMUvWwCKKc2IiMjtYW8vDwzm5uba9+TsLCwGm5ob90PyrmmxzNQ6ipoAwD8ldGjRyujzZw508xqQrOvvPKKVeHChQuTJ09WYbt27XzVhlbRoilTpmgjlSbCkrShCXcZnDx5stSDcq7poA2HVdAGAPglyuY33nij+3WxCu2JPicnR4W1atXyVRshISFapNWvy9H17t3b4SaVuYXlzRDKueaPVx/h2EtKXQVtAIBfEh8fr+x2//332wv79evn/vzWwQ1lW1QJmDeAS3oknpiYWLt27RYtWmzdujU/P3/37t2zZs3q3Lmz+5471xTNmjVT5bS0NKuk1FXQBgD4JV26dFG+mz9/vr0wISFBhVrkLgCXe03uwxT70oKCguurDTF79uyYmJjQ0NDY2FjjSPv+bN++fdCgQY0aNVKKb9Wq1YgRI7Zt2+ZReA41TStNmjTxaRW0AQDXn2v6LfHo6GjlxEWLFtm/7ueAqi1YsECr3HLLLXw0FQjaAIAK45pe13/++eetW7f26cdFVFmraMWqKUK0AQBog7/uhzYAANAGoA0AIMmiDbQBANcZ/pY42gAAQISANgAAAG0AAADaAAAAtAEA1RSeBKANAAAfqH7vHSFCtAEAaCOgjwhtAABJliNCGwBAkuWI0AYAVHv4ljjaAABAhIA2AAAAbQAAANoAAAC0AQDVFJ4EoA0AAB/gW+JoAwAgoLXBC7hoAwCuIVFRUcqzLlfomq1hw7+W6oj4WNEGAACgDQAAQBsAAIA2AAAAbQAAANoAAABAGwAAgDYAAABtAAAA2gAAALQBAABoAwAAAG0AAADauIJf/9AmS1nK0uuyFBhtAAAA2gAAALQBAABoAwAA0AYAAADaAAAAtAEAAGgDAADQBgAAoA0AAEAbAAAAaAMAANAGAACgjWtP27ZtawD4P4rkAIxq+1ED2qgkFHk/Afg/iuS8vLz8/PwLFy4ETlTbj7qoqKi4uJjkjjbQBoC3CTQzM/PkyZPZ2dkBpQ3rqCUPmYPkjjbQBoC3CTQtLe3gwYPHjh0LKG1YRy1zFBQUkNzRBtoA8DaBbtmyJTU1VTk0oLRhHXVWVta5c+dI7mgDbQB4m0BXrVqlHLpr166A0oZ11BkZGTk5OSR3tIE2ALxNoAsXLlyzZk1ycnJAacM66gMHDpw9e5bkjjbQBoC3CfSTTz758ssvt2/fHlDasI56//79aANtVF1tZGdn165dW+vWqVNH02WI9WvUsUvasq7Fhg0bFh0drd2uX79+ixYt4uLiKqFLX+v8Vf4m7Fsw0x06dLh06VKlHcjEiRO18X79+lkl9913n0omTZqENtLS0saNG9euXbuSPgK0gTb8RhszZszQisYcM2fOrOLaeO+994KDgx955JFdu3YVFhZqLL9o0SLlJrThURvi7bffrpwDkZ9uvvlmbXzr1q1W4ZYtW1Sichd7BaA27rjjjrFjx0oeaANt+L02unXrphWnTZum/7t3716VtbFp06agoKAuXbpcvny58m8g+KM2mjRpEhYWdujQoUo4EOU7bbljx44u5RrxqHz16tXcpHL+CNAG2vAPbehqXWvdfvvtmja/4qASh/j2psSF+fPnmzp16tRp06bNq6++WlRUZBYdPXp0xIgRzZs316IWLVoMGzZs48aNLhfL9u1rkKHpTz/91KE5paeePXsqV4aGhvbo0cOercymlixZ0qtXr4YNG0ZGRsbFxVkp1dedMdMa8YwaNapx48Y1a9b05vx8//33jz/+eFRUlFq5++67P//8c4cmRGJiYv/+/cPDwyMiIiT1FStW2Dc+d+7cli1b6mA7der00Ucfue/eggUL9P+AAQMc1OKwt2Y2ISGhXbt22uH27dtrB8aPH9+sWTM1qvOsa2er8osvvug+uBEqUbmWog20gTaqgzZee+01rTVx4kRNv/XWW5rWOLpitTF69OhVq1bl5+fn5uZOnjxZlceMGWMW9e7dW7OfffZZQUGB+kl8fLxGEg5bvummm1Ry5MgRB2cofWv8pDrp6ema0KxlDrPB2NjYb7/9Ni8v74033tCs9qFsO2NKpkyZoq0VFxdbhRoPlXR+lA4ks+jo6HXr1p07dy4lJUVycmhiw4YNISEhkpxcnp2dPXz4cFWQHszStWvXalZqTL+CJjwqQWrUxLx58zxqw2FvrdlBgwadOXNm4cKFZnbw4MHKaEpwmtYZtirLgi53qOz3qbQUbaANtFEdtBETExMcHHzs2DFzua0kq6vXitWGy+1vVVajZrZevXqa1UW9/VN02LJyqLnAL2n7JnVu3rzZuqmlWV0U2zeYlJRkZpW4zRiobDtjSnbs2OFSqPNZ0or9+vXTtDXCKLUJCUMlO3fuNLMnT57UrEZsZrZPnz7mC2JmVkftURv6WDVS0XhIachdGw57a83u2bNH07KpfdZ8lLVr17Yq33DDDSo5ffq0y3GdOnVK5RreoQ20gTb8XhuJiYlaZeDAgVbJgAEDVKJsW1F35JUynnrqqebNm5uMbzD3c4QSuikJCwvr0KHDqFGjjMBK2rJyn/NoQ9fyqiAfmFkNKTSrQvsGrVtk5oxZTfi6M6bk4sWL3mtDW9Z0Sa+ruTdh6rtgbT8yMtL9YD3egJo+fbqmn3766bJpw3qa7XLILpW1KfcTIlSicgUA2kAbaMPvtTFy5EiPP+D8/PPPV5Q2jIfGjBljLkI1ULDXz8jIUC6Ljo62mrZGBh63XOqzDRdtmPGEkq83QyVfd8bjgdulKKQod2388MMPPmlD6vVY30Ub5mA9akOx8fOf/1yzGzZscKnjsLclWaSkWUYbaANtVHNtKIOrn9erV+/8+fNWYX5+vkrUw82NoPLfpAoPD7entq+//tpj/dzcXHOvXK1bhUFBQR7fpOratavH+0juN6nMfRuXm1Sl7ryXO+NxXfMes3VKt23bZq9mvsSwdOlSjzvv3oS5DbVkyRKP9c3DmFJvUhn27t1rXkmwlzvvra/aMG9M8WwDbaCNaquNxYsXq779kazhiSeesFJV+bVh7uZPnTpVuUlZqXXr1vb63bp1W7hw4eHDh3Wdu3LlSpX379/fWrdZs2Yq2b17t32D06ZN0wXyo48+mpaWprW0rgYf1vfLzCNx85RYowdNuD8SL2nnfd0ZjwdunkZMmDBBpkxNTe3YsaO9WlJSUt26dW+99db169fL0N99992QIUMcmpAmldlbtGihFXUC9+zZ88EHH3Tu3Nk6WG8eiVuMHz/e5U0t5731VRvPPfecw5tUL7zwAtpAG2jDv7Xx0EMPqf6yZctcyr/44guVa6lP2nDHLD1+/Phjjz0WGRmpS11djSYkJNiX6spUllIa1dLo6OhnnnkmKyvL2nJ8fHyTJk3cW1Snku1uvvnmWrVqhYaG3nLLLQ8++KDLC7ihV+jevbs6oZfO83VnPHb+Q4cOxcXF6XgbNGig1o2b7dWUnYcOHXrTTTeplU6dOtkfj3s83uTk5EGDBjVq1Ej+aNWq1YgRI3T49lViYmJ0pLGxsXPmzHHevYsXL95111328lL31qfZFStWmO+lu5wTMwqxfxABq42SugnaQBv+9CYVQEUhLTVt2tR+3+wnviXuo1TQBtpAGxBYmN+ksv/Wi3mc437nCm2gDbSBNgCuSQJFG4A20AYA2kAbaANtAKANtIE20AYA2kAbaANtAKANtIE20MYVoqKiagD4PxEREVYCNT9EFmhHjTbQRuWRk5OTnp6+c+fOxMTE5cuXJwD4J4pexbAiOf0qgRDV9qNWXya5o43KIC8v7/jx4/v27UtJSdm4ceNKAP9E0asYViQfv0ogRLX9qNWXSe5oozI4f/78mTNnMjMzFXmpqalJAP6JolcxrEg+c5VAiGr7Uasvk9zRxjXH/FVXAH8nJibmyJEjuuJW9mx7880BeNQaahQWFpLc0QZvUgF4+05Renr6iRMnzp49+3+jetGiQPhnP+pz584VFRWR3NEG2gBAG2gDbaANgGugjbS0tIMHDx47diygtGEddXZ2dkFBAckdbaANAG+1sWXLltTUVOXQgNKGddRZWVkacJDc0QbaAPBWG6tWrVIO3bVrV0BpwzrqjIwMvreBNqqoNjQWNn9Quk6dOpouQ/e+Rq4q6S/xBQUF1a1bNyoqqnv37mPHjtVw/tq1WAkHVZ4tmOkOHTq4/AWka3og5i9qWH+F96erf1Fj0qRJFXuiFi5cuGbNmuTk5GqjjbSpU8cNHdouOvr/fUCetGEd9YEDB/iWONqootqYMWOG1jLmmDlzZtXXhiaUJTMzM+Pj41u0aNGgQYOlS5cGsjbc/wjStTsQnfmbr7wOu3XrVquwbH+/r9TD/J/fpKoW2rijefOxQ4dKHg7a4MdF0IYfaKNbt25aa9q0afpf1+9+oQ0L9auWLVtqnPT9998HrDaaNGkSFhZ26NChSjgQZTRtuWPHji7l5q+Fr169Gm14eTMKbaANf9WGBsJa5fbbb9e0+aqgSnxK3KVmqPnz55s6Su5t2rR59dVXi4qKzKKjR4+OGDGiefPmWqRxw7BhwzZu3OhyHe2eJV22n5CQoMJf//rXVkliYmL//v3Dw8MjIiIkwhUrVliLytZiYWHhqFGjGjduXLNmTW9Oghz2+OOPR0VFqZW77777888/d2jCeYfF3LlzpUaJoVOnTh999JH77i1YsED/DxgwwEEtDntrZnUa27Vrpx1u3769dmD8+PHNmjVToz179kxLS7Mqv/jiix7/wqtKVK6laANtoI1qro3XXntNq0ycOFHTb731lqbHjh1bsdoYPXr0qlWr8vPzc3NzJ0+erMpjxowxi3r37q3Zzz77rKCgQJ0kPj6+S5cuvraVlZWlwqZNm5rZDRs2hISE9OrVS/7Lzs4ePny4lirblqfFKVOmfPvtt8XFxVZhUFBQSTumDh8aGhodHb1u3bpz586lpKRITg5NOO/w2rVrNdujRw/zW36a8KiEuLg4TcybN8+jNhz21podNGjQmTNnFi5caGYHDx6snKUUpmmNR63KsqDLHSr7fSotRRtoA21Uc23ExMQEBwebp8q6EtfVtC5sK1YbLnfGzS8omNl69eppVtf79o/Q17YuXryowlq1aplZ5V/N7ty508yePHlSsxrllKfFHTt2uBTqpJW0Yr9+/TRtjTBKbcJ5h/v06WNeyjSzmzdv9qgNfXYaqWg8pETjrg2HvbVm9+zZo2nZ1D5rPq/atWtblW+44QaVnD592uW4Tp06pfKGDRuiDbSBNqqzNhITE1V/4MCBVsmAAQNUsmnTpoq6Wa9s8tRTTzVv3lwX1NbNGXOrR/Ts2dOUhIWFdejQYdSoUfbXorzUxokTJ+yjDW3K/ad+rLxZthZlJu+1YXagpHfS3Jtw3uHIyEjNatRiZvPy8kq6ATV9+nRNP/3002XThvU02+WQXSprU+4nxJK3PmW0gTbQRnXWxsiRIz3+ntrzzz9fUdowHhozZoy5Pi0sLLTXz8jIUJqLvvo+olBa91UbH3/8sQqtG0EmC0tXHvenQlq0m08UFRW5a+OHH37wSRsl7bCLNjRRkjb06f/85z/X7IYNG1zqOOxtSRYpaZbRBtpAG4GrDWVwpYB69eqdP3/eKszPz1eJOr+WVshNqvDwcHvW+/rrrz3Wz83NNbfR1bpVGBQUVIY3qcxdnSVLljgffplbFOZlZeu8bdu2zV7NfImhpHeC3Ztw3mHzMKbUm1SGvXv3mvcO7OXOe+urNswbUzzbQBtoIxC1sXjxYvtFusUTTzxhZbHya8Pc6J86darSlhJW69at7fW7deu2cOHCw4cP6xJ45cqVKu/fv7+1brNmzVSye/du97aKi4uPHj1qfW/D/iBh06ZNSpQqT0pKUqN79uz54IMPOnfuXM4W3Z9GTJgwQTpMTU3t2LGjvZrarVu37q233rp+/Xpp+LvvvhsyZIhDE847vHr1am8eiVuMHz/e5U0t5731VRvPPfecw5tUL7zwAtpAG2ij2mrjoYceUuVly5a5lH/xxRcq11KftOGOWXr8+PHHHnssMjJSV8G6UDUvy1pLddEqSynDaml0dPQzzzyTlZVlbVlWaNKkiXuW1AW76ptviY8bN879W+LJycmDBg1q1KiR0nGrVq1GjBihTlieFl22f+jQobi4OB2UjKV9MAK2V1N2Hjp06E033aRWOnXqZLeaexPOO2xWiYmJCQ0NjY2NnTNnjvPuXbx48a677rKXl7q3Ps2uWLHCfC/d4/c2lO/QhjfC+J+egjbQhn+9SQXgE9JS06ZN7ffNfuJb4hUqFbSBNtAGVDfMb1Ldd999Vol5nON+5wptoA20gTYAKgm0gTbQBtoAQBtoA22gDQC0gTbQBtoAQBtoA22gDQC0gTYAbaANQBtoA9AG2gBAG2gDbVQSUVFRNQD8n4iICCuBNm7cOACPGm2gjcojJycnPT19586diYmJy5cvTwDwTxS9imFFcvpVAiGq7UetvkxyRxuVQV5e3vHjx/ft25eSkrJx48aVAP6JolcxrEg+fpVAiGr7Uasvk9zRRmVw/vz5M2fOZGZmKvJSU1OTAPwTRa9iWJF85iqBENX2o1ZfJrmjjcqgsLBQFymKOV2tHDly5L8A/omiVzGsSM67SiBEtf2o1ZdJ7mijMrh06ZKiTdcpubm52dnZpwH8E0WvYliRXHiVQIhq+1GrL5Pc0UblcfkqxQD+iRXDARXV7kcNaAMAANAGAACgDQAAQBsAAABoAwAA0AYAAKANAABAGwAAgDYAAABtAAAAoA0AAEAbAACANgAAAG0AAADaAAAAtAEAAIA2AAAAbQAAANoAAAC0AQAAaAMAANAGAAAA2gAAALQBAABoAwAAqqQ2AAAASgVtAAAA2gAAgGvD/wE+yMFWIj1W6wAAAABJRU5ErkJggg==" />
</p>
<p>また、以下に見るようにstd::unique_ptrはcopy生成やcopy代入を許可しない。</p>
<div class="sourceCode" id="cb592"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb592-1"><a href="#cb592-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/unique_ptr_ownership_ut.cpp 123</span></span>
<span id="cb592-2"><a href="#cb592-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb592-3"><a href="#cb592-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> a0 <span class="op">=</span> <span class="bu">std::</span>make_unique<span class="op">&lt;</span>A<span class="op">&gt;(</span><span class="dv">0</span><span class="op">);</span></span>
<span id="cb592-4"><a href="#cb592-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb592-5"><a href="#cb592-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// auto a1 = a0;                            // 下記のようなメッセージでコンパイルエラー</span></span>
<span id="cb592-6"><a href="#cb592-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">//      unique_ptr_ownership_ut.cpp:125:15: error: use of deleted function ‘std::unique_ptr ...</span></span>
<span id="cb592-7"><a href="#cb592-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb592-8"><a href="#cb592-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> a1 <span class="op">=</span> <span class="bu">std::</span>move<span class="op">(</span>a0<span class="op">);</span>                    <span class="co">// すでに示したようにmove生成は可能</span></span>
<span id="cb592-9"><a href="#cb592-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb592-10"><a href="#cb592-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> a2 <span class="op">=</span> <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>A<span class="op">&gt;{};</span></span>
<span id="cb592-11"><a href="#cb592-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb592-12"><a href="#cb592-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">// a2 = a1;                                 // 下記のようなメッセージでコンパイルエラー</span></span>
<span id="cb592-13"><a href="#cb592-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">//      unique_ptr_ownership_ut.cpp:131:10: error: use of deleted function ‘std::unique_ptr ...</span></span>
<span id="cb592-14"><a href="#cb592-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb592-15"><a href="#cb592-15" aria-hidden="true" tabindex="-1"></a>    a2 <span class="op">=</span> <span class="bu">std::</span>move<span class="op">(</span>a1<span class="op">);</span>                         <span class="co">// すでに示したようにmove代入は可能</span></span>
<span id="cb592-16"><a href="#cb592-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb592-17"><a href="#cb592-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">//</span></span>
<span id="cb592-18"><a href="#cb592-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> x0 <span class="op">=</span> X<span class="op">{</span><span class="bu">std::</span>make_unique<span class="op">&lt;</span>A<span class="op">&gt;(</span><span class="dv">0</span><span class="op">)};</span></span>
<span id="cb592-19"><a href="#cb592-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb592-20"><a href="#cb592-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">// auto x1 = x0;                            // Xはstd::unique_ptrをメンバとするため、</span></span>
<span id="cb592-21"><a href="#cb592-21" aria-hidden="true" tabindex="-1"></a>                                                <span class="co">// デフォルトのcopyコンストラクタによる生成は</span></span>
<span id="cb592-22"><a href="#cb592-22" aria-hidden="true" tabindex="-1"></a>                                                <span class="co">// コンパイルエラー</span></span>
<span id="cb592-23"><a href="#cb592-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> x1 <span class="op">=</span> <span class="bu">std::</span>move<span class="op">(</span>x0<span class="op">);</span>                    <span class="co">// デフォルトのmove生成は可能</span></span>
<span id="cb592-24"><a href="#cb592-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb592-25"><a href="#cb592-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> x2 <span class="op">=</span> X<span class="op">{</span><span class="bu">std::</span>make_unique<span class="op">&lt;</span>A<span class="op">&gt;(</span><span class="dv">0</span><span class="op">)};</span></span>
<span id="cb592-26"><a href="#cb592-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb592-27"><a href="#cb592-27" aria-hidden="true" tabindex="-1"></a>    <span class="co">// x2 = x1;                                 // Xはstd::unique_ptrをメンバとするため、</span></span>
<span id="cb592-28"><a href="#cb592-28" aria-hidden="true" tabindex="-1"></a>                                                <span class="co">// デフォルトのcopy代入子の呼び出しは</span></span>
<span id="cb592-29"><a href="#cb592-29" aria-hidden="true" tabindex="-1"></a>                                                <span class="co">// コンパイルエラー</span></span>
<span id="cb592-30"><a href="#cb592-30" aria-hidden="true" tabindex="-1"></a>    x2 <span class="op">=</span> <span class="bu">std::</span>move<span class="op">(</span>x1<span class="op">);</span>                         <span class="co">// デフォルトのmove代入は可能</span></span></code></pre></div>
<p>以上で示したstd::unique_ptrの仕様の要点をまとめると、以下のようになる。</p>
<ul>
<li>std::unique_ptrはダイナミックに生成されたオブジェクトを保持する。</li>
<li>ダイナミックに生成されたオブジェクトを保持するstd::unique_ptrがスコープアウトすると、
保持中のオブジェクトは自動的にdeleteされる。</li>
<li>保持中のオブジェクトを他のstd::unique_ptrにmoveすることはできるが、
copyすることはできない。このため、下記に示すような不正な方法以外で、
複数のstd::unique_ptrが1つのオブジェクトを共有することはできない。</li>
</ul>
<div class="sourceCode" id="cb593"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb593-1"><a href="#cb593-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/unique_ptr_ownership_ut.cpp 161</span></span>
<span id="cb593-2"><a href="#cb593-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb593-3"><a href="#cb593-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 以下のようなコードを書いてはならない</span></span>
<span id="cb593-4"><a href="#cb593-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb593-5"><a href="#cb593-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> a0 <span class="op">=</span> <span class="bu">std::</span>make_unique<span class="op">&lt;</span>A<span class="op">&gt;(</span><span class="dv">0</span><span class="op">);</span></span>
<span id="cb593-6"><a href="#cb593-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> a1 <span class="op">=</span> <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>A<span class="op">&gt;{</span>a0<span class="op">.</span>get<span class="op">()};</span>  <span class="co">// a1もa0が保持するオブジェクトを保持するが、</span></span>
<span id="cb593-7"><a href="#cb593-7" aria-hidden="true" tabindex="-1"></a>                                             <span class="co">// 保持されたオブジェクトは二重解放される</span></span>
<span id="cb593-8"><a href="#cb593-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb593-9"><a href="#cb593-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> a_ptr <span class="op">=</span> <span class="kw">new</span> A<span class="op">{</span><span class="dv">0</span><span class="op">};</span></span>
<span id="cb593-10"><a href="#cb593-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb593-11"><a href="#cb593-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> a2 <span class="op">=</span> <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>A<span class="op">&gt;{</span>a_ptr<span class="op">};</span></span>
<span id="cb593-12"><a href="#cb593-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> a3 <span class="op">=</span> <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>A<span class="op">&gt;{</span>a_ptr<span class="op">};</span>  <span class="co">// a3もa2が保持するオブジェクトを保持するが、</span></span>
<span id="cb593-13"><a href="#cb593-13" aria-hidden="true" tabindex="-1"></a>                                          <span class="co">// 保持されたオブジェクトは二重解放される</span></span></code></pre></div>
<p>こういった機能によりstd::unique_ptrはオブジェクトの排他所有を実現している。</p>
<h4 id="オブジェクトの共有所有">オブジェクトの共有所有
<a id="SS_5_2_9_2"></a></h4>
<p>オブジェクトの共有所有や、それを容易に実現するための <a
href="https://cpprefjp.github.io/reference/memory/shared_ptr.html">std::shared_ptr</a>
の仕様をを説明するために、下記のようにクラスA、Xを定義する。</p>
<div class="sourceCode" id="cb594"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb594-1"><a href="#cb594-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/shared_ptr_ownership_ut.cpp 7</span></span>
<span id="cb594-2"><a href="#cb594-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb594-3"><a href="#cb594-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> A <span class="kw">final</span> <span class="op">{</span></span>
<span id="cb594-4"><a href="#cb594-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb594-5"><a href="#cb594-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> A<span class="op">(</span><span class="dt">int32_t</span> n<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">:</span> <span class="va">num_</span><span class="op">{</span>n<span class="op">}</span> <span class="op">{</span> <span class="va">last_constructed_num_</span> <span class="op">=</span> <span class="va">num_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb594-6"><a href="#cb594-6" aria-hidden="true" tabindex="-1"></a>        <span class="op">~</span>A<span class="op">()</span> <span class="op">{</span> <span class="va">last_destructed_num_</span> <span class="op">=</span> <span class="va">num_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb594-7"><a href="#cb594-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb594-8"><a href="#cb594-8" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span> GetNum<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">num_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb594-9"><a href="#cb594-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb594-10"><a href="#cb594-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="dt">int32_t</span> LastConstructedNum<span class="op">()</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">last_constructed_num_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb594-11"><a href="#cb594-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="dt">int32_t</span> LastDestructedNum<span class="op">()</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">last_destructed_num_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb594-12"><a href="#cb594-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb594-13"><a href="#cb594-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb594-14"><a href="#cb594-14" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span> <span class="at">const</span>  <span class="va">num_</span><span class="op">;</span></span>
<span id="cb594-15"><a href="#cb594-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="dt">int32_t</span> <span class="va">last_constructed_num_</span><span class="op">;</span></span>
<span id="cb594-16"><a href="#cb594-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> <span class="dt">int32_t</span> <span class="va">last_destructed_num_</span><span class="op">;</span></span>
<span id="cb594-17"><a href="#cb594-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb594-18"><a href="#cb594-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb594-19"><a href="#cb594-19" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int32_t</span> A<span class="op">::</span><span class="va">last_constructed_num_</span> <span class="op">=</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb594-20"><a href="#cb594-20" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int32_t</span> A<span class="op">::</span><span class="va">last_destructed_num_</span>  <span class="op">=</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb594-21"><a href="#cb594-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb594-22"><a href="#cb594-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> X <span class="kw">final</span> <span class="op">{</span></span>
<span id="cb594-23"><a href="#cb594-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb594-24"><a href="#cb594-24" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Xオブジェクトの生成と、ptrからptr_へ所有権の移動もしくは共有</span></span>
<span id="cb594-25"><a href="#cb594-25" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> X<span class="op">(</span><span class="bu">std::</span>shared_ptr<span class="op">&lt;</span>A<span class="op">&gt;</span> ptr<span class="op">)</span> <span class="op">:</span> <span class="va">ptr_</span><span class="op">{</span><span class="bu">std::</span>move<span class="op">(</span>ptr<span class="op">)}</span> <span class="op">{}</span></span>
<span id="cb594-26"><a href="#cb594-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb594-27"><a href="#cb594-27" aria-hidden="true" tabindex="-1"></a>        <span class="co">// ptrからptr_へ所有権の移動</span></span>
<span id="cb594-28"><a href="#cb594-28" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> Move<span class="op">(</span><span class="bu">std::</span>shared_ptr<span class="op">&lt;</span>A<span class="op">&gt;&amp;&amp;</span> ptr<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="va">ptr_</span> <span class="op">=</span> <span class="bu">std::</span>move<span class="op">(</span>ptr<span class="op">);</span> <span class="op">}</span></span>
<span id="cb594-29"><a href="#cb594-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb594-30"><a href="#cb594-30" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span> UseCount<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">ptr_</span><span class="op">.</span>use_count<span class="op">();</span> <span class="op">}</span></span>
<span id="cb594-31"><a href="#cb594-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb594-32"><a href="#cb594-32" aria-hidden="true" tabindex="-1"></a>        A <span class="at">const</span><span class="op">*</span> GetA<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">ptr_</span> <span class="op">?</span> <span class="va">ptr_</span><span class="op">.</span>get<span class="op">()</span> <span class="op">:</span> <span class="kw">nullptr</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb594-33"><a href="#cb594-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb594-34"><a href="#cb594-34" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb594-35"><a href="#cb594-35" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>shared_ptr<span class="op">&lt;</span>A<span class="op">&gt;</span> <span class="va">ptr_</span><span class="op">{};</span></span>
<span id="cb594-36"><a href="#cb594-36" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>下記に示した上記クラスの単体テストにより、
オブジェクトの所有権やその移動、共有、 std::shared_ptr、std::move()、<a
href="#SS_5_5_3">rvalue</a>の関係を解説する。</p>
<div class="sourceCode" id="cb595"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb595-1"><a href="#cb595-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/shared_ptr_ownership_ut.cpp 47</span></span>
<span id="cb595-2"><a href="#cb595-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb595-3"><a href="#cb595-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ステップ0</span></span>
<span id="cb595-4"><a href="#cb595-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// まだ、クラスAオブジェクトは生成されていないため、</span></span>
<span id="cb595-5"><a href="#cb595-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// A::LastConstructedNum()、A::LastDestructedNum()は初期値である-1である。</span></span>
<span id="cb595-6"><a href="#cb595-6" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(-</span><span class="dv">1</span><span class="op">,</span> A<span class="op">::</span>LastConstructedNum<span class="op">());</span>     <span class="co">// まだ、A::A()は呼ばれてない</span></span>
<span id="cb595-7"><a href="#cb595-7" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(-</span><span class="dv">1</span><span class="op">,</span> A<span class="op">::</span>LastDestructedNum<span class="op">());</span>      <span class="co">// まだ、A::~A()は呼ばれてない</span></span></code></pre></div>
<div class="sourceCode" id="cb596"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb596-1"><a href="#cb596-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/shared_ptr_ownership_ut.cpp 56</span></span>
<span id="cb596-2"><a href="#cb596-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb596-3"><a href="#cb596-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ステップ1</span></span>
<span id="cb596-4"><a href="#cb596-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// a0、a1がそれぞれ初期化される。</span></span>
<span id="cb596-5"><a href="#cb596-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> a0 <span class="op">=</span> <span class="bu">std::</span>make_shared<span class="op">&lt;</span>A<span class="op">&gt;(</span><span class="dv">0</span><span class="op">);</span>           <span class="co">// a0はA{0}を所有</span></span>
<span id="cb596-6"><a href="#cb596-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> a1 <span class="op">=</span> <span class="bu">std::</span>make_shared<span class="op">&lt;</span>A<span class="op">&gt;(</span><span class="dv">1</span><span class="op">);</span>           <span class="co">// a1はA{1}を所有</span></span>
<span id="cb596-7"><a href="#cb596-7" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">1</span><span class="op">,</span> a0<span class="op">.</span>use_count<span class="op">());</span>               <span class="co">// A{0}の共有所有カウント数は1</span></span>
<span id="cb596-8"><a href="#cb596-8" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">1</span><span class="op">,</span> a1<span class="op">.</span>use_count<span class="op">());</span>               <span class="co">// A{1}の共有所有カウント数は1</span></span>
<span id="cb596-9"><a href="#cb596-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb596-10"><a href="#cb596-10" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">1</span><span class="op">,</span>  A<span class="op">::</span>LastConstructedNum<span class="op">());</span>     <span class="co">// A{1}は生成された</span></span>
<span id="cb596-11"><a href="#cb596-11" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(-</span><span class="dv">1</span><span class="op">,</span> A<span class="op">::</span>LastDestructedNum<span class="op">());</span>      <span class="co">// まだ、A::~A()は呼ばれてない</span></span></code></pre></div>
<p>
<img src="data:image/png;base64,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" />
</p>
<div class="sourceCode" id="cb597"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb597-1"><a href="#cb597-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/shared_ptr_ownership_ut.cpp 68</span></span>
<span id="cb597-2"><a href="#cb597-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb597-3"><a href="#cb597-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ステップ2</span></span>
<span id="cb597-4"><a href="#cb597-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// x0が生成され、オブジェクトA{0}がa0とx0に共同所有される。</span></span>
<span id="cb597-5"><a href="#cb597-5" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">0</span><span class="op">,</span> a0<span class="op">-&gt;</span>GetNum<span class="op">());</span>                 <span class="co">// a0はA{0}を所有</span></span>
<span id="cb597-6"><a href="#cb597-6" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">1</span><span class="op">,</span> a0<span class="op">.</span>use_count<span class="op">());</span>               <span class="co">// A{0}の共有所有カウントは1</span></span>
<span id="cb597-7"><a href="#cb597-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> x0 <span class="op">=</span> X<span class="op">{</span>a0<span class="op">};</span>                            <span class="co">// x0の生成と、a0とx0によるA{0}の共有所有</span></span>
<span id="cb597-8"><a href="#cb597-8" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">2</span><span class="op">,</span> a0<span class="op">.</span>use_count<span class="op">());</span>               <span class="co">// A{0}の共有所有カウント数は2</span></span>
<span id="cb597-9"><a href="#cb597-9" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">2</span><span class="op">,</span> x0<span class="op">.</span>UseCount<span class="op">());</span></span>
<span id="cb597-10"><a href="#cb597-10" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>x0<span class="op">.</span>GetA<span class="op">(),</span> a0<span class="op">.</span>get<span class="op">());</span></span></code></pre></div>
<p>
<img src="data:image/png;base64,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" />
</p>
<div class="sourceCode" id="cb598"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb598-1"><a href="#cb598-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/shared_ptr_ownership_ut.cpp 79</span></span>
<span id="cb598-2"><a href="#cb598-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb598-3"><a href="#cb598-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ステップ３</span></span>
<span id="cb598-4"><a href="#cb598-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// x1が生成され、オブジェクトA{0}の所有がa0からx1へ移動する。</span></span>
<span id="cb598-5"><a href="#cb598-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> x1 <span class="op">=</span> X<span class="op">{</span><span class="bu">std::</span>move<span class="op">(</span>a0<span class="op">)};</span>                 <span class="co">// x1の生成と、a0からx1へA{0}の所有権の移動</span></span>
<span id="cb598-6"><a href="#cb598-6" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>x1<span class="op">.</span>GetA<span class="op">(),</span> x1<span class="op">.</span>GetA<span class="op">());</span>            <span class="co">// x0、x1がA{0}を共有所有</span></span>
<span id="cb598-7"><a href="#cb598-7" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">2</span><span class="op">,</span> x0<span class="op">.</span>UseCount<span class="op">());</span>                <span class="co">// A{0}の共有所有カウント数は2</span></span>
<span id="cb598-8"><a href="#cb598-8" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">2</span><span class="op">,</span> x1<span class="op">.</span>UseCount<span class="op">());</span></span>
<span id="cb598-9"><a href="#cb598-9" aria-hidden="true" tabindex="-1"></a>    ASSERT_FALSE<span class="op">(</span>a0<span class="op">);</span>                           <span class="co">// a0は何も所有していない</span></span></code></pre></div>
<p>
<img src="data:image/png;base64,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" />
</p>
<div class="sourceCode" id="cb599"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb599-1"><a href="#cb599-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/shared_ptr_ownership_ut.cpp 89</span></span>
<span id="cb599-2"><a href="#cb599-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb599-3"><a href="#cb599-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ステップ４</span></span>
<span id="cb599-4"><a href="#cb599-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// オブジェクトA{1}の所有がa1からx1へ移動する。</span></span>
<span id="cb599-5"><a href="#cb599-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// この時、x1::ptr_は下記のような手順で以前保持していたA{0}オブジェクトへの所有を放棄する。</span></span>
<span id="cb599-6"><a href="#cb599-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">//  1. x1::ptr_の共有所有カウント(ptr_.use_count()の戻り値)をデクリメント</span></span>
<span id="cb599-7"><a href="#cb599-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">//  2. 共有所有カウントが0ならば、ptr_で保持しているオブジェクト(この場合、A{0})をdelete</span></span>
<span id="cb599-8"><a href="#cb599-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">//  3. x1::ptr_の管理対象をに新規オブジェクト(この場合、A{1})に変更</span></span>
<span id="cb599-9"><a href="#cb599-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">//</span></span>
<span id="cb599-10"><a href="#cb599-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ここでは、x0::ptr_がA{0}を所有しているため、共有所有カウントは1であり、</span></span>
<span id="cb599-11"><a href="#cb599-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 従って、A{0}はdeleteされず、A::LastDestructedNum()の値は-1のまま。</span></span>
<span id="cb599-12"><a href="#cb599-12" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">1</span><span class="op">,</span> a1<span class="op">-&gt;</span>GetNum<span class="op">());</span>                 <span class="co">// a1はA{1}を所有</span></span>
<span id="cb599-13"><a href="#cb599-13" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">0</span><span class="op">,</span> x1<span class="op">.</span>GetA<span class="op">()-&gt;</span>GetNum<span class="op">());</span>          <span class="co">// x1はA{0}を所有</span></span>
<span id="cb599-14"><a href="#cb599-14" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">2</span><span class="op">,</span> x1<span class="op">.</span>UseCount<span class="op">());</span>                <span class="co">// A{0}の共有所有カウント数は２</span></span>
<span id="cb599-15"><a href="#cb599-15" aria-hidden="true" tabindex="-1"></a>    x1<span class="op">.</span>Move<span class="op">(</span><span class="bu">std::</span>move<span class="op">(</span>a1<span class="op">));</span>                     <span class="co">// x1はA{0}の代わりに、A{1}を所有</span></span>
<span id="cb599-16"><a href="#cb599-16" aria-hidden="true" tabindex="-1"></a>                                                <span class="co">// a1からx1へA{1}の所有権の移動</span></span>
<span id="cb599-17"><a href="#cb599-17" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(-</span><span class="dv">1</span><span class="op">,</span> A<span class="op">::</span>LastDestructedNum<span class="op">());</span>      <span class="co">// x0がA{0}を所有するため、A{0}は未解放</span></span>
<span id="cb599-18"><a href="#cb599-18" aria-hidden="true" tabindex="-1"></a>    ASSERT_FALSE<span class="op">(</span>a1<span class="op">);</span>                           <span class="co">// a1は何も所有していない</span></span>
<span id="cb599-19"><a href="#cb599-19" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">1</span><span class="op">,</span> x1<span class="op">.</span>GetA<span class="op">()-&gt;</span>GetNum<span class="op">());</span>          <span class="co">// x1はA{1}を所有</span></span>
<span id="cb599-20"><a href="#cb599-20" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">1</span><span class="op">,</span> x1<span class="op">.</span>UseCount<span class="op">());</span>                <span class="co">// A{0}の共有所有カウント数は1</span></span></code></pre></div>
<p>
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAf4AAAGkCAIAAABfGNDjAABCMklEQVR4Xu2dC3gU5dn+h1MCCacQDiGCICfBcpT6UT4UgtDi5wmLHCKfyKGioIgUUFtFwT9WKLUWCqJQgaJeIAofQiVQsYAaC6aAtKEqAkJIMMghXQgJCYTs/3EfeWfy7u5ksrO77Mx7/669uN7DM4d35n7ueWd22GheAAAAiqHJDQAAANwOrB8AAJRDt/5yAAAArgbWDwAAygHrBwAA5YD1AwCAcsD6AQBAOWD9AACgHLB+AABQDlg/AAAoB6wfAACUA9YPAADKAesHAADlgPUDAIBywPoBAEA5YP0AAKAcsH4AAFAOWD8AACgHrB8AAJQD1g8AAMoB6wcAAOWA9QMAgHLA+gEAQDlg/QAAoBywfgAAUA5YPwAAKAesHwAAlAPWDwAAygHrrzK5ubmlpaVyKwAAOAdYf9WYM2eOpmldu3YtKSmR+wAAwCG4wfqLiooW+5GVlcW95NFy3+LFe/furbiOABQXF6/yIyUl5a233mratOmHH37IYRMmTKCLwY9+9KOKSwMAQOziBus/ffp0r4rUrFlz7ty53Hvu3Lk+frz55psV11F+5swZLhQWFl64cIEKJ0+evN6PevXqjRgxonbt2tnZ2RSzZ8+eunXrwvoBAM7CDdYv8be//a1OnTq5ubnlvpn7v4KQl5dHATt37hw3bhxdPOLj48+ePUstaWlpCxculNYp+NnPfkYT/xdffJGrdBV5/vnnYf0AAGfhNuunqXrr1q1feOEFrmZlZWlB+MUvfkEB+fn5NIU/f/58t27dNmzYQC0dO3Zct26dcZ1GWrRoMWPGDC7TrUObNm3o6qLB+gEAjsJV1l9QUHDTTTf99Kc/LSsrk/t8dwDk0Xv27JHau3bt+te//nXq1KnTpk2j6X+NGjWOHj0qxTB0i0BrEE/5U1NTX3755a+//poa27dvf+TIkYrhAAAQo7jH+smCaepNU/4mTZp8/vnncnd5+caNG+vUqVNUVCS1k6GfOHHi1KlThYWFzz33XO/evaUApqSkhLq6dOkirisV7yK0Vq1aVVwCAABiFDdY/+XLl1999dV69eqNHz+eDHrmzJlJSUnS7H7r1q00SX/yySeNjUbOnj1LC9avX/8f//iH3Fdevn///r59+9ImjBeVd65Avt+yZctNmzYZlgAAgNjFDdZ/6623kvOuX79etMyaNatRo0Z0H8BVuiQkJCTMmDEj4IOg7777jqbzdevWHTx4MFm8sYvuBh577LGePXuSuaelpX3xxRfGXoGGZ/0AAEfhBuv/9NNPi4uLpcbVq1dfvHiRywcOHPjPf/5TsV+ntLSU7gkCBpw5c2bMmDEvvfSSdEkAAABH4wbrBwAAUCVg/QAAoBywfgAAUA5YPwAAKAesHwAAlAPWDwAAygHrBwAA5YD1AwCAcsD6AQBAOVxl/cnJydJPqgFgBVKOLCbLQHUgNOyozj6usn46mmIUAFiHlOPxeAoLC4uLi0tLSwP+1lMwoDoQGnZUZx99N0RJDnEOSEIQGqScnJyc/Pz8M2fOUCpSHsraCg5UB0LDjurso++GKMkhzgFJCEKDlJOdnX3w4MG8vDzKQ/9fAzQBqgOhYUd19tF3Q5TkEOeAJAShQcrJzMzct28f5SHNwmgKJmsrOFAdCA07qrOPvhuiJIc4ByQhCA1STkZGBuUhzcLoHtzj8cjaCg5UB0LDjurso++GKMkhzgFJCEKDlLN69eotW7ZkZWXRFIzuvmVtBQeqA6FhR3X20XdDlOQQ54AkBKFhJwmhOhAadlRnH303REkOcQ5RSMJp06ZpPuSOkOBV0TrljsgT3oE4HTtJGIVjGN6TBdXFCHZUZx99N0RJDnEONiVlJSXCq10rW4wQYRlIRPefsoLXr/lehJC7w4pmIwmjcAzDcrIEVrYYIcIykIjuv1NUZx99N0RJDnEOUZBUWLQrsLJFi1y4cEFuMiUsA7Gy/+Y79t1337300kv/8z//I3d4vT/72c94/QE3kZGRMXTo0M2bN1++fFnqCgHNRhJG4RiG5WQJrGzRIuYn15+wDMTK/pvvmAtUZx99N0RJDnEOlUrqX//616BBgxo0aFCjRo0mTZr0799/27Zt3CXOt0As9dvf/paCaanHfUi9XDWqRGqpdKOTJ0+eMmVKw4YNk5KSnn/+ebGevXv39uvXLyUlpWbNmvHx8R07dpw9e/alS5eMy06cOPH+++9PSEiYOXMmNRYXF//6179u06ZNrVq1aMFHHnnk3LlzYoXmA/GHAyZNmjRhwoT69evTsrQGqdeIsV3aMYmysrL333//5z//Oe1ntWrVqCAF5ObmVq9endbz4x//mP5t1qyZGDhD2UIDpK6WLVs+++yz33zzjbG3qmg2klAMPBiVCsCIWMr8ZHEVqtNUVZ199N0QJTnEOQgdBIN0TDGUDN26devQoQOd5j/84Q/c1atXL1ZP8+bNe/ng9jfeeIPbr7nmmtTU1MTERK6KdXLVJAlNNsqRtWvXpjWTxLn68ccfc+/69espuG3btiRE2jr3/upXvzIuGxcXR+lBa6b8pMaBAwdyY9euXevUqUPlm2++udx3misdiD8cQPl/jQ+u0nq4N9gR40ZpxwSHDh16+umnaQc0X/4888wz1GIMYF544QUKIFf66quvKEupvGHDBimG0nLjxo333HMPZ/KAAQNWrVplPt0LhmYjCTXTY+g1FUCwY1jpyeIqVKes6uyj74YoySHOQTOVFEHKoJiRI0dy9dSpU4cPHxa9rB7pLo+v/5Q8F3xQgcNEwPU+jBMTqcVko7yqVq1a0byJtMhVodoTJ05QMJeJwYMHaz7hGpdt2rQp3b1Sle5AaVpHLSTHPXv2UMs///lPjqG7VK+FgfjDATSbMy5y0003SQHSEeNG445xO6VTWloa7R5l9YgRI0jxJnfN7dq1o5XQvI/Kt9xyC5Up2eSgK5w8efL3v/99586dKYymscKnrKPZSELN9Bh6TQXgDXIMKz1ZUJ3iqrOPvhuiJIc4B81UUsTdd9/NEqHrP01VSO4FBQWil7skSdHkiBrpHparVOAwY4w5Jhvl9vHjx3t9YuXq9OnTuff48eNjxoyhrKNbb+7SfPM447Jjx47lKjFv3jwRZmTWrFnekAbCAQ8//DBXeRFajxQQMAmNO8bQdJK71qxZY5J+xCeffMKRO3fupOrSpUupTJMsSjY51AAZFjmd5jM1ua8yNBtJqJkeQ6+pALxBjmEIJ0vCZKPcDtVJOEt19tF3Q5TkEOegmUqKKCkpWbZs2QMPPED3ifxQj2YEopdPfNiT0GSj0halKt01cwtNfGhZusPlasBg75UkpCzlG2HBH//4R29IA+EAaRGLSSg1en2zJLrR5lv4a6+99tlnnzVOfo2MGzeOV9LAR926dbkqHlkY4Qe4Q4YMETfga9eulYMqQ7ORhJrpMfSaCsAb5HCFcLIkTDYqbVGqQnWOUJ199N0QJTnEOWimkiI++ugjceX/3//9X813VRe9PM0R0w2G71jpVrrEBxVYECKg0ltvk43yqoIlIYVRNT09ncoXL17s16+fcdNSMMG33sT27du55dKlS3/961/z8/O9FgbiDwdIixhvvQMeMV7KPwkZyplNmzaJnCE/euONN4qKikTA+fPnRdZJdO3a1bCm7+/ln3rqKfYmyurnnnvuyJEjxgDraDaSUDM9hl5TAXiDHMNKTxZUp7jq7KPvhijJIc5BM5WU13es6XrevXv3H/3oR/w1zo033ih6u3TpQi0kLGrsdeXroz//+c+sgBYtWtDcIT4+nqtiKa4aNSe1aME36h9prHLa0JSNxNe0aVPxJ0ECBjP8hRttpVOnTt26deNv1T7//HOvhYH4wwEJCQnGL9xoPSIg4BHjsGBJKKDp2EsvvXTDDTdQcMeOHUW72M/du3eLxrfeeosb+YEysXnzZs33td6wYcPMH+BaQbORhJrpMfSaCsAb5BhWerK4CtUpqzr76LshSnKIc9BMJUXQTIGlScomWY8YMcJ4xaaJEqlKPOIU7XPmzGncuHG9evUeeuihSZMmSb1cNUlCk41KkVKV5hd9+/YlnaWkpMycOXPq1KkcEDCYKS4uptvbtm3b0uyGttizZ89f//rXHo+He80H4g8HTJ48+bHHHqtfvz4t++KLLxoDAh6xgDtmws6dO+k2XFR5mik9OaUh8PeWtNvcsmvXLroTP336tDEsZDQbSWh+DL2mAvAGOYbeyk6W/0GWWkw2KkVKVahOEMuqs4++G6IkhzgHc0mBqlLVdHIudpIQqgsvUF100HdDlOQQ54AkDI2K38/9gBdJaA2oLjRkwfnwQnXRQt8NUZJDnAOSMDQ42SREO5LQHD5WoKoYxSYQ7VBdpNF3Q5TkEOfA0gGgqthJQqgOhIYd1dlH3w1RkkOcA5IQhIadJITqKmXcuHHdu3fn10ZxuAR2VGcffTdESQ5xDlBVpXz88cdpaWmJiYkJCQlUyMzMlCOUxE4SQnWVQoeocePG0v8OA3ZUZx99N0RJDnEOUJU5pDCeed17771Dhw7VfG8oi3eWVcZOEkJ15j/2SRw9etQbpl9sdhN2VGcffTdESQ5xDlAV8emnn/bs2bNBgwbVq1evX78+5eRHH33EXfxTXCNGjODq8OHDqer/07UKYicJoTrzH/sUwPol7KjOPvpuiJIc4hygKuL//u//yO7Hjx8/adKkPn36aL7/GMk/QUU33VTlH1chFixYQNUmTZpUWF5J7CQhVGf+Y58CWL+EHdXZR98NUZJDnANUxXz44Yd0xz116tRHH32Uk23dunXUXqNGDSovX76cw5YtW6b5/kN8hYWVxE4SQnXmP/YpgPVL2FGdffTdECU5xDlAVcTEiRNF+gn4J1D491hoss+RmPULNBtJqCmvOvMf+xTA+iXsqM4++m6IkhziHKAqgv9M0i9/+cuSkpJvv/2Wk23FihXeK7/hPnz4cI7kZ/0mf4xCHewkIVRn/mOfAli/hB3V2UffDVGSQ5wDVOW98peG2rZtO2HChE6dOnGysfXv2rWLb8nFGz6UtCQ7eRXqYScJoTrzH/sk2vpo2LAht3PVsAJFsaM6++i7IUpyiHNAEnp9/k4ZSBZP14ANGzZwsrH1Ezt27Ojbt29CQgLdHFBBvPyjOHaSEKoz/7FPr+/w+mNYgaJoNlRnH303REkOcQ7QEwgNO0kI1YHQsKM6++i7IUpyiHNAEoLQsJOEUB0IDTuqs4++G6IkhzgHJCEIDTtJCNWB0LCjOvvouyFKcohzQBKC0LCThFAdCA07qrOPvhuiJIc4ByQhCA07SQjVgdCwozr76LshSnKIc0ASgtCwk4RQHQgNO6qzj74boiSHOAckIQgNO0kI1YHQsKM6++i7IUpyiHNAEoLQsJOEUB0IDTuqs4++G6IkhzgHJCEIDTtJCNWB0LCjOvvouyFKcohzEP+DHIAqkZiYGHISQnUgNOyozj6usn7C4/Hk5ORkZ2dnZmZmZGSsVhjNN6cAFiG1kGZIOaQfUpEsLFOgOgFUVyXsqM4mbrP+wsLC/Px8uoTu27ePjukWhaEklJtAcEgtpBlSDumHVCQLyxSoTgDVVQk7qrOJ26y/uLiY7pvy8vLoaNK1NEthKAnlJhAcUgtphpRD+iEVycIyBaoTQHVVwo7qbOI26y8tLaWLJx1HuorSPdRBhaEklJtAcEgtpBlSDumHVCQLyxSoTgDVVQk7qrOJ26y/rKyMjiBdP+lQejyeMwpDSSg3geCQWkgzpBzSD6lIFpYpUJ0AqqsSdlRnE7dZPxBQEspNAEQYqM4pwPpdC5IQRB+ozinA+l0LkhBEH6jOKcD6XQuSEEQfqM4pwPpdC5IQRB+ozinA+l0LkhBEH6jOKcD6XQuSEEQfqM4pwPpdC5IQRB+ozinA+l0LkhBEH6jOKcD6XQuSEEQfqM4pwPpdC5IQRB+ozinA+l0LkhBEH6jOKcD6XQuSEEQfqM4pwPpdC5IQRB+ozinA+l0LkhBEH6jOKcD63UPXrl21IFCXHA1AOIDqHAqs3z3MnTtXTr4rUJccDUA4gOocCqzfPeTk5FSvXl3OP02jRuqSowEIB1CdQ4H1u4q0tDQ5BTWNGuU4AMIHVOdEYP2uYunSpXIKaho1ynEAhA+ozonA+l1FQUFBfHy8MQOpSo1yHADhA6pzIrB+tzFkyBBjElJVjgAg3EB1jgPW7zbWrl1rTEKqyhEAhBuoznHA+t3GhQsXkpKSOAOpQFU5AoBwA9U5Dli/C3nwwQc5Cakg9wEQGaA6ZwHrdyHbtm3jJKSC3AdAZIDqnAWs34Vcvny5pQ8qyH0ARAaozlnA+t3JUz7kVgAiCVTnIGD97uSfPuRWACIJVOcgYP0gKPzodsCAAQGrlfLnP/95pg+5A4DgQHXRAdYPgmIzCSmSF5E7AAgOVBcdYP0gKNFJwsLCQrkJKAxUFx1g/S5HZM7KlSvbtGkTHx9/++23nz59WurlqpQ2Um+w6ltvvdWuXTtac//+/b/++mtjr4S04JIlS1q1alWtWjVuB65BnGKoLmaB9bscVnz9+vX1VNC0hx56yNhrJwmTkpIoi7hMXHfddTyfEi1GjAs2bNhQageugU8rVBfLwPpdjhD622+/nZuby9JPTU019tpJQoLmX0VFRRMnTuTq4sWLA65NIBacMWPG+fPnv/zySykAOB1xiqG6mAXW73JY7u3bt+dqnz59NN9fUDL22knCjh07cpUynFtGjhzJLeZJmJKSUlZWJnUBd8CnGKqLZWD9LocVf+utt3LVPM0ozKQ3YLV///5cvXTpErfcdttt3GKehP369ZPagWvgUwzVxTKwfpfDig82w+K/qtq3b1+udurUydgrLRuwajL/GjhwILdwVSCtB7gP6RRDdTEIrN/lSIqXkrB58+ZUbtKkicfj2b59O3eJXmnZgFVi1apVRUVFjzzyCFdfffVVDrj77ru5Ze/evdxiXBBJ6GKkUwzVxSCwfpcjKV5KwvHjx3O1bt26NWrUqFOnjrFXWjZglRKYJ3GMeNeCmDNnjmhnAq4HuA/pFEN1MQis3+VIipeS8PTp03fccUd8fHyrVq2WLFki9UrLBqu+8847HTp0oJWkpaUdOHCAe4ni4mJK8saNG4v38AKuB7gP6RRDdTEIrB+ECHIJRB+oLlzA+kGIIAlB9IHqwgWsH4QIkhBEH6guXMD6AQBAOWD9AACgHLB+AABQDlg/AAAoB6wfAACUA9YPAADKAesHAADlgPUDAIBywPoBAEA5YP0AgLAxc+ZMuQnEJLB+AEDY0K78UiaIcWD9AICwAet3CrB+AEDYgPU7BVg/ACBswPqdAqwfABA28DWvU4D1AwCAcsD6AQBAOWD9AACgHLB+AABQDlg/ACBs4GtepwDrBwCEDbzc6RRg/QCAsAHrdwqwfgBA2ID1OwVYPwAgbMD6nQKsHwAQNvA1r1OA9QMAgHLA+gEAQDlg/QCAmGbatGk9evSoXr265kPu9oPDiB//+MfG9p49e4ouY3vkKCoqatOmDW1u2bJlcl8QzAc7cuRIahw1apTUHgKwfgBATCP8OqAb+mMM3r9/PzdmZ2cb2ysuESlmz55N22revHlJSYncFwTjTvrv5549e6ixWrVqn332mdRVVWD9AICwEYmveSdNmrR27drevXsHdEN/jNb55JNPcuMTTzxhbK+4REQoLCxMSkqibU2dOlXuC06lg+3SpQu133XXXXJHFYH1AwDCRkC3MuH9999nj3vxxRepWlZW9pOf/ISq11xzTUFBgTFywIABwdxQgsNatGhB/6ampl7yQVNv0WhcSU5OztixYymsVq1aFDN69OgjR45w18SJEymyTp06ZOLcsmPHDl789ddf91+8ZcuWkydP9ng83LVs2TIO/uSTT7iFOHjw4J133kmRFB8fH9+5c+f58+dfvnxZBDAmg6WLK7VXr149NzdX7qsKsH4AQNgI6FbmkHWywx4+fHjBggVseZs2bZLCTNxQgsMo/qabbqJCRkYGrY0K//Vf/yWthIy7WbNm3CJo2rQpuz9ZNre8/fbbHP/YY49RtXbt2uzvARfv0aNHcXEx9Q4ZMoSqZPEXLlz4Yc/Ky7dt2ybFE+T+IoAxGezmzZu567XXXpP7qgKsHwAQNgK6lTn/+c9/eDLep0+fevXqUeHBBx+Ug0zdUILDKH7hwoVUSE9PHzFiBBUWLVokrWTMmDFcXbJkCRk0/ctVmvtzwHXXXUfVYcOGUZnm5nQvIqpicWrcs2cPLb527Vpe/JVXXqHeVq1aUbljx44czBw7dmz79u00ZLoROXToUOvWrSmG5v7GmHLTwdJkn7vGjx8v91UFWD8AIGwEdKtK2bJlC9sZQY559uxZOcLUDSU4jOJPnz4dFxdX20d8fDxVpZWkpKRQuX379mJZKmu+L2a5+swzz1A1MTGxqKjo008/5WXfe+897uWHSP4MHz6cemm+r/muZ2LlBA1t8uTJ1157bc2aNUU87Zsxptx0sHRLwV2333673FcVYP0AgLAR2te8NKGm2TE72tNPPy13+zBxQwkOo3gq33vvvVwdOnRoud9K2H/T0tLEsv369aMWaufqF198wfHvvvvu1KlTqZCcnFxaWmpc3J+BAweWB7F+fjvTH2NMud9+GqGLEHfB+gEAzoafzDAJCQkHDx6UI0zdUILD2Po3bNjA1Y0bN5b7rYRn/R06dBDL8qyf2kXLjTfeqPmeGvHDmYkTJ4ouXpyN3gh/bRvwgQ8/0WrRokVOTg5Vg73JYzLYY8eOcRce+AAAHMyhQ4cSExPJy+677z5+mH7LLbeUlZWJgJM++vbty5bHVUIEcDt7vVS9ePHicB9UKPez1NGjR3P1T3/6U0lJCf3L1QceeOCHVZeX//73v9d89wHclZmZKbr4WX+1atWWLFlCk3GPx/PBBx/QRWLNmjXlhq95jS/104WNGukqQvu/efPmGjVq8GpFQKWDzcjI4C58zQsAcCo0QWaba968eUFBgZikk+GKGG7xRwoIaP0SkvUfOXKkSZMm3CJo3LjxN998IxY5fvy4MOg2bdqIduLo0aP+b/gQq1atot7ly5dz9e9//7tYZPDgwSKMrgr+L5uKXgkRgJc7AQCOZ/78+Wxta9eu5RaaNWu+dz2/+uorbjE6oBGxEq6GYP3lPvenuX9KSgrN6+nfUaNGGX2f+elPf8pLPfvss1LXsWPHxo8f37JlS1q8Xr16vXr1Ims+ceJEue+/dDVq1IiWmj59uoj/9ttvBw0aFBcXR1eRd999139/uOqPCOjcubOG/9IFAIgpQvua163wDzmkpqaKb4Ztsnv3br4S7Nq1S+6rIrB+AEDYMM5PQVFREf/PgOXLl8t9IXHfffdp+Pk2AECsAet3CrB+AEDYgPU7BVg/ACBswPqdAqwfABA28DWvU4D1AwCAcsD6AQBAOWD9AACgHK6y/uTkZP7/Dq6BRiQPEsQYUB1wIq6yflKtGIU7oBF5PJ7CwsLi4uLS0lLjb1qBGAGqM4KveZ2CfrpFSQ5xDq5MwpycnPz8/DNnzlAqhuu/g4MwAtUZ0fByp0PQT7coySHOwZVJmJ2dffDgwby8PMpD/pufIKaA6ozA+p2CfrpFSQ5xDq5MwszMzH379lEe0iyMpmDymMHVBqozAut3CvrpFiU5xDm4MgkzMjIoD2kWRvfgHo9HHjO42kB1RmD9TkE/3aIkhzgHVybh6tWrt2zZkpWVRVMwuvuWxwyuNlCdEXzN6xT00y1KcohzQBKC6APVASein25RkkOcA5IQRB+oDjgR/XSLkhziHKKZhN988016enpycnJcXFynTp3mz59fbjia4QJJGPtEU3XEuHHjunfvXqtWLc2H3B0OoDoV0E+3KMkhziFCmeBPfn5+SkoKba5hw4adO3euVq2a5vsLnHKcbZCEsU/UVMdovr8b3rx5c1g/sIN+ukVJDnEOYcyEDRs2cGpt3bqVqjt27GB/f+edd6g6efJkzff/3U+dOkXVefPmUbV69epHjx6V1mMTJGHsE0bVeSsTHsEamzZtGocZlw0XdlSHr3mdgn66RUkOcQ7hzYSHH36YVti6dWua4/Mf2BwzZgx3tW/fnqojRozg6rFjxzgPly5dqi8fDuwkIYgO4VWd11R4gpi1fg0vdzoE/XSLkhziHMKbCUVFRddffz2ts1mzZvRv27ZtCwsLuSs+Pp5apkyZwtVLly5xHj7zzDP68uHAThKC6BBe1XlNhSeA9QOb6KdblOQQ5xD2TNi9e3eNGjU038OcXbt2iXa2/scff5yrFy9e5DyE9StI2FXnDS48Aawf2EQ/3aIkhziHsGfCe++9xwnGySDa+YHP8OHDuYoHPioTdtV5gwtPAOsHNtFPtyjJIc4hvJmQn5/fuHFjWmePHj0038s8ZPHcJX3N+7vf/U7D17yqEl7VeU2FJ4hZ68fXvE5BP92iJIc4hzBmAq1t0KBBtMKbbrqppKSkV69eVO7fv//ly5ep99tvv23atCm1JCUldenShd/BmDp1qrwW29hJQhAdwqg6b2XCI9r6oOsBWz9XK67DLlCdCuinW5TkEOcQxiRcsGABrS0+Pv6LL76g6oEDBxISEqhl3rx5HHDo0KHhw4c3atQoLi6uY8eOL7/8cjn+S5eShFF1XgvCY8eXqLAK22hQnQLop1uU5BDnEPYcuOogCWMfqA44Ef10i5Ic4hyQhCD6QHXAieinW5TkEOeAJATRB6ozgq95nYJ+ukVJDnEOSEIQfaA6Ixpe7nQI+ukWJTnEOSAJQfSB6ozA+p2CfrpFSQ5xDkhCEH2gOiOwfqegn25RkkOcA5IQRB+ozgis3ynop1uU5BDngCQE0QeqM4KveZ2CfrpFSQ5xDkhCEH2gOuBE9NMtSnKIc0hOTtbcRWJiIpIwxoHqgBNxlfUTHo8nJycnOzs7MzMzIyNjdZjQfPOgqwKNgsZCI6Jx0ejkAYMYAKoDjsNt1l9YWJifn09TlX379pF2t4QJSkK5KVrQKGgsNCIaF41OHjCIAaA64DjcZv3FxcV0f5qXl0eqpTlLVpigJJSbogWNgsZCI6Jx0ejkAYMYAKoT4Gtep+A26y8tLaVJCumVZit0r3owTFASyk3RgkZBY6ER0bhodPKAQQwA1Qk0vNzpENxm/WVlZaRUmqeQZD0ez5kwQYKWm6IFjYLGQiOicdHo5AGDGACqE8D6nYLbrD9CQNAg+jhRdU7cZzWB9VsCggbRx4mqc+I+qwms3xIQNIg+TlQdvuZ1CrB+SzgxCYHTgepA5ID1WwJJCKIPVAciB6zfEkhCEH2gOhA5YP2WQBKC6APVgcgB67cEkhBEHyeqDl/zOgVYvyWcmITA6ThRdU7cZzWB9VsCggbRx4mqc+I+qwms3xIQNIg+TlSdE/dZTWD9loCgQfRxouqcuM9qAuu3BAQNoo8TVYeveZ0CrN8STkxC4HSgOhA5YP2WQBKC6APVgcgB6w9M165dtSBQlxwNQDhwouqcuM+gHNYfjLlz58pCvgJ1ydEAhAMnqs6J+wzKYf3ByMnJqV69uqxlTaNG6pKjAQgHTlSdE/cZlMP6TUhLS5PlrGnUKMcBED6cqDon7jOA9Qdl6dKlspw1jRrlOADChxNV58R9BrD+oBQUFMTHxxvVTFVqlOMACB9OVJ0T9xnA+s0YMmSIUdBUlSMACDdOVJ0T91lxYP1mrF271ihoqsoRAIQbJ6rOifusOLB+My5cuJCUlMRqpgJV5QgAwo0TVefEfVYcWH8lPPjggyxoKsh9AEQGJ6rOifusMrD+Sti2bRsLmgpyHwCRwYmqc+I+qwysvxIuX77c0gcV5D4AIoMTVefEfVYZWH/lPOVDbgUgkjhRdU7cZ2WB9VfOP33IrQBEEieqzon7rCywfgAAUA5YPwAAKAesHwAAlAPWDwAAygHrBwAA5YD1AwCAcsD6AQBAOWD9loiLq8//Sd01JCcny4MEMUZiw0T5tDkcqC52gPVbglQ7bNhWN31oRB6Pp7CwsLi4uLS0tKysTB4zuNrQOVpyeImbPlBd7ADrt4QrrT8nJyc/P//MmTOUipSH8pjB1caV1g/VxQiwfku40vqzs7MPHjyYl5dHeUizMHnM4GrjSuuH6mIEWL8lXGn9mZmZ+/btozykWRhNweQxg6uNK60fqosRYP2WcKX1Z2RkUB7SLIzuwT0ejzxmcLVxpfVDdTECrN8SrrT+1atXb9myJSsri6ZgdPctjxlcbVxp/VBdjADrtwSsH0QfWD+IHLB+S8D6QfSB9YPIAeu3ROSs/8UXP8/NPV9W9v2ZmDVrt3+A/+fkyQt04s6du/j++znDh8u9Fj9Iwtgnctb/2LLHmrdrXr1GddrEtFXT/AOkT/I1ydWqVaubVHfA2AGvHXrNP8DiB6qLHWD9lgjZ+rdtO85H9bPPvvPvpU9BQQn1nj59YcuW3Mce+1S0P/fcP/bvLygpKaMPFWbM+IfoWrPmMLXwamfP3uO/TisfJGHsE7L1//fQ/9Z89PhZD/9e+jRo2oB6k5onpd2fNnvbbG688bYbGzZryAuOnjfaGH/XlLuu/8n13DVl5RT/FVr8QHWxgzB8WL8ZWkjW/8AD28i4+ajSvP7BBz/yj+HeP/3pS2Pjr371Gd8H7Nr13c6d31Hh0qXLTz65SwTcf/82XnDRov3+67TyQRLGPlpI1r/gXwviE+LZpmvUrPG7z37nH8O9I//fSGMj+X73n3bnLsn66bNw/0LuGvO7Mf4rtPjRoLqYgQ3EC+s3RwvJ+pcs+YKO57lzF0+eLKbCW299LQUMH/4hH3PJwbOyTlLjp5+e4Orf/37C63ffwAsuXvxvaZ0WP0jC2EcLyfrv/839tGDdpLrJLZKpMOSpIVLAawdfMzFx7vK3fr3rtwG6LH6gutiBDcQL6zdHC8n6Dx06S8fzgw9y33vvCBW+/bbI2Eu+//LL/+JjPnfuPmMXXS2ocfnyr7hKBaqePVtqjCks/D7m44+/HTnyb8Z2ix8kYeyjhWT9rbu2pgX7juw76OFBVGh2XTNjL/n++D+OZxN/dOmj/ov/4O+BrJ9/Tq7XPb0WfbHIv9fKB6qLHa74PazflBCsf9q0nXw8Z87c/cQTu7j83HP6F7nigG/bdjw9/UPjspcvf39ixIyeCl7fIyNjzLx5+4qKLvEajO0WP0jC2CcE638u4zn27mmrps34ywwuT189XQRwC9FnWJ/FBxb7r4F7A1r/xNcm1qlXhwP8e618NKguZhD+A+s3Q6u69WdkHKODWVBQQrN7qublnafqRx99KwI2bz7GjcXFlx55JNO4rJVZ/+7d3z8UIvffujXP2G7xgySMfUJw2P4P9KelGjZrSLN7qqa0TaHqT37+E2NA83bNqbF23dovfvSi/xpMrL/rgK7URe5/S/ot/r1WPlBd7CAMH9ZvRlWtf+TIv/EDGYnS0sujR28XYRMnfsLtCxZkGxf/xz++t/W//73Cs/6srJPGGP4e+K23DhobrX+QhLFPVa3/lS9fCfgT/7Vq15q/b74Im/PJHG7/xR9+4b8S7gpo/TVq1qCuIU/KXx5Y/2hQXcwgTAnWb4ZWResnK+eDuWfPKbJs+pCb89F+/fUKL/Nw2CuvVPi29umns6Q3fKj6q199VumC1j9IwthHq6L1k5WzcXfp36XbwG78qVatGrXc9/x9xsiA/t57SG/6cFfbnm25WulSVfpoUF3MwAbihfWbo1XR+vm9e/rX2Mjv7XzzzTljI5+CZct+eLYjPjNn7v7ii+/f66cbBSoYvyQY5nttlE8WXu50MVoVrZ9fve/Qq4Oxkd/XbHlDS2MjXw/SZ6YbG9nZJUTvgn8t4JaxL401LlWljwbVxQzC8GH9ZmhVtH7rnxMnvn/vs6CgRPovXSafNWsO08WAT9azz+r/1atKHyRh7GN03vB+GrdsrPm+EjD+ly6Tz11T7mr/X+3Z+p9Y84R/gMUPVBc7CMOH9ZsROet//vk9x44VhvBDDmfPlr733hH/XosfJGHsEznr/+Vbv0ztkFrVH3Ko16jeoIcH+fda/0B1sQOs3xKRs/6r9UESxj6Rs/6r9YHqYgdYvyVg/SD6wPpB5ID1WwLWD6IPrB9EDli/JWD9IPrA+kHkgPVbAtYPog+sH0QOWL8lYP0g+sD6QeSA9VsC1g+iD6wfRA5YvyVg/SD6wPpB5ID1WwLWD6IPrB9EDli/JWD9IPrA+kHkgPVbAtYPog+sH0QOWL8lYP0g+sD6QeSA9VsC1g+iD6wfRA5YvyVg/SD6wPpB5ID1WwLWD6IPrB9EDli/JWD9IPrA+kHkgPVbAtYPog+sH0QOWL8lYP0g+sD6QeSA9VsC1g+iD6wfRA5YvyVg/SD6wPpB5ID1WwLWD6IPrB9EDli/JZKTkzV3kZiYiCSMcaA6EDlg/VbxeDw5OTnZ2dmZmZkZGRmrnQ+NgsZCI6Jx0ejkAYMYAKoDEQLWb5XCwsL8/Hyaquzbt4+0u8X50ChoLDQiGheNTh4wiAGgOhAhYP1WKS4upvvTvLw8Ui3NWbKcD42CxkIjonHR6OQBgxgAqgMRAtZvldLSUpqkkF5ptkL3qgedD42CxkIjonHR6OQBgxgAqgMRAtZvlbKyMlIqzVNIsh6P54zzoVHQWGhENC4anTxgEANAdSBCwPoBAEA5YP0AAKAcsH4AAFAOWD8AACgHrB8AAJQD1g8AAMoB6wcAAOWA9QMAgHK4yvpnzpxp/JlAqqIXvehFr3mvmrjK+gEAAFgB1g8AAMoB6wcAAOWA9QMAgHLA+gEAQDlg/QAAoBywfgAAUA5YPwAAKAesHwAAlAPWDwAAygHrBwAA5YD1AwCAcsD6AQBAOWD9P5CcnGz8bT8AHAopWUFVG0cNrADr/wFSjzgCADgXUrLH4yksLCwuLlZH1cZRl5aWlpWVyRkOKqIfOlGSQ9RAnSQB7oaUnJOTk5+ff+bMGXVUbRw1XQDI/eUMBxXRD50oySFqoE6SAHdDSs7Ozj548GBeXp46qjaOmtyf5v5yhoOK6IdOlOQQNVAnSYC7ISVnZmbu27ePfFAdVRtHTXN/mvjLGQ4qoh86UZJD1ECdJAHuhpSckZFBPkizYHVUbRx1Tk6Ox+ORMxxURD90oiSHqIE6SQLcDSl59erVW7ZsycrKUkfVxlHTxP/MmTNyhoOK6IdOlOQQNTBPkoKCglq1amk+0tPT5W4L8LIDBgyQO2yzcuXKmT7kDh+5ublTp0694YYbEhIS4uLi2rdv//DDD3/11VdyXLgx36uwE67NSaeJq8SiRYuCxYSX4uLiNm3a0PqXL1/OLSNHjqTqqFGjKgYGRXOj9U+bNq1Hjx7Vq1fngy93w/qrjn7oREkOUYOAehIsW7aMNUfUrVuX8lOOqAxeNhJ+QevklcsdXu+HH37YoEEDsecC+xZZKSZ7FQnCtTleib/1kx2XlZUFjAkvL7zwAq28efPmpaWl3LJ3715qqVatGplaxdjAaG60fnEiGLkb1l919EMnSnKIGgTUk2DQoEFG5a1du1aOqAxeMBJ+Ecz1jh07xr5fu3bthQsXnjp1qqSkhHzk8ccf/81vfiMFh51geyVx/vx5uSkkLG6uUngl/tav+ZwlYEwYoaORlJREK6cbNWN7ly5dqPGuu+4yNgaDd9Vl1j9p0qR169b17t2bD77cDeuvOvqhEyU5RA0C6ok5ffp0zZo1KWDo0KFko1QYNmyYFONvB1KLf4CRQ4cO3XnnnS1btqxVq1Z8fHznzp0XLFhQfuX05OfnjxkzhmaCtBsJCQmdOnWi23+Px+P1mw0xvNSUKVO4umLFiivb+YFLly5xgS4PY8eOTU1Npe3S+kePHn306FERxovTPr/xxhs07aUdu/322ympuDe0veIyrXPp0qWtWrWiyazUzlV/K6ftTp8+vUOHDrQbtLkbb7zxL3/5i3FZCbGgcYx0hCdPnnz27FnRu2nTpo4dO9Jpvfnmm//973/zstJZq1GjBv1LWzQ2Bjuz0p6L3pUrV7Zu3ToxMTE9PZ12YOPGjTfccAONpVevXtnZ2Ry8fPlyjs/MzOQWZtasWdRYvXr1vLw8Y3tANDdaP+OvCoFx1LB+K+iHTpTkEDUIqCeGTIoFR5N98j4qkPUUFRUZYzggZOvfvn07Bxgh9+fetLQ0uU/Tjhw54jV1PXI0zfcf3MWTCgnyxGbNmknLNm3aVLg/t9SvX98Y8NBDD3FvaHvF5YYNGwZsD2agJ06cuO6668QijHhsJbUz3BVwjD169Lhw4QL17t69W3yFQ6SkpHBBOmt0VaArHBU++OAD0RjszAa0fprL00WOywTNXvlywtA1gIOHDBlCVdoluj/jFoYcjSOXLFlibA+IBuuH9VtAP3SiJIeoQUA9MQMHDqRemqAVFha++uqrLL41a9YYY7gxZOvPzc3dsWMHTZnJpg8fPkzTQwqmuT/3sj21b9/+5MmTpaWl+/fvnzdvHpW5N1g+1KlThxr79OkjtQtozs4L0rWNvEZc4WjuzwFc1XyDpfkm+zVNn7k3tL0S65wxYwZdPsUXztwYzEDpesPV8ePH02WAjJsulu+//z73+scLeIzXXHPN3r17aYzr1q3jsMWLF3uvWK3mcw3amYkTJ3LV/6zNnTuXCqQEY6MUw9WA1k+8++67x48f5+c5BN18kJxuvfVWrvJxoNsgKtM1m5cV8H/O0nzDl7r80WD9sH4L6IdOlOQQNQioJ4K8jCdot912m9eQhOQacqgpvFQw6z937hx5wbXXXstPlhi62HBvu3btNN8j+0cfffT111+nuerly5fFssHyoVLr50kuebdoobLm+46Rq7xaEUCr0nyPHbga2l5xI23aGCzagxkoT7rpqhPsDibY5nhBf4YPH069TZo00QxWK06uv63TVZnvfvbs2RMshqsBrb9Dhw5c5WNI0MWeqrNnz+YqXcm8V66m/qeMLnUcRjedUpc/Gqwf1m8B/dCJkhyiBgH1RIhp/lNPPZXtgy2PjJVmbXJ0cHglwayfX+Dzh3vJF6THHWTHBw4c4N5g+VDpAx++zKSlpYmWfv36UQu1c5VXSzNTrkobCm2vuJE2FLBdHB8xHeYq76r/UoJgmzNeSo3w/J0v6v379+dgOlDcG9DWn3jiCSqPGDHCJMbrt+dc9j+G5b7cmzNnDle3bt3qDW79/ENsGqw/yFn2wvqrjn7oREkOUYOAeiLIF1ht/qxatUqODg4vEsz669WrR70tWrQ4duwYVQO+yfDll1+uX79efHk7ZswYbufnUVKw1/A178qVK6Uu/pqXZ/1iQuq9Muundq7y4sHms0xV90pap4Bf2e7bty9XO3XqZFyc5vua77lNsMtYsM3xGNnojZT7pM+zftoWN5rM+ql8/PjxuLg48YxexJjvuRQsHUPJ+oM98KFbBA7DAx/j0TNiHDWs3wr6oRMlOUQNAurpxIkTxq/jJAYPHiwiucXoaFILV7t37765ItybkJBAva1btz516hTJV2yUe6dOnfrJJ594PB6ybPGF8B133MG9d999N7d8/vnn3MKQX/DLnXSD8sorr5w+fbqkpIRiJk+ezC93jh49mhd8/fXXS0tL6V+uPvDAA7wGrgazrdD2SlqngJ/MkBefPXt2x44dHKZd2ZZ41j9hwoTvvvuOBvLxxx8bn/UH2xw/669WrdrSpUtp7kwrJ5NNT09/5513qPfee+/lpd5++23qNXnWz9Vx48Zxi7HRfM+lYHPrF1/zipf6GdIJhyn7Ne8pH3R95ePAVUIEGEcN67eCfuhESQ5Rg4BJsmjRIpba/Pnzje3dunXTfI+5z507xy0cVqn1+8O9dBURLZT5NP039oouIwsXLuRe/gbSCLd7ff+lS3o/h+F3Y44ePcrTXiONGzfmt3S8fkOQbEtfxkCle8Vlf+un+Sx31a1bl658/EWFWMr8DR9v8M3l5OT4v+Gj+WzC6/eGT6NGjbgQzPrpFke8qCMazfdcCja3/hUrVnB1586dHMDQSDW1X+7kw+KPMQDWXyX0QydKcogaGGUk4FkG5XN+fr6xXWTsm2++yS1cDdn6af2DBg2Ki4tr06bN2rVrJYOYPn16r169kpKSKPnp/qBnz540i+cur+87QHIfsmzhSqLLe+WHHDp16kSWROtv164dzaDFezXk/jT3T0lJqVmzJv07atQo4ftevyGEZa+kdQooV+mOIT4+vlWrVjRDl7bFAfxeP42CLrpdu3bduHGj6A22Oa/vCFBXy5YtaYz16tWjfZ41axbdOnAv3Tp07NiRttu7d2+6Y5B2z39v77nnHqnRfM+lYHPrP3/+PF9+aKQcwHTu3FlT+7908VHyxxgA668S+qETJTlEDYwyAuBqwT/kkJqaevHiRW4R7xR99tlnFWMDYzRBdVQN668q+qETJTlEDdRJEhDLFBcX86Mt8X+w77vvPk35n2+rFFh/VdEPnSjJIWqgTpIAdwPrh/VbQT90oiSHqIE6SQLcDawf1m8F/dCJkhyiBuokCXA3sH5YvxX0QydKcogaqJMkwN3A+mH9VtAPnSjJIWqgTpIAdwPrh/VbQT90oiSHqEFycrIGgPNJTEwUJmj8cWx3Yxw1rN8KsH4dj8eTk5OTnZ2dmZmZkZGxGgBnQuolDZOSc66ggqqNo6ZcltMbVATWr1NYWJifn09Thn379pGGtgDgTEi9pGFScv4VVFC1cdSUy3J6g4rA+nWKi4vpPjEvL4/UQ3OHLACcCamXNExKPnMFFVRtHDXlspzeoCKw/h/As37gDho2bJiTk0MzX3JAdVRtHDVN+UtLS+UMBxWB9f+Apsy7EMDdkJKFCaqjauOoYf1W0A+dKMkhaqBOkgB3A+uH9VtBP3SiJIeogTpJAtwNKVk89VZH1cZR41m/FfRDJ0pyiBqokyTA3ZCSxbsu6qjaOGq84WMF/dCJkhyiBuZJUlBQIP6cU3p6utxtAV7W/0+U2GflypUzfUjtvEXN96dmGjRo0Llz50ceeUT8kRb7BNtuhAjX5qQTIY7SokWLgsWEF5qQtmnThta/fPlybhk5cqRWlZ9lNodWJd5w10xV7SCmTZvWo0cP/jPIAQdlHDXe67eCfuhESQ5Rg4B6Eixbtow1p/n+Dh9lrxxRGbxsJNzE/w9aMWKHjdSuXXv9+vVSZGgE226ECNfmeCX+1k92LP7muxQTXviPsTRv3lz8Ad69e/dqvj8gnJWVVTE2FDQ3/pCDOE2M3F1x1PjfvFbQD50oySFqEFBPgkGDBhmVt3btWjmiMnjBSLhJME80bvHkyZNLliyhi5bm+y/v33zzjRQcAsG2K3H+/Hm5KSQsbq5SjIdFVJnVvj/Y6x8TRuhoJCUl0cqnTp1qbO/SpYtm+U8wmsMDcZn1T5o0ad26db179+ZTI3fD+quOfuhESQ5Rg4B6Yk6fPl2zZk0KGDp0KM2aqTBs2DApxt8spBb/ACOHDh268847W7ZsWatWrfj4+M6dOy9YsKD8yunJz88fM2YMzRNpNxISEjp16jRq1Ci6pfX6zYYYXorLxi2+++673Dh58mTReOzYsbFjx6amptKmaQeo6+zZs9xlc7tLly5t1aoVTWaldq76W/mZK399l44Abe7GG2/8y1/+YlxWQixoMgRi06ZNHTt2pBN38803//vf/+ZlpfNSo0YN+pe2aGwMdu6kPRe9K1eubN26NV1Z09PTaQc2btx4ww030Fh69eqVnZ3NwcuXL+f4zMxMbmFmzZqlWf7D6+ZobrR+xl8zAuOoYf1W0A+dKMkhahBQTwxZGAuOJvu33347FciYioqKjDEcELL1b9++nQOMkPtzb1pamtynaUeOHPGaeiKXjVukYTZt2pQar7/+em4h02zWrFmFhTWtR48eFy5c8NrbrvGHw4ztwQz0xIkT/IcJjYgn+1I7w13mQ9i9e7f4koZISUnhgnRe6KpAVzgqfPDBB6Ix2LkLaP00lxd/EZ6g+SlfThi6BnDwkCFDqEq7VFJSwi0MeRZH0s2ZsT0ENFg/rN8C+qETJTlEDQLqiRk4cCD10vStsLDw1VdfZfGtWbPGGMONIVt/bm7ujh07aEJdVlZ2+PBhmjxSMM39uZfNq3379idPniwtLd2/f/+8efOozL3B8iHgFvv06UONderU4SpN6ql6zTXX7N27l8yI7ql5qcWLF3vtbZeYMWMGXSDFF8vcGMxAH3roIa6OHz+eLgNk3HQ5fP/997nXP15gPgS2Ws3nC7QzEydO5Kr/eZk7dy4V6FwbG6UYrga0foJuqo4fP87PczTfrRUJ5tZbb+UqHwe6DaIy3YXwsgJ+EVPzDV/qqioarB/WbwH90ImSHKIGAfXk9T0l5+nbbbfd5jWkKHmKHGoKLxXM+s+dO0dOce211/KTJYYuNtzbrl07zfcN7aOPPvr666/TTPby5cti2WD5EHCLkvXzVNef4cOHe+1tl+bXxmDRHsxAeU9SU1PFd60SwTZnPoQmTZpoBqsVp8/f1um6W79+fSrv2bMnWAxXA1p/hw4duMpHmKDLOVVnz57NVbqSea9cTSmGgwV0qeMwuq2UuqqKBuuH9VtAP3SiJIeoQUA9EWKa/9RTT2X7YEMk96Q5nRwdHF5JMOvn1/v84V5yDelhCM3EDxw4wL3B8oEbjVukYUpWaLzSGOHJr53t9uvXL2C72B8xHeYq74n/UoJgmzMfAl+2+/fvz8F0XeHegLb+xBNPUHnEiBEmMV6/PecyNXJV7Ge5L7vmzJnD1a1bt3qDW39xcTGHKWX9JCcetT/UJUcH14AX1l919EMnSnKIGgTUE0GuYVSkkVWrVsnRweFFgll/vXr1qLdFixbHjh2jasA3Gb788sv169dPmTKFu8aMGcPt/DxKCvYG2qL4mvfxxx/nFn72zS5ppNygDPvbZfil7L59+3K1U6dOxsVpvq/5ntsEm/UH25z5EPhSR9viRpNZP5WPHz8eFxcnntGLGPM9l4Ile5KsP9gDH7pF4DA88DEB1h9G9EMnSnKIGgTU04kTJ4xf1kkMHjxYRHKL0e+kFq527959c0W4NyEhgXpbt2596tQpkq/YKPdOnTr1k08+8Xg8ly5dEl8I33HHHdx79913c8vnn3/OLQw38g7QapcuXcoXmLp16/JXtd4rD8qrVatGvTTxPHv2LDlUenr6O++84w3Hdo3wkxnyYtrKjh07OEy7MkbxrH/ChAnfffddSUnJxx9/bHzWH2xz5kO49957eam3336bek2e9XN13Lhx3GJsNN9zKdjc+sXXvOKlfoaUwGH4mjcgp3zQ1ZePElcJEWAcNazfCvqhEyU5RA0CJsmiRYtYavPnzze2d+vWTfM9BD937hy3cFil1u8P99JVRLSQL9D039gruowsXLiQe/n7SSMmS9WpU+e9997jACInJ8f/9RjNl0XB1mBxu/7WT/NZ7qJrD13baE+MS5m/4eMNvjnzIUhv+DRq1IgLwayfbnHEizqi0XzPpWBz61+xYgVXd+7cyQEMjVTDy53B4YPmjzEA1l8l9EMnSnKIGhhlJOBZBmV7fn6+sV3k85tvvsktXA3Z+mn9gwYNiouLa9Omzdq1ayX7mD59eq9evZKSksga6P6gZ8+er7zyCnd5fd8Qkjc1btxYeBa3i03QUuKHHL7++muxIJObm0uLt2zZsmbNmnRbQBuaNWsWzbu99rbrb/2UjXTHEB8f36pVK5qhS2PkAH6vn44DXVa7du26ceNG0Rtsc17TIRB069CxY0fabu/evemOQdo9/7295557pEbzPZeCza3//PnzfPmhkXIAQ2dHw3/pCg4fQ3+MAbD+KqEfOlGSQ9TAKCMAIgf/kENqaurFixe5RbxT9Nlnn1WMDQWjCaqjalh/VdEPnSjJIWqgTpKAq0txcTE/2lqxYgW33HfffVpYf74N1g/rrxT90ImSHKIG6iQJcDewfli/FfRDJ0pyiBqokyTA3cD6Yf1W0A+dKMkhaqBOkgB3A+uH9VtBP3SiJIeogTpJAtwNrB/WbwX90ImSHKIG6iQJcDewfli/FfRDJ0pyiBqokyTA3cD6Yf1W0A+dKMkhaqBOkgB3A+uH9VtBP3SiJIeoQXJysgaA80lMTBQmaPyDOe7GOGpYvxVg/ToejycnJyc7OzszMzMjI2M1AM6E1EsaJiXnXEEFVRtHTbkspzeoCKxfp7CwMD8/n6YM+/btIw1tAcCZkHpJw6Tk/CuooGrjqCmX5fQGFYH16xQXF9N9Yl5eHqmH5g5ZADgTUi9pmJR85goqqNo4asplOb1BRWD9OqWlpTRZIN3QrIHuGQ8C4ExIvaRhUnLhFVRQtXHUlMtyeoOKwPp1ysrKSDE0XyDpeDweMWMCwFmQeknDpOTSK6igauOoKZfl9AYVgfUDAIBywPoBAEA5YP0AAKAcsH4AAFAOWD8AACgHrB8AAJQD1g8AAMoB6wcAAOWA9QMAgHLA+gEAQDlg/QAAoBywfgAAUA5YPwAAKAesHwAAlAPWDwAAygHrBwAA5YD1AwCAcsD6AQBAOWD9AACgHLB+AABQDlg/AAAoB6wfAACUA9YPAADKAesHAADlgPUDAIBywPoBAEA5Alg/AAAARYD1AwCAcsD6AQBAOf4/TvEBPR5sL8cAAAAASUVORK5CYII=" />
</p>
<div class="sourceCode" id="cb600"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb600-1"><a href="#cb600-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/shared_ptr_ownership_ut.cpp 110</span></span>
<span id="cb600-2"><a href="#cb600-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb600-3"><a href="#cb600-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ステップ５</span></span>
<span id="cb600-4"><a href="#cb600-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 現時点でx1はA{1}オブジェクトを保持している。</span></span>
<span id="cb600-5"><a href="#cb600-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// x1::Moveに空のstd::shared_ptrを渡すことにより、A{1}を解放する。</span></span>
<span id="cb600-6"><a href="#cb600-6" aria-hidden="true" tabindex="-1"></a>    x1<span class="op">.</span>Move<span class="op">(</span><span class="bu">std::</span>shared_ptr<span class="op">&lt;</span>A<span class="op">&gt;{});</span>              <span class="co">// x1に空のstd::shared_ptr&lt;A&gt;を代入することで、</span></span>
<span id="cb600-7"><a href="#cb600-7" aria-hidden="true" tabindex="-1"></a>                                                <span class="co">// A{1}を解放</span></span>
<span id="cb600-8"><a href="#cb600-8" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="kw">nullptr</span><span class="op">,</span> x1<span class="op">.</span>GetA<span class="op">());</span>              <span class="co">// x1は何も保持していない</span></span>
<span id="cb600-9"><a href="#cb600-9" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">1</span><span class="op">,</span> A<span class="op">::</span>LastDestructedNum<span class="op">());</span>       <span class="co">// A{1}が解放された</span></span></code></pre></div>
<p>
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAnYAAAGkCAIAAAAzKP8XAABMeUlEQVR4Xu3dC3gTVd4/8Cm3QrlDuRWRO7bIVdaXlxcWCvKKCysqKrCsF2AFARFZwEUFhHdxBS/r6qrwwl9AlJeLgghiRWEBsYpyE7d4QRQJrZRbMVBaKLTN/0d+9uRwkplOk0zITL6fh4dn5pwzM5nkzPnmJGmieQAAAMACmloAAAAA4YCIBQAAsIQvYosBAAAgZIhYAAAASyBiAQAALIGIBQAAsAQiFgAAwBKIWAAAAEsgYgEAACyBiAUAALAEIhYAAMASiFgAAABLIGIBAAAsgYgFAACwBCIWAADAEohYAAAASyBiAQAALIGIBQAAsAQiFgAAwBKIWAAAAEsgYgEAACyBiAUAALAEIhYAAMASiFgAAABLIGIBAAAsgYgFAACwBCIWAADAEohYAAAASyBig5GZmVlQUKCWAgAASBCxZTZnzhxN0zp06HDhwgW1DgAAoIRDIjYvL2+en507d3ItZaFaN2/e3r17r9xHAPn5+cv9NGzYcNmyZfXr19+8ebMm+etf/6puDwAAMcwhEXvq1KmuV6pQocLcuXO59uzZs939vPnmm1fuozgnJ4cXcnNzz58/TwsnTpy4zk/16tWHDBlSuXLljIwMStZrrrmGo3f//v1X7A4AAGKbQyJW8a9//atKlSqZmZnF3pnov3VkZWVRgx07dowcOZJCOj4+/syZM1SSmpr68ssvK/sUbr75ZprIPv3007RMEXv99de73e6ioiK1HQAAxDYHRixNPZs1a/bUU0/x6s6dO+WXc2V/+tOfqEF2djZNSc+dO9exY8d169ZRSXJy8po1a+R9ymjaOn36dF4Wu2rQoMGmTZuubAgAADHNaRF7+vTpG2+88b//+78LCwvVOu+MluJwz549SnmHDh0+/PDDSZMmTZ48maaz5cuXP3z4sNKG0ZSX9rB582ZenTFjxvr16+fOnRsXF0fBfGVbAACIaY6K2O+///7666+nKWy9evW+/PJLtbq4mOKwSpUqeXl5SjkF57Fjx06ePJmbm/vkk09269ZNacAuXLhAVe3bt/fP76ZNm1asWFEpBACAWOaQiC0qKpo/f3716tVHjRpFQThz5szatWsrs9VNmzYlJSX95S9/kQtlZ86coQ1r1Kixa9cuta64eP/+/T179qRDiPB+4YUXJkyY8Prrr0+cOJGmtnrBDAAAsckhEdunT58mTZqsXbtWlMyaNatOnTo0r+VVit6EhITp06f7T0DJ8ePHKSCrVat22223KR8Mptntww8/3KVLFwrR1NTUb775RlS99957HTt2jI+Ppz3379//0KFDvs0AACDmOSRiP/300/z8fKVwxYoVFy9e5OUDBw788ssvV9b7FBQU0Bw3YIOcnJzhw4c///zz+JscAAAoE4dELAAAQLRBxAIAAFgCEQsAAGAJRCwAAIAlELEAAACWQMQCAABYAhELAABgCUQsAACAJRCxAAAAlnBUxNatW1f8uhyAedRz1M5kGnodBCeUXgd24aiIpV4rzgLAPOo5brc7Nzc3Pz+/oKAg4BdZ60Gvg+CE0uvALnwPt1hSm9gHBjsIDvUcl8uVnZ2dk5NDQx6Nd2rf0odeB8EJpdeBXfgebrGkNrEPDHYQHOo5GRkZBw8ezMrKovHO/yclDKDXQXBC6XVgF76HWyypTewDgx0Eh3pOenr6vn37aLyjWQVNKdS+pQ+9DoITSq8Du/A93GJJbWIfGOwgONRz0tLSaLyjWYXL5XK73Wrf0odeB8EJpdeBXfgebrGkNrEPDHYQHOo5K1as2Lhx486dO2lKkZOTo/Ytfeh1EJxQeh3Yhe/hFktqE/vAYAfBCWWwQ6+D4ITS68AufA+3WFKb2EcEBrvJkydrXmpFUHhXtE+1wnrhPRG7C2Wwi8B9GN4HC70uSoTS68AufA+3WFKb2EeIl66ZoSe8Y4SZI1okLCdi6e2n0Yf3r3k/eKlWh5UWwmAXgfswLA+WYOaIFgnLiVh6++3S68AufA+3WFKb2EcELt2wjBGCmSOadP78ebXIUFhOxMztN75hx48ff/7553/3u9+pFR7PzTffzPsPeIi0tLS77rrrgw8+KCoqUqqCoIUw2EXgPgzLgyWYOaJJxg+uv7CciJnbb3zDHNDrwC58D7dYUpvYR6mX7r///e9+/frVrFmzfPny9erV692795YtW7hKXFeC2OqZZ56hxrTVI15KLa/KV6NSUupBJ0yYMHHixFq1atWuXft//ud/xH727t3bq1evhg0bVqhQIT4+Pjk5efbs2ZcuXZK3HTt27D333JOQkDBz5kwqzM/Pf/zxx1u0aFGxYkXacNy4cWfPnhU7ND4Rf9xg/PjxY8aMqVGjBm1Le1BqZXK5csMUhYWFGzZsuOOOO+h2xsXF0YLSIDMzs1y5crSf3/zmN/R/gwYNxIkzGpXoBKmqSZMmM2bMOHTokFxbVloIg504cT2ldgCZ2Mr4weJV9DotVnsd2IXv4RZLahP7ENebHhovqA0NOh07dmzTpg1dTv/4xz+4qmvXrnyVNmrUqKsXl7/xxhtc3rhx46SkpKpVq/Kq2CevGgx2BgfllpUrV6Y901DCq9u3b+fatWvXUuOWLVvSBU9H59rHHntM3rZSpUo0DNGeaRykwr59+3Jhhw4dqlSpQss9evQo9j7MpZ6IP25A42xjL16l/XCt3j3GhcoNE3744YcnnniCboDmHaemTZtGJXID9tRTT1EDGv2/++47Gg1ped26dUobGv7Wr19/++2384h50003LV++3Hj6okcLYbDTDO9Dj2EH0LsPS32weBW9LmZ7HdiF7+EWS2oT+9AML11CVyC1GTZsGK+ePHnyxx9/FLV8lSqvDvHzWRqkznvRAjcTDa7zkp9oKyUGB+VdNW3alOYBdM3zqhgdjh07Ro15mdx2222ad4CQt61fv/7x48dptaioiKYpVEKX/Z49e6jkq6++4jZpaWkeEyfijxvQ7ETe5MYbb1QaKPcYF8o3jMtp2EpNTaWbR6PnkCFDaGQxeLWtVatWtBOax9Dyb3/7W1qmQU1tVOLEiRN///vf27VrR81oWibywDwthMFOM7wPPYYdwKNzH5b6YKHXxXivA7vwPdxiSW1iH5rhpUsGDhzIlyI9n6Wn3jSsnD59WtRylXLp0pN9Khw3bhyv0gI3k9sYMzgol48aNcrjHRR4dcqUKVz7888/Dx8+nEa3ChUqcJXmnZfI244YMYJXybPPPiuayWbNmuUJ6kS4wYMPPsirvAntR2kQcLCTbxij6RFXrVq1ymCYI5988gm33LFjB60uXLiQlmnSQIOa2lRCwUCJonnDQ60rjRbCYKcZ3oceww7g0bkPg3iwFAYH5XL0OoW9eh3Yhe/hFktqE/vQDC9dcuHChUWLFt13331du3blN13oGa6o5Qss7IOdwUGVIyqrPXr04BJ6Ik/bNmrUiFcDNvaUDHY0GvILaMI///lPT1Anwg2UTUwOdkqhx/usf9q0afzS37XXXjtjxgx5MicbOXIk76SmV7Vq1XhVvNQp4zfYBg0aJF64W716tdqoNFoIg51meB96DDuAR+fuCuLBUhgcVDmisopeZ4teB3bhe7jFktrEPjTDS5d8/PHH4pnsH//4R837LFXU8tN28fSZ8Std11133QUvWuALTzQo9SU7g4PyrvQGO2pGq0OHDqXlixcv9urVSz600pjwS3Zk69atXHLp0qUPP/wwOzvbY+JE/HEDZRP5JbuA9xhv5T/YMRqb3n//fTE20bj/xhtv5OXliQbnzp0To5uiQ4cO0p4uvwY4depUzgAaPZ988smffvpJbmCeFsJgpxnehx7DDuDRuQ9LfbDQ62K814Fd+B5usaQ2sQ/N8NL1ePs0PT/t1KnT9ddfzx9nuOGGG0Rt+/btqYQuYCrsWvIxitdff52vtGuuuYaeC8fHx/Oq2IpX5WtbKdH0D+rfUl7l4YmmIHSR169fX/z0d8DGjD94QkdJSUnp2LEjf7rkyy+/9Jg4EX/cICEhQf7gCe1HNAh4j3EzvcFOoOnF888/37ZtW2qcnJwsysXt3L17tyhctmwZF/IbfuSDDz7QvB9vufvuu43fYDNDC2Gw0wzvQ49hB/Do3IelPli8il4Xs70O7ML3cIsltYl9aIaXLqFnvjwE0AhCw8eQIUPkZ6D0xJ+uXvEWlCifM2dOYmJi9erVR48ePX78eKWWVw0GO4ODKi2VVXq+3LNnT7qeGzZsOHPmzEmTJnGDgI1Zfn7+tGnTWrZsSc/W6YhdunR5/PHH3W431xqfiD9uMGHChIcffrhGjRq07dNPPy03CHiPBbxhBnbs2DFjxgyxytMm5Z0tOgX+/A7dbC75/PPP//GPf5w6dUpuFjQthMHO+D70GHYAj8596CntwfK/k5USg4MqLZVV9Dohmnsd2IXv4RZLahP7ML50oazKOmzZVyiDHXpdeKHXgZP4Hm6xpDaxDwx2wbnycyq/8mCwMwe9Ljhqh/PyoNeBs/gebrGkNrEPDHbB4UFNIcox2Bnj+wrKSu5sgihHrwNn8D3cYkltYh98iQKUVSiDHXodBCeUXgd24Xu4xZLaxD4w2EFwQhns0OtKNXLkyE6dOvGfA+HuEkLpdWAXvodbLKlN7ANXb6m2b9+emppatWrVhIQEWkhPT1dbxKRQBjv0ulLRXZSYmKh8iwWE0uvALnwPt1hSm9gHrl5jdCXzTOLOO++86667NO9f+Im/+YtloQx26HXGP85DDh8+7AnTL9k5SSi9DuzC93CLJbWJfeDqJZ9++mmXLl1q1qxZrly5GjVq0Nj38ccfcxV/pfuQIUN4dfDgwbTq/5NeMSiUwQ69zvjHeQRErCKUXgd24Xu4xZLaxD5w9ZJ33nmHYnXUqFHjx4/v3r275v2iHP4q88TERFrlL48lL730Eq3Wq1fviu1jUiiDHXqd8Y/zCIhYRSi9DuzC93CLJbWJfeDqZZs3b549e/akSZMeeughHtTWrFlD5eXLl6flxYsXc7NFixZp3i+iu2LjmBTKYIdeZ/zjPAIiVhFKrwO78D3cYkltYh+4esnYsWPFMCfwV7zy983S5JVbYhYraCEMdlrM9zrjH+cRELGKUHod2IXv4RZLahP7wNVLqlSpQvfDn//85wsXLhw9epQHtSVLlnhKfkN08ODB3JLfizX40enYEcpgh15n/OM8AiJWEUqvA7vwPdxiSW1iH7h6SatWreh+aNmy5ZgxY1JSUnhQ44j9/PPP+aU88YliGhzp8lZ3EXtCGezQ64x/nIe09KpVqxaX86q0gxgVSq8Du/A93GJJbWIfGOw83hylkY6ilLJ23bp1PKhxxJJt27b17NkzISGBJru0ID5sHONCGezQ64x/nMfjvXv9STuIUVoIvQ7swvdwiyW1iX3guoXghDLYoddBcELpdWAXvodbLKlN7AODHQQnlMEOvQ6CE0qvA7vwPdxiSW1iHxjsIDihDHbodRCcUHod2IXv4RZLahP7wGAHwQllsEOvg+CE0uvALnwPt1hSm9gHBjsITiiDHXodBCeUXgd24Xu4xZLaxD4w2EFwQhns0OsgOKH0OrAL38MtltQm9oHBDoITymCHXgfBCaXXgV34Hm6xpDaxDwx2EJxQBjv0OghOKL0O7ML3cIsltYl9YLCD4IQy2KHXQXBC6XVgF76HWyypTexDfHMbQJlUrVo16MEOvQ6CE0qvA7twVMQSt9vtcrkyMjLS09PT0tJWxDDN+xwZTKLeQn2Geg71H+pFascyhF4noNeVSSi9DmzBaRGbm5ubnZ1NTwn37dtHfXdjDKPBTi0CfdRbqM9Qz6H+Q71I7ViG0OsE9LoyCaXXgS04LWLz8/NzcnKysrKo19Jzw50xjAY7tQj0UW+hPkM9h/oP9SK1YxlCrxPQ68oklF4HtuC0iC0oKKAng9Rf6Vmhy+U6GMNosFOLQB/1Fuoz1HOo/1AvUjuWIfQ6Ab2uTELpdWALTovYwsJC6qn0fJC6rNvtzolhNNipRaCPegv1Geo51H+oF6kdyxB6nYBeVyah9DqwBadFLAg02KlFABZDrwOQIWIdC4MdRB56HYAMEetYGOwg8tDrAGSIWMfCYAeRh14HIEPEOhYGO4g89DoAGSLWsTDYQeSh1wHIELGOhcEOIg+9DkCGiHUsDHYQeeh1ADJErGNhsIPIQ68DkCFiHQuDHUQeeh2ADBHrWBjsIPLQ6wBkiFjHwmAHkYdeByBDxDoWBjuIPPQ6ABki1rEw2EHkodcByBCxjoXBDiIPvQ5Ahoh1jg4dOmg6qEptDRAO6HUABhCxzjF37lx1kCtBVWprgHBArwMwgIh1DpfLVa5cOXWc0zQqpCq1NUA4oNcBGEDEOkpqaqo61GkaFartAMIHvQ5ADyLWURYuXKgOdZpGhWo7gPBBrwPQg4h1lNOnT8fHx8sjHa1SodoOIHzQ6wD0IGKdZtCgQfJgR6tqC4BwQ68DCAgR6zSrV6+WBztaVVsAhBt6HUBAiFinOX/+fO3atXmkowVaVVsAhBt6HUBAiFgHeuCBB3iwowW1DsAa6HUA/hCxDrRlyxYe7GhBrQOwBnodgD9ErAMVFRU18aIFtQ7AGuh1AP4Qsc401UstBbASeh2AAhHrTF95qaUAVkKvA1AgYkEXv7V20003BVwt1euvvz7TS60A0IdeB06CiAVdIQ521JI3USsA9KHXgZMgYkFXZAa73NxctQhiGHodOAki1uHECLV06dIWLVrEx8f379//1KlTSi2vKsOTUqu3umzZslatWtGee/fu/f3338u1CmXDBQsWNG3aNC4ujsvBMcRDjF4HMQ4R63A8stSoUcM35Gja6NGj5dpQBrvatWvTaMXLpHnz5jw/ECUyecNatWop5eAY/LCi1wEgYh1ODCgrV67MzMzkISYpKUmuDWWwIzSfyMvLGzt2LK/Omzcv4N4EseH06dPPnTv37bffKg3A7sRDjF4HMQ4R63A8rLRu3ZpXu3fvTqvlypWTa0MZ7JKTk3mVRlIuGTZsGJcYD3YNGzYsLCxUqsAZ+CFGrwNAxDocjyx9+vThVePhjJoZ1AZc7d27N69eunSJS2655RYuMR7sevXqpZSDY/BDjF4HgIh1OB5Z9GYMNLGg5Z49e/JqSkqKXKtsG3DVYD7Rt29fLuFVQdkPOI/yEKPXQcxCxDqcMrIog12jRo1ouV69em63e+vWrVwlapVtA66S5cuX5+XljRs3jlfnz5/PDQYOHMgle/fu5RJ5Qwx2DqY8xOh1ELMQsQ6njCzKYDdq1CherVatWvny5atUqSLXKtsGXKWBkiclTHy2k8yZM0eUs4D7AedRHmL0OohZiFiHU0YWZbA7derUgAED4uPjmzZtumDBAqVW2VZv9a233mrTpg3tJDU19cCBA1xL8vPzaTBNTEwUf18RcD/gPMpDjF4HMQsRC0HCmAWRh14H9oKIhSBhsIPIQ68De0HEQpAw2EHkodeBvSBiAQAALIGIBQAAsAQiFgAAwBKIWAAAAEsgYgEAACyBiAUAALCEoyK2bt26/Jl+x6AzUk8Sogx6HQDocVTE0uggzsIZ6Izcbndubm5+fn5BQQF+6jIKodcBgB7fZSWW1Cb24cjBzuVyZWdn5+Tk0JBH4516znC1odcBgB7fZSWW1Cb24cjBLiMj4+DBg1lZWTTe0axCPWe42tDrAECP77ISS2oT+3DkYJeenr5v3z4a72hWIX6xC6IHeh0A6PFdVmJJbWIfjhzs0tLSaLyjWYXL5XK73eo5w9WGXgcAenyXlVhSm9iHIwe7FStWbNy4cefOnTSlyMnJUc8Zrjb0OgDQ47usxJLaxD4w2EHkodcBgB7fZSWW1Cb2gcEOIg+9DgD0+C4rsaQ2sY9IDnaHDh0aOnRo3bp1K1WqlJKS8uKLLxZL92a4YLCLfpHsdWTkyJGdOnWqWLGi5qVWhwN6HUC4+C4rsaQ2sQ+LRhx/2dnZDRs2pMPVqlWrXbt2cXFxtDxlyhS1Xcgw2EW/iPU6RodLTExs1KgRIhYg+vkuK7GkNrGPMI4469at4yFs06ZNtLpt2zbO0bfeeotWJ0yYoHm/Z+7kyZO0+uyzz9JquXLlDh8+rOwnRBjsol8Ye52ntI5HuI9NnjyZm8nbhgt6HUC4+C4rsaQ2sY/wjjgPPvgg7bBZs2Y0Z23evDktDx8+nKtat25Nq0OGDOHVI0eO8Hi3cOFC3/bhgMEu+oW313kMO56AiAWwBd9lJZbUJvYR3hEnLy/vuuuuo302aNCA/m/ZsmVubi5XxcfHU8nEiRN59dKlSzzeTZs2zbd9OGCwi37h7XUew44nIGIBbMF3WYkltYl9hH3E2b17d/ny5TXvi8Cff/65KOeIfeSRR3j14sWLiNiYFfZe59HveAIiFsAWfJeVWFKb2EfYR5x3332XBzIedEQ5v1A8ePBgXsULxbEs7L3Oo9/xBEQsgC34LiuxpDaxj/COONnZ2YmJibTPzp07a94PD1OUcpXycafnnntOw8edYlV4e53HsOMJiFgAW/BdVmJJbWIfYRxxaG/9+vWjHd54440XLlzo2rUrLffu3buoqIhqjx49Wr9+fSqpXbt2+/bt+TOfkyZNUvcSMgx20S+Mvc5TWscjLb0odzliefXKfYQKvQ4gXHyXlVhSm9hHGAe7l156ifYWHx//zTff0OqBAwcSEhKo5Nlnn+UGP/zww+DBg+vUqVOpUqXk5OQXXnihGF89EZPC2Os8JjoeJ6viil2ETEOvAwgT32UlltQm9hH2seaqw2AX/dDrAECP77ISS2oT+8BgB5GHXgcAenyXlVhSm9gHBjuIPPQ6ANDju6zEktrEPjDYQeSh1wGAHt9lJZbUJvaBwQ4iD70OAPT4LiuxpDaxDwx2EHnodQCgx3dZiSW1iX1gsIPIQ68DAD2+y0osqU3sA4MdRB56HQDo8V1WYkltYh8Y7CDy0OsAQI/vshJLahP7qFu3ruYsVatWxWAX5dDrAECPoyKWuN1ul8uVkZGRnp6elpa2Ikw07/P6q4LOgs6FzojOi85OPWGIAuh1ABCQ0yI2Nzc3Ozubnnrv27ePxoiNYUKDnVoUKXQWdC50RnRedHbqCUMUQK8DgICcFrH5+fk5OTlZWVk0OtBz8J1hQoOdWhQpdBZ0LnRGdF50duoJQxRArwOAgJwWsQUFBfSkm8YFevbtcrkOhgkNdmpRpNBZ0LnQGdF50dmpJwxRAL0OAAJyWsQWFhbSiEDPu2locLvdOWFCg51aFCl0FnQudEZ0XnR26glDFECvA4CAnBaxFqHBTi0CsBh6HYDdIWJNwWAHkYdeB2B3iFhTMNhB5KHXAdgdItYUDHYQeeh1AHaHiDUFgx1EHnodgN0hYk3BYAeRh14HYHeIWFMw2EHkodcB2B0i1hQMdhB56HUAdoeINQWDHUQeeh2A3SFiTcFgB5GHXgdgd4hYUzDYQeSh1wHYHSLWFAx2EHnodQB2h4g1BYMdRB56HYDdIWJNwWAHkYdeB2B3iFhTMNhB5KHXAdgdItYUDHYQeeh1AHaHiDUFgx1EHnqdv8OHD1etWjU+Pv7o0aNqXVAmT56seakVQeFd0T7VCuuF90RsYdeuXf/5n/9JnYHOeubMmaKcVuPi4urXrz9x4sRLly5JWxQ/8cQTVDty5Ei50FKIWFNiquNClIhYr6MRp1OnThUrVix1jOYG5P777xeFWVlZYlur0+WPf/wjHeVPf/qTWhGImZsU3mQyc0SLhOVELL39y5cv5/2Tf//732p12XXo0IH3lpKSsnDhQlH+H//xH7Vr1+aqN998U9qiODs7u1KlSuXKldu3b59cbh1ErClaaB0XIAgR63V0oMTExEaNGvGopFZLuAGhqQONVlz4+OOPi3KLRmf2448/li9fno6ydetWtS4QMzcpLMkkmDmiSfn5+WqRobCciJnbb3zDjh079txzz/3ud79TK4qLb775Zt5/wEO8//77d911V1paWmFhoVKlhzsDbaVWeLsKH2jq1KlK1YABA6h82LBhSrlFELGmaKF1XIAghKvXvfvuuzzcfPTRR7RK+RQXF0erq1at4gY//fRTsbkxmhvwnPXJJ5+kknPnztWpUyfgLPbTTz+lobZWrVpU26JFCxrsqDGVP/jgg9Ty+uuvFy151Ovbty8t5+XlUWZTe9qqYcOG48aNO3PmDDebOXMmNatZs6YYhb/66qt+/fpRCY229erV692797/+9S+u4tsj43Iyd+5cakxbPeKl1PKqfCJKSakHnTBhwsSJE+nEaS41a9YssZ89e/b06tWLTqpChQr0HCU5Ofmvf/3rxYsX5W3Hjh17zz33JCQk8CufBvdGcWkn4o8bjB8/fsyYMTVq1KBtaQ9KrUwuV26Y4tKlS++9994dd9xBt5N6Fy0oDY4cOUJzR9rPb37zG/q/QYMG4sTZF198QSdIVU2aNJkxYwZlpFwbEN8w/7RmerXz58/XvM8R3W63UmUFRKwpmmHHBbBCGHsdp1qzZs2OHj3avHlzWh4+fLjSxnzEDh48mEKCBujz58+/+uqrVEKDL1eJEW3btm2cuxTA7du351D/7W9/S+n42WefcWN+tfDUqVPckl/To6Cl5UqVKnXo0KFKlSq03KNHj6KiIqr6r//6L1rt06ePuD2UUlRCUdexY8c2bdrQIP7CCy9wVdeuXfkoNDvv6sXlS5cu5fLGjRsnJSVVrVqVV8U+edUgYg0Oyi0rV65Me6b7h1c//vhjrn3nnXeoccuWLSlm6Ohc+9hjj8nb0olT+NGeKX2LDe+NUk/EHzegdGnsxau0H67Vu8e4ULlhwsGDB5944gm6AZo3HadNm0YlcgM2e/ZsakDPOb799lvuDPTMT2lDobtu3brbb7+dc/qmm276v//7P71JM/U9vmGPPvqoWufFtQ8//LBSTk90uGrt2rVKlRUQsaZohh0XwAph7HU0fbzuuus07+yB/qdR/uzZs0ob8xFLLYcMGUILCxcupIyhhV27dokqbknTNc07+v/yyy+0Om/ePG6wfv364pKUouGYlhcsWEDLNHzTjI2mg5r3syq7d++mqn379vFW77//Pq3SvFC78rMqNO5r0ot+J06c+OGHH0Qtb6vMY3gWRTc734tvvyad9XVe8vROKTE4KO+qadOmdC6UNLwqMik7O5sa8zK57bbbNG8sydvWr1//2LFjtErPRYzvjVJPxB83oDmxvMmNN96oNFDuMS6UbxiXU1impqbSzaPMpv7wwQcfGLzG26pVK9oJzZ5pmZ5p0TJFqdqoxPHjx59//vl27dpRM3rQxbMQgSbNixYt4hv297//Xall/MZH27ZtxTsajJ7S8YZPPfWUXG4RRKwpmmHHBbBCeHsdpSC/d0UTqR07dqjVZYxY2oPmzUXNOzeVq7hlQkICrT7wwAO8SkHLDfjl5aeffpqWadilZZqV0vKoUaNo+ZlnnuFmCn5xkl9pfOSRR3ifZODAgdyAZlE04aMwy8nJEbVcpQQGTTGpcNy4cbxKC9xMbmPM4KBczudCecOrU6ZM4dqsrKzhw4dTplaoUIGrNO9sWN52xIgRvFpc2r0RxIlwgwcffJBXeRPaj9IgYMTKN4zRpJyrVq5caRCuZPv27dzys88+Ky55UkVTVYpStamEno7Q8xjN+5RFqeK9kQEDBvBzOH908/gJpXbl541prsyFf/nLX6TmVkHEmqIZdlwAK4S3161du7ZkXNKWL1+uVpcxYmm5W7duvLpmzRqlqri0iM3MzOS8pEktB/+nn35aXBIqVMIvVAovvfQS1dasWVO78uPE58+ff+211+677z5qwzukeZWoVW4SCyKZFAYHVY6orPbo0YNLaPpI2yqfL1MaF5d2bwRxItxA2cRkxCqFxd655rRp0/gF52uvvXbGjBnySwiykSNH8k5qelWrVo1XxQvsMn5bd9CgQeLl4rfffltpQzN4ftmc5rj79+9XatmkSZP4KM2aNZM/byxmsbNnz5aaWwURa4pm2HEBrBDGXnf06NHExETaYefOnXlgcrlcSpuAEau8RsoNeLRdtWqV5n3VkWcwclVxaS8Uk379+tEqf8KFDsGF/NIo2bJlC5fQnGPjxo38V7D8Xix/Kopt27ZNzJ/473loXBa1PFkUkzbGr6/SEc978evnWlleKDY4KO9KL2L5LeehQ4fSckFBAd9F4tBK4+LS7o1ST8QfN1A2kV8oDniP8Vb+EcsoETds2CASkZ5tLF26lD/XxnJzc0WmKjp06CDt6fIrz1OnTuVnHpTZ9Gzs0KFDcgMZPSfjncgfKJPxQXv27MlvXQvivVh+amg1RKwpmmHHBbBCuHodDTGcZzSY0sDa1fuplt69e4ucaOnF73Rq3ndqCVdxScDMoN2eOHFCvKertKQc4vG6Tp06NJLKH3fiBvJfST799NNcWFzyAR9qn5KS0rFjR/4Uz969e4tLPlFMOxSDpuadGHXq1On666/nQ9xwww1iV+3bt6cSuhlU2LXkwztLlizhg15zzTX0DIC/uECT7mpelRNFKdH0D+rfUl7lUKSJL90h9evXr1u3LjcI2JgZ3Bulnog/bpCQkCB/3In2IxoEvMe4mV7ECjSpfe6559q2bUuNk5OTRbm4nbt27RKFb775Jhfy28wkLS1N836o6u677zZ+W5dRtPMexOvwCq6dOHGiUs6fKKYDnT59WqmyAiLWFM2w4wJYIVy97sUXX9S8nyP9+uuvafW7777jV3GfeeYZbsCDkUKu0ssMmX8VzTNuueUWSiPlj3ZYfn4+hzpFTmZmpijPy8ubNm0aZTxtRYnSpUuXxx9/nKfC4u9it2/fzo1pvsXBQzuh0BoyZIg876GYp8wQb3yKckp0mtNXr1599OjR48ePV2r9T0QpMTio0lJZpVkaTapocKe5Oz1dEK9kBmzMDO6N4tJOxB83mDBhwsMPP1yjRg3a9m9/+5vcIOA9FvCGGfjss89mzJghVnmyrryfSqfAnxqjm80lO3bseOGFF06ePCk3M8Y37M9//rNaIb0R7n+z+/fvT+X0qCnlFkHEmiJ6G0DEoNf5478O4s8TQVnppY5N8bvRPXr0UP7CtaioiObBfLLTp0+Xq/jbneLi4viVgAhAxJqCwQ4iD73OH39HMY2t4fqOYke68tNRvyp2XMTy2x9M+Y5iYfPmzdIW+I7iaKVhsIOIQ6+D4MgZI4hyx0TssWPHJk6c2KtXL3oCIX9mmFa7des2cODAFStWSM2vDkSsKdxBASIJvQ7A7hCxpmCwg8hDrwOwO0SsKRjsIPLQ6wDsDhFrCgY7iDz0OgC7Q8SagsEOIg+9DsDuELGmYLCDyEOvA7A7RKwpGOwg8tDrAOwOEWsKBjuIPPQ6ALtDxJqCwQ4iD70OwO4QsaZgsIPIQ68DsDtErCkY7CDy0OsA7A4RawoGO4g89DoAu0PEmoLBDiIPvQ7A7hCxpmCwgwjo0KGDpoOq1NYAEPUQsaZoiFiw3ty5c9VoLUFVamsAiHqIWFM0RCxYz+VylStXTk1XTaNCqlJbA0DUQ8SaoiFiISJSU1PVgNU0KlTbAYAdIGJN0RCxEBELFy5UA1bTqFBtBwB2gIg1RUPEQkScPn06Pj5ezldapUK1HQDYASLWFEQsRMygQYPkiKVVtQUA2AQi1hRELETM6tWr5YilVbUFANgEItYURCxEzPnz52vXrs35Sgu0qrYAAJtAxJqCiIVIeuCBBzhiaUGtAwD7QMSagoiFSNqyZQtHLC2odQBgH4hYUxCxEElFRUVNvGhBrQMA+0DEmoKIhQib6qWWAoCtIGJNQcRChH3lpZYCgK0gYgPDb56AA3CPvemmmwKulur111+f6aVWAIA5iNjA8Jsn4ADcY4OOWGrJm6gVAGAOIjYw/OYJOAB3WqsjNjc3Vy0CAC9ErC785glEA+54lHZLly5t0aJFfHx8//79T506pdTyqhKKSq3e6rJly1q1akV77t279/fffy/XKpQNFyxY0LRp07i4OC4HAAUiVhd+8wSiAXe8GjVqyP1w9OjRcm0oEVu7dm3KSF4mzZs351mpKJHJG9aqVUspBwAFIlYXfvMEooHofitXrszMzORgS0pKkmtDiVhCs9i8vLyxY8fy6rx58wLuTRAbTp8+/dy5c99++63SAAAYItYIfvMErjrue61bt+bV7t27a97PBMi1oURscnIyr1J+c8mwYcO4xDhiGzZsWFhYqFQBgAwRawS/eQJXHfe9Pn368KpxiFIzg9qAq7179+bVS5cuccktt9zCJcYR26tXL6UcABSIWCP4zRO46rj76c1T+XPvPXv25NWUlBS5Vtk24KrBLLZv375cwquCsh8A0IOILQV+8wSuLiXPlIht1KgRLderV8/tdm/dupWrRK2ybcBVsnz58ry8vHHjxvHq/PnzucHAgQO5ZO/evVwib4iIBSgVIrYU+M0TuLqUPFMidtSoUbxarVq18uXLV6lSRa5Vtg24SvEs/wm4+EQxmTNnjihnAfcDAHoQsaXAb57A1aXkmRKxp06dGjBgQHx8fNOmTRcsWKDUKtvqrb711ltt2rShnaSmph44cIBrSX5+PkV4YmKi+KuegPsBAD2I2NLhN0/AkZCUAFZDxJYOv3kCjoSIBbAaIhYgRjkyYst0UmVqXIyfHoKyQ8QCgHOUKTXL1LjY741wgFIhYgHAOcqUmmVqXIyIhbJDxAKAjW3YsCE5Obly5co9evTYv3+/f2q6XK4RI0YkJSVVrFixSZMmEyZMcLvdXBVEY4WZDSGWIWIBwK527dpFkSYCr2HDhrwgUpOSr0GDBqIB69y5c35+frFfxJpprDCzIcQyRCwA2JX4oY7ly5efO3dO/FiQSM3hw4fTauPGjffs2XP+/HnxreOvvvpqsV/EGjcu1n+huNQNIWYhYgHArurVq6cF+pplkZr8BZP+Bg8eXOwXscaNi/UjttQNIWYhYk2pVOmKH8R2gLp166onCVGGHiN6pJQ/EaFV+XG0V23Ye1358uW1QD8WJFKzQoUK4lbJ+vbtW+wXscaNi/UjttQNIWYhYk2hq+Xuuzc56R+dkdvtzs3Nzc/PLygowA9/RiHNbyi3u7CfEc9iU1JSeNV/FsvvzvpHHX8fapkaF+v/9FCpG0LMQsSaojkxYl0uV3Z2dk5ODgUtpax6znC1+Q/ldhf2L2248847OfNWrFiRl5en915sXFzcggULqAE9rfzoo4+GDh26atWqYr+INW5crP/TQ6VuCDELEWuK5sSIzcjIOHjwYFZWFqUsPvoYhcIeSM6jfKK4Tp06vCBS8/Dhw/6f9dW8H48q9otY48bF+j89VOqGELMQsaZoTozY9PT0ffv2UcrSXFb8fhmAvbz33nvJycnx8fHdunWjySVnm0hNcuTIkVGjRjVp0qRChQrVq1fv2rUrPXc5duxYsV/EGjcu1v/poVI3hJiFiDXFkRGblpZGKUtzWZfLhT+TBwAIO0SsKY6M2BUrVmzcuHHnzp00kc3JyVHPGQAAQoOINQURCxA6vLsMsQYRawoiFiLPeYEkv3kJEAsQsaZYF7FPP/1lZua5wsLLj8SsWbv9G/j/O3HiPD1wZ89e3LDBNXiwWmvyHyI2+lkXSBs2bGjbti1/YcKWLVvUaj9NmzaNi4tLTEycOHFiKH/rad0ZAUQnRKwpQUfsli0/8736xRfH/Wvp3+nTF6j21KnzGzdmPvzwp6L8ySd37d9/+sKFQvpHC9On7xJVq1b9SCW829mz9/jv08w/RGz0CzqQRowYoXndcccdap0Xf+FfkyZNxo0b9/3333PhnXfe2bhxY95w8eLFcvtZs2b17t2bqz788EO5qkyCPiMAmxLBiog1ogUVsffdt4UCku9Vmqc+8MDH/m249v/9v2/lwsce+4LntZ9/fnzHjuO0cOlS0V/+8rlocM89W3jDV17Z779PM/80RGzUCy6Qzpw5U7VqVY7DihUrZmdnqy1K/lhF+ZL6pKSk22+/nauUiCXnzp3jqiVLlihV5mlBnRGAffFA7UHEGtOCitgFC76h+/Ps2YsnTuTTwrJl3ysNBg/ezPe5kpQ7d56gwk8/Pcarn312zOM3D+YN5837WtmnyX8aIjbqBRdI//u//0sbJiYmNmvWjBbmzp2rNCgsLDQIS67yj9jikqpFixapFaY5791lAGM8UHsQsca0oCL2hx/O0P350UeZ7777Ey0cPZon11K+vvDCv/k+nzt3n1xFqUyFixd/x6u0QKtnzhTIbXJzL7fZvv3osGH/kstN/tMQsVEvuEC68cYb6cEdM2bM1KlTaaFNmzZyLeXrypUrOSzXrVsnVzGDiOXvTrrnnnvwXWAAJpXkKiLWUBARO3nyDr4/Z87c/eijn/Pyk0/6PtAk7vAtW34eOnSzvG1R0eUHRsxQacHjfalZbvPss/vy8i7xHuRyk/8QsY701VdfcUZu3bpVfNXRtm3bRAMuISNHjgz4xdRcGzBi33nnnZo1a3IDtQ4AAhHjPCLWiFb2iE1LO0J35unTF2i2SqtZWedo9eOPj4oGH3xwhAvz8y+NG5cub2tmFrt79+UXkyllN23KkstN/tMQsU708MMP0yOblJTEP52UnJxMq/fee69oMH78+JSUFCqsUaPGoUOHRLlgELG33norVVHKjh49Wq0DgEBEsCJijZQ1YocN+xe/kKsoKCi6//6totnYsZ9w+UsvZcib79p1OT4/++yK92J37jwht+HPQy1bdlAuNP8PEes858+fF9+DL6tSpcovv/wimh0+fJjLly1bJm39K64KGLH8hftz5sxRKwBAhxj8EbFGtDJGLEUm35l79pykaKR/lJp8b7/22hUfHuZmr756xaeWnnhip/KJYlp97LEvSt3Q/D8NEes4FJkckAMGDLjNa+DAgfyF9a+88orcMmCO3u/FVd27d+dVuUHArcokuHeXAeyLB2oPItaYVsaI5b9bpf/lQv6c8KFDZ+VCfggWLfr1NWHxb+bM3d98c/nvYmniSwvym7h3e/8ciB8s/NGOg5U1kPhPV1NTU+VC/juczp07y4Wcu//85z/lQk5Qhag9c+YMl7z++uvSRmUj7xAgFohgRcQa0coYseb/HTt2+e95Tp++oHz1hMG/Vat+pNDlB2vGDN9XUpTpn4aIjXrWBVKLFi0071u28ldPGJg1a1bPnj05Yrdv365Wm2bdGQFEJxGsiFgj1kXs//zPniNHcoP4AsUzZwreffcn/1qT/xCx0c+6QNq8eXO7du3K+gWK9erVmzp1qlpXFtadEUB0QsSaYl3EXq1/iNjo57xAct4ZARhDxJqCiIXIc14glfXdZQC7Q8SagoiFyEMgAdgdItYURCwAAJQVItYURCwAAJQVItYURCwAAJQVItYURCxA6PDuMsQaRKwpiFiIPOcFkvM+Iw1gDBFrCiIWIs95geS8MwIwhog1BRELkee8QHLeGQEYQ8SagoiFyHNeIDnvjACMIWJNQcRC5DkvkJz37jKAMUSsKYhYiDwEEoDdIWJNQcQCAEBZIWJNQcQCAEBZIWJNQcQCAEBZIWJNQcQChA7vLkOsQcSagoiFyHNeIDnvM9IAxhCxpiBiIfKcF0jOOyMAY4hYUxCxEHnOCyTnnRGAMUSsKYhYiDznBZLzzgjAGCLWlLp162rOUrVqVURslFN6nfLWLK3asVZeBXA8RKxZbrfb5XJlZGSkp6enpaWtsD86CzoXOiM6Lzo79YQBACA0iFizcnNzs7OzacK3b98+SqaN9kdnQedCZ0TnRWennjAAAIQGEWtWfn5+Tk5OVlYWZRLN/HbaH50FnQudEZ0XnZ16wgAAEBpErFkFBQU01aM0ojmfy+U6aH90FnQudEZ0XnR26gkDAEBoELFmFRYWUg7RbI8Cye1259gfnQWdC50RnRednXrCAAAQGkQsAACAJRCxAAAAlkDEAgAAWAIRCwAAYAlELAAAgCUQsQAAAJZAxAIAAFgCEQsAAGAJR0Vsqb/ygVrUoha1Si2AdRwVsQAAANEDEQsAAGAJRCwAAIAlELEAAACWQMQCAABYAhELAABgCUQsAACAJRCxAAAAlkDEAgAAWAIRCwAAYAlELAAAgCUQsQAAAJZAxAIAAFgCEfurunXryr/FAWBT1JNjsFfLZw0QPRCxv6KrVNwDAPZFPdntdufm5ubn58dOr5bPuqCgoLCwUL3CAa4GXxcVS2qT2BA7gxE4G/Vkl8uVnZ2dk5MTO71aPmsKWkpZ9QoHuBp8XVQsqU1iQ+wMRuBs1JMzMjIOHjyYlZUVO71aPmtKWZrLqlc4wNXg66JiSW0SG2JnMAJno56cnp6+b98+ypvY6dXyWdNcliay6hUOcDX4uqhYUpvEhtgZjMDZqCenpaVR3tCsLnZ6tXzWLpfL7XarVzjA1eDromJJbRIbYmcwAmejnrxixYqNGzfu3Lkzdnq1fNY0kc3JyVGvcICrwddFxZLaJDYYD0anT5+uWLGi5jV06FC12gTe9qabblIrQrZ06dKZXmqFV2Zm5qRJk9q2bZuQkFCpUqXWrVs/+OCD3333ndou3IxvVdiF63DKw8Sr5JVXXtFrE175+fktWrSg/S9evJhLhg0bRqv33nvvlQ11aU6M2MmTJ3fu3LlcuXJ856vViFiIVr4uKpbUJrEh4HUrLFq0iK9tUq1aNRoH1Ral4W2tGJdpn7xztcLj2bx5c82aNcUtF0KPolIZ3CorhOtwvBP/iKXYKywsDNgmvJ566inaeaNGjQoKCrhk7969VBIXF0fhcWXbwDQnRqx4IJhajYiFaOXromJJbRIbAl63Qr9+/eQrfPXq1WqL0vCGVozLeuly5MgRztfKlSu//PLLJ0+evHDhAo3XjzzyyN/+9jelcdjp3SrFuXPn1KKgmDxcqXgn/hGreUfwgG3CiO6N2rVr084nTZokl7dv354Kb731VrlQD99Uh0Xs+PHj16xZ061bN77z1WpELEQrXxcVS2qT2BDwumWnTp2qUKECNbjrrrsormjh7rvvVtr4D7tKiX8D2Q8//PD73/++SZMmFStWjI+Pb9eu3UsvvVRc8vBkZ2cPHz6cZjZ0MxISElJSUu6991632+3xe3bPeKuJEyfy6pIlS0qO86tLly7xAsXwiBEjkpKS6Li0//vvv//w4cOiGW9Ot/mNN96gaRzdsP79+9PgxbXB3Spepn0uXLiwadOmNDlTynnVPzLpuFOmTGnTpg3dDDrcDTfc8N5778nbKsSG8jnSPTxhwoQzZ86I2vfffz85OZke1h49enz99de8rfKolS9fnv6nI8qFeo+scstF7dKlS5s1a1a1atWhQ4fSDVi/fn3btm3pXLp27ZqRkcGNFy9ezO3T09O5hM2aNYsKy5Url5WVJZcHpDkxYpl/rxDks0bEQvTwdVGxpDaJDQGvW0ZhwBc2TV4pY2iBhvi8vDy5DTcIOmK3bt3KDWSUslybmpqq1mnaTz/95DFMF0oOzfvFcuIVTgVlT4MGDZRt69evL1KWS2rUqCE3GD16NNcGd6t4uVatWgHL9YLq2LFjzZs3F5sw8XK3Us64KuA5du7c+fz581S7e/du8RY7adiwIS8ojxqlLz2ToIWPPvpIFOo9sgEjluam9GSClwnNxji2GWUtNx40aBCt0k26cOEClzBKDm65YMECuTwgDRGLiIWo4euiYkltEhsCXresb9++VEsTjtzc3Pnz5/NFvmrVKrkNFwYdsZmZmdu2baMpIMXhjz/+SNMdakxzWa7lGGjduvWJEycKCgr279//7LPP0jLX6o07VapUocLu3bsr5QLNQXlDeg5BY7p4JkFzWW7Aq5r3ZGn+xLlI00GuDe5WiX1Onz6dnqaID15xoV5QUa7z6qhRoyhuKSDpScmGDRu41r+9wOfYuHHjvXv30jmuWbOGm82bN89TEmmad3SmGzN27Fhe9X/U5s6dSwvUE+RCpQ2vBoxY8vbbb//888/8OjChyTR1pz59+vAq3w80radlem7E2wr8JRKa9/SVKn8aIhYRC1HD10XFktokNgS8bgllBk84brnlFo802NHorDY1xFvpRezZs2dpzL322mv5FWlGoc61rVq10rxvqT700EOvvfYazb2KiorEtnrjTqkRy5M2ykhRQsua97M2vMq7FQ1oV5r35UpeDe5WcSEdWm4syvWCiieRlO56M3K9w/GG/gYPHky19erV06RIEw+uf3zSsx+eze/Zs0evDa8GjNg2bdrwKt+HhJ5U0ers2bN5lZ4xeEqetfg/ZPSUgpv1799fqfKnIWIRsRA1fF1ULKlNYkPA65aIaevUqVMzvDhaKMBoFqK21sc70YtY/sMMf1xL46/yMinF3oEDB7hWb9wp9YVijvPU1FRR0qtXLyqhcl7l3dJMi1eVAwV3q7iQDhSwXNw/YnrHq3xT/bcS9A4nP2WR8XyUnzz17t2bG9MdxbUB4/PRRx+l5SFDhhi08fjdcl72vw+LvdfenDlzeHXTpk0e/YjlL/TXELE6j7IHEQvRytdFxZLaJDYEvG4Jjb98Vftbvny52lofb6IXsdWrV6faa6655siRI7Qa8JOT33777dq1a8WHmIYPH87l/Dq20tgjfdxp6dKlShV/3IlnsWKC5SmZxVI5r/LmevMzVtZbpexT4D957NmzJ6+mpKTIm9P8VfO+3qv3dEHvcHyOHKiyYm/X51ksHYsLDWaxtPzzzz9XqlRJvIcq2hjfcqWxch8qEav3QjFNebkZXiiW7z2ZfNaIWIgevi4qltQmsSHgdXvs2DH5YymK2267TbTkEjk5lBJe7dSp0wdX4tqEhASqbdas2cmTJ2mYEAfl2kmTJn3yySdut5uiUXwwasCAAVw7cOBALvnyyy+5hNG4zH+0QxPuV1999dSpUxcuXKA2EyZM4D/auf/++3nD1157raCggP7n1fvuu4/3wKt68RDcrVL2KfArupR5Z86c2bZtGzfTSo4l3osdM2bM8ePH6US2b98uvxerdzh+LzYuLm7hwoU0F6SdU5gNHTr0rbfeoto777yTt1q5ciXVGrwXy6sjR47kErnQ+JYrjY0jVnzcSfxRLKN+ws1i9uNOJ73oeQzfD7xKRAP5rBGxED18XVQsqU1iQ8DB6JVXXuFL+sUXX5TLO3bsqHnfhjx79iyXcLNSI9Yf11JaixIaYWk6K9eKKtnLL7/MtfxJHBmXe7xfPaF8HpjxZ3EPHz7M0zhZYmIifyrY43cKSjz4tpGUeqt42T9iaX7GVdWqVaNnGPxGstjK+BPFHv3DuVwu/08Ua97h2OP3ieI6derwgl7E0pRdfDBYFBrfcqWxccQuWbKEV3fs2MENGJ2pFtt/tMN3iz+5ASIWopCvi4oltUlskC9XgZ8107iZnZ0tl4uR8c033+QSXg06Ymn//fr1q1SpUosWLVavXq0MxFOmTOnatWvt2rVpkKX5bpcuXWhWylUe72dhaJSnaBSjv6jylHyBYkpKCg39tP9WrVrRjFB8jpdSluayDRs2rFChAv1/7733inz1+J1CWG6Vsk+BxkSaAcfHxzdt2pRmnMqxuAH/XSydBT256dChw/r160Wt3uE83nuAqpo0aULnWL16dbrNs2bNoqkw19JUODk5mY7brVs3mgErN8//1t5+++1KofEtVxobR+y5c+c45ulMuQFr166dFttfPcH3kj+5ASIWopCvi4oltUlskC9XgKuFv0AxKSnp4sWLXCI+w/zFF19c2TYwOWxip1cjYiE6+bqoWFKbxIbYGYwgmuXn5/NL4uI7uf7whz9oMf8zAKVCxEJ08nVRsaQ2iQ2xMxiBsyFiEbEQPXxdVCypTWJD7AxG4GyIWEQsRA9fFxVLapPYEDuDETgbIhYRC9HD10XFktokNsTOYATOhohFxEL08HVRsaQ2iQ2xMxiBsyFiEbEQPXxdVCypTWJD3bp1NQD7q1q1qggb+UcDnU0+a0QsRA9ErI/b7Xa5XBkZGenp6WlpaSsA7Il6L/Vh6smuErHQq+WzpmtZvbwBrgZErE9ubm52djY9Bd63bx9dqxsB7Il6L/Vh6snZJWKhV8tnTdeyenkDXA2IWJ/8/PycnJysrCy6Sum58E4Ae6LeS32YenJOiVjo1fJZ07WsXt4AVwMi9ld4LxacoVatWi6Xi2ZylDR1vT+SGAvks6YpbEFBgXqFA1wNiNhfaTHz2UtwNurJImwu9+q33oqFf/JZI2IhevguTLGkNokNiFhwBkQsIhaih+/CFEtqk9iAiAVnoJ4s3pWMqYjFe7EQhXwXplhSm8QGRCw4A/Vk8dnamIpYfKIYopDvwhRLapPYYByxp0+frlixouY1dOhQtdoE3tb/p8hDt3Tp0pleSjkfUfP+pHzNmjXbtWs3btw48WPsodM7rkXCdTjlgRD30iuvvKLXJrxogtWiRQva/+LFi7lk2LBhWll+rs4Y7Ur8hajmlIidfOutnZs3LxcXxw+NfwP5rPF3sRA9fBemWFKbxIbL162+RYsW8bVNqlWrRqOk2qI0vK0Vozbtk3eulIsbLKtcufLatWuVlsHRO65FwnU43ol/xFLsFRYWBmwTXvyj640aNSooKOCSvXv3UklcXNzOnTuvbBsMTfkCRb80suM/8TCxgA3EWePbnSB6+C5MsaQ2iQ2Xr1t9/fr1k6/w1atXqy1KwxtaMWrrZY98xBMnTixYsICeHGjer5o7dOiQ0jgIesdVnDt3Ti0KisnDlUq+W8QqozE6YJswonujdu3atPNJkybJ5e3bt6fCW2+9VS4MDp+IwyJ2/C23rJk8uVubNvzQ+DeQzxoRC9HDd2GKJbVJbLh83eo4depUhQoVqMFdd91Fs0BauPvuu5U2/oOyUuLfQPbDDz/8/ve/b9KkScWKFePj49u1a/fSSy8Vlzw82dnZw4cPp3kP3YyEhISUlJR7773X7XZ7dKaqvBUvy0d8++23uXDChAmi8MiRIyNGjEhKSqJD0w2gqjNnznBViMdduHBh06ZNaXKmlPOqf2TSsDhlypQ2bdrQPUCHu+GGG9577z15W4XY0OAUyPvvv5+cnEwPXI8ePb7++mveVnlcypcvT//TEeVCvcdOueWidunSpc2aNaNnMEOHDqUbsH79+rZt29K5dO3aNSMjgxsvXryY26enp3MJmzVrFhWWK1cuKytLLg+C5sSI5X83eZ+IBDwp+awRsRA9fBemWFKbxIbL160Oigq+sGny2r9/f1qgAMjLy5PbcIOgI3br1q3cQEYpy7Wpqalqnab99NNPHsPs4WX5iHSa9evXp8LrrruOSyicGjRocMXGmta5c+fz5897Qjuu/AX0crleUB07dqx58+ZiEybeeVXKGVcZn8Lu3bvFm+ikYcOGvKA8LpS+9EyCFj766CNRqPfYBYxYmpvGlbxTSLp168axzShrufGgQYNolW7ShQsXuIRRNnDLBQsWyOVB0BCxiFiIGr4LUyypTWLD5etWR9++famWpiO5ubnz58/ni3zVqlVyGy4MOmIzMzO3bdtGE8TCwsIff/yRJkPUmOayXMsh0bp16xMnThQUFOzfv//ZZ5+lZa5VRnwh4BG7d+9OhVWqVOFVmqTSauPGjffu3UuD/po1a3irefPmeUI7Lpk+fTo9EREfsOJCvaAaPXo0r44aNYrilgKSnnZs2LCBa/3bC8anwJGmecdfujFjx47lVf/HZe7cubRAj7VcqLTh1YARS95+++2ff/6ZXwfWvC8VUIfp06cPr/L9QNN6WqZZNW8r8B/YaN7TV6rKSkPEImIhavguTLGkNokNl6/bQChReDpyyy23eKShkMZutakh3kovYs+ePUsj8rXXXsuvSDMKda5t1aqV5v2k0kMPPfTaa6/RzKyoqEhsq5c9AY+oRCxP3fwNHjzYE9pxab4oNxblekHFtyQpKUl85kihdzjjU6hXr54mRZp4+Pzjk57f1KhRg5b37Nmj14ZXA0ZsmzZteJXvYUJPm2h19uzZvErPGDwlz1qoDTcW6CkFN+vfv79SVVYaIhYRC1HDd2GKJbVJbLh83QYipq1Tp07N8OLgoZSiOYraWh/vRC9i+c82/HEtjc7Ki6g0szxw4ADX6mUPF8pHpNNUIkdOdBlP5kI5bq9evQKWi9sjpne8yrfEfytB73DGp8BPj3r37s2NKb+5NmB8Pvroo7Q8ZMgQgzYev1vOy1TIq+J2Fnuvrjlz5vDqpk2bPPoRm5+fz80QsQb/ELFgO74LUyypTWLD5es2EBqd+ar2t3z5crW1Pt5EL2Kre7+u/Zprrjly5AitduvWjdvLbb799tu1a9dOnDiRq4YPH87l/Dq20tgT6Iji406PPPIIl/B7k5xGsmKpZ4R+XFauXDkq79mzJ6+mpKTIm9P8VfO+3qs3i9U7nPEp8FMKOhYXGsxiafnnn3+uVKmSeA9VtDG+5Upj5amAErF6LxTTlJeb4YVig3+IWLAd34UpltQmseHydevn2LFj8odWFLfddptoySVyriglvNqpU6cPrsS1CQkJVNusWbOTJ0/SMCEOyrWTJk365JNP3G73pUuXxAejBgwYwLUDBw7kki+//JJLGBfyDaDdLly4kIO8WrVq/JElT8kbmXFxcVRLE6kzZ85QEgwdOvQtGrbCcVwZv6JLmUdH2bZtGzfTSs5RvBc7ZsyY48ePX7hwYfv27fJ7sXqHMz6FO++8k7dauXIl1Rq8F8urI0eO5BK50PiWK42NI1Z83En8USyjnsDN8HGngP9OLlpE/3qWPLnhVfonGshnjYiF6OG7MMWS2iQ2XB6M/Lzyyit8Sb/44otyeceOHTXvm5Rnz57lEm5WasT641pKa1FC4y9NZ+VaUSV7+eWXuZY/pyMz2KpKlSrvvvsuNyAul8v/47iad7TS24PJ4/pHLM3PuIoynp5D0C2RtzL+RLFH/3DGp6B8orhOnTq8oBexNGUXHwwWhca3XGlsHLFLlizh1R07dnADRmeq4Y929P/xneZPboCIhSjkuzDFktokNly+XP307NlT8/7RZHZ2tlwuxs0333yTS3g16Iil/ffr169SpUotWrRYvXq1MkxPmTKla9eutWvXpiGY5rtdunR59dVXucrj/aQMZUBiYqLIBi4Xh6CtxBcofv/992JDlpmZSZs3adKkQoUKNM2lA82aNYvmkZ7QjusfsTTq0Qw4Pj6+adOmNONUzpEb8N/F0v1AT186dOiwfv16Uat3OI/hKRCaCicnJ9Nxu3XrRjNg5eb539rbb79dKTS+5Upj44g9d+4cxzydKTdg9Oho+OoJ/X98H/qTGyBiIQr5LkyxpDaJDZcvVwDr8RcoJiUlXbx4kUvEZ5i/+OKLK9sGQw4bOYSc/Q8RC9HJd2GKJbVJbEDEQmTk5+fzS+JLlizhkj/84Q9aWH8GABGLiIUo4bswxZLaJDYgYsEZELGIWIgevgtTLKlNYgMiFpwBEYuIhejhuzDFktokNiBiwRkQsYhYiB6+C1MsqU1iAyIWnAERi4iF6OG7MMWS2iQ2IGLBGRCxiFiIHr4LUyypTWIDIhacARGLiIXo4bswxZLaJDYgYsEZELGIWIgevgtTLKlNYkPdunU1APurWrWqCJtatWqp1Q4lnzUiFqIHItbH7Xa7XK6MjIz09PS0tLQVAPZEvZf6MPVkV4lY6NXyWdO1rF7eAFcDItYnNzc3OzubngLv27ePrtWNAPZEvZf6MPXk7BKx0Kvls6ZrWb28Aa4GRKxPfn5+Tk5OVlYWXaX0XHgngD1R76U+TD05p0Qs9Gr5rOlaVi9vgKsBEetTUFBAT37p+qRnwS6X6yCAPVHvpT5MPTm3RCz0avms6VpWL2+AqwER61NYWEhXJj3/pUvU7XaLGQCAvVDvpT5MPbmgRCz0avms6VpWL2+AqwERCwAAYAlELAAAgCUQsQAAAJZAxAIAAFgCEQsAAGAJRCwAAIAlELEAAACWQMQCAABYAhELAABgCUQsAACAJRCxAAAAlkDEAgAAWAIRCwAAYAlELAAAgCUQsQAAAJZAxAIAAFgCEQsAAGAJRCwAAIAlELEAAACWQMQCAABYAhELAABgCUQsAACAJRCxAAAAlkDEAgAAWAIRCwAAYAlELAAAgCUCRCwAAACEESIWAADAEohYAAAAS/x/oe59K0HV4iwAAAAASUVORK5CYII=" />
</p>
<div class="sourceCode" id="cb601"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb601-1"><a href="#cb601-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/shared_ptr_ownership_ut.cpp 120</span></span>
<span id="cb601-2"><a href="#cb601-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb601-3"><a href="#cb601-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ステップ６</span></span>
<span id="cb601-4"><a href="#cb601-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 現時点でx0はA{0}オブジェクトを保持している。</span></span>
<span id="cb601-5"><a href="#cb601-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">//</span></span>
<span id="cb601-6"><a href="#cb601-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ここでは、x0からx2、x3をそれぞれcopy、move生成し、</span></span>
<span id="cb601-7"><a href="#cb601-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">// この次のステップ７では、x2、x3がスコープアウトすることでA{0}を解放する。</span></span>
<span id="cb601-8"><a href="#cb601-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb601-9"><a href="#cb601-9" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="dv">0</span><span class="op">,</span> x0<span class="op">.</span>GetA<span class="op">()-&gt;</span>GetNum<span class="op">());</span>      <span class="co">// x0はA{0}を所有</span></span>
<span id="cb601-10"><a href="#cb601-10" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="dv">1</span><span class="op">,</span> x0<span class="op">.</span>UseCount<span class="op">());</span>            <span class="co">// A{0}の共有所有カウント数は1</span></span>
<span id="cb601-11"><a href="#cb601-11" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> x2 <span class="op">=</span> x0<span class="op">;</span>                           <span class="co">// x0からx2をcopy生成</span></span>
<span id="cb601-12"><a href="#cb601-12" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span>x0<span class="op">.</span>GetA<span class="op">(),</span> x2<span class="op">.</span>GetA<span class="op">());</span></span>
<span id="cb601-13"><a href="#cb601-13" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="dv">2</span><span class="op">,</span> x0<span class="op">.</span>UseCount<span class="op">());</span>            <span class="co">// A{0}の共有所有カウント数は２</span></span>
<span id="cb601-14"><a href="#cb601-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb601-15"><a href="#cb601-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> x3 <span class="op">=</span> <span class="bu">std::</span>move<span class="op">(</span>x0<span class="op">);</span>                <span class="co">// x0からx2をmove生成、x0はA{0}の所有を放棄</span></span>
<span id="cb601-16"><a href="#cb601-16" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="kw">nullptr</span><span class="op">,</span> x0<span class="op">.</span>GetA<span class="op">());</span></span>
<span id="cb601-17"><a href="#cb601-17" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="dv">0</span><span class="op">,</span> x2<span class="op">.</span>GetA<span class="op">()-&gt;</span>GetNum<span class="op">());</span>      <span class="co">// x2はA{0}を保有</span></span>
<span id="cb601-18"><a href="#cb601-18" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span>x2<span class="op">.</span>GetA<span class="op">(),</span> x3<span class="op">.</span>GetA<span class="op">());</span>        <span class="co">// x2、x3はA{0}を共有保有</span></span>
<span id="cb601-19"><a href="#cb601-19" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="dv">2</span><span class="op">,</span> x2<span class="op">.</span>UseCount<span class="op">());</span>            <span class="co">// A{1}の共有所有カウント数は２</span></span></code></pre></div>
<p>
<img src="data:image/png;base64,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zpTdZ555xu+tKerAefPmlZSUfP3111oDIopnjOAGkLDr16+f7I4cOdLw/B0Nc204ETxgwADZRb5LyY033iglwSO4S5culZWVWhURxT9GcANI3o0ZM0Z2g4csmgWp9bs7evRo2T179qyUXHnllVISPIIvv/xyrZyIbIER3ACSd4HWufK35kaNGiW7AwcONNdqx/rdDbIKHjt2rJTIrqLdDhHZCyO4AbS80yK4a9eu2O7UqZPL5Xr//felStVqx/rdhZdffrm0tPTOO++U3WeffVYaXH311VKye/duKTEfyAgmsilGcANoeadF8PTp02W3TZs2zZo1a9WqlblWO9bvLuLb/Geb1TciYOHChapc+L0dIrIXRnADaHmnRfCJEycmTJiQnJzcq1evZcuWabXasYF2169f379/f9xIenr63r17pRbKysoQ8R07dlTfWvN7O0RkL4zguMAkJUpMjOC4wAgmSkyM4LjACCZKTIxgIiLLMIKJiCzDCCYisgwjmIjIMoxgIiLLMIKJiCzDCCYisgwjmIjIMoxgIiLLMIIda/78+XoREcUZRrBjGT6/352I4g0j2LEYwUTxjxHsWIxgovjHCHYsRjBR/GMEOxY/jiOKf4xgIiLLMIKJiCzDCCYisgwjmIjIMoxgx+LHcUTxjxHsWPxSGlH8YwQ7FiOYKP4xgh2LEUwU/xjBjsUIJop/jGDH4sdxRPGPEUxEZBlGMBGRZRIigh999NH09PROnTolJSV16NDh2muv/de//qU3ipWSkpL/+I//6NWrV4sWLfA/tktLS/VG5BQbNmz49a9/jVHXrFmzdu3ajRw5ct26dXqjmHj++efne+gVPgyPK664Qq+wCUyoPn36oAsrV67U6wIIPitvvPFG3NrUqVNNR0RMQkSwDCkzTIZvv/1Wbxd9VVVVY8eO1R7Mb3/7W5TrTckR5syZo11uQC7r7aIPkSr3rlf4kGb2jWAsufD4u3btWl5ertf5U++s3LVrF0qaNGny6aef1j00AhIigrt3775kyZKCggKXyzVjxgw5xbNmzdLbRd9LL70k975w4cKysrLHH39cdl9++WW9adhCWe9QtG3cuPGdd97BwDt16tRf/vIXudzXX3+93i76EiSC3W53amoqHv/s2bP1ugBCmZWDBw9Gye9+9zvTcZHhhAh+88035ZTh3GG3srLyV7/6FXaR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" />
</p>
<div class="sourceCode" id="cb602"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb602-1"><a href="#cb602-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/shared_ptr_ownership_ut.cpp 142</span></span>
<span id="cb602-2"><a href="#cb602-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb602-3"><a href="#cb602-3" aria-hidden="true" tabindex="-1"></a>        <span class="co">// ステップ７</span></span>
<span id="cb602-4"><a href="#cb602-4" aria-hidden="true" tabindex="-1"></a>        <span class="co">// このブロックが終了することで、x2、x3はスコープアウトする。</span></span>
<span id="cb602-5"><a href="#cb602-5" aria-hidden="true" tabindex="-1"></a>        <span class="co">// デストラクタ呼び出しの順序はコンストラクタ呼び出しの逆になるため、</span></span>
<span id="cb602-6"><a href="#cb602-6" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 最初にx3::~X()が呼び出され、この延長でx3::ptr_のデストラクタが呼び出される。</span></span>
<span id="cb602-7"><a href="#cb602-7" aria-hidden="true" tabindex="-1"></a>        <span class="co">// これによりA{0}のの共有所有カウントは1になる。</span></span>
<span id="cb602-8"><a href="#cb602-8" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 次にx2::~X()が呼び出され、この延長でx2::ptr_のデストラクタが呼び出される。</span></span>
<span id="cb602-9"><a href="#cb602-9" aria-hidden="true" tabindex="-1"></a>        <span class="co">// これによりA{0}のの共有所有カウントは0になり、A{0}はdeleteされる。</span></span>
<span id="cb602-10"><a href="#cb602-10" aria-hidden="true" tabindex="-1"></a>        <span class="co">// </span></span>
<span id="cb602-11"><a href="#cb602-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>   <span class="co">// x2、x3のスコープアウト</span></span>
<span id="cb602-12"><a href="#cb602-12" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">0</span><span class="op">,</span> A<span class="op">::</span>LastDestructedNum<span class="op">());</span>  <span class="co">// A{0}が解放された</span></span>
<span id="cb602-13"><a href="#cb602-13" aria-hidden="true" tabindex="-1"></a>    </span></code></pre></div>
<p>
<img src="data:image/png;base64,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" />
</p>
<p>以上で示したstd::shared_ptrの仕様の要点をまとめると、以下のようになる。</p>
<ul>
<li>std::shared_ptrはダイナミックに生成されたオブジェクトを保持する。</li>
<li>ダイナミックに生成されたオブジェクトを保持するstd::shared_ptrがスコープアウトすると、
共有所有カウントはデクリメントされ、その値が0ならば保持しているオブジェクトはdeleteされる。</li>
<li>std::shared_ptrを他のstd::shared_ptrに、
<ul>
<li>moveすることことで、保持中のオブジェクトの所有権を移動できる。</li>
<li>copyすることことで、保持中のオブジェクトの所有権を共有できる。</li>
</ul></li>
<li>下記のようなコードはstd::shared_ptrの仕様が想定するセマンティクスに沿っておらず、
未定義動作に繋がる。</li>
</ul>
<div class="sourceCode" id="cb603"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb603-1"><a href="#cb603-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/shared_ptr_ownership_ut.cpp 162</span></span>
<span id="cb603-2"><a href="#cb603-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb603-3"><a href="#cb603-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 以下のようなコードを書いてはならない</span></span>
<span id="cb603-4"><a href="#cb603-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb603-5"><a href="#cb603-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> a0 <span class="op">=</span> <span class="bu">std::</span>make_shared<span class="op">&lt;</span>A<span class="op">&gt;(</span><span class="dv">0</span><span class="op">);</span></span>
<span id="cb603-6"><a href="#cb603-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> a1 <span class="op">=</span> <span class="bu">std::</span>shared_ptr<span class="op">&lt;</span>A<span class="op">&gt;{</span>a0<span class="op">.</span>get<span class="op">()};</span>  <span class="co">// a1もa0が保持するオブジェクトを保持するが、</span></span>
<span id="cb603-7"><a href="#cb603-7" aria-hidden="true" tabindex="-1"></a>                                             <span class="co">// 保持されたオブジェクトは二重解放される</span></span>
<span id="cb603-8"><a href="#cb603-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb603-9"><a href="#cb603-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> a_ptr <span class="op">=</span> <span class="kw">new</span> A<span class="op">{</span><span class="dv">0</span><span class="op">};</span></span>
<span id="cb603-10"><a href="#cb603-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb603-11"><a href="#cb603-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> a2 <span class="op">=</span> <span class="bu">std::</span>shared_ptr<span class="op">&lt;</span>A<span class="op">&gt;{</span>a_ptr<span class="op">};</span></span>
<span id="cb603-12"><a href="#cb603-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> a3 <span class="op">=</span> <span class="bu">std::</span>shared_ptr<span class="op">&lt;</span>A<span class="op">&gt;{</span>a_ptr<span class="op">};</span>  <span class="co">// a3もa2が保持するオブジェクトを保持するが、</span></span>
<span id="cb603-13"><a href="#cb603-13" aria-hidden="true" tabindex="-1"></a>                                          <span class="co">// 保持されたオブジェクトは二重解放される</span></span></code></pre></div>
<p>こういった機能によりstd::shared_ptrはオブジェクトの共有所有を実現している。</p>
<h3 id="オブジェクトのライフタイム">オブジェクトのライフタイム
<a id="SS_5_2_10"></a></h3>
<p>オブジェクトは、以下のような種類のライフタイムを持つ。</p>
<ul>
<li>静的に生成されたオブジェクトのライフタイム</li>
<li>thread_localに生成されたオブジェクトのライフタイム</li>
<li>newで生成されたオブジェクトのライフタイム</li>
<li>スタック上に生成されたオブジェクトのライフタイム</li>
<li>prvalue(「<a href="#SS_5_5_3">rvalue</a>」参照)のライフタイム</li>
</ul>
<p>なお、リファレンスの初期化をrvalueで行った場合、
そのrvalueはリファレンスがスコープを抜けるまで存続し続ける。</p>
<h3 id="クラスのレイアウト">クラスのレイアウト
<a id="SS_5_2_11"></a></h3>
<p>クラス(やそのクラスが継承した基底クラス)が仮想関数を持たない場合、
そのクラスは、非静的なメンバ変数が定義された順にメモリ上に配置されたレイアウトを持つ
(CPUアーキテクチャに依存したパディング領域が変数間に挿入されることもある)。
このようなクラスは<a href="#SS_5_1_6">POD</a> (C++20では、<a
href="https://cpprefjp.github.io/lang/cpp20/deprecate_pod.html">PODという用語は非推奨</a>
となり、トリビアル型とスタンダードレイアウト型に用語が分割された)とも呼ばれ、
C言語の構造体のレイアウトと互換性を持つことが一般的である。</p>
<p>クラス(やそのクラスが継承したクラス)が仮想関数を持つ場合、
仮想関数呼び出しを行う(「<a
href="#SS_5_10_1">オーバーライドとオーバーロードの違い</a>」参照)
ためのメモリレイアウトが必要になる。
それを示すために、まずは下記のようにクラスX、Y、Zを定義する。</p>
<div class="sourceCode" id="cb604"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb604-1"><a href="#cb604-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/class_layout_ut.cpp 4</span></span>
<span id="cb604-2"><a href="#cb604-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb604-3"><a href="#cb604-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> X <span class="op">{</span></span>
<span id="cb604-4"><a href="#cb604-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb604-5"><a href="#cb604-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">int64_t</span> GetX<span class="op">()</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">x_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb604-6"><a href="#cb604-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="op">~</span>X<span class="op">()</span> <span class="op">{}</span></span>
<span id="cb604-7"><a href="#cb604-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb604-8"><a href="#cb604-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb604-9"><a href="#cb604-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int64_t</span> <span class="va">x_</span><span class="op">{</span><span class="dv">1</span><span class="op">};</span></span>
<span id="cb604-10"><a href="#cb604-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb604-11"><a href="#cb604-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb604-12"><a href="#cb604-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Y <span class="op">:</span> <span class="kw">public</span> X <span class="op">{</span></span>
<span id="cb604-13"><a href="#cb604-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb604-14"><a href="#cb604-14" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">int64_t</span> GetX<span class="op">()</span> <span class="kw">override</span> <span class="op">{</span> <span class="cf">return</span> X<span class="op">::</span>GetX<span class="op">()</span> <span class="op">+</span> <span class="va">y_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb604-15"><a href="#cb604-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">int64_t</span> GetY<span class="op">()</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">y_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb604-16"><a href="#cb604-16" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="op">~</span>Y<span class="op">()</span> <span class="kw">override</span> <span class="op">{}</span></span>
<span id="cb604-17"><a href="#cb604-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb604-18"><a href="#cb604-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb604-19"><a href="#cb604-19" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int64_t</span> <span class="va">y_</span><span class="op">{</span><span class="dv">2</span><span class="op">};</span></span>
<span id="cb604-20"><a href="#cb604-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb604-21"><a href="#cb604-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb604-22"><a href="#cb604-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Z <span class="op">:</span> <span class="kw">public</span> Y <span class="op">{</span></span>
<span id="cb604-23"><a href="#cb604-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb604-24"><a href="#cb604-24" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">int64_t</span> GetX<span class="op">()</span> <span class="kw">override</span> <span class="op">{</span> <span class="cf">return</span> Y<span class="op">::</span>GetX<span class="op">()</span> <span class="op">+</span> <span class="va">z_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb604-25"><a href="#cb604-25" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">int64_t</span> GetY<span class="op">()</span> <span class="kw">override</span> <span class="op">{</span> <span class="cf">return</span> Y<span class="op">::</span>GetY<span class="op">()</span> <span class="op">+</span> <span class="va">z_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb604-26"><a href="#cb604-26" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">int64_t</span> GetZ<span class="op">()</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">z_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb604-27"><a href="#cb604-27" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="op">~</span>Z<span class="op">()</span> <span class="kw">override</span> <span class="op">{}</span></span>
<span id="cb604-28"><a href="#cb604-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb604-29"><a href="#cb604-29" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb604-30"><a href="#cb604-30" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int64_t</span> <span class="va">z_</span><span class="op">{</span><span class="dv">3</span><span class="op">};</span></span>
<span id="cb604-31"><a href="#cb604-31" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>通常のC++コンパイラが作り出すX、Y、Zの概念的なメモリレイアウトは下記のようになる。</p>
<p>
<img src="data:image/png;base64,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" />
</p>
<p>各クラスがvtblへのポインタを保持するため、このドキュメントで使用している<a
href="#SS_5_9_1">g++</a>では、
sizeof(X)は8ではなく16、sizeof(Y)は16ではなく24、sizeof(Z)は24ではなく32となる。</p>
<p>g++の場合、以下のオプションを使用し、クラスのメモリレイアウトをファイルに出力することができる。</p>
<div class="sourceCode" id="cb605"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb605-1"><a href="#cb605-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/Makefile 19</span></span>
<span id="cb605-2"><a href="#cb605-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb605-3"><a href="#cb605-3" aria-hidden="true" tabindex="-1"></a>    CCFLAGS_ADD<span class="op">:=-</span>fdump<span class="op">-</span>lang<span class="op">-</span><span class="kw">class</span></span></code></pre></div>
<p>X、Y、Zのメモリレイアウトは以下の様に出力される。</p>
<pre><code>    Vtable for X
    X::_ZTV1X: 5 entries
    0     (int (*)(...))0
    8     (int (*)(...))(&amp; _ZTI1X)
    16    (int (*)(...))X::GetX
    24    (int (*)(...))X::~X
    32    (int (*)(...))X::~X

    Class X
       size=16 align=8
       base size=16 base align=8
    X (0x0x7f54bbc23a80) 0
        vptr=((&amp; X::_ZTV1X) + 16)

    Vtable for Y
    Y::_ZTV1Y: 6 entries
    0     (int (*)(...))0
    8     (int (*)(...))(&amp; _ZTI1Y)
    16    (int (*)(...))Y::GetX
    24    (int (*)(...))Y::~Y
    32    (int (*)(...))Y::~Y
    40    (int (*)(...))Y::GetY

    Class Y
       size=24 align=8
       base size=24 base align=8
    Y (0x0x7f54bbc3f000) 0
        vptr=((&amp; Y::_ZTV1Y) + 16)
      X (0x0x7f54bbc23d20) 0
          primary-for Y (0x0x7f54bbc3f000)

    Vtable for Z
    Z::_ZTV1Z: 7 entries
    0     (int (*)(...))0
    8     (int (*)(...))(&amp; _ZTI1Z)
    16    (int (*)(...))Z::GetX
    24    (int (*)(...))Z::~Z
    32    (int (*)(...))Z::~Z
    40    (int (*)(...))Z::GetY
    48    (int (*)(...))Z::GetZ

    Class Z
       size=32 align=8
       base size=32 base align=8
    Z (0x0x7f54bbc3f068) 0
        vptr=((&amp; Z::_ZTV1Z) + 16)
      Y (0x0x7f54bbc3f0d0) 0
          primary-for Z (0x0x7f54bbc3f068)
        X (0x0x7f54bbc43060) 0
            primary-for Y (0x0x7f54bbc3f0d0)</code></pre>
<p>このようなメモリレイアウトは、</p>
<div class="sourceCode" id="cb607"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb607-1"><a href="#cb607-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/class_layout_ut.cpp 40</span></span>
<span id="cb607-2"><a href="#cb607-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb607-3"><a href="#cb607-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> z_ptr <span class="op">=</span> <span class="kw">new</span> Z<span class="op">;</span></span></code></pre></div>
<p>のようなオブジェクト生成に密接に関係する。その手順を下記の疑似コードにより示す。</p>
<div class="sourceCode" id="cb608"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb608-1"><a href="#cb608-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ステップ1  メモリアロケーション</span></span>
<span id="cb608-2"><a href="#cb608-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span><span class="op">*</span> ptr <span class="op">=</span> malloc<span class="op">(</span><span class="kw">sizeof</span><span class="op">(</span>Z<span class="op">));</span></span>
<span id="cb608-3"><a href="#cb608-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb608-4"><a href="#cb608-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ステップ2  ZオブジェクトのX部分の初期化</span></span>
<span id="cb608-5"><a href="#cb608-5" aria-hidden="true" tabindex="-1"></a>    X<span class="op">*</span> x_ptr <span class="op">=</span> <span class="op">(</span>X<span class="op">*)</span>ptr<span class="op">;</span></span>
<span id="cb608-6"><a href="#cb608-6" aria-hidden="true" tabindex="-1"></a>    x_ptr<span class="op">-&gt;</span>vtbl <span class="op">=</span> <span class="op">&amp;</span>vtbl_for_X       <span class="co">// Xのコンストラクタ呼び出し処理</span></span>
<span id="cb608-7"><a href="#cb608-7" aria-hidden="true" tabindex="-1"></a>    x_ptr<span class="op">-&gt;</span><span class="va">x_</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span>                  <span class="co">// Xのコンストラクタ呼び出し処理</span></span>
<span id="cb608-8"><a href="#cb608-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb608-9"><a href="#cb608-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ステップ3  ZオブジェクトのY部分の初期化</span></span>
<span id="cb608-10"><a href="#cb608-10" aria-hidden="true" tabindex="-1"></a>    Y<span class="op">*</span> y_ptr <span class="op">=</span> <span class="op">(</span>Y<span class="op">*)</span>ptr<span class="op">;</span></span>
<span id="cb608-11"><a href="#cb608-11" aria-hidden="true" tabindex="-1"></a>    y_ptr<span class="op">-&gt;</span>vtbl <span class="op">=</span> <span class="op">&amp;</span>vtbl_for_Y       <span class="co">// Yのコンストラクタ呼び出し処理</span></span>
<span id="cb608-12"><a href="#cb608-12" aria-hidden="true" tabindex="-1"></a>    y_ptr<span class="op">-&gt;</span><span class="va">y_</span> <span class="op">=</span> <span class="dv">2</span><span class="op">;</span>                  <span class="co">// Yのコンストラクタ呼び出し処理</span></span>
<span id="cb608-13"><a href="#cb608-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb608-14"><a href="#cb608-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ステップ4  ZオブジェクトのZ部分の初期化</span></span>
<span id="cb608-15"><a href="#cb608-15" aria-hidden="true" tabindex="-1"></a>    Z<span class="op">*</span> z_ptr <span class="op">=</span> <span class="op">(</span>Z<span class="op">*)</span>ptr<span class="op">;</span></span>
<span id="cb608-16"><a href="#cb608-16" aria-hidden="true" tabindex="-1"></a>    z_ptr<span class="op">-&gt;</span>vtbl <span class="op">=</span> <span class="op">&amp;</span>vtbl_for_Z       <span class="co">// Zのコンストラクタ呼び出し処理</span></span>
<span id="cb608-17"><a href="#cb608-17" aria-hidden="true" tabindex="-1"></a>    z_ptr<span class="op">-&gt;</span><span class="va">z_</span> <span class="op">=</span> <span class="dv">3</span><span class="op">;</span>                  <span class="co">// Zのコンストラクタ呼び出し処理</span></span></code></pre></div>
<p>オブジェクトの生成がこのように行われるため、Xのコンストラクタ内で仮想関数GetX()を呼び出した場合、
その時のvtblへのポインタはXのvtblを指しており(上記ステップ2)、X::GetX()の呼び出しとなる
(Z::GetX()の呼び出しとはならない)。</p>
<p>なお、オブジェクトの解放は生成とは逆の順番で行われる。</p>
<h2 id="オブジェクトのコピー">オブジェクトのコピー
<a id="SS_5_3"></a></h2>
<h3 id="シャローコピー">シャローコピー <a id="SS_5_3_1"></a></h3>
<p>シャローコピー(浅いコピー)とは、暗黙的、
もしくは=defaultによってコンパイラが生成するようなcopyコンストラクタ、
copy代入演算子が行うコピーであり、<a
href="#SS_5_3_2">ディープコピー</a>と対比的に使われる概念である。</p>
<p>以下のクラスShallowOKには、コンパイラが生成するcopyコンストラクタ、
copy代入演算子と同等なものを定義したが、これは問題のないシャローコピーである
(が、正しく自動生成される関数を実装すると、メンバ変数が増えた際にバグを生み出すことがあるため、
実践的にはこのようなことはすべきではない)。</p>
<div class="sourceCode" id="cb609"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb609-1"><a href="#cb609-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/deep_shallow_copy_ut.cpp 7</span></span>
<span id="cb609-2"><a href="#cb609-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb609-3"><a href="#cb609-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> ShallowOK <span class="op">{</span></span>
<span id="cb609-4"><a href="#cb609-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb609-5"><a href="#cb609-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> ShallowOK<span class="op">(</span><span class="dt">char</span> <span class="at">const</span><span class="op">*</span> str <span class="op">=</span> <span class="st">&quot;&quot;</span><span class="op">)</span> <span class="op">:</span> <span class="va">str_</span><span class="op">{</span><span class="bu">std::</span>string<span class="op">{</span>str<span class="op">}}</span> <span class="op">{}</span></span>
<span id="cb609-6"><a href="#cb609-6" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span><span class="op">&amp;</span> GetString<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">str_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb609-7"><a href="#cb609-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb609-8"><a href="#cb609-8" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 下記2関数を定義しなければ、以下と同等なcopyコンストラクタ、copy代入演算子が定義される。</span></span>
<span id="cb609-9"><a href="#cb609-9" aria-hidden="true" tabindex="-1"></a>        ShallowOK<span class="op">(</span>ShallowOK <span class="at">const</span><span class="op">&amp;</span> rhs<span class="op">)</span> <span class="op">:</span> <span class="va">str_</span><span class="op">{</span>rhs<span class="op">.</span><span class="va">str_</span><span class="op">}</span> <span class="op">{}</span></span>
<span id="cb609-10"><a href="#cb609-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb609-11"><a href="#cb609-11" aria-hidden="true" tabindex="-1"></a>        ShallowOK<span class="op">&amp;</span> <span class="kw">operator</span><span class="op">=(</span>ShallowOK <span class="at">const</span><span class="op">&amp;</span> rhs<span class="op">)</span></span>
<span id="cb609-12"><a href="#cb609-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb609-13"><a href="#cb609-13" aria-hidden="true" tabindex="-1"></a>            <span class="va">str_</span> <span class="op">=</span> rhs<span class="op">.</span><span class="va">str_</span><span class="op">;</span></span>
<span id="cb609-14"><a href="#cb609-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="op">*</span><span class="kw">this</span><span class="op">;</span></span>
<span id="cb609-15"><a href="#cb609-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb609-16"><a href="#cb609-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb609-17"><a href="#cb609-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb609-18"><a href="#cb609-18" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span><span class="va">str_</span><span class="op">;</span></span>
<span id="cb609-19"><a href="#cb609-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>コンストラクタでポインタのようなリソースを確保し、
デストラクタでそれらを解放するようなクラスの場合、シャローコピーは良く知られた問題を起こす。</p>
<p>下記のShallowNGはその例である。</p>
<div class="sourceCode" id="cb610"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb610-1"><a href="#cb610-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/deep_shallow_copy_ut.cpp 43</span></span>
<span id="cb610-2"><a href="#cb610-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb610-3"><a href="#cb610-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> ShallowNG <span class="op">{</span></span>
<span id="cb610-4"><a href="#cb610-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb610-5"><a href="#cb610-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> ShallowNG<span class="op">(</span><span class="dt">char</span> <span class="at">const</span><span class="op">*</span> str <span class="op">=</span> <span class="st">&quot;&quot;</span><span class="op">)</span> <span class="op">:</span> <span class="va">str_</span><span class="op">{</span><span class="kw">new</span> <span class="bu">std::</span>string<span class="op">{</span>str<span class="op">}}</span> <span class="op">{}</span></span>
<span id="cb610-6"><a href="#cb610-6" aria-hidden="true" tabindex="-1"></a>        <span class="op">~</span>ShallowNG<span class="op">()</span> <span class="op">{</span> <span class="kw">delete</span> <span class="va">str_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb610-7"><a href="#cb610-7" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span><span class="op">&amp;</span> GetString<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="op">*</span><span class="va">str_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb610-8"><a href="#cb610-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb610-9"><a href="#cb610-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb610-10"><a href="#cb610-10" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op">*</span> <span class="va">str_</span><span class="op">;</span></span>
<span id="cb610-11"><a href="#cb610-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>シャローコピーにより、メンバで保持していたポインタ(ポインタが指しているオブジェクトではない)
がコピーされてしまうため、下記のコード内のコメントで示した通り、
メモリリークや2重解放を起こしてしまう。</p>
<div class="sourceCode" id="cb611"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb611-1"><a href="#cb611-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/deep_shallow_copy_ut.cpp 60</span></span>
<span id="cb611-2"><a href="#cb611-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb611-3"><a href="#cb611-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> <span class="at">const</span> s0 <span class="op">=</span> ShallowNG<span class="op">{</span><span class="st">&quot;s0&quot;</span><span class="op">};</span></span>
<span id="cb611-4"><a href="#cb611-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb611-5"><a href="#cb611-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// NG s0.str_とs1.str_は同じメモリを指すため~ShallowNG()に2重解放される。</span></span>
<span id="cb611-6"><a href="#cb611-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> <span class="at">const</span> s1 <span class="op">=</span> ShallowNG<span class="op">{</span>s0<span class="op">};</span></span>
<span id="cb611-7"><a href="#cb611-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb611-8"><a href="#cb611-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> s2 <span class="op">=</span> ShallowNG<span class="op">{</span><span class="st">&quot;s2&quot;</span><span class="op">};</span></span>
<span id="cb611-9"><a href="#cb611-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb611-10"><a href="#cb611-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">// NG s2.str_が元々保持していたメモリは、解放できなくなる。</span></span>
<span id="cb611-11"><a href="#cb611-11" aria-hidden="true" tabindex="-1"></a>    s2 <span class="op">=</span> s0<span class="op">;</span></span>
<span id="cb611-12"><a href="#cb611-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb611-13"><a href="#cb611-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">// NG s0.str_とs2.str_は同じメモリを指すため、</span></span>
<span id="cb611-14"><a href="#cb611-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">//    s0、s2のスコープアウト時に、~ShallowNG()により、2重解放される。</span></span></code></pre></div>
<h3 id="ディープコピー">ディープコピー <a id="SS_5_3_2"></a></h3>
<p>ディープコピーとは、<a
href="#SS_5_3_1">シャローコピー</a>が発生させる問題を回避したコピーである。</p>
<p>以下に例を示す。</p>
<div class="sourceCode" id="cb612"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb612-1"><a href="#cb612-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/deep_shallow_copy_ut.cpp 79</span></span>
<span id="cb612-2"><a href="#cb612-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb612-3"><a href="#cb612-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Deep <span class="op">{</span></span>
<span id="cb612-4"><a href="#cb612-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb612-5"><a href="#cb612-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> Deep<span class="op">(</span><span class="dt">char</span> <span class="at">const</span><span class="op">*</span> str <span class="op">=</span> <span class="st">&quot;&quot;</span><span class="op">)</span> <span class="op">:</span> <span class="va">str_</span><span class="op">{</span><span class="kw">new</span> <span class="bu">std::</span>string<span class="op">{</span>str<span class="op">}}</span> <span class="op">{}</span></span>
<span id="cb612-6"><a href="#cb612-6" aria-hidden="true" tabindex="-1"></a>        <span class="op">~</span>Deep<span class="op">()</span> <span class="op">{</span> <span class="kw">delete</span> <span class="va">str_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb612-7"><a href="#cb612-7" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span><span class="op">&amp;</span> GetString<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="op">*</span><span class="va">str_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb612-8"><a href="#cb612-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb612-9"><a href="#cb612-9" aria-hidden="true" tabindex="-1"></a>        <span class="co">// copyコンストラクタの実装例</span></span>
<span id="cb612-10"><a href="#cb612-10" aria-hidden="true" tabindex="-1"></a>        Deep<span class="op">(</span>Deep <span class="at">const</span><span class="op">&amp;</span> rhs<span class="op">)</span> <span class="op">:</span> <span class="va">str_</span><span class="op">{</span><span class="kw">new</span> <span class="bu">std::</span>string<span class="op">{*</span>rhs<span class="op">.</span><span class="va">str_</span><span class="op">}}</span> <span class="op">{}</span></span>
<span id="cb612-11"><a href="#cb612-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb612-12"><a href="#cb612-12" aria-hidden="true" tabindex="-1"></a>        <span class="co">// copy代入演算子の実装例</span></span>
<span id="cb612-13"><a href="#cb612-13" aria-hidden="true" tabindex="-1"></a>        Deep<span class="op">&amp;</span> <span class="kw">operator</span><span class="op">=(</span>Deep <span class="at">const</span><span class="op">&amp;</span> rhs<span class="op">)</span></span>
<span id="cb612-14"><a href="#cb612-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb612-15"><a href="#cb612-15" aria-hidden="true" tabindex="-1"></a>            <span class="op">*</span><span class="va">str_</span> <span class="op">=</span> <span class="op">*(</span>rhs<span class="op">.</span><span class="va">str_</span><span class="op">);</span></span>
<span id="cb612-16"><a href="#cb612-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="op">*</span><span class="kw">this</span><span class="op">;</span></span>
<span id="cb612-17"><a href="#cb612-17" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb612-18"><a href="#cb612-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb612-19"><a href="#cb612-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb612-20"><a href="#cb612-20" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op">*</span> <span class="va">str_</span><span class="op">;</span></span>
<span id="cb612-21"><a href="#cb612-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb612-22"><a href="#cb612-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb612-23"><a href="#cb612-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Deep2 <span class="op">{</span>  <span class="co">// std::unique_ptrを使いDeepをリファクタリング</span></span>
<span id="cb612-24"><a href="#cb612-24" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb612-25"><a href="#cb612-25" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> Deep2<span class="op">(</span><span class="dt">char</span> <span class="at">const</span><span class="op">*</span> str <span class="op">=</span> <span class="st">&quot;&quot;</span><span class="op">)</span> <span class="op">:</span> <span class="va">str_</span><span class="op">{</span><span class="bu">std::</span>make_unique<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;(</span>str<span class="op">)}</span> <span class="op">{}</span></span>
<span id="cb612-26"><a href="#cb612-26" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span><span class="op">&amp;</span> GetString<span class="op">()</span> <span class="at">const</span> <span class="op">{</span> <span class="cf">return</span> <span class="op">*</span><span class="va">str_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb612-27"><a href="#cb612-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb612-28"><a href="#cb612-28" aria-hidden="true" tabindex="-1"></a>        <span class="co">// copyコンストラクタの実装例</span></span>
<span id="cb612-29"><a href="#cb612-29" aria-hidden="true" tabindex="-1"></a>        Deep2<span class="op">(</span>Deep2 <span class="at">const</span><span class="op">&amp;</span> rhs<span class="op">)</span> <span class="op">:</span> <span class="va">str_</span><span class="op">{</span><span class="bu">std::</span>make_unique<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;(*</span>rhs<span class="op">.</span><span class="va">str_</span><span class="op">)}</span> <span class="op">{}</span></span>
<span id="cb612-30"><a href="#cb612-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb612-31"><a href="#cb612-31" aria-hidden="true" tabindex="-1"></a>        <span class="co">// copy代入演算子の実装例</span></span>
<span id="cb612-32"><a href="#cb612-32" aria-hidden="true" tabindex="-1"></a>        Deep2<span class="op">&amp;</span> <span class="kw">operator</span><span class="op">=(</span>Deep2 <span class="at">const</span><span class="op">&amp;</span> rhs<span class="op">)</span></span>
<span id="cb612-33"><a href="#cb612-33" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb612-34"><a href="#cb612-34" aria-hidden="true" tabindex="-1"></a>            <span class="op">*</span><span class="va">str_</span> <span class="op">=</span> <span class="op">*(</span>rhs<span class="op">.</span><span class="va">str_</span><span class="op">);</span></span>
<span id="cb612-35"><a href="#cb612-35" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="op">*</span><span class="kw">this</span><span class="op">;</span></span>
<span id="cb612-36"><a href="#cb612-36" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb612-37"><a href="#cb612-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb612-38"><a href="#cb612-38" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb612-39"><a href="#cb612-39" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;</span> <span class="va">str_</span><span class="op">;</span></span>
<span id="cb612-40"><a href="#cb612-40" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>上記クラスのDeepは、copyコンストラクタ、copy代入演算子でポインタをコピーするのではなく、
ポインタが指しているオブジェクトを複製することにより、シャローコピーの問題を防ぐ。</p>
<h3 id="スライシング">スライシング <a id="SS_5_3_3"></a></h3>
<p>オブジェクトのスライシングとは、</p>
<ul>
<li>クラスBaseとその派生クラスDerived</li>
<li>クラスDerivedのインスタンスd1、d2(解説のために下記例ではd0も定義)</li>
<li>d2により初期化されたBase&amp;型のd2_ref(クラスBase型のリファレンス)</li>
</ul>
<p>が宣言されたとした場合、</p>
<div class="sourceCode" id="cb613"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb613-1"><a href="#cb613-1" aria-hidden="true" tabindex="-1"></a>    d2_ref <span class="op">=</span> d1<span class="op">;</span>    <span class="co">// オブジェクトの代入</span></span></code></pre></div>
<p>を実行した時に発生するようなオブジェクトの部分コピーのことである
(この問題はリファレンスをポインタに代えた場合にも起こる)。</p>
<p>以下のクラスと単体テストはこの現象を表している。</p>
<div class="sourceCode" id="cb614"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb614-1"><a href="#cb614-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/slice_ut.cpp 10</span></span>
<span id="cb614-2"><a href="#cb614-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb614-3"><a href="#cb614-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Base <span class="op">{</span></span>
<span id="cb614-4"><a href="#cb614-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb614-5"><a href="#cb614-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> Base<span class="op">(</span><span class="dt">char</span> <span class="at">const</span><span class="op">*</span> name<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">:</span> <span class="va">name0_</span><span class="op">{</span>name<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb614-6"><a href="#cb614-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">char</span> <span class="at">const</span><span class="op">*</span> Name0<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">name0_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb614-7"><a href="#cb614-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb614-8"><a href="#cb614-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb614-9"><a href="#cb614-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb614-10"><a href="#cb614-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">char</span> <span class="at">const</span><span class="op">*</span> <span class="va">name0_</span><span class="op">;</span></span>
<span id="cb614-11"><a href="#cb614-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb614-12"><a href="#cb614-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb614-13"><a href="#cb614-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Derived <span class="kw">final</span> <span class="op">:</span> <span class="kw">public</span> Base <span class="op">{</span></span>
<span id="cb614-14"><a href="#cb614-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb614-15"><a href="#cb614-15" aria-hidden="true" tabindex="-1"></a>        Derived<span class="op">(</span><span class="dt">char</span> <span class="at">const</span><span class="op">*</span> name0<span class="op">,</span> <span class="dt">char</span> <span class="at">const</span><span class="op">*</span> name1<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">:</span> Base<span class="op">{</span>name0<span class="op">},</span> <span class="va">name1_</span><span class="op">{</span>name1<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb614-16"><a href="#cb614-16" aria-hidden="true" tabindex="-1"></a>        <span class="dt">char</span> <span class="at">const</span><span class="op">*</span> Name1<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">name1_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb614-17"><a href="#cb614-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb614-18"><a href="#cb614-18" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb614-19"><a href="#cb614-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb614-20"><a href="#cb614-20" aria-hidden="true" tabindex="-1"></a>        <span class="dt">char</span> <span class="at">const</span><span class="op">*</span> <span class="va">name1_</span><span class="op">;</span></span>
<span id="cb614-21"><a href="#cb614-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb614-22"><a href="#cb614-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb614-23"><a href="#cb614-23" aria-hidden="true" tabindex="-1"></a>    TEST<span class="op">(</span>Slicing<span class="op">,</span> reference<span class="op">)</span></span>
<span id="cb614-24"><a href="#cb614-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb614-25"><a href="#cb614-25" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> <span class="at">const</span> d0     <span class="op">=</span> Derived<span class="op">{</span><span class="st">&quot;d0&quot;</span><span class="op">,</span> <span class="st">&quot;d0&quot;</span><span class="op">};</span></span>
<span id="cb614-26"><a href="#cb614-26" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> <span class="at">const</span> d1     <span class="op">=</span> Derived<span class="op">{</span><span class="st">&quot;d1&quot;</span><span class="op">,</span> <span class="st">&quot;d1&quot;</span><span class="op">};</span></span>
<span id="cb614-27"><a href="#cb614-27" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span>       d2     <span class="op">=</span> Derived<span class="op">{</span><span class="st">&quot;d2&quot;</span><span class="op">,</span> <span class="st">&quot;d2&quot;</span><span class="op">};</span></span>
<span id="cb614-28"><a href="#cb614-28" aria-hidden="true" tabindex="-1"></a>        Base<span class="op">&amp;</span>      d2_ref <span class="op">=</span> d2<span class="op">;</span></span>
<span id="cb614-29"><a href="#cb614-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb614-30"><a href="#cb614-30" aria-hidden="true" tabindex="-1"></a>        ASSERT_STREQ<span class="op">(</span><span class="st">&quot;d2&quot;</span><span class="op">,</span> d2<span class="op">.</span>Name0<span class="op">());</span>  <span class="co">// OK</span></span>
<span id="cb614-31"><a href="#cb614-31" aria-hidden="true" tabindex="-1"></a>        ASSERT_STREQ<span class="op">(</span><span class="st">&quot;d2&quot;</span><span class="op">,</span> d2<span class="op">.</span>Name1<span class="op">());</span>  <span class="co">// OK</span></span>
<span id="cb614-32"><a href="#cb614-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb614-33"><a href="#cb614-33" aria-hidden="true" tabindex="-1"></a>        d2 <span class="op">=</span> d0<span class="op">;</span></span>
<span id="cb614-34"><a href="#cb614-34" aria-hidden="true" tabindex="-1"></a>        ASSERT_STREQ<span class="op">(</span><span class="st">&quot;d0&quot;</span><span class="op">,</span> d2<span class="op">.</span>Name0<span class="op">());</span>  <span class="co">// OK</span></span>
<span id="cb614-35"><a href="#cb614-35" aria-hidden="true" tabindex="-1"></a>        ASSERT_STREQ<span class="op">(</span><span class="st">&quot;d0&quot;</span><span class="op">,</span> d2<span class="op">.</span>Name1<span class="op">());</span>  <span class="co">// OK</span></span>
<span id="cb614-36"><a href="#cb614-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb614-37"><a href="#cb614-37" aria-hidden="true" tabindex="-1"></a>        d2_ref <span class="op">=</span> d1<span class="op">;</span>                     <span class="co">// d2_refはBase&amp;型で、d2へのリファレンス</span></span>
<span id="cb614-38"><a href="#cb614-38" aria-hidden="true" tabindex="-1"></a>        ASSERT_STREQ<span class="op">(</span><span class="st">&quot;d1&quot;</span><span class="op">,</span> d2<span class="op">.</span>Name0<span class="op">());</span>  <span class="co">// OK</span></span>
<span id="cb614-39"><a href="#cb614-39" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#if 0</span></span>
<span id="cb614-40"><a href="#cb614-40" aria-hidden="true" tabindex="-1"></a><span class="co">        ASSERT_STREQ(&quot;d1&quot;, d2.Name1());  // 本来ならこうなってほしいが、</span></span>
<span id="cb614-41"><a href="#cb614-41" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="pp">#else</span></span>
<span id="cb614-42"><a href="#cb614-42" aria-hidden="true" tabindex="-1"></a>        ASSERT_STREQ<span class="op">(</span><span class="st">&quot;d0&quot;</span><span class="op">,</span> d2<span class="op">.</span>Name1<span class="op">());</span>  <span class="co">// スライシングの影響でDerived::name1_はコピーされない</span></span>
<span id="cb614-43"><a href="#cb614-43" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#endif</span></span>
<span id="cb614-44"><a href="#cb614-44" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>copy代入演算子(=)によりコピーが行われた場合、=の両辺のオブジェクトは等価になるべきだが
(copy代入演算子をオーバーロードした場合も、そうなるように定義すべきである)、
スライシングが起こった場合、そうならないことが問題である(「<a
href="#SS_5_8_1">等価性のセマンティクス</a>」参照)。</p>
<p>下記にこの現象の発生メカニズムについて解説する。</p>
<ol type="1">
<li>上記クラスBase、Derivedのメモリ上のレイアウトは下記のようになる。</li>
</ol>
<p>
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAcwAAADSCAIAAABIEmeOAAAa10lEQVR4Xu2de3BURb7HT8gLAiiYy1PCS2BhL9daoOoiiwouYd1arWKvVmIumt2ghgpS67pAWZQEYvnH3RW4roKAUK7+cauE1VDZ5RGRh7wCSGDZWEkAIQQnGZkABicJjDNkYu5v0qZP2w2DJDnDdM/3U7+y+pzf7zzS3eeTnpNRrVYAAACOYck7AAAAdB2QLAAAOIgt2e8AAAB0EZAsAAA4CCQLAAAOAskCAICDQLIAAOAgkCwAADgIJAsAAA4CyQIAgINAsgAA4CCQLAAAOAgkCwAADgLJAgCAg0CyAADgIJAsAAA4CCQLAAAOAskCAICDQLIAAOAgkCwAADgIJAsAAA4CyQIAgINAsgAA4CCQLAAAOAgkCwAADgLJAgCAg0CyAADgIJAsAAA4CCQLAAAOAskCAICDQLIAAOAgkCwAADgIJAsAAA4CyQIAgIMYJdnU1FQLmAiNLB/lpKS75HRMIvYJiGaMkizNPP5TAJOgkfV6vU1NTT6fj9oZGbsQYp8EAoFgMCg/DyA6sKcxb8kl+gDJmgqNrMvl8ng89fX1kCwLsU9IteRZ+XkA0YE9jXlLLtEHSNZUaGTLy8vPnj3rdrshWRZin5BnaT0rPw8gOrCnMW/JJfoAyZoKjWxJSUlZWRk5BZJlIfYJrWdpMSs/DyA6sKcxb8kl+gDJmgqNbHFxMTmF1m6QLAuxT1wul9frlZ8HEB3Y05i35BJ9gGRNhUZ248aNO3bsKC0thWRZiH1Ci9n6+nr5eQDRgT2NeUsu0QdI1lQgWTUgWV2wpzFvySX6AMmaCiSrBiSrC/Y05i25RB8gWVOBZNWAZHXBnsa8JZfoAyRrKpCsGpCsLtjTmLfkEn2AZE0FklUDktUFexrzllyiD5CsqUCyakCyumBPY96SS/QBkjUVSFYNSFYX7GnMW3KJPkCypgLJqgHJ6oI9jXlLLtEHSNZUIFk1IFldsKcxb8kl+gDJmgokqwYkqwv2NOYtuUQfIFlTgWTVgGR1wZ7GvCWX6AMkayqQrBqQrC7Y05i35BJ9gGRNBZJVA5LVBXsa85Zcog+QrKlAsmpAsrpgT2Pekkv0wTnJWm3MmDFDTjgGuyIjPj4+NTU1PT1927Ztcl1sIArFgmTbQuwTSDaasacxb8kl+mAZKllOXFzczp075dIYwIJklRD7BJKNZuxpzFtyiT5YxkmWXfH69evr1q1je7Kzs+XSGACSVQOS1QV7GvOWXKIPnZQsTdNFixaNGTMmOTk5JSVl4sSJW7duZSlJslVVVY8//nhaWlpiYiIVjx8//q233vquvTc9Hk9OTs6gQYMSEhLoPOPGjSMzer3e8CkJ6Yrsf4VNPPbYY2xPh++BqKmpmTNnzuDBg+lYOsOLL77Y0NDAUtGJppJdtuxYRcUVvz9IQY38/GNqTYcDktUFexrzllyiD52RbF1d3YgRI5jIOAUFBSzLNrny9u7d+8PCEOQ4lp0+fbqcs6zz58+HT0mwFF/Jbtiwge1ZunQpK+jwPZBhBwwYIKUmTJjw7bfffn/t6MPSULKLFx8NBkMP2GefXTxy5CI1mptbXn75M7WyYyH2CSQbzdjTmLfkEn2wOiHZuXPnMt3k5uaScMk4ZDH+hyaW4pKtra3dt28fLQyDweC5c+eGDx9OWVpLsiwtD2lz9OjRly5dCgQCFRUVy5cvp3b4lAS7osTMmTOvXr3KCjp8D7TCpdS999574sQJv9+/efNmdvK1a9fyq0cbVkclyw4vKjp/8uQVcpzbfZVrLj+/9Ny5hmvXmmnm+HzNlZVXli07Lh5VWFhNR12/3lJd3bhw4ZFNm6q83gCtSffs+SorazerfP75/bt3u69c8ZNP6Z87d9bm5OxjqdLSUG8fOlTHNg8frqPNo0cvqjfZsRD7BJKNZtpnccxLlj5Z0+H0CZqcJecUyTY2NtJH7KFDh9KHcZYi6DM7y44aNYo2u3fvPn/+/Hfffff48eMtLS23TEnw04r079+fnihW0OF7YD+pSmZmJiuIQqzOSZYMuHfvV/X1fmqfOeNlqRUrPiexkiI//rjm9OlvKEUCfe65/fwo0uu+fRcuXw4t8ClVV+fbv/8Ce2TWrauksqef3nPhwjXaPH++8ZNPaknZ7PyZmSEFNzZep8333jvNLkcN2mxoCKg32bEQ+wSSjWbYdGqFZJmqpk2bJifaYBrikp09ezZ3kwjL0hJYevNAK8ovvvgifEqCZdkVm5ubadGakpJCe6ZMmcIKOnwPopRF0tPT2y8edVidk2xxcU1Gu+ZoPcuzr732T1qfbt3q2rGjhlWuXPm5dNT7738/OmwJXFUVMumuXW5qr1pV3hp6XlrJsNu3u2gZyyoLCkIr4paW0NO1dm1IxxTUaG3TvXSHHQ6xTyDZaIbNilZIltawVtuH6B+zku3duzdtDhkypKYm9HCS+FiBeMipU6eKiopeeukllqIP6T8mxWEp8fsMDzzwgNW2OGWbHb6HgQMHWjdS6nfCbIg2rM5J9p13TlJ7zZqQ5giWIjPaF2jn7bcrbnYUe0VQUXGF2rTCpfYHH1TxA0VWrw6dBCtZwOATI9Yly9/J5uXlXbx40e/3Hzhw4GbvZNmicvjw4ZcvX6ZZHh8fzwpYdsGCBQcPHvR6vbQC5X+eYt8KCJOSYCl1JUuKZAUdvgf2TjYuLm7Dhg0+n6+hoWHXrl1ZWVkffvhh+8WjDqtzkiVRZiiSDQRC70+2bXPNnr1n7twDYmWYoyorbcmuWlVBbVqx5uUd4FecN+/gU0+FdHzsWOid7OHDP3gnW1p6iVd2MsQ+gWSjGTZ/WiHZ2/p2waxZs3hNYmIiLSdZWyyWWL16dfiUhFzUzpIlS1hBh+/B5XKp3y6w2p5YfvVog91e10rW4wm9Tq2r89HHfLf7+z8n3pZkn3nmU/ZO9ptvAnv2fLV7t/vMGS/Nw+zsTyn7yiul0rcLaHPx4qPqTXYsxD6BZKMZNn9aIdlW4XuySUlJ9Kn8/vvv37JlC0sxDXHJejyeRx99lMpGjhxZWFhI+1kBy9JJJk+e3Ldv327dutF6c9KkSWvWrLllSoKdkMO+t/vmm2/yv191+B5a276ZkJubm5aWlpCQ0Lt3b6p89dVXaf3OC6INywHJkgS//LKJxEe2ff31MrEyzFGiZDPavl2wc6f766/9tJ71+4PV1Y1btnzJv3tQUHD85MnQ92Rp1UwN/u2FLgmxTyDZaIbNn1ZIFkQzHZaswQHJ6oI9jXlLLtEHSNZUDJPs9u0uNdSy8AHJ6oI9jXlLLtEHSNZUDJOs/OO1oZaFD0hWF/gQQ7IgejFMsl0SkKwu2NOYt+QSfYBkTQWSVQOS1QV7GvOWXKIPkKypQLJqQLK6YE9j3pJL9AGSNRVIVg1IVhfsacxbcok+QLKmAsmqAcnqgj2NeUsu0QdI1lQgWTUgWV2wpzFvySX6AMmaCiSrBiSrC/Y05i25RB8gWVOBZNWAZHXBnsa8JZfoAyRrKpCsGpCsLtjTmLfkEn2AZE0FklUDktUFexrzllyiD5CsqUCyakCyumBPY96SS/QBkjUVSFYNSFYX7GnMW3KJPkCypgLJqgHJ6oI9jXlLLtEHSNZUIFk1IFldsKcxb8kl+gDJmgokqwYkqwv2NOYtuUQfIFlTgWTVgGR1wZ7GvCWX6AMkayqQrBqQrC7Y05i35BJ9gGRNBZJVA5LVBXsa85Zcog+QrKlAsmpAsrpgT2Pekkv0AZI1FUhWDUhWF+xpzFtyiT6kpqZawER69uzJhdKnTx85HZOIfQLJRjNGSZbwer0ul6u8vLykpKS4uHgjMAUaTRpTGllXOxhlsU9o5ssPA4gOTJNsU1OTx+OhX+xlZWU0/3YAU6DRpDGlkfW0g1EW+4RmvvwwgOjANMn6fD763OR2u2nm0W/4UmAKNJo0pjSy9e1glMU+oZkvPwwgOjBNsoFAgH6l05yj3+30GeosMAUaTRpTGtmmdjDKYp/QzJcfBhAdmCbZYDBIs41+q9O083q9fNUDdIdGk8aURjbQDkZZ7BOa+fLDAKID0yQLAABRBSQLAAAOAskCAICDQLIAAOAgkCwAADgIJAsAAA4CyQIAgINAsgAA4CBGSXb06NHyf6roR0PHyqcDAIBOY5RkAQAg2oBkAQDAQSBZAABwEEgWAAAcBJIFAAAHgWQBAMBBIFkAAHAQSBYAABwEkgUAAAeBZAEAwEEgWQAAcBBIFgAAHASSBQAABzFKsqmpqfJ/XAsYAY0sH+WkpLvkdIwh9kbPPj3ldEwi9km0YZRkqa/5TwFMgkbW6/U2NTX5fD5qZ2TsiuWQemP9ufUIsU8CgUAwGJTtcOewpzFvySX6AMmaCo2sy+XyeDz19fWQrNQbqnFiMMQ+IdWSZ2U73Dnsacxbcok+QLKmQiNbXl5+9uxZt9sNyUq9oRonBkPsE/IsrWdlO9w57GnMW3KJPkCypkIjW1JSUlZWRk8RJCv1hmqcGAyxT2g9S4tZ2Q53Dnsa85Zcog+QrKnQyBYXF9NTRKsVSFbqDdU4MRhin7hcLq/XK9vhzmFPY96SS/QBkjUVGtmNGzfu2LGjtLQUkpV6QzVODIbYJ7SYra+vl+1w57CnMW/JJfoAyZoKJCsGJKsGJBshIFlTgWTFgGTVgGQjBCRrKpCsGJCsGpBshIBkTQWSFQOSVQOSjRCQrKlAsmJAsmpAshECkjUVSFYMSFYNSDZCQLKmAsmKAcmqAclGCEjWVCBZMSBZNSDZCAHJmgokKwYkqwYkGyEgWVOBZMWAZNWAZCMEJGsqkKwYkKwakGyEgGRNBZIVA5JVA5KNEJCsqUCyYkCyakCyEQKSNRVIVgxIVg1INkI4LVmrjRkzZsgJx2BXJOLj4+++++7x48e/8MILp0+flutuH0d/li4/uQXJCiH1hmqcGAyxTyBZB7HMlaxI9+7di4qK5NLbhJ3KoZ+ly09uQbJCSL2hGicGQ+wTSNZBLEMly6546dKl9evX9+rVi/b07Nmzurparv4RXL16Vd7lAF3eUeIjZEGykKwSYp9Asg5idYVkaXgWLVo0ZsyY5OTklJSUiRMnbt26laUkd1RVVT3++ONpaWmJiYlUTJ/l33rrre/a+9Tj8eTk5AwaNCghIYHOM27cuOzsbK/XGz4lodrqo48+YjtffPFFvrOmpmbOnDmDBw+mO6H7oVRDQwNL8TNs2LBh2LBhcXFx0n5qz5s3j9o9evTgCt6/fz8r+Otf/8r2hLkEsX379rFjx9IS+8EHH6ysrBRP3iVYekp22bJjFRVX/P4gBTXy84+pNR0IqTdU40RnTPzVxD4D+rC58bvlv1MLOhNin0CyDmJ1WrJ1dXUjRoxg84BTUFDAsmyTu2Pv3r0/LAxBnmXZ6dOnyznLOn/+fPiUBEuJtqIfs3///rTzJz/5CdtD+hswYMAPzmVZEyZM+Pbbb/kZ+vT5fnJb7V3E2uzMJSUlbPNvf/sby/7+97+32t5LMJOGv8Tx48fJvHz/wIEDWSPGJbt48dFgMPSAffbZxSNHLlKjubnl5Zc/UytvN6TeUI0TnUGG/dnMn7G5AcnqitVpyc6dO5dNgtzcXBIuSYRMum3bNpZlKe6O2traffv20Qo0GAyeO3du+PDhlKX1LMsy74wePZo+5gcCgYqKiuXLl1M7fEpCuiJj6tSpVtvCk23Sopg277333hMnTvj9/s2bN7Oj1q5dy89A5OfnX7t2jf/RjO3kZ2a/WjIyMlrbJgCdjW/e8hJPPPEE26RZTpdg62Lx5J2HnbwDkmWHFxWdP3nyCjnO7b7KNZefX3ruXMO1a8308/p8zZWVV5YtOy4eVVhYTUddv95SXd24cOGRTZuqvN4ArUn37PkqK2s3q3z++f27d7uvXPGTT+mfO3fW5uTsY6nS0tCAHjpUxzYPH66jzaNHL6o3ebsh9YZqnDDBhuZXeb8a/Z+jExITBo0atGTLEpZ6+aOXh40f1qN3j7hucd17dR8zecyijYvEo349/9eho5IShv770GXFy2YtmHXXv92VnJI8NXPqujPrWOWKoysefOpB8mm3+G5397/74dkP/+XEX9QbgGR1xeq0ZOkjPJ2EPhSTN+WcIqbGxkb61Dx06FD61M9SRHJyMsuOGjXKalsMzp8//91336XlXktLyy1TEtIVGZJk2T2rZGZm8jPQ6lK6BNvPz7xkyRKr7VWvz+c7fPgwy/7jH/9g2fCX6NevH7XHjh3Lit1uN8tGj2TJgHv3flVf76f2mTNellqx4nMSKyny449rTp/+hlIk0Oee28+PIr3u23fh8uXQap1SdXW+/fsvsEdm3bpKKnv66T0XLlyjzfPnGz/5pJaUzc6fmRlScGPjddp8773T7HLUoM2GhoB6k7cbUm+oxgkTbGjiE+J//uTP2Yf3ET8bwVJ56/JIrA9lPfTIbx+5b9J9lErqkbTy2Ep+FOl1yhNT7hl8D7XJrf2G9nvgvx6Ii4ujzd/+6bdU9nbl2wNGhD7xpP00bdrT00jZ7PzvnH1HugFIVlesTkuW6XLatGlyog02P7g7Zs+ezfZIsCwtgaU3D7R0/eKLL8KnJFhWel0gSU1UvEh6ejo/g/oTsf38zKdOnWJ7CgsLFyxYQI3U1NTr10OaaL3VJeLj46n9yCOPsGL6/cSy0SPZ4uKajHbN0XqWZ1977Z+0Pt261bVjRw2rXLnyc+mo99//flzYEriqKmTSXbvc1F61qrw1NCKtZNjt2120jGWVBQWhFXFLS+jpWrs2pGMKarS26V66ww6E1BuqccIEGxrSKLWzCrKoTetZnv3j//2R1qfpz6VPz57OKvPW5vGjfvG7X1A7c2km28zfmk+bw/4jZFJSM7WffeNZapN2ybAzcmbQMpZVLvxgoXQDkKyuWJ2WLK1hrbbPxT9mJdu7d2/aHDJkSE1N6BGdMmUKKxAPIXkVFRW99NJLLEWfu39MisNSoq34H77+8Ic/sD3sHSjznch3baOrnoGh7p84cSLtycrKYu896FM/T4W/BJP+uHHj2M4oXMm+885Jaq9ZE9IcwVJkRvsC7bz9dsXNjmKvCCoqrlCbVrjU/uCDKn6gyOrVoZNE80o2+3+yqU2mY5ssRWZkmyI5K3JudhR7RUCLX2rTCpfav1n4G36gyJyVc6QbgGR1xeq0ZPk72by8vIsXL/r9/gMHDtzsnWxKSgptkpIuX75Mo8sWdPweaD148OBBr9fb3NzM/0T22GOPhU9JsBS7Il1lw4YNzOy9evXifyhjL0xp+UBZ+rDf0NCwa9cucuWHH34onUFE3f/GG2/QHr5oPXToEE+Fv8STTz7JDtm0aRNlo/CdLIkyQ5FsIBB6f7Jtm2v27D1z5x4QK8McVVlpS3bVqgpq04o1L+8Av+K8eQefeiqk42PHQu9kDx/+wTvZ0tJLvLLDIfWGapwwwYaGOU6SbGL30J8K0p9NX3NqzfIjy8XKMEeJkn32f0Mr2W7x3f586M/8in86+Cf+xlY6VReGBclGBqvTkr2tbxfMmjWL1yQmJtKSlrXFYonVq1eHT0nIRW306NHj73//O69xuVzqn/6ttjnHz6D6Tt1/4cIF/nti5MiRQu0tLiF9u+Cee0Lv7KwbXbTDsGt1rWQ9ntDr1Lo6H33Md7u//+7abUn2mWc+Ze9kv/kmsGfPV7t3u8+c8dI8zM7+lLKvvFIqfbuANhcvPqre5O2G1BuqccIEG5ob6rL/sNC3VvoN7Ucf8weNGiRWhjlKlOzqitX9h4dOcle/u6ZmTn0o66GRE0bGdYtbVb6KslRDwY69b9J9bFO9w46FBclGBqvTkm0VvieblJTUvXv3+++/f8uWLSzF5gd3h8fjefTRR6mMlFRYWEj7WQHL0kkmT57ct2/fbt260Zp30qRJa9asuWVKgp2QoEr+r9WeOXNGKqutrc3NzU1LS6N1KC116eSvvvoqrcT5GVTf3XD/zJkz2f6lS5eK+1vDXqI1tB7cNnbs2OTk5ClTpvzrX/+64ck7g+WAZEmCX37ZROIj277+eplYGeYoUbIZbd8u2LnT/fXXflrP+v3B6urGLVu+5N89KCg4fvJk6HuytGqmBv/2QidD6g3VOGGCDc0Ndbl48+IhY4fQOpRs+8L6F8TKMEeJkl3f9u2Ch//74b4D+9J5klOS036a9svcX7KVLDtKQr3DjoUFyUYGqyskC6IQ8RGybkeyRobUG6pxYjAg2QgByZqKYZLdvt2lhlp2szBMsjNyZqihloUPSDZCQLKmYphk5R+vDbXsZmGYZK0boZaFDwuSjQwWJGso4iNk6S/ZTobUG6pxYjAg2QgByZoKJCsGJKsGJBshIFlTgWTFgGTVgGQjBCRrKpCsGJCsGpBshIBkTQWSFQOSVQOSjRCQrKlAsmJAsmpAshECkjUVSFYMSFYNSDZCQLKmAsmKAcmqAclGCEjWVCBZMSBZNSDZCAHJmgokKwYkqwYkGyEgWVOBZMWAZNWAZCMEJGsqkKwYkKwakGyEgGRNBZIVA5JVA5KNEJCsqUCyYkCyakCyEQKSNRVIVgxIVg1INkJAsqYCyYoByaoByUYISNZUIFkxIFk1INkIAcmaCiQrBiSrBiQbISBZU4FkxYBk1YBkIwQkayqQrBiQrBqQbIRITU21gIn07NmTP0J9+vSR0zEGekNF7BNI1lm8Xq/L5SovLy8pKSkuLt4ITIFGk8aURtbVTiyPMnpDRewT8oCshjuHaZJtamryeDz0q6ysrIx6fAcwBRpNGlMaWU87sTzK6A0VsU/IA7Ia7hymSdbn89EnBbfbTX1Nv9NKgSnQaNKY0sjWtxPLo4zeUBH7hDwgq+HOYZpkA4EA/RKjXqbfZvSp4SwwBRpNGlMa2aZ2YnmU0RsqYp+QB2Q13DlMk2wwGKT+pd9j1NFer5f/nge6Q6NJY0ojG2gnlkcZvaEi9gl5QFbDncM0yQIAQFQByQIAgINAsgAA4CCQLAAAOAgkCwAADgLJAgCAg0CyAADgIJAsAAA4CCQLAAAOAskCAICDQLIAAOAgkCwAADgIJAsAAA4CyQIAgINAsgAA4CCQLAAAOAgkCwAADgLJAgCAg0CyAADgIJAsAAA4CCQLAAAOAskCAICDQLIAAOAgkCwAADgIJAsAAA4CyQIAgIPcQLIAAAC6HEgWAAAcBJIFAAAH+X+SSwuksT4EIAAAAABJRU5ErkJggg==" />
</p>
<ol start="2" type="1">
<li>上記インスタンスd0、d1、d2、d2_refのメモリ上のレイアウトは下記のようになる。</li>
</ol>
<p>
<img src="data:image/png;base64,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" />
</p>
<ol start="3" type="1">
<li>d2 = d0をした場合の状態は下記のようになる。</li>
</ol>
<p>
<img src="data:image/png;base64,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" />
</p>
<ol start="4" type="1">
<li>上記の状態でd2_ref = d1をした場合の状態は下記のようになる。</li>
</ol>
<p>
<img src="data:image/png;base64,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" />
</p>
<p>d2.name1_の値が元のままであるが(これがスライシングである)、その理由は下記の疑似コードが示す通り、
「d2_refの表層型がクラスBaseであるためd1もクラスBase(正確にはBase型へのリファレンス)へ変換された後、
d2_refが指しているオブジェクト(d2)へコピーされた」からである。</p>
<div class="sourceCode" id="cb615"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb615-1"><a href="#cb615-1" aria-hidden="true" tabindex="-1"></a>    d2_ref<span class="op">.</span>Base<span class="op">::</span><span class="kw">operator</span><span class="op">=(</span>d1<span class="op">);</span>   <span class="co">// Base::operator=(Base const&amp;)が呼び出される</span></span></code></pre></div>
<p>次に示すのは、
「オブジェクトの配列をその基底クラスへのポインタに代入し、
そのポインタを配列のように使用した場合に発生する」スライシングと類似の現象である。</p>
<div class="sourceCode" id="cb616"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb616-1"><a href="#cb616-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/slice_ut.cpp 61</span></span>
<span id="cb616-2"><a href="#cb616-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb616-3"><a href="#cb616-3" aria-hidden="true" tabindex="-1"></a>    TEST<span class="op">(</span>Slicing<span class="op">,</span> array<span class="op">)</span></span>
<span id="cb616-4"><a href="#cb616-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb616-5"><a href="#cb616-5" aria-hidden="true" tabindex="-1"></a>        Derived d_array<span class="op">[]{{</span><span class="st">&quot;0&quot;</span><span class="op">,</span> <span class="st">&quot;1&quot;</span><span class="op">},</span> <span class="op">{</span><span class="st">&quot;2&quot;</span><span class="op">,</span> <span class="st">&quot;3&quot;</span><span class="op">}};</span></span>
<span id="cb616-6"><a href="#cb616-6" aria-hidden="true" tabindex="-1"></a>        Base<span class="op">*</span>   b_ptr <span class="op">=</span> d_array<span class="op">;</span>  <span class="co">// この代入までは問題ないが、b_ptr[1]でのアクセスで問題が起こる</span></span>
<span id="cb616-7"><a href="#cb616-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb616-8"><a href="#cb616-8" aria-hidden="true" tabindex="-1"></a>        ASSERT_STREQ<span class="op">(</span><span class="st">&quot;0&quot;</span><span class="op">,</span> d_array<span class="op">[</span><span class="dv">0</span><span class="op">].</span>Name0<span class="op">());</span>  <span class="co">// OK</span></span>
<span id="cb616-9"><a href="#cb616-9" aria-hidden="true" tabindex="-1"></a>        ASSERT_STREQ<span class="op">(</span><span class="st">&quot;0&quot;</span><span class="op">,</span> b_ptr<span class="op">[</span><span class="dv">0</span><span class="op">].</span>Name0<span class="op">());</span>    <span class="co">// OK</span></span>
<span id="cb616-10"><a href="#cb616-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb616-11"><a href="#cb616-11" aria-hidden="true" tabindex="-1"></a>        ASSERT_STREQ<span class="op">(</span><span class="st">&quot;2&quot;</span><span class="op">,</span> d_array<span class="op">[</span><span class="dv">1</span><span class="op">].</span>Name0<span class="op">());</span>  <span class="co">// OK</span></span>
<span id="cb616-12"><a href="#cb616-12" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#if 0  </span><span class="co">// スライシングに類似した問題で、以下のテストは失敗する。</span></span>
<span id="cb616-13"><a href="#cb616-13" aria-hidden="true" tabindex="-1"></a><span class="co">        ASSERT_STREQ(&quot;2&quot;, b_ptr[1].Name0());  // NG</span></span>
<span id="cb616-14"><a href="#cb616-14" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="pp">#else</span>  <span class="co">// こうすればテストは通るが、、、</span></span>
<span id="cb616-15"><a href="#cb616-15" aria-hidden="true" tabindex="-1"></a>        ASSERT_STREQ<span class="op">(</span><span class="st">&quot;1&quot;</span><span class="op">,</span> b_ptr<span class="op">[</span><span class="dv">1</span><span class="op">].</span>Name0<span class="op">());</span>  <span class="co">// NG</span></span>
<span id="cb616-16"><a href="#cb616-16" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#endif</span></span>
<span id="cb616-17"><a href="#cb616-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAjAAAADSCAIAAADbgG2YAAAfFElEQVR4Xu3de5BU1Z3A8csMTI8KCpJRQhhGUGB0CRVI1cYBw0NgcbcgJFgQF3ywhljAutZuyCaoE6nyD3GjbhTwgbW1SWrlsYbdbEVBV0F8RkWWSBjUCD5GBhAMMDIPXjOwv57DXE6fc+/tmbk9t+90fz/1q6nb555zaU7/+vfrHnoG5wwAADHgmAMAAGQDDQkAEAvnGtJpAAAiR0MCAMQCDQkAEAs0JABALNCQAACxQEMCAMQCDQkAEAs0JABALNCQAACxQEMCAMQCDQkAEAs0JABALNCQAACxQEMCAMQCDQkAEAs0JABALNCQAACxQEMCAMQCDQkAEAs0JABALNCQAACxQEMCAMQCDQkAEAs0JABALNCQAACxQENC1+a0mDhxonkirtQdVpYsWeKO19fX33nnnWVlZUVFRfJVjhsaGjxXdaG/bHZ1ue3SH2U9NxYtWjRy5MiCggJ1SluRpK/qQn9ZTzQkdG1d7nmolw+36DQ3N0+aNEk/JSZPnizj9qou9JfNri63XfqjrDckfdyhIQGx1RnPw7q6OnOohd94u3je4VWrVqnxpUuXNjY23nffferm6tWr9Wmea+GnM7bLLwf8xtvF7w7ffvvt69atq6ioUBOMs4rf2q6FhoQu5tlnny0vLy8uLr7mmmuqqqra+DzctWvX1KlTS0tLe/TokUgkhg8f/vDDDxvvP+QiK1euLCsr69atW/B4wNU+/fRT9a0V/RXu6NGjZWTEiBH6Nd2zQq4mg7169Tp58qTclK9yLCPTpk3Tp3muhSsnc8Ml42qCeaJF8NqugoaEruSdd96R57l67ol+/fq18Xn40ksvuatcUinUWXWzd+/e7qng8eCrSReRm5dddpkqQzU1NVKtZOSBBx5wr2nc4f79+8vgqFGj3BE5lpEBAwZos7zXQsnV3HDRkIB4mTFjhnrirV69ur6+fsGCBW18Hn722WebN28+cuTIqVOndu/eLRVBVsmrV3VWXURUVlbKZd9///3g8eCrrV+/Xq3auHGj3Fy+fLkcFxYW7tu3z72mcYeLiopkcMKECe7I+PHjZUTGtVnea6Hkam64aEhAvJSUlMizrry8XN3cs2dPG5+HX3755R133DFw4MDu3burJSKRSKiz6qa8pm5qatJX+Y0HX00mDxo0SEZuvPFGuXnttdfK8ZQpU9RZNTltQxo3bpx+TcVzLZRczQ0XDQl5qm/fviq/IzZkyBDzrqSS15KOVrjlRahamPZ5OHv27JQ/qZU6q46lB6Qu8h0PvppYunSp3Dz//PPlNbK6z0899ZQ6pWYad9j+lt3IkSOdEN+yk51UkzNOfYspenmbG65MNaTOyw2pG+Yf1k40JHhwfJI+69Sr4CuvvFLdbPurYPUZAanv1dXVctP4wJLfRfzGg68mDhw4oN70jBkzxmn5tEJ9fb065XlN+0MNPXv2dGL5oQb9rxkruZobrkw1pM7jd9/ajoYED+ETq5Ncf/316om3Zs2ahoaGtv87gbwgdVr+MfngwYPPPfecemXq/jX9LuI3Hnw1RX+lPHfuXHfc85rGx77Vi2gnlh/7dsiNwPHgqyntyg1xsMXYsWPVBHVT6HP81kbJCZ0bNCR4CJ9YncT4JNXFF1/cxufh9OnT3VVyBXkBq47VWb+L+I0HX0159dVX3TnqX7AVNWJcM+0Pxipq3L4/UXLIjcDx4Ksp7coNd9xmz7HXRsm4Sx1AQ4KH8InVeZ555pny8vJEIlFRUbFt27Y2Pg/37ds3ZcqUoqKiwYMH/+Y3v5mY+t0Pv4v4jQdfzTV8+HAZLC0t1fuK3zXr6+sXL15cVlYmVUy+yrH7nRyX39oo2X/N+MjV3FDjNnuOvTZKxl3qABoSPIRPLNTV1UlfkZ2866679PEwhSPM2kwhN8IjN/zQkOAhfGLluWHDhl100UWyjT179qypqdFPqcKh6D+xH0xf1dWLTp4jNwLQkOAhfGJlhf7M1JnzOp/T8vHooUOHPvfcc/YpV34WnazQN1Bnzut8Drnhj4YED+ETKyv0Z6bOnIcQuuh+mjnRypyHEMLvJw0JHsInFnIVuQE/4XODhgQP4RMLuYrcgJ/wuUFDgofwiYVcRW7AT/jcoCHBQ/jEQq4iN+AnfG7QkOAhfGIhV5Eb8BM+N2hI8BA+sZCryA34CZ8bNCR4CJ9YyFXkBvyEzw0aEjyETyzkKnIDfsLnBg0JHsInFnIVuQE/4XODhgQP4RMLuYrcgJ/wuUFDgofwiYVcRW7AT/jcoCHBQ/jEQq4iN+AnfG7QkOAhfGIhV5Eb8BM+N2hI8BA+sZCryA34CZ8bNCR4CJ9YyFXkBvyEzw0aEjyETyzkKnIDfsLnBg0JHsInFnIVuQE/4XODhgQP4RMLuYrcgJ/wuUFDgofwiYVcRW7AT/jcyKmG1LdvXwfhyB7KTg4ZMkS+FhVdaJ7OM2o3lAt6X2CezjPkho7csBUWFrp70jE51ZBkR9y/BTpG9rC2traurq6xsVGOZ858MZ/D2I2VH63M5yA39CA37ND35MSJE01NTWaNTudcIXKPzCldBw0pPNnD6urq/fv3Hzp0iKJj7Ib9DMyrIDf0IDfs0PdE2pL0JLNGp3OuELlH5pSug4YUnuzhjh07du3aVVNTQ9ExdsN+BuZVkBt6kBt26HsiPUneJ5k1Op1zhcg9Mqd0HTSk8GQPX3/99XfffVeyiqJj7Ib9DMyrIDf0IDfs0PdE3ifJmySzRqdzrhC5R+aUroOGFJ7s4YYNGySr5JUORcfYDfsZmFdBbuhBbtih70l1dXVtba1Zo9M5V4jcI3NK10FDCk/2cM2aNc8///yWLVsoOsZu2M/AvApyQw9yww59T+RN0qFDh8wanc65QuQemVO6DhpSeBQdPSg6epAbepAbdtCQUtCQwqPo6EHR0YPc0IPcsIOGlIKGFB5FRw+Kjh7khh7khh00pBQ0pPAoOnpQdPQgN/QgN+ygIaWgIYVH0dGDoqMHuaEHuWEHDSkFDSk8io4eFB09yA09yA07aEgpaEjhUXT0oOjoQW7oQW7YQUNKQUMKj6KjB0VHD3JDD3LDDhpSChpSeBQdPSg6epAbepAbdtCQUtCQwqPo6EHR0YPc0IPcsIOGlIKGFB5FRw+Kjh7khh7khh00pBQ0pPAoOnpQdPQgN/QgN+ygIaWgIYVH0dGDoqMHuaEHuWEHDSkFDSk8io4eFB09yA09yA07aEgpMtiQnBYTJ040T+Q6io4eFB09yA09yA07aEgpaEjhUXT0oOjoQW7oQW7YQUNKEfOGVF9fbw618BvPCoqOHhQdPcgNPcgNO2hIKcI0pPXr15eXlxcXF19zzTU7d+5sY0PavXv31KlTS0tLe/TokUgkhg8f/sgjj5xu3Vb3Ik8++WRZWVm3bt2CxwOuVl1dXVBQIKuWLFmiJovRo0fLyIgRI9yR8PSUcrpO0bnnnneqqg4fP94kIQeVle/YczoQxm7Yz8B4xqjrRvW+tLdKs1t+fos9oWNBbuhBbtih7wkNqeMNaevWrdID1IMk+vXrpw7SNqTNmze7q1zSRdRZdbN377MPv9N69/zGg682bdo0uXnZZZedbnnY9u7dK51MRh588EE1ISOcLlh0Fi9+u6kpuSdvvXXgzTcPyMGpU80/+clb9sz2hrEb9jMwniEV5xuTv6HyJ4NFh9zQg9ywQ98TGlLHG9KMGTPUIyS72dDQsGDBAnUzbUPas2fPyy+/XFtb29TU9NFHH0m3kFXyzkadVRcRlZWVctkPPvggeDz4ahs2bFCrNm3aJDdXrFghx4WFhfv371cTMsLpaNFRy3/720/ee++wPOdraurdp31l5ZaPPvqyoeGUPEaNjad27jx8zz1b9VXr1n0sq06ebP7446OLFr25du3u2toT8np206a9N9ywUc2cN++VjRtrDh8+LvVFvr7wwp65c19Wp7ZsOSgXeeONz9XN3//+c7n59tsH7DvZ3jB2w34GBoR6sK6bf92QvxzSvUf3r17x1bt/d7c69ZPf/KRseNl5vc7rVtCtuGfx0G8N/fGaH+ur/ubv/ya5qqj7wL8YeM+Ge6b/aPqFX7kwcX5izKwxj3/4uJr5wNsPXPP9a6S+FBQWXHTJRWNnj/3Ftl/YdyCDRYfc0IPcsEPfExpSxxtSSUmJrC0vL1c3a2pq1AOWtiEdPXr0jjvuGDhwYPfu3dUSkUgk1Fl1U95vNTc366v8xoOvJpMHDRokIzfeeKPcvPbaa+V4ypQp+hXCc8IVHakImzfvPXTouBx/+GGtOvXAA9ul0EjJeO65zz744IickoLygx+84q6ScvPyy/u++OKYOvX5542vvLJPJefjj++UaXPmbNq3r0FufvLJ0f/93z1SwtT1Z81KlqSjR0/KzX//9w/UHycHcvPLL0/Yd7K9YeyG/QwMCPXwFXYvHH39aPVNkkHfGKROzX98vhSab9/w7Qk3T7j8m5fLqaLzih5850F3lZSbihkVF/e/WI6l1pQMLLn6e1erN8Q3L71Zpq3YueLSQZfKzdKrSsfNGSclTF3/iV1PGHcgg0XHITe0MHbD3q6AUA9NLuWGCoeGpHM62pDkfYasnTBhgropb1DUA5a2Ic2ePVvNNKiz6njcuHEpa/zHg68m7r//frl5/vnny/sndZ9XrVqlXSADnHBFZ8OGz2a2Pu3ltbB79t57/09e2z7zTPXzz3+mZj744HZj1S9/+Sd1U7183r07WVlefLFGjpct23EmmZlnpOKsX18tL4HVzCVLkq+mm5uTefzYY8nyJCEHZ1rKn3EPOxDGbtjPwIBQj52UFTm+YckNciyvhd2z//Qf/ySvbSf9YNL4m8armfMfm++uuvaWa+V41s9mqZuVz1TKzbKvJyuLlCo5vvVfb5VjKUNScSbOnSgvgdXMRasXGXcgg0XHITe0MHbD3q6AUA9NLuWGCoeGpHM62pDUO6Qrr7xS3Wz7O6RevXrJtAEDBnz2WfK5VFFRoRaqs34X8RsPvpo4ePBgUVGRjIwZM0a+yvyGhuRrwwxywhWdJ554T44ffTT5tBfqlFSKc39AqxUrqvxWqW/FVFUdlmN5dSzHq1fvdhfqli9PXiTOr4Jvuu8mOZZnvrqpTkmlUDd1cx+Y67dKfStGXjjLsbw6luPvLvquu1D3dw/+nXEHMlh0HHJDC2M37O0KCPXQ5FJuqHBoSDqnow3p+uuvV4/Q2rVrGxsb2/5vSPJmxWn5oMEXX3whD4N61+LeDb+L+I0HX03R30XNnTtXP5URTriiI4VjplV0TpxIfmfy2WerZ8/edNttr+ozA1bt3Hmu6CxbVnUm+U3L0/Pnv+r+iQsWvPb97yfL0zvvJP+d4Pe/T/l3gi1bDrozOxzGbtjPwIBQj5F6zhtFp0dx8hM0k26d9Oj7j/78zZ/rMwNW6UXn1oeSr4ILCgvuf+N+909c+tpS918RjEtlJBxyQwtjN+ztCgj9ocmN3FDh0JB0TkcbkvEpu4svTn5/1vHqGYbp06e7q+QK8uZGHauzfhfxGw++mvLaa6+5c9SnGzLL6YSis39/8m3c5583vvDCnpqasz901a6ic+ONL6l/Jzhy5MSmTXs3bqz58MNaecRvuuklOXvXXVuMT1LJzcWL37bvZHvD2A37GRgQ6jHyLB+XlF0ixyUDS8bOHvvVK76qzwxYpRed5VXLL7kseZELSy4cM2vMt2/49uCRg7sVdFu2Y5mclTkSau3l37xc3bTvYXvDITe0MHbD3q6AUA+N56PcRXNDhUND0jkdbUhnkq/Rni0vL08kEhUVFX/4wx/UA2b3DMP+/funTJlSVFQ0ePDgdevWyXy1UJ31u4jfePDVXMOHD5fB0tLS09rjlylOJxQdKQqfflonhUCqz7/8y7v6zIBVetGZ2fJJqhdeqPnzn4/La+Hjx5s+/vjo7373qfs5qyVLtr73XvJnTeQVtxy4n9QKGcZu2M/AgFCPnWf5WPxfiweUD5DXsFJ9Fq5cqM8MWKUXnZUtn6Qa+7dj+/TrI9dJnJ8ovar0r374V+pVsFplsO9he8MhN7QwdsPeroBQj4jno9xFc0OFQ0PSOVbtzj319fVlZWXyN73rrrvMc5mgp5TTnqKTk2Hshv0MzKsgN/QgN+ygIaXI+YY0bNiwiy66SP6aPXv23Lt3r3k6E3Ks6KxfX22HPc0vcqzoTJw70Q57ml+QG3qQG3bQkFJ0UkNyfJjzOp/T8mnOoUOHykNunssQpzOLzpnkL5hokAP5eqb12y8zW/4Z4L//+5ODB4+dOtUsX+V4zpxNaVe1JVL/cmfZ0/zC2A37GRgm5IKXDr5UDuSrfvHJ8yaXXlXarSD5kyX2H+q3qi2hLmiwp/mFE3lurFmzu6rq8JdfnmhqOl1Xd3LLloM/+tGbwUvaHqlJcZY9zS+M3bC3K0w4Xo/y/MfmXz7q8gt6X1BQWFDcs/jyb15+2/Lbgpe0Pc4lhMaeFhwODUnndE6TMB+lVua8nOBEXnRmzXrxj388ZNyN7dsPyXjAqmjC2A37GRgmHJ8KoueY/Yf6rYognMhzIzUpkhobT/3DP7wRsCSyMHbD3q4w4fkoyyuVc2nRSv2Ikt+SiMOhIemcHG0SUdJTyomk6Dz8cPIHG8VTT+2aPXvTqlW71M2HH/5jwKpowtgN+xkYJvwqyISbJ0iVGTxysKo4bVwVQUSfG4cOHf+3f/tg3rxXbr5584sv1qjEUD8q67cksog+NxauXPiPv/7HR7Y/smzHsu/++OwPG43661EBSyIOfU9oSDSkDIi+6Gzd+sWZ5CvfJvWxKPkqx2eSn8U/+8MinquiieiLjhvlo8tVxWnXqk6N6HNDfXRbxS23bFYpum3bFwFLIoss5obEo+8/qtJj5JSRbVwSQeh7QkOiIWVApxYdzzh8OPnLzT7++Kg7Iscy8uc/H7cnRxydWnSCw68hZTGizw093B+b3bgx+RuDsh5ZzA15h/S9f/6eSo9bH7rVnpCt0PeEhkRDyoDoi86pU8mf1a+qOuyOqF8Mo/+6s2xFFosODcmIF144+y27n/0sM/+hUcjISm5UPlOpssJp+V0Msypn2XOyGPqe0JBoSBkQfdGxG5L6sceTJ2lISfapbEX0ueHG2rVnf2Hd//zPJ/bZrERWckNvSOK8Xuf9eO3Z/5wiDqHvCQ2JhpQB0RcdvmXnGTQkN9xutGnTXvezl1mPLObGsh3Lblt+W/ei5H9SM+DKAfaEbAUNKQUNKbzoi479oYZjx1I+1JDFyGLRoSGp+M///EhlZqy60cys5oYK9b8lFXYvtE9lK2hIKWhI4UVfdIyPfctXddP92HcWIytF56GtD0kM+cshqiGpmxL2zIgj+tx4+umz3WjjxppYdaOZ2ciNCTdP+Om6ny6vWr7ivRULVy7skUj+PuiSgSX2zGwFDSkFDSm86ItO2h+MzWJEX3RWtjyrPdkzIw4n8twwskKRbLFnRh/GbtjblfFITYez1O9ajUk4NCSdQ0MKTU8pJ5KiM7PlVwf99rfJXx3U1HRavsqxjNjTog9jN+xnYGeEXm509syIw4k8N8zsbJG3DWncnHH9h/QvOq+ooLCgV99eX5/w9Tt+eYc9LYuh7wkNiYaUAdEXnThH9EUnzkFu6EFu2EFDSkFDCo+iowdFRw9yQw9yww4aUgoaUngUHT0oOnqQG3qQG3bQkFLQkMKj6OhB0dGD3NCD3LCDhpSChhQeRUcPio4e5IYe5IYdNKQUNKTwKDp6UHT0IDf0IDfsoCGloCGFR9HRg6KjB7mhB7lhBw0pBQ0pPIqOHhQdPcgNPcgNO2hIKWhI4VF09KDo6EFu6EFu2EFDStG3b18H4VxwwQVuSvXu3ds8nWfYDR27oWM3bPqe0JCSamtrq6urd+zY8frrr2/YsGEN2k/2TXZP9rC6VT7vJ7uhYzd07IZN3xOpxmaBTifXGlJdXd3+/fulOb/77ruyL8+j/WTfZPdkD/e3yuf9ZDd07IaO3bDpeyLV2CzQ6eRaQ2psbJT3iTU1NbIj0qW3oP1k32T3ZA8Ptcrn/WQ3dOyGjt2w6Xsi1dgs0OnkWkM6ceKEtGXZC+nP8p5xF9pP9k12T/awrlU+7ye7oWM3dOyGTd8TqcZmgU4n1xpSU1OT7IJ0ZtmO2tras69b0B6yb7J7socnWuXzfrIbOnZDx27Y9D2RamwW6HRyrSEBALooGhJM21uYo/mK3QAiQ0OC6actzNF8xW4AkaEhIUVzc3NpCzkwz+UfdgOIEg0JKV566SX1Q9dyYJ7LP+wGECUaElLMmzdPlWA5MM/lH3YDiBINCeccO3asT58+qgTLgdw0Z+QTdgOIGA0J56xbt07VX0VumjPyCbsBRIyGhHNmzJihl2C5ac7IJ+wGEDEaEs46fPhwIpHQS7DclEFzXn5gN4Do0ZBw1pNPPqnXX0UGzXn5gd0AokdDwlnjx483C7DjyKA5Lz+wG0D0aEhIqq6uLigoMAuw48ignDJn5zp2A8gKGhKS7r//frP6tpJT5uxcx24AWUFDQtKIESPM0ttKTpmzcx27AWQFDQkepPKaQ3mM3QCiQUOCB0qwjt0AokFDggdKsI7dAKJBQ4IHSrCO3QCiQUOCB0qwjt0AokFDggdKsI7dAKJBQ4IHSrCO3QCiQUOCB0qwjt0AokFDggdKsI7dAKJBQ4IHSrCO3QCiQUOCB0qwjt0AokFDggdKsI7dAKJBQ4IHSrCO3QCiQUOChyFDhphDeYyGBESDhgRvq1atGjVqVCKRKC4uHjp06Jw5c4wJTouJEyca4yH96le/WtLCPOFD3Q1FX1VfX3/nnXeWlZUVFRXJVzluaGjwXJX2r+DQkIBI0JDgYe3atXrJVow5ajBtNW8vuaDnH+fn3P3TGlJzc/OkSZP0U2Ly5Mkybq9K+1dw2nxnAIRBQ4KH6dOnq2L91ltvnThxYvv27Xfffbcxp43VvL3a2JDq6urUgefdkLd3anzp0qWNjY333Xefurl69Wp9mudam5PuzgDICBoSPCxcuFAV682bN5vnWrnV/Omnnx46dGhxcfGECRM+/PBDc14qd9VTTz11xRVXJBIJfZU6azAWrly5sqysrFu3bsa4uqlMnTpVBnv16nXy5Em5KV/lWEamTZumT/Nca3PvA4BORUOCh3379qkKfskll/zpT38yT7dQ1bykpKSgoEAdi0GDBrnvXTypaX369JGOYq9yR3T6wt69e3uOG02lf//+Mjhq1Ch3RI5lZMCAAdos77U2988C0KloSDDV1tZ+61vfOlv1HWfgwIHV1dWnW75LpkbeeOON01rzkPc6DQ0NCxYsUDcfe+wx84qatKv8vmXnLqysrKyvr3///ff1caOpFBUVyaC893JHxo8fLyMyrs3yXmtzrDsDoDPQkGBSTaKwsPChhx7q0aOHHA8bNuzAgQPr169X40eOHDndWs3Ly8vVqj179qiR2bNnp1wuVdpVwQ2pX79+TU1N9njahjRu3DgZSSQS2izvtTb7zgDoDDQkmPr27SslWN4kyfGvf/1rVbVHjhw5fPhwOZg0aZKapsbdon/q1Ck1ct1117mXsqVdFdyQpK94jqf9lp3cf6ej37Ljp7KAaNCQYJK3EVKmr7rqKnXz3nvvVYVbFBQUvPbaa2pcjQS81/GUdpX7ce1za1qoQbt5eI7bH2ro2bOn09EPNQCIBg0JptGjR6tKLa2ooaGhqqqqpKREjch7hWPHjqlpasRp+Sy1THM/mPf444+nXi9F2lXf+c531Mi2bdvshXbz8Bw3PvYtX9XNjn3sG0A0aEgwyXsg9SbJ07x589Q0dbNjn7ILWOU2D5e+0G4enuNpfzBWUeP2NQFkBQ0JHrZu3Tp9+vQ+ffp07979a1/72pw5c1599dWrr75aVfAnnnjitFbN1c8hSQ8bP36832fEXWlXyRuaH/7wh1/5ylfcz4UbC92ZweP19fWLFy8uKyvr0aOHfJVjGTHm+K0FkBU0JEQq4z0gzAXDrAWQcTQkRCrjPUBdUOnYr2TN4J0BEAYNCZmnl3udeyqDPUC/fuc1pK7+u88XLVo0cuRI99/ttBVJ+qqM/xWAtqMhIfP0Aqcz53URXf13nxvjjnU1/VTG/wpA29GQgDS6+u8+F7fffvu6desqKioCrua3FogMDQlIo6v/7nNXcHsLXgtEgIYEpNHVf/e5i4aEmKMhAUFy4Hefu/yupgSvBSJAQwKC5MDvPnf5XU0JXgtEgIYEBMmB333u8ruaErwWiAANCQiSA7/73EVDQszRkIAgOfC7z8XBFmPHjlUT1E2hz/FbC0SGhgQEyYHffe6O2+w59logMjQkII0c+N3natxmz7HXApGhIQFZk/EeEOaCYdYCGUFDArIm4z1AXVDp2K9kzeCdAdqLhgR0Lr3c69xTGewB+vVpSOhyaEhA59LLvc6cB+Q9GhIAIBZoSACAWKAhAQBigYYEAIgFGhIAIBZoSACAWKAhAQBigYYEAIgFGhIAIBZoSACAWKAhAQBigYYEAIgFGhIAIBZoSACAWKAhAQBigYYEAIgFGhIAIBZoSACAWKAhAQBigYYEAIgFGhIAIBZoSACAWKAhAQBiwaMhAQCQRTQkAEAs0JAAALHw/8bUJJj03iCAAAAAAElFTkSuQmCC" />
</p>
<h2 id="name-lookupと名前空間">name lookupと名前空間
<a id="SS_5_4"></a></h2>
<p>ここではname lookupとそれに影響を与える名前空間について解説する。</p>
<h3 id="ルックアップ">ルックアップ <a id="SS_5_4_1"></a></h3>
<p>このドキュメントでのルックアップとは<a href="#SS_5_4_2">name
lookup</a>を指す。</p>
<h3 id="name-lookup">name lookup <a id="SS_5_4_2"></a></h3>
<p><a href="https://en.cppreference.com/w/cpp/language/lookup">name
lookup</a>
とはソースコードで名前が検出された時に、その名前をその宣言と関連付けることである。
以下、name lookupの例を上げる。</p>
<p>下記のようなコードがあった場合、</p>
<div class="sourceCode" id="cb617"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb617-1"><a href="#cb617-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/name_lookup_ut.cpp 5</span></span>
<span id="cb617-2"><a href="#cb617-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb617-3"><a href="#cb617-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> NS_LU <span class="op">{</span></span>
<span id="cb617-4"><a href="#cb617-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> f<span class="op">()</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb617-5"><a href="#cb617-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace NS_LU</span></span></code></pre></div>
<p>以下のコードでの関数呼び出しf()のname lookupは、</p>
<div class="sourceCode" id="cb618"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb618-1"><a href="#cb618-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/name_lookup_ut.cpp 29</span></span>
<span id="cb618-2"><a href="#cb618-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb618-3"><a href="#cb618-3" aria-hidden="true" tabindex="-1"></a>    NS_LU<span class="op">::</span>f<span class="op">();</span></span></code></pre></div>
<ol type="1">
<li>NS_LUをその前方で宣言された名前空間と関連付けする</li>
<li>f()呼び出しをその前方の名前空間NS_LUで宣言された関数fと関連付ける</li>
</ol>
<p>という手順で行われる。</p>
<p>下記のようなコードがあった場合、</p>
<div class="sourceCode" id="cb619"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb619-1"><a href="#cb619-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/name_lookup_ut.cpp 11</span></span>
<span id="cb619-2"><a href="#cb619-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb619-3"><a href="#cb619-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> NS_LU <span class="op">{</span></span>
<span id="cb619-4"><a href="#cb619-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bool</span> g<span class="op">(</span><span class="dt">int</span> i<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> i <span class="op">&lt;</span> <span class="dv">0</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb619-5"><a href="#cb619-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb619-6"><a href="#cb619-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> g<span class="op">(</span><span class="bu">std::</span>string_view<span class="op"> </span>str<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> str<span class="op">[</span><span class="dv">0</span><span class="op">];</span> <span class="op">}</span></span>
<span id="cb619-7"><a href="#cb619-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb619-8"><a href="#cb619-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">,</span> <span class="dt">size_t</span> N<span class="op">&gt;</span></span>
<span id="cb619-9"><a href="#cb619-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">size_t</span> g<span class="op">(</span>T <span class="at">const</span> <span class="op">(&amp;)[</span>N<span class="op">])</span> <span class="kw">noexcept</span></span>
<span id="cb619-10"><a href="#cb619-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb619-11"><a href="#cb619-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> N<span class="op">;</span></span>
<span id="cb619-12"><a href="#cb619-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>以下のコードでの関数呼び出しg()のname lookupは、</p>
<div class="sourceCode" id="cb620"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb620-1"><a href="#cb620-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/name_lookup_ut.cpp 37</span></span>
<span id="cb620-2"><a href="#cb620-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> a<span class="op">[</span><span class="dv">3</span><span class="op">]{</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">};</span></span>
<span id="cb620-3"><a href="#cb620-3" aria-hidden="true" tabindex="-1"></a>    NS_LU<span class="op">::</span>g<span class="op">(</span>a<span class="op">);</span></span></code></pre></div>
<ol type="1">
<li>NS_LUをその前方で宣言された名前空間と関連付けする</li>
<li>名前空間NS_LU内で宣言された複数のgを見つける</li>
<li>g()呼び出しを、 すでに見つけたgの中からベストマッチしたg(T const
(&amp;)[N])と関連付ける</li>
</ol>
<p>という手順で行われる。</p>
<p>下記記のようなコードがあった場合、</p>
<div class="sourceCode" id="cb621"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb621-1"><a href="#cb621-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/name_lookup_ut.cpp 44</span></span>
<span id="cb621-2"><a href="#cb621-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb621-3"><a href="#cb621-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// グローバル名前空間</span></span>
<span id="cb621-4"><a href="#cb621-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>string<span class="op"> </span>ToString<span class="op">(</span><span class="dt">int</span> i<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> <span class="bu">std::</span>to_string<span class="op">(</span>i<span class="op">)</span> <span class="op">+</span> <span class="st">&quot; in Global&quot;</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb621-5"><a href="#cb621-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb621-6"><a href="#cb621-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> NS_LU <span class="op">{</span></span>
<span id="cb621-7"><a href="#cb621-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> X <span class="op">{</span></span>
<span id="cb621-8"><a href="#cb621-8" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> i<span class="op">;</span></span>
<span id="cb621-9"><a href="#cb621-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb621-10"><a href="#cb621-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb621-11"><a href="#cb621-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>string<span class="op"> </span>ToString<span class="op">(</span>X <span class="at">const</span><span class="op">&amp;</span> x<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> <span class="bu">std::</span>to_string<span class="op">(</span>x<span class="op">.</span>i<span class="op">)</span> <span class="op">+</span> <span class="st">&quot; in NS_LU&quot;</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb621-12"><a href="#cb621-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace NS_LU</span></span>
<span id="cb621-13"><a href="#cb621-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb621-14"><a href="#cb621-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> NS2 <span class="op">{</span></span>
<span id="cb621-15"><a href="#cb621-15" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>string<span class="op"> </span>ToString<span class="op">(</span>NS_LU<span class="op">::</span>X <span class="at">const</span><span class="op">&amp;</span> x<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> <span class="bu">std::</span>to_string<span class="op">(</span>x<span class="op">.</span>i<span class="op">)</span> <span class="op">+</span> <span class="st">&quot; in NS2&quot;</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb621-16"><a href="#cb621-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace NS2</span></span></code></pre></div>
<p>以下のコードでの関数呼び出しToString()のname lookupは、</p>
<div class="sourceCode" id="cb622"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb622-1"><a href="#cb622-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/name_lookup_ut.cpp 65</span></span>
<span id="cb622-2"><a href="#cb622-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb622-3"><a href="#cb622-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> x <span class="op">=</span> NS_LU<span class="op">::</span>X<span class="op">{</span><span class="dv">1</span><span class="op">};</span></span>
<span id="cb622-4"><a href="#cb622-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb622-5"><a href="#cb622-5" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;1 in NS_LU&quot;</span><span class="op">,</span> ToString<span class="op">(</span>x<span class="op">));</span></span></code></pre></div>
<ol type="1">
<li>ToString()呼び出しの引数xの型Xが名前空間NS_LUで定義されているため、
ToStringを探索する名前空間にNS_LUを組み入れる(「<a
href="#SS_5_4_6">関連名前空間</a>」参照)</li>
<li>ToString()呼び出しより前方で宣言されたグローバル名前空間とNS_LUの中から、
複数のToStringの定義を見つける</li>
<li>ToString()呼び出しを、
すでに見つけたToStringの中からベストマッチしたNS_LU::ToStringと関連付ける</li>
</ol>
<p>という手順で行われる。</p>
<h3 id="two-phase-name-lookup">two phase name lookup
<a id="SS_5_4_3"></a></h3>
<p><a
href="https://en.cppreference.com/w/cpp/language/two-phase_lookup">two
phase name lookup</a>
とはテンプレートをインスタンス化するときに使用される、下記のような2段階でのname
lookupである。</p>
<ol type="1">
<li>テンプレート定義内でname lookupを行う(通常のname lookupと同じ)。
この時、テンプレートパラメータに依存した名前 (<a
href="https://en.cppreference.com/w/cpp/language/dependent_name">dependent_name</a>)は
name lookupの対象外となる(name lookupの対象が確定しないため)。</li>
<li>1の後、テンプレートパラメータを展開した関数内で、 <a
href="#SS_5_4_6">関連名前空間</a>の宣言も含めたname lookupを行う。</li>
</ol>
<p>以下の議論では、</p>
<ul>
<li>上記1のname lookupを1st name lookup</li>
<li>上記2のname lookupを2nd name lookup</li>
</ul>
<p>と呼ぶことにする。</p>
<p>下記のようなコードがあった場合、</p>
<div class="sourceCode" id="cb623"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb623-1"><a href="#cb623-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/two_phase_name_lookup_ut.cpp 5</span></span>
<span id="cb623-2"><a href="#cb623-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb623-3"><a href="#cb623-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> NS_TPLU <span class="op">{</span></span>
<span id="cb623-4"><a href="#cb623-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> X <span class="op">{</span></span>
<span id="cb623-5"><a href="#cb623-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> i<span class="op">;</span></span>
<span id="cb623-6"><a href="#cb623-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb623-7"><a href="#cb623-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace NS_TPLU</span></span>
<span id="cb623-8"><a href="#cb623-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb623-9"><a href="#cb623-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">// グローバル名前空間</span></span>
<span id="cb623-10"><a href="#cb623-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">inline</span> <span class="bu">std::</span>string<span class="op"> </span>ToType<span class="op">(</span>NS_TPLU<span class="op">::</span>X <span class="at">const</span><span class="op">&amp;)</span> <span class="op">{</span> <span class="cf">return</span> <span class="st">&quot;X in global&quot;</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb623-11"><a href="#cb623-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">inline</span> <span class="bu">std::</span>string<span class="op"> </span>ToType<span class="op">(</span><span class="dt">int</span> <span class="at">const</span><span class="op">&amp;)</span> <span class="op">{</span> <span class="cf">return</span> <span class="st">&quot;int in global&quot;</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb623-12"><a href="#cb623-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb623-13"><a href="#cb623-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 再びNS_TPLU</span></span>
<span id="cb623-14"><a href="#cb623-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> NS_TPLU <span class="op">{</span></span>
<span id="cb623-15"><a href="#cb623-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb623-16"><a href="#cb623-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>string<span class="op"> </span>Header<span class="op">(</span><span class="dt">long</span><span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> <span class="st">&quot;type:&quot;</span><span class="op">;</span> <span class="op">}</span>  <span class="co">//  下記にもオーバーロードあり</span></span>
<span id="cb623-17"><a href="#cb623-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb623-18"><a href="#cb623-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb623-19"><a href="#cb623-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>string<span class="op"> </span>ToType<span class="op">(</span>T <span class="at">const</span><span class="op">&amp;)</span>  <span class="co">//  下記にもオーバーロードあり</span></span>
<span id="cb623-20"><a href="#cb623-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb623-21"><a href="#cb623-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&quot;unknown&quot;</span><span class="op">;</span></span>
<span id="cb623-22"><a href="#cb623-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb623-23"><a href="#cb623-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb623-24"><a href="#cb623-24" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb623-25"><a href="#cb623-25" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>string<span class="op"> </span>TypeName<span class="op">(</span>T <span class="at">const</span><span class="op">&amp;</span> t<span class="op">)</span>  <span class="co">// オーバーロードなし</span></span>
<span id="cb623-26"><a href="#cb623-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb623-27"><a href="#cb623-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> Header<span class="op">(</span><span class="dt">int</span><span class="op">{})</span> <span class="op">+</span> ToType<span class="op">(</span>t<span class="op">);</span></span>
<span id="cb623-28"><a href="#cb623-28" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb623-29"><a href="#cb623-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb623-30"><a href="#cb623-30" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>string<span class="op"> </span>Header<span class="op">(</span><span class="dt">int</span><span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> <span class="st">&quot;TYPE:&quot;</span><span class="op">;</span> <span class="op">}</span>  <span class="co">// 上記にもオーバーロードあり</span></span>
<span id="cb623-31"><a href="#cb623-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb623-32"><a href="#cb623-32" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>string<span class="op"> </span>ToType<span class="op">(</span>X <span class="at">const</span><span class="op">&amp;)</span> <span class="op">{</span> <span class="cf">return</span> <span class="st">&quot;X&quot;</span><span class="op">;</span> <span class="op">}</span>      <span class="co">// 上記にもオーバーロードあり</span></span>
<span id="cb623-33"><a href="#cb623-33" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>string<span class="op"> </span>ToType<span class="op">(</span><span class="dt">int</span> <span class="at">const</span><span class="op">&amp;)</span> <span class="op">{</span> <span class="cf">return</span> <span class="st">&quot;int&quot;</span><span class="op">;</span> <span class="op">}</span>  <span class="co">// 上記にもオーバーロードあり</span></span>
<span id="cb623-34"><a href="#cb623-34" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace NS_TPLU</span></span></code></pre></div>
<p>以下のコードでのTypeNameのインスタンス化に伴うname lookupは、</p>
<div class="sourceCode" id="cb624"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb624-1"><a href="#cb624-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/two_phase_name_lookup_ut.cpp 44</span></span>
<span id="cb624-2"><a href="#cb624-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb624-3"><a href="#cb624-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> x <span class="op">=</span> NS_TPLU<span class="op">::</span>X<span class="op">{</span><span class="dv">1</span><span class="op">};</span></span>
<span id="cb624-4"><a href="#cb624-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb624-5"><a href="#cb624-5" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;type:X&quot;</span><span class="op">,</span> TypeName<span class="op">(</span>x<span class="op">));</span></span></code></pre></div>
<ol type="1">
<li>TypeName()呼び出しの引数xの型Xが名前空間NS_TPLUで宣言されているため、
NS_TPLUをTypeNameを探索する<a
href="#SS_5_4_6">関連名前空間</a>にする。</li>
<li>TypeName()呼び出しより前方で宣言されたグローバル名前空間とNS_TPLUの中からTypeNameを見つける。</li>
<li>TypeNameは関数テンプレートであるためtwo phase
lookupが以下のように行われる。
<ol type="1">
<li>TypeName内でのHeader(int{})の呼び出しは、1st name lookupにより、
Header(long)の宣言と関連付けられる。
Header(int)はHeader(long)よりもマッチ率が高い、
TypeNameの定義より後方で宣言されているため、name
lookupの対象外となる。</li>
<li>TypeName内でのToType(t)の呼び出しに対しては、2nd name
lookupが行われる。
このためTypeName定義より前方で宣言されたグローバル名前空間と、
tの型がNS_TPLU::Xであるため<a
href="#SS_5_4_6">関連名前空間</a>となったNS_TPLUがname
lookupの対象となるが、 グローバル名前空間内のToTypeは、
NS_TPLU内でTypeNameより前に宣言されたtemplate&lt;&gt; ToTypeによって<a
href="#SS_5_4_8">name-hiding</a>が起こり、
TypeNameからは非可視となるためname lookupの対象から外れる。
このため、ToType(t)の呼び出しは、NS_TPLU::ToType(X
const&amp;)の宣言と関連付けられる。</li>
</ol></li>
</ol>
<p>という手順で行われる。</p>
<p>上と同じ定義、宣言がある場合の以下のコードでのTypeNameのインスタンス化に伴うname
lookupは、</p>
<div class="sourceCode" id="cb625"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb625-1"><a href="#cb625-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/two_phase_name_lookup_ut.cpp 50</span></span>
<span id="cb625-2"><a href="#cb625-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb625-3"><a href="#cb625-3" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;type:unknown&quot;</span><span class="op">,</span> NS_TPLU<span class="op">::</span>TypeName<span class="op">(</span><span class="dt">int</span><span class="op">{}));</span></span></code></pre></div>
<ol type="1">
<li>NS_TPLUを名前空間と関連付けする (引数の型がintなのでNS_TPLUは<a
href="#SS_5_4_6">関連名前空間</a>とならず、NS_TPLUを明示する必要がある)。</li>
<li>TypeName()呼び出しより前方で宣言されたNS_TPLUの中からTypeNameを見つける。</li>
<li>TypeNameは関数テンプレートであるためtwo phase
lookupが以下のように行われる。
<ol type="1">
<li>TypeName内でのHeader(int{})の呼び出しは、1st name lookupにより、
前例と同じ理由で、Header(long)の宣言と関連付けられる。</li>
<li>TypeName内でのToType(t)の呼び出しに対しては、2nd name
lookupが行われる。 tの型がintであるためNS_TPLUは<a
href="#SS_5_4_6">関連名前空間</a>とならず、通常のname lookupと同様に
ToType(t)の呼び出し前方のグローバル名前空間とNS_TPLUがname
lookupの対象になるが、 グローバル名前空間内のToTypeは、
NS_TPLU内でTypeNameより前に宣言されたtemplate&lt;&gt; ToTypeによって<a
href="#SS_5_4_8">name-hiding</a>が起こり、
TypeNameからは非可視となるためname lookupの対象から外れる。
また、ToType(int
const&amp;)は、TypeNameの定義より後方で宣言されているため、 name
lookupの対象外となり、
その結果、ToType(t)の呼び出しは、NS_TPLU内のtemplate&lt;&gt;
ToTypeの宣言と関連付けられる。</li>
</ol></li>
</ol>
<p>という手順で行われる。</p>
<p>以上の理由から、先に示した例でのToTypeの戻り値は”X”となり、
後に示した例でのToTypeの戻り値は”unknown”となる。 これはtwo phase
lookupの結果であり、 two phase
lookupが実装されていないコンパイラ(こういったコンパイラは存在する)では、
結果が異なるため注意が必要である
(本ドキュメントではこのような問題をできる限り避けるために、
サンプルコードを<a href="#SS_5_9_1">g++</a>と<a
href="#SS_5_9_2">clang++</a>でコンパイルしている)。</p>
<p>以下に、two phase lookupにまつわるさらに驚くべきコード例を紹介する。
上と同じ定義、宣言がある場合の以下のコードの動作を考える。</p>
<div class="sourceCode" id="cb626"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb626-1"><a href="#cb626-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/two_phase_name_lookup_ut.cpp 54</span></span>
<span id="cb626-2"><a href="#cb626-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb626-3"><a href="#cb626-3" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;type:long&quot;</span><span class="op">,</span> NS_TPLU<span class="op">::</span>TypeName<span class="op">(</span><span class="dt">long</span><span class="op">{}));</span></span></code></pre></div>
<p>NS_TPLU::TypeName(int{})のintをlongにしただけなので、この単体テストはパスしないが、
この単体テストコードの後(実際にはこのファイルのコンパイル単位の中のNS_TPLU内で、
且つtemplate&lt;&gt; ToTypeの宣言の後方であればどこでもよい)
に以下のコードを追加するとパスしてしまう。</p>
<div class="sourceCode" id="cb627"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb627-1"><a href="#cb627-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/two_phase_name_lookup_ut.cpp 61</span></span>
<span id="cb627-2"><a href="#cb627-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb627-3"><a href="#cb627-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> NS_TPLU <span class="op">{</span></span>
<span id="cb627-4"><a href="#cb627-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;&gt;</span></span>
<span id="cb627-5"><a href="#cb627-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>string<span class="op"> </span>ToType<span class="op">&lt;</span><span class="dt">long</span><span class="op">&gt;(</span><span class="dt">long</span> <span class="at">const</span><span class="op">&amp;)</span></span>
<span id="cb627-6"><a href="#cb627-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb627-7"><a href="#cb627-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&quot;long&quot;</span><span class="op">;</span></span>
<span id="cb627-8"><a href="#cb627-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb627-9"><a href="#cb627-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace NS_TPLU</span></span></code></pre></div>
<p>この理由は、関数テンプレート内での2nd name
lookupで選択された名前が関数テンプレートであった場合、
その特殊化の検索範囲はコンパイル単位内になることがあるからである (<a
href="https://en.cppreference.com/w/cpp/language/template_specialization">template_specialization</a>
によるとこの動作は未定義のようだが、 <a href="#SS_5_9_1">g++</a>/<a
href="#SS_5_9_2">clang++</a>両方ともこのコードを警告なしでコンパイルする)。</p>
<p>TypeName(long{})内でのtwo phase name
lookupは、TypeName(int{})とほぼ同様に進み、 template&lt;&gt;
ToTypeの宣言を探し出すが、
さらに前述したようにこのコンパイル単位のNS_TPLU内からその特殊化も探し出す。
その結果、ToType(t)の呼び出しは、NS_TPLU内のtemplate&lt;&gt;
ToType&lt;long&gt;の定義と関連付けられる。</p>
<p>以上の議論からわかる通り、関数テンプレートとその特殊化の組み合わせは、
そのインスタンス化箇所(この場合単体テストコード内)の後方から、 name
lookupでバインドされる関数を変更することができるため、
極めて分かりづらいコードを生み出す。ここから、</p>
<ul>
<li>関数テンプレートとその特殊化はソースコード上なるべく近い位置で宣言するべきである</li>
<li>STL関数テンプレートの特殊化は行うべきではない</li>
</ul>
<p>という教訓が得られる。</p>
<p>なお、関数とその関数オーバーロードのname
lookupの対象は、呼び出し箇所前方の宣言のみであるため、
関数テンプレートToType(T const&amp;
t)の代わりに、関数ToType(…)を使うことで、 上記問題は回避可能である。</p>
<p>次に示す例は、一見2nd name
lookupで関連付けされるように見える関数ToType(NS_TPLU2::Y const&amp;)が、
実際には関連付けされないコードである。</p>
<div class="sourceCode" id="cb628"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb628-1"><a href="#cb628-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/two_phase_name_lookup_ut.cpp 71</span></span>
<span id="cb628-2"><a href="#cb628-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb628-3"><a href="#cb628-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> NS_TPLU2 <span class="op">{</span></span>
<span id="cb628-4"><a href="#cb628-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> Y <span class="op">{</span></span>
<span id="cb628-5"><a href="#cb628-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> i<span class="op">;</span></span>
<span id="cb628-6"><a href="#cb628-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb628-7"><a href="#cb628-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace NS_TPLU2</span></span></code></pre></div>
<div class="sourceCode" id="cb629"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb629-1"><a href="#cb629-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/two_phase_name_lookup_ut.cpp 79</span></span>
<span id="cb629-2"><a href="#cb629-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb629-3"><a href="#cb629-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// global名前空間</span></span>
<span id="cb629-4"><a href="#cb629-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb629-5"><a href="#cb629-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>string<span class="op"> </span>ToType<span class="op">(</span>T <span class="at">const</span><span class="op">&amp;)</span></span>
<span id="cb629-6"><a href="#cb629-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb629-7"><a href="#cb629-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&quot;unknown&quot;</span><span class="op">;</span></span>
<span id="cb629-8"><a href="#cb629-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb629-9"><a href="#cb629-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb629-10"><a href="#cb629-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb629-11"><a href="#cb629-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>string<span class="op"> </span>TypeName<span class="op">(</span>T <span class="at">const</span><span class="op">&amp;</span> t<span class="op">)</span></span>
<span id="cb629-12"><a href="#cb629-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb629-13"><a href="#cb629-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&quot;type:&quot;</span> <span class="op">+</span> ToType<span class="op">(</span>t<span class="op">);</span></span>
<span id="cb629-14"><a href="#cb629-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb629-15"><a href="#cb629-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb629-16"><a href="#cb629-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>string<span class="op"> </span>ToType<span class="op">(</span>NS_TPLU2<span class="op">::</span>Y <span class="at">const</span><span class="op">&amp;)</span> <span class="op">{</span> <span class="cf">return</span> <span class="st">&quot;Y&quot;</span><span class="op">;</span> <span class="op">}</span></span></code></pre></div>
<p>これは先に示したNS_TPLU::Xの例と極めて似ている。本質的な違いは、
TypeNameやToTypeがグローバル名前空間で宣言されていることのみである。
だが、下記の単体テストで示す通り、 TypeName内でのname
lookupで関数オーバーライドToType(NS_TPLU2::Y
const&amp;)が選択されないのである。</p>
<div class="sourceCode" id="cb630"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb630-1"><a href="#cb630-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/two_phase_name_lookup_ut.cpp 100</span></span>
<span id="cb630-2"><a href="#cb630-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb630-3"><a href="#cb630-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> y <span class="op">=</span> NS_TPLU2<span class="op">::</span>Y<span class="op">{</span><span class="dv">1</span><span class="op">};</span></span>
<span id="cb630-4"><a href="#cb630-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb630-5"><a href="#cb630-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ASSERT_EQ(&quot;type:Y&quot;, TypeName(y));</span></span>
<span id="cb630-6"><a href="#cb630-6" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;type:unknown&quot;</span><span class="op">,</span> TypeName<span class="op">(</span>y<span class="op">));</span>  <span class="co">// ToType(NS_TPLU2::Y const&amp;)は使われない</span></span></code></pre></div>
<p>ここまでの現象を正確に理解するには、 「two phase
lookupの対象となる宣言」を下記のように、より厳密に認識する必要がある。</p>
<ul>
<li>TypeNameの中で行われる1st name
lookupの対象となる宣言は下記の積集合である。
<ul>
<li>TypeNameと同じ名前空間内かグローバル名前空間内の宣言</li>
<li>TypeName定義位置より前方の宣言</li>
</ul></li>
<li>TypeNameの中で行われる2nd name
lookupの対象となる宣言は下記の和集合である。
<ul>
<li>1st name lookupで使われた宣言</li>
<li>TypeName呼び出しより前方にある<a
href="#SS_5_4_6">関連名前空間</a>内の宣言</li>
</ul></li>
</ul>
<p>この認識に基づくNS_TPLU2::Yに対するグローバルなTypeName内でのtwo
phase name lookupは、</p>
<ol type="1">
<li>TypeName内に1st name lookupの対象がないため何もしない。</li>
<li>TypeName内の2nd name lookupに使用される<a
href="#SS_5_4_6">関連名前空間</a>NS_TPLU2は、 ToType(NS_TPLU2::Y
const&amp;)の宣言を含まないため、この宣言は2nd name
lookupの対象とならない。
その結果、ToType(t)の呼び出しは関数テンプレートToType(T
const&amp;)と関連付けられる。</li>
</ol>
<p>という手順で行われる。</p>
<p>以上が、TypeNameからToType(NS_TPLU2::Y
const&amp;)が使われない理由である。</p>
<p>ここまでで示したようにtwo phase name lookupは理解しがたく、
理解したとしてもその使いこなしはさらに難しい。</p>
<p>次のコードは、この難解さに翻弄されるのが現場のプログラマのみではないことを示す。</p>
<div class="sourceCode" id="cb631"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb631-1"><a href="#cb631-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/two_phase_name_lookup_ut.cpp 71</span></span>
<span id="cb631-2"><a href="#cb631-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb631-3"><a href="#cb631-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> NS_TPLU2 <span class="op">{</span></span>
<span id="cb631-4"><a href="#cb631-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> Y <span class="op">{</span></span>
<span id="cb631-5"><a href="#cb631-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> i<span class="op">;</span></span>
<span id="cb631-6"><a href="#cb631-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb631-7"><a href="#cb631-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace NS_TPLU2</span></span></code></pre></div>
<div class="sourceCode" id="cb632"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb632-1"><a href="#cb632-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/two_phase_name_lookup_ut.cpp 110</span></span>
<span id="cb632-2"><a href="#cb632-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb632-3"><a href="#cb632-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// global名前空間</span></span>
<span id="cb632-4"><a href="#cb632-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb632-5"><a href="#cb632-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> <span class="kw">operator</span><span class="op">+(</span>T <span class="at">const</span><span class="op">&amp;,</span> <span class="dt">int</span> i<span class="op">)</span></span>
<span id="cb632-6"><a href="#cb632-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb632-7"><a href="#cb632-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> i<span class="op">;</span></span>
<span id="cb632-8"><a href="#cb632-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb632-9"><a href="#cb632-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb632-10"><a href="#cb632-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb632-11"><a href="#cb632-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> TypeNum<span class="op">(</span>T <span class="at">const</span><span class="op">&amp;</span> t<span class="op">)</span></span>
<span id="cb632-12"><a href="#cb632-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb632-13"><a href="#cb632-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> t <span class="op">+</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb632-14"><a href="#cb632-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb632-15"><a href="#cb632-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb632-16"><a href="#cb632-16" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> <span class="kw">operator</span><span class="op">+(</span>NS_TPLU2<span class="op">::</span>Y <span class="at">const</span><span class="op">&amp;</span> y<span class="op">,</span> <span class="dt">int</span> i<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> y<span class="op">.</span>i <span class="op">+</span> i<span class="op">;</span> <span class="op">}</span></span></code></pre></div>
<p>上記の宣言、定義があった場合、operator+の単体テストは以下のようになる。</p>
<div class="sourceCode" id="cb633"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb633-1"><a href="#cb633-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/two_phase_name_lookup_ut.cpp 132</span></span>
<span id="cb633-2"><a href="#cb633-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb633-3"><a href="#cb633-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> y <span class="op">=</span> NS_TPLU2<span class="op">::</span>Y<span class="op">{</span><span class="dv">1</span><span class="op">};</span></span>
<span id="cb633-4"><a href="#cb633-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb633-5"><a href="#cb633-5" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">1</span><span class="op">,</span> y <span class="op">+</span> <span class="dv">0</span><span class="op">);</span>  <span class="co">// 2つ目のoperator+が選択される</span></span></code></pre></div>
<p>このテストは当然パスするが、次はどうだろう？</p>
<div class="sourceCode" id="cb634"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb634-1"><a href="#cb634-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/two_phase_name_lookup_ut.cpp 142</span></span>
<span id="cb634-2"><a href="#cb634-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb634-3"><a href="#cb634-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> y <span class="op">=</span> NS_TPLU2<span class="op">::</span>Y<span class="op">{</span><span class="dv">1</span><span class="op">};</span></span>
<span id="cb634-4"><a href="#cb634-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb634-5"><a href="#cb634-5" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">1</span><span class="op">,</span> TypeNum<span class="op">(</span>y<span class="op">));</span>  <span class="co">// g++ではoperator+(NS_TPLU2::Y const&amp;, int i)がname lookupされる</span></span></code></pre></div>
<p>これまでのtwo phase name lookupの説明では、 operator+(NS_TPLU2::Y
const&amp; y, int i)はTypeNum内でのname lookupの対象にはならないため、
このテストはエラーとならなければならないが、<a
href="#SS_5_9_1">g++</a>ではパスしてしまう。 2nd name
lookupのロジックにバグがあるようである。</p>
<p>有難いことに、<a
href="#SS_5_9_2">clang++</a>では仕様通りこのテストはエラーとなり、
当然ながら以下のテストはパスする(つまり、g++ではエラーする)。</p>
<div class="sourceCode" id="cb635"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb635-1"><a href="#cb635-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/two_phase_name_lookup_ut.cpp 151</span></span>
<span id="cb635-2"><a href="#cb635-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb635-3"><a href="#cb635-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> y <span class="op">=</span> NS_TPLU2<span class="op">::</span>Y<span class="op">{</span><span class="dv">1</span><span class="op">};</span></span>
<span id="cb635-4"><a href="#cb635-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb635-5"><a href="#cb635-5" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">0</span><span class="op">,</span> TypeNum<span class="op">(</span>y<span class="op">));</span>  <span class="co">// clang++ではoperator+(T const&amp;, int i)がname lookupされる</span></span></code></pre></div>
<p>なお、TypeNum内のコードである</p>
<div class="sourceCode" id="cb636"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb636-1"><a href="#cb636-1" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> t <span class="op">+</span> <span class="dv">0</span><span class="op">;</span></span></code></pre></div>
<p>を下記のように変更することで</p>
<div class="sourceCode" id="cb637"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb637-1"><a href="#cb637-1" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">operator</span><span class="op">+(</span>t<span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span></code></pre></div>
<p>g++のname lookupはclang++と同じように動作するため、
記法に違和感があるものの、この方法はg++のバグのワークアランドとして使用できる。</p>
<p>また、operator+(NS_TPLU2::Y const&amp; y, int
i)をNS_TPLU2で宣言することで、
g++ではパスしたテストをclang++でもパスさせられるようになる(これは正しい動作)。
これにより、型とその2項演算子オーバーロードは同じ名前空間で宣言するべきである、
という教訓が得られる。</p>
<p>以上で見てきたようにtwo phase name
lookupは、現場プログラマのみではなく、
コンパイラを開発するプログラマをも混乱させるほど難解ではあるが、
STLを含むテンプレートメタプログラミングを支える重要な機能であるため、
C++プログラマには、最低でもこれを理解し、出来れば使いこなせるようになってほしい。</p>
<h3 id="実引数依存探索">実引数依存探索 <a id="SS_5_4_4"></a></h3>
<p>実引数依存探索とは、argument-dependent lookupの和訳語であり、
通常はその略語である<a href="#SS_5_4_5">ADL</a>と呼ばれる。</p>
<h3 id="adl">ADL <a id="SS_5_4_5"></a></h3>
<p>ADLとは、関数の実引数の型が宣言されている名前空間(これを<a
href="#SS_5_4_6">関連名前空間</a>と呼ぶ)内の宣言が、 その関数の<a
href="#SS_5_4_2">name lookup</a>の対象になることである。</p>
<p>下記のようなコードがあった場合、</p>
<div class="sourceCode" id="cb638"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb638-1"><a href="#cb638-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/name_lookup_adl_ut.cpp 5</span></span>
<span id="cb638-2"><a href="#cb638-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> NS_ADL <span class="op">{</span></span>
<span id="cb638-3"><a href="#cb638-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> A <span class="op">{</span></span>
<span id="cb638-4"><a href="#cb638-4" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> i<span class="op">;</span></span>
<span id="cb638-5"><a href="#cb638-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb638-6"><a href="#cb638-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb638-7"><a href="#cb638-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>string<span class="op"> </span>ToString<span class="op">(</span>A <span class="at">const</span><span class="op">&amp;</span> a<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> <span class="bu">std::</span>string<span class="op">{</span><span class="st">&quot;A:&quot;</span><span class="op">}</span> <span class="op">+</span> <span class="bu">std::</span>to_string<span class="op">(</span>a<span class="op">.</span>i<span class="op">);</span> <span class="op">}</span></span>
<span id="cb638-8"><a href="#cb638-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace NS_ADL</span></span></code></pre></div>
<p>以下のコードでのToStringの呼び出しに対するのname lookupは、</p>
<div class="sourceCode" id="cb639"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb639-1"><a href="#cb639-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/name_lookup_adl_ut.cpp 18</span></span>
<span id="cb639-2"><a href="#cb639-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb639-3"><a href="#cb639-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> a <span class="op">=</span> NS_ADL<span class="op">::</span>A<span class="op">{</span><span class="dv">0</span><span class="op">};</span></span>
<span id="cb639-4"><a href="#cb639-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb639-5"><a href="#cb639-5" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;A:0&quot;</span><span class="op">,</span> ToString<span class="op">(</span>a<span class="op">));</span>  <span class="co">// ADLの効果により、ToStringはNS_ADLを指定しなくても見つかる</span></span></code></pre></div>
<ul>
<li>ToStringの呼び出しより前方で行われているグローバル名前空間内の宣言</li>
<li>ToStringの呼び出しより前方で行われているNS_ADL内の宣言</li>
</ul>
<p>の両方を対象として行われる。
NS_ADL内の宣言がToStringの呼び出しに対するのname
lookupの対象になる理由は、
ToStringの呼び出しに使われている実引数aの型AがNS_ADLで宣言されているからである。
すでに述べたようにこれをADLと呼び、この場合のNS_ADLを<a
href="#SS_5_4_6">関連名前空間</a>と呼ぶ。</p>
<p>ADLは思わぬname lookupによるバグを誘発することもあるが、
下記コードを見れば明らかなように、また、
多くのプログラマはそれと気づかずに使っていることからもわかる通り、
コードをより自然に、より簡潔に記述するための重要な機能となっている。</p>
<div class="sourceCode" id="cb640"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb640-1"><a href="#cb640-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/name_lookup_adl_ut.cpp 28</span></span>
<span id="cb640-2"><a href="#cb640-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb640-3"><a href="#cb640-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 下記operator &lt;&lt;は、std::operator&lt;&lt;(ostream&amp;, string const&amp;)であり、</span></span>
<span id="cb640-4"><a href="#cb640-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// namespace stdで定義されている。</span></span>
<span id="cb640-5"><a href="#cb640-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb640-6"><a href="#cb640-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ADLがあるため、operator &lt;&lt;は名前空間修飾無しで呼び出せる。</span></span>
<span id="cb640-7"><a href="#cb640-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>cout<span class="op"> &lt;&lt;</span> <span class="bu">std::</span>string<span class="op">{</span><span class="ot">__func__</span><span class="op">};</span></span>
<span id="cb640-8"><a href="#cb640-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb640-9"><a href="#cb640-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ADLが無いと下記のような呼び出しになる。</span></span>
<span id="cb640-10"><a href="#cb640-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>operator<span class="op">&lt;&lt;(</span><span class="bu">std::</span>cout<span class="op">,</span> <span class="bu">std::</span>string<span class="op">{</span><span class="ot">__func__</span><span class="op">});</span></span></code></pre></div>
<h3 id="関連名前空間">関連名前空間 <a id="SS_5_4_6"></a></h3>
<p>関連名前空間(associated namespace)とは、 <a
href="#SS_5_4_5">ADL</a>(実引数依存探索)によってname
lookupの対象になった宣言を含む名前空間のことである。</p>
<h3 id="sfinae">SFINAE <a id="SS_5_4_7"></a></h3>
<p><a
href="https://cpprefjp.github.io/lang/cpp11/sfinae_expressions.html">SFINAE</a>
(Substitution Failure Is Not An Errorの略称、スフィネェと読む)とは、
「テンプレートのパラメータ置き換えに失敗した(<a
href="#SS_5_10_8">ill-formed</a>になった)際に、
即時にコンパイルエラーとはせず、置き換えに失敗したテンプレートを <a
href="#SS_5_4_2">name lookup</a>の候補から除外する」
という言語機能である。</p>
<h3 id="name-hiding">name-hiding <a id="SS_5_4_8"></a></h3>
<p>name-hidingとは
「前方の識別子が、その後方に同一の名前をもつ識別子があるために、 <a
href="#SS_5_4_2">name
lookup</a>の対象外になる」現象一般をを指す通称である (<a
href="https://en.cppreference.com/w/cpp/language/namespace">namespace</a>参照)。</p>
<p>まずは、クラスとその派生クラスでのname-hidingの例を示す。</p>
<div class="sourceCode" id="cb641"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb641-1"><a href="#cb641-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/name_hiding.cpp 4</span></span>
<span id="cb641-2"><a href="#cb641-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-3"><a href="#cb641-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> Base <span class="op">{</span></span>
<span id="cb641-4"><a href="#cb641-4" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> f<span class="op">()</span> <span class="kw">noexcept</span> <span class="op">{}</span></span>
<span id="cb641-5"><a href="#cb641-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb641-6"><a href="#cb641-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-7"><a href="#cb641-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> Derived <span class="op">:</span> Base <span class="op">{</span></span>
<span id="cb641-8"><a href="#cb641-8" aria-hidden="true" tabindex="-1"></a>        <span class="co">// void f(int) { f(); }     // f()では、Baseのf()をname lookupできないため、</span></span>
<span id="cb641-9"><a href="#cb641-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> f<span class="op">(</span><span class="dt">int</span><span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span> Base<span class="op">::</span>f<span class="op">();</span> <span class="op">}</span>  <span class="co">// Base::でf()を修飾した</span></span>
<span id="cb641-10"><a href="#cb641-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>上記の関数fは一見オーバーロードに見えるが、そうではない。下記のコードで示したように、
Base::f()には、修飾しない形式でのDerivedクラス経由のアクセスはできない。</p>
<div class="sourceCode" id="cb642"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb642-1"><a href="#cb642-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/name_hiding.cpp 18</span></span>
<span id="cb642-2"><a href="#cb642-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb642-3"><a href="#cb642-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb642-4"><a href="#cb642-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> d <span class="op">=</span> Derived<span class="op">{};</span></span>
<span id="cb642-5"><a href="#cb642-5" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#if 0 </span></span>
<span id="cb642-6"><a href="#cb642-6" aria-hidden="true" tabindex="-1"></a><span class="co">        d.f(); // コンパイルできない</span></span>
<span id="cb642-7"><a href="#cb642-7" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="pp">#else</span></span>
<span id="cb642-8"><a href="#cb642-8" aria-hidden="true" tabindex="-1"></a>        d<span class="op">.</span>Base<span class="op">::</span>f<span class="op">();</span>  <span class="co">// Base::での修飾が必要</span></span>
<span id="cb642-9"><a href="#cb642-9" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#endif</span></span>
<span id="cb642-10"><a href="#cb642-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>これは前述したように、
Base::fがその後方にあるDerived::f(int)によりname-hidingされたために起こる現象である
(name
lookupによる探索には識別子が使われるため、シグネチャの違いはname-hidingに影響しない)。</p>
<p>下記のように<a href="#SS_5_4_13">using宣言</a>を使用することで、
修飾しない形式でのDerivedクラス経由のBase::f()へのアクセスが可能となる。</p>
<div class="sourceCode" id="cb643"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb643-1"><a href="#cb643-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/name_hiding.cpp 34</span></span>
<span id="cb643-2"><a href="#cb643-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb643-3"><a href="#cb643-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> Derived <span class="op">:</span> Base <span class="op">{</span></span>
<span id="cb643-4"><a href="#cb643-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> Base<span class="op">::</span>f<span class="op">;</span>  <span class="co">// using宣言によりDerivedにBase::fを導入</span></span>
<span id="cb643-5"><a href="#cb643-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> f<span class="op">(</span><span class="dt">int</span><span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span> Base<span class="op">::</span>f<span class="op">();</span> <span class="op">}</span></span>
<span id="cb643-6"><a href="#cb643-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb644"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb644-1"><a href="#cb644-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/name_hiding.cpp 45</span></span>
<span id="cb644-2"><a href="#cb644-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb644-3"><a href="#cb644-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> d <span class="op">=</span> Derived<span class="op">{};</span></span>
<span id="cb644-4"><a href="#cb644-4" aria-hidden="true" tabindex="-1"></a>    d<span class="op">.</span>f<span class="op">();</span>  <span class="co">// using宣言によりコンパイルできる</span></span></code></pre></div>
<p>下記コードは、名前空間でも似たような現象が起こることを示している。</p>
<div class="sourceCode" id="cb645"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb645-1"><a href="#cb645-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/name_hiding.cpp 54</span></span>
<span id="cb645-2"><a href="#cb645-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb645-3"><a href="#cb645-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// global名前空間</span></span>
<span id="cb645-4"><a href="#cb645-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> f<span class="op">()</span> <span class="kw">noexcept</span> <span class="op">{}</span></span>
<span id="cb645-5"><a href="#cb645-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb645-6"><a href="#cb645-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> NS_A <span class="op">{</span></span>
<span id="cb645-7"><a href="#cb645-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> f<span class="op">(</span><span class="dt">int</span><span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{}</span></span>
<span id="cb645-8"><a href="#cb645-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb645-9"><a href="#cb645-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> g<span class="op">()</span> <span class="kw">noexcept</span></span>
<span id="cb645-10"><a href="#cb645-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb645-11"><a href="#cb645-11" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#if 0</span></span>
<span id="cb645-12"><a href="#cb645-12" aria-hidden="true" tabindex="-1"></a><span class="co">        f();  // NS_A::fによりname-hidingされたため、コンパイルできない</span></span>
<span id="cb645-13"><a href="#cb645-13" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="pp">#endif</span></span>
<span id="cb645-14"><a href="#cb645-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb645-15"><a href="#cb645-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace NS_A</span></span></code></pre></div>
<p>この問題に対しては、下記のようにf(int)の定義位置を後方に移動することで回避できる。</p>
<div class="sourceCode" id="cb646"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb646-1"><a href="#cb646-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/name_hiding.cpp 70</span></span>
<span id="cb646-2"><a href="#cb646-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb646-3"><a href="#cb646-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> NS_A_fixed_0 <span class="op">{</span></span>
<span id="cb646-4"><a href="#cb646-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> g<span class="op">()</span> <span class="kw">noexcept</span></span>
<span id="cb646-5"><a href="#cb646-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb646-6"><a href="#cb646-6" aria-hidden="true" tabindex="-1"></a>        <span class="co">// グローバルなfの呼び出し</span></span>
<span id="cb646-7"><a href="#cb646-7" aria-hidden="true" tabindex="-1"></a>        f<span class="op">();</span>  <span class="co">// NS_A::fは後方に移動されたためコンパイルできる</span></span>
<span id="cb646-8"><a href="#cb646-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb646-9"><a href="#cb646-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb646-10"><a href="#cb646-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> f<span class="op">(</span><span class="dt">int</span><span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{}</span></span>
<span id="cb646-11"><a href="#cb646-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace NS_A_fixed_0</span></span></code></pre></div>
<p>また、先述のクラスでの方法と同様にusing宣言を使い、下記のようにすることもできる。</p>
<div class="sourceCode" id="cb647"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb647-1"><a href="#cb647-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/name_hiding.cpp 82</span></span>
<span id="cb647-2"><a href="#cb647-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb647-3"><a href="#cb647-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> NS_A_fixed_1 <span class="op">{</span></span>
<span id="cb647-4"><a href="#cb647-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> f<span class="op">(</span><span class="dt">int</span><span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{}</span></span>
<span id="cb647-5"><a href="#cb647-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb647-6"><a href="#cb647-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> g<span class="op">()</span> <span class="kw">noexcept</span></span>
<span id="cb647-7"><a href="#cb647-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb647-8"><a href="#cb647-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> <span class="op">::</span>f<span class="op">;</span></span>
<span id="cb647-9"><a href="#cb647-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb647-10"><a href="#cb647-10" aria-hidden="true" tabindex="-1"></a>        <span class="co">// グローバルなfの呼び出し</span></span>
<span id="cb647-11"><a href="#cb647-11" aria-hidden="true" tabindex="-1"></a>        f<span class="op">();</span>  <span class="co">// using宣言によりコンパイルできる</span></span>
<span id="cb647-12"><a href="#cb647-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb647-13"><a href="#cb647-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace NS_A_fixed_1</span></span></code></pre></div>
<p>当然ながら、下記のようにf()の呼び出しを::で修飾することもできる。</p>
<div class="sourceCode" id="cb648"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb648-1"><a href="#cb648-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/name_hiding.cpp 96</span></span>
<span id="cb648-2"><a href="#cb648-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb648-3"><a href="#cb648-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> NS_A_fixed_2 <span class="op">{</span></span>
<span id="cb648-4"><a href="#cb648-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> f<span class="op">(</span><span class="dt">int</span><span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{}</span></span>
<span id="cb648-5"><a href="#cb648-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb648-6"><a href="#cb648-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> g<span class="op">()</span> <span class="kw">noexcept</span></span>
<span id="cb648-7"><a href="#cb648-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb648-8"><a href="#cb648-8" aria-hidden="true" tabindex="-1"></a>        <span class="co">// グローバルなfの呼び出し</span></span>
<span id="cb648-9"><a href="#cb648-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">::</span>f<span class="op">();</span>  <span class="co">// ::で修飾すればコンパイルできる</span></span>
<span id="cb648-10"><a href="#cb648-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb648-11"><a href="#cb648-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace NS_A_fixed_2</span></span></code></pre></div>
<p>修飾の副作用として「<a href="#SS_5_4_3">two phase name
lookup</a>」の例で示したような <a
href="#SS_5_4_5">ADL</a>を利用した高度な静的ディスパッチが使用できなくなるが、
通常のソフトウェア開発では、ADLが必要な場面は限られているため、
デフォルトでは名前空間を使用して修飾を行うことにするのが、
無用の混乱をさけるための安全な記法であると言えるだろう。</p>
<p>次に、そういった混乱を引き起こすであろうコードを示す。</p>
<div class="sourceCode" id="cb649"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb649-1"><a href="#cb649-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/name_hiding.cpp 108</span></span>
<span id="cb649-2"><a href="#cb649-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb649-3"><a href="#cb649-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> NS_B <span class="op">{</span></span>
<span id="cb649-4"><a href="#cb649-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> S_in_B <span class="op">{};</span></span>
<span id="cb649-5"><a href="#cb649-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb649-6"><a href="#cb649-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> f<span class="op">(</span>S_in_B<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{}</span></span>
<span id="cb649-7"><a href="#cb649-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> f<span class="op">(</span><span class="dt">int</span><span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{}</span></span>
<span id="cb649-8"><a href="#cb649-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb649-9"><a href="#cb649-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> NS_B_Inner <span class="op">{</span></span>
<span id="cb649-10"><a href="#cb649-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> g<span class="op">()</span> <span class="kw">noexcept</span></span>
<span id="cb649-11"><a href="#cb649-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb649-12"><a href="#cb649-12" aria-hidden="true" tabindex="-1"></a>        f<span class="op">(</span><span class="dt">int</span><span class="op">{});</span>  <span class="co">// コンパイルでき、NS_B::f(int)が呼ばれる</span></span>
<span id="cb649-13"><a href="#cb649-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb649-14"><a href="#cb649-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb649-15"><a href="#cb649-15" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> f<span class="op">()</span> <span class="kw">noexcept</span> <span class="op">{}</span></span>
<span id="cb649-16"><a href="#cb649-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb649-17"><a href="#cb649-17" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> h<span class="op">()</span> <span class="kw">noexcept</span></span>
<span id="cb649-18"><a href="#cb649-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb649-19"><a href="#cb649-19" aria-hidden="true" tabindex="-1"></a>        <span class="co">// f(int{});     // コンパイルできない</span></span>
<span id="cb649-20"><a href="#cb649-20" aria-hidden="true" tabindex="-1"></a>        NS_B<span class="op">::</span>f<span class="op">(</span><span class="dt">int</span><span class="op">{});</span>  <span class="co">// 名前空間で修飾することでコンパイルできる</span></span>
<span id="cb649-21"><a href="#cb649-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb649-22"><a href="#cb649-22" aria-hidden="true" tabindex="-1"></a>        f<span class="op">(</span>S_in_B<span class="op">{});</span>  <span class="co">// ADLによりコンパイルできる</span></span>
<span id="cb649-23"><a href="#cb649-23" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb649-24"><a href="#cb649-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace NS_B_Inner</span></span>
<span id="cb649-25"><a href="#cb649-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace NS_B</span></span></code></pre></div>
<p>NS_B_Inner::g()内のf(int)の呼び出しはコンパイルできるが、
name-hidingが原因で、NS_B_Inner::h()内のf(int)の呼び出しはコンパイルできず、
名前空間で修飾することが必要になる。
一方で、ADLの効果で名前空間での修飾をしていないf(S_in_B)の呼び出しはコンパイルできる。</p>
<p>全チームメンバがこういったname
lookupを正しく扱えると確信できないのであれば、
前述の通り、デフォルトでは名前空間を使用して修飾を行うのが良いだろう。</p>
<h3 id="ドミナンス">ドミナンス <a id="SS_5_4_9"></a></h3>
<p><a
href="https://en.wikipedia.org/wiki/Dominance_(C%2B%2B)">ドミナンス(Dominance、支配性)</a>とは、
「探索対称の名前が継承の中にも存在するような場合の<a
href="#SS_5_4_2">name lookup</a>の仕様の一部」 を指す慣用句である。</p>
<p>以下に</p>
<ul>
<li><a href="#SS_5_4_9_1">ダイヤモンド継承を含まない場合</a></li>
<li><a
href="#SS_5_4_9_2">ダイヤモンド継承かつそれが仮想継承でない場合</a></li>
<li><a
href="#SS_5_4_9_3">ダイヤモンド継承かつそれが仮想継承である場合</a></li>
</ul>
<p>のドミナンスについてのコードを例示する。</p>
<p>この例で示したように、<a
href="#SS_5_4_10">ダイヤモンド継承</a>を通常の継承で行うか、 <a
href="#SS_5_4_11">仮想継承</a>で行うかでは結果が全く異なるため、注意が必要である。</p>
<h4 id="ダイヤモンド継承を含まない場合">ダイヤモンド継承を含まない場合
<a id="SS_5_4_9_1"></a></h4>
<div class="sourceCode" id="cb650"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb650-1"><a href="#cb650-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/dominance_ut.cpp 9</span></span>
<span id="cb650-2"><a href="#cb650-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb650-3"><a href="#cb650-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int32_t</span> f<span class="op">(</span><span class="dt">double</span><span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb650-4"><a href="#cb650-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb650-5"><a href="#cb650-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> Base <span class="op">{</span></span>
<span id="cb650-6"><a href="#cb650-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span> f<span class="op">(</span><span class="dt">int32_t</span><span class="op">)</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb650-7"><a href="#cb650-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span> f<span class="op">(</span><span class="dt">double</span><span class="op">)</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="dv">2</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb650-8"><a href="#cb650-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb650-9"><a href="#cb650-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb650-10"><a href="#cb650-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> Derived <span class="op">:</span> Base <span class="op">{</span></span>
<span id="cb650-11"><a href="#cb650-11" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span> f<span class="op">(</span><span class="dt">int32_t</span><span class="op">)</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="dv">3</span><span class="op">;</span> <span class="op">}</span>  <span class="co">// Base::fを隠蔽する(name-hiding)</span></span>
<span id="cb650-12"><a href="#cb650-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb650-13"><a href="#cb650-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb650-14"><a href="#cb650-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> DerivedDerived <span class="op">:</span> Derived <span class="op">{</span></span>
<span id="cb650-15"><a href="#cb650-15" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span> g<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> f<span class="op">(</span><span class="fl">2.14</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb650-16"><a href="#cb650-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb651"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb651-1"><a href="#cb651-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/dominance_ut.cpp 29</span></span>
<span id="cb651-2"><a href="#cb651-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb651-3"><a href="#cb651-3" aria-hidden="true" tabindex="-1"></a>    Base b<span class="op">;</span></span>
<span id="cb651-4"><a href="#cb651-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb651-5"><a href="#cb651-5" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">2</span><span class="op">,</span> b<span class="op">.</span>f<span class="op">(</span><span class="fl">2.14</span><span class="op">));</span>  <span class="co">// オーバーロード解決により、B::f(double)が呼ばれる</span></span>
<span id="cb651-6"><a href="#cb651-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb651-7"><a href="#cb651-7" aria-hidden="true" tabindex="-1"></a>    DerivedDerived dd<span class="op">;</span></span>
<span id="cb651-8"><a href="#cb651-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb651-9"><a href="#cb651-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Derivedのドミナンスにより、B::fは、DerivedDerived::gでのfのname lookupの対象にならず、</span></span>
<span id="cb651-10"><a href="#cb651-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">// DerivedDerived::gはDerived::fを呼び出す。</span></span>
<span id="cb651-11"><a href="#cb651-11" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">3</span><span class="op">,</span> dd<span class="op">.</span>g<span class="op">());</span></span></code></pre></div>
<p>この<a href="#SS_5_4_2">name lookup</a>については、<a
href="#SS_5_4_8">name-hiding</a>で説明した通りである。</p>
<h4
id="ダイヤモンド継承かつそれが仮想継承でない場合">ダイヤモンド継承かつそれが仮想継承でない場合
<a id="SS_5_4_9_2"></a></h4>
<div class="sourceCode" id="cb652"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb652-1"><a href="#cb652-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/dominance_ut.cpp 45</span></span>
<span id="cb652-2"><a href="#cb652-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb652-3"><a href="#cb652-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> Base <span class="op">{</span></span>
<span id="cb652-4"><a href="#cb652-4" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span> f<span class="op">(</span><span class="dt">int32_t</span><span class="op">)</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb652-5"><a href="#cb652-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span> f<span class="op">(</span><span class="dt">double</span><span class="op">)</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="dv">2</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb652-6"><a href="#cb652-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb652-7"><a href="#cb652-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb652-8"><a href="#cb652-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> Derived_0 <span class="op">:</span> Base <span class="op">{</span></span>
<span id="cb652-9"><a href="#cb652-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span> f<span class="op">(</span><span class="dt">int32_t</span><span class="op">)</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="dv">3</span><span class="op">;</span> <span class="op">}</span>  <span class="co">// Base::fを隠蔽する(name-hiding)</span></span>
<span id="cb652-10"><a href="#cb652-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb652-11"><a href="#cb652-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb652-12"><a href="#cb652-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> Derived_1 <span class="op">:</span> Base <span class="op">{};</span></span>
<span id="cb652-13"><a href="#cb652-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb652-14"><a href="#cb652-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> DerivedDerived <span class="op">:</span> Derived_0<span class="op">,</span> Derived_1 <span class="op">{</span></span>
<span id="cb652-15"><a href="#cb652-15" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span> g<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> f<span class="op">(</span><span class="fl">2.14</span><span class="op">);</span> <span class="op">}</span>  <span class="co">// Derived_0::f or Derived_1::f ?</span></span>
<span id="cb652-16"><a href="#cb652-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb652-17"><a href="#cb652-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb652-18"><a href="#cb652-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">// dominance_ut.cpp:58:41: error: reference to ‘f’ is ambiguous</span></span>
<span id="cb652-19"><a href="#cb652-19" aria-hidden="true" tabindex="-1"></a>    <span class="co">//    58 |     int32_t g() const noexcept { return f(2.14); }  // Derived_0::f or Derived_1::f ?</span></span>
<span id="cb652-20"><a href="#cb652-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">//       |                                         ^</span></span></code></pre></div>
<p>上記コードはコードブロック内のコメントのようなメッセージが原因でコンパイルできない。</p>
<p>Derived_0のドミナンスにより、DerivedDerived::gはDerived_0::fを呼び出すように見えるが、
もう一つの継承元であるDerived_1が導入したDerived_1::f(実際には、Derived_1::Base::f)があるため、
Derived_1によるドミナンスも働き、その結果として、呼び出しが曖昧(ambiguous)になることで、
このような結果となる。</p>
<h4
id="ダイヤモンド継承かつそれが仮想継承である場合">ダイヤモンド継承かつそれが仮想継承である場合
<a id="SS_5_4_9_3"></a></h4>
<div class="sourceCode" id="cb653"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb653-1"><a href="#cb653-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/dominance_ut.cpp 71</span></span>
<span id="cb653-2"><a href="#cb653-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb653-3"><a href="#cb653-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> Base <span class="op">{</span></span>
<span id="cb653-4"><a href="#cb653-4" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span> f<span class="op">(</span><span class="dt">int32_t</span><span class="op">)</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb653-5"><a href="#cb653-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span> f<span class="op">(</span><span class="dt">double</span><span class="op">)</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="dv">2</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb653-6"><a href="#cb653-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb653-7"><a href="#cb653-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb653-8"><a href="#cb653-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> Derived_0 <span class="op">:</span> <span class="kw">virtual</span> Base <span class="op">{</span></span>
<span id="cb653-9"><a href="#cb653-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span> f<span class="op">(</span><span class="dt">int32_t</span><span class="op">)</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="dv">3</span><span class="op">;</span> <span class="op">}</span>  <span class="co">// Base::fを隠蔽する(name-hiding)</span></span>
<span id="cb653-10"><a href="#cb653-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb653-11"><a href="#cb653-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb653-12"><a href="#cb653-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> Derived_1 <span class="op">:</span> <span class="kw">virtual</span> Base <span class="op">{};</span></span>
<span id="cb653-13"><a href="#cb653-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb653-14"><a href="#cb653-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> DerivedDerived <span class="op">:</span> Derived_0<span class="op">,</span> Derived_1 <span class="op">{</span></span>
<span id="cb653-15"><a href="#cb653-15" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span> g<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> f<span class="op">(</span><span class="fl">2.14</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb653-16"><a href="#cb653-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb654"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb654-1"><a href="#cb654-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/dominance_ut.cpp 92</span></span>
<span id="cb654-2"><a href="#cb654-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb654-3"><a href="#cb654-3" aria-hidden="true" tabindex="-1"></a>    DerivedDerived dd<span class="op">;</span></span>
<span id="cb654-4"><a href="#cb654-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb654-5"><a href="#cb654-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Derived_0のドミナンスと仮想継承の効果により、</span></span>
<span id="cb654-6"><a href="#cb654-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">// B::fは、DerivedDerived::gでのfのname lookupの対象にならず、</span></span>
<span id="cb654-7"><a href="#cb654-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">// DerivedDerived::gはDerived_0::fを呼び出す。</span></span>
<span id="cb654-8"><a href="#cb654-8" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">3</span><span class="op">,</span> dd<span class="op">.</span>g<span class="op">());</span></span></code></pre></div>
<p>これまでと同様にDerived_0のドミナンスによりBase::fは<a
href="#SS_5_4_8">name-hiding</a>されることになる。
この時、Derived_0、Derived_1がBaseから<a
href="#SS_5_4_11">仮想継承</a>した効果により、
この継承ヒエラルキーの中でBaseは１つのみ存在することになるため、
Derived_1により導入されたBase::fも併せて<a
href="#SS_5_4_8">name-hiding</a>される。
結果として、曖昧性は排除され、コンパイルエラーにはならず、このような結果となる。</p>
<h3 id="ダイヤモンド継承">ダイヤモンド継承 <a id="SS_5_4_10"></a></h3>
<p>ダイヤモンド継承(Diamond
Inheritance)とは、以下のような構造のクラス継承を指す。</p>
<ul>
<li>基底クラス(Base)が一つ存在し、その基底クラスから二つのクラス(Derived_0、Derived_1)が派生する。</li>
<li>Derived_0とDerived_1からさらに一つのクラス(DerivedDerived)が派生する。
したがって、DerivedDerivedはBaseの孫クラスとなる。</li>
</ul>
<p>この継承は、多重継承の一形態であり、クラス図で表すと下記のようになるため、
ダイヤモンド継承と呼ばれる。</p>
<p>
<img src="data:image/png;base64,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" />
</p>
<p>ダイヤモンド継承は、 <a href="#SS_5_4_11">仮想継承</a>(virtual
inheritance)を使ったものと、使わないものに分類できる。</p>
<p><a
href="#SS_5_4_11">仮想継承</a>を使わないダイヤモンド継承のコードを以下に示す。</p>
<div class="sourceCode" id="cb655"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb655-1"><a href="#cb655-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/diamond_inheritance_ut.cpp 6</span></span>
<span id="cb655-2"><a href="#cb655-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb655-3"><a href="#cb655-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Base <span class="op">{</span></span>
<span id="cb655-4"><a href="#cb655-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb655-5"><a href="#cb655-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span> get<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">x_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb655-6"><a href="#cb655-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span>    set<span class="op">(</span><span class="dt">int32_t</span> x<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="va">x_</span> <span class="op">=</span> x<span class="op">;</span> <span class="op">}</span></span>
<span id="cb655-7"><a href="#cb655-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb655-8"><a href="#cb655-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb655-9"><a href="#cb655-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span> <span class="va">x_</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb655-10"><a href="#cb655-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb655-11"><a href="#cb655-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb655-12"><a href="#cb655-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Derived_0 <span class="op">:</span> <span class="kw">public</span> Base <span class="op">{};</span></span>
<span id="cb655-13"><a href="#cb655-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb655-14"><a href="#cb655-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Derived_1 <span class="op">:</span> <span class="kw">public</span> Base <span class="op">{};</span></span>
<span id="cb655-15"><a href="#cb655-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb655-16"><a href="#cb655-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> DerivedDerived <span class="op">:</span> <span class="kw">public</span> Derived_0<span class="op">,</span> <span class="kw">public</span> Derived_1 <span class="op">{};</span></span></code></pre></div>
<div class="sourceCode" id="cb656"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb656-1"><a href="#cb656-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/diamond_inheritance_ut.cpp 26</span></span>
<span id="cb656-2"><a href="#cb656-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb656-3"><a href="#cb656-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> dd <span class="op">=</span> DerivedDerived<span class="op">{};</span></span>
<span id="cb656-4"><a href="#cb656-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb656-5"><a href="#cb656-5" aria-hidden="true" tabindex="-1"></a>    Base<span class="op">&amp;</span> b0 <span class="op">=</span> <span class="kw">static_cast</span><span class="op">&lt;</span>Derived_0<span class="op">&amp;&gt;(</span>dd<span class="op">);</span>  <span class="co">// Derived_0::Baseのリファレンス</span></span>
<span id="cb656-6"><a href="#cb656-6" aria-hidden="true" tabindex="-1"></a>    Base<span class="op">&amp;</span> b1 <span class="op">=</span> <span class="kw">static_cast</span><span class="op">&lt;</span>Derived_1<span class="op">&amp;&gt;(</span>dd<span class="op">);</span>  <span class="co">// Derived_1::Baseのリファレンス</span></span>
<span id="cb656-7"><a href="#cb656-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb656-8"><a href="#cb656-8" aria-hidden="true" tabindex="-1"></a>    ASSERT_NE<span class="op">(&amp;</span>b0<span class="op">,</span> <span class="op">&amp;</span>b1<span class="op">);</span>  <span class="co">// ddの中には、Baseインスタンスが2つできる</span></span></code></pre></div>
<p>これからわかるように、DerivedDerivedインスタンスの中に2つのBaseインスタンスが存在する。</p>
<p>下記コードは、それが原因で名前解決が曖昧になりコンパイルできない。</p>
<div class="sourceCode" id="cb657"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb657-1"><a href="#cb657-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/diamond_inheritance_ut.cpp 36</span></span>
<span id="cb657-2"><a href="#cb657-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb657-3"><a href="#cb657-3" aria-hidden="true" tabindex="-1"></a>    Base<span class="op">&amp;</span> b <span class="op">=</span> dd<span class="op">;</span>  <span class="co">// Derived_0::Base or Derived_1::Base ?</span></span>
<span id="cb657-4"><a href="#cb657-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb657-5"><a href="#cb657-5" aria-hidden="true" tabindex="-1"></a>    dd<span class="op">.</span>get<span class="op">();</span>  <span class="co">// Derived_0::get or  Derived_1::get ?</span></span>
<span id="cb657-6"><a href="#cb657-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb657-7"><a href="#cb657-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 下記のようなエラーが発生する</span></span>
<span id="cb657-8"><a href="#cb657-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">//  diamond_inheritance_ut.cpp:37:15: error: ‘Base’ is an ambiguous base of ‘DerivedDerived’</span></span>
<span id="cb657-9"><a href="#cb657-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">//     37 |     Base&amp; b = dd;  // Derived_0::Base or Derived_1::Base ?</span></span>
<span id="cb657-10"><a href="#cb657-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">//        |               ^~</span></span>
<span id="cb657-11"><a href="#cb657-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">//  diamond_inheritance_ut.cpp:39:8: error: request for member ‘get’ is ambiguous</span></span>
<span id="cb657-12"><a href="#cb657-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">//     39 |     dd.get();  // Derived_0::get or  Derived_1::get ?</span></span>
<span id="cb657-13"><a href="#cb657-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">//        |        ^~~</span></span></code></pre></div>
<p>この問題に対処するには、クラス名による修飾が必要になるが、
Baseインスタンスが2つ存在するため、下記に示すようなわかりづらいバグの温床となる。</p>
<div class="sourceCode" id="cb658"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb658-1"><a href="#cb658-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/diamond_inheritance_ut.cpp 53</span></span>
<span id="cb658-2"><a href="#cb658-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb658-3"><a href="#cb658-3" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">0</span><span class="op">,</span> dd<span class="op">.</span>Derived_0<span class="op">::</span>get<span class="op">());</span>  <span class="co">// クラス名による名前修飾</span></span>
<span id="cb658-4"><a href="#cb658-4" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">0</span><span class="op">,</span> dd<span class="op">.</span>Derived_1<span class="op">::</span>get<span class="op">());</span></span>
<span id="cb658-5"><a href="#cb658-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb658-6"><a href="#cb658-6" aria-hidden="true" tabindex="-1"></a>    dd<span class="op">.</span>Derived_0<span class="op">::</span>set<span class="op">(</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb658-7"><a href="#cb658-7" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">1</span><span class="op">,</span> dd<span class="op">.</span>Derived_0<span class="op">::</span>get<span class="op">());</span>  <span class="co">// Derived_0::Base::x_は1に変更</span></span>
<span id="cb658-8"><a href="#cb658-8" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">0</span><span class="op">,</span> dd<span class="op">.</span>Derived_1<span class="op">::</span>get<span class="op">());</span>  <span class="co">// Derived_1::Base::x_は0のまま</span></span>
<span id="cb658-9"><a href="#cb658-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb658-10"><a href="#cb658-10" aria-hidden="true" tabindex="-1"></a>    dd<span class="op">.</span>Derived_1<span class="op">::</span>set<span class="op">(</span><span class="dv">2</span><span class="op">);</span></span>
<span id="cb658-11"><a href="#cb658-11" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">1</span><span class="op">,</span> dd<span class="op">.</span>Derived_0<span class="op">::</span>get<span class="op">());</span>  <span class="co">// Derived_0::Base::x_は1のまま</span></span>
<span id="cb658-12"><a href="#cb658-12" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">2</span><span class="op">,</span> dd<span class="op">.</span>Derived_1<span class="op">::</span>get<span class="op">());</span>  <span class="co">// Derived_1::Base::x_は2に変更</span></span></code></pre></div>
<p>次に示すのは、<a
href="#SS_5_4_11">仮想継承</a>を使用したダイヤモンド継承の例である。</p>
<div class="sourceCode" id="cb659"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb659-1"><a href="#cb659-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/diamond_inheritance_ut.cpp 70</span></span>
<span id="cb659-2"><a href="#cb659-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb659-3"><a href="#cb659-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Base <span class="op">{</span></span>
<span id="cb659-4"><a href="#cb659-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb659-5"><a href="#cb659-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span> get<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">x_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb659-6"><a href="#cb659-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span>    set<span class="op">(</span><span class="dt">int32_t</span> x<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="va">x_</span> <span class="op">=</span> x<span class="op">;</span> <span class="op">}</span></span>
<span id="cb659-7"><a href="#cb659-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb659-8"><a href="#cb659-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb659-9"><a href="#cb659-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span> <span class="va">x_</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb659-10"><a href="#cb659-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb659-11"><a href="#cb659-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb659-12"><a href="#cb659-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Derived_0 <span class="op">:</span> <span class="kw">public</span> <span class="kw">virtual</span> Base <span class="op">{};</span>  <span class="co">// 仮想継承</span></span>
<span id="cb659-13"><a href="#cb659-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb659-14"><a href="#cb659-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Derived_1 <span class="op">:</span> <span class="kw">public</span> <span class="kw">virtual</span> Base <span class="op">{};</span>  <span class="co">// 仮想継承</span></span>
<span id="cb659-15"><a href="#cb659-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb659-16"><a href="#cb659-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> DerivedDerived <span class="op">:</span> <span class="kw">public</span> Derived_0<span class="op">,</span> <span class="kw">public</span> Derived_1 <span class="op">{};</span></span></code></pre></div>
<div class="sourceCode" id="cb660"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb660-1"><a href="#cb660-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/diamond_inheritance_ut.cpp 90</span></span>
<span id="cb660-2"><a href="#cb660-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb660-3"><a href="#cb660-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> dd <span class="op">=</span> DerivedDerived<span class="op">{};</span></span>
<span id="cb660-4"><a href="#cb660-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb660-5"><a href="#cb660-5" aria-hidden="true" tabindex="-1"></a>    Base<span class="op">&amp;</span> b0 <span class="op">=</span> <span class="kw">static_cast</span><span class="op">&lt;</span>Derived_0<span class="op">&amp;&gt;(</span>dd<span class="op">);</span>  <span class="co">// Derived_0::Baseのリファレンス</span></span>
<span id="cb660-6"><a href="#cb660-6" aria-hidden="true" tabindex="-1"></a>    Base<span class="op">&amp;</span> b1 <span class="op">=</span> <span class="kw">static_cast</span><span class="op">&lt;</span>Derived_1<span class="op">&amp;&gt;(</span>dd<span class="op">);</span>  <span class="co">// Derived_1::Baseのリファレンス</span></span>
<span id="cb660-7"><a href="#cb660-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb660-8"><a href="#cb660-8" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(&amp;</span>b0<span class="op">,</span> <span class="op">&amp;</span>b1<span class="op">);</span>  <span class="co">// ddの中には、Baseインスタンスが1つできる</span></span></code></pre></div>
<p>仮想継承の効果で、DerivedDerivedインスタンスの中に存在するBaseインスタンスは1つになるため、
上で示した仮想継承を使わないダイヤモンド継承での問題は解消される (が、<a
href="#SS_5_4_11">仮想継承</a>による別の問題が発生する)。</p>
<div class="sourceCode" id="cb661"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb661-1"><a href="#cb661-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/diamond_inheritance_ut.cpp 99</span></span>
<span id="cb661-2"><a href="#cb661-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb661-3"><a href="#cb661-3" aria-hidden="true" tabindex="-1"></a>    Base<span class="op">&amp;</span> b <span class="op">=</span> dd<span class="op">;</span>  <span class="co">// Baseインスタンスは1つであるため、コンパイルできる</span></span>
<span id="cb661-4"><a href="#cb661-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb661-5"><a href="#cb661-5" aria-hidden="true" tabindex="-1"></a>    dd<span class="op">.</span>get<span class="op">();</span>  <span class="co">// Baseインスタンスは1つであるため、コンパイルできる</span></span>
<span id="cb661-6"><a href="#cb661-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb661-7"><a href="#cb661-7" aria-hidden="true" tabindex="-1"></a>    dd<span class="op">.</span>Derived_0<span class="op">::</span>set<span class="op">(</span><span class="dv">1</span><span class="op">);</span>               <span class="co">// クラス名による修飾</span></span>
<span id="cb661-8"><a href="#cb661-8" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">1</span><span class="op">,</span> dd<span class="op">.</span>Derived_1<span class="op">::</span>get<span class="op">());</span>  <span class="co">// Derived_1::BaseとDerived_1::Baseは同一であるため</span></span>
<span id="cb661-9"><a href="#cb661-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb661-10"><a href="#cb661-10" aria-hidden="true" tabindex="-1"></a>    dd<span class="op">.</span>set<span class="op">(</span><span class="dv">2</span><span class="op">);</span></span>
<span id="cb661-11"><a href="#cb661-11" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">2</span><span class="op">,</span> dd<span class="op">.</span>get<span class="op">());</span></span></code></pre></div>
<h3 id="仮想継承">仮想継承 <a id="SS_5_4_11"></a></h3>
<p>下記に示した継承方法を仮想継承、仮想継承の基底クラスを仮想基底クラスと呼ぶ。</p>
<div class="sourceCode" id="cb662"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb662-1"><a href="#cb662-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/virtual_inheritance_ut.cpp 9</span></span>
<span id="cb662-2"><a href="#cb662-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb662-3"><a href="#cb662-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Base <span class="op">{</span></span>
<span id="cb662-4"><a href="#cb662-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb662-5"><a href="#cb662-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> Base<span class="op">(</span><span class="dt">int32_t</span> x <span class="op">=</span> <span class="dv">0</span><span class="op">)</span> <span class="kw">noexcept</span> <span class="op">:</span> <span class="va">x_</span><span class="op">{</span>x<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb662-6"><a href="#cb662-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span> get<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">x_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb662-7"><a href="#cb662-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb662-8"><a href="#cb662-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb662-9"><a href="#cb662-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span> <span class="va">x_</span><span class="op">;</span></span>
<span id="cb662-10"><a href="#cb662-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb662-11"><a href="#cb662-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb662-12"><a href="#cb662-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> DerivedVirtual <span class="op">:</span> <span class="kw">public</span> <span class="kw">virtual</span> Base <span class="op">{</span>  <span class="co">// 仮想継承</span></span>
<span id="cb662-13"><a href="#cb662-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb662-14"><a href="#cb662-14" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> DerivedVirtual<span class="op">(</span><span class="dt">int32_t</span> x<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">:</span> Base<span class="op">{</span>x<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb662-15"><a href="#cb662-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>仮想継承は、<a
href="#SS_5_4_10">ダイヤモンド継承</a>の基底クラスのインスタンスを、
その継承ヒエラルキーの中で1つのみにするための言語機能である。</p>
<p>仮想継承の独特の動作を示すため、
上記コードに加え、仮想継承クラス、通常の継承クラス、
それぞれを通常の継承したクラスを下記のように定義する。</p>
<div class="sourceCode" id="cb663"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb663-1"><a href="#cb663-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/virtual_inheritance_ut.cpp 25</span></span>
<span id="cb663-2"><a href="#cb663-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb663-3"><a href="#cb663-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> DerivedDerivedVirtual <span class="op">:</span> <span class="kw">public</span> DerivedVirtual <span class="op">{</span>  <span class="co">// 仮想継承を通常の継承</span></span>
<span id="cb663-4"><a href="#cb663-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb663-5"><a href="#cb663-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> DerivedDerivedVirtual<span class="op">(</span><span class="dt">int32_t</span> x<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">:</span> DerivedVirtual<span class="op">{</span>x<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb663-6"><a href="#cb663-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb663-7"><a href="#cb663-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb663-8"><a href="#cb663-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> DerivedNormal <span class="op">:</span> <span class="kw">public</span> Base <span class="op">{</span>  <span class="co">// 通常の継承</span></span>
<span id="cb663-9"><a href="#cb663-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb663-10"><a href="#cb663-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> DerivedNormal<span class="op">(</span><span class="dt">int32_t</span> x<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">:</span> Base<span class="op">{</span>x<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb663-11"><a href="#cb663-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb663-12"><a href="#cb663-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb663-13"><a href="#cb663-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> DerivedDerivedNormal <span class="op">:</span> <span class="kw">public</span> DerivedNormal <span class="op">{</span>  <span class="co">// 通常の継承を通常の継承</span></span>
<span id="cb663-14"><a href="#cb663-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb663-15"><a href="#cb663-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> DerivedDerivedNormal<span class="op">(</span><span class="dt">int32_t</span> x<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">:</span> DerivedNormal<span class="op">{</span>x<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb663-16"><a href="#cb663-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>この場合、継承ヒエラルキーに仮想継承を含むクラスと、含まないクラスでは、
以下に示したような違いが発生する。</p>
<div class="sourceCode" id="cb664"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb664-1"><a href="#cb664-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/virtual_inheritance_ut.cpp 45</span></span>
<span id="cb664-2"><a href="#cb664-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb664-3"><a href="#cb664-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> dv <span class="op">=</span> DerivedVirtual<span class="op">{</span><span class="dv">1</span><span class="op">};</span>  <span class="co">// 仮想継承クラス</span></span>
<span id="cb664-4"><a href="#cb664-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> dn <span class="op">=</span> DerivedNormal<span class="op">{</span><span class="dv">1</span><span class="op">};</span>   <span class="co">// 通常の継承クラス</span></span>
<span id="cb664-5"><a href="#cb664-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb664-6"><a href="#cb664-6" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">1</span><span class="op">,</span> dv<span class="op">.</span>get<span class="op">());</span>  <span class="co">// これは非仮想継承と同じ動作</span></span>
<span id="cb664-7"><a href="#cb664-7" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">1</span><span class="op">,</span> dn<span class="op">.</span>get<span class="op">());</span></span>
<span id="cb664-8"><a href="#cb664-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb664-9"><a href="#cb664-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> ddv <span class="op">=</span> DerivedDerivedVirtual<span class="op">{</span><span class="dv">1</span><span class="op">};</span>  <span class="co">// 仮想継承クラスを継承したクラス</span></span>
<span id="cb664-10"><a href="#cb664-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> ddn <span class="op">=</span> DerivedDerivedNormal<span class="op">{</span><span class="dv">1</span><span class="op">};</span>   <span class="co">// 通常の継承クラスを継承したクラス</span></span>
<span id="cb664-11"><a href="#cb664-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb664-12"><a href="#cb664-12" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">0</span><span class="op">,</span> ddv<span class="op">.</span>get<span class="op">());</span>  <span class="co">// Baseのデフォルトコンストラクタが呼ばれる</span></span>
<span id="cb664-13"><a href="#cb664-13" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">1</span><span class="op">,</span> ddn<span class="op">.</span>get<span class="op">());</span></span></code></pre></div>
<p>これは、「仮想継承クラスを継承したクラスが、
仮想継承クラスの基底クラスのコンストラクタを明示的に呼び出さない場合、
引数なしで呼び出せる基底クラスのコンストラクタが呼ばれる」仕様に起因している
(引数なしで呼び出せる基底クラスのコンストラクタがない場合はコンパイルエラー)。
以下では、これを「仮想継承のコンストラクタ呼び出し」仕様と呼ぶことにする。</p>
<p>仮想継承クラスが、基底クラスのコンストラクタを呼び出したとしても、この仕様が優先されるため、
上記コードのような動作となる。</p>
<p>これを通常の継承クラスと同様な動作にするには、下記のようにしなければならない。</p>
<div class="sourceCode" id="cb665"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb665-1"><a href="#cb665-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/virtual_inheritance_ut.cpp 61</span></span>
<span id="cb665-2"><a href="#cb665-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb665-3"><a href="#cb665-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> DerivedDerivedVirtualFixed <span class="op">:</span> <span class="kw">public</span> DerivedVirtual <span class="op">{</span>  <span class="co">// DerivedDerivedNormalと同じように動作</span></span>
<span id="cb665-4"><a href="#cb665-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb665-5"><a href="#cb665-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> DerivedDerivedVirtualFixed<span class="op">(</span><span class="dt">int32_t</span> x<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">:</span> Base<span class="op">{</span>x<span class="op">},</span> DerivedVirtual<span class="op">{</span>x<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb665-6"><a href="#cb665-6" aria-hidden="true" tabindex="-1"></a>        <span class="co">//                     基底クラスのコンストラクタ呼び出し ^^^^^^^</span></span>
<span id="cb665-7"><a href="#cb665-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb666"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb666-1"><a href="#cb666-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/virtual_inheritance_ut.cpp 72</span></span>
<span id="cb666-2"><a href="#cb666-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb666-3"><a href="#cb666-3" aria-hidden="true" tabindex="-1"></a>    DerivedDerivedVirtual ddv<span class="op">{</span><span class="dv">1</span><span class="op">};</span>  <span class="co">// 仮想継承クラスを継承したクラス</span></span>
<span id="cb666-4"><a href="#cb666-4" aria-hidden="true" tabindex="-1"></a>    DerivedDerivedVirtualFixed ddvf<span class="op">{</span><span class="dv">1</span><span class="op">};</span>  <span class="co">// 上記クラスのコンストラクタを修正したクラス</span></span>
<span id="cb666-5"><a href="#cb666-5" aria-hidden="true" tabindex="-1"></a>    DerivedDerivedNormal ddn<span class="op">{</span><span class="dv">1</span><span class="op">};</span>         <span class="co">// 通常の継承クラスを継承したクラス</span></span>
<span id="cb666-6"><a href="#cb666-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb666-7"><a href="#cb666-7" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">0</span><span class="op">,</span> ddv<span class="op">.</span>get<span class="op">());</span>  <span class="co">// 仮想継承独特の動作</span></span>
<span id="cb666-8"><a href="#cb666-8" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">1</span><span class="op">,</span> ddvf<span class="op">.</span>get<span class="op">());</span></span>
<span id="cb666-9"><a href="#cb666-9" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">1</span><span class="op">,</span> ddn<span class="op">.</span>get<span class="op">());</span></span></code></pre></div>
<p>「仮想継承のコンストラクタ呼び出し」仕様は、 <a
href="#SS_5_4_10">ダイヤモンド継承</a>での基底クラスのコンストラクタ呼び出しを一度にするために存在する。</p>
<p>もし、この機能がなければ、下記のコードでの基底クラスのコンストラクタ呼び出しは2度になるため、
デバッグ困難なバグが発生してしまうことは容易に想像できるだろう。</p>
<div class="sourceCode" id="cb667"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb667-1"><a href="#cb667-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/virtual_inheritance_ut.cpp 87</span></span>
<span id="cb667-2"><a href="#cb667-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb667-3"><a href="#cb667-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int32_t</span> base_called<span class="op">;</span></span>
<span id="cb667-4"><a href="#cb667-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb667-5"><a href="#cb667-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Base <span class="op">{</span></span>
<span id="cb667-6"><a href="#cb667-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb667-7"><a href="#cb667-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> Base<span class="op">(</span><span class="dt">int32_t</span> x <span class="op">=</span> <span class="dv">0</span><span class="op">)</span> <span class="kw">noexcept</span> <span class="op">:</span> <span class="va">x_</span><span class="op">{</span>x<span class="op">}</span> <span class="op">{</span> <span class="op">++</span>base_called<span class="op">;</span> <span class="op">}</span></span>
<span id="cb667-8"><a href="#cb667-8" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span> get<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">x_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb667-9"><a href="#cb667-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb667-10"><a href="#cb667-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb667-11"><a href="#cb667-11" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span> <span class="va">x_</span><span class="op">;</span></span>
<span id="cb667-12"><a href="#cb667-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb667-13"><a href="#cb667-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb667-14"><a href="#cb667-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Derived_0 <span class="op">:</span> <span class="kw">public</span> <span class="kw">virtual</span> Base <span class="op">{</span>  <span class="co">// 仮想継承</span></span>
<span id="cb667-15"><a href="#cb667-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb667-16"><a href="#cb667-16" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> Derived_0<span class="op">(</span><span class="dt">int32_t</span> x<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">:</span> Base<span class="op">{</span>x<span class="op">}</span> <span class="op">{</span> <span class="ot">assert</span><span class="op">(</span>base_called <span class="op">==</span> <span class="dv">1</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb667-17"><a href="#cb667-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb667-18"><a href="#cb667-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb667-19"><a href="#cb667-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Derived_1 <span class="op">:</span> <span class="kw">public</span> <span class="kw">virtual</span> Base <span class="op">{</span>  <span class="co">// 仮想継承</span></span>
<span id="cb667-20"><a href="#cb667-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb667-21"><a href="#cb667-21" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> Derived_1<span class="op">(</span><span class="dt">int32_t</span> x<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">:</span> Base<span class="op">{</span>x<span class="op">}</span> <span class="op">{</span> <span class="ot">assert</span><span class="op">(</span>base_called <span class="op">==</span> <span class="dv">1</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb667-22"><a href="#cb667-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb667-23"><a href="#cb667-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb667-24"><a href="#cb667-24" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> DerivedDerived <span class="op">:</span> <span class="kw">public</span> Derived_0<span class="op">,</span> <span class="kw">public</span> Derived_1 <span class="op">{</span></span>
<span id="cb667-25"><a href="#cb667-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb667-26"><a href="#cb667-26" aria-hidden="true" tabindex="-1"></a>        DerivedDerived<span class="op">(</span><span class="dt">int32_t</span> x0<span class="op">,</span> <span class="dt">int32_t</span> x1<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">:</span> Derived_0<span class="op">{</span>x0<span class="op">},</span> Derived_1<span class="op">{</span>x1<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb667-27"><a href="#cb667-27" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 「仮想継承のコンストラクタ呼び出し」仕様がなければ、このコンストラクタは、</span></span>
<span id="cb667-28"><a href="#cb667-28" aria-hidden="true" tabindex="-1"></a>        <span class="co">//    Base::Base -&gt; Derived_0::Derived_0 -&gt;</span></span>
<span id="cb667-29"><a href="#cb667-29" aria-hidden="true" tabindex="-1"></a>        <span class="co">//      Base::Base -&gt; Derived_0::Derived_0 -&gt;</span></span>
<span id="cb667-30"><a href="#cb667-30" aria-hidden="true" tabindex="-1"></a>        <span class="co">//        DerivedDerived::DerivedDerived</span></span>
<span id="cb667-31"><a href="#cb667-31" aria-hidden="true" tabindex="-1"></a>        <span class="co">//  という呼び出しになるため、Base::Baseが2度呼び出されてしまう。</span></span>
<span id="cb667-32"><a href="#cb667-32" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb668"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb668-1"><a href="#cb668-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/virtual_inheritance_ut.cpp 123</span></span>
<span id="cb668-2"><a href="#cb668-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb668-3"><a href="#cb668-3" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">0</span><span class="op">,</span> base_called<span class="op">);</span></span>
<span id="cb668-4"><a href="#cb668-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb668-5"><a href="#cb668-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> dd <span class="op">=</span> DerivedDerived<span class="op">{</span><span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">};</span>  <span class="co">// Base::Baseが最初に呼ばれないとassertion failする</span></span>
<span id="cb668-6"><a href="#cb668-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb668-7"><a href="#cb668-7" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">1</span><span class="op">,</span> base_called<span class="op">);</span>  <span class="co">// 「仮想継承のコンストラクタ呼び出し」仕様のため</span></span>
<span id="cb668-8"><a href="#cb668-8" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">0</span><span class="op">,</span> dd<span class="op">.</span>get<span class="op">());</span>  <span class="co">// Baseのデフォルトコンストラクタは、x_を0にする</span></span></code></pre></div>
<p>基底クラスのコンストラクタ呼び出しは、下記のコードのようにした場合でも、
単体テストが示すように、一番最初に行われる。</p>
<div class="sourceCode" id="cb669"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb669-1"><a href="#cb669-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/virtual_inheritance_ut.cpp 138</span></span>
<span id="cb669-2"><a href="#cb669-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb669-3"><a href="#cb669-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> DerivedDerived <span class="op">:</span> <span class="kw">public</span> Derived_0<span class="op">,</span> <span class="kw">public</span> Derived_1 <span class="op">{</span></span>
<span id="cb669-4"><a href="#cb669-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb669-5"><a href="#cb669-5" aria-hidden="true" tabindex="-1"></a>        DerivedDerived<span class="op">(</span><span class="dt">int32_t</span> x0<span class="op">,</span> <span class="dt">int32_t</span> x1<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">:</span> Derived_0<span class="op">{</span>x0<span class="op">},</span> Derived_1<span class="op">{</span>x1<span class="op">},</span> Base<span class="op">{</span><span class="dv">1</span><span class="op">}</span> <span class="op">{}</span></span>
<span id="cb669-6"><a href="#cb669-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb670"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb670-1"><a href="#cb670-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/virtual_inheritance_ut.cpp 150</span></span>
<span id="cb670-2"><a href="#cb670-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb670-3"><a href="#cb670-3" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">0</span><span class="op">,</span> base_called<span class="op">);</span></span>
<span id="cb670-4"><a href="#cb670-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb670-5"><a href="#cb670-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> dd <span class="op">=</span> DerivedDerived<span class="op">{</span><span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">};</span>  <span class="co">// Base::Baseが最初に呼ばれないとassertion failする</span></span>
<span id="cb670-6"><a href="#cb670-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb670-7"><a href="#cb670-7" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">1</span><span class="op">,</span> base_called<span class="op">);</span>  <span class="co">// 「仮想継承のコンストラクタ呼び出し」仕様のため</span></span>
<span id="cb670-8"><a href="#cb670-8" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">1</span><span class="op">,</span> dd<span class="op">.</span>get<span class="op">());</span>  <span class="co">// Base{1}呼び出しの効果</span></span></code></pre></div>
<p>このため、基底クラスのコンストラクタ呼び出しは下記のような順番で行うべきである。</p>
<div class="sourceCode" id="cb671"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb671-1"><a href="#cb671-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/virtual_inheritance_ut.cpp 163</span></span>
<span id="cb671-2"><a href="#cb671-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb671-3"><a href="#cb671-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> DerivedDerived <span class="op">:</span> <span class="kw">public</span> Derived_0<span class="op">,</span> <span class="kw">public</span> Derived_1 <span class="op">{</span></span>
<span id="cb671-4"><a href="#cb671-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb671-5"><a href="#cb671-5" aria-hidden="true" tabindex="-1"></a>        DerivedDerived<span class="op">(</span><span class="dt">int32_t</span> x0<span class="op">,</span> <span class="dt">int32_t</span> x1<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">:</span> Base<span class="op">{</span><span class="dv">1</span><span class="op">},</span> Derived_0<span class="op">{</span>x0<span class="op">},</span> Derived_1<span class="op">{</span>x1<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb671-6"><a href="#cb671-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<h3 id="仮想基底">仮想基底 <a id="SS_5_4_12"></a></h3>
<p>仮想基底(クラス)とは、<a
href="#SS_5_4_11">仮想継承</a>の基底クラス指す。</p>
<h3 id="using宣言">using宣言 <a id="SS_5_4_13"></a></h3>
<p>using宣言とは、“using XXX::func”のような記述である。
この記述が行われたスコープでは、この記述後の行から名前空間XXXでの修飾をすることなく、
funcが使用できる。</p>
<div class="sourceCode" id="cb672"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb672-1"><a href="#cb672-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/namespace_ut.cpp 6</span></span>
<span id="cb672-2"><a href="#cb672-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> XXX <span class="op">{</span></span>
<span id="cb672-3"><a href="#cb672-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> func<span class="op">()</span> <span class="kw">noexcept</span> <span class="op">{}</span></span>
<span id="cb672-4"><a href="#cb672-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> gunc<span class="op">()</span> <span class="kw">noexcept</span> <span class="op">{}</span></span>
<span id="cb672-5"><a href="#cb672-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace XXX</span></span></code></pre></div>
<div class="sourceCode" id="cb673"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb673-1"><a href="#cb673-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/namespace_ut.cpp 12</span></span>
<span id="cb673-2"><a href="#cb673-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb673-3"><a href="#cb673-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// global namespace</span></span>
<span id="cb673-4"><a href="#cb673-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> using_declaration<span class="op">()</span> <span class="kw">noexcept</span></span>
<span id="cb673-5"><a href="#cb673-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb673-6"><a href="#cb673-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> XXX<span class="op">::</span>func<span class="op">;</span>  <span class="co">// using宣言</span></span>
<span id="cb673-7"><a href="#cb673-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb673-8"><a href="#cb673-8" aria-hidden="true" tabindex="-1"></a>        func<span class="op">();</span>       <span class="co">// XXX::不要</span></span>
<span id="cb673-9"><a href="#cb673-9" aria-hidden="true" tabindex="-1"></a>        XXX<span class="op">::</span>gunc<span class="op">();</span>  <span class="co">// XXX::必要</span></span>
<span id="cb673-10"><a href="#cb673-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<h3 id="usingディレクティブ">usingディレクティブ
<a id="SS_5_4_14"></a></h3>
<p>usingディレクティブとは、“using namespace XXX”のような記述である。
この記述が行われたスコープでは、下記例のように、この記述後から名前空間XXXでの修飾をすることなく、
XXXの識別子が使用できる。</p>
<div class="sourceCode" id="cb674"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb674-1"><a href="#cb674-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/namespace_ut.cpp 6</span></span>
<span id="cb674-2"><a href="#cb674-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> XXX <span class="op">{</span></span>
<span id="cb674-3"><a href="#cb674-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> func<span class="op">()</span> <span class="kw">noexcept</span> <span class="op">{}</span></span>
<span id="cb674-4"><a href="#cb674-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> gunc<span class="op">()</span> <span class="kw">noexcept</span> <span class="op">{}</span></span>
<span id="cb674-5"><a href="#cb674-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace XXX</span></span></code></pre></div>
<div class="sourceCode" id="cb675"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb675-1"><a href="#cb675-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/namespace_ut.cpp 24</span></span>
<span id="cb675-2"><a href="#cb675-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb675-3"><a href="#cb675-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// global namespace</span></span>
<span id="cb675-4"><a href="#cb675-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> using_directive<span class="op">()</span> <span class="kw">noexcept</span></span>
<span id="cb675-5"><a href="#cb675-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb675-6"><a href="#cb675-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> <span class="kw">namespace</span> XXX<span class="op">;</span>  <span class="co">// usingディレクティブ</span></span>
<span id="cb675-7"><a href="#cb675-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb675-8"><a href="#cb675-8" aria-hidden="true" tabindex="-1"></a>        func<span class="op">();</span>  <span class="co">// XXX::不要</span></span>
<span id="cb675-9"><a href="#cb675-9" aria-hidden="true" tabindex="-1"></a>        gunc<span class="op">();</span>  <span class="co">// XXX::不要</span></span>
<span id="cb675-10"><a href="#cb675-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>より多くの識別子が名前空間の修飾無しで使えるようになる点において、 <a
href="#SS_5_4_13">using宣言</a>よりも危険であり、また、 下記のように<a
href="#SS_5_4_8">name-hiding</a>された識別子の導入には効果がない。</p>
<div class="sourceCode" id="cb676"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb676-1"><a href="#cb676-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/namespace_ut.cpp 6</span></span>
<span id="cb676-2"><a href="#cb676-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> XXX <span class="op">{</span></span>
<span id="cb676-3"><a href="#cb676-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> func<span class="op">()</span> <span class="kw">noexcept</span> <span class="op">{}</span></span>
<span id="cb676-4"><a href="#cb676-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> gunc<span class="op">()</span> <span class="kw">noexcept</span> <span class="op">{}</span></span>
<span id="cb676-5"><a href="#cb676-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace XXX</span></span></code></pre></div>
<div class="sourceCode" id="cb677"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb677-1"><a href="#cb677-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/namespace_ut.cpp 35</span></span>
<span id="cb677-2"><a href="#cb677-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb677-3"><a href="#cb677-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> XXX_Inner <span class="op">{</span></span>
<span id="cb677-4"><a href="#cb677-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> func<span class="op">(</span><span class="dt">int</span><span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{}</span></span>
<span id="cb677-5"><a href="#cb677-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> using_declaration<span class="op">()</span> <span class="kw">noexcept</span></span>
<span id="cb677-6"><a href="#cb677-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb677-7"><a href="#cb677-7" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#if 0</span></span>
<span id="cb677-8"><a href="#cb677-8" aria-hidden="true" tabindex="-1"></a><span class="co">        using namespace XXX;  // name-hidingのため効果がない</span></span>
<span id="cb677-9"><a href="#cb677-9" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="pp">#else</span></span>
<span id="cb677-10"><a href="#cb677-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> XXX<span class="op">::</span>func<span class="op">;</span>  <span class="co">// using宣言</span></span>
<span id="cb677-11"><a href="#cb677-11" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#endif</span></span>
<span id="cb677-12"><a href="#cb677-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb677-13"><a href="#cb677-13" aria-hidden="true" tabindex="-1"></a>        func<span class="op">();</span>  <span class="co">// XXX::不要</span></span>
<span id="cb677-14"><a href="#cb677-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>従って、usingディレクティブの使用は避けるべきである。</p>
<h2 id="expressionと値カテゴリ">expressionと値カテゴリ
<a id="SS_5_5"></a></h2>
<p>ここでは、expression(式)の値カテゴリや、それに付随した機能についての解説を行う。</p>
<h3 id="expression">expression <a id="SS_5_5_1"></a></h3>
<p>C++においてexpression、lvalue、rvalue、xvalue、glvalue、prvalueは以下のように定められている。</p>
<ul>
<li><p><a
href="https://ja.cppreference.com/w/cpp/language/expressions">expression</a>(式)
とは「演算子とそのオペランドの並び」である(オペランドのみの記述も式である)。
演算子とは以下のようなものである。</p>
<ul>
<li>四則演算、代入(a = b、a += b …)、インクリメント、比較、論理式</li>
<li>明示的キャストや型変換</li>
<li>メンバアクセス(a.b、a-&gt;b、a[x]、 *a、&amp;a …)</li>
<li>関数呼び出し演算子(f(…))、sizeof、decltype等</li>
</ul></li>
<li><p>expressionは、以下のいずれかに分類される。lvalueでないexpressionがrvalueである。</p>
<ul>
<li>lvalue</li>
<li>rvalue</li>
</ul></li>
<li><p>lvalueとは、関数もしくはオブジェクトを指す。</p></li>
<li><p>rvalueは、以下のいずれかに分類される。</p>
<ul>
<li>xvalue</li>
<li>prvalue</li>
</ul></li>
<li><p>xvalueとは以下のようなものである。</p>
<ul>
<li>戻り値の型がT&amp;&amp;(Tは任意の型)である関数の呼び出し式(std::move(x))</li>
<li>オブジェクトへのT&amp;&amp;へのキャスト式(static_cast&lt;char&amp;&amp;&gt;(x))</li>
<li>aを配列のrvalueとした場合のa[N]や、
cをクラス型のrvalueとした場合のc.m(mはaの非staticメンバ)等</li>
</ul></li>
<li><p>prvalueとは、オブジェクトやビットフィールドを初期化する、
もしくはオペランドの値を計算する式であり、以下のようなものである。</p>
<ul>
<li>文字列リテラルを除くリテラル</li>
<li>戻り値の型が非リファレンスである関数呼び出し式、
または前置++と前置–を除くオーバーロードされた演算子式(path.string()、str1
+ str2、it++ …)</li>
<li>組み込み型インスタンスaのa++、a--(++a、--aはlvalue)</li>
<li>組み込み型インスタンスa、bに対する a + b、 a % b、 a &amp; b、 a
&amp;&amp; b、 a || b、 !a、 a &lt; b、 a == b等</li>
</ul></li>
<li><p>glvalueは、以下のいずれかに分類される。</p>
<ul>
<li>lvalue</li>
<li>xvalue</li>
</ul></li>
</ul>
<p>
<img src="data:image/png;base64,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" />
</p>
<p>ざっくりと言えば、lvalueとは代入式の左辺になり得る式、rvalueとは代入式の左辺にはなり得ない式である。
T
const&amp;は左辺になり得ないが、lvalueである。rvalueリファレンス(T&amp;&amp;)もlvalueであるため、
rvalueであることとrvalueリファレンスであることとは全く異なる。</p>
<p>xvalueとは、多くの場合、「std::move()の呼び出し式のことである」と考えても差し支えない。</p>
<p>prvalueとは、いわゆるテンポラリオブジェクトのことであるため
(下記のstd::string()で作られるようなオブジェクト)、名前はない。
また、アドレス演算子(&amp;)のオペランドになれない。</p>
<div class="sourceCode" id="cb678"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb678-1"><a href="#cb678-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/rvalue_lvalue_ut.cpp 8</span></span>
<span id="cb678-2"><a href="#cb678-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb678-3"><a href="#cb678-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb678-4"><a href="#cb678-4" aria-hidden="true" tabindex="-1"></a>        <span class="co">// sを初期化するためにstd::string{}により生成されるオブジェクトはprvalue</span></span>
<span id="cb678-5"><a href="#cb678-5" aria-hidden="true" tabindex="-1"></a>        <span class="co">// sはlvalue</span></span>
<span id="cb678-6"><a href="#cb678-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb678-7"><a href="#cb678-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> s <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{};</span></span>
<span id="cb678-8"><a href="#cb678-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb678-9"><a href="#cb678-9" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#if 0</span></span>
<span id="cb678-10"><a href="#cb678-10" aria-hidden="true" tabindex="-1"></a><span class="co">        // 下記はコンパイルエラー</span></span>
<span id="cb678-11"><a href="#cb678-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb678-12"><a href="#cb678-12" aria-hidden="true" tabindex="-1"></a><span class="co">        auto* sp = &amp;std::string{};</span></span>
<span id="cb678-13"><a href="#cb678-13" aria-hidden="true" tabindex="-1"></a><span class="co">        // 下記はg++のエラーメッセージ</span></span>
<span id="cb678-14"><a href="#cb678-14" aria-hidden="true" tabindex="-1"></a><span class="co">        // programming_convention_type.cpp|709 col 29| error: taking address of rvalue [-fpermissive]</span></span>
<span id="cb678-15"><a href="#cb678-15" aria-hidden="true" tabindex="-1"></a><span class="co">        // ||   709 |     auto* sp = &amp;std::string{};</span></span>
<span id="cb678-16"><a href="#cb678-16" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="pp">#else</span></span>
<span id="cb678-17"><a href="#cb678-17" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 下記のようにすればアドレスを取得できるが、このようなことはすべきではない。</span></span>
<span id="cb678-18"><a href="#cb678-18" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span><span class="op">&amp;&amp;</span> rvalue_ref <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{};</span></span>
<span id="cb678-19"><a href="#cb678-19" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span>   sp         <span class="op">=</span> <span class="op">&amp;</span>rvalue_ref<span class="op">;</span></span>
<span id="cb678-20"><a href="#cb678-20" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#endif</span></span>
<span id="cb678-21"><a href="#cb678-21" aria-hidden="true" tabindex="-1"></a>        <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">*,</span> <span class="kw">decltype</span><span class="op">(</span>sp<span class="op">)&gt;);</span></span>
<span id="cb678-22"><a href="#cb678-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>C++11でrvalueの概念の整理やstd::move()の導入が行われた目的はプログラム実行速度の向上である。</p>
<ul>
<li>lvalueからの代入</li>
<li>rvalueからの代入</li>
<li>std::move(lvalue)からの代入</li>
</ul>
<p>の処理がどのように違うのかを見ることでrvalueの効果について説明する。</p>
<ol type="1">
<li><p>下記コードにより「lvalueからの代入」を説明する。</p>
<div class="sourceCode" id="cb679"><pre
class="sourceCode .cpp"><code class="sourceCode cpp"><span id="cb679-1"><a href="#cb679-1" aria-hidden="true" tabindex="-1"></a><span class="co">// @@@ example/term_explanation/rvalue_lvalue_ut.cpp 35</span></span>
<span id="cb679-2"><a href="#cb679-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb679-3"><a href="#cb679-3" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> str0 <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{};</span>        <span class="co">// str0はlvalue</span></span>
<span id="cb679-4"><a href="#cb679-4" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> str1 <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{</span><span class="st">&quot;hehe&quot;</span><span class="op">};</span>  <span class="co">// str1もlvalue</span></span>
<span id="cb679-5"><a href="#cb679-5" aria-hidden="true" tabindex="-1"></a>str0      <span class="op">=</span> str1<span class="op">;</span>                 <span class="co">// lvalueからの代入</span></span></code></pre></div>
<ul>
<li><p>ステップ1。 str0、str1がそれぞれ初期化される
(“hehe”を保持するバッファが生成され、それをstr1オブジェクトが所有する)。</p></li>
<li><p>ステップ2。
st1が所有している文字列バッファと等価のバッファが作られ
(文字列バッファ用のメモリをnewし、文字列を代入)、
str0がそれを所有する。従って、“hehe”を保持するバッファが2つできる。
この代入をcopy代入と呼ぶ。</p></li>
</ul></li>
</ol>
<p>
<img src="data:image/png;base64,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iJyoEDkgcoACiJyoEDkgcoACiJyoEDkgcoACiJyoEDkgcoACiJyoEDkgcoACiJyoEDkgcoACiJyoEDkgcoACiJyoEDkgcoACiJyoEDkgcoACiJyoEDkgcoACiJyoEDkgcoACiJyouPczuauqqoicohA5QAEBkROdTCbT0tLS3Nzc2NjY0NCwzn6yClmLrEjWJaszF4wjETlAAUROhDo6Otra2uSGYMuWLXKl3mg/WYWsRVYk65LVmQvGkYgcoAAiJ0JdXV3t7e2tra1yjZY7gyb7ySpkLbIiWZeszlwwjkTkAAUQORHq7u6WWwG5Oss9QUtLyw77ySpkLbIiWZeszlwwjkTkAAUQORHq6emR67LcDcgFOpPJtNtPViFrkRXJumR15oJxJCIHKIDIAaJC5AAFEDlAVIgcoAAiB4gKkQMUQOQAUSFygAKIHCAqRA5QAJEDRIXIAQogcoCoEDlAAUQOEJWyRM7dd9/d91NWvyZP2cveZPeWIighco7+XbGXvfHvTVZZIgdwSVBC5ADIRuQABRA5QFSIHKAAIgeICpEDFEDkAFEhcoACiBwgKkQOUACRA0SFyAEKIHKAqNgdOTt37uS/4UO5ETlAVCyOnBUrVsi1oKamZv/+/eY+IDpEDhCViCOns7Pz4RxNTU1qr2SDue/hh998880jv0Y/urq6ns4xceLEp556asKECZs2bVq8ePG4ceMGDRo0Z86c119/3TweKAGRA0Ql4sjZvXv32UeSGKivr1d7v/jii3NzPPnkk0d+jd729nY16Ojo2Ldvnwx27dp1ao6RI0deeeWVQ4cObW5uPu2001atWnXHHXfI1UHGR3w5oDREDhCViCPH8OKLLw4bNmznzp29fXcqb+fR2toqE1599dVrrrlGQquysvLzzz+XLbW1tatXrza+pnbRRRfJjc79998vY/03OtOmTZPDj5gHlIbIAaJSxsiRW5MTTzzx3nvvVU+bmpq++glz/bn22mtlQltbm9yy7N2794wzznj22Wdly8yZM9evX5/9NbOdcMIJdXV12Vvef/99ualauHBh9kagRAGRA0SkXJGzZ8+euXPnLlq0qKenx9zXd8cjbfzGG28Y22tqap5//vlbb711+fLlcrszcODAjz76yJijyC2RfIVNmzbpLR9//PGpp546fvx4CZ6siUCpiBwgKmWJHLnon3baaXKL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" />
</p>
<ol start="2" type="1">
<li><p>下記コードにより「rvalueからの代入」を説明する。</p>
<div class="sourceCode" id="cb680"><pre
class="sourceCode .cpp"><code class="sourceCode cpp"><span id="cb680-1"><a href="#cb680-1" aria-hidden="true" tabindex="-1"></a><span class="co">// @@@ example/term_explanation/rvalue_lvalue_ut.cpp 46</span></span>
<span id="cb680-2"><a href="#cb680-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb680-3"><a href="#cb680-3" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> str0 <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{};</span>        <span class="co">// str0はlvalue</span></span>
<span id="cb680-4"><a href="#cb680-4" aria-hidden="true" tabindex="-1"></a>str0      <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{</span><span class="st">&quot;hehe&quot;</span><span class="op">};</span>  <span class="co">// rvalueからの代入</span></span></code></pre></div>
<ul>
<li><p>ステップ1。str0、「std::string()により作られたテンポラリオブジェクト」がそれぞれ初期化される
(“hehe”を保持するバッファが生成され、それをテンポラリオブジェクトが所有する)。</p></li>
<li><p>ステップ2。 “hehe”を保持する文字列バッファをもう1つ作る代わりに、
テンポラリオブジェクトが所有している文字列バッファをstr0の所有にする。
この代入をmove代入と呼ぶ。</p></li>
<li><p>ステップ3。 テンポラリオブジェクトが解体されるが、
文字列バッファはstr0の所有であるためdeleteする必要がなく、実際には何もしない。
move代入によって、文字列バッファの生成と破棄の回数がそれぞれ1回少なくなったため、
実行速度は向上する(通常、new/deleteの処理コストは高い)。</p></li>
</ul></li>
</ol>
<p>
<img src="data:image/png;base64,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" />
</p>
<ol start="3" type="1">
<li><p>下記コードにより「std::move(lvalue)からの代入」を説明する。</p>
<div class="sourceCode" id="cb681"><pre
class="sourceCode .cpp"><code class="sourceCode cpp"><span id="cb681-1"><a href="#cb681-1" aria-hidden="true" tabindex="-1"></a><span class="co">// @@@ example/term_explanation/rvalue_lvalue_ut.cpp 56</span></span>
<span id="cb681-2"><a href="#cb681-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb681-3"><a href="#cb681-3" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> str0 <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{};</span>        <span class="co">// str0はlvalue</span></span>
<span id="cb681-4"><a href="#cb681-4" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> str1 <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{</span><span class="st">&quot;hehe&quot;</span><span class="op">};</span>  <span class="co">// str1もlvalue</span></span>
<span id="cb681-5"><a href="#cb681-5" aria-hidden="true" tabindex="-1"></a>str0      <span class="op">=</span> <span class="bu">std::</span>move<span class="op">(</span>str1<span class="op">);</span>      <span class="co">// str1はこれ以降使われないとする</span></span></code></pre></div>
<ul>
<li><p>ステップ1。「lvalueからの代入」のステップ1と同じである。</p></li>
<li><p>ステップ2。
std::move()の効果により(実際にはrvalueリファレンスへのキャストが行われるだけなので、
実行時速度に影響はない)、“hehe”を保持する文字列バッファをもう1つ作る代わりに、
str1が所有している文字列バッファをstr0の所有にする。
この代入もmove代入と呼ぶ。
この動作は「rvalueからの代入」と同じであり、同様に速度が向上するが、その副作用として、
str1.size() == 0となる。</p></li>
</ul></li>
</ol>
<p>
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAiYAAAGWCAIAAADDjt/5AAAtOElEQVR4Xu3dD3BV5Z3/8ZM/EEj4kxhAYKEhKBaWin+QteJPCKBufwJ2prsztvbPMmqwap0y6nR1JiP97XRLtEynLIKF6czK6kKnU8epncnQ8Q/7G+N2f/EPccOKQDt6h3RikeDVkGBqEn/f5oFzbp6byyW9555znud5v+YZ5rnnPOfCuef7PZ8ciNH7DACASHj6BgAAioPIAQBEJIicIQAAioDIAQBEhMgBAESEyAEARITIAQBEhMgBAESEyAEARITIAQBEhMgBAESEyAEARITIAQBEhMgBAESEyAEARITIAQBEhMgBAESEyAEARITIAQBEhMgBAESEyAEARITIAQBEhMgBAESEyAEARITIAQBEhMgBAESEyAEARITIAQBExOzIOX78eH9/v74VAJBIBkfOli1bPM9bsmTJJ598ou8DACRPyJHT29u7M0tbW5vaK9mg79u588033xz5HqPo6+vbm2XmzJnPPPPMjBkzXnzxxVtuuUVeSgItXrxYPxgAkAwhR87JkyevHam8vLy5uVnt/fjjj6/P8vTTT498j6Hu7m416enpOXPmjExOnDjx+SyTJ0++7bbbJkyY0NHRsW7dukcffZTIAYAkCzlyNC+99NLEiROPHz8+NPyk8t85dHZ2yoLf/va3d9xxh4RWRUXFRx99JFsaGhq2b9+uvafv5ptvliebH/7wh/4WIgcAkqyIkSOPJvPmzfvBD36gXra1tXk53HnnnbKgq6tLHllOnz59xRVX/OpXv5ItCxcufPbZZzPfM9OcOXOampoyt3hEDgAkWLEi59SpU8uWLbvpppsGBgb0fcNPPBIPb7zxhrZ9yZIlv/nNbx544IEHH3xQHnfKysree+89bY0ij0TyDi+++GLmRiIHAJKsKJFz9OhRufXLI8706dMPHjyo7x4aev755ydOnNjb26ttlyB5//33P/jgg56enkcfffS6667TFiiffPKJ7Lr88su1PCNyACDJQo6cwcHBJ598cvLkyY2NjRIMmzdvrqmp0Z5mXnjhhdmzZ3/ve9/L3Jjpo48+kgOnTJny2muv6fuGhg4dOrRixQr5LTLDbPcwiRx5Z5lkLAcAJEXIkbN69eq5c+c+99xz/pbvf//7F110kTz3qJcSRZWVlU1NTaP+hdsf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iyZyenp69E0AnETkGM/PiT179syfP7+iouKWW245efKktle91EJC25vr5TPPPHPppZfKO69atero0aOZezXagbt27aqrqyspKVHbATiOyDGeur9PmTIluPF73saNGzP3FhI5NTU1khlqLurr69VTi78lU+aB1dXV2nYAjiNyjOff1n/+858fP35c3ehnz56dubeQyBHylNPb23vPPfeolzt37hz13Xz+gU1NTadPnz58+LC2AICbiBzjqZv7ggUL1Mvrr7/eG/7/KmbuLSRyFi5cqF5Knqktt99+u9py/siZOXPmwMCAtguAy4gc46n7++rVq9XL84eKLDvP3lFfrlq1Sr389NNP1ZYvfelLasv5I2flypXadjiuqrpK1YY1amtr9ZPEeRE5xlOln+s5Rv2/5VesWKFeLlq0KHOvduyoL8/zlHPjjTeqLeqlT3sfQJGq2PX7XTYNOaN0Ot3T09PX19ff389jfV5EjvG0+7sWObNmzZL59OnTpTEOHDigdvl7tWNHfSn27t3b29t77733qpdPPvmkWnDrrbeqLW+++abaknkgkQONZ2PkpFKprq6u7u5uCR5JHf2cMRKRYzzt/q5FTmNjo3o5adKksrKyiRMnZu7Vjh31pcSVelRS/O9YE1u2bPG3K6O+D6B4NkZOR0fHsWPHOjs7JXXkWUc/Z4xE5BhPu79rkXPy5Mm1a9dWVFTU1dXt2rVL26sdm+vlL37xi8suu0zepKGh4ciRI2qvkAaTSJs2bZr/XdSjvg+geDZGTmtra3t7u6SOPOvwXz3nReQgJ5ID4bIyclpaWiR15FknlUql02n9nDESkYOciByEy8rI2bdv3/79+9va2uRBp7u7Wz9njETkICciB+HKFTmy/eL5F8tEfvXXqPJbuHxh9vq8o8Bjs/8wuYZH5IwRkQMgIrnu4KPe5QuMjUKOzf7D5BpEzlgROQAikusOPupdvsDYKOTY7D9MrkHkjBWRAyAiue7go97l/di4e8fdM+bNKB9f/oWGL/z4jR/7RzW3Ni//++XVF1eXlZfVzKpZ/Q+rt721LZRjs/8wuQaRM1ZEDtylbkxbtmyZO3futGnT9uzZs2vXrunTp6u5WjM4OPijH/3okksuGTdu3KxZszZt2tTb2yvbv/Wtb8mxskst27Bhg7x8/PHH1cudO3cuWrRIDpG3amxs/PDDD9V2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" />
</p>
<p>エッセンシャルタイプがTであるlvalue、xvalue、prvalueに対して
(例えば、std::string
const&amp;のエッセンシャルタイプはstd::stringである)、
decltypeの算出結果は下表のようになる。</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">decltype</th>
<th style="text-align: left;">算出された型</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">decltype(lvalue)</td>
<td style="text-align: left;">T</td>
</tr>
<tr class="even">
<td style="text-align: left;">decltype((lvalue))</td>
<td style="text-align: left;">T&amp;</td>
</tr>
<tr class="odd">
<td style="text-align: left;">decltype(xvalue)</td>
<td style="text-align: left;">T&amp;&amp;</td>
</tr>
<tr class="even">
<td style="text-align: left;">decltype((xvalue))</td>
<td style="text-align: left;">T&amp;&amp;</td>
</tr>
<tr class="odd">
<td style="text-align: left;">decltype(prvalue)</td>
<td style="text-align: left;">T</td>
</tr>
<tr class="even">
<td style="text-align: left;">decltype((prvalue))</td>
<td style="text-align: left;">T</td>
</tr>
</tbody>
</table>
<p>この表の結果を使用した下記の関数型マクロ群により式を分類できる。
定義から明らかな通り、これらは <a
href="https://ja.wikipedia.org/wiki/%E3%83%86%E3%83%B3%E3%83%97%E3%83%AC%E3%83%BC%E3%83%88%E3%83%A1%E3%82%BF%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0">テンプレートメタプログラミング</a>
に有効に活用できる。</p>
<div class="sourceCode" id="cb682"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb682-1"><a href="#cb682-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/rvalue_lvalue_ut.cpp 65</span></span>
<span id="cb682-2"><a href="#cb682-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb682-3"><a href="#cb682-3" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#define IS_LVALUE</span><span class="op">(</span>EXPR_<span class="op">)</span><span class="pp"> </span><span class="bu">std::</span>is_lvalue_reference_v<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">((</span>EXPR_<span class="op">))&gt;</span></span>
<span id="cb682-4"><a href="#cb682-4" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#define IS_XVALUE</span><span class="op">(</span>EXPR_<span class="op">)</span><span class="pp"> </span><span class="bu">std::</span>is_rvalue_reference_v<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">((</span>EXPR_<span class="op">))&gt;</span></span>
<span id="cb682-5"><a href="#cb682-5" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#define IS_PRVALUE</span><span class="op">(</span>EXPR_<span class="op">)</span><span class="pp"> </span><span class="op">!</span><span class="bu">std::</span>is_reference_v<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">((</span>EXPR_<span class="op">))&gt;</span></span>
<span id="cb682-6"><a href="#cb682-6" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#define IS_RVALUE</span><span class="op">(</span>EXPR_<span class="op">)</span><span class="pp"> </span><span class="op">(</span>IS_PRVALUE<span class="op">(</span>EXPR_<span class="op">)</span><span class="pp"> </span><span class="op">||</span><span class="pp"> </span>IS_XVALUE<span class="op">(</span>EXPR_<span class="op">))</span></span>
<span id="cb682-7"><a href="#cb682-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb682-8"><a href="#cb682-8" aria-hidden="true" tabindex="-1"></a>    TEST<span class="op">(</span>Expression<span class="op">,</span> rvalue<span class="op">)</span></span>
<span id="cb682-9"><a href="#cb682-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb682-10"><a href="#cb682-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> str <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{};</span></span>
<span id="cb682-11"><a href="#cb682-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb682-12"><a href="#cb682-12" aria-hidden="true" tabindex="-1"></a>        <span class="kw">static_assert</span><span class="op">(</span>IS_LVALUE<span class="op">(</span>str<span class="op">),</span> <span class="st">&quot;EXPR_ must be lvalue&quot;</span><span class="op">);</span></span>
<span id="cb682-13"><a href="#cb682-13" aria-hidden="true" tabindex="-1"></a>        <span class="kw">static_assert</span><span class="op">(!</span>IS_RVALUE<span class="op">(</span>str<span class="op">),</span> <span class="st">&quot;EXPR_ must NOT be rvalue&quot;</span><span class="op">);</span></span>
<span id="cb682-14"><a href="#cb682-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb682-15"><a href="#cb682-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">static_assert</span><span class="op">(</span>IS_XVALUE<span class="op">(</span><span class="bu">std::</span>move<span class="op">(</span>str<span class="op">)),</span> <span class="st">&quot;EXPR_ must be xvalue&quot;</span><span class="op">);</span></span>
<span id="cb682-16"><a href="#cb682-16" aria-hidden="true" tabindex="-1"></a>        <span class="kw">static_assert</span><span class="op">(!</span>IS_PRVALUE<span class="op">(</span><span class="bu">std::</span>move<span class="op">(</span>str<span class="op">)),</span> <span class="st">&quot;EXPR_ must NOT be prvalue&quot;</span><span class="op">);</span></span>
<span id="cb682-17"><a href="#cb682-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb682-18"><a href="#cb682-18" aria-hidden="true" tabindex="-1"></a>        <span class="kw">static_assert</span><span class="op">(</span>IS_PRVALUE<span class="op">(</span><span class="bu">std::</span>string<span class="op">{}),</span> <span class="st">&quot;EXPR_ must be prvalue&quot;</span><span class="op">);</span></span>
<span id="cb682-19"><a href="#cb682-19" aria-hidden="true" tabindex="-1"></a>        <span class="kw">static_assert</span><span class="op">(</span>IS_RVALUE<span class="op">(</span><span class="bu">std::</span>string<span class="op">{}),</span> <span class="st">&quot;EXPR_ must be rvalue&quot;</span><span class="op">);</span></span>
<span id="cb682-20"><a href="#cb682-20" aria-hidden="true" tabindex="-1"></a>        <span class="kw">static_assert</span><span class="op">(!</span>IS_LVALUE<span class="op">(</span><span class="bu">std::</span>string<span class="op">{}),</span> <span class="st">&quot;EXPR_ must NOT be lvalue&quot;</span><span class="op">);</span></span>
<span id="cb682-21"><a href="#cb682-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<h3 id="lvalue">lvalue <a id="SS_5_5_2"></a></h3>
<p>「<a href="#SS_5_5_1">expression</a>」を参照せよ。</p>
<h3 id="rvalue">rvalue <a id="SS_5_5_3"></a></h3>
<p>「<a href="#SS_5_5_1">expression</a>」を参照せよ。</p>
<h4 id="xvalue">xvalue <a id="SS_5_5_3_1"></a></h4>
<p>「<a href="#SS_5_5_1">expression</a>」を参照せよ。</p>
<h4 id="prvalue">prvalue <a id="SS_5_5_3_2"></a></h4>
<p>「<a href="#SS_5_5_1">expression</a>」を参照せよ。</p>
<h3 id="rvalue修飾">rvalue修飾 <a id="SS_5_5_4"></a></h3>
<p>下記GetString0()のような関数が返すオブジェクトの内部メンバに対するハンドルは、
オブジェクトのライフタイム終了後にもアクセスすることができるため、
そのハンドルを通じて、
ライフタイム終了後のオブジェクトのメンバオブジェクトにもアクセスできてしまう。</p>
<p>ライフタイム終了後のオブジェクトにアクセスすることは未定義動作であり、
特にそのオブジェクトがrvalueであった場合、さらにその危険性は高まる。</p>
<p>こういったコードに対処するためのシンタックスが、lvalue修飾、rvalue修飾である。</p>
<p>下記GetString1()、GetString3()、GetString4()のようにメンバ関数をlvalue修飾やrvalue修飾することで、
rvalueの内部ハンドルを返さないようにすることが可能となり、上記の危険性を緩和することができる。</p>
<div class="sourceCode" id="cb683"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb683-1"><a href="#cb683-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/rvalue_lvalue_ut.cpp 91</span></span>
<span id="cb683-2"><a href="#cb683-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb683-3"><a href="#cb683-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> C <span class="op">{</span></span>
<span id="cb683-4"><a href="#cb683-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb683-5"><a href="#cb683-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> C<span class="op">(</span><span class="dt">char</span> <span class="at">const</span><span class="op">*</span> str<span class="op">)</span> <span class="op">:</span> <span class="va">str_</span><span class="op">{</span>str<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb683-6"><a href="#cb683-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb683-7"><a href="#cb683-7" aria-hidden="true" tabindex="-1"></a>        <span class="co">// lvalue修飾なし、rvalue修飾なし</span></span>
<span id="cb683-8"><a href="#cb683-8" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op">&amp;</span> GetString0<span class="op">()</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">str_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb683-9"><a href="#cb683-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb683-10"><a href="#cb683-10" aria-hidden="true" tabindex="-1"></a>        <span class="co">// lvalue修飾</span></span>
<span id="cb683-11"><a href="#cb683-11" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span><span class="op">&amp;</span> GetString1<span class="op">()</span> <span class="at">const</span><span class="op">&amp;</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">str_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb683-12"><a href="#cb683-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb683-13"><a href="#cb683-13" aria-hidden="true" tabindex="-1"></a>        <span class="co">// rvalue修飾</span></span>
<span id="cb683-14"><a href="#cb683-14" aria-hidden="true" tabindex="-1"></a>        <span class="co">// *thisがrvalueの場合でのGetString1()の呼び出しは、この関数を呼び出すため、</span></span>
<span id="cb683-15"><a href="#cb683-15" aria-hidden="true" tabindex="-1"></a>        <span class="co">// class内部のハンドルを返してはならない。</span></span>
<span id="cb683-16"><a href="#cb683-16" aria-hidden="true" tabindex="-1"></a>        <span class="co">// また、それによりstd::stringを生成するため、noexcept指定してはならない。</span></span>
<span id="cb683-17"><a href="#cb683-17" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span>GetString1<span class="op">()</span> <span class="at">const</span><span class="op">&amp;&amp;</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">str_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb683-18"><a href="#cb683-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb683-19"><a href="#cb683-19" aria-hidden="true" tabindex="-1"></a>        <span class="co">// lvalue修飾だが、const関数はrvalueからでも呼び出せる。</span></span>
<span id="cb683-20"><a href="#cb683-20" aria-hidden="true" tabindex="-1"></a>        <span class="co">// rvalueに対しての呼び出しを禁止したい場合には、GetString4のようにする。</span></span>
<span id="cb683-21"><a href="#cb683-21" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span><span class="op">&amp;</span> GetString2<span class="op">()</span> <span class="at">const</span><span class="op">&amp;</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">str_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb683-22"><a href="#cb683-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb683-23"><a href="#cb683-23" aria-hidden="true" tabindex="-1"></a>        <span class="co">// lvalue修飾</span></span>
<span id="cb683-24"><a href="#cb683-24" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 非constなのでrvalueからは呼び出せない。</span></span>
<span id="cb683-25"><a href="#cb683-25" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span><span class="op">&amp;</span> GetString3<span class="op">()</span> <span class="op">&amp;</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">str_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb683-26"><a href="#cb683-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb683-27"><a href="#cb683-27" aria-hidden="true" tabindex="-1"></a>        <span class="co">// lvalue修飾</span></span>
<span id="cb683-28"><a href="#cb683-28" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span><span class="op">&amp;</span> GetString4<span class="op">()</span> <span class="at">const</span><span class="op">&amp;</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">str_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb683-29"><a href="#cb683-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb683-30"><a href="#cb683-30" aria-hidden="true" tabindex="-1"></a>        <span class="co">// rvalue修飾</span></span>
<span id="cb683-31"><a href="#cb683-31" aria-hidden="true" tabindex="-1"></a>        <span class="co">// rvalueからこの関数を呼び出されるとrvalueオブジェクトの内部ハンドルを返してしまい、</span></span>
<span id="cb683-32"><a href="#cb683-32" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 危険なので=deleteすべき。</span></span>
<span id="cb683-33"><a href="#cb683-33" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span><span class="op">&amp;</span> GetString4<span class="op">()</span> <span class="at">const</span><span class="op">&amp;&amp;</span> <span class="op">=</span> <span class="kw">delete</span><span class="op">;</span></span>
<span id="cb683-34"><a href="#cb683-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb683-35"><a href="#cb683-35" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb683-36"><a href="#cb683-36" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span><span class="va">str_</span><span class="op">;</span></span>
<span id="cb683-37"><a href="#cb683-37" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<div class="sourceCode" id="cb684"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb684-1"><a href="#cb684-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/rvalue_lvalue_ut.cpp 132</span></span>
<span id="cb684-2"><a href="#cb684-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb684-3"><a href="#cb684-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span>        c    <span class="op">=</span> C<span class="op">{</span><span class="st">&quot;c0&quot;</span><span class="op">};</span></span>
<span id="cb684-4"><a href="#cb684-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> <span class="at">const</span><span class="op">&amp;</span> s0_0 <span class="op">=</span> c<span class="op">.</span>GetString0<span class="op">();</span>        <span class="co">// OK cが解放されるまでs0_0は有効</span></span>
<span id="cb684-5"><a href="#cb684-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span>        s0_1 <span class="op">=</span> C<span class="op">{</span><span class="st">&quot;c1&quot;</span><span class="op">}.</span>GetString0<span class="op">();</span>  <span class="co">// NG 危険なコード</span></span>
<span id="cb684-6"><a href="#cb684-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">// s0_1が指すオブジェクトは、次の行で無効になる</span></span>
<span id="cb684-7"><a href="#cb684-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb684-8"><a href="#cb684-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> <span class="at">const</span><span class="op">&amp;</span> s1_0 <span class="op">=</span> c<span class="op">.</span>GetString1<span class="op">();</span>        <span class="co">// OK GetString1()&amp;が呼び出される</span></span>
<span id="cb684-9"><a href="#cb684-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> <span class="at">const</span><span class="op">&amp;</span> s1_1 <span class="op">=</span> C<span class="op">{</span><span class="st">&quot;c1&quot;</span><span class="op">}.</span>GetString1<span class="op">();</span>  <span class="co">// OK GetString1()&amp;&amp;が呼び出される</span></span>
<span id="cb684-10"><a href="#cb684-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">// s1_0が指すrvalueはs1_0がスコープアウトするまで有効</span></span>
<span id="cb684-11"><a href="#cb684-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb684-12"><a href="#cb684-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> <span class="at">const</span><span class="op">&amp;</span> s2_0 <span class="op">=</span> c<span class="op">.</span>GetString2<span class="op">();</span>        <span class="co">// OK GetString2()&amp;が呼び出される</span></span>
<span id="cb684-13"><a href="#cb684-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> <span class="at">const</span><span class="op">&amp;</span> s2_1 <span class="op">=</span> C<span class="op">{</span><span class="st">&quot;c1&quot;</span><span class="op">}.</span>GetString2<span class="op">();</span>  <span class="co">// NG const関数はlvalue修飾しても呼び出し可能</span></span>
<span id="cb684-14"><a href="#cb684-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">// s2_1が指すオブジェクトは、次の行で無効になる</span></span>
<span id="cb684-15"><a href="#cb684-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb684-16"><a href="#cb684-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> <span class="at">const</span><span class="op">&amp;</span> s3_0 <span class="op">=</span> c<span class="op">.</span>GetString3<span class="op">();</span>  <span class="co">// OK GetString3()&amp;が呼び出される</span></span>
<span id="cb684-17"><a href="#cb684-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">// auto const&amp; s3_1 = C{&quot;c1&quot;}.GetString3();  // 危険なのでコンパイルさせない</span></span>
<span id="cb684-18"><a href="#cb684-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb684-19"><a href="#cb684-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> <span class="at">const</span><span class="op">&amp;</span> s4_0 <span class="op">=</span> c<span class="op">.</span>GetString4<span class="op">();</span>  <span class="co">// OK GetString4()&amp;が呼び出される</span></span>
<span id="cb684-20"><a href="#cb684-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">// auto const&amp; s4_1 = C{&quot;c1&quot;}.GetString4();  // 危険なのでコンパイルさせない</span></span></code></pre></div>
<h3 id="lvalue修飾">lvalue修飾 <a id="SS_5_5_5"></a></h3>
<p><a href="#SS_5_5_4">rvalue修飾</a>を参照せよ。</p>
<h3 id="リファレンス修飾">リファレンス修飾 <a id="SS_5_5_6"></a></h3>
<p><a href="#SS_5_5_4">rvalue修飾</a>と<a
href="#SS_5_5_5">lvalue修飾</a>とを併せて、リファレンス修飾と呼ぶ。</p>
<h3 id="decltype">decltype <a id="SS_5_5_7"></a></h3>
<p>decltypeはオペランドに<a
href="#SS_5_5_1">expression</a>を取り、その型を算出する機能である。
decltype(auto)はそのオペランドの省略形である。
autoとdecltypeでは、以下に示す通りリファレンスの扱いが異なることに注意する必要がある。</p>
<div class="sourceCode" id="cb685"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb685-1"><a href="#cb685-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/decltype_ut.cpp 7</span></span>
<span id="cb685-2"><a href="#cb685-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb685-3"><a href="#cb685-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int32_t</span>  x<span class="op">{</span><span class="dv">3</span><span class="op">};</span></span>
<span id="cb685-4"><a href="#cb685-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int32_t</span><span class="op">&amp;</span> r<span class="op">{</span>x<span class="op">};</span></span>
<span id="cb685-5"><a href="#cb685-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb685-6"><a href="#cb685-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span>           a <span class="op">=</span> r<span class="op">;</span>  <span class="co">// aの型はint32_t</span></span>
<span id="cb685-7"><a href="#cb685-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">decltype</span><span class="op">(</span>r<span class="op">)</span>    b <span class="op">=</span> r<span class="op">;</span>  <span class="co">// bの型はint32_t&amp;</span></span>
<span id="cb685-8"><a href="#cb685-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">decltype</span><span class="op">(</span><span class="kw">auto</span><span class="op">)</span> c <span class="op">=</span> r<span class="op">;</span>  <span class="co">// cの型はint32_t&amp;   C++14からサポート</span></span>
<span id="cb685-9"><a href="#cb685-9" aria-hidden="true" tabindex="-1"></a>                           <span class="co">// decltype(auto)は、decltypeに右辺の式を与えるための構文</span></span>
<span id="cb685-10"><a href="#cb685-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb685-11"><a href="#cb685-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">// std::is_sameはオペランドの型が同じか否かを返すメタ関数</span></span>
<span id="cb685-12"><a href="#cb685-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span>a<span class="op">),</span> <span class="dt">int</span><span class="op">&gt;);</span></span>
<span id="cb685-13"><a href="#cb685-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span>b<span class="op">),</span> <span class="dt">int</span><span class="op">&amp;&gt;);</span></span>
<span id="cb685-14"><a href="#cb685-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span>c<span class="op">),</span> <span class="dt">int</span><span class="op">&amp;&gt;);</span></span></code></pre></div>
<p>decltypeは、テンプレートプログラミングに多用されるが、
クロージャ型(「<a href="#SS_5_10_4">ラムダ式</a>」参照)
のような記述不可能な型をオブジェクトから算出できるため、
下記例のような場合にも有用である。</p>
<div class="sourceCode" id="cb686"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb686-1"><a href="#cb686-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/decltype_ut.cpp 26</span></span>
<span id="cb686-2"><a href="#cb686-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb686-3"><a href="#cb686-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">//  本来ならばA::dataは、</span></span>
<span id="cb686-4"><a href="#cb686-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">//      * A::Aでメモリ割り当て</span></span>
<span id="cb686-5"><a href="#cb686-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">//      * A::~Aでメモリ解放</span></span>
<span id="cb686-6"><a href="#cb686-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">//  すべきだが、何らかの理由でそれが出来ないとする</span></span>
<span id="cb686-7"><a href="#cb686-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> A <span class="op">{</span></span>
<span id="cb686-8"><a href="#cb686-8" aria-hidden="true" tabindex="-1"></a>        <span class="dt">size_t</span>   len<span class="op">;</span></span>
<span id="cb686-9"><a href="#cb686-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">uint8_t</span><span class="op">*</span> data<span class="op">;</span></span>
<span id="cb686-10"><a href="#cb686-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb686-11"><a href="#cb686-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb686-12"><a href="#cb686-12" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> do_something<span class="op">(</span><span class="dt">size_t</span> len<span class="op">)</span></span>
<span id="cb686-13"><a href="#cb686-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb686-14"><a href="#cb686-14" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> deallocate <span class="op">=</span> <span class="op">[](</span>A<span class="op">*</span> p<span class="op">)</span> <span class="op">{</span></span>
<span id="cb686-15"><a href="#cb686-15" aria-hidden="true" tabindex="-1"></a>            <span class="kw">delete</span><span class="op">[](</span>p<span class="op">-&gt;</span>data<span class="op">);</span></span>
<span id="cb686-16"><a href="#cb686-16" aria-hidden="true" tabindex="-1"></a>            <span class="kw">delete</span> p<span class="op">;</span></span>
<span id="cb686-17"><a href="#cb686-17" aria-hidden="true" tabindex="-1"></a>        <span class="op">};</span></span>
<span id="cb686-18"><a href="#cb686-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb686-19"><a href="#cb686-19" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> a_ptr <span class="op">=</span> <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span>A<span class="op">,</span> <span class="kw">decltype</span><span class="op">(</span>deallocate<span class="op">)&gt;{</span><span class="kw">new</span> A<span class="op">,</span> deallocate<span class="op">};</span></span>
<span id="cb686-20"><a href="#cb686-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb686-21"><a href="#cb686-21" aria-hidden="true" tabindex="-1"></a>        a_ptr<span class="op">-&gt;</span>len  <span class="op">=</span> len<span class="op">;</span></span>
<span id="cb686-22"><a href="#cb686-22" aria-hidden="true" tabindex="-1"></a>        a_ptr<span class="op">-&gt;</span>data <span class="op">=</span> <span class="kw">new</span> <span class="dt">uint8_t</span><span class="op">[</span><span class="dv">10</span><span class="op">];</span></span>
<span id="cb686-23"><a href="#cb686-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb686-24"><a href="#cb686-24" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb686-25"><a href="#cb686-25" aria-hidden="true" tabindex="-1"></a>        <span class="co">// do something for a_ptr</span></span>
<span id="cb686-26"><a href="#cb686-26" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb686-27"><a href="#cb686-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb686-28"><a href="#cb686-28" aria-hidden="true" tabindex="-1"></a>        <span class="co">// a_ptrによるメモリの自動解放</span></span>
<span id="cb686-29"><a href="#cb686-29" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<h2 id="リファレンス">リファレンス <a id="SS_5_6"></a></h2>
<p>ここでは、C++11から導入された</p>
<ul>
<li><a href="#SS_5_6_1">ユニバーサルリファレンス</a></li>
<li><a href="#SS_5_6_4">リファレンスcollapsing</a></li>
</ul>
<p>について解説する。</p>
<h3 id="ユニバーサルリファレンス">ユニバーサルリファレンス
<a id="SS_5_6_1"></a></h3>
<p>関数テンプレートの型パラメータや型推論autoに&amp;&amp;をつけて宣言された変数を、
ユニバーサルリファレンスと呼ぶ(C++17から「forwardingリファレンス」という正式名称が与えられた)。
ユニバーサルリファレンスは一見rvalueリファレンスのように見えるが、
下記に示す通り、lvalueにもrvalueにもバインドできる。</p>
<div class="sourceCode" id="cb687"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb687-1"><a href="#cb687-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/universal_ref_ut.cpp 8</span></span>
<span id="cb687-2"><a href="#cb687-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb687-3"><a href="#cb687-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb687-4"><a href="#cb687-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> f<span class="op">(</span>T<span class="op">&amp;&amp;</span> t<span class="op">)</span> <span class="kw">noexcept</span>  <span class="co">// tはユニバーサルリファレンス</span></span>
<span id="cb687-5"><a href="#cb687-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb687-6"><a href="#cb687-6" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb687-7"><a href="#cb687-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb687-8"><a href="#cb687-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb687-9"><a href="#cb687-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb687-10"><a href="#cb687-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> g<span class="op">(</span><span class="bu">std::</span>vector<span class="op">&lt;</span>T<span class="op">&gt;&amp;&amp;</span> t<span class="op">)</span> <span class="kw">noexcept</span>  <span class="co">// tはrvalueリファレンス</span></span>
<span id="cb687-11"><a href="#cb687-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb687-12"><a href="#cb687-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb687-13"><a href="#cb687-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb688"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb688-1"><a href="#cb688-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/universal_ref_ut.cpp 29</span></span>
<span id="cb688-2"><a href="#cb688-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb688-3"><a href="#cb688-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span>       vec  <span class="op">=</span> <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;{</span><span class="st">&quot;lvalue&quot;</span><span class="op">};</span>   <span class="co">// vecはlvalue</span></span>
<span id="cb688-4"><a href="#cb688-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> <span class="at">const</span> cvec <span class="op">=</span> <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;{</span><span class="st">&quot;clvalue&quot;</span><span class="op">};</span>  <span class="co">// cvecはconstなlvalue</span></span>
<span id="cb688-5"><a href="#cb688-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb688-6"><a href="#cb688-6" aria-hidden="true" tabindex="-1"></a>    f<span class="op">(</span>vec<span class="op">);</span>                                 <span class="co">// 引数はlvalue</span></span>
<span id="cb688-7"><a href="#cb688-7" aria-hidden="true" tabindex="-1"></a>    f<span class="op">(</span>cvec<span class="op">);</span>                                <span class="co">// 引数はconstなlvalue</span></span>
<span id="cb688-8"><a href="#cb688-8" aria-hidden="true" tabindex="-1"></a>    f<span class="op">(</span><span class="bu">std::</span>vector<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;{</span><span class="st">&quot;rvalue&quot;</span><span class="op">});</span>  <span class="co">// 引数はrvalue</span></span>
<span id="cb688-9"><a href="#cb688-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb688-10"><a href="#cb688-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">// g(vec);  // 引数がlvalueなのでコンパイルエラー</span></span>
<span id="cb688-11"><a href="#cb688-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">// g(cvec); // 引数がconst lvalueなのでコンパイルエラー</span></span>
<span id="cb688-12"><a href="#cb688-12" aria-hidden="true" tabindex="-1"></a>    g<span class="op">(</span><span class="bu">std::</span>vector<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;{</span><span class="st">&quot;rvalue&quot;</span><span class="op">});</span>  <span class="co">// 引数はrvalue</span></span></code></pre></div>
<p>下記のコードはジェネリックラムダ(「<a
href="#SS_5_10_4">ラムダ式</a>」参照)
の引数をユニバーサルリファレンスにした例である。</p>
<div class="sourceCode" id="cb689"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb689-1"><a href="#cb689-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/universal_ref_ut.cpp 47</span></span>
<span id="cb689-2"><a href="#cb689-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb689-3"><a href="#cb689-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// sはユニバーサルリファレンス</span></span>
<span id="cb689-4"><a href="#cb689-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> <span class="dt">value_type</span> <span class="op">=</span> <span class="op">[](</span><span class="kw">auto</span><span class="op">&amp;&amp;</span> s<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span></span>
<span id="cb689-5"><a href="#cb689-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&amp;,</span> <span class="kw">decltype</span><span class="op">(</span>s<span class="op">)&gt;)</span> <span class="op">{</span></span>
<span id="cb689-6"><a href="#cb689-6" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb689-7"><a href="#cb689-7" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb689-8"><a href="#cb689-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span><span class="op">&amp;,</span> <span class="kw">decltype</span><span class="op">(</span>s<span class="op">)&gt;)</span> <span class="op">{</span></span>
<span id="cb689-9"><a href="#cb689-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb689-10"><a href="#cb689-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb689-11"><a href="#cb689-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&amp;&amp;,</span> <span class="kw">decltype</span><span class="op">(</span>s<span class="op">)&gt;)</span> <span class="op">{</span></span>
<span id="cb689-12"><a href="#cb689-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb689-13"><a href="#cb689-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb689-14"><a href="#cb689-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb689-15"><a href="#cb689-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb689-16"><a href="#cb689-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb689-17"><a href="#cb689-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span>       str  <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{</span><span class="st">&quot;lvalue&quot;</span><span class="op">};</span></span>
<span id="cb689-18"><a href="#cb689-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> <span class="at">const</span> cstr <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{</span><span class="st">&quot;const lvalue&quot;</span><span class="op">};</span></span>
<span id="cb689-19"><a href="#cb689-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb689-20"><a href="#cb689-20" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">0</span><span class="op">,</span> <span class="dt">value_type</span><span class="op">(</span>str<span class="op">));</span></span>
<span id="cb689-21"><a href="#cb689-21" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dt">value_type</span><span class="op">(</span>cstr<span class="op">));</span></span>
<span id="cb689-22"><a href="#cb689-22" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="dv">2</span><span class="op">,</span> <span class="dt">value_type</span><span class="op">(</span><span class="bu">std::</span>string<span class="op">{</span><span class="st">&quot;rvalue&quot;</span><span class="op">}));</span></span></code></pre></div>
<p>通常、ユニバーサルリファレンスはstd::forwardと組み合わせて使用される。</p>
<h3 id="forwardingリファレンス">forwardingリファレンス
<a id="SS_5_6_2"></a></h3>
<p>「<a href="#SS_5_6_1">ユニバーサルリファレンス</a>」を参照せよ。</p>
<h3 id="perfect-forwarding">perfect forwarding
<a id="SS_5_6_3"></a></h3>
<p>perfect forwarding とは、引数の<a href="#SS_5_5_3">rvalue</a>性や <a
href="#SS_5_5_2">lvalue</a>性を損失することなく、
その引数を別の関数に転送する技術のことを指す。 通常は、<a
href="#SS_5_6_1">ユニバーサルリファレンス</a>である関数の仮引数をstd::forwardを用いて、
他の関数に渡すことで実現される。</p>
<h3 id="リファレンスcollapsing">リファレンスcollapsing
<a id="SS_5_6_4"></a></h3>
<p>Tを任意の型とし、TRを下記のように宣言した場合、</p>
<div class="sourceCode" id="cb690"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb690-1"><a href="#cb690-1" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> TR <span class="op">=</span> T<span class="op">&amp;;</span></span></code></pre></div>
<p>下記のようなコードは、C++03ではコンパイルエラーとなったが、
C++11からはエラーとならず、TRRはT&amp;となる。</p>
<div class="sourceCode" id="cb691"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb691-1"><a href="#cb691-1" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> TRR <span class="op">=</span> TR<span class="op">&amp;;</span></span></code></pre></div>
<p>2つの&amp;を1つに折り畳む、このような機能をリファレンスcollapsingと呼ぶ。</p>
<p>下記はTをintとした場合のリファレンスcollapsingの動きを示している。</p>
<div class="sourceCode" id="cb692"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb692-1"><a href="#cb692-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/ref_collapsing_ut.cpp 7</span></span>
<span id="cb692-2"><a href="#cb692-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb692-3"><a href="#cb692-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i<span class="op">;</span></span>
<span id="cb692-4"><a href="#cb692-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb692-5"><a href="#cb692-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> IR  <span class="op">=</span> <span class="dt">int</span><span class="op">&amp;;</span></span>
<span id="cb692-6"><a href="#cb692-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> IRR <span class="op">=</span> IR<span class="op">&amp;;</span>  <span class="co">// IRRはint&amp; &amp;となり、int&amp;に変換される</span></span>
<span id="cb692-7"><a href="#cb692-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb692-8"><a href="#cb692-8" aria-hidden="true" tabindex="-1"></a>    IR  ir  <span class="op">=</span> i<span class="op">;</span></span>
<span id="cb692-9"><a href="#cb692-9" aria-hidden="true" tabindex="-1"></a>    IRR irr <span class="op">=</span> ir<span class="op">;</span></span>
<span id="cb692-10"><a href="#cb692-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb692-11"><a href="#cb692-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">&amp;,</span> <span class="kw">decltype</span><span class="op">(</span>ir<span class="op">)&gt;);</span>   <span class="co">// lvalueリファレンス</span></span>
<span id="cb692-12"><a href="#cb692-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">&amp;,</span> <span class="kw">decltype</span><span class="op">(</span>irr<span class="op">)&gt;);</span>  <span class="co">// lvalueリファレンス</span></span></code></pre></div>
<p>リファレンスcollapsingは、型エイリアス、型であるテンプレートパラメータ、decltypeに対して行われる。
詳細な変換則は、下記のようになる。</p>
<pre><code>    T&amp; &amp;   -&gt; T&amp;
    T&amp; &amp;&amp;  -&gt; T&amp;
    T&amp;&amp; &amp;  -&gt; T&amp;
    T&amp;&amp; &amp;&amp; -&gt; T&amp;&amp;</code></pre>
<p>下記のようなクラステンプレートを定義した場合、</p>
<div class="sourceCode" id="cb694"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb694-1"><a href="#cb694-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/ref_collapsing_ut.cpp 26</span></span>
<span id="cb694-2"><a href="#cb694-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb694-3"><a href="#cb694-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb694-4"><a href="#cb694-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> Ref <span class="op">{</span></span>
<span id="cb694-5"><a href="#cb694-5" aria-hidden="true" tabindex="-1"></a>        T<span class="op">&amp;</span>  t<span class="op">;</span></span>
<span id="cb694-6"><a href="#cb694-6" aria-hidden="true" tabindex="-1"></a>        T<span class="op">&amp;&amp;</span> u<span class="op">;</span></span>
<span id="cb694-7"><a href="#cb694-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>下記のコードにより、テンプレートパラメータに対するこの変換則を確かめることができる。</p>
<div class="sourceCode" id="cb695"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb695-1"><a href="#cb695-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/ref_collapsing_ut.cpp 38</span></span>
<span id="cb695-2"><a href="#cb695-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb695-3"><a href="#cb695-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">&amp;,</span> <span class="kw">decltype</span><span class="op">(</span>Ref<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;::</span>t<span class="op">)&gt;);</span>    <span class="co">// lvalueリファレンス</span></span>
<span id="cb695-4"><a href="#cb695-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">&amp;&amp;,</span> <span class="kw">decltype</span><span class="op">(</span>Ref<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;::</span>u<span class="op">)&gt;);</span>   <span class="co">// rvalueリファレンス</span></span>
<span id="cb695-5"><a href="#cb695-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb695-6"><a href="#cb695-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">&amp;,</span> <span class="kw">decltype</span><span class="op">(</span>Ref<span class="op">&lt;</span><span class="dt">int</span><span class="op">&amp;&gt;::</span>t<span class="op">)&gt;);</span>   <span class="co">// lvalueリファレンス</span></span>
<span id="cb695-7"><a href="#cb695-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">&amp;,</span> <span class="kw">decltype</span><span class="op">(</span>Ref<span class="op">&lt;</span><span class="dt">int</span><span class="op">&amp;&gt;::</span>u<span class="op">)&gt;);</span>   <span class="co">// lvalueリファレンス</span></span>
<span id="cb695-8"><a href="#cb695-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb695-9"><a href="#cb695-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">&amp;,</span> <span class="kw">decltype</span><span class="op">(</span>Ref<span class="op">&lt;</span><span class="dt">int</span><span class="op">&amp;&amp;&gt;::</span>t<span class="op">)&gt;);</span>  <span class="co">// lvalueリファレンス</span></span>
<span id="cb695-10"><a href="#cb695-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">&amp;&amp;,</span> <span class="kw">decltype</span><span class="op">(</span>Ref<span class="op">&lt;</span><span class="dt">int</span><span class="op">&amp;&amp;&gt;::</span>u<span class="op">)&gt;);</span> <span class="co">// rvalueリファレンス</span></span></code></pre></div>
<p>この機能がないC++03では、</p>
<div class="sourceCode" id="cb696"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb696-1"><a href="#cb696-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/ref_collapsing_ut.cpp 52</span></span>
<span id="cb696-2"><a href="#cb696-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb696-3"><a href="#cb696-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb696-4"><a href="#cb696-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> AddRef <span class="op">{</span></span>
<span id="cb696-5"><a href="#cb696-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> type <span class="op">=</span> T<span class="op">&amp;;</span></span>
<span id="cb696-6"><a href="#cb696-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>ようなクラステンプレートに下記コードのようにリファレンス型を渡すとコンパイルエラーとなる。</p>
<div class="sourceCode" id="cb697"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb697-1"><a href="#cb697-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/ref_collapsing_ut.cpp 69</span></span>
<span id="cb697-2"><a href="#cb697-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb697-3"><a href="#cb697-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static_assert</span><span class="op">(</span><span class="bu">std::</span>is_same_v<span class="op">&lt;</span><span class="dt">int</span><span class="op">&amp;,</span> AddRef<span class="op">&lt;</span><span class="dt">int</span><span class="op">&amp;&gt;::</span>type<span class="op">&gt;);</span></span></code></pre></div>
<p>この問題を回避するためには下記のようなテンプレートの特殊化が必要になる。</p>
<div class="sourceCode" id="cb698"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb698-1"><a href="#cb698-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/ref_collapsing_ut.cpp 59</span></span>
<span id="cb698-2"><a href="#cb698-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb698-3"><a href="#cb698-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb698-4"><a href="#cb698-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> AddRef<span class="op">&lt;</span>T<span class="op">&amp;&gt;</span> <span class="op">{</span></span>
<span id="cb698-5"><a href="#cb698-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> type <span class="op">=</span> T<span class="op">&amp;;</span></span>
<span id="cb698-6"><a href="#cb698-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>上記したようなクラステンプレートでのメンバエイリアスの宣言は、 <a
href="https://ja.wikipedia.org/wiki/%E3%83%86%E3%83%B3%E3%83%97%E3%83%AC%E3%83%BC%E3%83%88%E3%83%A1%E3%82%BF%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0">テンプレートメタプログラミング</a>
で頻繁に使用されるため、
このようなテンプレートの特殊化を不要にするリファレンスcollapsingは、
有用な機能拡張であると言える。</p>
<h3 id="danglingリファレンス">danglingリファレンス
<a id="SS_5_6_5"></a></h3>
<p>Dangling
リファレンスとは、破棄後のオブジェクトを指しているリファレンスを指す。
このようなリファレンスにアクセスすると、未定義動作動作に繋がるに繋がる。</p>
<div class="sourceCode" id="cb699"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb699-1"><a href="#cb699-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/dangling_ut.cpp 9</span></span>
<span id="cb699-2"><a href="#cb699-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb699-3"><a href="#cb699-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bool</span> X_destructed<span class="op">;</span></span>
<span id="cb699-4"><a href="#cb699-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> X <span class="op">{</span></span>
<span id="cb699-5"><a href="#cb699-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb699-6"><a href="#cb699-6" aria-hidden="true" tabindex="-1"></a>        X<span class="op">()</span> <span class="op">{</span> X_destructed <span class="op">=</span> <span class="kw">false</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb699-7"><a href="#cb699-7" aria-hidden="true" tabindex="-1"></a>        <span class="op">~</span>X<span class="op">()</span> <span class="op">{</span> X_destructed <span class="op">=</span> <span class="kw">true</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb699-8"><a href="#cb699-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb699-9"><a href="#cb699-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb699-10"><a href="#cb699-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bool</span> A_destructed<span class="op">;</span></span>
<span id="cb699-11"><a href="#cb699-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> A <span class="op">{</span></span>
<span id="cb699-12"><a href="#cb699-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb699-13"><a href="#cb699-13" aria-hidden="true" tabindex="-1"></a>        A<span class="op">()</span> <span class="op">{</span> A_destructed <span class="op">=</span> <span class="kw">false</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb699-14"><a href="#cb699-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">~</span>A<span class="op">()</span> <span class="op">{</span> A_destructed <span class="op">=</span> <span class="kw">true</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb699-15"><a href="#cb699-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb699-16"><a href="#cb699-16" aria-hidden="true" tabindex="-1"></a>        X <span class="at">const</span><span class="op">&amp;</span> GetX<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">x_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb699-17"><a href="#cb699-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb699-18"><a href="#cb699-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb699-19"><a href="#cb699-19" aria-hidden="true" tabindex="-1"></a>        X <span class="va">x_</span><span class="op">;</span></span>
<span id="cb699-20"><a href="#cb699-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb699-21"><a href="#cb699-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb699-22"><a href="#cb699-22" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/dangling_ut.cpp 34</span></span>
<span id="cb699-23"><a href="#cb699-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb699-24"><a href="#cb699-24" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> a <span class="op">=</span> A<span class="op">{};</span></span>
<span id="cb699-25"><a href="#cb699-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb699-26"><a href="#cb699-26" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> <span class="at">const</span><span class="op">&amp;</span> x_safe <span class="op">=</span> a<span class="op">.</span>GetX<span class="op">();</span>  <span class="co">// x_safeはダングリングリファレンスではない</span></span>
<span id="cb699-27"><a href="#cb699-27" aria-hidden="true" tabindex="-1"></a>    ASSERT_FALSE<span class="op">(</span>A_destructed <span class="op">||</span> X_destructed<span class="op">);</span></span>
<span id="cb699-28"><a href="#cb699-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb699-29"><a href="#cb699-29" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> <span class="at">const</span><span class="op">&amp;</span> x_dangling <span class="op">=</span> A<span class="op">{}.</span>GetX<span class="op">();</span>  <span class="co">// 次の行でxが指すオブジェクトは解放される</span></span>
<span id="cb699-30"><a href="#cb699-30" aria-hidden="true" tabindex="-1"></a>    <span class="co">// この行ではxはdangngling リファレンスになる。</span></span>
<span id="cb699-31"><a href="#cb699-31" aria-hidden="true" tabindex="-1"></a>    ASSERT_TRUE<span class="op">(</span>A_destructed <span class="op">&amp;&amp;</span> X_destructed<span class="op">);</span></span>
<span id="cb699-32"><a href="#cb699-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb699-33"><a href="#cb699-33" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> <span class="at">const</span><span class="op">*</span> x_ptr_dangling <span class="op">=</span> <span class="op">&amp;</span>A<span class="op">{}.</span>GetX<span class="op">();</span>  <span class="co">// 次の行でxが指すオブジェクトは解放される</span></span>
<span id="cb699-34"><a href="#cb699-34" aria-hidden="true" tabindex="-1"></a>    <span class="co">// この行ではxはdangngling ポインタになる。</span></span>
<span id="cb699-35"><a href="#cb699-35" aria-hidden="true" tabindex="-1"></a>    ASSERT_TRUE<span class="op">(</span>A_destructed <span class="op">&amp;&amp;</span> X_destructed<span class="op">);</span></span></code></pre></div>
<h3 id="danglingポインタ">danglingポインタ <a id="SS_5_6_6"></a></h3>
<p>danglingポインタとは、<a
href="#SS_5_6_5">danglingリファレンス</a>と同じような状態になったポインタを指す。</p>
<h2 id="エクセプション安全性の保証">エクセプション安全性の保証
<a id="SS_5_7"></a></h2>
<p>関数のエクセプション発生時の安全性の保証には以下の3つのレベルが規定されている。</p>
<h3 id="no-fail保証">no-fail保証 <a id="SS_5_7_1"></a></h3>
<p>「no-fail保証」を満たす関数はエクセプションをthrowしない。</p>
<h3 id="強い保証">強い保証 <a id="SS_5_7_2"></a></h3>
<p>「強い保証」を満たす関数は、この関数がエクセプションによりスコープから外れた場合でも、
この関数が呼ばれなかった状態と同じ(プログラムカウンタ以外の状態は同じ)であることを保証する。
従って、この関数呼び出しは成功したか、完全な無効だったかのどちらかになる。</p>
<h3 id="基本保証">基本保証 <a id="SS_5_7_3"></a></h3>
<p>「基本保障」を満たす関数は、この関数がエクセプションによりスコープから外れた場合でも、
メモリ等のリソースリークは起こさず、
オブジェクトは(変更されたかもしれないが)引き続き使えることを保証する。</p>
<h2 id="シンタックスセマンティクス">シンタックス、セマンティクス
<a id="SS_5_8"></a></h2>
<p>直訳すれば、シンタックスとは構文論のことであり、セマンティクスとは意味論のことである。
この二つの概念の違いをはっきりと際立たせる有名な文を例示する。</p>
<pre><code>    Colorless green ideas sleep furiously(直訳:無色の緑の考えが猛烈に眠る)</code></pre>
<p>この文は構文的には正しい(シンタックスは問題ない)が、
意味不明である(セマンティクスは誤り)。</p>
<p>C++プログラミングにおいては、コンパイルできることがシンタックス的な正しさであり、例えば</p>
<ul>
<li>クラスや関数がその名前から想起できる責務を持っている
<ul>
<li>「<a href="#SS_1_1">単一責任の原則(SRP)</a>」を満たしている</li>
<li><a
href="#SS_2_4">Accessor</a>を実装する関数の名前は、GetXxxやSetXxxになっている</li>
<li>コンテナクラスのメンバ関数beginやendは、
そのクラスが保持する値集合の先頭や最後尾の次を指すイテレータを返す</li>
<li>等</li>
</ul></li>
<li>「<a href="#SS_5_8_1">等価性のセマンティクス</a>」を守ってる</li>
<li>「<a href="#SS_5_8_2">copyセマンティクス</a>」を守ってる</li>
<li>「<a href="#SS_5_8_3">moveセマンティクス</a>」を守っている</li>
</ul>
<p>等がセマンティクス的な正しさである。</p>
<p>セマンティクス的に正しいソースコードは読みやすく、保守性、拡張性に優れている。</p>
<h3 id="等価性のセマンティクス">等価性のセマンティクス
<a id="SS_5_8_1"></a></h3>
<p>純粋数学での実数の等号(=)は、任意の実数x、y、zに対して、</p>
<table>
<thead>
<tr class="header">
<th>律</th>
<th>意味</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>反射律</td>
<td>x = x</td>
</tr>
<tr class="even">
<td>対称律</td>
<td>x = yならばy = x</td>
</tr>
<tr class="odd">
<td>推移律</td>
<td>x = y且つy = zならばx = z</td>
</tr>
</tbody>
</table>
<p>を満たしている。x =
yが成立する場合、「xはyと等しい」もしくは「xはyと同一」であると言う。</p>
<p>C++における組み込みの==も純粋数学の等号と同じ性質を満たしている。
下記のコードは、その性質を表している。</p>
<div class="sourceCode" id="cb701"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb701-1"><a href="#cb701-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/semantics_ut.cpp 12</span></span>
<span id="cb701-2"><a href="#cb701-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb701-3"><a href="#cb701-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span>  a <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb701-4"><a href="#cb701-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span><span class="op">&amp;</span> b <span class="op">=</span> a<span class="op">;</span></span>
<span id="cb701-5"><a href="#cb701-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb701-6"><a href="#cb701-6" aria-hidden="true" tabindex="-1"></a>    ASSERT_TRUE<span class="op">(</span>a <span class="op">==</span> b<span class="op">);</span></span>
<span id="cb701-7"><a href="#cb701-7" aria-hidden="true" tabindex="-1"></a>    ASSERT_TRUE<span class="op">(&amp;</span>a <span class="op">==</span> <span class="op">&amp;</span>b<span class="op">);</span>  <span class="co">// aとbは同一</span></span></code></pre></div>
<p>しかし、下記のコード内のa、bは同じ値を持つが、
アドレスが異なるため同一のオブジェクトではないにもかかわらず、組み込みの==の値はtrueとなる。</p>
<div class="sourceCode" id="cb702"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb702-1"><a href="#cb702-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/semantics_ut.cpp 22</span></span>
<span id="cb702-2"><a href="#cb702-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3"><a href="#cb702-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> a <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb702-4"><a href="#cb702-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> b <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb702-5"><a href="#cb702-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-6"><a href="#cb702-6" aria-hidden="true" tabindex="-1"></a>    ASSERT_TRUE<span class="op">(</span>a <span class="op">==</span> b<span class="op">);</span></span>
<span id="cb702-7"><a href="#cb702-7" aria-hidden="true" tabindex="-1"></a>    ASSERT_FALSE<span class="op">(&amp;</span>a <span class="op">==</span> <span class="op">&amp;</span>b<span class="op">);</span>  <span class="co">// aとbは同一ではない</span></span></code></pre></div>
<p>このような場合、aとbは等価であるという。同一ならば等価であるが、等価であっても同一とは限らない。</p>
<p>ポインタや配列をオペランドとする場合を除き、C++における組み込みの==は、
数学の等号とは違い、等価を表していると考えられるが、
上記した3つの律を守っている。従ってオーバーロードoperator==も同じ性質を守る必要がある。</p>
<p>組み込みの==やオーバーロードoperator==のこのような性質をここでは「等価性のセマンティクス」と呼ぶ。</p>
<p>クラスAを下記のように定義し、</p>
<div class="sourceCode" id="cb703"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb703-1"><a href="#cb703-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/semantics_ut.cpp 33</span></span>
<span id="cb703-2"><a href="#cb703-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb703-3"><a href="#cb703-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> A <span class="op">{</span></span>
<span id="cb703-4"><a href="#cb703-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb703-5"><a href="#cb703-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> A<span class="op">(</span><span class="dt">int</span> num<span class="op">,</span> <span class="dt">char</span> <span class="at">const</span><span class="op">*</span> name<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">:</span> <span class="va">num_</span><span class="op">{</span>num<span class="op">},</span> <span class="va">name_</span><span class="op">{</span>name<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb703-6"><a href="#cb703-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb703-7"><a href="#cb703-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span>         GetNum<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">num_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb703-8"><a href="#cb703-8" aria-hidden="true" tabindex="-1"></a>        <span class="dt">char</span> <span class="at">const</span><span class="op">*</span> GetName<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">name_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb703-9"><a href="#cb703-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb703-10"><a href="#cb703-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb703-11"><a href="#cb703-11" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> <span class="at">const</span>   <span class="va">num_</span><span class="op">;</span></span>
<span id="cb703-12"><a href="#cb703-12" aria-hidden="true" tabindex="-1"></a>        <span class="dt">char</span> <span class="at">const</span><span class="op">*</span> <span class="va">name_</span><span class="op">;</span></span>
<span id="cb703-13"><a href="#cb703-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>そのoperator==を下記のように定義した場合、</p>
<div class="sourceCode" id="cb704"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb704-1"><a href="#cb704-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/semantics_ut.cpp 50</span></span>
<span id="cb704-2"><a href="#cb704-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb704-3"><a href="#cb704-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">inline</span> <span class="dt">bool</span> <span class="kw">operator</span><span class="op">==(</span>A <span class="at">const</span><span class="op">&amp;</span> lhs<span class="op">,</span> A <span class="at">const</span><span class="op">&amp;</span> rhs<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb704-4"><a href="#cb704-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb704-5"><a href="#cb704-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> lhs<span class="op">.</span>GetNum<span class="op">()</span> <span class="op">==</span> rhs<span class="op">.</span>GetNum<span class="op">()</span> <span class="op">&amp;&amp;</span> lhs<span class="op">.</span>GetName<span class="op">()</span> <span class="op">==</span> rhs<span class="op">.</span>GetName<span class="op">();</span></span>
<span id="cb704-6"><a href="#cb704-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>単体テストは下記のように書けるだろう。</p>
<div class="sourceCode" id="cb705"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb705-1"><a href="#cb705-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/semantics_ut.cpp 61</span></span>
<span id="cb705-2"><a href="#cb705-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb705-3"><a href="#cb705-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> a0 <span class="op">=</span> A<span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="st">&quot;a&quot;</span><span class="op">};</span></span>
<span id="cb705-4"><a href="#cb705-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> a1 <span class="op">=</span> A<span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="st">&quot;a&quot;</span><span class="op">};</span></span>
<span id="cb705-5"><a href="#cb705-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb705-6"><a href="#cb705-6" aria-hidden="true" tabindex="-1"></a>    ASSERT_TRUE<span class="op">(</span>a0 <span class="op">==</span> a1<span class="op">);</span></span></code></pre></div>
<p>これは、一応パスするが(処理系定義の動作を前提とするため、必ず動作する保証はない)、
下記のようにすると、パスしなくなる。</p>
<div class="sourceCode" id="cb706"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb706-1"><a href="#cb706-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/semantics_ut.cpp 71</span></span>
<span id="cb706-2"><a href="#cb706-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb706-3"><a href="#cb706-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> a0_name<span class="op">[]</span> <span class="op">=</span> <span class="st">&quot;a&quot;</span><span class="op">;</span></span>
<span id="cb706-4"><a href="#cb706-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> a0        <span class="op">=</span> A<span class="op">{</span><span class="dv">0</span><span class="op">,</span> a0_name<span class="op">};</span></span>
<span id="cb706-5"><a href="#cb706-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb706-6"><a href="#cb706-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> a1_name<span class="op">[]</span> <span class="op">=</span> <span class="st">&quot;a&quot;</span><span class="op">;</span></span>
<span id="cb706-7"><a href="#cb706-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> a1        <span class="op">=</span> A<span class="op">{</span><span class="dv">0</span><span class="op">,</span> a1_name<span class="op">};</span></span>
<span id="cb706-8"><a href="#cb706-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb706-9"><a href="#cb706-9" aria-hidden="true" tabindex="-1"></a>    ASSERT_TRUE<span class="op">(</span>a0 <span class="op">==</span> a1<span class="op">);</span>  <span class="co">// テストが失敗する</span></span></code></pre></div>
<p>一般にポインタの等価性は、その値の同一性ではなく、
そのポインタが指すオブジェクトの等価性で判断されるべきであるが、
先に示したoperator==はその考慮をしていないため、このような結果になった。</p>
<p>次に、これを修正した例を示す。</p>
<div class="sourceCode" id="cb707"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb707-1"><a href="#cb707-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/semantics_ut.cpp 90</span></span>
<span id="cb707-2"><a href="#cb707-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb707-3"><a href="#cb707-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">inline</span> <span class="dt">bool</span> <span class="kw">operator</span><span class="op">==(</span>A <span class="at">const</span><span class="op">&amp;</span> lhs<span class="op">,</span> A <span class="at">const</span><span class="op">&amp;</span> rhs<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb707-4"><a href="#cb707-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb707-5"><a href="#cb707-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> lhs<span class="op">.</span>GetNum<span class="op">()</span> <span class="op">==</span> rhs<span class="op">.</span>GetNum<span class="op">()</span></span>
<span id="cb707-6"><a href="#cb707-6" aria-hidden="true" tabindex="-1"></a>               <span class="op">&amp;&amp;</span> <span class="bu">std::</span>string_view<span class="op">{</span>lhs<span class="op">.</span>GetName<span class="op">()}</span> <span class="op">==</span> <span class="bu">std::</span>string_view<span class="op">{</span>rhs<span class="op">.</span>GetName<span class="op">()};</span></span>
<span id="cb707-7"><a href="#cb707-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>ポインタをメンバに持つクラスのoperator==については、上記したような処理が必要となる。</p>
<p>次に示す例は、基底クラスBaseとそのoperator==である。</p>
<div class="sourceCode" id="cb708"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb708-1"><a href="#cb708-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/semantics_ut.cpp 113</span></span>
<span id="cb708-2"><a href="#cb708-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb708-3"><a href="#cb708-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Base <span class="op">{</span></span>
<span id="cb708-4"><a href="#cb708-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb708-5"><a href="#cb708-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> Base<span class="op">(</span><span class="dt">int</span> b<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">:</span> <span class="va">b_</span><span class="op">{</span>b<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb708-6"><a href="#cb708-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="op">~</span>Base<span class="op">()</span> <span class="op">=</span> <span class="cf">default</span><span class="op">;</span></span>
<span id="cb708-7"><a href="#cb708-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> GetB<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">b_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb708-8"><a href="#cb708-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb708-9"><a href="#cb708-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb708-10"><a href="#cb708-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> <span class="va">b_</span><span class="op">;</span></span>
<span id="cb708-11"><a href="#cb708-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb708-12"><a href="#cb708-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb708-13"><a href="#cb708-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">inline</span> <span class="dt">bool</span> <span class="kw">operator</span><span class="op">==(</span>Base <span class="at">const</span><span class="op">&amp;</span> lhs<span class="op">,</span> Base <span class="at">const</span><span class="op">&amp;</span> rhs<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb708-14"><a href="#cb708-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb708-15"><a href="#cb708-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> lhs<span class="op">.</span>GetB<span class="op">()</span> <span class="op">==</span> rhs<span class="op">.</span>GetB<span class="op">();</span></span>
<span id="cb708-16"><a href="#cb708-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>次の単体テストが示す通り、これ自体には問題がないように見える。</p>
<div class="sourceCode" id="cb709"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb709-1"><a href="#cb709-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/semantics_ut.cpp 133</span></span>
<span id="cb709-2"><a href="#cb709-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb709-3"><a href="#cb709-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> b0 <span class="op">=</span> Base<span class="op">{</span><span class="dv">0</span><span class="op">};</span></span>
<span id="cb709-4"><a href="#cb709-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> b1 <span class="op">=</span> Base<span class="op">{</span><span class="dv">0</span><span class="op">};</span></span>
<span id="cb709-5"><a href="#cb709-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> b2 <span class="op">=</span> Base<span class="op">{</span><span class="dv">1</span><span class="op">};</span></span>
<span id="cb709-6"><a href="#cb709-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb709-7"><a href="#cb709-7" aria-hidden="true" tabindex="-1"></a>    ASSERT_TRUE<span class="op">(</span>b0 <span class="op">==</span> b0<span class="op">);</span></span>
<span id="cb709-8"><a href="#cb709-8" aria-hidden="true" tabindex="-1"></a>    ASSERT_TRUE<span class="op">(</span>b0 <span class="op">==</span> b1<span class="op">);</span></span>
<span id="cb709-9"><a href="#cb709-9" aria-hidden="true" tabindex="-1"></a>    ASSERT_FALSE<span class="op">(</span>b0 <span class="op">==</span> b2<span class="op">);</span></span></code></pre></div>
<p>しかし、Baseから派生したクラスDerivedを</p>
<div class="sourceCode" id="cb710"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb710-1"><a href="#cb710-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/semantics_ut.cpp 145</span></span>
<span id="cb710-2"><a href="#cb710-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb710-3"><a href="#cb710-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Derived <span class="op">:</span> <span class="kw">public</span> Base <span class="op">{</span></span>
<span id="cb710-4"><a href="#cb710-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb710-5"><a href="#cb710-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> Derived<span class="op">(</span><span class="dt">int</span> d<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">:</span> Base<span class="op">{</span><span class="dv">0</span><span class="op">},</span> <span class="va">d_</span><span class="op">{</span>d<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb710-6"><a href="#cb710-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> GetD<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">d_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb710-7"><a href="#cb710-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb710-8"><a href="#cb710-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb710-9"><a href="#cb710-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> <span class="va">d_</span><span class="op">;</span></span>
<span id="cb710-10"><a href="#cb710-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>のように定義すると、下記の単体テストで示す通り、等価性のセマンティクスが破壊される。</p>
<div class="sourceCode" id="cb711"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb711-1"><a href="#cb711-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/semantics_ut.cpp 159</span></span>
<span id="cb711-2"><a href="#cb711-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb711-3"><a href="#cb711-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb711-4"><a href="#cb711-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> b <span class="op">=</span> Base<span class="op">{</span><span class="dv">0</span><span class="op">};</span></span>
<span id="cb711-5"><a href="#cb711-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> d <span class="op">=</span> Derived<span class="op">{</span><span class="dv">1</span><span class="op">};</span></span>
<span id="cb711-6"><a href="#cb711-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb711-7"><a href="#cb711-7" aria-hidden="true" tabindex="-1"></a>        ASSERT_TRUE<span class="op">(</span>b <span class="op">==</span> d<span class="op">);</span>  <span class="co">// NG bとdは明らかに等価でない</span></span>
<span id="cb711-8"><a href="#cb711-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb711-9"><a href="#cb711-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb711-10"><a href="#cb711-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> d0 <span class="op">=</span> Derived<span class="op">{</span><span class="dv">0</span><span class="op">};</span></span>
<span id="cb711-11"><a href="#cb711-11" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> d1 <span class="op">=</span> Derived<span class="op">{</span><span class="dv">1</span><span class="op">};</span></span>
<span id="cb711-12"><a href="#cb711-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb711-13"><a href="#cb711-13" aria-hidden="true" tabindex="-1"></a>        ASSERT_TRUE<span class="op">(</span>d0 <span class="op">==</span> d1<span class="op">);</span>  <span class="co">// NG d0とd1は明らかに等価ではない</span></span>
<span id="cb711-14"><a href="#cb711-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>Derived用のoperator==を</p>
<div class="sourceCode" id="cb712"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb712-1"><a href="#cb712-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/semantics_ut.cpp 176</span></span>
<span id="cb712-2"><a href="#cb712-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb712-3"><a href="#cb712-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bool</span> <span class="kw">operator</span><span class="op">==(</span>Derived <span class="at">const</span><span class="op">&amp;</span> lhs<span class="op">,</span> Derived <span class="at">const</span><span class="op">&amp;</span> rhs<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb712-4"><a href="#cb712-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb712-5"><a href="#cb712-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> lhs<span class="op">.</span>GetB<span class="op">()</span> <span class="op">==</span> rhs<span class="op">.</span>GetB<span class="op">()</span> <span class="op">&amp;&amp;</span> lhs<span class="op">.</span>GetD<span class="op">()</span> <span class="op">==</span> rhs<span class="op">.</span>GetD<span class="op">();</span></span>
<span id="cb712-6"><a href="#cb712-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>と定義しても、下記に示す通り部分的な効果しかない。</p>
<div class="sourceCode" id="cb713"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb713-1"><a href="#cb713-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/semantics_ut.cpp 186</span></span>
<span id="cb713-2"><a href="#cb713-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb713-3"><a href="#cb713-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> d0 <span class="op">=</span> Derived<span class="op">{</span><span class="dv">0</span><span class="op">};</span></span>
<span id="cb713-4"><a href="#cb713-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> d1 <span class="op">=</span> Derived<span class="op">{</span><span class="dv">1</span><span class="op">};</span></span>
<span id="cb713-5"><a href="#cb713-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb713-6"><a href="#cb713-6" aria-hidden="true" tabindex="-1"></a>    ASSERT_FALSE<span class="op">(</span>d0 <span class="op">==</span> d1<span class="op">);</span>  <span class="co">// OK operator==(Derived const&amp;, Derived const&amp;)の効果で正しい判定</span></span>
<span id="cb713-7"><a href="#cb713-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb713-8"><a href="#cb713-8" aria-hidden="true" tabindex="-1"></a>    Base<span class="op">&amp;</span> d0_b_ref <span class="op">=</span> d0<span class="op">;</span></span>
<span id="cb713-9"><a href="#cb713-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb713-10"><a href="#cb713-10" aria-hidden="true" tabindex="-1"></a>    ASSERT_TRUE<span class="op">(</span>d0_b_ref <span class="op">==</span> d1<span class="op">);</span>  <span class="co">// NG d0_b_refの実態はd0なのでd1と等価でない</span></span></code></pre></div>
<p>この問題は、<a
href="#SS_5_10_15">RTTI</a>を使った下記のようなコードで対処できる。</p>
<div class="sourceCode" id="cb714"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb714-1"><a href="#cb714-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/semantics_ut.cpp 202</span></span>
<span id="cb714-2"><a href="#cb714-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb714-3"><a href="#cb714-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Base <span class="op">{</span></span>
<span id="cb714-4"><a href="#cb714-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb714-5"><a href="#cb714-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> Base<span class="op">(</span><span class="dt">int</span> b<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">:</span> <span class="va">b_</span><span class="op">{</span>b<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb714-6"><a href="#cb714-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="op">~</span>Base<span class="op">()</span> <span class="op">=</span> <span class="cf">default</span><span class="op">;</span></span>
<span id="cb714-7"><a href="#cb714-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> GetB<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">b_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb714-8"><a href="#cb714-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb714-9"><a href="#cb714-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">protected</span><span class="op">:</span></span>
<span id="cb714-10"><a href="#cb714-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">bool</span> is_equal<span class="op">(</span>Base <span class="at">const</span><span class="op">&amp;</span> rhs<span class="op">)</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">b_</span> <span class="op">==</span> rhs<span class="op">.</span><span class="va">b_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb714-11"><a href="#cb714-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb714-12"><a href="#cb714-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb714-13"><a href="#cb714-13" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> <span class="va">b_</span><span class="op">;</span></span>
<span id="cb714-14"><a href="#cb714-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb714-15"><a href="#cb714-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">friend</span> <span class="kw">inline</span> <span class="dt">bool</span> <span class="kw">operator</span><span class="op">==(</span>Base <span class="at">const</span><span class="op">&amp;</span> lhs<span class="op">,</span> Base <span class="at">const</span><span class="op">&amp;</span> rhs<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb714-16"><a href="#cb714-16" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb714-17"><a href="#cb714-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span><span class="kw">typeid</span><span class="op">(</span>lhs<span class="op">)</span> <span class="op">!=</span> <span class="kw">typeid</span><span class="op">(</span>rhs<span class="op">))</span> <span class="op">{</span></span>
<span id="cb714-18"><a href="#cb714-18" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb714-19"><a href="#cb714-19" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb714-20"><a href="#cb714-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb714-21"><a href="#cb714-21" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> lhs<span class="op">.</span>is_equal<span class="op">(</span>rhs<span class="op">);</span></span>
<span id="cb714-22"><a href="#cb714-22" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb714-23"><a href="#cb714-23" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb714-24"><a href="#cb714-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb714-25"><a href="#cb714-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Derived <span class="op">:</span> <span class="kw">public</span> Base <span class="op">{</span></span>
<span id="cb714-26"><a href="#cb714-26" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb714-27"><a href="#cb714-27" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> Derived<span class="op">(</span><span class="dt">int</span> d<span class="op">)</span> <span class="op">:</span> Base<span class="op">{</span><span class="dv">0</span><span class="op">},</span> <span class="va">d_</span><span class="op">{</span>d<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb714-28"><a href="#cb714-28" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> GetD<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">d_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb714-29"><a href="#cb714-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb714-30"><a href="#cb714-30" aria-hidden="true" tabindex="-1"></a>    <span class="kw">protected</span><span class="op">:</span></span>
<span id="cb714-31"><a href="#cb714-31" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">bool</span> is_equal<span class="op">(</span>Base <span class="at">const</span><span class="op">&amp;</span> rhs<span class="op">)</span> <span class="at">const</span> <span class="kw">noexcept</span></span>
<span id="cb714-32"><a href="#cb714-32" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb714-33"><a href="#cb714-33" aria-hidden="true" tabindex="-1"></a>            <span class="co">// operator==によりrhsの型はDerivedであるため、下記のキャストは安全</span></span>
<span id="cb714-34"><a href="#cb714-34" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> <span class="at">const</span><span class="op">&amp;</span> rhs_d <span class="op">=</span> <span class="kw">static_cast</span><span class="op">&lt;</span>Derived <span class="at">const</span><span class="op">&amp;&gt;(</span>rhs<span class="op">);</span></span>
<span id="cb714-35"><a href="#cb714-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb714-36"><a href="#cb714-36" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> Base<span class="op">::</span>is_equal<span class="op">(</span>rhs<span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="va">d_</span> <span class="op">==</span> rhs_d<span class="op">.</span><span class="va">d_</span><span class="op">;</span></span>
<span id="cb714-37"><a href="#cb714-37" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb714-38"><a href="#cb714-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb714-39"><a href="#cb714-39" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb714-40"><a href="#cb714-40" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> <span class="va">d_</span><span class="op">;</span></span>
<span id="cb714-41"><a href="#cb714-41" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>下記に示す通り、このコードは、 <a
href="#SS_1_2">オープン・クローズドの原則(OCP)</a>にも対応した柔軟な構造を実現している。</p>
<div class="sourceCode" id="cb715"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb715-1"><a href="#cb715-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/semantics_ut.cpp 269</span></span>
<span id="cb715-2"><a href="#cb715-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb715-3"><a href="#cb715-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> DerivedDerived <span class="op">:</span> <span class="kw">public</span> Derived <span class="op">{</span></span>
<span id="cb715-4"><a href="#cb715-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb715-5"><a href="#cb715-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> DerivedDerived<span class="op">(</span><span class="dt">int</span> dd<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">:</span> Derived<span class="op">{</span><span class="dv">0</span><span class="op">},</span> <span class="va">dd_</span><span class="op">{</span>dd<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb715-6"><a href="#cb715-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> GetDD<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">dd_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb715-7"><a href="#cb715-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb715-8"><a href="#cb715-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">protected</span><span class="op">:</span></span>
<span id="cb715-9"><a href="#cb715-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">bool</span> is_equal<span class="op">(</span>Base <span class="at">const</span><span class="op">&amp;</span> rhs<span class="op">)</span> <span class="at">const</span> <span class="kw">noexcept</span></span>
<span id="cb715-10"><a href="#cb715-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb715-11"><a href="#cb715-11" aria-hidden="true" tabindex="-1"></a>            <span class="co">// operator==によりrhsの型はDerivedDerivedであるため、下記のキャストは安全</span></span>
<span id="cb715-12"><a href="#cb715-12" aria-hidden="true" tabindex="-1"></a>            <span class="kw">auto</span> <span class="at">const</span><span class="op">&amp;</span> rhs_d <span class="op">=</span> <span class="kw">static_cast</span><span class="op">&lt;</span>DerivedDerived <span class="at">const</span><span class="op">&amp;&gt;(</span>rhs<span class="op">);</span></span>
<span id="cb715-13"><a href="#cb715-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb715-14"><a href="#cb715-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> Derived<span class="op">::</span>is_equal<span class="op">(</span>rhs<span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="va">dd_</span> <span class="op">==</span> rhs_d<span class="op">.</span><span class="va">dd_</span><span class="op">;</span></span>
<span id="cb715-15"><a href="#cb715-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb715-16"><a href="#cb715-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb715-17"><a href="#cb715-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb715-18"><a href="#cb715-18" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> <span class="va">dd_</span><span class="op">;</span></span>
<span id="cb715-19"><a href="#cb715-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>前例では「両辺の型が等しいこと」が「等価であること」の必要条件となるが、
この要件が、すべてのoperator==に求められるわけではない。</p>
<p>次に示すのは、一見すると両辺の型が違うにもかかわらず、
等価性のセマンティクスを満たしている例である。</p>
<div class="sourceCode" id="cb716"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb716-1"><a href="#cb716-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/semantics_ut.cpp 319</span></span>
<span id="cb716-2"><a href="#cb716-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb716-3"><a href="#cb716-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> abc <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{</span><span class="st">&quot;abc&quot;</span><span class="op">};</span></span>
<span id="cb716-4"><a href="#cb716-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb716-5"><a href="#cb716-5" aria-hidden="true" tabindex="-1"></a>    ASSERT_TRUE<span class="op">(</span><span class="st">&quot;abc&quot;</span> <span class="op">==</span> abc<span class="op">);</span></span>
<span id="cb716-6"><a href="#cb716-6" aria-hidden="true" tabindex="-1"></a>    ASSERT_TRUE<span class="op">(</span>abc <span class="op">==</span> <span class="st">&quot;abc&quot;</span><span class="op">);</span></span></code></pre></div>
<p>これは、文字列リテラルを第1引数に取るstd::stringのコンストラクタが非explicitであることによって、
文字列リテラルからstd::stringへの暗黙の型変換が起こるために成立する
(「<a
href="#SS_5_2_5">非explitなコンストラクタによる暗黙の型変換</a>」参照)。</p>
<p>以上で見てきたように、等価性のセマンティクスを守ったoperator==の実装には多くの観点が必要になる。</p>
<h3 id="copyセマンティクス">copyセマンティクス
<a id="SS_5_8_2"></a></h3>
<p>copyセマンティクスとは以下を満たすようなセマンティクスである。</p>
<ul>
<li>a = bが行われた後に、aとbが等価である。</li>
<li>a = bが行われた前後でbの値が変わっていない。</li>
</ul>
<p>従って、これらのオブジェクトに対して<a
href="#SS_5_8_1">等価性のセマンティクス</a>
を満たすoperator==が定義されている場合、
以下を満たすようなセマンティクスであると言い換えることができる。</p>
<ul>
<li>a = bが行われた後に、a == bがtrueになる。</li>
<li>b == b_preがtrueの時に、a = bが行われた後でもb ==
b_preがtrueとなる。</li>
</ul>
<p>下記に示す通り、std::stringはcopyセマンティクスを満たしている。</p>
<div class="sourceCode" id="cb717"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb717-1"><a href="#cb717-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/semantics_ut.cpp 333</span></span>
<span id="cb717-2"><a href="#cb717-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb717-3"><a href="#cb717-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> c_str <span class="op">=</span> <span class="st">&quot;string&quot;</span><span class="op">;</span></span>
<span id="cb717-4"><a href="#cb717-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> str   <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{};</span></span>
<span id="cb717-5"><a href="#cb717-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb717-6"><a href="#cb717-6" aria-hidden="true" tabindex="-1"></a>    str <span class="op">=</span> c_str<span class="op">;</span></span>
<span id="cb717-7"><a href="#cb717-7" aria-hidden="true" tabindex="-1"></a>    ASSERT_TRUE<span class="op">(</span>c_str <span class="op">==</span> str<span class="op">);</span>      <span class="co">// = 後には == が成立している</span></span>
<span id="cb717-8"><a href="#cb717-8" aria-hidden="true" tabindex="-1"></a>    ASSERT_STREQ<span class="op">(</span><span class="st">&quot;string&quot;</span><span class="op">,</span> c_str<span class="op">);</span>  <span class="co">// c_strの値は変わっていない</span></span></code></pre></div>
<p>一方で、std::auto_ptrはcopyセマンティクスを満たしていない。</p>
<div class="sourceCode" id="cb718"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb718-1"><a href="#cb718-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/semantics_ut.cpp 346</span></span>
<span id="cb718-2"><a href="#cb718-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb718-3"><a href="#cb718-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>auto_ptr<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;</span> str0<span class="op">{</span><span class="kw">new</span> <span class="bu">std::</span>string<span class="op">{</span><span class="st">&quot;string&quot;</span><span class="op">}};</span></span>
<span id="cb718-4"><a href="#cb718-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>auto_ptr<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;</span> str0_pre<span class="op">{</span><span class="kw">new</span> <span class="bu">std::</span>string<span class="op">{</span><span class="st">&quot;string&quot;</span><span class="op">}};</span></span>
<span id="cb718-5"><a href="#cb718-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb718-6"><a href="#cb718-6" aria-hidden="true" tabindex="-1"></a>    ASSERT_TRUE<span class="op">(*</span>str0 <span class="op">==</span> <span class="op">*</span>str0_pre<span class="op">);</span>  <span class="co">// 前提は成立</span></span>
<span id="cb718-7"><a href="#cb718-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb718-8"><a href="#cb718-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>auto_ptr<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;</span> str1<span class="op">;</span></span>
<span id="cb718-9"><a href="#cb718-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb718-10"><a href="#cb718-10" aria-hidden="true" tabindex="-1"></a>    str1 <span class="op">=</span> str0<span class="op">;</span></span>
<span id="cb718-11"><a href="#cb718-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb718-12"><a href="#cb718-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ASSERT_TRUE(*str0 == *str0_pre);  // これをするとクラッシュする</span></span>
<span id="cb718-13"><a href="#cb718-13" aria-hidden="true" tabindex="-1"></a>    ASSERT_TRUE<span class="op">(</span>str0<span class="op">.</span>get<span class="op">()</span> <span class="op">==</span> <span class="kw">nullptr</span><span class="op">);</span>  <span class="co">// str0の値がoperator ==で変わってしまった</span></span>
<span id="cb718-14"><a href="#cb718-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb718-15"><a href="#cb718-15" aria-hidden="true" tabindex="-1"></a>    ASSERT_TRUE<span class="op">(*</span>str1 <span class="op">==</span> <span class="op">*</span>str0_pre<span class="op">);</span>  <span class="co">// これは成立</span></span></code></pre></div>
<p>この仕様は極めて不自然であり、std::auto_ptrはC++11で非推奨となり、C++17で規格から排除された。</p>
<p>下記の単体テストから明らかな通り、 「<a
href="#SS_5_8_1">等価性のセマンティクス</a>」で示した最後の例も、copyセマンティクスを満たしていない。</p>
<div class="sourceCode" id="cb719"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb719-1"><a href="#cb719-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/semantics_ut.cpp 366</span></span>
<span id="cb719-2"><a href="#cb719-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb719-3"><a href="#cb719-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> b <span class="op">=</span> Base<span class="op">{</span><span class="dv">1</span><span class="op">};</span></span>
<span id="cb719-4"><a href="#cb719-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> d <span class="op">=</span> Derived<span class="op">{</span><span class="dv">1</span><span class="op">};</span></span>
<span id="cb719-5"><a href="#cb719-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb719-6"><a href="#cb719-6" aria-hidden="true" tabindex="-1"></a>    b <span class="op">=</span> d<span class="op">;</span>  <span class="co">// スライシングが起こる</span></span>
<span id="cb719-7"><a href="#cb719-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb719-8"><a href="#cb719-8" aria-hidden="true" tabindex="-1"></a>    ASSERT_FALSE<span class="op">(</span>b <span class="op">==</span> d<span class="op">);</span>  <span class="co">// copyセマンティクスを満たしていない</span></span></code></pre></div>
<p>原因は、copy代入で<a
href="#SS_5_3_3">スライシング</a>が起こるためである。</p>
<h3 id="moveセマンティクス">moveセマンティクス
<a id="SS_5_8_3"></a></h3>
<p>moveセマンティクスとは以下を満たすようなセマンティクスである(operator==が定義されていると前提)。</p>
<ul>
<li><p>copy代入の実行コスト &gt;= move代入の実行コスト</p></li>
<li><p>a == bがtrueの時に、c = std::move(a)が行われた場合、</p>
<ul>
<li>b == cがtrueになる。</li>
<li>a ==
cはtrueにならなくても良い(aはmove代入により破壊されるかもしれない)。</li>
</ul>
<p>必須ではないが、「aがポインタ等のリソースを保有している場合、move代入後には、
そのリソースはcに移動している」ことが一般的である(「<a
href="#SS_5_5_3">rvalue</a>」参照)。</p></li>
<li><p><a
href="#SS_5_7_1">no-fail保証</a>をする(noexceptと宣言し、エクセプションをthrowしない)。</p></li>
</ul>
<p>moveセマンティクスはcopy代入後に使用されなくなるオブジェクト(主にrvalue)
からのcopy代入の実行コストを下げるために導入されたため、
下記のようなコードは推奨されない。</p>
<div class="sourceCode" id="cb720"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb720-1"><a href="#cb720-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/semantics_ut.cpp 381</span></span>
<span id="cb720-2"><a href="#cb720-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb720-3"><a href="#cb720-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> NotRecommended <span class="op">{</span></span>
<span id="cb720-4"><a href="#cb720-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb720-5"><a href="#cb720-5" aria-hidden="true" tabindex="-1"></a>        NotRecommended<span class="op">(</span><span class="dt">char</span> <span class="at">const</span><span class="op">*</span> name<span class="op">)</span> <span class="op">:</span> <span class="va">name_</span><span class="op">{</span>name<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb720-6"><a href="#cb720-6" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span><span class="op">&amp;</span> Name<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">name_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb720-7"><a href="#cb720-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb720-8"><a href="#cb720-8" aria-hidden="true" tabindex="-1"></a>        NotRecommended<span class="op">&amp;</span> <span class="kw">operator</span><span class="op">=(</span>NotRecommended<span class="op">&amp;&amp;</span> rhs<span class="op">)</span>  <span class="co">// move代入、非no-fail保証</span></span>
<span id="cb720-9"><a href="#cb720-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb720-10"><a href="#cb720-10" aria-hidden="true" tabindex="-1"></a>            <span class="va">name_</span> <span class="op">=</span> rhs<span class="op">.</span><span class="va">name_</span><span class="op">;</span>  <span class="co">// rhs.name_からname_へのcopy代入。パフォーマンス問題になるかも。</span></span>
<span id="cb720-11"><a href="#cb720-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="op">*</span><span class="kw">this</span><span class="op">;</span></span>
<span id="cb720-12"><a href="#cb720-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb720-13"><a href="#cb720-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb720-14"><a href="#cb720-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb720-15"><a href="#cb720-15" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span><span class="va">name_</span><span class="op">;</span></span>
<span id="cb720-16"><a href="#cb720-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb720-17"><a href="#cb720-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb720-18"><a href="#cb720-18" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bool</span> <span class="kw">operator</span><span class="op">==(</span>NotRecommended <span class="at">const</span><span class="op">&amp;</span> lhs<span class="op">,</span> NotRecommended <span class="at">const</span><span class="op">&amp;</span> rhs<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb720-19"><a href="#cb720-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb720-20"><a href="#cb720-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> lhs<span class="op">.</span>Name<span class="op">()</span> <span class="op">==</span> rhs<span class="op">.</span>Name<span class="op">();</span></span>
<span id="cb720-21"><a href="#cb720-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb720-22"><a href="#cb720-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb720-23"><a href="#cb720-23" aria-hidden="true" tabindex="-1"></a>    TEST<span class="op">(</span>Semantics<span class="op">,</span> move1<span class="op">)</span></span>
<span id="cb720-24"><a href="#cb720-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb720-25"><a href="#cb720-25" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> a <span class="op">=</span> NotRecommended<span class="op">{</span><span class="st">&quot;a&quot;</span><span class="op">};</span></span>
<span id="cb720-26"><a href="#cb720-26" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> b <span class="op">=</span> NotRecommended<span class="op">{</span><span class="st">&quot;a&quot;</span><span class="op">};</span></span>
<span id="cb720-27"><a href="#cb720-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb720-28"><a href="#cb720-28" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;a&quot;</span><span class="op">,</span> a<span class="op">.</span>Name<span class="op">());</span></span>
<span id="cb720-29"><a href="#cb720-29" aria-hidden="true" tabindex="-1"></a>        ASSERT_TRUE<span class="op">(</span>a <span class="op">==</span> b<span class="op">);</span></span>
<span id="cb720-30"><a href="#cb720-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb720-31"><a href="#cb720-31" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> c <span class="op">=</span> NotRecommended<span class="op">{</span><span class="st">&quot;c&quot;</span><span class="op">};</span></span>
<span id="cb720-32"><a href="#cb720-32" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;c&quot;</span><span class="op">,</span> c<span class="op">.</span>Name<span class="op">());</span></span>
<span id="cb720-33"><a href="#cb720-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb720-34"><a href="#cb720-34" aria-hidden="true" tabindex="-1"></a>        c <span class="op">=</span> <span class="bu">std::</span>move<span class="op">(</span>a<span class="op">);</span></span>
<span id="cb720-35"><a href="#cb720-35" aria-hidden="true" tabindex="-1"></a>        ASSERT_TRUE<span class="op">(</span>b <span class="op">==</span> c<span class="op">);</span>  <span class="co">// 一応、moveセマンティクスは守っているが・・・</span></span>
<span id="cb720-36"><a href="#cb720-36" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>下記のコードのようにメンバの代入もできる限りmove代入を使うことで、
パフォーマンスの良い代入ができる。</p>
<div class="sourceCode" id="cb721"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb721-1"><a href="#cb721-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/semantics_ut.cpp 419</span></span>
<span id="cb721-2"><a href="#cb721-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb721-3"><a href="#cb721-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Recommended <span class="op">{</span></span>
<span id="cb721-4"><a href="#cb721-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb721-5"><a href="#cb721-5" aria-hidden="true" tabindex="-1"></a>        Recommended<span class="op">(</span><span class="dt">char</span> <span class="at">const</span><span class="op">*</span> name<span class="op">)</span> <span class="op">:</span> <span class="va">name_</span><span class="op">{</span>name<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb721-6"><a href="#cb721-6" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span><span class="op">&amp;</span> Name<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">name_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb721-7"><a href="#cb721-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb721-8"><a href="#cb721-8" aria-hidden="true" tabindex="-1"></a>        Recommended<span class="op">&amp;</span> <span class="kw">operator</span><span class="op">=(</span>Recommended<span class="op">&amp;&amp;</span> rhs<span class="op">)</span> <span class="kw">noexcept</span>  <span class="co">// move代入、no-fail保証</span></span>
<span id="cb721-9"><a href="#cb721-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb721-10"><a href="#cb721-10" aria-hidden="true" tabindex="-1"></a>            <span class="va">name_</span> <span class="op">=</span> <span class="bu">std::</span>move<span class="op">(</span>rhs<span class="op">.</span><span class="va">name_</span><span class="op">);</span>  <span class="co">// rhs.name_からname_へのmove代入</span></span>
<span id="cb721-11"><a href="#cb721-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="op">*</span><span class="kw">this</span><span class="op">;</span></span>
<span id="cb721-12"><a href="#cb721-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb721-13"><a href="#cb721-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb721-14"><a href="#cb721-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb721-15"><a href="#cb721-15" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span><span class="va">name_</span><span class="op">;</span></span>
<span id="cb721-16"><a href="#cb721-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb721-17"><a href="#cb721-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb721-18"><a href="#cb721-18" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bool</span> <span class="kw">operator</span><span class="op">==(</span>Recommended <span class="at">const</span><span class="op">&amp;</span> lhs<span class="op">,</span> Recommended <span class="at">const</span><span class="op">&amp;</span> rhs<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb721-19"><a href="#cb721-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb721-20"><a href="#cb721-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> lhs<span class="op">.</span>Name<span class="op">()</span> <span class="op">==</span> rhs<span class="op">.</span>Name<span class="op">();</span></span>
<span id="cb721-21"><a href="#cb721-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb721-22"><a href="#cb721-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb721-23"><a href="#cb721-23" aria-hidden="true" tabindex="-1"></a>    TEST<span class="op">(</span>Semantics<span class="op">,</span> move2<span class="op">)</span></span>
<span id="cb721-24"><a href="#cb721-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb721-25"><a href="#cb721-25" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> a <span class="op">=</span> Recommended<span class="op">{</span><span class="st">&quot;a&quot;</span><span class="op">};</span></span>
<span id="cb721-26"><a href="#cb721-26" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> b <span class="op">=</span> Recommended<span class="op">{</span><span class="st">&quot;a&quot;</span><span class="op">};</span></span>
<span id="cb721-27"><a href="#cb721-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb721-28"><a href="#cb721-28" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;a&quot;</span><span class="op">,</span> a<span class="op">.</span>Name<span class="op">());</span></span>
<span id="cb721-29"><a href="#cb721-29" aria-hidden="true" tabindex="-1"></a>        ASSERT_TRUE<span class="op">(</span>a <span class="op">==</span> b<span class="op">);</span></span>
<span id="cb721-30"><a href="#cb721-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb721-31"><a href="#cb721-31" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> c <span class="op">=</span> Recommended<span class="op">{</span><span class="st">&quot;c&quot;</span><span class="op">};</span></span>
<span id="cb721-32"><a href="#cb721-32" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;c&quot;</span><span class="op">,</span> c<span class="op">.</span>Name<span class="op">());</span></span>
<span id="cb721-33"><a href="#cb721-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb721-34"><a href="#cb721-34" aria-hidden="true" tabindex="-1"></a>        c <span class="op">=</span> <span class="bu">std::</span>move<span class="op">(</span>a<span class="op">);</span>     <span class="co">// これ以降aは使ってはならない</span></span>
<span id="cb721-35"><a href="#cb721-35" aria-hidden="true" tabindex="-1"></a>        ASSERT_TRUE<span class="op">(</span>b <span class="op">==</span> c<span class="op">);</span>  <span class="co">// moveセマンティクスを正しく守っている</span></span>
<span id="cb721-36"><a href="#cb721-36" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<h2 id="cコンパイラ">C++コンパイラ <a id="SS_5_9"></a></h2>
<p>本ドキュメントで使用するg++/clang++のバージョンは以下のとおりである。</p>
<h3 id="g">g++ <a id="SS_5_9_1"></a></h3>
<pre><code>    g++ (Ubuntu 11.3.0-1ubuntu1~22.04) 11.3.0
    Copyright (C) 2021 Free Software Foundation, Inc.
    This is free software; see the source for copying conditions.  There is NO
    warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</code></pre>
<h3 id="clang">clang++ <a id="SS_5_9_2"></a></h3>
<pre><code>    Ubuntu clang version 14.0.0-1ubuntu1
    Target: x86_64-pc-linux-gnu
    Thread model: posix
    InstalledDir: /usr/bin</code></pre>
<h2 id="cその他">C++その他 <a id="SS_5_10"></a></h2>
<h3
id="オーバーライドとオーバーロードの違い">オーバーライドとオーバーロードの違い
<a id="SS_5_10_1"></a></h3>
<p>下記例では、Base::g()がオーバーロードで、Derived::f()がオーバーライドである
(Derived::g()はオーバーロードでもオーバーライドでもない(「<a
href="#SS_5_4_8">name-hiding</a>」参照))。</p>
<div class="sourceCode" id="cb724"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb724-1"><a href="#cb724-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/override_overload_ut.cpp 5</span></span>
<span id="cb724-2"><a href="#cb724-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb724-3"><a href="#cb724-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Base <span class="op">{</span></span>
<span id="cb724-4"><a href="#cb724-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb724-5"><a href="#cb724-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="op">~</span>Base<span class="op">()</span> <span class="op">=</span> <span class="cf">default</span><span class="op">;</span></span>
<span id="cb724-6"><a href="#cb724-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="bu">std::</span>string<span class="op"> </span>f<span class="op">()</span> <span class="op">{</span> <span class="cf">return</span> <span class="st">&quot;Base::f&quot;</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb724-7"><a href="#cb724-7" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span>        g<span class="op">()</span> <span class="op">{</span> <span class="cf">return</span> <span class="st">&quot;Base::g&quot;</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb724-8"><a href="#cb724-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb724-9"><a href="#cb724-9" aria-hidden="true" tabindex="-1"></a>        <span class="co">// g()のオーバーロード</span></span>
<span id="cb724-10"><a href="#cb724-10" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span>g<span class="op">(</span><span class="dt">int</span><span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> <span class="st">&quot;Base::g(int)&quot;</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb724-11"><a href="#cb724-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb724-12"><a href="#cb724-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb724-13"><a href="#cb724-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Derived <span class="op">:</span> <span class="kw">public</span> Base <span class="op">{</span></span>
<span id="cb724-14"><a href="#cb724-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb724-15"><a href="#cb724-15" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Base::fのオーバーライド</span></span>
<span id="cb724-16"><a href="#cb724-16" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="bu">std::</span>string<span class="op"> </span>f<span class="op">()</span> <span class="kw">override</span> <span class="op">{</span> <span class="cf">return</span> <span class="st">&quot;Derived::f&quot;</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb724-17"><a href="#cb724-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb724-18"><a href="#cb724-18" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Base::gのname-hiding</span></span>
<span id="cb724-19"><a href="#cb724-19" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span>g<span class="op">()</span> <span class="op">{</span> <span class="cf">return</span> <span class="st">&quot;Derived::g&quot;</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb724-20"><a href="#cb724-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>下記図の通り、</p>
<ul>
<li>BaseのインスタンスはBase用のvtblへのポインタを内部に持ち、
そのvtblでBase::f()のアドレスを保持する。</li>
<li>DerivedのインスタンスはDerived用のvtblへのポインタを内部に持ち、
そのvtblでDerived::f()のアドレスを保持する。</li>
<li>Base::g()、Base::g(int)、
Derived::g()のアドレスはBaseやDerivedのインスタンスから辿ることはできない。</li>
</ul>
<p>
<img src="data:image/png;base64,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" />
</p>
<p>vtblとは仮想関数テーブルとも呼ばれる、仮想関数ポインタを保持するための上記のようなテーブルである
(「<a href="#SS_5_2_11">クラスのレイアウト</a>」参照)。</p>
<p>Base::f()、Derived::f()の呼び出し選択は、オブジェクトの表層の型ではなく、実際の型により決定される。
Base::g()、Derived::g()の呼び出し選択は、オブジェクトの表層の型により決定される。</p>
<div class="sourceCode" id="cb725"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb725-1"><a href="#cb725-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/override_overload_ut.cpp 29</span></span>
<span id="cb725-2"><a href="#cb725-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb725-3"><a href="#cb725-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span>  ret   <span class="op">=</span> <span class="bu">std::</span>string<span class="op">{};</span></span>
<span id="cb725-4"><a href="#cb725-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span>  b     <span class="op">=</span> Base<span class="op">{};</span></span>
<span id="cb725-5"><a href="#cb725-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span>  d     <span class="op">=</span> Derived<span class="op">{};</span></span>
<span id="cb725-6"><a href="#cb725-6" aria-hidden="true" tabindex="-1"></a>    Base<span class="op">&amp;</span> d_ref <span class="op">=</span> d<span class="op">;</span></span>
<span id="cb725-7"><a href="#cb725-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb725-8"><a href="#cb725-8" aria-hidden="true" tabindex="-1"></a>    ret <span class="op">=</span> b<span class="op">.</span>f<span class="op">();</span>  <span class="co">// Base::f()呼び出し</span></span>
<span id="cb725-9"><a href="#cb725-9" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;Base::f&quot;</span><span class="op">,</span> ret<span class="op">);</span></span>
<span id="cb725-10"><a href="#cb725-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb725-11"><a href="#cb725-11" aria-hidden="true" tabindex="-1"></a>    ret <span class="op">=</span> d<span class="op">.</span>f<span class="op">();</span>  <span class="co">// Derived::f()呼び出し</span></span>
<span id="cb725-12"><a href="#cb725-12" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;Derived::f&quot;</span><span class="op">,</span> ret<span class="op">);</span></span>
<span id="cb725-13"><a href="#cb725-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb725-14"><a href="#cb725-14" aria-hidden="true" tabindex="-1"></a>    ret <span class="op">=</span> b<span class="op">.</span>g<span class="op">();</span>  <span class="co">// Base::g()呼び出し</span></span>
<span id="cb725-15"><a href="#cb725-15" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;Base::g&quot;</span><span class="op">,</span> ret<span class="op">);</span></span>
<span id="cb725-16"><a href="#cb725-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb725-17"><a href="#cb725-17" aria-hidden="true" tabindex="-1"></a>    ret <span class="op">=</span> d<span class="op">.</span>g<span class="op">();</span>  <span class="co">// Derived::g()呼び出し</span></span>
<span id="cb725-18"><a href="#cb725-18" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;Derived::g&quot;</span><span class="op">,</span> ret<span class="op">);</span></span>
<span id="cb725-19"><a href="#cb725-19" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ret = d.g(int{});   // Derived::gによって、Base::gが隠されるのでコンパイルエラー</span></span>
<span id="cb725-20"><a href="#cb725-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb725-21"><a href="#cb725-21" aria-hidden="true" tabindex="-1"></a>    ret <span class="op">=</span> d_ref<span class="op">.</span>f<span class="op">();</span>  <span class="co">// Base::fはDerived::fによってオーバーライドされたので、Derived::f()呼び出し</span></span>
<span id="cb725-22"><a href="#cb725-22" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;Derived::f&quot;</span><span class="op">,</span> ret<span class="op">);</span></span>
<span id="cb725-23"><a href="#cb725-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb725-24"><a href="#cb725-24" aria-hidden="true" tabindex="-1"></a>    ret <span class="op">=</span> d_ref<span class="op">.</span>g<span class="op">();</span>  <span class="co">// d_refの表層型はBaseなので、Base::g()呼び出し</span></span>
<span id="cb725-25"><a href="#cb725-25" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;Base::g&quot;</span><span class="op">,</span> ret<span class="op">);</span></span>
<span id="cb725-26"><a href="#cb725-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb725-27"><a href="#cb725-27" aria-hidden="true" tabindex="-1"></a>    ret <span class="op">=</span> d_ref<span class="op">.</span>g<span class="op">(</span><span class="dt">int</span><span class="op">{});</span>  <span class="co">// d_refの表層型はBaseなので、Base::g(int)呼び出し</span></span>
<span id="cb725-28"><a href="#cb725-28" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;Base::g(int)&quot;</span><span class="op">,</span> ret<span class="op">);</span></span></code></pre></div>
<p>上記のメンバ関数呼び出し</p>
<div class="sourceCode" id="cb726"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb726-1"><a href="#cb726-1" aria-hidden="true" tabindex="-1"></a>    d_ref<span class="op">.</span>f<span class="op">()</span> </span></code></pre></div>
<p>がどのように解釈され、Derived::f()が選択されるかを以下に疑似コードで例示する。</p>
<div class="sourceCode" id="cb727"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb727-1"><a href="#cb727-1" aria-hidden="true" tabindex="-1"></a>    vtbl <span class="op">=</span> d_ref<span class="op">.</span>vtbl             <span class="co">// d_refの実態はDerivedなのでvtblはDerivedのvtbl</span></span>
<span id="cb727-2"><a href="#cb727-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb727-3"><a href="#cb727-3" aria-hidden="true" tabindex="-1"></a>    member_func <span class="op">=</span> vtbl<span class="op">-&gt;</span>f         <span class="co">// vtbl-&gt;fはDerived::f()のアドレス</span></span>
<span id="cb727-4"><a href="#cb727-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb727-5"><a href="#cb727-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">(</span>d_ref<span class="op">.*</span>member_func<span class="op">)(&amp;</span>d_ref<span class="op">)</span>  <span class="co">// member_func()の呼び出し</span></span></code></pre></div>
<p>このようなメカニズムにより仮想関数呼び出しが行われる。</p>
<h3 id="実引数仮引数">実引数/仮引数 <a id="SS_5_10_2"></a></h3>
<p>引数(もしくは実引数、argument)、仮引数(parameter)とは下記のように定義される。</p>
<div class="sourceCode" id="cb728"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb728-1"><a href="#cb728-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/argument.cpp 2</span></span>
<span id="cb728-2"><a href="#cb728-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb728-3"><a href="#cb728-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> f0<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span><span class="op">&amp;</span> b<span class="op">)</span> <span class="kw">noexcept</span>  <span class="co">// a, bは仮引数</span></span>
<span id="cb728-4"><a href="#cb728-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb728-5"><a href="#cb728-5" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb728-6"><a href="#cb728-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb728-7"><a href="#cb728-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb728-8"><a href="#cb728-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> f1<span class="op">()</span> <span class="kw">noexcept</span></span>
<span id="cb728-9"><a href="#cb728-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb728-10"><a href="#cb728-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb728-11"><a href="#cb728-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb728-12"><a href="#cb728-12" aria-hidden="true" tabindex="-1"></a>        f0<span class="op">(</span>x<span class="op">,</span> y<span class="op">);</span>  <span class="co">// x, yは実引数</span></span>
<span id="cb728-13"><a href="#cb728-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<h3 id="範囲for文">範囲for文 <a id="SS_5_10_3"></a></h3>
<p>範囲for文は下記例のコメントで示されたようなfor文であり、
begin()、end()によって表される範囲内のすべての要素に対して付属するブロックの処理を行う。</p>
<div class="sourceCode" id="cb729"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb729-1"><a href="#cb729-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/range_for_ut.cpp 9</span></span>
<span id="cb729-2"><a href="#cb729-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb729-3"><a href="#cb729-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> list <span class="op">=</span> <span class="bu">std::</span>list<span class="op">{</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">};</span></span>
<span id="cb729-4"><a href="#cb729-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb729-5"><a href="#cb729-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> <span class="at">const</span> a <span class="op">:</span> list<span class="op">)</span> <span class="op">{</span>  <span class="co">// 範囲for文</span></span>
<span id="cb729-6"><a href="#cb729-6" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>cout<span class="op"> &lt;&lt;</span> a <span class="op">&lt;&lt;</span> <span class="bu">std::</span>endl<span class="op">;</span></span>
<span id="cb729-7"><a href="#cb729-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb729-8"><a href="#cb729-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb729-9"><a href="#cb729-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 上記for文は下記for文のシンタックスシュガー</span></span>
<span id="cb729-10"><a href="#cb729-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="bu">std::</span>list<span class="op">&lt;</span><span class="dt">int32_t</span><span class="op">&gt;::</span>iterator it <span class="op">=</span> <span class="bu">std::</span>begin<span class="op">(</span>list<span class="op">);</span> it <span class="op">!=</span> <span class="bu">std::</span>end<span class="op">(</span>list<span class="op">);</span> <span class="op">++</span>it<span class="op">)</span> <span class="op">{</span></span>
<span id="cb729-11"><a href="#cb729-11" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>cout<span class="op"> &lt;&lt;</span> <span class="op">*</span>it <span class="op">&lt;&lt;</span> <span class="bu">std::</span>endl<span class="op">;</span></span>
<span id="cb729-12"><a href="#cb729-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb730"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb730-1"><a href="#cb730-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/range_for_ut.cpp 25</span></span>
<span id="cb730-2"><a href="#cb730-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb730-3"><a href="#cb730-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int32_t</span> array<span class="op">[</span><span class="dv">3</span><span class="op">]{</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">};</span></span>
<span id="cb730-4"><a href="#cb730-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb730-5"><a href="#cb730-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> <span class="at">const</span> a <span class="op">:</span> array<span class="op">)</span> <span class="op">{</span>  <span class="co">// 範囲for文</span></span>
<span id="cb730-6"><a href="#cb730-6" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>cout<span class="op"> &lt;&lt;</span> a <span class="op">&lt;&lt;</span> <span class="bu">std::</span>endl<span class="op">;</span></span>
<span id="cb730-7"><a href="#cb730-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb730-8"><a href="#cb730-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb730-9"><a href="#cb730-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 上記for文は下記for文のシンタックスシュガー</span></span>
<span id="cb730-10"><a href="#cb730-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int32_t</span><span class="op">*</span> it <span class="op">=</span> <span class="bu">std::</span>begin<span class="op">(</span>array<span class="op">);</span> it <span class="op">!=</span> <span class="bu">std::</span>end<span class="op">(</span>array<span class="op">);</span> <span class="op">++</span>it<span class="op">)</span> <span class="op">{</span></span>
<span id="cb730-11"><a href="#cb730-11" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>cout<span class="op"> &lt;&lt;</span> <span class="op">*</span>it <span class="op">&lt;&lt;</span> <span class="bu">std::</span>endl<span class="op">;</span></span>
<span id="cb730-12"><a href="#cb730-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<h3 id="ラムダ式">ラムダ式 <a id="SS_5_10_4"></a></h3>
<p>ラムダ式に関する言葉の定義と例を示す。</p>
<ul>
<li>ラムダ式とは、その場で関数オブジェクトを定義する式。</li>
<li>クロージャ(オブジェクト)とは、ラムダ式から生成された関数オブジェクト。</li>
<li>クロージャ型とは、クロージャオブジェクトの型。</li>
<li>キャプチャとは、ラムダ式外部の変数をラムダ式内にコピーかリファレンスとして定義する機能。</li>
<li>ラムダ式からキャプチャできるのは、ラムダ式から可視である自動変数と仮引数(thisを含む)。</li>
<li><a
href="#SS_5_10_5">ジェネリックラムダ</a>とは、C++11のラムダ式を拡張して、
パラメータにautoを使用(型推測)できるようにした機能。</li>
</ul>
<div class="sourceCode" id="cb731"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb731-1"><a href="#cb731-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/lambda.cpp 10</span></span>
<span id="cb731-2"><a href="#cb731-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb731-3"><a href="#cb731-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> a <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb731-4"><a href="#cb731-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb731-5"><a href="#cb731-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// closureがクロージャ。それを初期化する式がラムダ式</span></span>
<span id="cb731-6"><a href="#cb731-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">// [a = a]がキャプチャ</span></span>
<span id="cb731-7"><a href="#cb731-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">// [a = a]内の右辺aは上記で定義されたa</span></span>
<span id="cb731-8"><a href="#cb731-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">// [a = a]内の左辺aは右辺aで初期化された変数。ラムダ式内で使用されるaは左辺a。</span></span>
<span id="cb731-9"><a href="#cb731-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> closure <span class="op">=</span> <span class="op">[</span>a <span class="op">=</span> a<span class="op">](</span><span class="dt">int32_t</span> b<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> a <span class="op">+</span> b<span class="op">;</span> <span class="op">};</span></span>
<span id="cb731-10"><a href="#cb731-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb731-11"><a href="#cb731-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> ret <span class="op">=</span> closure<span class="op">(</span><span class="dv">3</span><span class="op">);</span>  <span class="co">// クロージャの実行</span></span>
<span id="cb731-12"><a href="#cb731-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb731-13"><a href="#cb731-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">// g_closureはジェネリックラムダ</span></span>
<span id="cb731-14"><a href="#cb731-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> <span class="va">g_closure</span> <span class="op">=</span> <span class="op">[](</span><span class="kw">auto</span> t0<span class="op">,</span> <span class="kw">auto</span> t1<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> t0 <span class="op">+</span> t1<span class="op">;</span> <span class="op">};</span></span>
<span id="cb731-15"><a href="#cb731-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb731-16"><a href="#cb731-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> i <span class="op">=</span> <span class="va">g_closure</span><span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">);</span>                                <span class="co">// t0、t1はint</span></span>
<span id="cb731-17"><a href="#cb731-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> s <span class="op">=</span> <span class="va">g_closure</span><span class="op">(</span><span class="bu">std::</span>string<span class="op">{</span><span class="st">&quot;1&quot;</span><span class="op">},</span> <span class="bu">std::</span>string<span class="op">{</span><span class="st">&quot;2&quot;</span><span class="op">});</span>  <span class="co">// t0、t1はstd::string</span></span></code></pre></div>
<h3 id="ジェネリックラムダ-1">ジェネリックラムダ
<a id="SS_5_10_5"></a></h3>
<p>ジェネリックラムダとは、C++11のラムダ式のパラメータの型にautoを指定できるようにした機能で、
C++14で導入された。</p>
<p>この機能により関数の中で関数テンプレートと同等のものが定義できるようになった。</p>
<p>ジェネリックラムダで定義されたクロージャは、通常のラムダと同様にオブジェクトであるため、
下記のように使用することもできる便利な記法である。</p>
<div class="sourceCode" id="cb732"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb732-1"><a href="#cb732-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/generic_lambda_ut.cpp 4</span></span>
<span id="cb732-2"><a href="#cb732-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb732-3"><a href="#cb732-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> PUTTO<span class="op">&gt;</span></span>
<span id="cb732-4"><a href="#cb732-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> f<span class="op">(</span>PUTTO<span class="op">&amp;&amp;</span> p<span class="op">)</span></span>
<span id="cb732-5"><a href="#cb732-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb732-6"><a href="#cb732-6" aria-hidden="true" tabindex="-1"></a>        p<span class="op">(</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb732-7"><a href="#cb732-7" aria-hidden="true" tabindex="-1"></a>        p<span class="op">(</span><span class="fl">2.71</span><span class="op">);</span></span>
<span id="cb732-8"><a href="#cb732-8" aria-hidden="true" tabindex="-1"></a>        p<span class="op">(</span><span class="st">&quot;str&quot;</span><span class="op">);</span></span>
<span id="cb732-9"><a href="#cb732-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb732-10"><a href="#cb732-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb732-11"><a href="#cb732-11" aria-hidden="true" tabindex="-1"></a>    TEST<span class="op">(</span>Template<span class="op">,</span> generic_lambda<span class="op">)</span></span>
<span id="cb732-12"><a href="#cb732-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb732-13"><a href="#cb732-13" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>ostringstream<span class="op"> </span>oss<span class="op">;</span></span>
<span id="cb732-14"><a href="#cb732-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb732-15"><a href="#cb732-15" aria-hidden="true" tabindex="-1"></a>        f<span class="op">([&amp;</span>oss<span class="op">](</span><span class="kw">auto</span> <span class="at">const</span><span class="op">&amp;</span> elem<span class="op">)</span> <span class="op">{</span> oss <span class="op">&lt;&lt;</span> elem <span class="op">&lt;&lt;</span> <span class="bu">std::</span>endl<span class="op">;</span> <span class="op">});</span></span>
<span id="cb732-16"><a href="#cb732-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb732-17"><a href="#cb732-17" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;1</span><span class="sc">\n</span><span class="st">2.71</span><span class="sc">\n</span><span class="st">str</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">,</span> oss<span class="op">.</span>str<span class="op">());</span></span>
<span id="cb732-18"><a href="#cb732-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>なお、上記のジェネリックラムダは下記クラスのインスタンスの動きと同じである。</p>
<div class="sourceCode" id="cb733"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb733-1"><a href="#cb733-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/generic_lambda_ut.cpp 23</span></span>
<span id="cb733-2"><a href="#cb733-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb733-3"><a href="#cb733-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Closure <span class="op">{</span></span>
<span id="cb733-4"><a href="#cb733-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb733-5"><a href="#cb733-5" aria-hidden="true" tabindex="-1"></a>        Closure<span class="op">(</span><span class="bu">std::</span>ostream<span class="op">&amp;</span> os<span class="op">)</span> <span class="op">:</span> <span class="va">os_</span><span class="op">(</span>os<span class="op">)</span> <span class="op">{}</span></span>
<span id="cb733-6"><a href="#cb733-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb733-7"><a href="#cb733-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb733-8"><a href="#cb733-8" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> <span class="kw">operator</span><span class="op">()(</span>T<span class="op">&amp;&amp;</span> t<span class="op">)</span></span>
<span id="cb733-9"><a href="#cb733-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb733-10"><a href="#cb733-10" aria-hidden="true" tabindex="-1"></a>            <span class="va">os_</span> <span class="op">&lt;&lt;</span> t <span class="op">&lt;&lt;</span> <span class="bu">std::</span>endl<span class="op">;</span></span>
<span id="cb733-11"><a href="#cb733-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb733-12"><a href="#cb733-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb733-13"><a href="#cb733-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb733-14"><a href="#cb733-14" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>ostream<span class="op">&amp;</span> <span class="va">os_</span><span class="op">;</span></span>
<span id="cb733-15"><a href="#cb733-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb733-16"><a href="#cb733-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb733-17"><a href="#cb733-17" aria-hidden="true" tabindex="-1"></a>    TEST<span class="op">(</span>Template<span class="op">,</span> generic_lambda_like<span class="op">)</span></span>
<span id="cb733-18"><a href="#cb733-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb733-19"><a href="#cb733-19" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>ostringstream<span class="op"> </span>oss<span class="op">;</span></span>
<span id="cb733-20"><a href="#cb733-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb733-21"><a href="#cb733-21" aria-hidden="true" tabindex="-1"></a>        Closure closure<span class="op">(</span>oss<span class="op">);</span></span>
<span id="cb733-22"><a href="#cb733-22" aria-hidden="true" tabindex="-1"></a>        f<span class="op">(</span>closure<span class="op">);</span></span>
<span id="cb733-23"><a href="#cb733-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb733-24"><a href="#cb733-24" aria-hidden="true" tabindex="-1"></a>        ASSERT_EQ<span class="op">(</span><span class="st">&quot;1</span><span class="sc">\n</span><span class="st">2.71</span><span class="sc">\n</span><span class="st">str</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">,</span> oss<span class="op">.</span>str<span class="op">());</span></span>
<span id="cb733-25"><a href="#cb733-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<h3 id="関数tryブロック">関数tryブロック <a id="SS_5_10_6"></a></h3>
<p>関数tryブロックとはtry-catchを本体とした下記のような関数のブロックを指す。</p>
<div class="sourceCode" id="cb734"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb734-1"><a href="#cb734-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/func_try_block.cpp 8</span></span>
<span id="cb734-2"><a href="#cb734-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb734-3"><a href="#cb734-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> function_try_block<span class="op">()</span></span>
<span id="cb734-4"><a href="#cb734-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span> <span class="op">{</span>  <span class="co">// 関数tryブロック</span></span>
<span id="cb734-5"><a href="#cb734-5" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 何らかの処理</span></span>
<span id="cb734-6"><a href="#cb734-6" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb734-7"><a href="#cb734-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb734-8"><a href="#cb734-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">catch</span> <span class="op">(</span><span class="bu">std::</span>length_error<span class="op"> </span><span class="at">const</span><span class="op">&amp;</span> e<span class="op">)</span> <span class="op">{</span>  <span class="co">// 関数tryブロックのエクセプションハンドラ</span></span>
<span id="cb734-9"><a href="#cb734-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb734-10"><a href="#cb734-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb734-11"><a href="#cb734-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">catch</span> <span class="op">(</span><span class="bu">std::</span>logic_error<span class="op"> </span><span class="at">const</span><span class="op">&amp;</span> e<span class="op">)</span> <span class="op">{</span>  <span class="co">// 関数tryブロックのエクセプションハンドラ</span></span>
<span id="cb734-12"><a href="#cb734-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb734-13"><a href="#cb734-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<h3 id="単純代入">単純代入 <a id="SS_5_10_7"></a></h3>
<p>代入は下記のように分類される。</p>
<ul>
<li>単純代入(=)</li>
<li>複合代入(+=，++ 等)</li>
</ul>
<h3 id="ill-formed">ill-formed <a id="SS_5_10_8"></a></h3>
<p><a
href="https://cpprefjp.github.io/implementation-compliance.html">標準規格と処理系</a>に詳しい解説があるが、</p>
<ul>
<li>well-formed(適格)とはプログラムが全ての構文規則・診断対象の意味規則・
単一定義規則を満たすことである。</li>
<li>ill-formed(不適格)とはプログラムが適格でないことである。</li>
</ul>
<p>プログラムがwell-formedになった場合、そのプログラムはコンパイルできる。
プログラムがill-formedになった場合、通常はコンパイルエラーになるが、
対象がテンプレートの場合、事情は少々異なり、<a
href="#SS_5_4_7">SFINAE</a>によりコンパイルできることもある。</p>
<h3 id="well-formed">well-formed <a id="SS_5_10_9"></a></h3>
<p>「<a href="#SS_5_10_8">ill-formed</a>」を参照せよ。</p>
<h3 id="one-definition-rule">one-definition rule
<a id="SS_5_10_10"></a></h3>
<p>「<a href="#SS_5_10_11">ODR</a>」を参照せよ。</p>
<h3 id="odr">ODR <a id="SS_5_10_11"></a></h3>
<p>ODRとは、One Definition
Ruleの略語であり、下記のようなことを定めている。</p>
<ul>
<li>どの翻訳単位でも、テンプレート、型、関数、またはオブジェクトは、複数の定義を持つことができない。</li>
<li>プログラム全体で、オブジェクトまたは非インライン関数は複数の定義を持つことはできない。</li>
<li>型、テンプレート、外部インライン関数等、いくつかのものは複数の翻訳単位で定義することができる。</li>
</ul>
<p>より詳しい内容がが知りたい場合は、 <a
href="https://en.cppreference.com/w/cpp/language/definition">https://en.cppreference.com/w/cpp/language/definition</a>
が参考になる。</p>
<h3 id="rvoreturn-value-optimization">RVO(Return Value Optimization)
<a id="SS_5_10_12"></a></h3>
<p>関数の戻り値がオブジェクトである場合、
戻り値オブジェクトは、その関数の呼び出し元のオブジェクトにコピーされた後、すぐに破棄される。
この「オブジェクトをコピーして、その後すぐにそのオブジェクトを破棄する」動作は、
「関数の戻り値オブジェクトをそのままその関数の呼び出し元で使用する」ことで効率的になる。
RVOとはこのような最適化を指す。</p>
<p>なお、このような最適化は、 <a
href="https://cpprefjp.github.io/lang/cpp17/guaranteed_copy_elision.html">C++17から規格化</a>された。</p>
<h3 id="ssosmall-string-optimization">SSO(Small String Optimization)
<a id="SS_5_10_13"></a></h3>
<p>一般にstd::stringで文字列を保持する場合、newしたメモリが使用される。
64ビット環境であれば、newしたメモリのアドレスを保持する領域は8バイトになる。
std::stringで保持する文字列が終端の’\0’も含め8バイト以下である場合、
アドレスを保持する領域をその文字列の格納に使用すれば、newする必要がない(当然deleteも不要)。
こうすることで、短い文字列を保持するstd::stringオブジェクトは効率的に動作できる。</p>
<p>SOOとはこのような最適化を指す。</p>
<h3 id="most-vexing-parse">Most Vexing Parse
<a id="SS_5_10_14"></a></h3>
<p>Most Vexing
Parse(最も困惑させる構文解析)とは、C++の文法に関連する問題で、 Scott
Meyersが彼の著書”Effective
STL”の中でこの現象に名前をつけたことに由来する。</p>
<p>この問題はC++の文法が関数の宣言と変数の定義とを曖昧に扱うことによって生じる。
特にオブジェクトの初期化の文脈で発生し、意図に反して、その行は関数宣言になってしまう。</p>
<div class="sourceCode" id="cb735"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb735-1"><a href="#cb735-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/most_vexing_parse_ut.cpp 6</span></span>
<span id="cb735-2"><a href="#cb735-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb735-3"><a href="#cb735-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Vexing <span class="op">{</span></span>
<span id="cb735-4"><a href="#cb735-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb735-5"><a href="#cb735-5" aria-hidden="true" tabindex="-1"></a>        Vexing<span class="op">(</span><span class="dt">int</span><span class="op">)</span> <span class="op">{}</span></span>
<span id="cb735-6"><a href="#cb735-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb735-7"><a href="#cb735-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb735-8"><a href="#cb735-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/most_vexing_parse_ut.cpp 19</span></span>
<span id="cb735-9"><a href="#cb735-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb735-10"><a href="#cb735-10" aria-hidden="true" tabindex="-1"></a>    Vexing obj1<span class="op">();</span>        <span class="co">// はローカルオブジェクトobj1の宣言ではない</span></span>
<span id="cb735-11"><a href="#cb735-11" aria-hidden="true" tabindex="-1"></a>    Vexing obj2<span class="op">(</span>Vexing<span class="op">);</span>  <span class="co">// ローカルオブジェクトobj2の宣言ではない</span></span>
<span id="cb735-12"><a href="#cb735-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb735-13"><a href="#cb735-13" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;Vexing ()&quot;</span><span class="op">,</span> Nstd<span class="op">::</span>Type2Str<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span>obj1<span class="op">)&gt;());</span></span>
<span id="cb735-14"><a href="#cb735-14" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;Vexing (Vexing)&quot;</span><span class="op">,</span> Nstd<span class="op">::</span>Type2Str<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span>obj2<span class="op">)&gt;());</span></span>
<span id="cb735-15"><a href="#cb735-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 上記単体テストが示すように、</span></span>
<span id="cb735-16"><a href="#cb735-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">// * obj1はVexingを返す関数</span></span>
<span id="cb735-17"><a href="#cb735-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">// * obj2はVexingを引数に取りVexingを返す関数</span></span>
<span id="cb735-18"><a href="#cb735-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">// となる。</span></span></code></pre></div>
<p><a
href="#SS_5_2_2">初期化子リストコンストラクタ</a>の呼び出しでオブジェクトの初期化を行うことで、
このような問題を回避できる。</p>
<h3 id="rtti">RTTI <a id="SS_5_10_15"></a></h3>
<p>RTTI(Run-time Type
Information)とは、プログラム実行中のオブジェクトの型を導出するための機能であり、
具体的には下記の3つの要素を指す。</p>
<ul>
<li>dynamic_cast</li>
<li>typeid</li>
<li>std::type_info</li>
</ul>
<p>下記のようなポリモーフィックな(virtual関数を持った)クラスに対しては、</p>
<div class="sourceCode" id="cb736"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb736-1"><a href="#cb736-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/rtti_ut.cpp 7</span></span>
<span id="cb736-2"><a href="#cb736-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb736-3"><a href="#cb736-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Polymorphic_Base <span class="op">{</span>  <span class="co">// ポリモーフィックな基底クラス</span></span>
<span id="cb736-4"><a href="#cb736-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb736-5"><a href="#cb736-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="op">~</span>Polymorphic_Base<span class="op">()</span> <span class="op">=</span> <span class="cf">default</span><span class="op">;</span></span>
<span id="cb736-6"><a href="#cb736-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb736-7"><a href="#cb736-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb736-8"><a href="#cb736-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Polymorphic_Derived <span class="op">:</span> <span class="kw">public</span> Polymorphic_Base <span class="op">{</span>  <span class="co">// ポリモーフィックな派生クラス</span></span>
<span id="cb736-9"><a href="#cb736-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>dynamic_cast、typeidやその戻り値であるstd::type_infoは、下記のように振舞う。</p>
<div class="sourceCode" id="cb737"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb737-1"><a href="#cb737-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/rtti_ut.cpp 21</span></span>
<span id="cb737-2"><a href="#cb737-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb737-3"><a href="#cb737-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> b <span class="op">=</span> Polymorphic_Base<span class="op">{};</span></span>
<span id="cb737-4"><a href="#cb737-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> d <span class="op">=</span> Polymorphic_Derived<span class="op">{};</span></span>
<span id="cb737-5"><a href="#cb737-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb737-6"><a href="#cb737-6" aria-hidden="true" tabindex="-1"></a>    Polymorphic_Base<span class="op">&amp;</span> b_ref_d <span class="op">=</span> d<span class="op">;</span></span>
<span id="cb737-7"><a href="#cb737-7" aria-hidden="true" tabindex="-1"></a>    Polymorphic_Base<span class="op">&amp;</span> b_ref_b <span class="op">=</span> b<span class="op">;</span></span>
<span id="cb737-8"><a href="#cb737-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb737-9"><a href="#cb737-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">// std::type_infoの比較</span></span>
<span id="cb737-10"><a href="#cb737-10" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="kw">typeid</span><span class="op">(</span>b_ref_d<span class="op">),</span> <span class="kw">typeid</span><span class="op">(</span>d<span class="op">));</span></span>
<span id="cb737-11"><a href="#cb737-11" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="kw">typeid</span><span class="op">(</span>b_ref_b<span class="op">),</span> <span class="kw">typeid</span><span class="op">(</span>b<span class="op">));</span></span>
<span id="cb737-12"><a href="#cb737-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb737-13"><a href="#cb737-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ポインタへのdynamic_cast</span></span>
<span id="cb737-14"><a href="#cb737-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span><span class="op">*</span> d_ptr <span class="op">=</span> <span class="kw">dynamic_cast</span><span class="op">&lt;</span>Polymorphic_Derived<span class="op">*&gt;(&amp;</span>b_ref_d<span class="op">);</span></span>
<span id="cb737-15"><a href="#cb737-15" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>d_ptr<span class="op">,</span> <span class="op">&amp;</span>d<span class="op">);</span></span>
<span id="cb737-16"><a href="#cb737-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb737-17"><a href="#cb737-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span><span class="op">*</span> d_ptr2 <span class="op">=</span> <span class="kw">dynamic_cast</span><span class="op">&lt;</span>Polymorphic_Derived<span class="op">*&gt;(&amp;</span>b_ref_b<span class="op">);</span></span>
<span id="cb737-18"><a href="#cb737-18" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>d_ptr2<span class="op">,</span> <span class="kw">nullptr</span><span class="op">);</span>  <span class="co">// キャストできない場合、nullptrが返る</span></span>
<span id="cb737-19"><a href="#cb737-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb737-20"><a href="#cb737-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">// リファレンスへのdynamic_cast</span></span>
<span id="cb737-21"><a href="#cb737-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span><span class="op">&amp;</span> d_ref <span class="op">=</span> <span class="kw">dynamic_cast</span><span class="op">&lt;</span>Polymorphic_Derived<span class="op">&amp;&gt;(</span>b_ref_d<span class="op">);</span></span>
<span id="cb737-22"><a href="#cb737-22" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(&amp;</span>d_ref<span class="op">,</span> <span class="op">&amp;</span>d<span class="op">);</span></span>
<span id="cb737-23"><a href="#cb737-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb737-24"><a href="#cb737-24" aria-hidden="true" tabindex="-1"></a>    <span class="co">// キャストできない場合、エクセプションのが発生する</span></span>
<span id="cb737-25"><a href="#cb737-25" aria-hidden="true" tabindex="-1"></a>    ASSERT_THROW<span class="op">(</span><span class="kw">dynamic_cast</span><span class="op">&lt;</span>Polymorphic_Derived<span class="op">&amp;&gt;(</span>b_ref_b<span class="op">),</span> <span class="bu">std::</span>bad_cast<span class="op">);</span></span></code></pre></div>
<p>下記のような非ポリモーフィックな(virtual関数を持たない)クラスに対しては、</p>
<div class="sourceCode" id="cb738"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb738-1"><a href="#cb738-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/rtti_ut.cpp 53</span></span>
<span id="cb738-2"><a href="#cb738-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb738-3"><a href="#cb738-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> NonPolymorphic_Base <span class="op">{</span>  <span class="co">// 非ポリモーフィックな基底クラス</span></span>
<span id="cb738-4"><a href="#cb738-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb738-5"><a href="#cb738-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb738-6"><a href="#cb738-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> NonPolymorphic_Derived <span class="op">:</span> <span class="kw">public</span> NonPolymorphic_Base <span class="op">{</span>  <span class="co">// 非ポリモーフィックな派生クラス</span></span>
<span id="cb738-7"><a href="#cb738-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>dynamic_cast、typeidやその戻り値であるstd::type_infoは、下記のように振舞う。</p>
<div class="sourceCode" id="cb739"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb739-1"><a href="#cb739-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/rtti_ut.cpp 65</span></span>
<span id="cb739-2"><a href="#cb739-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb739-3"><a href="#cb739-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> b <span class="op">=</span> NonPolymorphic_Base<span class="op">{};</span></span>
<span id="cb739-4"><a href="#cb739-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> d <span class="op">=</span> NonPolymorphic_Derived<span class="op">{};</span></span>
<span id="cb739-5"><a href="#cb739-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb739-6"><a href="#cb739-6" aria-hidden="true" tabindex="-1"></a>    NonPolymorphic_Base<span class="op">&amp;</span> b_ref_d <span class="op">=</span> d<span class="op">;</span></span>
<span id="cb739-7"><a href="#cb739-7" aria-hidden="true" tabindex="-1"></a>    NonPolymorphic_Base<span class="op">&amp;</span> b_ref_b <span class="op">=</span> b<span class="op">;</span></span>
<span id="cb739-8"><a href="#cb739-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb739-9"><a href="#cb739-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">// std::type_infoの比較</span></span>
<span id="cb739-10"><a href="#cb739-10" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="kw">typeid</span><span class="op">(</span>b_ref_d<span class="op">),</span> <span class="kw">typeid</span><span class="op">(</span>b<span class="op">));</span>  <span class="co">// 実際の型ではなく、表層型のtype_infoが返る</span></span>
<span id="cb739-11"><a href="#cb739-11" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="kw">typeid</span><span class="op">(</span>b_ref_b<span class="op">),</span> <span class="kw">typeid</span><span class="op">(</span>b<span class="op">));</span></span>
<span id="cb739-12"><a href="#cb739-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb739-13"><a href="#cb739-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">// virtual関数を持たないため、ポインタへのdynamic_castはコンパイルできない</span></span>
<span id="cb739-14"><a href="#cb739-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">// auto* d_ptr = dynamic_cast&lt;NonPolymorphic_Derived*&gt;(&amp;b_ref_d);</span></span>
<span id="cb739-15"><a href="#cb739-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">// auto* d_ptr2 = dynamic_cast&lt;NonPolymorphic_Derived*&gt;(&amp;b_ref_b);</span></span>
<span id="cb739-16"><a href="#cb739-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb739-17"><a href="#cb739-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">// virtual関数を持たないため、リファレンスへのdynamic_castはコンパイルできない</span></span>
<span id="cb739-18"><a href="#cb739-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">// auto&amp; d_ref = dynamic_cast&lt;NonPolymorphic_Derived&amp;&gt;(b_ref_d);</span></span>
<span id="cb739-19"><a href="#cb739-19" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ASSERT_THROW(dynamic_cast&lt;NonPolymorphic_Derived&amp;&gt;(b_ref_b), std::bad_cast);</span></span></code></pre></div>
<h3 id="run-time-type-information">Run-time Type Information
<a id="SS_5_10_16"></a></h3>
<p>「<a href="#SS_5_10_15">RTTI</a>」を参照せよ。</p>
<h3 id="simple-declaration">simple-declaration
<a id="SS_5_10_17"></a></h3>
<p>このための記述が <a
href="https://cpprefjp.github.io/lang/cpp17/selection_statements_with_initializer.html">simple-declaration</a>
とは、C++17から導入された
「従来for文しか使用できなかった初期化をif文とswitch文でも使えるようにする」ための記述方法である。</p>
<div class="sourceCode" id="cb740"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb740-1"><a href="#cb740-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/simple_declaration_ut.cpp 9</span></span>
<span id="cb740-2"><a href="#cb740-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int32_t</span> f<span class="op">();</span></span>
<span id="cb740-3"><a href="#cb740-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int32_t</span> g1<span class="op">()</span></span>
<span id="cb740-4"><a href="#cb740-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb740-5"><a href="#cb740-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span><span class="kw">auto</span> ret <span class="op">=</span> f<span class="op">();</span> ret <span class="op">!=</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span>  <span class="co">// retがsimple-declaration</span></span>
<span id="cb740-6"><a href="#cb740-6" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> ret<span class="op">;</span></span>
<span id="cb740-7"><a href="#cb740-7" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb740-8"><a href="#cb740-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb740-9"><a href="#cb740-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb740-10"><a href="#cb740-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb740-11"><a href="#cb740-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb740-12"><a href="#cb740-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb740-13"><a href="#cb740-13" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int32_t</span> g2<span class="op">()</span></span>
<span id="cb740-14"><a href="#cb740-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb740-15"><a href="#cb740-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">switch</span> <span class="op">(</span><span class="kw">auto</span> ret <span class="op">=</span> f<span class="op">())</span> <span class="op">{</span>  <span class="co">// retがsimple-declaration</span></span>
<span id="cb740-16"><a href="#cb740-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="dv">0</span><span class="op">:</span></span>
<span id="cb740-17"><a href="#cb740-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb740-18"><a href="#cb740-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="dv">1</span><span class="op">:</span></span>
<span id="cb740-19"><a href="#cb740-19" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> ret <span class="op">*</span> <span class="dv">5</span><span class="op">;</span></span>
<span id="cb740-20"><a href="#cb740-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="dv">2</span><span class="op">:</span></span>
<span id="cb740-21"><a href="#cb740-21" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> ret <span class="op">+</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb740-22"><a href="#cb740-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">default</span><span class="op">:</span></span>
<span id="cb740-23"><a href="#cb740-23" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb740-24"><a href="#cb740-24" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb740-25"><a href="#cb740-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<h3 id="typeid">typeid <a id="SS_5_10_18"></a></h3>
<p>「<a href="#SS_5_10_15">RTTI</a>」を参照せよ。</p>
<h3 id="トライグラフ">トライグラフ <a id="SS_5_10_19"></a></h3>
<p>トライグラフとは、2つの疑問符とその後に続く1文字によって表される、下記の文字列である。</p>
<pre><code>    ??=  ??/  ??&#39;  ??(  ??)  ??!  ??&lt;  ??&gt;  ??-</code></pre>
<h3 id="フリースタンディング環境">フリースタンディング環境
<a id="SS_5_10_20"></a></h3>
<p><a
href="https://ja.wikipedia.org/wiki/%E3%83%95%E3%83%AA%E3%83%BC%E3%82%B9%E3%82%BF%E3%83%B3%E3%83%87%E3%82%A3%E3%83%B3%E3%82%B0%E7%92%B0%E5%A2%83">フリースタンディング環境</a>
とは、組み込みソフトウェアやOSのように、その実行にOSの補助を受けられないソフトウエアを指す。</p>
<h2 id="ソフトウェア一般">ソフトウェア一般 <a id="SS_5_11"></a></h2>
<h3 id="凝集度">凝集度 <a id="SS_5_11_1"></a></h3>
<p><a
href="https://ja.wikipedia.org/wiki/%E5%87%9D%E9%9B%86%E5%BA%A6">凝集度</a>
とはクラス設計の妥当性を表す尺度の一種であり、 Lack of Cohesion in
Methodsというメトリクスで計測される。</p>
<ul>
<li>Lack of Cohesion in
Methodsの値が1に近ければ凝集度は低く、この値が0に近ければ凝集度は高い。</li>
<li>凝集度とは結合度とも呼ばれ、メンバ(メンバ変数、メンバ関数等)間の結びつきを表す。
メンバ間の結びつきが強いほど、良い設計とされる。</li>
<li>メンバ変数やメンバ関数が多くなれば、凝集度は低くなりやすい。</li>
<li>「<a
href="#SS_1_1">単一責任の原則(SRP)</a>」を守ると凝集度は高くなりやすい。</li>
<li>「<a
href="#SS_2_4">Accessor</a>」を多用すれば凝集度は低くなる。従って、下記のようなクラスは凝集度が低い。
言い換えれば、凝集度を下げることなく、より小さいクラスに分割できる。</li>
</ul>
<div class="sourceCode" id="cb742"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb742-1"><a href="#cb742-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/lack_of_cohesion_ut.cpp 7</span></span>
<span id="cb742-2"><a href="#cb742-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb742-3"><a href="#cb742-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> ABC <span class="op">{</span></span>
<span id="cb742-4"><a href="#cb742-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb742-5"><a href="#cb742-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> ABC<span class="op">(</span><span class="dt">int32_t</span> a<span class="op">,</span> <span class="dt">int32_t</span> b<span class="op">,</span> <span class="dt">int32_t</span> c<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">:</span> <span class="va">a_</span><span class="op">{</span>a<span class="op">},</span> <span class="va">b_</span><span class="op">{</span>b<span class="op">},</span> <span class="va">c_</span><span class="op">{</span>c<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb742-6"><a href="#cb742-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb742-7"><a href="#cb742-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span> GetA<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">a_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb742-8"><a href="#cb742-8" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span> GetB<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">b_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb742-9"><a href="#cb742-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span> GetC<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">c_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb742-10"><a href="#cb742-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span>    SetA<span class="op">(</span><span class="dt">int32_t</span> a<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="va">a_</span> <span class="op">=</span> a<span class="op">;</span> <span class="op">}</span></span>
<span id="cb742-11"><a href="#cb742-11" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span>    SetB<span class="op">(</span><span class="dt">int32_t</span> b<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="va">b_</span> <span class="op">=</span> b<span class="op">;</span> <span class="op">}</span></span>
<span id="cb742-12"><a href="#cb742-12" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span>    SetC<span class="op">(</span><span class="dt">int32_t</span> c<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="va">c_</span> <span class="op">=</span> c<span class="op">;</span> <span class="op">}</span></span>
<span id="cb742-13"><a href="#cb742-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb742-14"><a href="#cb742-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb742-15"><a href="#cb742-15" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span> <span class="va">a_</span><span class="op">;</span></span>
<span id="cb742-16"><a href="#cb742-16" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span> <span class="va">b_</span><span class="op">;</span></span>
<span id="cb742-17"><a href="#cb742-17" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span> <span class="va">c_</span><span class="op">;</span></span>
<span id="cb742-18"><a href="#cb742-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>良く設計されたクラスは、下記のようにメンバが結合しあっているため凝集度が高い
(ただし、「<a
href="#SS_2_6">Immutable</a>」の観点からは、QuadraticEquation::Set()がない方が良い)。
言い換えれば、凝集度を落とさずにクラスを分割することは難しい。</p>
<div class="sourceCode" id="cb743"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb743-1"><a href="#cb743-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/lack_of_cohesion_ut.cpp 26</span></span>
<span id="cb743-2"><a href="#cb743-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb743-3"><a href="#cb743-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> QuadraticEquation <span class="op">{</span>  <span class="co">// 2次方程式</span></span>
<span id="cb743-4"><a href="#cb743-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb743-5"><a href="#cb743-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">explicit</span> QuadraticEquation<span class="op">(</span><span class="dt">int32_t</span> a<span class="op">,</span> <span class="dt">int32_t</span> b<span class="op">,</span> <span class="dt">int32_t</span> c<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">:</span> <span class="va">a_</span><span class="op">{</span>a<span class="op">},</span> <span class="va">b_</span><span class="op">{</span>b<span class="op">},</span> <span class="va">c_</span><span class="op">{</span>c<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb743-6"><a href="#cb743-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb743-7"><a href="#cb743-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> Set<span class="op">(</span><span class="dt">int32_t</span> a<span class="op">,</span> <span class="dt">int32_t</span> b<span class="op">,</span> <span class="dt">int32_t</span> c<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb743-8"><a href="#cb743-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb743-9"><a href="#cb743-9" aria-hidden="true" tabindex="-1"></a>            <span class="va">a_</span> <span class="op">=</span> a<span class="op">;</span></span>
<span id="cb743-10"><a href="#cb743-10" aria-hidden="true" tabindex="-1"></a>            <span class="va">b_</span> <span class="op">=</span> b<span class="op">;</span></span>
<span id="cb743-11"><a href="#cb743-11" aria-hidden="true" tabindex="-1"></a>            <span class="va">c_</span> <span class="op">=</span> c<span class="op">;</span></span>
<span id="cb743-12"><a href="#cb743-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb743-13"><a href="#cb743-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb743-14"><a href="#cb743-14" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span> Discriminant<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span>  <span class="co">// 判定式</span></span>
<span id="cb743-15"><a href="#cb743-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb743-16"><a href="#cb743-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">b_</span> <span class="op">*</span> <span class="va">b_</span> <span class="op">-</span> <span class="dv">4</span> <span class="op">*</span> <span class="va">a_</span> <span class="op">*</span> <span class="va">c_</span><span class="op">;</span></span>
<span id="cb743-17"><a href="#cb743-17" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb743-18"><a href="#cb743-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb743-19"><a href="#cb743-19" aria-hidden="true" tabindex="-1"></a>        <span class="dt">bool</span> HasRealNumberSolution<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="dv">0</span> <span class="op">&lt;=</span> Discriminant<span class="op">();</span> <span class="op">}</span></span>
<span id="cb743-20"><a href="#cb743-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb743-21"><a href="#cb743-21" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>pair<span class="op">&lt;</span><span class="dt">int32_t</span><span class="op">,</span> <span class="dt">int32_t</span><span class="op">&gt;</span> Solution<span class="op">()</span> <span class="at">const</span><span class="op">;</span></span>
<span id="cb743-22"><a href="#cb743-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb743-23"><a href="#cb743-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb743-24"><a href="#cb743-24" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span> <span class="va">a_</span><span class="op">;</span></span>
<span id="cb743-25"><a href="#cb743-25" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span> <span class="va">b_</span><span class="op">;</span></span>
<span id="cb743-26"><a href="#cb743-26" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int32_t</span> <span class="va">c_</span><span class="op">;</span></span>
<span id="cb743-27"><a href="#cb743-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb743-28"><a href="#cb743-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb743-29"><a href="#cb743-29" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>pair<span class="op">&lt;</span><span class="dt">int32_t</span><span class="op">,</span> <span class="dt">int32_t</span><span class="op">&gt;</span> QuadraticEquation<span class="op">::</span>Solution<span class="op">()</span> <span class="at">const</span></span>
<span id="cb743-30"><a href="#cb743-30" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb743-31"><a href="#cb743-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!</span>HasRealNumberSolution<span class="op">())</span> <span class="op">{</span></span>
<span id="cb743-32"><a href="#cb743-32" aria-hidden="true" tabindex="-1"></a>            <span class="cf">throw</span> <span class="bu">std::</span>invalid_argument<span class="op">{</span><span class="st">&quot;solution is an imaginary number&quot;</span><span class="op">};</span></span>
<span id="cb743-33"><a href="#cb743-33" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb743-34"><a href="#cb743-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb743-35"><a href="#cb743-35" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> a0 <span class="op">=</span> <span class="kw">static_cast</span><span class="op">&lt;</span><span class="dt">int32_t</span><span class="op">&gt;((-</span><span class="va">b_</span> <span class="op">-</span> <span class="bu">std::</span>sqrt<span class="op">(</span>Discriminant<span class="op">()))</span> <span class="op">/</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb743-36"><a href="#cb743-36" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> a1 <span class="op">=</span> <span class="kw">static_cast</span><span class="op">&lt;</span><span class="dt">int32_t</span><span class="op">&gt;((-</span><span class="va">b_</span> <span class="op">+</span> <span class="bu">std::</span>sqrt<span class="op">(</span>Discriminant<span class="op">()))</span> <span class="op">/</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb743-37"><a href="#cb743-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb743-38"><a href="#cb743-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="op">{</span>a0<span class="op">,</span> a1<span class="op">};</span></span>
<span id="cb743-39"><a href="#cb743-39" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<h3 id="サイクロマティック複雑度">サイクロマティック複雑度
<a id="SS_5_11_2"></a></h3>
<p><a
href="https://ja.wikipedia.org/wiki/%E5%BE%AA%E7%92%B0%E7%9A%84%E8%A4%87%E9%9B%91%E5%BA%A6">サイクロマティック複雑度</a>
とは関数の複雑さを表すメトリクスである。
このメトリクスの解釈は諸説あるものの、概ね以下のテーブルのようなものである。</p>
<table>
<colgroup>
<col style="width: 40%" />
<col style="width: 60%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">サイクロマティック複雑度(CC)</th>
<th style="text-align: left;">複雑さの状態</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">CC &lt;= 10</td>
<td style="text-align: left;">非常に良い構造</td>
</tr>
<tr class="even">
<td style="text-align: center;">11 &lt; CC &lt; 30</td>
<td style="text-align: left;">やや複雑</td>
</tr>
<tr class="odd">
<td style="text-align: center;">31 &lt; CC &lt; 50</td>
<td style="text-align: left;">構造的なリスクあり</td>
</tr>
<tr class="even">
<td style="text-align: center;">51 &lt; CC</td>
<td
style="text-align: left;">テスト不可能、デグレードリスクが非常に高い</td>
</tr>
</tbody>
</table>
<h3 id="spurious-wakeup">Spurious Wakeup <a id="SS_5_11_3"></a></h3>
<p><a href="https://en.wikipedia.org/wiki/Spurious_wakeup">Spurious
Wakeup</a>とは、
条件変数に対する通知待ちの状態であるスレッドが、その通知がされていないにもかかわらず、
起き上がってしまう現象のことを指す。</p>
<p>下記のようなstd::condition_variableの使用で起こり得る。</p>
<div class="sourceCode" id="cb744"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb744-1"><a href="#cb744-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/spurious_wakeup_ut.cpp 8</span></span>
<span id="cb744-2"><a href="#cb744-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb744-3"><a href="#cb744-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> <span class="op">{</span></span>
<span id="cb744-4"><a href="#cb744-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>mutex<span class="op"> </span>             mutex<span class="op">;</span></span>
<span id="cb744-5"><a href="#cb744-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>condition_variable<span class="op"> </span>cond_var<span class="op">;</span></span>
<span id="cb744-6"><a href="#cb744-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace</span></span>
<span id="cb744-7"><a href="#cb744-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb744-8"><a href="#cb744-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> notify_wrong<span class="op">()</span>  <span class="co">// 通知を行うスレッドが呼び出す関数</span></span>
<span id="cb744-9"><a href="#cb744-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb744-10"><a href="#cb744-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> lock <span class="op">=</span> <span class="bu">std::</span>lock_guard<span class="op">{</span>mutex<span class="op">};</span></span>
<span id="cb744-11"><a href="#cb744-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb744-12"><a href="#cb744-12" aria-hidden="true" tabindex="-1"></a>        cond_var<span class="op">.</span>notify_all<span class="op">();</span>  <span class="co">// wait()で待ち状態のスレッドを起こす。</span></span>
<span id="cb744-13"><a href="#cb744-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb744-14"><a href="#cb744-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb744-15"><a href="#cb744-15" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> wait_wrong<span class="op">()</span>  <span class="co">// 通知待ちスレッドが呼び出す関数</span></span>
<span id="cb744-16"><a href="#cb744-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb744-17"><a href="#cb744-17" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> lock <span class="op">=</span> <span class="bu">std::</span>unique_lock<span class="op">{</span>mutex<span class="op">};</span></span>
<span id="cb744-18"><a href="#cb744-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb744-19"><a href="#cb744-19" aria-hidden="true" tabindex="-1"></a>        <span class="co">// notifyされるのを待つ。</span></span>
<span id="cb744-20"><a href="#cb744-20" aria-hidden="true" tabindex="-1"></a>        cond_var<span class="op">.</span>wait<span class="op">(</span>lock<span class="op">);</span>  <span class="co">// notify_allされなくても起き上がってしまうことがある。</span></span>
<span id="cb744-21"><a href="#cb744-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb744-22"><a href="#cb744-22" aria-hidden="true" tabindex="-1"></a>        <span class="co">// do something</span></span>
<span id="cb744-23"><a href="#cb744-23" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>std::condition_variable::wait()の第2引数を下記のようにすることでこの現象を回避できる。</p>
<div class="sourceCode" id="cb745"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb745-1"><a href="#cb745-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/spurious_wakeup_ut.cpp 34</span></span>
<span id="cb745-2"><a href="#cb745-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb745-3"><a href="#cb745-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> <span class="op">{</span></span>
<span id="cb745-4"><a href="#cb745-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bool</span>                    event_occured<span class="op">{</span><span class="kw">false</span><span class="op">};</span></span>
<span id="cb745-5"><a href="#cb745-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>mutex<span class="op"> </span>             mutex<span class="op">;</span></span>
<span id="cb745-6"><a href="#cb745-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>condition_variable<span class="op"> </span>cond_var<span class="op">;</span></span>
<span id="cb745-7"><a href="#cb745-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>  <span class="co">// namespace</span></span>
<span id="cb745-8"><a href="#cb745-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb745-9"><a href="#cb745-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> notify_right<span class="op">()</span>  <span class="co">// 通知を行うスレッドが呼び出す関数</span></span>
<span id="cb745-10"><a href="#cb745-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb745-11"><a href="#cb745-11" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> lock <span class="op">=</span> <span class="bu">std::</span>lock_guard<span class="op">{</span>mutex<span class="op">};</span></span>
<span id="cb745-12"><a href="#cb745-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb745-13"><a href="#cb745-13" aria-hidden="true" tabindex="-1"></a>        event_occured <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb745-14"><a href="#cb745-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb745-15"><a href="#cb745-15" aria-hidden="true" tabindex="-1"></a>        cond_var<span class="op">.</span>notify_all<span class="op">();</span>  <span class="co">// wait()で待ち状態のスレッドを起こす。</span></span>
<span id="cb745-16"><a href="#cb745-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb745-17"><a href="#cb745-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb745-18"><a href="#cb745-18" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> wait_right<span class="op">()</span>  <span class="co">// 通知待ちスレッドが呼び出す関数</span></span>
<span id="cb745-19"><a href="#cb745-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb745-20"><a href="#cb745-20" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> lock <span class="op">=</span> <span class="bu">std::</span>unique_lock<span class="op">{</span>mutex<span class="op">};</span></span>
<span id="cb745-21"><a href="#cb745-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb745-22"><a href="#cb745-22" aria-hidden="true" tabindex="-1"></a>        <span class="co">// notifyされるのを待つ。</span></span>
<span id="cb745-23"><a href="#cb745-23" aria-hidden="true" tabindex="-1"></a>        cond_var<span class="op">.</span>wait<span class="op">(</span>lock<span class="op">,</span> <span class="op">[]()</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> event_occured<span class="op">;</span> <span class="op">});</span>  <span class="co">// Spurious Wakeup対策</span></span>
<span id="cb745-24"><a href="#cb745-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb745-25"><a href="#cb745-25" aria-hidden="true" tabindex="-1"></a>        event_occured <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb745-26"><a href="#cb745-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb745-27"><a href="#cb745-27" aria-hidden="true" tabindex="-1"></a>        <span class="co">// do something</span></span>
<span id="cb745-28"><a href="#cb745-28" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<h3 id="副作用">副作用 <a id="SS_5_11_4"></a></h3>
<p>プログラミングにおいて、式の評価による作用には、
主たる作用とそれ以外の <a
href="https://ja.wikipedia.org/wiki/%E5%89%AF%E4%BD%9C%E7%94%A8_(%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%A0)">副作用</a>
(side effect)とがある。
式は、評価値を得ること(関数では「引数を受け取り値を返す」と表現する)が主たる作用とされ、
それ以外のコンピュータの論理的状態(ローカル環境以外の状態変数の値)を変化させる作用を副作用という。
副作用の例としては、グローバル変数や静的ローカル変数の変更、
ファイルの読み書き等のI/O実行、等がある。</p>
<h3 id="is-a">is-a <a id="SS_5_11_5"></a></h3>
<p>「is-a」の関係は、オブジェクト指向プログラミング（OOP）
においてクラス間の継承関係を説明する際に使われる概念である。
クラスDerivedとBaseが「is-a」の関係である場合、
DerivedがBaseの派生クラスであり、Baseの特性をDerivedが引き継いでいることを意味する。
C++でのOOPでは、DerivedはBaseのpublic継承として定義される。
通常DerivedやBaseは以下の条件を満たす必要がある。</p>
<ul>
<li>Baseはvirtualメンバ関数(Base::f)を持つ。</li>
<li>DerivedはBase::fのオーバーライド関数を持つ。</li>
<li>DerivedはBaseに対して <a
href="https://ja.wikipedia.org/wiki/%E3%83%AA%E3%82%B9%E3%82%B3%E3%83%95%E3%81%AE%E7%BD%AE%E6%8F%9B%E5%8E%9F%E5%89%87">リスコフの置換原則</a>
を守る必要がある。 この原則を簡単にに説明すると、
「派生クラスのオブジェクトは、
いつでもその基底クラスのオブジェクトと置き換えても、
プログラムの動作に悪影響を与えずに問題が発生してはならない」という設計の制約である。</li>
</ul>
<p>「is-a」の関係とは「一種の～」と言い換えることができることが多い.
ペンギンや九官鳥
は一種の鳥であるため、この関係を使用したコード例を次に示す。</p>
<div class="sourceCode" id="cb746"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb746-1"><a href="#cb746-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/class_relation_ut.cpp 11</span></span>
<span id="cb746-2"><a href="#cb746-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-3"><a href="#cb746-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> bird <span class="op">{</span></span>
<span id="cb746-4"><a href="#cb746-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb746-5"><a href="#cb746-5" aria-hidden="true" tabindex="-1"></a>        <span class="co">//  事前条件: altitude  &gt; 0 でなければならない</span></span>
<span id="cb746-6"><a href="#cb746-6" aria-hidden="true" tabindex="-1"></a>        <span class="co">//  事後条件: 呼び出しが成功した場合、is_flyingがtrueを返すことである</span></span>
<span id="cb746-7"><a href="#cb746-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="dt">void</span> fly<span class="op">(</span><span class="dt">int</span> altitude<span class="op">)</span></span>
<span id="cb746-8"><a href="#cb746-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb746-9"><a href="#cb746-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span><span class="kw">not</span><span class="op">(</span>altitude <span class="op">&gt;</span> <span class="dv">0</span><span class="op">))</span> <span class="op">{</span>  <span class="co">// 高度(altitude)は0より大きくなければ、飛べない</span></span>
<span id="cb746-10"><a href="#cb746-10" aria-hidden="true" tabindex="-1"></a>                <span class="cf">throw</span> <span class="bu">std::</span>invalid_argument<span class="op">{</span><span class="st">&quot;altitude error&quot;</span><span class="op">};</span></span>
<span id="cb746-11"><a href="#cb746-11" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb746-12"><a href="#cb746-12" aria-hidden="true" tabindex="-1"></a>            <span class="va">altitude_</span> <span class="op">=</span> altitude<span class="op">;</span></span>
<span id="cb746-13"><a href="#cb746-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb746-14"><a href="#cb746-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-15"><a href="#cb746-15" aria-hidden="true" tabindex="-1"></a>        <span class="dt">bool</span> is_flying<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span></span>
<span id="cb746-16"><a href="#cb746-16" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb746-17"><a href="#cb746-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">altitude_</span> <span class="op">!=</span> <span class="dv">0</span><span class="op">;</span>  <span class="co">// 高度が0でなければ、飛んでいると判断</span></span>
<span id="cb746-18"><a href="#cb746-18" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb746-19"><a href="#cb746-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-20"><a href="#cb746-20" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="op">~</span>bird<span class="op">()</span> <span class="op">=</span> <span class="cf">default</span><span class="op">;</span></span>
<span id="cb746-21"><a href="#cb746-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-22"><a href="#cb746-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb746-23"><a href="#cb746-23" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> <span class="va">altitude_</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb746-24"><a href="#cb746-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb746-25"><a href="#cb746-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-26"><a href="#cb746-26" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> kyukancho <span class="op">:</span> <span class="kw">public</span> bird <span class="op">{</span></span>
<span id="cb746-27"><a href="#cb746-27" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb746-28"><a href="#cb746-28" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> speak<span class="op">()</span></span>
<span id="cb746-29"><a href="#cb746-29" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb746-30"><a href="#cb746-30" aria-hidden="true" tabindex="-1"></a>            <span class="co">// しゃべるため処理</span></span>
<span id="cb746-31"><a href="#cb746-31" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb746-32"><a href="#cb746-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb746-33"><a href="#cb746-33" aria-hidden="true" tabindex="-1"></a>        <span class="co">// このクラスにget_nameを追加した理由はこの後を読めばわかる</span></span>
<span id="cb746-34"><a href="#cb746-34" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="bu">std::</span>string<span class="op"> </span>get_name<span class="op">()</span> <span class="at">const</span>  <span class="co">// その個体の名前を返す</span></span>
<span id="cb746-35"><a href="#cb746-35" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb746-36"><a href="#cb746-36" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&quot;no name&quot;</span><span class="op">;</span></span>
<span id="cb746-37"><a href="#cb746-37" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb746-38"><a href="#cb746-38" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>bird::flyのオーバーライド(penguin::fly)について、
リスコフの置換原則に反した例を下記する。</p>
<div class="sourceCode" id="cb747"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb747-1"><a href="#cb747-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/class_relation_ut.cpp 50</span></span>
<span id="cb747-2"><a href="#cb747-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb747-3"><a href="#cb747-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> penguin <span class="op">:</span> <span class="kw">public</span> bird <span class="op">{</span></span>
<span id="cb747-4"><a href="#cb747-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb747-5"><a href="#cb747-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> fly<span class="op">(</span><span class="dt">int</span> altitude<span class="op">)</span> <span class="kw">override</span></span>
<span id="cb747-6"><a href="#cb747-6" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb747-7"><a href="#cb747-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>altitude <span class="op">!=</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb747-8"><a href="#cb747-8" aria-hidden="true" tabindex="-1"></a>                <span class="cf">throw</span> <span class="bu">std::</span>invalid_argument<span class="op">{</span><span class="st">&quot;altitude error&quot;</span><span class="op">};</span></span>
<span id="cb747-9"><a href="#cb747-9" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb747-10"><a href="#cb747-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb747-11"><a href="#cb747-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb747-12"><a href="#cb747-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb747-13"><a href="#cb747-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ...</span></span>
<span id="cb747-14"><a href="#cb747-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb747-15"><a href="#cb747-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> let_it_fly <span class="op">=</span> <span class="op">[](</span>bird<span class="op">&amp;</span> b<span class="op">,</span> <span class="dt">int</span> altitude<span class="op">)</span> <span class="op">{</span></span>
<span id="cb747-16"><a href="#cb747-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span> <span class="op">{</span></span>
<span id="cb747-17"><a href="#cb747-17" aria-hidden="true" tabindex="-1"></a>            b<span class="op">.</span>fly<span class="op">(</span>altitude<span class="op">);</span></span>
<span id="cb747-18"><a href="#cb747-18" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb747-19"><a href="#cb747-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">catch</span> <span class="op">(</span><span class="bu">std::</span>exception<span class="op"> </span><span class="at">const</span><span class="op">&amp;)</span> <span class="op">{</span></span>
<span id="cb747-20"><a href="#cb747-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span>  <span class="co">// エクセプションが発生した</span></span>
<span id="cb747-21"><a href="#cb747-21" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb747-22"><a href="#cb747-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb747-23"><a href="#cb747-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> b<span class="op">.</span>is_flying<span class="op">()</span> <span class="op">?</span> <span class="dv">2</span> <span class="op">:</span> <span class="dv">1</span><span class="op">;</span>  <span class="co">// is_flyingがfalseなら1を返す</span></span>
<span id="cb747-24"><a href="#cb747-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb747-25"><a href="#cb747-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb747-26"><a href="#cb747-26" aria-hidden="true" tabindex="-1"></a>    bird    b<span class="op">;</span></span>
<span id="cb747-27"><a href="#cb747-27" aria-hidden="true" tabindex="-1"></a>    penguin p<span class="op">;</span></span>
<span id="cb747-28"><a href="#cb747-28" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>let_it_fly<span class="op">(</span>p<span class="op">,</span> <span class="dv">0</span><span class="op">),</span> <span class="dv">1</span><span class="op">);</span>  <span class="co">// パスする</span></span>
<span id="cb747-29"><a href="#cb747-29" aria-hidden="true" tabindex="-1"></a>    <span class="co">// birdからpenguinへの派生がリスコフ置換の原則を満たすのであれば、</span></span>
<span id="cb747-30"><a href="#cb747-30" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 上記のテストのpをbで置き換えたテストがパスしなければならないが、</span></span>
<span id="cb747-31"><a href="#cb747-31" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 実際には逆に下記テストがパスしてしまう</span></span>
<span id="cb747-32"><a href="#cb747-32" aria-hidden="true" tabindex="-1"></a>    ASSERT_NE<span class="op">(</span>let_it_fly<span class="op">(</span>b<span class="op">,</span> <span class="dv">0</span><span class="op">),</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb747-33"><a href="#cb747-33" aria-hidden="true" tabindex="-1"></a>    <span class="co">// このことからpenguinへの派生はリスコフ置換の原則を満たさない</span></span></code></pre></div>
<p>birdからpenguinへの派生がリスコフ置換の原則に反してしまった原因は以下のように考えることができる。</p>
<ul>
<li>bird::flyの事前条件penguin::flyが強めた</li>
<li>bird::flyの事後条件をpenguin::flyが弱めた</li>
</ul>
<p>penguinとbirdの関係はis-aの関係ではあるが、
上記コードの問題によって不適切なis-aの関係と言わざるを得ない。</p>
<p>上記の例では鳥全般と鳥の種類のis-a関係をpublic継承を使用して表した(一部不適切であるもの)。
さらにis-aの誤った適用例を示す。
自身が飼っている九官鳥に”キューちゃん”と名付けることははよくあることである。
キューちゃんという名前の九官鳥は一種の九官鳥であることは間違いのないことであるが、
このis-aの関係を表すためにpublic継承を使用するのは、is-aの関係の誤用になることが多い。
実際のコード例を以下に示す。この場合、型とインスタンスの概念の混乱が原因だと思われる。</p>
<div class="sourceCode" id="cb748"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb748-1"><a href="#cb748-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/class_relation_ut.cpp 92</span></span>
<span id="cb748-2"><a href="#cb748-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb748-3"><a href="#cb748-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> q_chan <span class="op">:</span> <span class="kw">public</span> kyukancho <span class="op">{</span></span>
<span id="cb748-4"><a href="#cb748-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb748-5"><a href="#cb748-5" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span>get_name<span class="op">()</span> <span class="at">const</span> <span class="kw">override</span> <span class="op">{</span> <span class="cf">return</span> <span class="st">&quot;キューちゃん&quot;</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb748-6"><a href="#cb748-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<p>この誤用を改めた例を以下に示す。</p>
<div class="sourceCode" id="cb749"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb749-1"><a href="#cb749-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/class_relation_ut.cpp 114</span></span>
<span id="cb749-2"><a href="#cb749-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb749-3"><a href="#cb749-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> kyukancho <span class="op">{</span></span>
<span id="cb749-4"><a href="#cb749-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb749-5"><a href="#cb749-5" aria-hidden="true" tabindex="-1"></a>        kyukancho<span class="op">(</span><span class="bu">std::</span>string<span class="op"> </span>name<span class="op">)</span> <span class="op">:</span> <span class="va">name_</span><span class="op">{</span><span class="bu">std::</span>move<span class="op">(</span>name<span class="op">)}</span> <span class="op">{}</span></span>
<span id="cb749-6"><a href="#cb749-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb749-7"><a href="#cb749-7" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span><span class="op">&amp;</span> get_name<span class="op">()</span> <span class="at">const</span>  <span class="co">// 名称をメンバ変数で保持するため、virtualである必要はない</span></span>
<span id="cb749-8"><a href="#cb749-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb749-9"><a href="#cb749-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">name_</span><span class="op">;</span></span>
<span id="cb749-10"><a href="#cb749-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb749-11"><a href="#cb749-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb749-12"><a href="#cb749-12" aria-hidden="true" tabindex="-1"></a>        <span class="kw">virtual</span> <span class="op">~</span>kyukancho<span class="op">()</span> <span class="op">=</span> <span class="cf">default</span><span class="op">;</span></span>
<span id="cb749-13"><a href="#cb749-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb749-14"><a href="#cb749-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb749-15"><a href="#cb749-15" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span><span class="at">const</span> <span class="va">name_</span><span class="op">;</span>  <span class="co">// 名称の保持</span></span>
<span id="cb749-16"><a href="#cb749-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb749-17"><a href="#cb749-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb749-18"><a href="#cb749-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ...</span></span>
<span id="cb749-19"><a href="#cb749-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb749-20"><a href="#cb749-20" aria-hidden="true" tabindex="-1"></a>    kyukancho q<span class="op">{</span><span class="st">&quot;キューちゃん&quot;</span><span class="op">};</span></span>
<span id="cb749-21"><a href="#cb749-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb749-22"><a href="#cb749-22" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span><span class="st">&quot;キューちゃん&quot;</span><span class="op">,</span> q<span class="op">.</span>get_name<span class="op">());</span></span></code></pre></div>
<p>修正されたKyukancho はstd::string
インスタンスをメンバ変数として持ち、 kyukanchoとstd::stringの関係を<a
href="#SS_5_11_6">has-a</a>の関係と呼ぶ。</p>
<h3 id="has-a">has-a <a id="SS_5_11_6"></a></h3>
<p>「has-a」の関係は、
あるクラスのインスタンスが別のクラスのインスタンスを構成要素として含む関係を指す。
つまり、あるクラスのオブジェクトが別のクラスのオブジェクトを保持している関係である。</p>
<p>例えば、CarクラスとEngineクラスがあるとする。CarクラスはEngineクラスのインスタンスを含むので、
CarはEngineを「has-a」の関係にあると言える。
通常、has-aの関係はクラス内でメンバ変数またはメンバオブジェクトとして実装される。
Carクラスの例ではCarクラスにはEngine型のメンバ変数が存在する。</p>
<div class="sourceCode" id="cb750"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb750-1"><a href="#cb750-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/class_relation_ut.cpp 145</span></span>
<span id="cb750-2"><a href="#cb750-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb750-3"><a href="#cb750-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Engine <span class="op">{</span></span>
<span id="cb750-4"><a href="#cb750-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb750-5"><a href="#cb750-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> start<span class="op">()</span> <span class="op">{}</span>  <span class="co">// エンジンを始動するための処理</span></span>
<span id="cb750-6"><a href="#cb750-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> stop<span class="op">()</span> <span class="op">{}</span>   <span class="co">// エンジンを停止するための処理</span></span>
<span id="cb750-7"><a href="#cb750-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb750-8"><a href="#cb750-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb750-9"><a href="#cb750-9" aria-hidden="true" tabindex="-1"></a>        <span class="co">// ...</span></span>
<span id="cb750-10"><a href="#cb750-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb750-11"><a href="#cb750-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb750-12"><a href="#cb750-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Car <span class="op">{</span></span>
<span id="cb750-13"><a href="#cb750-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb750-14"><a href="#cb750-14" aria-hidden="true" tabindex="-1"></a>        Car<span class="op">()</span> <span class="op">:</span> <span class="va">engine_</span><span class="op">{}</span> <span class="op">{}</span></span>
<span id="cb750-15"><a href="#cb750-15" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> start<span class="op">()</span> <span class="op">{</span> <span class="va">engine_</span><span class="op">.</span>start<span class="op">();</span> <span class="op">}</span></span>
<span id="cb750-16"><a href="#cb750-16" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> stop<span class="op">()</span> <span class="op">{</span> <span class="va">engine_</span><span class="op">.</span>stop<span class="op">();</span> <span class="op">}</span></span>
<span id="cb750-17"><a href="#cb750-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb750-18"><a href="#cb750-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb750-19"><a href="#cb750-19" aria-hidden="true" tabindex="-1"></a>        Engine <span class="va">engine_</span><span class="op">;</span>  <span class="co">// Car は Engine を持っている（has-a）</span></span>
<span id="cb750-20"><a href="#cb750-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span></code></pre></div>
<h3 id="is-implemented-in-terms-of">is-implemented-in-terms-of
<a id="SS_5_11_7"></a></h3>
<p>「is-implemented-in-terms-of」の関係は、
オブジェクト指向プログラミング（OOP）において、
あるクラスが別のクラスの機能を内部的に利用して実装されていることを示す概念である。
これは、あるクラスが他のクラスのインターフェースやメソッドを用いて、
自身の機能を提供する場合に使われる。 <a
href="#SS_5_11_6">has-a</a>の関係は、is-implemented-in-terms-of
の関係の一種である。</p>
<p>is-implemented-in-terms-ofは下記の手段1-3に示した方法がある。</p>
<p><em>手段1.</em> <a
href="#SS_5_11_7_1">public継承によるis-implemented-in-terms-of</a><br />
<em>手段2.</em> <a
href="#SS_5_11_7_2">private継承によるis-implemented-in-terms-of</a><br />
<em>手段3.</em> <a
href="#SS_5_11_7_3">コンポジションによる(has-a)is-implemented-in-terms-of</a></p>
<p>手段1-3にはそれぞれ、長所、短所があるため、必要に応じて手段を選択する必要がある。
以下の議論を単純にするため、下記のようにクラスS、C、CCを定める。</p>
<ul>
<li>S(サーバー): 実装を提供するクラス</li>
<li>C(クライアント): Sの実装を利用するクラス</li>
<li>CC(クライアントのクライアント): Cのメンバをを使用するクラス</li>
</ul>
<p>コード量の観点から考えた場合、手段1が最も優れていることが多い。
依存関係の複雑さから考えた場合、CはSに強く依存する。
場合によっては、この依存はCCからSへの依存間にも影響をあたえる。
従って、手段3が依存関係を単純にしやすい。 手段1は<a
href="#SS_5_11_5">is-a</a>に見え、以下に示すような問題も考慮する必要があるため、
可読性、保守性を劣化させる可能性がある。</p>
<div class="sourceCode" id="cb751"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb751-1"><a href="#cb751-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/class_relation_ut.cpp 261</span></span>
<span id="cb751-2"><a href="#cb751-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb751-3"><a href="#cb751-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> MyString <span class="op">:</span> <span class="kw">public</span> <span class="bu">std::</span>string<span class="op"> {</span>  <span class="co">// 手段1</span></span>
<span id="cb751-4"><a href="#cb751-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb751-5"><a href="#cb751-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb751-6"><a href="#cb751-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ...</span></span>
<span id="cb751-7"><a href="#cb751-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>string<span class="op">*</span> <span class="va">m_str</span> <span class="op">=</span> <span class="kw">new</span> MyString<span class="op">{</span><span class="st">&quot;str&quot;</span><span class="op">};</span></span>
<span id="cb751-8"><a href="#cb751-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb751-9"><a href="#cb751-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">// このようなpublic継承を行う場合、基底クラスのデストラクタは非virtualであるため、</span></span>
<span id="cb751-10"><a href="#cb751-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 以下のコードではｈmy_stringのデストラクタは呼び出されない。</span></span>
<span id="cb751-11"><a href="#cb751-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">// この問題はリソースリークを発生させる場合がある。</span></span>
<span id="cb751-12"><a href="#cb751-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">delete</span> <span class="va">m_str</span><span class="op">;</span></span></code></pre></div>
<p>以上述べたように問題の多い手段1であるが、実践的には有用なパターンであり、
<a
href="https://ja.wikibooks.org/wiki/More_C%2B%2B_Idioms/%E5%A5%87%E5%A6%99%E3%81%AB%E5%86%8D%E5%B8%B0%E3%81%97%E3%81%9F%E3%83%86%E3%83%B3%E3%83%97%E3%83%AC%E3%83%BC%E3%83%88%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3(Curiously_Recurring_Template_Pattern)">CRTP(curiously
recurring template pattern)</a>
の実現手段でもあるため、一概にコーディング規約などで排除することもできない。</p>
<h4
id="public継承によるis-implemented-in-terms-of">public継承によるis-implemented-in-terms-of
<a id="SS_5_11_7_1"></a></h4>
<p>public継承によるis-implemented-in-terms-ofの実装例を以下に示す。</p>
<div class="sourceCode" id="cb752"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb752-1"><a href="#cb752-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/class_relation_ut.cpp 283</span></span>
<span id="cb752-2"><a href="#cb752-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb752-3"><a href="#cb752-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> MyString <span class="op">:</span> <span class="kw">public</span> <span class="bu">std::</span>string<span class="op"> {};</span></span>
<span id="cb752-4"><a href="#cb752-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb752-5"><a href="#cb752-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ...</span></span>
<span id="cb752-6"><a href="#cb752-6" aria-hidden="true" tabindex="-1"></a>    MyString str<span class="op">{</span><span class="st">&quot;str&quot;</span><span class="op">};</span></span>
<span id="cb752-7"><a href="#cb752-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb752-8"><a href="#cb752-8" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>str<span class="op">[</span><span class="dv">0</span><span class="op">],</span> <span class="ch">&#39;s&#39;</span><span class="op">);</span></span>
<span id="cb752-9"><a href="#cb752-9" aria-hidden="true" tabindex="-1"></a>    ASSERT_STREQ<span class="op">(</span>str<span class="op">.</span>c_str<span class="op">(),</span> <span class="st">&quot;str&quot;</span><span class="op">);</span></span>
<span id="cb752-10"><a href="#cb752-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb752-11"><a href="#cb752-11" aria-hidden="true" tabindex="-1"></a>    str<span class="op">.</span>clear<span class="op">();</span></span>
<span id="cb752-12"><a href="#cb752-12" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>str<span class="op">.</span>size<span class="op">(),</span> <span class="dv">0</span><span class="op">);</span></span></code></pre></div>
<p>すでに述べたようにこの方法は、 <a
href="#SS_5_11_7_2">private継承によるis-implemented-in-terms-of</a>や、
<a
href="#SS_5_11_7_3">コンポジションによる(has-a)is-implemented-in-terms-of</a>
と比べコードがシンプルになる。</p>
<h4
id="private継承によるis-implemented-in-terms-of">private継承によるis-implemented-in-terms-of
<a id="SS_5_11_7_2"></a></h4>
<p>private継承によるis-implemented-in-terms-ofの実装例を以下に示す。</p>
<div class="sourceCode" id="cb753"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb753-1"><a href="#cb753-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/class_relation_ut.cpp 180</span></span>
<span id="cb753-2"><a href="#cb753-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb753-3"><a href="#cb753-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> MyString <span class="op">:</span> <span class="bu">std::</span>string<span class="op"> {</span></span>
<span id="cb753-4"><a href="#cb753-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb753-5"><a href="#cb753-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> <span class="bu">std::</span>string<span class="bu">::</span>string<span class="op">;</span></span>
<span id="cb753-6"><a href="#cb753-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> <span class="bu">std::</span>string<span class="bu">::</span>operator<span class="op">[];</span></span>
<span id="cb753-7"><a href="#cb753-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> <span class="bu">std::</span>string<span class="bu">::</span>c_str<span class="op">;</span></span>
<span id="cb753-8"><a href="#cb753-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> <span class="bu">std::</span>string<span class="bu">::</span>clear<span class="op">;</span></span>
<span id="cb753-9"><a href="#cb753-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> <span class="bu">std::</span>string<span class="bu">::</span>size<span class="op">;</span></span>
<span id="cb753-10"><a href="#cb753-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb753-11"><a href="#cb753-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb753-12"><a href="#cb753-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ...</span></span>
<span id="cb753-13"><a href="#cb753-13" aria-hidden="true" tabindex="-1"></a>    MyString str<span class="op">{</span><span class="st">&quot;str&quot;</span><span class="op">};</span></span>
<span id="cb753-14"><a href="#cb753-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb753-15"><a href="#cb753-15" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>str<span class="op">[</span><span class="dv">0</span><span class="op">],</span> <span class="ch">&#39;s&#39;</span><span class="op">);</span></span>
<span id="cb753-16"><a href="#cb753-16" aria-hidden="true" tabindex="-1"></a>    ASSERT_STREQ<span class="op">(</span>str<span class="op">.</span>c_str<span class="op">(),</span> <span class="st">&quot;str&quot;</span><span class="op">);</span></span>
<span id="cb753-17"><a href="#cb753-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb753-18"><a href="#cb753-18" aria-hidden="true" tabindex="-1"></a>    str<span class="op">.</span>clear<span class="op">();</span></span>
<span id="cb753-19"><a href="#cb753-19" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>str<span class="op">.</span>size<span class="op">(),</span> <span class="dv">0</span><span class="op">);</span></span></code></pre></div>
<p>この方法は、<a
href="#SS_5_11_7_1">public継承によるis-implemented-in-terms-of</a>が持つデストラクタ問題は発生せす、
<a href="#SS_5_11_5">is-a</a>と誤解してしまう問題も発生しない。</p>
<h4
id="コンポジションによるhas-ais-implemented-in-terms-of">コンポジションによる(has-a)is-implemented-in-terms-of
<a id="SS_5_11_7_3"></a></h4>
<p>コンポジションによる(has-a)is-implemented-in-terms-ofの実装例を示す。</p>
<div class="sourceCode" id="cb754"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb754-1"><a href="#cb754-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// @@@ example/term_explanation/class_relation_ut.cpp 208</span></span>
<span id="cb754-2"><a href="#cb754-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb754-3"><a href="#cb754-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> is_implemented_in_terms_of_1 <span class="op">{</span></span>
<span id="cb754-4"><a href="#cb754-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> MyString <span class="op">{</span></span>
<span id="cb754-5"><a href="#cb754-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb754-6"><a href="#cb754-6" aria-hidden="true" tabindex="-1"></a>        <span class="co">// コンストラクタ</span></span>
<span id="cb754-7"><a href="#cb754-7" aria-hidden="true" tabindex="-1"></a>        MyString<span class="op">()</span> <span class="op">=</span> <span class="cf">default</span><span class="op">;</span></span>
<span id="cb754-8"><a href="#cb754-8" aria-hidden="true" tabindex="-1"></a>        MyString<span class="op">(</span><span class="at">const</span> <span class="bu">std::</span>string<span class="op">&amp;</span> str<span class="op">)</span> <span class="op">:</span> <span class="va">str_</span><span class="op">(</span>str<span class="op">)</span> <span class="op">{}</span></span>
<span id="cb754-9"><a href="#cb754-9" aria-hidden="true" tabindex="-1"></a>        MyString<span class="op">(</span><span class="at">const</span> <span class="dt">char</span><span class="op">*</span> cstr<span class="op">)</span> <span class="op">:</span> <span class="va">str_</span><span class="op">(</span>cstr<span class="op">)</span> <span class="op">{}</span></span>
<span id="cb754-10"><a href="#cb754-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb754-11"><a href="#cb754-11" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 文字列へのアクセス</span></span>
<span id="cb754-12"><a href="#cb754-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">const</span> <span class="dt">char</span><span class="op">*</span> c_str<span class="op">()</span> <span class="at">const</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">str_</span><span class="op">.</span>c_str<span class="op">();</span> <span class="op">}</span></span>
<span id="cb754-13"><a href="#cb754-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb754-14"><a href="#cb754-14" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> reference <span class="op">=</span> <span class="bu">std::</span>string<span class="bu">::</span>reference<span class="op">;</span></span>
<span id="cb754-15"><a href="#cb754-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> <span class="dt">size_type</span> <span class="op">=</span> <span class="bu">std::</span>string<span class="bu">::</span>size_type<span class="op">;</span></span>
<span id="cb754-16"><a href="#cb754-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb754-17"><a href="#cb754-17" aria-hidden="true" tabindex="-1"></a>        reference <span class="kw">operator</span><span class="op">[](</span><span class="dt">size_type</span> pos<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">str_</span><span class="op">[</span>pos<span class="op">];</span> <span class="op">}</span></span>
<span id="cb754-18"><a href="#cb754-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb754-19"><a href="#cb754-19" aria-hidden="true" tabindex="-1"></a>        <span class="co">// その他のメソッドも必要に応じて追加する</span></span>
<span id="cb754-20"><a href="#cb754-20" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 以下は例</span></span>
<span id="cb754-21"><a href="#cb754-21" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>size_t<span class="op"> </span>size<span class="op">()</span> <span class="at">const</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">str_</span><span class="op">.</span>size<span class="op">();</span> <span class="op">}</span></span>
<span id="cb754-22"><a href="#cb754-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb754-23"><a href="#cb754-23" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> clear<span class="op">()</span> <span class="op">{</span> <span class="va">str_</span><span class="op">.</span>clear<span class="op">();</span> <span class="op">}</span></span>
<span id="cb754-24"><a href="#cb754-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb754-25"><a href="#cb754-25" aria-hidden="true" tabindex="-1"></a>        MyString<span class="op">&amp;</span> <span class="kw">operator</span><span class="op">+=(</span><span class="at">const</span> MyString<span class="op">&amp;</span> rhs<span class="op">)</span></span>
<span id="cb754-26"><a href="#cb754-26" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb754-27"><a href="#cb754-27" aria-hidden="true" tabindex="-1"></a>            <span class="va">str_</span> <span class="op">+=</span> rhs<span class="op">.</span><span class="va">str_</span><span class="op">;</span></span>
<span id="cb754-28"><a href="#cb754-28" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="op">*</span><span class="kw">this</span><span class="op">;</span></span>
<span id="cb754-29"><a href="#cb754-29" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb754-30"><a href="#cb754-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb754-31"><a href="#cb754-31" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb754-32"><a href="#cb754-32" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>string<span class="op"> </span><span class="va">str_</span><span class="op">;</span></span>
<span id="cb754-33"><a href="#cb754-33" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb754-34"><a href="#cb754-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb754-35"><a href="#cb754-35" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ...</span></span>
<span id="cb754-36"><a href="#cb754-36" aria-hidden="true" tabindex="-1"></a>    MyString str<span class="op">{</span><span class="st">&quot;str&quot;</span><span class="op">};</span></span>
<span id="cb754-37"><a href="#cb754-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb754-38"><a href="#cb754-38" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>str<span class="op">[</span><span class="dv">0</span><span class="op">],</span> <span class="ch">&#39;s&#39;</span><span class="op">);</span></span>
<span id="cb754-39"><a href="#cb754-39" aria-hidden="true" tabindex="-1"></a>    ASSERT_STREQ<span class="op">(</span>str<span class="op">.</span>c_str<span class="op">(),</span> <span class="st">&quot;str&quot;</span><span class="op">);</span></span>
<span id="cb754-40"><a href="#cb754-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb754-41"><a href="#cb754-41" aria-hidden="true" tabindex="-1"></a>    str<span class="op">.</span>clear<span class="op">();</span></span>
<span id="cb754-42"><a href="#cb754-42" aria-hidden="true" tabindex="-1"></a>    ASSERT_EQ<span class="op">(</span>str<span class="op">.</span>size<span class="op">(),</span> <span class="dv">0</span><span class="op">);</span></span></code></pre></div>
<p>この方は実装を利用するクラストの依存関係を他の2つに比べるとシンプルにできるが、
逆に実装例から昭なとおり、コード量が増えてしまう。</p>
<h2 id="非ソフトウェア用語">非ソフトウェア用語 <a id="SS_5_12"></a></h2>
<h3 id="割れ窓理論">割れ窓理論 <a id="SS_5_12_1"></a></h3>
<p><a
href="https://ja.wikipedia.org/wiki/%E5%89%B2%E3%82%8C%E7%AA%93%E7%90%86%E8%AB%96">割れ窓理論</a>とは、
軽微な犯罪も徹底的に取り締まることで、凶悪犯罪を含めた犯罪を抑止できるとする環境犯罪学上の理論。
アメリカの犯罪学者ジョージ・ケリングが考案した。
「建物の窓が壊れているのを放置すると、誰も注意を払っていないという象徴になり、
やがて他の窓もまもなく全て壊される」との考え方からこの名がある。</p>
<p>ソフトウェア開発での割れ窓とは、「朝会に数分遅刻する」、「プログラミング規約を守らない」
等の軽微なルール違反を指し、この理論の実践には、このような問題を放置しないことによって、</p>
<ul>
<li>チームのモラルハザードを防ぐ</li>
<li>コードの品質を高く保つ</li>
</ul>
<p>等の重要な狙いがある。</p>
<h3 id="車輪の再発明">車輪の再発明 <a id="SS_5_12_2"></a></h3>
<p><a
href="https://ja.wikipedia.org/wiki/%E8%BB%8A%E8%BC%AA%E3%81%AE%E5%86%8D%E7%99%BA%E6%98%8E">車輪の再発明</a>
とは、広く受け入れられ確立されている技術や解決法を（知らずに、または意図的に無視して）
再び一から作ること」を指すための慣用句である。
ソフトウェア開発では、STLのような優れたライブラリを使わずに、
それと同様なライブラリを自分たちで実装するような非効率な様を指すことが多い。</p>
<!-- ./md/sample_code.md -->
<h1 id="sample-code">Sample Code <a id="SS_6"></a></h1>
<h2 id="c">C++ <a id="SS_6_1"></a></h2>
<h3
id="exampledynamic_memory_allocationmalloc_ut.cpp">example/dynamic_memory_allocation/malloc_ut.cpp
<a id="SS_6_1_1"></a></h3>
<div class="sourceCode" id="cb755"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb755-1"><a href="#cb755-1" aria-hidden="true" tabindex="-1"></a>          <span class="dv">1</span> <span class="er">#include &lt;sys/unistd.h&gt;</span></span>
<span id="cb755-2"><a href="#cb755-2" aria-hidden="true" tabindex="-1"></a>          <span class="dv">2</span> </span>
<span id="cb755-3"><a href="#cb755-3" aria-hidden="true" tabindex="-1"></a>          <span class="dv">3</span> <span class="er">#include &lt;cassert&gt;</span></span>
<span id="cb755-4"><a href="#cb755-4" aria-hidden="true" tabindex="-1"></a>          <span class="dv">4</span> <span class="er">#include &lt;cstdint&gt;</span></span>
<span id="cb755-5"><a href="#cb755-5" aria-hidden="true" tabindex="-1"></a>          <span class="dv">5</span> <span class="er">#include &lt;mutex&gt;</span></span>
<span id="cb755-6"><a href="#cb755-6" aria-hidden="true" tabindex="-1"></a>          <span class="dv">6</span> </span>
<span id="cb755-7"><a href="#cb755-7" aria-hidden="true" tabindex="-1"></a>          <span class="dv">7</span> <span class="er">#include &quot;gtest_wrapper.h&quot;</span></span>
<span id="cb755-8"><a href="#cb755-8" aria-hidden="true" tabindex="-1"></a>          <span class="dv">8</span> </span>
<span id="cb755-9"><a href="#cb755-9" aria-hidden="true" tabindex="-1"></a>          <span class="dv">9</span> <span class="er">#include &quot;dynamic_memory_allocation_ut.h&quot;</span></span>
<span id="cb755-10"><a href="#cb755-10" aria-hidden="true" tabindex="-1"></a>         <span class="dv">10</span> <span class="er">#include &quot;spin_lock.h&quot;</span></span>
<span id="cb755-11"><a href="#cb755-11" aria-hidden="true" tabindex="-1"></a>         <span class="dv">11</span> <span class="er">#include &quot;utils.h&quot;</span></span>
<span id="cb755-12"><a href="#cb755-12" aria-hidden="true" tabindex="-1"></a>         <span class="dv">12</span> </span>
<span id="cb755-13"><a href="#cb755-13" aria-hidden="true" tabindex="-1"></a>         <span class="dv">13</span> <span class="co">// @@@ sample begin 0:0</span></span>
<span id="cb755-14"><a href="#cb755-14" aria-hidden="true" tabindex="-1"></a>         <span class="dv">14</span> </span>
<span id="cb755-15"><a href="#cb755-15" aria-hidden="true" tabindex="-1"></a>         <span class="dv">15</span> <span class="at">extern</span> <span class="st">&quot;C&quot;</span> <span class="dt">void</span><span class="op">*</span> sbrk<span class="op">(</span><span class="dt">ptrdiff_t</span> __incr<span class="op">);</span></span>
<span id="cb755-16"><a href="#cb755-16" aria-hidden="true" tabindex="-1"></a>         <span class="dv">16</span> <span class="co">// @@@ sample end</span></span>
<span id="cb755-17"><a href="#cb755-17" aria-hidden="true" tabindex="-1"></a>         <span class="dv">17</span> </span>
<span id="cb755-18"><a href="#cb755-18" aria-hidden="true" tabindex="-1"></a>         <span class="dv">18</span> <span class="kw">namespace</span> MallocFree <span class="op">{</span></span>
<span id="cb755-19"><a href="#cb755-19" aria-hidden="true" tabindex="-1"></a>         <span class="dv">19</span> <span class="co">// @@@ sample begin 1:0</span></span>
<span id="cb755-20"><a href="#cb755-20" aria-hidden="true" tabindex="-1"></a>         <span class="dv">20</span> </span>
<span id="cb755-21"><a href="#cb755-21" aria-hidden="true" tabindex="-1"></a>         <span class="dv">21</span> <span class="kw">namespace</span> <span class="op">{</span></span>
<span id="cb755-22"><a href="#cb755-22" aria-hidden="true" tabindex="-1"></a>         <span class="dv">22</span> </span>
<span id="cb755-23"><a href="#cb755-23" aria-hidden="true" tabindex="-1"></a>         <span class="dv">23</span> <span class="kw">struct</span> <span class="dt">header_t</span> <span class="op">{</span></span>
<span id="cb755-24"><a href="#cb755-24" aria-hidden="true" tabindex="-1"></a>         <span class="dv">24</span>     <span class="dt">header_t</span><span class="op">*</span> next<span class="op">;</span></span>
<span id="cb755-25"><a href="#cb755-25" aria-hidden="true" tabindex="-1"></a>         <span class="dv">25</span>     <span class="dt">size_t</span>    n_nuits<span class="op">;</span>  <span class="co">// header_tが何個あるか</span></span>
<span id="cb755-26"><a href="#cb755-26" aria-hidden="true" tabindex="-1"></a>         <span class="dv">26</span> <span class="op">};</span></span>
<span id="cb755-27"><a href="#cb755-27" aria-hidden="true" tabindex="-1"></a>         <span class="dv">27</span> </span>
<span id="cb755-28"><a href="#cb755-28" aria-hidden="true" tabindex="-1"></a>         <span class="dv">28</span> <span class="dt">header_t</span><span class="op">*</span>        header<span class="op">{</span><span class="kw">nullptr</span><span class="op">};</span></span>
<span id="cb755-29"><a href="#cb755-29" aria-hidden="true" tabindex="-1"></a>         <span class="dv">29</span> SpinLock         spin_lock<span class="op">{};</span></span>
<span id="cb755-30"><a href="#cb755-30" aria-hidden="true" tabindex="-1"></a>         <span class="dv">30</span> <span class="kw">constexpr</span> <span class="dt">size_t</span> unit_size<span class="op">{</span><span class="kw">sizeof</span><span class="op">(</span><span class="dt">header_t</span><span class="op">)};</span></span>
<span id="cb755-31"><a href="#cb755-31" aria-hidden="true" tabindex="-1"></a>         <span class="dv">31</span> </span>
<span id="cb755-32"><a href="#cb755-32" aria-hidden="true" tabindex="-1"></a>         <span class="dv">32</span> <span class="kw">inline</span> <span class="dt">bool</span> sprit<span class="op">(</span><span class="dt">header_t</span><span class="op">*</span> header<span class="op">,</span> <span class="dt">size_t</span> n_nuits<span class="op">,</span> <span class="dt">header_t</span><span class="op">*&amp;</span> next<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb755-33"><a href="#cb755-33" aria-hidden="true" tabindex="-1"></a>         <span class="dv">33</span> <span class="op">{</span></span>
<span id="cb755-34"><a href="#cb755-34" aria-hidden="true" tabindex="-1"></a>         <span class="dv">34</span>     <span class="co">// @@@ ignore begin</span></span>
<span id="cb755-35"><a href="#cb755-35" aria-hidden="true" tabindex="-1"></a>         <span class="dv">35</span>     <span class="ot">assert</span><span class="op">(</span>n_nuits <span class="op">&gt;</span> <span class="dv">1</span><span class="op">);</span>  <span class="co">// ヘッダとバッファなので最低でも2</span></span>
<span id="cb755-36"><a href="#cb755-36" aria-hidden="true" tabindex="-1"></a>         <span class="dv">36</span> </span>
<span id="cb755-37"><a href="#cb755-37" aria-hidden="true" tabindex="-1"></a>         <span class="dv">37</span>     next <span class="op">=</span> <span class="kw">nullptr</span><span class="op">;</span></span>
<span id="cb755-38"><a href="#cb755-38" aria-hidden="true" tabindex="-1"></a>         <span class="dv">38</span> </span>
<span id="cb755-39"><a href="#cb755-39" aria-hidden="true" tabindex="-1"></a>         <span class="dv">39</span>     <span class="cf">if</span> <span class="op">(</span>header<span class="op">-&gt;</span>n_nuits <span class="op">==</span> n_nuits <span class="op">||</span> header<span class="op">-&gt;</span>n_nuits <span class="op">==</span> n_nuits <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb755-40"><a href="#cb755-40" aria-hidden="true" tabindex="-1"></a>         <span class="dv">40</span>         next <span class="op">=</span> header<span class="op">-&gt;</span>next<span class="op">;</span></span>
<span id="cb755-41"><a href="#cb755-41" aria-hidden="true" tabindex="-1"></a>         <span class="dv">41</span>         <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb755-42"><a href="#cb755-42" aria-hidden="true" tabindex="-1"></a>         <span class="dv">42</span>     <span class="op">}</span></span>
<span id="cb755-43"><a href="#cb755-43" aria-hidden="true" tabindex="-1"></a>         <span class="dv">43</span>     <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>header<span class="op">-&gt;</span>n_nuits <span class="op">&gt;</span> n_nuits<span class="op">)</span> <span class="op">{</span></span>
<span id="cb755-44"><a href="#cb755-44" aria-hidden="true" tabindex="-1"></a>         <span class="dv">44</span>         next            <span class="op">=</span> header <span class="op">+</span> n_nuits<span class="op">;</span></span>
<span id="cb755-45"><a href="#cb755-45" aria-hidden="true" tabindex="-1"></a>         <span class="dv">45</span>         next<span class="op">-&gt;</span>n_nuits   <span class="op">=</span> header<span class="op">-&gt;</span>n_nuits <span class="op">-</span> n_nuits<span class="op">;</span></span>
<span id="cb755-46"><a href="#cb755-46" aria-hidden="true" tabindex="-1"></a>         <span class="dv">46</span>         next<span class="op">-&gt;</span>next      <span class="op">=</span> header<span class="op">-&gt;</span>next<span class="op">;</span></span>
<span id="cb755-47"><a href="#cb755-47" aria-hidden="true" tabindex="-1"></a>         <span class="dv">47</span>         header<span class="op">-&gt;</span>n_nuits <span class="op">=</span> n_nuits<span class="op">;</span></span>
<span id="cb755-48"><a href="#cb755-48" aria-hidden="true" tabindex="-1"></a>         <span class="dv">48</span>         <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb755-49"><a href="#cb755-49" aria-hidden="true" tabindex="-1"></a>         <span class="dv">49</span>     <span class="op">}</span></span>
<span id="cb755-50"><a href="#cb755-50" aria-hidden="true" tabindex="-1"></a>         <span class="dv">50</span> </span>
<span id="cb755-51"><a href="#cb755-51" aria-hidden="true" tabindex="-1"></a>         <span class="dv">51</span>     <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb755-52"><a href="#cb755-52" aria-hidden="true" tabindex="-1"></a>         <span class="dv">52</span>     <span class="co">// @@@ ignore end</span></span>
<span id="cb755-53"><a href="#cb755-53" aria-hidden="true" tabindex="-1"></a>         <span class="dv">53</span> <span class="op">}</span></span>
<span id="cb755-54"><a href="#cb755-54" aria-hidden="true" tabindex="-1"></a>         <span class="dv">54</span> </span>
<span id="cb755-55"><a href="#cb755-55" aria-hidden="true" tabindex="-1"></a>         <span class="dv">55</span> <span class="kw">inline</span> <span class="dt">void</span> concat<span class="op">(</span><span class="dt">header_t</span><span class="op">*</span> front<span class="op">,</span> <span class="dt">header_t</span><span class="op">*</span> rear<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb755-56"><a href="#cb755-56" aria-hidden="true" tabindex="-1"></a>         <span class="dv">56</span> <span class="op">{</span></span>
<span id="cb755-57"><a href="#cb755-57" aria-hidden="true" tabindex="-1"></a>         <span class="dv">57</span>     <span class="co">// @@@ ignore begin</span></span>
<span id="cb755-58"><a href="#cb755-58" aria-hidden="true" tabindex="-1"></a>         <span class="dv">58</span>     <span class="cf">if</span> <span class="op">(</span>front <span class="op">+</span> front<span class="op">-&gt;</span>n_nuits <span class="op">==</span> rear<span class="op">)</span> <span class="op">{</span>  <span class="co">// 1枚のメモリになる</span></span>
<span id="cb755-59"><a href="#cb755-59" aria-hidden="true" tabindex="-1"></a>         <span class="dv">59</span>         front<span class="op">-&gt;</span>n_nuits <span class="op">+=</span> rear<span class="op">-&gt;</span>n_nuits<span class="op">;</span></span>
<span id="cb755-60"><a href="#cb755-60" aria-hidden="true" tabindex="-1"></a>         <span class="dv">60</span>         front<span class="op">-&gt;</span>next <span class="op">=</span> rear<span class="op">-&gt;</span>next<span class="op">;</span></span>
<span id="cb755-61"><a href="#cb755-61" aria-hidden="true" tabindex="-1"></a>         <span class="dv">61</span>     <span class="op">}</span></span>
<span id="cb755-62"><a href="#cb755-62" aria-hidden="true" tabindex="-1"></a>         <span class="dv">62</span>     <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb755-63"><a href="#cb755-63" aria-hidden="true" tabindex="-1"></a>         <span class="dv">63</span>         front<span class="op">-&gt;</span>next <span class="op">=</span> rear<span class="op">;</span></span>
<span id="cb755-64"><a href="#cb755-64" aria-hidden="true" tabindex="-1"></a>         <span class="dv">64</span>     <span class="op">}</span></span>
<span id="cb755-65"><a href="#cb755-65" aria-hidden="true" tabindex="-1"></a>         <span class="dv">65</span>     <span class="co">// @@@ ignore end</span></span>
<span id="cb755-66"><a href="#cb755-66" aria-hidden="true" tabindex="-1"></a>         <span class="dv">66</span> <span class="op">}</span></span>
<span id="cb755-67"><a href="#cb755-67" aria-hidden="true" tabindex="-1"></a>         <span class="dv">67</span> </span>
<span id="cb755-68"><a href="#cb755-68" aria-hidden="true" tabindex="-1"></a>         <span class="dv">68</span> <span class="dt">header_t</span><span class="op">*</span> set_back<span class="op">(</span><span class="dt">void</span><span class="op">*</span> mem<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="kw">static_cast</span><span class="op">&lt;</span><span class="dt">header_t</span><span class="op">*&gt;(</span>mem<span class="op">)</span> <span class="op">-</span> <span class="dv">1</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb755-69"><a href="#cb755-69" aria-hidden="true" tabindex="-1"></a>         <span class="dv">69</span> </span>
<span id="cb755-70"><a href="#cb755-70" aria-hidden="true" tabindex="-1"></a>         <span class="dv">70</span> <span class="kw">static_assert</span><span class="op">(</span><span class="kw">sizeof</span><span class="op">(</span><span class="dt">header_t</span><span class="op">)</span> <span class="op">==</span> <span class="kw">alignof</span><span class="op">(</span><span class="bu">std::</span>max_align_t<span class="op">));</span></span>
<span id="cb755-71"><a href="#cb755-71" aria-hidden="true" tabindex="-1"></a>         <span class="dv">71</span> </span>
<span id="cb755-72"><a href="#cb755-72" aria-hidden="true" tabindex="-1"></a>         <span class="dv">72</span> <span class="dt">void</span><span class="op">*</span> malloc_inner<span class="op">(</span><span class="dt">size_t</span> size<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb755-73"><a href="#cb755-73" aria-hidden="true" tabindex="-1"></a>         <span class="dv">73</span> <span class="op">{</span></span>
<span id="cb755-74"><a href="#cb755-74" aria-hidden="true" tabindex="-1"></a>         <span class="dv">74</span>     <span class="co">// @@@ ignore begin</span></span>
<span id="cb755-75"><a href="#cb755-75" aria-hidden="true" tabindex="-1"></a>         <span class="dv">75</span>     <span class="co">// size分のメモリとヘッダ</span></span>
<span id="cb755-76"><a href="#cb755-76" aria-hidden="true" tabindex="-1"></a>         <span class="dv">76</span>     <span class="kw">auto</span> n_nuits <span class="op">=</span> <span class="op">(</span>Roundup<span class="op">(</span>unit_size<span class="op">,</span> size<span class="op">)</span> <span class="op">/</span> unit_size<span class="op">)</span> <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb755-77"><a href="#cb755-77" aria-hidden="true" tabindex="-1"></a>         <span class="dv">77</span>     <span class="kw">auto</span> lock    <span class="op">=</span> <span class="bu">std::</span>lock_guard<span class="op">{</span>spin_lock<span class="op">};</span></span>
<span id="cb755-78"><a href="#cb755-78" aria-hidden="true" tabindex="-1"></a>         <span class="dv">78</span> </span>
<span id="cb755-79"><a href="#cb755-79" aria-hidden="true" tabindex="-1"></a>         <span class="dv">79</span>     <span class="kw">auto</span> curr <span class="op">=</span> header<span class="op">;</span></span>
<span id="cb755-80"><a href="#cb755-80" aria-hidden="true" tabindex="-1"></a>         <span class="dv">80</span>     <span class="cf">for</span> <span class="op">(</span><span class="dt">header_t</span><span class="op">*</span> prev <span class="op">=</span> <span class="kw">nullptr</span><span class="op">;</span> curr <span class="op">!=</span> <span class="kw">nullptr</span><span class="op">;</span> prev <span class="op">=</span> curr<span class="op">,</span> curr <span class="op">=</span> curr<span class="op">-&gt;</span>next<span class="op">)</span> <span class="op">{</span></span>
<span id="cb755-81"><a href="#cb755-81" aria-hidden="true" tabindex="-1"></a>         <span class="dv">81</span>         <span class="dt">header_t</span><span class="op">*</span> next<span class="op">;</span></span>
<span id="cb755-82"><a href="#cb755-82" aria-hidden="true" tabindex="-1"></a>         <span class="dv">82</span> </span>
<span id="cb755-83"><a href="#cb755-83" aria-hidden="true" tabindex="-1"></a>         <span class="dv">83</span>         <span class="cf">if</span> <span class="op">(!</span>sprit<span class="op">(</span>curr<span class="op">,</span> n_nuits<span class="op">,</span> next<span class="op">))</span> <span class="op">{</span></span>
<span id="cb755-84"><a href="#cb755-84" aria-hidden="true" tabindex="-1"></a>         <span class="dv">84</span>             <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb755-85"><a href="#cb755-85" aria-hidden="true" tabindex="-1"></a>         <span class="dv">85</span>         <span class="op">}</span></span>
<span id="cb755-86"><a href="#cb755-86" aria-hidden="true" tabindex="-1"></a>         <span class="dv">86</span> </span>
<span id="cb755-87"><a href="#cb755-87" aria-hidden="true" tabindex="-1"></a>         <span class="dv">87</span>         <span class="cf">if</span> <span class="op">(</span>prev <span class="op">==</span> <span class="kw">nullptr</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb755-88"><a href="#cb755-88" aria-hidden="true" tabindex="-1"></a>         <span class="dv">88</span>             header <span class="op">=</span> next<span class="op">;</span></span>
<span id="cb755-89"><a href="#cb755-89" aria-hidden="true" tabindex="-1"></a>         <span class="dv">89</span>         <span class="op">}</span></span>
<span id="cb755-90"><a href="#cb755-90" aria-hidden="true" tabindex="-1"></a>         <span class="dv">90</span>         <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb755-91"><a href="#cb755-91" aria-hidden="true" tabindex="-1"></a>         <span class="dv">91</span>             prev<span class="op">-&gt;</span>next <span class="op">=</span> next<span class="op">;</span></span>
<span id="cb755-92"><a href="#cb755-92" aria-hidden="true" tabindex="-1"></a>         <span class="dv">92</span>         <span class="op">}</span></span>
<span id="cb755-93"><a href="#cb755-93" aria-hidden="true" tabindex="-1"></a>         <span class="dv">93</span>         <span class="cf">break</span><span class="op">;</span></span>
<span id="cb755-94"><a href="#cb755-94" aria-hidden="true" tabindex="-1"></a>         <span class="dv">94</span>     <span class="op">}</span></span>
<span id="cb755-95"><a href="#cb755-95" aria-hidden="true" tabindex="-1"></a>         <span class="dv">95</span> </span>
<span id="cb755-96"><a href="#cb755-96" aria-hidden="true" tabindex="-1"></a>         <span class="dv">96</span>     <span class="cf">if</span> <span class="op">(</span>curr <span class="op">!=</span> <span class="kw">nullptr</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb755-97"><a href="#cb755-97" aria-hidden="true" tabindex="-1"></a>         <span class="dv">97</span>         <span class="op">++</span>curr<span class="op">;</span></span>
<span id="cb755-98"><a href="#cb755-98" aria-hidden="true" tabindex="-1"></a>         <span class="dv">98</span>     <span class="op">}</span></span>
<span id="cb755-99"><a href="#cb755-99" aria-hidden="true" tabindex="-1"></a>         <span class="dv">99</span> </span>
<span id="cb755-100"><a href="#cb755-100" aria-hidden="true" tabindex="-1"></a>        <span class="dv">100</span>     <span class="cf">return</span> curr<span class="op">;</span></span>
<span id="cb755-101"><a href="#cb755-101" aria-hidden="true" tabindex="-1"></a>        <span class="dv">101</span>     <span class="co">// @@@ ignore end</span></span>
<span id="cb755-102"><a href="#cb755-102" aria-hidden="true" tabindex="-1"></a>        <span class="dv">102</span> <span class="op">}</span></span>
<span id="cb755-103"><a href="#cb755-103" aria-hidden="true" tabindex="-1"></a>        <span class="dv">103</span> <span class="op">}</span>  <span class="co">// namespace</span></span>
<span id="cb755-104"><a href="#cb755-104" aria-hidden="true" tabindex="-1"></a>        <span class="dv">104</span> <span class="co">// @@@ sample end</span></span>
<span id="cb755-105"><a href="#cb755-105" aria-hidden="true" tabindex="-1"></a>        <span class="dv">105</span> <span class="co">// @@@ sample begin 2:0</span></span>
<span id="cb755-106"><a href="#cb755-106" aria-hidden="true" tabindex="-1"></a>        <span class="dv">106</span> </span>
<span id="cb755-107"><a href="#cb755-107" aria-hidden="true" tabindex="-1"></a>        <span class="dv">107</span> <span class="dt">void</span> free<span class="op">(</span><span class="dt">void</span><span class="op">*</span> mem<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb755-108"><a href="#cb755-108" aria-hidden="true" tabindex="-1"></a>        <span class="dv">108</span> <span class="op">{</span></span>
<span id="cb755-109"><a href="#cb755-109" aria-hidden="true" tabindex="-1"></a>        <span class="dv">109</span>     <span class="dt">header_t</span><span class="op">*</span> mem_to_free <span class="op">=</span> set_back<span class="op">(</span>mem<span class="op">);</span></span>
<span id="cb755-110"><a href="#cb755-110" aria-hidden="true" tabindex="-1"></a>        <span class="dv">110</span> </span>
<span id="cb755-111"><a href="#cb755-111" aria-hidden="true" tabindex="-1"></a>        <span class="dv">111</span>     mem_to_free<span class="op">-&gt;</span>next <span class="op">=</span> <span class="kw">nullptr</span><span class="op">;</span></span>
<span id="cb755-112"><a href="#cb755-112" aria-hidden="true" tabindex="-1"></a>        <span class="dv">112</span> </span>
<span id="cb755-113"><a href="#cb755-113" aria-hidden="true" tabindex="-1"></a>        <span class="dv">113</span>     <span class="kw">auto</span> lock <span class="op">=</span> <span class="bu">std::</span>lock_guard<span class="op">{</span>spin_lock<span class="op">};</span></span>
<span id="cb755-114"><a href="#cb755-114" aria-hidden="true" tabindex="-1"></a>        <span class="dv">114</span> </span>
<span id="cb755-115"><a href="#cb755-115" aria-hidden="true" tabindex="-1"></a>        <span class="dv">115</span>     <span class="cf">if</span> <span class="op">(</span>header <span class="op">==</span> <span class="kw">nullptr</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb755-116"><a href="#cb755-116" aria-hidden="true" tabindex="-1"></a>        <span class="dv">116</span>         header <span class="op">=</span> mem_to_free<span class="op">;</span></span>
<span id="cb755-117"><a href="#cb755-117" aria-hidden="true" tabindex="-1"></a>        <span class="dv">117</span>         <span class="cf">return</span><span class="op">;</span></span>
<span id="cb755-118"><a href="#cb755-118" aria-hidden="true" tabindex="-1"></a>        <span class="dv">118</span>     <span class="op">}</span></span>
<span id="cb755-119"><a href="#cb755-119" aria-hidden="true" tabindex="-1"></a>        <span class="dv">119</span>     <span class="co">// @@@ sample end</span></span>
<span id="cb755-120"><a href="#cb755-120" aria-hidden="true" tabindex="-1"></a>        <span class="dv">120</span>     <span class="co">// @@@ sample begin 2:1</span></span>
<span id="cb755-121"><a href="#cb755-121" aria-hidden="true" tabindex="-1"></a>        <span class="dv">121</span> </span>
<span id="cb755-122"><a href="#cb755-122" aria-hidden="true" tabindex="-1"></a>        <span class="dv">122</span>     <span class="cf">if</span> <span class="op">(</span>mem_to_free <span class="op">&lt;</span> header<span class="op">)</span> <span class="op">{</span></span>
<span id="cb755-123"><a href="#cb755-123" aria-hidden="true" tabindex="-1"></a>        <span class="dv">123</span>         concat<span class="op">(</span>mem_to_free<span class="op">,</span> header<span class="op">);</span></span>
<span id="cb755-124"><a href="#cb755-124" aria-hidden="true" tabindex="-1"></a>        <span class="dv">124</span>         header <span class="op">=</span> mem_to_free<span class="op">;</span></span>
<span id="cb755-125"><a href="#cb755-125" aria-hidden="true" tabindex="-1"></a>        <span class="dv">125</span>         <span class="cf">return</span><span class="op">;</span></span>
<span id="cb755-126"><a href="#cb755-126" aria-hidden="true" tabindex="-1"></a>        <span class="dv">126</span>     <span class="op">}</span></span>
<span id="cb755-127"><a href="#cb755-127" aria-hidden="true" tabindex="-1"></a>        <span class="dv">127</span> </span>
<span id="cb755-128"><a href="#cb755-128" aria-hidden="true" tabindex="-1"></a>        <span class="dv">128</span>     <span class="kw">auto</span> curr <span class="op">=</span> header<span class="op">;</span></span>
<span id="cb755-129"><a href="#cb755-129" aria-hidden="true" tabindex="-1"></a>        <span class="dv">129</span>     <span class="cf">for</span> <span class="op">(;</span> curr<span class="op">-&gt;</span>next <span class="op">!=</span> <span class="kw">nullptr</span><span class="op">;</span> curr <span class="op">=</span> curr<span class="op">-&gt;</span>next<span class="op">)</span> <span class="op">{</span></span>
<span id="cb755-130"><a href="#cb755-130" aria-hidden="true" tabindex="-1"></a>        <span class="dv">130</span>         <span class="cf">if</span> <span class="op">(</span>mem_to_free <span class="op">&lt;</span> curr<span class="op">-&gt;</span>next<span class="op">)</span> <span class="op">{</span>  <span class="co">// 常に curr &lt; mem_to_free</span></span>
<span id="cb755-131"><a href="#cb755-131" aria-hidden="true" tabindex="-1"></a>        <span class="dv">131</span>             concat<span class="op">(</span>mem_to_free<span class="op">,</span> curr<span class="op">-&gt;</span>next<span class="op">);</span></span>
<span id="cb755-132"><a href="#cb755-132" aria-hidden="true" tabindex="-1"></a>        <span class="dv">132</span>             concat<span class="op">(</span>curr<span class="op">,</span> mem_to_free<span class="op">);</span></span>
<span id="cb755-133"><a href="#cb755-133" aria-hidden="true" tabindex="-1"></a>        <span class="dv">133</span>             <span class="cf">return</span><span class="op">;</span></span>
<span id="cb755-134"><a href="#cb755-134" aria-hidden="true" tabindex="-1"></a>        <span class="dv">134</span>         <span class="op">}</span></span>
<span id="cb755-135"><a href="#cb755-135" aria-hidden="true" tabindex="-1"></a>        <span class="dv">135</span>     <span class="op">}</span></span>
<span id="cb755-136"><a href="#cb755-136" aria-hidden="true" tabindex="-1"></a>        <span class="dv">136</span> </span>
<span id="cb755-137"><a href="#cb755-137" aria-hidden="true" tabindex="-1"></a>        <span class="dv">137</span>     concat<span class="op">(</span>curr<span class="op">,</span> mem_to_free<span class="op">);</span></span>
<span id="cb755-138"><a href="#cb755-138" aria-hidden="true" tabindex="-1"></a>        <span class="dv">138</span>     <span class="co">// @@@ sample end</span></span>
<span id="cb755-139"><a href="#cb755-139" aria-hidden="true" tabindex="-1"></a>        <span class="dv">139</span>     <span class="co">// @@@ sample begin 2:2</span></span>
<span id="cb755-140"><a href="#cb755-140" aria-hidden="true" tabindex="-1"></a>        <span class="dv">140</span> <span class="op">}</span></span>
<span id="cb755-141"><a href="#cb755-141" aria-hidden="true" tabindex="-1"></a>        <span class="dv">141</span> <span class="co">// @@@ sample end</span></span>
<span id="cb755-142"><a href="#cb755-142" aria-hidden="true" tabindex="-1"></a>        <span class="dv">142</span> <span class="co">// @@@ sample begin 3:0</span></span>
<span id="cb755-143"><a href="#cb755-143" aria-hidden="true" tabindex="-1"></a>        <span class="dv">143</span> </span>
<span id="cb755-144"><a href="#cb755-144" aria-hidden="true" tabindex="-1"></a>        <span class="dv">144</span> <span class="dt">void</span><span class="op">*</span> malloc<span class="op">(</span><span class="dt">size_t</span> size<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb755-145"><a href="#cb755-145" aria-hidden="true" tabindex="-1"></a>        <span class="dv">145</span> <span class="op">{</span></span>
<span id="cb755-146"><a href="#cb755-146" aria-hidden="true" tabindex="-1"></a>        <span class="dv">146</span>     <span class="dt">void</span><span class="op">*</span> mem <span class="op">=</span> malloc_inner<span class="op">(</span>size<span class="op">);</span></span>
<span id="cb755-147"><a href="#cb755-147" aria-hidden="true" tabindex="-1"></a>        <span class="dv">147</span>     <span class="co">// @@@ sample end</span></span>
<span id="cb755-148"><a href="#cb755-148" aria-hidden="true" tabindex="-1"></a>        <span class="dv">148</span>     <span class="co">// @@@ sample begin 3:1</span></span>
<span id="cb755-149"><a href="#cb755-149" aria-hidden="true" tabindex="-1"></a>        <span class="dv">149</span> </span>
<span id="cb755-150"><a href="#cb755-150" aria-hidden="true" tabindex="-1"></a>        <span class="dv">150</span>     <span class="cf">if</span> <span class="op">(</span>mem <span class="op">==</span> <span class="kw">nullptr</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb755-151"><a href="#cb755-151" aria-hidden="true" tabindex="-1"></a>        <span class="dv">151</span>         <span class="kw">auto</span> <span class="at">const</span> add_size <span class="op">=</span> Roundup<span class="op">(</span>unit_size<span class="op">,</span> <span class="dv">1024</span> <span class="op">*</span> <span class="dv">1024</span> <span class="op">+</span> size<span class="op">);</span>  <span class="co">// 1MB追加</span></span>
<span id="cb755-152"><a href="#cb755-152" aria-hidden="true" tabindex="-1"></a>        <span class="dv">152</span> </span>
<span id="cb755-153"><a href="#cb755-153" aria-hidden="true" tabindex="-1"></a>        <span class="dv">153</span>         <span class="dt">header_t</span><span class="op">*</span> add <span class="op">=</span> <span class="kw">static_cast</span><span class="op">&lt;</span><span class="dt">header_t</span><span class="op">*&gt;(</span>sbrk<span class="op">(</span>add_size<span class="op">));</span></span>
<span id="cb755-154"><a href="#cb755-154" aria-hidden="true" tabindex="-1"></a>        <span class="dv">154</span>         add<span class="op">-&gt;</span>n_nuits  <span class="op">=</span> add_size <span class="op">/</span> unit_size<span class="op">;</span></span>
<span id="cb755-155"><a href="#cb755-155" aria-hidden="true" tabindex="-1"></a>        <span class="dv">155</span>         free<span class="op">(++</span>add<span class="op">);</span></span>
<span id="cb755-156"><a href="#cb755-156" aria-hidden="true" tabindex="-1"></a>        <span class="dv">156</span>         mem <span class="op">=</span> malloc_inner<span class="op">(</span>size<span class="op">);</span></span>
<span id="cb755-157"><a href="#cb755-157" aria-hidden="true" tabindex="-1"></a>        <span class="dv">157</span>     <span class="op">}</span></span>
<span id="cb755-158"><a href="#cb755-158" aria-hidden="true" tabindex="-1"></a>        <span class="dv">158</span>     <span class="co">// @@@ sample end</span></span>
<span id="cb755-159"><a href="#cb755-159" aria-hidden="true" tabindex="-1"></a>        <span class="dv">159</span>     <span class="co">// @@@ sample begin 3:2</span></span>
<span id="cb755-160"><a href="#cb755-160" aria-hidden="true" tabindex="-1"></a>        <span class="dv">160</span> </span>
<span id="cb755-161"><a href="#cb755-161" aria-hidden="true" tabindex="-1"></a>        <span class="dv">161</span>     <span class="cf">return</span> mem<span class="op">;</span></span>
<span id="cb755-162"><a href="#cb755-162" aria-hidden="true" tabindex="-1"></a>        <span class="dv">162</span> <span class="op">}</span></span>
<span id="cb755-163"><a href="#cb755-163" aria-hidden="true" tabindex="-1"></a>        <span class="dv">163</span> <span class="co">// @@@ sample end</span></span>
<span id="cb755-164"><a href="#cb755-164" aria-hidden="true" tabindex="-1"></a>        <span class="dv">164</span> </span>
<span id="cb755-165"><a href="#cb755-165" aria-hidden="true" tabindex="-1"></a>        <span class="dv">165</span> <span class="kw">namespace</span> <span class="op">{</span></span>
<span id="cb755-166"><a href="#cb755-166" aria-hidden="true" tabindex="-1"></a>        <span class="dv">166</span> TEST<span class="op">(</span>NewDelete_Opt<span class="op">,</span> malloc<span class="op">)</span></span>
<span id="cb755-167"><a href="#cb755-167" aria-hidden="true" tabindex="-1"></a>        <span class="dv">167</span> <span class="op">{</span></span>
<span id="cb755-168"><a href="#cb755-168" aria-hidden="true" tabindex="-1"></a>        <span class="dv">168</span>     <span class="op">{</span></span>
<span id="cb755-169"><a href="#cb755-169" aria-hidden="true" tabindex="-1"></a>        <span class="dv">169</span>         <span class="dt">void</span><span class="op">*</span> mem <span class="op">=</span> malloc<span class="op">(</span><span class="dv">1024</span><span class="op">);</span></span>
<span id="cb755-170"><a href="#cb755-170" aria-hidden="true" tabindex="-1"></a>        <span class="dv">170</span> </span>
<span id="cb755-171"><a href="#cb755-171" aria-hidden="true" tabindex="-1"></a>        <span class="dv">171</span>         ASSERT_NE<span class="op">(</span><span class="kw">nullptr</span><span class="op">,</span> mem<span class="op">);</span></span>
<span id="cb755-172"><a href="#cb755-172" aria-hidden="true" tabindex="-1"></a>        <span class="dv">172</span>         free<span class="op">(</span>mem<span class="op">);</span></span>
<span id="cb755-173"><a href="#cb755-173" aria-hidden="true" tabindex="-1"></a>        <span class="dv">173</span> </span>
<span id="cb755-174"><a href="#cb755-174" aria-hidden="true" tabindex="-1"></a>        <span class="dv">174</span>         <span class="dt">void</span><span class="op">*</span> ints<span class="op">[</span><span class="dv">8</span><span class="op">]{};</span></span>
<span id="cb755-175"><a href="#cb755-175" aria-hidden="true" tabindex="-1"></a>        <span class="dv">175</span> </span>
<span id="cb755-176"><a href="#cb755-176" aria-hidden="true" tabindex="-1"></a>        <span class="dv">176</span>         <span class="kw">constexpr</span> <span class="kw">auto</span> n_nuits <span class="op">=</span> Roundup<span class="op">(</span>unit_size<span class="op">,</span> unit_size <span class="op">+</span> <span class="kw">sizeof</span><span class="op">(</span><span class="dt">int</span><span class="op">))</span> <span class="op">/</span> unit_size<span class="op">;</span></span>
<span id="cb755-177"><a href="#cb755-177" aria-hidden="true" tabindex="-1"></a>        <span class="dv">177</span> </span>
<span id="cb755-178"><a href="#cb755-178" aria-hidden="true" tabindex="-1"></a>        <span class="dv">178</span>         <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span><span class="op">&amp;</span> i <span class="op">:</span> ints<span class="op">)</span> <span class="op">{</span></span>
<span id="cb755-179"><a href="#cb755-179" aria-hidden="true" tabindex="-1"></a>        <span class="dv">179</span>             i <span class="op">=</span> malloc<span class="op">(</span><span class="kw">sizeof</span><span class="op">(</span><span class="dt">int</span><span class="op">));</span></span>
<span id="cb755-180"><a href="#cb755-180" aria-hidden="true" tabindex="-1"></a>        <span class="dv">180</span> </span>
<span id="cb755-181"><a href="#cb755-181" aria-hidden="true" tabindex="-1"></a>        <span class="dv">181</span>             <span class="dt">header_t</span><span class="op">*</span> h <span class="op">=</span> set_back<span class="op">(</span>i<span class="op">);</span></span>
<span id="cb755-182"><a href="#cb755-182" aria-hidden="true" tabindex="-1"></a>        <span class="dv">182</span>             ASSERT_EQ<span class="op">(</span>h<span class="op">-&gt;</span>n_nuits<span class="op">,</span> n_nuits<span class="op">);</span></span>
<span id="cb755-183"><a href="#cb755-183" aria-hidden="true" tabindex="-1"></a>        <span class="dv">183</span>         <span class="op">}</span></span>
<span id="cb755-184"><a href="#cb755-184" aria-hidden="true" tabindex="-1"></a>        <span class="dv">184</span> </span>
<span id="cb755-185"><a href="#cb755-185" aria-hidden="true" tabindex="-1"></a>        <span class="dv">185</span>         <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span><span class="op">&amp;</span> i <span class="op">:</span> ints<span class="op">)</span> <span class="op">{</span></span>
<span id="cb755-186"><a href="#cb755-186" aria-hidden="true" tabindex="-1"></a>        <span class="dv">186</span>             free<span class="op">(</span>i<span class="op">);</span></span>
<span id="cb755-187"><a href="#cb755-187" aria-hidden="true" tabindex="-1"></a>        <span class="dv">187</span>         <span class="op">}</span></span>
<span id="cb755-188"><a href="#cb755-188" aria-hidden="true" tabindex="-1"></a>        <span class="dv">188</span>     <span class="op">}</span></span>
<span id="cb755-189"><a href="#cb755-189" aria-hidden="true" tabindex="-1"></a>        <span class="dv">189</span> </span>
<span id="cb755-190"><a href="#cb755-190" aria-hidden="true" tabindex="-1"></a>        <span class="dv">190</span>     <span class="co">// @@@ sample begin 4:0</span></span>
<span id="cb755-191"><a href="#cb755-191" aria-hidden="true" tabindex="-1"></a>        <span class="dv">191</span> </span>
<span id="cb755-192"><a href="#cb755-192" aria-hidden="true" tabindex="-1"></a>        <span class="dv">192</span>     <span class="dt">void</span><span class="op">*</span> mem<span class="op">[</span><span class="dv">1024</span><span class="op">];</span></span>
<span id="cb755-193"><a href="#cb755-193" aria-hidden="true" tabindex="-1"></a>        <span class="dv">193</span> </span>
<span id="cb755-194"><a href="#cb755-194" aria-hidden="true" tabindex="-1"></a>        <span class="dv">194</span>     <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span><span class="op">&amp;</span> m <span class="op">:</span> mem<span class="op">)</span> <span class="op">{</span>  <span class="co">// 32バイト x 1024個のメモリ確保</span></span>
<span id="cb755-195"><a href="#cb755-195" aria-hidden="true" tabindex="-1"></a>        <span class="dv">195</span>         m <span class="op">=</span> malloc<span class="op">(</span><span class="dv">32</span><span class="op">);</span></span>
<span id="cb755-196"><a href="#cb755-196" aria-hidden="true" tabindex="-1"></a>        <span class="dv">196</span>     <span class="op">}</span></span>
<span id="cb755-197"><a href="#cb755-197" aria-hidden="true" tabindex="-1"></a>        <span class="dv">197</span> </span>
<span id="cb755-198"><a href="#cb755-198" aria-hidden="true" tabindex="-1"></a>        <span class="dv">198</span>     <span class="co">// memを使用した何らかの処理</span></span>
<span id="cb755-199"><a href="#cb755-199" aria-hidden="true" tabindex="-1"></a>        <span class="dv">199</span>     <span class="co">// @@@ ignore begin</span></span>
<span id="cb755-200"><a href="#cb755-200" aria-hidden="true" tabindex="-1"></a>        <span class="dv">200</span>     <span class="co">// @@@ ignore end</span></span>
<span id="cb755-201"><a href="#cb755-201" aria-hidden="true" tabindex="-1"></a>        <span class="dv">201</span> </span>
<span id="cb755-202"><a href="#cb755-202" aria-hidden="true" tabindex="-1"></a>        <span class="dv">202</span>     <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> i <span class="op">=</span> <span class="dv">0</span><span class="bu">U</span><span class="op">;</span> i <span class="op">&lt;</span> ArrayLength<span class="op">(</span>mem<span class="op">);</span> i <span class="op">+=</span> <span class="dv">2</span><span class="op">)</span> <span class="op">{</span>  <span class="co">// 512個のメモリを解放</span></span>
<span id="cb755-203"><a href="#cb755-203" aria-hidden="true" tabindex="-1"></a>        <span class="dv">203</span>         free<span class="op">(</span>mem<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb755-204"><a href="#cb755-204" aria-hidden="true" tabindex="-1"></a>        <span class="dv">204</span>     <span class="op">}</span></span>
<span id="cb755-205"><a href="#cb755-205" aria-hidden="true" tabindex="-1"></a>        <span class="dv">205</span>     <span class="co">// @@@ sample end</span></span>
<span id="cb755-206"><a href="#cb755-206" aria-hidden="true" tabindex="-1"></a>        <span class="dv">206</span> </span>
<span id="cb755-207"><a href="#cb755-207" aria-hidden="true" tabindex="-1"></a>        <span class="dv">207</span>     <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> i <span class="op">=</span> <span class="dv">1</span><span class="bu">U</span><span class="op">;</span> i <span class="op">&lt;</span> ArrayLength<span class="op">(</span>mem<span class="op">);</span> i <span class="op">+=</span> <span class="dv">2</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb755-208"><a href="#cb755-208" aria-hidden="true" tabindex="-1"></a>        <span class="dv">208</span>         free<span class="op">(</span>mem<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb755-209"><a href="#cb755-209" aria-hidden="true" tabindex="-1"></a>        <span class="dv">209</span>     <span class="op">}</span></span>
<span id="cb755-210"><a href="#cb755-210" aria-hidden="true" tabindex="-1"></a>        <span class="dv">210</span> <span class="op">}</span></span>
<span id="cb755-211"><a href="#cb755-211" aria-hidden="true" tabindex="-1"></a>        <span class="dv">211</span> <span class="op">}</span>  <span class="co">// namespace</span></span>
<span id="cb755-212"><a href="#cb755-212" aria-hidden="true" tabindex="-1"></a>        <span class="dv">212</span> <span class="op">}</span>  <span class="co">// namespace MallocFree</span></span></code></pre></div>
<h3
id="exampledynamic_memory_allocationmpool_variable.h">example/dynamic_memory_allocation/mpool_variable.h
<a id="SS_6_1_2"></a></h3>
<div class="sourceCode" id="cb756"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb756-1"><a href="#cb756-1" aria-hidden="true" tabindex="-1"></a>          <span class="dv">1</span> <span class="er">#pragma once</span></span>
<span id="cb756-2"><a href="#cb756-2" aria-hidden="true" tabindex="-1"></a>          <span class="dv">2</span> <span class="er">#include &lt;cassert&gt;</span></span>
<span id="cb756-3"><a href="#cb756-3" aria-hidden="true" tabindex="-1"></a>          <span class="dv">3</span> <span class="er">#include &lt;cstdint&gt;</span></span>
<span id="cb756-4"><a href="#cb756-4" aria-hidden="true" tabindex="-1"></a>          <span class="dv">4</span> <span class="er">#include &lt;mutex&gt;</span></span>
<span id="cb756-5"><a href="#cb756-5" aria-hidden="true" tabindex="-1"></a>          <span class="dv">5</span> <span class="er">#include &lt;optional&gt;</span></span>
<span id="cb756-6"><a href="#cb756-6" aria-hidden="true" tabindex="-1"></a>          <span class="dv">6</span> </span>
<span id="cb756-7"><a href="#cb756-7" aria-hidden="true" tabindex="-1"></a>          <span class="dv">7</span> <span class="er">#include &quot;mpool.h&quot;</span></span>
<span id="cb756-8"><a href="#cb756-8" aria-hidden="true" tabindex="-1"></a>          <span class="dv">8</span> <span class="er">#include &quot;spin_lock.h&quot;</span></span>
<span id="cb756-9"><a href="#cb756-9" aria-hidden="true" tabindex="-1"></a>          <span class="dv">9</span> <span class="er">#include &quot;utils.h&quot;</span></span>
<span id="cb756-10"><a href="#cb756-10" aria-hidden="true" tabindex="-1"></a>         <span class="dv">10</span> </span>
<span id="cb756-11"><a href="#cb756-11" aria-hidden="true" tabindex="-1"></a>         <span class="dv">11</span> <span class="kw">namespace</span> Inner_ <span class="op">{</span></span>
<span id="cb756-12"><a href="#cb756-12" aria-hidden="true" tabindex="-1"></a>         <span class="dv">12</span> </span>
<span id="cb756-13"><a href="#cb756-13" aria-hidden="true" tabindex="-1"></a>         <span class="dv">13</span> <span class="kw">struct</span> <span class="dt">header_t</span> <span class="op">{</span></span>
<span id="cb756-14"><a href="#cb756-14" aria-hidden="true" tabindex="-1"></a>         <span class="dv">14</span>     <span class="dt">header_t</span><span class="op">*</span> next<span class="op">;</span></span>
<span id="cb756-15"><a href="#cb756-15" aria-hidden="true" tabindex="-1"></a>         <span class="dv">15</span>     <span class="dt">size_t</span>    n_nuits<span class="op">;</span>  <span class="co">// header_tが何個あるか</span></span>
<span id="cb756-16"><a href="#cb756-16" aria-hidden="true" tabindex="-1"></a>         <span class="dv">16</span> <span class="op">};</span></span>
<span id="cb756-17"><a href="#cb756-17" aria-hidden="true" tabindex="-1"></a>         <span class="dv">17</span> </span>
<span id="cb756-18"><a href="#cb756-18" aria-hidden="true" tabindex="-1"></a>         <span class="dv">18</span> <span class="kw">constexpr</span> <span class="kw">auto</span> unit_size <span class="op">=</span> <span class="kw">sizeof</span><span class="op">(</span><span class="dt">header_t</span><span class="op">);</span></span>
<span id="cb756-19"><a href="#cb756-19" aria-hidden="true" tabindex="-1"></a>         <span class="dv">19</span> </span>
<span id="cb756-20"><a href="#cb756-20" aria-hidden="true" tabindex="-1"></a>         <span class="dv">20</span> <span class="kw">inline</span> <span class="bu">std::</span>optional<span class="op">&lt;</span><span class="dt">header_t</span><span class="op">*&gt;</span> sprit<span class="op">(</span><span class="dt">header_t</span><span class="op">*</span> header<span class="op">,</span> <span class="dt">size_t</span> n_nuits<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb756-21"><a href="#cb756-21" aria-hidden="true" tabindex="-1"></a>         <span class="dv">21</span> <span class="op">{</span></span>
<span id="cb756-22"><a href="#cb756-22" aria-hidden="true" tabindex="-1"></a>         <span class="dv">22</span>     <span class="ot">assert</span><span class="op">(</span>n_nuits <span class="op">&gt;</span> <span class="dv">1</span><span class="op">);</span>  <span class="co">// ヘッダとバッファなので最低でも2</span></span>
<span id="cb756-23"><a href="#cb756-23" aria-hidden="true" tabindex="-1"></a>         <span class="dv">23</span> </span>
<span id="cb756-24"><a href="#cb756-24" aria-hidden="true" tabindex="-1"></a>         <span class="dv">24</span>     <span class="cf">if</span> <span class="op">(</span>header<span class="op">-&gt;</span>n_nuits <span class="op">==</span> n_nuits <span class="op">||</span> header<span class="op">-&gt;</span>n_nuits <span class="op">==</span> n_nuits <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb756-25"><a href="#cb756-25" aria-hidden="true" tabindex="-1"></a>         <span class="dv">25</span>         <span class="cf">return</span> header<span class="op">-&gt;</span>next<span class="op">;</span></span>
<span id="cb756-26"><a href="#cb756-26" aria-hidden="true" tabindex="-1"></a>         <span class="dv">26</span>     <span class="op">}</span></span>
<span id="cb756-27"><a href="#cb756-27" aria-hidden="true" tabindex="-1"></a>         <span class="dv">27</span>     <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>header<span class="op">-&gt;</span>n_nuits <span class="op">&gt;</span> n_nuits<span class="op">)</span> <span class="op">{</span></span>
<span id="cb756-28"><a href="#cb756-28" aria-hidden="true" tabindex="-1"></a>         <span class="dv">28</span>         <span class="kw">auto</span> next       <span class="op">=</span> header <span class="op">+</span> n_nuits<span class="op">;</span></span>
<span id="cb756-29"><a href="#cb756-29" aria-hidden="true" tabindex="-1"></a>         <span class="dv">29</span>         next<span class="op">-&gt;</span>n_nuits   <span class="op">=</span> header<span class="op">-&gt;</span>n_nuits <span class="op">-</span> n_nuits<span class="op">;</span></span>
<span id="cb756-30"><a href="#cb756-30" aria-hidden="true" tabindex="-1"></a>         <span class="dv">30</span>         next<span class="op">-&gt;</span>next      <span class="op">=</span> header<span class="op">-&gt;</span>next<span class="op">;</span></span>
<span id="cb756-31"><a href="#cb756-31" aria-hidden="true" tabindex="-1"></a>         <span class="dv">31</span>         header<span class="op">-&gt;</span>n_nuits <span class="op">=</span> n_nuits<span class="op">;</span></span>
<span id="cb756-32"><a href="#cb756-32" aria-hidden="true" tabindex="-1"></a>         <span class="dv">32</span>         <span class="cf">return</span> next<span class="op">;</span></span>
<span id="cb756-33"><a href="#cb756-33" aria-hidden="true" tabindex="-1"></a>         <span class="dv">33</span>     <span class="op">}</span></span>
<span id="cb756-34"><a href="#cb756-34" aria-hidden="true" tabindex="-1"></a>         <span class="dv">34</span> </span>
<span id="cb756-35"><a href="#cb756-35" aria-hidden="true" tabindex="-1"></a>         <span class="dv">35</span>     <span class="cf">return</span> <span class="bu">std::</span>nullopt<span class="op">;</span></span>
<span id="cb756-36"><a href="#cb756-36" aria-hidden="true" tabindex="-1"></a>         <span class="dv">36</span> <span class="op">}</span></span>
<span id="cb756-37"><a href="#cb756-37" aria-hidden="true" tabindex="-1"></a>         <span class="dv">37</span> </span>
<span id="cb756-38"><a href="#cb756-38" aria-hidden="true" tabindex="-1"></a>         <span class="dv">38</span> <span class="kw">inline</span> <span class="dt">void</span> concat<span class="op">(</span><span class="dt">header_t</span><span class="op">*</span> front<span class="op">,</span> <span class="dt">header_t</span><span class="op">*</span> rear<span class="op">)</span> <span class="kw">noexcept</span></span>
<span id="cb756-39"><a href="#cb756-39" aria-hidden="true" tabindex="-1"></a>         <span class="dv">39</span> <span class="op">{</span></span>
<span id="cb756-40"><a href="#cb756-40" aria-hidden="true" tabindex="-1"></a>         <span class="dv">40</span>     <span class="cf">if</span> <span class="op">(</span>front <span class="op">+</span> front<span class="op">-&gt;</span>n_nuits <span class="op">==</span> rear<span class="op">)</span> <span class="op">{</span>  <span class="co">// 1枚のメモリになる</span></span>
<span id="cb756-41"><a href="#cb756-41" aria-hidden="true" tabindex="-1"></a>         <span class="dv">41</span>         front<span class="op">-&gt;</span>n_nuits <span class="op">+=</span> rear<span class="op">-&gt;</span>n_nuits<span class="op">;</span></span>
<span id="cb756-42"><a href="#cb756-42" aria-hidden="true" tabindex="-1"></a>         <span class="dv">42</span>         front<span class="op">-&gt;</span>next <span class="op">=</span> rear<span class="op">-&gt;</span>next<span class="op">;</span></span>
<span id="cb756-43"><a href="#cb756-43" aria-hidden="true" tabindex="-1"></a>         <span class="dv">43</span>     <span class="op">}</span></span>
<span id="cb756-44"><a href="#cb756-44" aria-hidden="true" tabindex="-1"></a>         <span class="dv">44</span>     <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb756-45"><a href="#cb756-45" aria-hidden="true" tabindex="-1"></a>         <span class="dv">45</span>         front<span class="op">-&gt;</span>next <span class="op">=</span> rear<span class="op">;</span></span>
<span id="cb756-46"><a href="#cb756-46" aria-hidden="true" tabindex="-1"></a>         <span class="dv">46</span>     <span class="op">}</span></span>
<span id="cb756-47"><a href="#cb756-47" aria-hidden="true" tabindex="-1"></a>         <span class="dv">47</span> <span class="op">}</span></span>
<span id="cb756-48"><a href="#cb756-48" aria-hidden="true" tabindex="-1"></a>         <span class="dv">48</span> </span>
<span id="cb756-49"><a href="#cb756-49" aria-hidden="true" tabindex="-1"></a>         <span class="dv">49</span> <span class="kw">inline</span> <span class="dt">header_t</span><span class="op">*</span> set_back<span class="op">(</span><span class="dt">void</span><span class="op">*</span> mem<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="kw">static_cast</span><span class="op">&lt;</span><span class="dt">header_t</span><span class="op">*&gt;(</span>mem<span class="op">)</span> <span class="op">-</span> <span class="dv">1</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb756-50"><a href="#cb756-50" aria-hidden="true" tabindex="-1"></a>         <span class="dv">50</span> </span>
<span id="cb756-51"><a href="#cb756-51" aria-hidden="true" tabindex="-1"></a>         <span class="dv">51</span> <span class="kw">static_assert</span><span class="op">(</span><span class="kw">sizeof</span><span class="op">(</span><span class="dt">header_t</span><span class="op">)</span> <span class="op">==</span> <span class="kw">alignof</span><span class="op">(</span><span class="bu">std::</span>max_align_t<span class="op">));</span></span>
<span id="cb756-52"><a href="#cb756-52" aria-hidden="true" tabindex="-1"></a>         <span class="dv">52</span> </span>
<span id="cb756-53"><a href="#cb756-53" aria-hidden="true" tabindex="-1"></a>         <span class="dv">53</span> <span class="kw">template</span> <span class="op">&lt;</span><span class="dt">uint32_t</span> MEM_SIZE<span class="op">&gt;</span></span>
<span id="cb756-54"><a href="#cb756-54" aria-hidden="true" tabindex="-1"></a>         <span class="dv">54</span> <span class="kw">struct</span> <span class="dt">buffer_t</span> <span class="op">{</span></span>
<span id="cb756-55"><a href="#cb756-55" aria-hidden="true" tabindex="-1"></a>         <span class="dv">55</span>     <span class="kw">alignas</span><span class="op">(</span><span class="kw">alignof</span><span class="op">(</span><span class="bu">std::</span>max_align_t<span class="op">))</span> <span class="dt">uint8_t</span> buffer<span class="op">[</span>Roundup<span class="op">(</span><span class="kw">sizeof</span><span class="op">(</span><span class="dt">header_t</span><span class="op">),</span> MEM_SIZE<span class="op">)];</span></span>
<span id="cb756-56"><a href="#cb756-56" aria-hidden="true" tabindex="-1"></a>         <span class="dv">56</span> <span class="op">};</span></span>
<span id="cb756-57"><a href="#cb756-57" aria-hidden="true" tabindex="-1"></a>         <span class="dv">57</span> <span class="op">}</span>  <span class="co">// namespace Inner_</span></span>
<span id="cb756-58"><a href="#cb756-58" aria-hidden="true" tabindex="-1"></a>         <span class="dv">58</span> </span>
<span id="cb756-59"><a href="#cb756-59" aria-hidden="true" tabindex="-1"></a>         <span class="dv">59</span> <span class="co">// @@@ sample begin 0:0</span></span>
<span id="cb756-60"><a href="#cb756-60" aria-hidden="true" tabindex="-1"></a>         <span class="dv">60</span> </span>
<span id="cb756-61"><a href="#cb756-61" aria-hidden="true" tabindex="-1"></a>         <span class="dv">61</span> <span class="kw">template</span> <span class="op">&lt;</span><span class="dt">uint32_t</span> MEM_SIZE<span class="op">&gt;</span></span>
<span id="cb756-62"><a href="#cb756-62" aria-hidden="true" tabindex="-1"></a>         <span class="dv">62</span> <span class="kw">class</span> MPoolVariable <span class="kw">final</span> <span class="op">:</span> <span class="kw">public</span> MPool <span class="op">{</span></span>
<span id="cb756-63"><a href="#cb756-63" aria-hidden="true" tabindex="-1"></a>         <span class="dv">63</span> <span class="kw">public</span><span class="op">:</span></span>
<span id="cb756-64"><a href="#cb756-64" aria-hidden="true" tabindex="-1"></a>         <span class="dv">64</span>     <span class="co">// @@@ sample end</span></span>
<span id="cb756-65"><a href="#cb756-65" aria-hidden="true" tabindex="-1"></a>         <span class="dv">65</span>     <span class="co">// @@@ sample begin 0:1</span></span>
<span id="cb756-66"><a href="#cb756-66" aria-hidden="true" tabindex="-1"></a>         <span class="dv">66</span>     MPoolVariable<span class="op">()</span> <span class="kw">noexcept</span> <span class="op">:</span> MPool<span class="op">{</span>MEM_SIZE<span class="op">}</span></span>
<span id="cb756-67"><a href="#cb756-67" aria-hidden="true" tabindex="-1"></a>         <span class="dv">67</span>     <span class="op">{</span></span>
<span id="cb756-68"><a href="#cb756-68" aria-hidden="true" tabindex="-1"></a>         <span class="dv">68</span>         <span class="va">header_</span><span class="op">-&gt;</span>next    <span class="op">=</span> <span class="kw">nullptr</span><span class="op">;</span></span>
<span id="cb756-69"><a href="#cb756-69" aria-hidden="true" tabindex="-1"></a>         <span class="dv">69</span>         <span class="va">header_</span><span class="op">-&gt;</span>n_nuits <span class="op">=</span> <span class="kw">sizeof</span><span class="op">(</span><span class="va">buff_</span><span class="op">)</span> <span class="op">/</span> Inner_<span class="op">::</span>unit_size<span class="op">;</span></span>
<span id="cb756-70"><a href="#cb756-70" aria-hidden="true" tabindex="-1"></a>         <span class="dv">70</span>     <span class="op">}</span></span>
<span id="cb756-71"><a href="#cb756-71" aria-hidden="true" tabindex="-1"></a>         <span class="dv">71</span>     <span class="co">// @@@ sample end</span></span>
<span id="cb756-72"><a href="#cb756-72" aria-hidden="true" tabindex="-1"></a>         <span class="dv">72</span>     <span class="co">// @@@ sample begin 0:2</span></span>
<span id="cb756-73"><a href="#cb756-73" aria-hidden="true" tabindex="-1"></a>         <span class="dv">73</span> </span>
<span id="cb756-74"><a href="#cb756-74" aria-hidden="true" tabindex="-1"></a>         <span class="dv">74</span>     <span class="kw">class</span> const_iterator <span class="op">{</span></span>
<span id="cb756-75"><a href="#cb756-75" aria-hidden="true" tabindex="-1"></a>         <span class="dv">75</span>     <span class="kw">public</span><span class="op">:</span></span>
<span id="cb756-76"><a href="#cb756-76" aria-hidden="true" tabindex="-1"></a>         <span class="dv">76</span>         <span class="kw">explicit</span> const_iterator<span class="op">(</span>Inner_<span class="op">::</span><span class="dt">header_t</span> <span class="at">const</span><span class="op">*</span> header<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">:</span> <span class="va">header_</span><span class="op">{</span>header<span class="op">}</span> <span class="op">{}</span></span>
<span id="cb756-77"><a href="#cb756-77" aria-hidden="true" tabindex="-1"></a>         <span class="dv">77</span>         const_iterator<span class="op">(</span>const_iterator <span class="at">const</span><span class="op">&amp;)</span> <span class="op">=</span> <span class="cf">default</span><span class="op">;</span></span>
<span id="cb756-78"><a href="#cb756-78" aria-hidden="true" tabindex="-1"></a>         <span class="dv">78</span>         const_iterator<span class="op">(</span>const_iterator<span class="op">&amp;&amp;)</span>      <span class="op">=</span> <span class="cf">default</span><span class="op">;</span></span>
<span id="cb756-79"><a href="#cb756-79" aria-hidden="true" tabindex="-1"></a>         <span class="dv">79</span> </span>
<span id="cb756-80"><a href="#cb756-80" aria-hidden="true" tabindex="-1"></a>         <span class="dv">80</span>         const_iterator<span class="op">&amp;</span> <span class="kw">operator</span><span class="op">++()</span> <span class="kw">noexcept</span>  <span class="co">// 前置++のみ実装</span></span>
<span id="cb756-81"><a href="#cb756-81" aria-hidden="true" tabindex="-1"></a>         <span class="dv">81</span>         <span class="op">{</span></span>
<span id="cb756-82"><a href="#cb756-82" aria-hidden="true" tabindex="-1"></a>         <span class="dv">82</span>             <span class="ot">assert</span><span class="op">(</span><span class="va">header_</span> <span class="op">!=</span> <span class="kw">nullptr</span><span class="op">);</span></span>
<span id="cb756-83"><a href="#cb756-83" aria-hidden="true" tabindex="-1"></a>         <span class="dv">83</span>             <span class="va">header_</span> <span class="op">=</span> <span class="va">header_</span><span class="op">-&gt;</span>next<span class="op">;</span></span>
<span id="cb756-84"><a href="#cb756-84" aria-hidden="true" tabindex="-1"></a>         <span class="dv">84</span> </span>
<span id="cb756-85"><a href="#cb756-85" aria-hidden="true" tabindex="-1"></a>         <span class="dv">85</span>             <span class="cf">return</span> <span class="op">*</span><span class="kw">this</span><span class="op">;</span></span>
<span id="cb756-86"><a href="#cb756-86" aria-hidden="true" tabindex="-1"></a>         <span class="dv">86</span>         <span class="op">}</span></span>
<span id="cb756-87"><a href="#cb756-87" aria-hidden="true" tabindex="-1"></a>         <span class="dv">87</span> </span>
<span id="cb756-88"><a href="#cb756-88" aria-hidden="true" tabindex="-1"></a>         <span class="dv">88</span>         Inner_<span class="op">::</span><span class="dt">header_t</span> <span class="at">const</span><span class="op">*</span> <span class="kw">operator</span><span class="op">*()</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">header_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb756-89"><a href="#cb756-89" aria-hidden="true" tabindex="-1"></a>         <span class="dv">89</span>         <span class="dt">bool</span> <span class="kw">operator</span><span class="op">==(</span>const_iterator <span class="at">const</span><span class="op">&amp;</span> rhs<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">header_</span> <span class="op">==</span> rhs<span class="op">.</span><span class="va">header_</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb756-90"><a href="#cb756-90" aria-hidden="true" tabindex="-1"></a>         <span class="dv">90</span>         <span class="dt">bool</span> <span class="kw">operator</span><span class="op">!=(</span>const_iterator <span class="at">const</span><span class="op">&amp;</span> rhs<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="op">!(*</span><span class="kw">this</span> <span class="op">==</span> rhs<span class="op">);</span> <span class="op">}</span></span>
<span id="cb756-91"><a href="#cb756-91" aria-hidden="true" tabindex="-1"></a>         <span class="dv">91</span> </span>
<span id="cb756-92"><a href="#cb756-92" aria-hidden="true" tabindex="-1"></a>         <span class="dv">92</span>     <span class="kw">private</span><span class="op">:</span></span>
<span id="cb756-93"><a href="#cb756-93" aria-hidden="true" tabindex="-1"></a>         <span class="dv">93</span>         Inner_<span class="op">::</span><span class="dt">header_t</span> <span class="at">const</span><span class="op">*</span> <span class="va">header_</span><span class="op">;</span></span>
<span id="cb756-94"><a href="#cb756-94" aria-hidden="true" tabindex="-1"></a>         <span class="dv">94</span>     <span class="op">};</span></span>
<span id="cb756-95"><a href="#cb756-95" aria-hidden="true" tabindex="-1"></a>         <span class="dv">95</span> </span>
<span id="cb756-96"><a href="#cb756-96" aria-hidden="true" tabindex="-1"></a>         <span class="dv">96</span>     const_iterator begin<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> const_iterator<span class="op">{</span><span class="va">header_</span><span class="op">};</span> <span class="op">}</span></span>
<span id="cb756-97"><a href="#cb756-97" aria-hidden="true" tabindex="-1"></a>         <span class="dv">97</span>     const_iterator end<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> const_iterator<span class="op">{</span><span class="kw">nullptr</span><span class="op">};</span> <span class="op">}</span></span>
<span id="cb756-98"><a href="#cb756-98" aria-hidden="true" tabindex="-1"></a>         <span class="dv">98</span>     const_iterator cbegin<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> const_iterator<span class="op">{</span><span class="va">header_</span><span class="op">};</span> <span class="op">}</span></span>
<span id="cb756-99"><a href="#cb756-99" aria-hidden="true" tabindex="-1"></a>         <span class="dv">99</span>     const_iterator cend<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> const_iterator<span class="op">{</span><span class="kw">nullptr</span><span class="op">};</span> <span class="op">}</span></span>
<span id="cb756-100"><a href="#cb756-100" aria-hidden="true" tabindex="-1"></a>        <span class="dv">100</span>     <span class="co">// @@@ sample end</span></span>
<span id="cb756-101"><a href="#cb756-101" aria-hidden="true" tabindex="-1"></a>        <span class="dv">101</span>     <span class="co">// @@@ sample begin 0:3</span></span>
<span id="cb756-102"><a href="#cb756-102" aria-hidden="true" tabindex="-1"></a>        <span class="dv">102</span> </span>
<span id="cb756-103"><a href="#cb756-103" aria-hidden="true" tabindex="-1"></a>        <span class="dv">103</span> <span class="kw">private</span><span class="op">:</span></span>
<span id="cb756-104"><a href="#cb756-104" aria-hidden="true" tabindex="-1"></a>        <span class="dv">104</span>     <span class="kw">using</span> <span class="dt">header_t</span> <span class="op">=</span> Inner_<span class="op">::</span><span class="dt">header_t</span><span class="op">;</span></span>
<span id="cb756-105"><a href="#cb756-105" aria-hidden="true" tabindex="-1"></a>        <span class="dv">105</span> </span>
<span id="cb756-106"><a href="#cb756-106" aria-hidden="true" tabindex="-1"></a>        <span class="dv">106</span>     Inner_<span class="op">::</span><span class="dt">buffer_t</span><span class="op">&lt;</span>MEM_SIZE<span class="op">&gt;</span> <span class="va">buff_</span><span class="op">{};</span></span>
<span id="cb756-107"><a href="#cb756-107" aria-hidden="true" tabindex="-1"></a>        <span class="dv">107</span>     <span class="dt">header_t</span><span class="op">*</span>                  <span class="va">header_</span><span class="op">{</span><span class="kw">reinterpret_cast</span><span class="op">&lt;</span><span class="dt">header_t</span><span class="op">*&gt;(</span><span class="va">buff_</span><span class="op">.</span>buffer<span class="op">)};</span></span>
<span id="cb756-108"><a href="#cb756-108" aria-hidden="true" tabindex="-1"></a>        <span class="dv">108</span>     <span class="at">mutable</span> SpinLock           <span class="va">spin_lock_</span><span class="op">{};</span></span>
<span id="cb756-109"><a href="#cb756-109" aria-hidden="true" tabindex="-1"></a>        <span class="dv">109</span>     <span class="dt">size_t</span>                     <span class="va">unit_count_</span><span class="op">{</span><span class="kw">sizeof</span><span class="op">(</span><span class="va">buff_</span><span class="op">)</span> <span class="op">/</span> Inner_<span class="op">::</span>unit_size<span class="op">};</span></span>
<span id="cb756-110"><a href="#cb756-110" aria-hidden="true" tabindex="-1"></a>        <span class="dv">110</span>     <span class="dt">size_t</span>                     <span class="va">unit_count_min_</span><span class="op">{</span><span class="kw">sizeof</span><span class="op">(</span><span class="va">buff_</span><span class="op">)</span> <span class="op">/</span> Inner_<span class="op">::</span>unit_size<span class="op">};</span></span>
<span id="cb756-111"><a href="#cb756-111" aria-hidden="true" tabindex="-1"></a>        <span class="dv">111</span> </span>
<span id="cb756-112"><a href="#cb756-112" aria-hidden="true" tabindex="-1"></a>        <span class="dv">112</span>     <span class="kw">virtual</span> <span class="dt">void</span><span class="op">*</span> alloc<span class="op">(</span><span class="dt">size_t</span> size<span class="op">)</span> <span class="kw">noexcept</span> <span class="kw">override</span></span>
<span id="cb756-113"><a href="#cb756-113" aria-hidden="true" tabindex="-1"></a>        <span class="dv">113</span>     <span class="op">{</span></span>
<span id="cb756-114"><a href="#cb756-114" aria-hidden="true" tabindex="-1"></a>        <span class="dv">114</span>         <span class="co">// @@@ ignore begin</span></span>
<span id="cb756-115"><a href="#cb756-115" aria-hidden="true" tabindex="-1"></a>        <span class="dv">115</span>         <span class="co">// size分のメモリとヘッダ</span></span>
<span id="cb756-116"><a href="#cb756-116" aria-hidden="true" tabindex="-1"></a>        <span class="dv">116</span>         <span class="kw">auto</span> n_nuits <span class="op">=</span> <span class="op">(</span>Roundup<span class="op">(</span>Inner_<span class="op">::</span>unit_size<span class="op">,</span> size<span class="op">)</span> <span class="op">/</span> Inner_<span class="op">::</span>unit_size<span class="op">)</span> <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb756-117"><a href="#cb756-117" aria-hidden="true" tabindex="-1"></a>        <span class="dv">117</span> </span>
<span id="cb756-118"><a href="#cb756-118" aria-hidden="true" tabindex="-1"></a>        <span class="dv">118</span>         <span class="kw">auto</span> lock <span class="op">=</span> <span class="bu">std::</span>lock_guard<span class="op">{</span><span class="va">spin_lock_</span><span class="op">};</span></span>
<span id="cb756-119"><a href="#cb756-119" aria-hidden="true" tabindex="-1"></a>        <span class="dv">119</span> </span>
<span id="cb756-120"><a href="#cb756-120" aria-hidden="true" tabindex="-1"></a>        <span class="dv">120</span>         <span class="kw">auto</span> curr <span class="op">=</span> <span class="va">header_</span><span class="op">;</span></span>
<span id="cb756-121"><a href="#cb756-121" aria-hidden="true" tabindex="-1"></a>        <span class="dv">121</span> </span>
<span id="cb756-122"><a href="#cb756-122" aria-hidden="true" tabindex="-1"></a>        <span class="dv">122</span>         <span class="cf">for</span> <span class="op">(</span><span class="dt">header_t</span><span class="op">*</span> prev<span class="op">{</span><span class="kw">nullptr</span><span class="op">};</span> curr <span class="op">!=</span> <span class="kw">nullptr</span><span class="op">;</span> prev <span class="op">=</span> curr<span class="op">,</span> curr <span class="op">=</span> curr<span class="op">-&gt;</span>next<span class="op">)</span> <span class="op">{</span></span>
<span id="cb756-123"><a href="#cb756-123" aria-hidden="true" tabindex="-1"></a>        <span class="dv">123</span>             <span class="kw">auto</span> opt_next <span class="op">=</span> <span class="bu">std::</span>optional<span class="op">&lt;</span><span class="dt">header_t</span><span class="op">*&gt;{</span>sprit<span class="op">(</span>curr<span class="op">,</span> n_nuits<span class="op">)};</span></span>
<span id="cb756-124"><a href="#cb756-124" aria-hidden="true" tabindex="-1"></a>        <span class="dv">124</span> </span>
<span id="cb756-125"><a href="#cb756-125" aria-hidden="true" tabindex="-1"></a>        <span class="dv">125</span>             <span class="cf">if</span> <span class="op">(!</span>opt_next<span class="op">)</span> <span class="op">{</span></span>
<span id="cb756-126"><a href="#cb756-126" aria-hidden="true" tabindex="-1"></a>        <span class="dv">126</span>                 <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb756-127"><a href="#cb756-127" aria-hidden="true" tabindex="-1"></a>        <span class="dv">127</span>             <span class="op">}</span></span>
<span id="cb756-128"><a href="#cb756-128" aria-hidden="true" tabindex="-1"></a>        <span class="dv">128</span> </span>
<span id="cb756-129"><a href="#cb756-129" aria-hidden="true" tabindex="-1"></a>        <span class="dv">129</span>             <span class="kw">auto</span> next <span class="op">=</span> <span class="op">*</span>opt_next<span class="op">;</span></span>
<span id="cb756-130"><a href="#cb756-130" aria-hidden="true" tabindex="-1"></a>        <span class="dv">130</span>             <span class="cf">if</span> <span class="op">(</span>prev <span class="op">==</span> <span class="kw">nullptr</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb756-131"><a href="#cb756-131" aria-hidden="true" tabindex="-1"></a>        <span class="dv">131</span>                 <span class="va">header_</span> <span class="op">=</span> next<span class="op">;</span></span>
<span id="cb756-132"><a href="#cb756-132" aria-hidden="true" tabindex="-1"></a>        <span class="dv">132</span>             <span class="op">}</span></span>
<span id="cb756-133"><a href="#cb756-133" aria-hidden="true" tabindex="-1"></a>        <span class="dv">133</span>             <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb756-134"><a href="#cb756-134" aria-hidden="true" tabindex="-1"></a>        <span class="dv">134</span>                 prev<span class="op">-&gt;</span>next <span class="op">=</span> next<span class="op">;</span></span>
<span id="cb756-135"><a href="#cb756-135" aria-hidden="true" tabindex="-1"></a>        <span class="dv">135</span>             <span class="op">}</span></span>
<span id="cb756-136"><a href="#cb756-136" aria-hidden="true" tabindex="-1"></a>        <span class="dv">136</span>             <span class="cf">break</span><span class="op">;</span></span>
<span id="cb756-137"><a href="#cb756-137" aria-hidden="true" tabindex="-1"></a>        <span class="dv">137</span>         <span class="op">}</span></span>
<span id="cb756-138"><a href="#cb756-138" aria-hidden="true" tabindex="-1"></a>        <span class="dv">138</span> </span>
<span id="cb756-139"><a href="#cb756-139" aria-hidden="true" tabindex="-1"></a>        <span class="dv">139</span>         <span class="cf">if</span> <span class="op">(</span>curr <span class="op">!=</span> <span class="kw">nullptr</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb756-140"><a href="#cb756-140" aria-hidden="true" tabindex="-1"></a>        <span class="dv">140</span>             <span class="va">unit_count_</span> <span class="op">-=</span> curr<span class="op">-&gt;</span>n_nuits<span class="op">;</span></span>
<span id="cb756-141"><a href="#cb756-141" aria-hidden="true" tabindex="-1"></a>        <span class="dv">141</span>             <span class="va">unit_count_min_</span> <span class="op">=</span> <span class="bu">std::</span>min<span class="op">(</span><span class="va">unit_count_</span><span class="op">,</span> <span class="va">unit_count_min_</span><span class="op">);</span></span>
<span id="cb756-142"><a href="#cb756-142" aria-hidden="true" tabindex="-1"></a>        <span class="dv">142</span>             <span class="op">++</span>curr<span class="op">;</span></span>
<span id="cb756-143"><a href="#cb756-143" aria-hidden="true" tabindex="-1"></a>        <span class="dv">143</span>         <span class="op">}</span></span>
<span id="cb756-144"><a href="#cb756-144" aria-hidden="true" tabindex="-1"></a>        <span class="dv">144</span> </span>
<span id="cb756-145"><a href="#cb756-145" aria-hidden="true" tabindex="-1"></a>        <span class="dv">145</span>         <span class="cf">return</span> curr<span class="op">;</span></span>
<span id="cb756-146"><a href="#cb756-146" aria-hidden="true" tabindex="-1"></a>        <span class="dv">146</span>         <span class="co">// @@@ ignore end</span></span>
<span id="cb756-147"><a href="#cb756-147" aria-hidden="true" tabindex="-1"></a>        <span class="dv">147</span>     <span class="op">}</span></span>
<span id="cb756-148"><a href="#cb756-148" aria-hidden="true" tabindex="-1"></a>        <span class="dv">148</span> </span>
<span id="cb756-149"><a href="#cb756-149" aria-hidden="true" tabindex="-1"></a>        <span class="dv">149</span>     <span class="kw">virtual</span> <span class="dt">void</span> free<span class="op">(</span><span class="dt">void</span><span class="op">*</span> mem<span class="op">)</span> <span class="kw">noexcept</span> <span class="kw">override</span></span>
<span id="cb756-150"><a href="#cb756-150" aria-hidden="true" tabindex="-1"></a>        <span class="dv">150</span>     <span class="op">{</span></span>
<span id="cb756-151"><a href="#cb756-151" aria-hidden="true" tabindex="-1"></a>        <span class="dv">151</span>         <span class="co">// @@@ ignore begin</span></span>
<span id="cb756-152"><a href="#cb756-152" aria-hidden="true" tabindex="-1"></a>        <span class="dv">152</span>         <span class="dt">header_t</span><span class="op">*</span> to_free <span class="op">=</span> Inner_<span class="op">::</span>set_back<span class="op">(</span>mem<span class="op">);</span></span>
<span id="cb756-153"><a href="#cb756-153" aria-hidden="true" tabindex="-1"></a>        <span class="dv">153</span> </span>
<span id="cb756-154"><a href="#cb756-154" aria-hidden="true" tabindex="-1"></a>        <span class="dv">154</span>         to_free<span class="op">-&gt;</span>next <span class="op">=</span> <span class="kw">nullptr</span><span class="op">;</span></span>
<span id="cb756-155"><a href="#cb756-155" aria-hidden="true" tabindex="-1"></a>        <span class="dv">155</span> </span>
<span id="cb756-156"><a href="#cb756-156" aria-hidden="true" tabindex="-1"></a>        <span class="dv">156</span>         <span class="kw">auto</span> lock <span class="op">=</span> <span class="bu">std::</span>lock_guard<span class="op">{</span><span class="va">spin_lock_</span><span class="op">};</span></span>
<span id="cb756-157"><a href="#cb756-157" aria-hidden="true" tabindex="-1"></a>        <span class="dv">157</span> </span>
<span id="cb756-158"><a href="#cb756-158" aria-hidden="true" tabindex="-1"></a>        <span class="dv">158</span>         <span class="va">unit_count_</span> <span class="op">+=</span> to_free<span class="op">-&gt;</span>n_nuits<span class="op">;</span></span>
<span id="cb756-159"><a href="#cb756-159" aria-hidden="true" tabindex="-1"></a>        <span class="dv">159</span>         <span class="va">unit_count_min_</span> <span class="op">=</span> <span class="bu">std::</span>min<span class="op">(</span><span class="va">unit_count_</span><span class="op">,</span> <span class="va">unit_count_min_</span><span class="op">);</span></span>
<span id="cb756-160"><a href="#cb756-160" aria-hidden="true" tabindex="-1"></a>        <span class="dv">160</span> </span>
<span id="cb756-161"><a href="#cb756-161" aria-hidden="true" tabindex="-1"></a>        <span class="dv">161</span>         <span class="cf">if</span> <span class="op">(</span><span class="va">header_</span> <span class="op">==</span> <span class="kw">nullptr</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb756-162"><a href="#cb756-162" aria-hidden="true" tabindex="-1"></a>        <span class="dv">162</span>             <span class="va">header_</span> <span class="op">=</span> to_free<span class="op">;</span></span>
<span id="cb756-163"><a href="#cb756-163" aria-hidden="true" tabindex="-1"></a>        <span class="dv">163</span>             <span class="cf">return</span><span class="op">;</span></span>
<span id="cb756-164"><a href="#cb756-164" aria-hidden="true" tabindex="-1"></a>        <span class="dv">164</span>         <span class="op">}</span></span>
<span id="cb756-165"><a href="#cb756-165" aria-hidden="true" tabindex="-1"></a>        <span class="dv">165</span> </span>
<span id="cb756-166"><a href="#cb756-166" aria-hidden="true" tabindex="-1"></a>        <span class="dv">166</span>         <span class="cf">if</span> <span class="op">(</span>to_free <span class="op">&lt;</span> <span class="va">header_</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb756-167"><a href="#cb756-167" aria-hidden="true" tabindex="-1"></a>        <span class="dv">167</span>             concat<span class="op">(</span>to_free<span class="op">,</span> <span class="va">header_</span><span class="op">);</span></span>
<span id="cb756-168"><a href="#cb756-168" aria-hidden="true" tabindex="-1"></a>        <span class="dv">168</span>             <span class="va">header_</span> <span class="op">=</span> to_free<span class="op">;</span></span>
<span id="cb756-169"><a href="#cb756-169" aria-hidden="true" tabindex="-1"></a>        <span class="dv">169</span>             <span class="cf">return</span><span class="op">;</span></span>
<span id="cb756-170"><a href="#cb756-170" aria-hidden="true" tabindex="-1"></a>        <span class="dv">170</span>         <span class="op">}</span></span>
<span id="cb756-171"><a href="#cb756-171" aria-hidden="true" tabindex="-1"></a>        <span class="dv">171</span> </span>
<span id="cb756-172"><a href="#cb756-172" aria-hidden="true" tabindex="-1"></a>        <span class="dv">172</span>         <span class="dt">header_t</span><span class="op">*</span> curr <span class="op">=</span> <span class="va">header_</span><span class="op">;</span></span>
<span id="cb756-173"><a href="#cb756-173" aria-hidden="true" tabindex="-1"></a>        <span class="dv">173</span> </span>
<span id="cb756-174"><a href="#cb756-174" aria-hidden="true" tabindex="-1"></a>        <span class="dv">174</span>         <span class="cf">for</span> <span class="op">(;</span> curr<span class="op">-&gt;</span>next <span class="op">!=</span> <span class="kw">nullptr</span><span class="op">;</span> curr <span class="op">=</span> curr<span class="op">-&gt;</span>next<span class="op">)</span> <span class="op">{</span></span>
<span id="cb756-175"><a href="#cb756-175" aria-hidden="true" tabindex="-1"></a>        <span class="dv">175</span>             <span class="cf">if</span> <span class="op">(</span>to_free <span class="op">&lt;</span> curr<span class="op">-&gt;</span>next<span class="op">)</span> <span class="op">{</span>  <span class="co">// 常に curr &lt; to_free</span></span>
<span id="cb756-176"><a href="#cb756-176" aria-hidden="true" tabindex="-1"></a>        <span class="dv">176</span>                 concat<span class="op">(</span>to_free<span class="op">,</span> curr<span class="op">-&gt;</span>next<span class="op">);</span></span>
<span id="cb756-177"><a href="#cb756-177" aria-hidden="true" tabindex="-1"></a>        <span class="dv">177</span>                 concat<span class="op">(</span>curr<span class="op">,</span> to_free<span class="op">);</span></span>
<span id="cb756-178"><a href="#cb756-178" aria-hidden="true" tabindex="-1"></a>        <span class="dv">178</span>                 <span class="cf">return</span><span class="op">;</span></span>
<span id="cb756-179"><a href="#cb756-179" aria-hidden="true" tabindex="-1"></a>        <span class="dv">179</span>             <span class="op">}</span></span>
<span id="cb756-180"><a href="#cb756-180" aria-hidden="true" tabindex="-1"></a>        <span class="dv">180</span>         <span class="op">}</span></span>
<span id="cb756-181"><a href="#cb756-181" aria-hidden="true" tabindex="-1"></a>        <span class="dv">181</span> </span>
<span id="cb756-182"><a href="#cb756-182" aria-hidden="true" tabindex="-1"></a>        <span class="dv">182</span>         concat<span class="op">(</span>curr<span class="op">,</span> to_free<span class="op">);</span></span>
<span id="cb756-183"><a href="#cb756-183" aria-hidden="true" tabindex="-1"></a>        <span class="dv">183</span>         <span class="co">// @@@ ignore end</span></span>
<span id="cb756-184"><a href="#cb756-184" aria-hidden="true" tabindex="-1"></a>        <span class="dv">184</span>     <span class="op">}</span></span>
<span id="cb756-185"><a href="#cb756-185" aria-hidden="true" tabindex="-1"></a>        <span class="dv">185</span> </span>
<span id="cb756-186"><a href="#cb756-186" aria-hidden="true" tabindex="-1"></a>        <span class="dv">186</span>     <span class="kw">virtual</span> <span class="dt">size_t</span> get_size<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="kw">override</span> <span class="op">{</span> <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb756-187"><a href="#cb756-187" aria-hidden="true" tabindex="-1"></a>        <span class="dv">187</span>     <span class="kw">virtual</span> <span class="dt">size_t</span> get_count<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="kw">override</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">unit_count_</span> <span class="op">*</span> Inner_<span class="op">::</span>unit_size<span class="op">;</span> <span class="op">}</span></span>
<span id="cb756-188"><a href="#cb756-188" aria-hidden="true" tabindex="-1"></a>        <span class="dv">188</span>     <span class="kw">virtual</span> <span class="dt">size_t</span> get_count_min<span class="op">()</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="kw">override</span></span>
<span id="cb756-189"><a href="#cb756-189" aria-hidden="true" tabindex="-1"></a>        <span class="dv">189</span>     <span class="op">{</span></span>
<span id="cb756-190"><a href="#cb756-190" aria-hidden="true" tabindex="-1"></a>        <span class="dv">190</span>         <span class="cf">return</span> <span class="va">unit_count_min_</span> <span class="op">*</span> Inner_<span class="op">::</span>unit_size<span class="op">;</span></span>
<span id="cb756-191"><a href="#cb756-191" aria-hidden="true" tabindex="-1"></a>        <span class="dv">191</span>     <span class="op">}</span></span>
<span id="cb756-192"><a href="#cb756-192" aria-hidden="true" tabindex="-1"></a>        <span class="dv">192</span> </span>
<span id="cb756-193"><a href="#cb756-193" aria-hidden="true" tabindex="-1"></a>        <span class="dv">193</span>     <span class="kw">virtual</span> <span class="dt">bool</span> is_valid<span class="op">(</span><span class="dt">void</span> <span class="at">const</span><span class="op">*</span> mem<span class="op">)</span> <span class="at">const</span> <span class="kw">noexcept</span> <span class="kw">override</span></span>
<span id="cb756-194"><a href="#cb756-194" aria-hidden="true" tabindex="-1"></a>        <span class="dv">194</span>     <span class="op">{</span></span>
<span id="cb756-195"><a href="#cb756-195" aria-hidden="true" tabindex="-1"></a>        <span class="dv">195</span>         <span class="cf">return</span> <span class="op">(&amp;</span><span class="va">buff_</span> <span class="op">&lt;</span> mem<span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="op">(</span>mem <span class="op">&lt;</span> <span class="op">&amp;</span><span class="va">buff_</span><span class="op">.</span>buffer<span class="op">[</span>ArrayLength<span class="op">(</span><span class="va">buff_</span><span class="op">.</span>buffer<span class="op">)]);</span></span>
<span id="cb756-196"><a href="#cb756-196" aria-hidden="true" tabindex="-1"></a>        <span class="dv">196</span>     <span class="op">}</span></span>
<span id="cb756-197"><a href="#cb756-197" aria-hidden="true" tabindex="-1"></a>        <span class="dv">197</span>     <span class="co">// @@@ sample end</span></span>
<span id="cb756-198"><a href="#cb756-198" aria-hidden="true" tabindex="-1"></a>        <span class="dv">198</span>     <span class="co">// @@@ sample begin 0:4</span></span>
<span id="cb756-199"><a href="#cb756-199" aria-hidden="true" tabindex="-1"></a>        <span class="dv">199</span> <span class="op">};</span></span>
<span id="cb756-200"><a href="#cb756-200" aria-hidden="true" tabindex="-1"></a>        <span class="dv">200</span> <span class="co">// @@@ sample end</span></span></code></pre></div>
</body>
</html>
